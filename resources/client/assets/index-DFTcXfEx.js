function k2(e,t){for(var n=0;n<t.length;n++){const o=t[n];if(typeof o!="string"&&!Array.isArray(o)){for(const u in o)if(u!=="default"&&!(u in e)){const h=Object.getOwnPropertyDescriptor(o,u);h&&Object.defineProperty(e,u,h.get?h:{enumerable:!0,get:()=>o[u]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const h of u)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function n(u){const h={};return u.integrity&&(h.integrity=u.integrity),u.referrerPolicy&&(h.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?h.credentials="include":u.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(u){if(u.ep)return;u.ep=!0;const h=n(u);fetch(u.href,h)}})();var pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qU={exports:{}},jT={},ZU={exports:{}},yr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fx=Symbol.for("react.element"),D2=Symbol.for("react.portal"),L2=Symbol.for("react.fragment"),z2=Symbol.for("react.strict_mode"),F2=Symbol.for("react.profiler"),N2=Symbol.for("react.provider"),B2=Symbol.for("react.context"),j2=Symbol.for("react.forward_ref"),$2=Symbol.for("react.suspense"),U2=Symbol.for("react.memo"),V2=Symbol.for("react.lazy"),eB=Symbol.iterator;function G2(e){return e===null||typeof e!="object"?null:(e=eB&&e[eB]||e["@@iterator"],typeof e=="function"?e:null)}var XU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},YU=Object.assign,KU={};function Bg(e,t,n){this.props=e,this.context=t,this.refs=KU,this.updater=n||XU}Bg.prototype.isReactComponent={};Bg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Bg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function QU(){}QU.prototype=Bg.prototype;function yR(e,t,n){this.props=e,this.context=t,this.refs=KU,this.updater=n||XU}var _R=yR.prototype=new QU;_R.constructor=yR;YU(_R,Bg.prototype);_R.isPureReactComponent=!0;var tB=Array.isArray,JU=Object.prototype.hasOwnProperty,vR={current:null},eV={key:!0,ref:!0,__self:!0,__source:!0};function tV(e,t,n){var o,u={},h=null,p=null;if(t!=null)for(o in t.ref!==void 0&&(p=t.ref),t.key!==void 0&&(h=""+t.key),t)JU.call(t,o)&&!eV.hasOwnProperty(o)&&(u[o]=t[o]);var _=arguments.length-2;if(_===1)u.children=n;else if(1<_){for(var a=Array(_),b=0;b<_;b++)a[b]=arguments[b+2];u.children=a}if(e&&e.defaultProps)for(o in _=e.defaultProps,_)u[o]===void 0&&(u[o]=_[o]);return{$$typeof:fx,type:e,key:h,ref:p,props:u,_owner:vR.current}}function W2(e,t){return{$$typeof:fx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xR(e){return typeof e=="object"&&e!==null&&e.$$typeof===fx}function H2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var nB=/\/+/g;function MP(e,t){return typeof e=="object"&&e!==null&&e.key!=null?H2(""+e.key):t.toString(36)}function Uw(e,t,n,o,u){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(h){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case fx:case D2:p=!0}}if(p)return p=e,u=u(p),e=o===""?"."+MP(p,0):o,tB(u)?(n="",e!=null&&(n=e.replace(nB,"$&/")+"/"),Uw(u,t,n,"",function(b){return b})):u!=null&&(xR(u)&&(u=W2(u,n+(!u.key||p&&p.key===u.key?"":(""+u.key).replace(nB,"$&/")+"/")+e)),t.push(u)),1;if(p=0,o=o===""?".":o+":",tB(e))for(var _=0;_<e.length;_++){h=e[_];var a=o+MP(h,_);p+=Uw(h,t,n,a,u)}else if(a=G2(e),typeof a=="function")for(e=a.call(e),_=0;!(h=e.next()).done;)h=h.value,a=o+MP(h,_++),p+=Uw(h,t,n,a,u);else if(h==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return p}function Gb(e,t,n){if(e==null)return e;var o=[],u=0;return Uw(e,o,"","",function(h){return t.call(n,h,u++)}),o}function q2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ko={current:null},Vw={transition:null},Z2={ReactCurrentDispatcher:Ko,ReactCurrentBatchConfig:Vw,ReactCurrentOwner:vR};function nV(){throw Error("act(...) is not supported in production builds of React.")}yr.Children={map:Gb,forEach:function(e,t,n){Gb(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Gb(e,function(){t++}),t},toArray:function(e){return Gb(e,function(t){return t})||[]},only:function(e){if(!xR(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};yr.Component=Bg;yr.Fragment=L2;yr.Profiler=F2;yr.PureComponent=yR;yr.StrictMode=z2;yr.Suspense=$2;yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z2;yr.act=nV;yr.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=YU({},e.props),u=e.key,h=e.ref,p=e._owner;if(t!=null){if(t.ref!==void 0&&(h=t.ref,p=vR.current),t.key!==void 0&&(u=""+t.key),e.type&&e.type.defaultProps)var _=e.type.defaultProps;for(a in t)JU.call(t,a)&&!eV.hasOwnProperty(a)&&(o[a]=t[a]===void 0&&_!==void 0?_[a]:t[a])}var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){_=Array(a);for(var b=0;b<a;b++)_[b]=arguments[b+2];o.children=_}return{$$typeof:fx,type:e.type,key:u,ref:h,props:o,_owner:p}};yr.createContext=function(e){return e={$$typeof:B2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:N2,_context:e},e.Consumer=e};yr.createElement=tV;yr.createFactory=function(e){var t=tV.bind(null,e);return t.type=e,t};yr.createRef=function(){return{current:null}};yr.forwardRef=function(e){return{$$typeof:j2,render:e}};yr.isValidElement=xR;yr.lazy=function(e){return{$$typeof:V2,_payload:{_status:-1,_result:e},_init:q2}};yr.memo=function(e,t){return{$$typeof:U2,type:e,compare:t===void 0?null:t}};yr.startTransition=function(e){var t=Vw.transition;Vw.transition={};try{e()}finally{Vw.transition=t}};yr.unstable_act=nV;yr.useCallback=function(e,t){return Ko.current.useCallback(e,t)};yr.useContext=function(e){return Ko.current.useContext(e)};yr.useDebugValue=function(){};yr.useDeferredValue=function(e){return Ko.current.useDeferredValue(e)};yr.useEffect=function(e,t){return Ko.current.useEffect(e,t)};yr.useId=function(){return Ko.current.useId()};yr.useImperativeHandle=function(e,t,n){return Ko.current.useImperativeHandle(e,t,n)};yr.useInsertionEffect=function(e,t){return Ko.current.useInsertionEffect(e,t)};yr.useLayoutEffect=function(e,t){return Ko.current.useLayoutEffect(e,t)};yr.useMemo=function(e,t){return Ko.current.useMemo(e,t)};yr.useReducer=function(e,t,n){return Ko.current.useReducer(e,t,n)};yr.useRef=function(e){return Ko.current.useRef(e)};yr.useState=function(e){return Ko.current.useState(e)};yr.useSyncExternalStore=function(e,t,n){return Ko.current.useSyncExternalStore(e,t,n)};yr.useTransition=function(){return Ko.current.useTransition()};yr.version="18.3.1";ZU.exports=yr;var W=ZU.exports;const Ye=Vr(W),bR=k2({__proto__:null,default:Ye},[W]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X2=W,Y2=Symbol.for("react.element"),K2=Symbol.for("react.fragment"),Q2=Object.prototype.hasOwnProperty,J2=X2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eee={key:!0,ref:!0,__self:!0,__source:!0};function rV(e,t,n){var o,u={},h=null,p=null;n!==void 0&&(h=""+n),t.key!==void 0&&(h=""+t.key),t.ref!==void 0&&(p=t.ref);for(o in t)Q2.call(t,o)&&!eee.hasOwnProperty(o)&&(u[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)u[o]===void 0&&(u[o]=t[o]);return{$$typeof:Y2,type:e,key:h,ref:p,props:u,_owner:J2.current}}jT.Fragment=K2;jT.jsx=rV;jT.jsxs=rV;qU.exports=jT;var re=qU.exports,dI={},iV={exports:{}},Wa={},oV={exports:{}},aV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ze,Xe){var de=Ze.length;Ze.push(Xe);e:for(;0<de;){var lt=de-1>>>1,gt=Ze[lt];if(0<u(gt,Xe))Ze[lt]=Xe,Ze[de]=gt,de=lt;else break e}}function n(Ze){return Ze.length===0?null:Ze[0]}function o(Ze){if(Ze.length===0)return null;var Xe=Ze[0],de=Ze.pop();if(de!==Xe){Ze[0]=de;e:for(var lt=0,gt=Ze.length,Se=gt>>>1;lt<Se;){var qt=2*(lt+1)-1,an=Ze[qt],dn=qt+1,Wt=Ze[dn];if(0>u(an,de))dn<gt&&0>u(Wt,an)?(Ze[lt]=Wt,Ze[dn]=de,lt=dn):(Ze[lt]=an,Ze[qt]=de,lt=qt);else if(dn<gt&&0>u(Wt,de))Ze[lt]=Wt,Ze[dn]=de,lt=dn;else break e}}return Xe}function u(Ze,Xe){var de=Ze.sortIndex-Xe.sortIndex;return de!==0?de:Ze.id-Xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var p=Date,_=p.now();e.unstable_now=function(){return p.now()-_}}var a=[],b=[],C=1,A=null,O=3,k=!1,N=!1,z=!1,U=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(Ze){for(var Xe=n(b);Xe!==null;){if(Xe.callback===null)o(b);else if(Xe.startTime<=Ze)o(b),Xe.sortIndex=Xe.expirationTime,t(a,Xe);else break;Xe=n(b)}}function Y(Ze){if(z=!1,H(Ze),!N)if(n(a)!==null)N=!0,st(K);else{var Xe=n(b);Xe!==null&&Ke(Y,Xe.startTime-Ze)}}function K(Ze,Xe){N=!1,z&&(z=!1,j(ve),ve=-1),k=!0;var de=O;try{for(H(Xe),A=n(a);A!==null&&(!(A.expirationTime>Xe)||Ze&&!Oe());){var lt=A.callback;if(typeof lt=="function"){A.callback=null,O=A.priorityLevel;var gt=lt(A.expirationTime<=Xe);Xe=e.unstable_now(),typeof gt=="function"?A.callback=gt:A===n(a)&&o(a),H(Xe)}else o(a);A=n(a)}if(A!==null)var Se=!0;else{var qt=n(b);qt!==null&&Ke(Y,qt.startTime-Xe),Se=!1}return Se}finally{A=null,O=de,k=!1}}var ee=!1,ue=null,ve=-1,Fe=5,Ne=-1;function Oe(){return!(e.unstable_now()-Ne<Fe)}function Le(){if(ue!==null){var Ze=e.unstable_now();Ne=Ze;var Xe=!0;try{Xe=ue(!0,Ze)}finally{Xe?Ue():(ee=!1,ue=null)}}else ee=!1}var Ue;if(typeof G=="function")Ue=function(){G(Le)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,rt=et.port2;et.port1.onmessage=Le,Ue=function(){rt.postMessage(null)}}else Ue=function(){U(Le,0)};function st(Ze){ue=Ze,ee||(ee=!0,Ue())}function Ke(Ze,Xe){ve=U(function(){Ze(e.unstable_now())},Xe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ze){Ze.callback=null},e.unstable_continueExecution=function(){N||k||(N=!0,st(K))},e.unstable_forceFrameRate=function(Ze){0>Ze||125<Ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Fe=0<Ze?Math.floor(1e3/Ze):5},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return n(a)},e.unstable_next=function(Ze){switch(O){case 1:case 2:case 3:var Xe=3;break;default:Xe=O}var de=O;O=Xe;try{return Ze()}finally{O=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ze,Xe){switch(Ze){case 1:case 2:case 3:case 4:case 5:break;default:Ze=3}var de=O;O=Ze;try{return Xe()}finally{O=de}},e.unstable_scheduleCallback=function(Ze,Xe,de){var lt=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?lt+de:lt):de=lt,Ze){case 1:var gt=-1;break;case 2:gt=250;break;case 5:gt=1073741823;break;case 4:gt=1e4;break;default:gt=5e3}return gt=de+gt,Ze={id:C++,callback:Xe,priorityLevel:Ze,startTime:de,expirationTime:gt,sortIndex:-1},de>lt?(Ze.sortIndex=de,t(b,Ze),n(a)===null&&Ze===n(b)&&(z?(j(ve),ve=-1):z=!0,Ke(Y,de-lt))):(Ze.sortIndex=gt,t(a,Ze),N||k||(N=!0,st(K))),Ze},e.unstable_shouldYield=Oe,e.unstable_wrapCallback=function(Ze){var Xe=O;return function(){var de=O;O=Xe;try{return Ze.apply(this,arguments)}finally{O=de}}}})(aV);oV.exports=aV;var tee=oV.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nee=W,Ua=tee;function Ut(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sV=new Set,o0={};function Wd(e,t){ag(e,t),ag(e+"Capture",t)}function ag(e,t){for(o0[e]=t,e=0;e<t.length;e++)sV.add(t[e])}var $u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pI=Object.prototype.hasOwnProperty,ree=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rB={},iB={};function iee(e){return pI.call(iB,e)?!0:pI.call(rB,e)?!1:ree.test(e)?iB[e]=!0:(rB[e]=!0,!1)}function oee(e,t,n,o){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function aee(e,t,n,o){if(t===null||typeof t>"u"||oee(e,t,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qo(e,t,n,o,u,h,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=u,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=h,this.removeEmptyString=p}var To={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){To[e]=new Qo(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];To[t]=new Qo(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){To[e]=new Qo(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){To[e]=new Qo(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){To[e]=new Qo(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){To[e]=new Qo(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){To[e]=new Qo(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){To[e]=new Qo(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){To[e]=new Qo(e,5,!1,e.toLowerCase(),null,!1,!1)});var wR=/[\-:]([a-z])/g;function SR(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wR,SR);To[t]=new Qo(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wR,SR);To[t]=new Qo(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wR,SR);To[t]=new Qo(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){To[e]=new Qo(e,1,!1,e.toLowerCase(),null,!1,!1)});To.xlinkHref=new Qo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){To[e]=new Qo(e,1,!1,e.toLowerCase(),null,!0,!0)});function TR(e,t,n,o){var u=To.hasOwnProperty(t)?To[t]:null;(u!==null?u.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(aee(t,n,u,o)&&(n=null),o||u===null?iee(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):u.mustUseProperty?e[u.propertyName]=n===null?u.type===3?!1:"":n:(t=u.attributeName,o=u.attributeNamespace,n===null?e.removeAttribute(t):(u=u.type,n=u===3||u===4&&n===!0?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}var Ju=nee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wb=Symbol.for("react.element"),Pm=Symbol.for("react.portal"),Mm=Symbol.for("react.fragment"),ER=Symbol.for("react.strict_mode"),mI=Symbol.for("react.profiler"),lV=Symbol.for("react.provider"),uV=Symbol.for("react.context"),AR=Symbol.for("react.forward_ref"),gI=Symbol.for("react.suspense"),yI=Symbol.for("react.suspense_list"),CR=Symbol.for("react.memo"),dh=Symbol.for("react.lazy"),cV=Symbol.for("react.offscreen"),oB=Symbol.iterator;function ov(e){return e===null||typeof e!="object"?null:(e=oB&&e[oB]||e["@@iterator"],typeof e=="function"?e:null)}var wi=Object.assign,IP;function Iv(e){if(IP===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);IP=t&&t[1]||""}return`
`+IP+e}var OP=!1;function RP(e,t){if(!e||OP)return"";OP=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var o=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){o=b}e.call(t.prototype)}else{try{throw Error()}catch(b){o=b}e()}}catch(b){if(b&&o&&typeof b.stack=="string"){for(var u=b.stack.split(`
`),h=o.stack.split(`
`),p=u.length-1,_=h.length-1;1<=p&&0<=_&&u[p]!==h[_];)_--;for(;1<=p&&0<=_;p--,_--)if(u[p]!==h[_]){if(p!==1||_!==1)do if(p--,_--,0>_||u[p]!==h[_]){var a=`
`+u[p].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=p&&0<=_);break}}}finally{OP=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Iv(e):""}function see(e){switch(e.tag){case 5:return Iv(e.type);case 16:return Iv("Lazy");case 13:return Iv("Suspense");case 19:return Iv("SuspenseList");case 0:case 2:case 15:return e=RP(e.type,!1),e;case 11:return e=RP(e.type.render,!1),e;case 1:return e=RP(e.type,!0),e;default:return""}}function _I(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mm:return"Fragment";case Pm:return"Portal";case mI:return"Profiler";case ER:return"StrictMode";case gI:return"Suspense";case yI:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case uV:return(e.displayName||"Context")+".Consumer";case lV:return(e._context.displayName||"Context")+".Provider";case AR:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case CR:return t=e.displayName||null,t!==null?t:_I(e.type)||"Memo";case dh:t=e._payload,e=e._init;try{return _I(e(t))}catch{}}return null}function lee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _I(t);case 8:return t===ER?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function hV(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function uee(e){var t=hV(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var u=n.get,h=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(p){o=""+p,h.call(this,p)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(p){o=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hb(e){e._valueTracker||(e._valueTracker=uee(e))}function fV(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=hV(e)?e.checked?"true":"false":e.value),e=o,e!==n?(t.setValue(e),!0):!1}function rS(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vI(e,t){var n=t.checked;return wi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function aB(e,t){var n=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;n=Fh(t.value!=null?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function dV(e,t){t=t.checked,t!=null&&TR(e,"checked",t,!1)}function xI(e,t){dV(e,t);var n=Fh(t.value),o=t.type;if(n!=null)o==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bI(e,t.type,n):t.hasOwnProperty("defaultValue")&&bI(e,t.type,Fh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function sB(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function bI(e,t,n){(t!=="number"||rS(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ov=Array.isArray;function Gm(e,t,n,o){if(e=e.options,t){t={};for(var u=0;u<n.length;u++)t["$"+n[u]]=!0;for(n=0;n<e.length;n++)u=t.hasOwnProperty("$"+e[n].value),e[n].selected!==u&&(e[n].selected=u),u&&o&&(e[n].defaultSelected=!0)}else{for(n=""+Fh(n),t=null,u=0;u<e.length;u++){if(e[u].value===n){e[u].selected=!0,o&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function wI(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ut(91));return wi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function lB(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Ut(92));if(Ov(n)){if(1<n.length)throw Error(Ut(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Fh(n)}}function pV(e,t){var n=Fh(t.value),o=Fh(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),o!=null&&(e.defaultValue=""+o)}function uB(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function mV(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function SI(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?mV(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qb,gV=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,o,u){MSApp.execUnsafeLocalFunction(function(){return e(t,n,o,u)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qb=qb||document.createElement("div"),qb.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function a0(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Nv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cee=["Webkit","ms","Moz","O"];Object.keys(Nv).forEach(function(e){cee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Nv[t]=Nv[e]})});function yV(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Nv.hasOwnProperty(e)&&Nv[e]?(""+t).trim():t+"px"}function _V(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var o=n.indexOf("--")===0,u=yV(n,t[n],o);n==="float"&&(n="cssFloat"),o?e.setProperty(n,u):e[n]=u}}var hee=wi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function TI(e,t){if(t){if(hee[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ut(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ut(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ut(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ut(62))}}function EI(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AI=null;function PR(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var CI=null,Wm=null,Hm=null;function cB(e){if(e=mx(e)){if(typeof CI!="function")throw Error(Ut(280));var t=e.stateNode;t&&(t=WT(t),CI(e.stateNode,e.type,t))}}function vV(e){Wm?Hm?Hm.push(e):Hm=[e]:Wm=e}function xV(){if(Wm){var e=Wm,t=Hm;if(Hm=Wm=null,cB(e),t)for(e=0;e<t.length;e++)cB(t[e])}}function bV(e,t){return e(t)}function wV(){}var kP=!1;function SV(e,t,n){if(kP)return e(t,n);kP=!0;try{return bV(e,t,n)}finally{kP=!1,(Wm!==null||Hm!==null)&&(wV(),xV())}}function s0(e,t){var n=e.stateNode;if(n===null)return null;var o=WT(n);if(o===null)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Ut(231,t,typeof n));return n}var PI=!1;if($u)try{var av={};Object.defineProperty(av,"passive",{get:function(){PI=!0}}),window.addEventListener("test",av,av),window.removeEventListener("test",av,av)}catch{PI=!1}function fee(e,t,n,o,u,h,p,_,a){var b=Array.prototype.slice.call(arguments,3);try{t.apply(n,b)}catch(C){this.onError(C)}}var Bv=!1,iS=null,oS=!1,MI=null,dee={onError:function(e){Bv=!0,iS=e}};function pee(e,t,n,o,u,h,p,_,a){Bv=!1,iS=null,fee.apply(dee,arguments)}function mee(e,t,n,o,u,h,p,_,a){if(pee.apply(this,arguments),Bv){if(Bv){var b=iS;Bv=!1,iS=null}else throw Error(Ut(198));oS||(oS=!0,MI=b)}}function Hd(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function TV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hB(e){if(Hd(e)!==e)throw Error(Ut(188))}function gee(e){var t=e.alternate;if(!t){if(t=Hd(e),t===null)throw Error(Ut(188));return t!==e?null:e}for(var n=e,o=t;;){var u=n.return;if(u===null)break;var h=u.alternate;if(h===null){if(o=u.return,o!==null){n=o;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===n)return hB(u),e;if(h===o)return hB(u),t;h=h.sibling}throw Error(Ut(188))}if(n.return!==o.return)n=u,o=h;else{for(var p=!1,_=u.child;_;){if(_===n){p=!0,n=u,o=h;break}if(_===o){p=!0,o=u,n=h;break}_=_.sibling}if(!p){for(_=h.child;_;){if(_===n){p=!0,n=h,o=u;break}if(_===o){p=!0,o=h,n=u;break}_=_.sibling}if(!p)throw Error(Ut(189))}}if(n.alternate!==o)throw Error(Ut(190))}if(n.tag!==3)throw Error(Ut(188));return n.stateNode.current===n?e:t}function EV(e){return e=gee(e),e!==null?AV(e):null}function AV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=AV(e);if(t!==null)return t;e=e.sibling}return null}var CV=Ua.unstable_scheduleCallback,fB=Ua.unstable_cancelCallback,yee=Ua.unstable_shouldYield,_ee=Ua.unstable_requestPaint,Mi=Ua.unstable_now,vee=Ua.unstable_getCurrentPriorityLevel,MR=Ua.unstable_ImmediatePriority,PV=Ua.unstable_UserBlockingPriority,aS=Ua.unstable_NormalPriority,xee=Ua.unstable_LowPriority,MV=Ua.unstable_IdlePriority,$T=null,jl=null;function bee(e){if(jl&&typeof jl.onCommitFiberRoot=="function")try{jl.onCommitFiberRoot($T,e,void 0,(e.current.flags&128)===128)}catch{}}var el=Math.clz32?Math.clz32:Tee,wee=Math.log,See=Math.LN2;function Tee(e){return e>>>=0,e===0?32:31-(wee(e)/See|0)|0}var Zb=64,Xb=4194304;function Rv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sS(e,t){var n=e.pendingLanes;if(n===0)return 0;var o=0,u=e.suspendedLanes,h=e.pingedLanes,p=n&268435455;if(p!==0){var _=p&~u;_!==0?o=Rv(_):(h&=p,h!==0&&(o=Rv(h)))}else p=n&~u,p!==0?o=Rv(p):h!==0&&(o=Rv(h));if(o===0)return 0;if(t!==0&&t!==o&&!(t&u)&&(u=o&-o,h=t&-t,u>=h||u===16&&(h&4194240)!==0))return t;if(o&4&&(o|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)n=31-el(t),u=1<<n,o|=e[n],t&=~u;return o}function Eee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Aee(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,u=e.expirationTimes,h=e.pendingLanes;0<h;){var p=31-el(h),_=1<<p,a=u[p];a===-1?(!(_&n)||_&o)&&(u[p]=Eee(_,t)):a<=t&&(e.expiredLanes|=_),h&=~_}}function II(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function IV(){var e=Zb;return Zb<<=1,!(Zb&4194240)&&(Zb=64),e}function DP(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function dx(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-el(t),e[t]=n}function Cee(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var u=31-el(n),h=1<<u;t[u]=0,o[u]=-1,e[u]=-1,n&=~h}}function IR(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-el(n),u=1<<o;u&t|e[o]&t&&(e[o]|=t),n&=~u}}var Wr=0;function OV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var RV,OR,kV,DV,LV,OI=!1,Yb=[],Eh=null,Ah=null,Ch=null,l0=new Map,u0=new Map,gh=[],Pee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dB(e,t){switch(e){case"focusin":case"focusout":Eh=null;break;case"dragenter":case"dragleave":Ah=null;break;case"mouseover":case"mouseout":Ch=null;break;case"pointerover":case"pointerout":l0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":u0.delete(t.pointerId)}}function sv(e,t,n,o,u,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:h,targetContainers:[u]},t!==null&&(t=mx(t),t!==null&&OR(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function Mee(e,t,n,o,u){switch(t){case"focusin":return Eh=sv(Eh,e,t,n,o,u),!0;case"dragenter":return Ah=sv(Ah,e,t,n,o,u),!0;case"mouseover":return Ch=sv(Ch,e,t,n,o,u),!0;case"pointerover":var h=u.pointerId;return l0.set(h,sv(l0.get(h)||null,e,t,n,o,u)),!0;case"gotpointercapture":return h=u.pointerId,u0.set(h,sv(u0.get(h)||null,e,t,n,o,u)),!0}return!1}function zV(e){var t=md(e.target);if(t!==null){var n=Hd(t);if(n!==null){if(t=n.tag,t===13){if(t=TV(n),t!==null){e.blockedOn=t,LV(e.priority,function(){kV(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Gw(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=RI(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);AI=o,n.target.dispatchEvent(o),AI=null}else return t=mx(n),t!==null&&OR(t),e.blockedOn=n,!1;t.shift()}return!0}function pB(e,t,n){Gw(e)&&n.delete(t)}function Iee(){OI=!1,Eh!==null&&Gw(Eh)&&(Eh=null),Ah!==null&&Gw(Ah)&&(Ah=null),Ch!==null&&Gw(Ch)&&(Ch=null),l0.forEach(pB),u0.forEach(pB)}function lv(e,t){e.blockedOn===t&&(e.blockedOn=null,OI||(OI=!0,Ua.unstable_scheduleCallback(Ua.unstable_NormalPriority,Iee)))}function c0(e){function t(u){return lv(u,e)}if(0<Yb.length){lv(Yb[0],e);for(var n=1;n<Yb.length;n++){var o=Yb[n];o.blockedOn===e&&(o.blockedOn=null)}}for(Eh!==null&&lv(Eh,e),Ah!==null&&lv(Ah,e),Ch!==null&&lv(Ch,e),l0.forEach(t),u0.forEach(t),n=0;n<gh.length;n++)o=gh[n],o.blockedOn===e&&(o.blockedOn=null);for(;0<gh.length&&(n=gh[0],n.blockedOn===null);)zV(n),n.blockedOn===null&&gh.shift()}var qm=Ju.ReactCurrentBatchConfig,lS=!0;function Oee(e,t,n,o){var u=Wr,h=qm.transition;qm.transition=null;try{Wr=1,RR(e,t,n,o)}finally{Wr=u,qm.transition=h}}function Ree(e,t,n,o){var u=Wr,h=qm.transition;qm.transition=null;try{Wr=4,RR(e,t,n,o)}finally{Wr=u,qm.transition=h}}function RR(e,t,n,o){if(lS){var u=RI(e,t,n,o);if(u===null)GP(e,t,o,uS,n),dB(e,o);else if(Mee(u,e,t,n,o))o.stopPropagation();else if(dB(e,o),t&4&&-1<Pee.indexOf(e)){for(;u!==null;){var h=mx(u);if(h!==null&&RV(h),h=RI(e,t,n,o),h===null&&GP(e,t,o,uS,n),h===u)break;u=h}u!==null&&o.stopPropagation()}else GP(e,t,o,null,n)}}var uS=null;function RI(e,t,n,o){if(uS=null,e=PR(o),e=md(e),e!==null)if(t=Hd(e),t===null)e=null;else if(n=t.tag,n===13){if(e=TV(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return uS=e,null}function FV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vee()){case MR:return 1;case PV:return 4;case aS:case xee:return 16;case MV:return 536870912;default:return 16}default:return 16}}var vh=null,kR=null,Ww=null;function NV(){if(Ww)return Ww;var e,t=kR,n=t.length,o,u="value"in vh?vh.value:vh.textContent,h=u.length;for(e=0;e<n&&t[e]===u[e];e++);var p=n-e;for(o=1;o<=p&&t[n-o]===u[h-o];o++);return Ww=u.slice(e,1<o?1-o:void 0)}function Hw(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Kb(){return!0}function mB(){return!1}function Ha(e){function t(n,o,u,h,p){this._reactName=n,this._targetInst=u,this.type=o,this.nativeEvent=h,this.target=p,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Kb:mB,this.isPropagationStopped=mB,this}return wi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kb)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kb)},persist:function(){},isPersistent:Kb}),t}var jg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},DR=Ha(jg),px=wi({},jg,{view:0,detail:0}),kee=Ha(px),LP,zP,uv,UT=wi({},px,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LR,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==uv&&(uv&&e.type==="mousemove"?(LP=e.screenX-uv.screenX,zP=e.screenY-uv.screenY):zP=LP=0,uv=e),LP)},movementY:function(e){return"movementY"in e?e.movementY:zP}}),gB=Ha(UT),Dee=wi({},UT,{dataTransfer:0}),Lee=Ha(Dee),zee=wi({},px,{relatedTarget:0}),FP=Ha(zee),Fee=wi({},jg,{animationName:0,elapsedTime:0,pseudoElement:0}),Nee=Ha(Fee),Bee=wi({},jg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jee=Ha(Bee),$ee=wi({},jg,{data:0}),yB=Ha($ee),Uee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wee(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Gee[e])?!!t[e]:!1}function LR(){return Wee}var Hee=wi({},px,{key:function(e){if(e.key){var t=Uee[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Hw(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Vee[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LR,charCode:function(e){return e.type==="keypress"?Hw(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Hw(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),qee=Ha(Hee),Zee=wi({},UT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_B=Ha(Zee),Xee=wi({},px,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LR}),Yee=Ha(Xee),Kee=wi({},jg,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qee=Ha(Kee),Jee=wi({},UT,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ete=Ha(Jee),tte=[9,13,27,32],zR=$u&&"CompositionEvent"in window,jv=null;$u&&"documentMode"in document&&(jv=document.documentMode);var nte=$u&&"TextEvent"in window&&!jv,BV=$u&&(!zR||jv&&8<jv&&11>=jv),vB=" ",xB=!1;function jV(e,t){switch(e){case"keyup":return tte.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $V(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Im=!1;function rte(e,t){switch(e){case"compositionend":return $V(t);case"keypress":return t.which!==32?null:(xB=!0,vB);case"textInput":return e=t.data,e===vB&&xB?null:e;default:return null}}function ite(e,t){if(Im)return e==="compositionend"||!zR&&jV(e,t)?(e=NV(),Ww=kR=vh=null,Im=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return BV&&t.locale!=="ko"?null:t.data;default:return null}}var ote={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bB(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ote[e.type]:t==="textarea"}function UV(e,t,n,o){vV(o),t=cS(t,"onChange"),0<t.length&&(n=new DR("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var $v=null,h0=null;function ate(e){JV(e,0)}function VT(e){var t=km(e);if(fV(t))return e}function ste(e,t){if(e==="change")return t}var VV=!1;if($u){var NP;if($u){var BP="oninput"in document;if(!BP){var wB=document.createElement("div");wB.setAttribute("oninput","return;"),BP=typeof wB.oninput=="function"}NP=BP}else NP=!1;VV=NP&&(!document.documentMode||9<document.documentMode)}function SB(){$v&&($v.detachEvent("onpropertychange",GV),h0=$v=null)}function GV(e){if(e.propertyName==="value"&&VT(h0)){var t=[];UV(t,h0,e,PR(e)),SV(ate,t)}}function lte(e,t,n){e==="focusin"?(SB(),$v=t,h0=n,$v.attachEvent("onpropertychange",GV)):e==="focusout"&&SB()}function ute(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return VT(h0)}function cte(e,t){if(e==="click")return VT(t)}function hte(e,t){if(e==="input"||e==="change")return VT(t)}function fte(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var il=typeof Object.is=="function"?Object.is:fte;function f0(e,t){if(il(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var u=n[o];if(!pI.call(t,u)||!il(e[u],t[u]))return!1}return!0}function TB(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function EB(e,t){var n=TB(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=t&&o>=t)return{node:n,offset:t-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=TB(n)}}function WV(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?WV(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function HV(){for(var e=window,t=rS();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=rS(e.document)}return t}function FR(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dte(e){var t=HV(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&WV(n.ownerDocument.documentElement,n)){if(o!==null&&FR(n)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var u=n.textContent.length,h=Math.min(o.start,u);o=o.end===void 0?h:Math.min(o.end,u),!e.extend&&h>o&&(u=o,o=h,h=u),u=EB(n,h);var p=EB(n,o);u&&p&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(u.node,u.offset),e.removeAllRanges(),h>o?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pte=$u&&"documentMode"in document&&11>=document.documentMode,Om=null,kI=null,Uv=null,DI=!1;function AB(e,t,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;DI||Om==null||Om!==rS(o)||(o=Om,"selectionStart"in o&&FR(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Uv&&f0(Uv,o)||(Uv=o,o=cS(kI,"onSelect"),0<o.length&&(t=new DR("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=Om)))}function Qb(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Rm={animationend:Qb("Animation","AnimationEnd"),animationiteration:Qb("Animation","AnimationIteration"),animationstart:Qb("Animation","AnimationStart"),transitionend:Qb("Transition","TransitionEnd")},jP={},qV={};$u&&(qV=document.createElement("div").style,"AnimationEvent"in window||(delete Rm.animationend.animation,delete Rm.animationiteration.animation,delete Rm.animationstart.animation),"TransitionEvent"in window||delete Rm.transitionend.transition);function GT(e){if(jP[e])return jP[e];if(!Rm[e])return e;var t=Rm[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in qV)return jP[e]=t[n];return e}var ZV=GT("animationend"),XV=GT("animationiteration"),YV=GT("animationstart"),KV=GT("transitionend"),QV=new Map,CB="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vh(e,t){QV.set(e,t),Wd(t,[e])}for(var $P=0;$P<CB.length;$P++){var UP=CB[$P],mte=UP.toLowerCase(),gte=UP[0].toUpperCase()+UP.slice(1);Vh(mte,"on"+gte)}Vh(ZV,"onAnimationEnd");Vh(XV,"onAnimationIteration");Vh(YV,"onAnimationStart");Vh("dblclick","onDoubleClick");Vh("focusin","onFocus");Vh("focusout","onBlur");Vh(KV,"onTransitionEnd");ag("onMouseEnter",["mouseout","mouseover"]);ag("onMouseLeave",["mouseout","mouseover"]);ag("onPointerEnter",["pointerout","pointerover"]);ag("onPointerLeave",["pointerout","pointerover"]);Wd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yte=new Set("cancel close invalid load scroll toggle".split(" ").concat(kv));function PB(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,mee(o,t,void 0,e),e.currentTarget=null}function JV(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],u=o.event;o=o.listeners;e:{var h=void 0;if(t)for(var p=o.length-1;0<=p;p--){var _=o[p],a=_.instance,b=_.currentTarget;if(_=_.listener,a!==h&&u.isPropagationStopped())break e;PB(u,_,b),h=a}else for(p=0;p<o.length;p++){if(_=o[p],a=_.instance,b=_.currentTarget,_=_.listener,a!==h&&u.isPropagationStopped())break e;PB(u,_,b),h=a}}}if(oS)throw e=MI,oS=!1,MI=null,e}function si(e,t){var n=t[BI];n===void 0&&(n=t[BI]=new Set);var o=e+"__bubble";n.has(o)||(e8(t,e,2,!1),n.add(o))}function VP(e,t,n){var o=0;t&&(o|=4),e8(n,e,o,t)}var Jb="_reactListening"+Math.random().toString(36).slice(2);function d0(e){if(!e[Jb]){e[Jb]=!0,sV.forEach(function(n){n!=="selectionchange"&&(yte.has(n)||VP(n,!1,e),VP(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jb]||(t[Jb]=!0,VP("selectionchange",!1,t))}}function e8(e,t,n,o){switch(FV(t)){case 1:var u=Oee;break;case 4:u=Ree;break;default:u=RR}n=u.bind(null,t,n,e),u=void 0,!PI||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),o?u!==void 0?e.addEventListener(t,n,{capture:!0,passive:u}):e.addEventListener(t,n,!0):u!==void 0?e.addEventListener(t,n,{passive:u}):e.addEventListener(t,n,!1)}function GP(e,t,n,o,u){var h=o;if(!(t&1)&&!(t&2)&&o!==null)e:for(;;){if(o===null)return;var p=o.tag;if(p===3||p===4){var _=o.stateNode.containerInfo;if(_===u||_.nodeType===8&&_.parentNode===u)break;if(p===4)for(p=o.return;p!==null;){var a=p.tag;if((a===3||a===4)&&(a=p.stateNode.containerInfo,a===u||a.nodeType===8&&a.parentNode===u))return;p=p.return}for(;_!==null;){if(p=md(_),p===null)return;if(a=p.tag,a===5||a===6){o=h=p;continue e}_=_.parentNode}}o=o.return}SV(function(){var b=h,C=PR(n),A=[];e:{var O=QV.get(e);if(O!==void 0){var k=DR,N=e;switch(e){case"keypress":if(Hw(n)===0)break e;case"keydown":case"keyup":k=qee;break;case"focusin":N="focus",k=FP;break;case"focusout":N="blur",k=FP;break;case"beforeblur":case"afterblur":k=FP;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=gB;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=Lee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=Yee;break;case ZV:case XV:case YV:k=Nee;break;case KV:k=Qee;break;case"scroll":k=kee;break;case"wheel":k=ete;break;case"copy":case"cut":case"paste":k=jee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=_B}var z=(t&4)!==0,U=!z&&e==="scroll",j=z?O!==null?O+"Capture":null:O;z=[];for(var G=b,H;G!==null;){H=G;var Y=H.stateNode;if(H.tag===5&&Y!==null&&(H=Y,j!==null&&(Y=s0(G,j),Y!=null&&z.push(p0(G,Y,H)))),U)break;G=G.return}0<z.length&&(O=new k(O,N,null,n,C),A.push({event:O,listeners:z}))}}if(!(t&7)){e:{if(O=e==="mouseover"||e==="pointerover",k=e==="mouseout"||e==="pointerout",O&&n!==AI&&(N=n.relatedTarget||n.fromElement)&&(md(N)||N[Uu]))break e;if((k||O)&&(O=C.window===C?C:(O=C.ownerDocument)?O.defaultView||O.parentWindow:window,k?(N=n.relatedTarget||n.toElement,k=b,N=N?md(N):null,N!==null&&(U=Hd(N),N!==U||N.tag!==5&&N.tag!==6)&&(N=null)):(k=null,N=b),k!==N)){if(z=gB,Y="onMouseLeave",j="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(z=_B,Y="onPointerLeave",j="onPointerEnter",G="pointer"),U=k==null?O:km(k),H=N==null?O:km(N),O=new z(Y,G+"leave",k,n,C),O.target=U,O.relatedTarget=H,Y=null,md(C)===b&&(z=new z(j,G+"enter",N,n,C),z.target=H,z.relatedTarget=U,Y=z),U=Y,k&&N)t:{for(z=k,j=N,G=0,H=z;H;H=ym(H))G++;for(H=0,Y=j;Y;Y=ym(Y))H++;for(;0<G-H;)z=ym(z),G--;for(;0<H-G;)j=ym(j),H--;for(;G--;){if(z===j||j!==null&&z===j.alternate)break t;z=ym(z),j=ym(j)}z=null}else z=null;k!==null&&MB(A,O,k,z,!1),N!==null&&U!==null&&MB(A,U,N,z,!0)}}e:{if(O=b?km(b):window,k=O.nodeName&&O.nodeName.toLowerCase(),k==="select"||k==="input"&&O.type==="file")var K=ste;else if(bB(O))if(VV)K=hte;else{K=ute;var ee=lte}else(k=O.nodeName)&&k.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(K=cte);if(K&&(K=K(e,b))){UV(A,K,n,C);break e}ee&&ee(e,O,b),e==="focusout"&&(ee=O._wrapperState)&&ee.controlled&&O.type==="number"&&bI(O,"number",O.value)}switch(ee=b?km(b):window,e){case"focusin":(bB(ee)||ee.contentEditable==="true")&&(Om=ee,kI=b,Uv=null);break;case"focusout":Uv=kI=Om=null;break;case"mousedown":DI=!0;break;case"contextmenu":case"mouseup":case"dragend":DI=!1,AB(A,n,C);break;case"selectionchange":if(pte)break;case"keydown":case"keyup":AB(A,n,C)}var ue;if(zR)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else Im?jV(e,n)&&(ve="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ve="onCompositionStart");ve&&(BV&&n.locale!=="ko"&&(Im||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&Im&&(ue=NV()):(vh=C,kR="value"in vh?vh.value:vh.textContent,Im=!0)),ee=cS(b,ve),0<ee.length&&(ve=new yB(ve,e,null,n,C),A.push({event:ve,listeners:ee}),ue?ve.data=ue:(ue=$V(n),ue!==null&&(ve.data=ue)))),(ue=nte?rte(e,n):ite(e,n))&&(b=cS(b,"onBeforeInput"),0<b.length&&(C=new yB("onBeforeInput","beforeinput",null,n,C),A.push({event:C,listeners:b}),C.data=ue))}JV(A,t)})}function p0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function cS(e,t){for(var n=t+"Capture",o=[];e!==null;){var u=e,h=u.stateNode;u.tag===5&&h!==null&&(u=h,h=s0(e,n),h!=null&&o.unshift(p0(e,h,u)),h=s0(e,t),h!=null&&o.push(p0(e,h,u))),e=e.return}return o}function ym(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function MB(e,t,n,o,u){for(var h=t._reactName,p=[];n!==null&&n!==o;){var _=n,a=_.alternate,b=_.stateNode;if(a!==null&&a===o)break;_.tag===5&&b!==null&&(_=b,u?(a=s0(n,h),a!=null&&p.unshift(p0(n,a,_))):u||(a=s0(n,h),a!=null&&p.push(p0(n,a,_)))),n=n.return}p.length!==0&&e.push({event:t,listeners:p})}var _te=/\r\n?/g,vte=/\u0000|\uFFFD/g;function IB(e){return(typeof e=="string"?e:""+e).replace(_te,`
`).replace(vte,"")}function ew(e,t,n){if(t=IB(t),IB(e)!==t&&n)throw Error(Ut(425))}function hS(){}var LI=null,zI=null;function FI(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var NI=typeof setTimeout=="function"?setTimeout:void 0,xte=typeof clearTimeout=="function"?clearTimeout:void 0,OB=typeof Promise=="function"?Promise:void 0,bte=typeof queueMicrotask=="function"?queueMicrotask:typeof OB<"u"?function(e){return OB.resolve(null).then(e).catch(wte)}:NI;function wte(e){setTimeout(function(){throw e})}function WP(e,t){var n=t,o=0;do{var u=n.nextSibling;if(e.removeChild(n),u&&u.nodeType===8)if(n=u.data,n==="/$"){if(o===0){e.removeChild(u),c0(t);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=u}while(n);c0(t)}function Ph(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function RB(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var $g=Math.random().toString(36).slice(2),Ll="__reactFiber$"+$g,m0="__reactProps$"+$g,Uu="__reactContainer$"+$g,BI="__reactEvents$"+$g,Ste="__reactListeners$"+$g,Tte="__reactHandles$"+$g;function md(e){var t=e[Ll];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Uu]||n[Ll]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=RB(e);e!==null;){if(n=e[Ll])return n;e=RB(e)}return t}e=n,n=e.parentNode}return null}function mx(e){return e=e[Ll]||e[Uu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function km(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ut(33))}function WT(e){return e[m0]||null}var jI=[],Dm=-1;function Gh(e){return{current:e}}function ci(e){0>Dm||(e.current=jI[Dm],jI[Dm]=null,Dm--)}function ri(e,t){Dm++,jI[Dm]=e.current,e.current=t}var Nh={},Bo=Gh(Nh),ga=Gh(!1),Od=Nh;function sg(e,t){var n=e.type.contextTypes;if(!n)return Nh;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in n)u[h]=t[h];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=u),u}function ya(e){return e=e.childContextTypes,e!=null}function fS(){ci(ga),ci(Bo)}function kB(e,t,n){if(Bo.current!==Nh)throw Error(Ut(168));ri(Bo,t),ri(ga,n)}function t8(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var u in o)if(!(u in t))throw Error(Ut(108,lee(e)||"Unknown",u));return wi({},n,o)}function dS(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nh,Od=Bo.current,ri(Bo,e),ri(ga,ga.current),!0}function DB(e,t,n){var o=e.stateNode;if(!o)throw Error(Ut(169));n?(e=t8(e,t,Od),o.__reactInternalMemoizedMergedChildContext=e,ci(ga),ci(Bo),ri(Bo,e)):ci(ga),ri(ga,n)}var Iu=null,HT=!1,HP=!1;function n8(e){Iu===null?Iu=[e]:Iu.push(e)}function Ete(e){HT=!0,n8(e)}function Wh(){if(!HP&&Iu!==null){HP=!0;var e=0,t=Wr;try{var n=Iu;for(Wr=1;e<n.length;e++){var o=n[e];do o=o(!0);while(o!==null)}Iu=null,HT=!1}catch(u){throw Iu!==null&&(Iu=Iu.slice(e+1)),CV(MR,Wh),u}finally{Wr=t,HP=!1}}return null}var Lm=[],zm=0,pS=null,mS=0,fs=[],ds=0,Rd=null,Ou=1,Ru="";function sd(e,t){Lm[zm++]=mS,Lm[zm++]=pS,pS=e,mS=t}function r8(e,t,n){fs[ds++]=Ou,fs[ds++]=Ru,fs[ds++]=Rd,Rd=e;var o=Ou;e=Ru;var u=32-el(o)-1;o&=~(1<<u),n+=1;var h=32-el(t)+u;if(30<h){var p=u-u%5;h=(o&(1<<p)-1).toString(32),o>>=p,u-=p,Ou=1<<32-el(t)+u|n<<u|o,Ru=h+e}else Ou=1<<h|n<<u|o,Ru=e}function NR(e){e.return!==null&&(sd(e,1),r8(e,1,0))}function BR(e){for(;e===pS;)pS=Lm[--zm],Lm[zm]=null,mS=Lm[--zm],Lm[zm]=null;for(;e===Rd;)Rd=fs[--ds],fs[ds]=null,Ru=fs[--ds],fs[ds]=null,Ou=fs[--ds],fs[ds]=null}var ja=null,Na=null,pi=!1,Ks=null;function i8(e,t){var n=gs(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function LB(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ja=e,Na=Ph(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ja=e,Na=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Rd!==null?{id:Ou,overflow:Ru}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=gs(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ja=e,Na=null,!0):!1;default:return!1}}function $I(e){return(e.mode&1)!==0&&(e.flags&128)===0}function UI(e){if(pi){var t=Na;if(t){var n=t;if(!LB(e,t)){if($I(e))throw Error(Ut(418));t=Ph(n.nextSibling);var o=ja;t&&LB(e,t)?i8(o,n):(e.flags=e.flags&-4097|2,pi=!1,ja=e)}}else{if($I(e))throw Error(Ut(418));e.flags=e.flags&-4097|2,pi=!1,ja=e}}}function zB(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ja=e}function tw(e){if(e!==ja)return!1;if(!pi)return zB(e),pi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!FI(e.type,e.memoizedProps)),t&&(t=Na)){if($I(e))throw o8(),Error(Ut(418));for(;t;)i8(e,t),t=Ph(t.nextSibling)}if(zB(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ut(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Na=Ph(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Na=null}}else Na=ja?Ph(e.stateNode.nextSibling):null;return!0}function o8(){for(var e=Na;e;)e=Ph(e.nextSibling)}function lg(){Na=ja=null,pi=!1}function jR(e){Ks===null?Ks=[e]:Ks.push(e)}var Ate=Ju.ReactCurrentBatchConfig;function cv(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ut(309));var o=n.stateNode}if(!o)throw Error(Ut(147,e));var u=o,h=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===h?t.ref:(t=function(p){var _=u.refs;p===null?delete _[h]:_[h]=p},t._stringRef=h,t)}if(typeof e!="string")throw Error(Ut(284));if(!n._owner)throw Error(Ut(290,e))}return e}function nw(e,t){throw e=Object.prototype.toString.call(t),Error(Ut(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function FB(e){var t=e._init;return t(e._payload)}function a8(e){function t(j,G){if(e){var H=j.deletions;H===null?(j.deletions=[G],j.flags|=16):H.push(G)}}function n(j,G){if(!e)return null;for(;G!==null;)t(j,G),G=G.sibling;return null}function o(j,G){for(j=new Map;G!==null;)G.key!==null?j.set(G.key,G):j.set(G.index,G),G=G.sibling;return j}function u(j,G){return j=Rh(j,G),j.index=0,j.sibling=null,j}function h(j,G,H){return j.index=H,e?(H=j.alternate,H!==null?(H=H.index,H<G?(j.flags|=2,G):H):(j.flags|=2,G)):(j.flags|=1048576,G)}function p(j){return e&&j.alternate===null&&(j.flags|=2),j}function _(j,G,H,Y){return G===null||G.tag!==6?(G=JP(H,j.mode,Y),G.return=j,G):(G=u(G,H),G.return=j,G)}function a(j,G,H,Y){var K=H.type;return K===Mm?C(j,G,H.props.children,Y,H.key):G!==null&&(G.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===dh&&FB(K)===G.type)?(Y=u(G,H.props),Y.ref=cv(j,G,H),Y.return=j,Y):(Y=Jw(H.type,H.key,H.props,null,j.mode,Y),Y.ref=cv(j,G,H),Y.return=j,Y)}function b(j,G,H,Y){return G===null||G.tag!==4||G.stateNode.containerInfo!==H.containerInfo||G.stateNode.implementation!==H.implementation?(G=eM(H,j.mode,Y),G.return=j,G):(G=u(G,H.children||[]),G.return=j,G)}function C(j,G,H,Y,K){return G===null||G.tag!==7?(G=Ad(H,j.mode,Y,K),G.return=j,G):(G=u(G,H),G.return=j,G)}function A(j,G,H){if(typeof G=="string"&&G!==""||typeof G=="number")return G=JP(""+G,j.mode,H),G.return=j,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Wb:return H=Jw(G.type,G.key,G.props,null,j.mode,H),H.ref=cv(j,null,G),H.return=j,H;case Pm:return G=eM(G,j.mode,H),G.return=j,G;case dh:var Y=G._init;return A(j,Y(G._payload),H)}if(Ov(G)||ov(G))return G=Ad(G,j.mode,H,null),G.return=j,G;nw(j,G)}return null}function O(j,G,H,Y){var K=G!==null?G.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return K!==null?null:_(j,G,""+H,Y);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case Wb:return H.key===K?a(j,G,H,Y):null;case Pm:return H.key===K?b(j,G,H,Y):null;case dh:return K=H._init,O(j,G,K(H._payload),Y)}if(Ov(H)||ov(H))return K!==null?null:C(j,G,H,Y,null);nw(j,H)}return null}function k(j,G,H,Y,K){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return j=j.get(H)||null,_(G,j,""+Y,K);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case Wb:return j=j.get(Y.key===null?H:Y.key)||null,a(G,j,Y,K);case Pm:return j=j.get(Y.key===null?H:Y.key)||null,b(G,j,Y,K);case dh:var ee=Y._init;return k(j,G,H,ee(Y._payload),K)}if(Ov(Y)||ov(Y))return j=j.get(H)||null,C(G,j,Y,K,null);nw(G,Y)}return null}function N(j,G,H,Y){for(var K=null,ee=null,ue=G,ve=G=0,Fe=null;ue!==null&&ve<H.length;ve++){ue.index>ve?(Fe=ue,ue=null):Fe=ue.sibling;var Ne=O(j,ue,H[ve],Y);if(Ne===null){ue===null&&(ue=Fe);break}e&&ue&&Ne.alternate===null&&t(j,ue),G=h(Ne,G,ve),ee===null?K=Ne:ee.sibling=Ne,ee=Ne,ue=Fe}if(ve===H.length)return n(j,ue),pi&&sd(j,ve),K;if(ue===null){for(;ve<H.length;ve++)ue=A(j,H[ve],Y),ue!==null&&(G=h(ue,G,ve),ee===null?K=ue:ee.sibling=ue,ee=ue);return pi&&sd(j,ve),K}for(ue=o(j,ue);ve<H.length;ve++)Fe=k(ue,j,ve,H[ve],Y),Fe!==null&&(e&&Fe.alternate!==null&&ue.delete(Fe.key===null?ve:Fe.key),G=h(Fe,G,ve),ee===null?K=Fe:ee.sibling=Fe,ee=Fe);return e&&ue.forEach(function(Oe){return t(j,Oe)}),pi&&sd(j,ve),K}function z(j,G,H,Y){var K=ov(H);if(typeof K!="function")throw Error(Ut(150));if(H=K.call(H),H==null)throw Error(Ut(151));for(var ee=K=null,ue=G,ve=G=0,Fe=null,Ne=H.next();ue!==null&&!Ne.done;ve++,Ne=H.next()){ue.index>ve?(Fe=ue,ue=null):Fe=ue.sibling;var Oe=O(j,ue,Ne.value,Y);if(Oe===null){ue===null&&(ue=Fe);break}e&&ue&&Oe.alternate===null&&t(j,ue),G=h(Oe,G,ve),ee===null?K=Oe:ee.sibling=Oe,ee=Oe,ue=Fe}if(Ne.done)return n(j,ue),pi&&sd(j,ve),K;if(ue===null){for(;!Ne.done;ve++,Ne=H.next())Ne=A(j,Ne.value,Y),Ne!==null&&(G=h(Ne,G,ve),ee===null?K=Ne:ee.sibling=Ne,ee=Ne);return pi&&sd(j,ve),K}for(ue=o(j,ue);!Ne.done;ve++,Ne=H.next())Ne=k(ue,j,ve,Ne.value,Y),Ne!==null&&(e&&Ne.alternate!==null&&ue.delete(Ne.key===null?ve:Ne.key),G=h(Ne,G,ve),ee===null?K=Ne:ee.sibling=Ne,ee=Ne);return e&&ue.forEach(function(Le){return t(j,Le)}),pi&&sd(j,ve),K}function U(j,G,H,Y){if(typeof H=="object"&&H!==null&&H.type===Mm&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case Wb:e:{for(var K=H.key,ee=G;ee!==null;){if(ee.key===K){if(K=H.type,K===Mm){if(ee.tag===7){n(j,ee.sibling),G=u(ee,H.props.children),G.return=j,j=G;break e}}else if(ee.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===dh&&FB(K)===ee.type){n(j,ee.sibling),G=u(ee,H.props),G.ref=cv(j,ee,H),G.return=j,j=G;break e}n(j,ee);break}else t(j,ee);ee=ee.sibling}H.type===Mm?(G=Ad(H.props.children,j.mode,Y,H.key),G.return=j,j=G):(Y=Jw(H.type,H.key,H.props,null,j.mode,Y),Y.ref=cv(j,G,H),Y.return=j,j=Y)}return p(j);case Pm:e:{for(ee=H.key;G!==null;){if(G.key===ee)if(G.tag===4&&G.stateNode.containerInfo===H.containerInfo&&G.stateNode.implementation===H.implementation){n(j,G.sibling),G=u(G,H.children||[]),G.return=j,j=G;break e}else{n(j,G);break}else t(j,G);G=G.sibling}G=eM(H,j.mode,Y),G.return=j,j=G}return p(j);case dh:return ee=H._init,U(j,G,ee(H._payload),Y)}if(Ov(H))return N(j,G,H,Y);if(ov(H))return z(j,G,H,Y);nw(j,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,G!==null&&G.tag===6?(n(j,G.sibling),G=u(G,H),G.return=j,j=G):(n(j,G),G=JP(H,j.mode,Y),G.return=j,j=G),p(j)):n(j,G)}return U}var ug=a8(!0),s8=a8(!1),gS=Gh(null),yS=null,Fm=null,$R=null;function UR(){$R=Fm=yS=null}function VR(e){var t=gS.current;ci(gS),e._currentValue=t}function VI(e,t,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Zm(e,t){yS=e,$R=Fm=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(pa=!0),e.firstContext=null)}function bs(e){var t=e._currentValue;if($R!==e)if(e={context:e,memoizedValue:t,next:null},Fm===null){if(yS===null)throw Error(Ut(308));Fm=e,yS.dependencies={lanes:0,firstContext:e}}else Fm=Fm.next=e;return t}var gd=null;function GR(e){gd===null?gd=[e]:gd.push(e)}function l8(e,t,n,o){var u=t.interleaved;return u===null?(n.next=n,GR(t)):(n.next=u.next,u.next=n),t.interleaved=n,Vu(e,o)}function Vu(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ph=!1;function WR(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function u8(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mh(e,t,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,Mr&2){var u=o.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),o.pending=t,Vu(e,n)}return u=o.interleaved,u===null?(t.next=t,GR(o)):(t.next=u.next,u.next=t),o.interleaved=t,Vu(e,n)}function qw(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,IR(e,n)}}function NB(e,t){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var u=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};h===null?u=h=p:h=h.next=p,n=n.next}while(n!==null);h===null?u=h=t:h=h.next=t}else u=h=t;n={baseState:o.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:o.shared,effects:o.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function _S(e,t,n,o){var u=e.updateQueue;ph=!1;var h=u.firstBaseUpdate,p=u.lastBaseUpdate,_=u.shared.pending;if(_!==null){u.shared.pending=null;var a=_,b=a.next;a.next=null,p===null?h=b:p.next=b,p=a;var C=e.alternate;C!==null&&(C=C.updateQueue,_=C.lastBaseUpdate,_!==p&&(_===null?C.firstBaseUpdate=b:_.next=b,C.lastBaseUpdate=a))}if(h!==null){var A=u.baseState;p=0,C=b=a=null,_=h;do{var O=_.lane,k=_.eventTime;if((o&O)===O){C!==null&&(C=C.next={eventTime:k,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var N=e,z=_;switch(O=t,k=n,z.tag){case 1:if(N=z.payload,typeof N=="function"){A=N.call(k,A,O);break e}A=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=z.payload,O=typeof N=="function"?N.call(k,A,O):N,O==null)break e;A=wi({},A,O);break e;case 2:ph=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,O=u.effects,O===null?u.effects=[_]:O.push(_))}else k={eventTime:k,lane:O,tag:_.tag,payload:_.payload,callback:_.callback,next:null},C===null?(b=C=k,a=A):C=C.next=k,p|=O;if(_=_.next,_===null){if(_=u.shared.pending,_===null)break;O=_,_=O.next,O.next=null,u.lastBaseUpdate=O,u.shared.pending=null}}while(!0);if(C===null&&(a=A),u.baseState=a,u.firstBaseUpdate=b,u.lastBaseUpdate=C,t=u.shared.interleaved,t!==null){u=t;do p|=u.lane,u=u.next;while(u!==t)}else h===null&&(u.shared.lanes=0);Dd|=p,e.lanes=p,e.memoizedState=A}}function BB(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],u=o.callback;if(u!==null){if(o.callback=null,o=n,typeof u!="function")throw Error(Ut(191,u));u.call(o)}}}var gx={},$l=Gh(gx),g0=Gh(gx),y0=Gh(gx);function yd(e){if(e===gx)throw Error(Ut(174));return e}function HR(e,t){switch(ri(y0,t),ri(g0,e),ri($l,gx),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:SI(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=SI(t,e)}ci($l),ri($l,t)}function cg(){ci($l),ci(g0),ci(y0)}function c8(e){yd(y0.current);var t=yd($l.current),n=SI(t,e.type);t!==n&&(ri(g0,e),ri($l,n))}function qR(e){g0.current===e&&(ci($l),ci(g0))}var vi=Gh(0);function vS(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qP=[];function ZR(){for(var e=0;e<qP.length;e++)qP[e]._workInProgressVersionPrimary=null;qP.length=0}var Zw=Ju.ReactCurrentDispatcher,ZP=Ju.ReactCurrentBatchConfig,kd=0,bi=null,Ji=null,co=null,xS=!1,Vv=!1,_0=0,Cte=0;function Oo(){throw Error(Ut(321))}function XR(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!il(e[n],t[n]))return!1;return!0}function YR(e,t,n,o,u,h){if(kd=h,bi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zw.current=e===null||e.memoizedState===null?Ote:Rte,e=n(o,u),Vv){h=0;do{if(Vv=!1,_0=0,25<=h)throw Error(Ut(301));h+=1,co=Ji=null,t.updateQueue=null,Zw.current=kte,e=n(o,u)}while(Vv)}if(Zw.current=bS,t=Ji!==null&&Ji.next!==null,kd=0,co=Ji=bi=null,xS=!1,t)throw Error(Ut(300));return e}function KR(){var e=_0!==0;return _0=0,e}function Rl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return co===null?bi.memoizedState=co=e:co=co.next=e,co}function ws(){if(Ji===null){var e=bi.alternate;e=e!==null?e.memoizedState:null}else e=Ji.next;var t=co===null?bi.memoizedState:co.next;if(t!==null)co=t,Ji=e;else{if(e===null)throw Error(Ut(310));Ji=e,e={memoizedState:Ji.memoizedState,baseState:Ji.baseState,baseQueue:Ji.baseQueue,queue:Ji.queue,next:null},co===null?bi.memoizedState=co=e:co=co.next=e}return co}function v0(e,t){return typeof t=="function"?t(e):t}function XP(e){var t=ws(),n=t.queue;if(n===null)throw Error(Ut(311));n.lastRenderedReducer=e;var o=Ji,u=o.baseQueue,h=n.pending;if(h!==null){if(u!==null){var p=u.next;u.next=h.next,h.next=p}o.baseQueue=u=h,n.pending=null}if(u!==null){h=u.next,o=o.baseState;var _=p=null,a=null,b=h;do{var C=b.lane;if((kd&C)===C)a!==null&&(a=a.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),o=b.hasEagerState?b.eagerState:e(o,b.action);else{var A={lane:C,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};a===null?(_=a=A,p=o):a=a.next=A,bi.lanes|=C,Dd|=C}b=b.next}while(b!==null&&b!==h);a===null?p=o:a.next=_,il(o,t.memoizedState)||(pa=!0),t.memoizedState=o,t.baseState=p,t.baseQueue=a,n.lastRenderedState=o}if(e=n.interleaved,e!==null){u=e;do h=u.lane,bi.lanes|=h,Dd|=h,u=u.next;while(u!==e)}else u===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function YP(e){var t=ws(),n=t.queue;if(n===null)throw Error(Ut(311));n.lastRenderedReducer=e;var o=n.dispatch,u=n.pending,h=t.memoizedState;if(u!==null){n.pending=null;var p=u=u.next;do h=e(h,p.action),p=p.next;while(p!==u);il(h,t.memoizedState)||(pa=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),n.lastRenderedState=h}return[h,o]}function h8(){}function f8(e,t){var n=bi,o=ws(),u=t(),h=!il(o.memoizedState,u);if(h&&(o.memoizedState=u,pa=!0),o=o.queue,QR(m8.bind(null,n,o,e),[e]),o.getSnapshot!==t||h||co!==null&&co.memoizedState.tag&1){if(n.flags|=2048,x0(9,p8.bind(null,n,o,u,t),void 0,null),ho===null)throw Error(Ut(349));kd&30||d8(n,t,u)}return u}function d8(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=bi.updateQueue,t===null?(t={lastEffect:null,stores:null},bi.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function p8(e,t,n,o){t.value=n,t.getSnapshot=o,g8(t)&&y8(e)}function m8(e,t,n){return n(function(){g8(t)&&y8(e)})}function g8(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!il(e,n)}catch{return!0}}function y8(e){var t=Vu(e,1);t!==null&&tl(t,e,1,-1)}function jB(e){var t=Rl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:v0,lastRenderedState:e},t.queue=e,e=e.dispatch=Ite.bind(null,bi,e),[t.memoizedState,e]}function x0(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},t=bi.updateQueue,t===null?(t={lastEffect:null,stores:null},bi.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e)),e}function _8(){return ws().memoizedState}function Xw(e,t,n,o){var u=Rl();bi.flags|=e,u.memoizedState=x0(1|t,n,void 0,o===void 0?null:o)}function qT(e,t,n,o){var u=ws();o=o===void 0?null:o;var h=void 0;if(Ji!==null){var p=Ji.memoizedState;if(h=p.destroy,o!==null&&XR(o,p.deps)){u.memoizedState=x0(t,n,h,o);return}}bi.flags|=e,u.memoizedState=x0(1|t,n,h,o)}function $B(e,t){return Xw(8390656,8,e,t)}function QR(e,t){return qT(2048,8,e,t)}function v8(e,t){return qT(4,2,e,t)}function x8(e,t){return qT(4,4,e,t)}function b8(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function w8(e,t,n){return n=n!=null?n.concat([e]):null,qT(4,4,b8.bind(null,t,e),n)}function JR(){}function S8(e,t){var n=ws();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&XR(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function T8(e,t){var n=ws();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&XR(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function E8(e,t,n){return kd&21?(il(n,t)||(n=IV(),bi.lanes|=n,Dd|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,pa=!0),e.memoizedState=n)}function Pte(e,t){var n=Wr;Wr=n!==0&&4>n?n:4,e(!0);var o=ZP.transition;ZP.transition={};try{e(!1),t()}finally{Wr=n,ZP.transition=o}}function A8(){return ws().memoizedState}function Mte(e,t,n){var o=Oh(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},C8(e))P8(t,n);else if(n=l8(e,t,n,o),n!==null){var u=Zo();tl(n,e,o,u),M8(n,t,o)}}function Ite(e,t,n){var o=Oh(e),u={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(C8(e))P8(t,u);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var p=t.lastRenderedState,_=h(p,n);if(u.hasEagerState=!0,u.eagerState=_,il(_,p)){var a=t.interleaved;a===null?(u.next=u,GR(t)):(u.next=a.next,a.next=u),t.interleaved=u;return}}catch{}finally{}n=l8(e,t,u,o),n!==null&&(u=Zo(),tl(n,e,o,u),M8(n,t,o))}}function C8(e){var t=e.alternate;return e===bi||t!==null&&t===bi}function P8(e,t){Vv=xS=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function M8(e,t,n){if(n&4194240){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,IR(e,n)}}var bS={readContext:bs,useCallback:Oo,useContext:Oo,useEffect:Oo,useImperativeHandle:Oo,useInsertionEffect:Oo,useLayoutEffect:Oo,useMemo:Oo,useReducer:Oo,useRef:Oo,useState:Oo,useDebugValue:Oo,useDeferredValue:Oo,useTransition:Oo,useMutableSource:Oo,useSyncExternalStore:Oo,useId:Oo,unstable_isNewReconciler:!1},Ote={readContext:bs,useCallback:function(e,t){return Rl().memoizedState=[e,t===void 0?null:t],e},useContext:bs,useEffect:$B,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Xw(4194308,4,b8.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Xw(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xw(4,2,e,t)},useMemo:function(e,t){var n=Rl();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=Rl();return t=n!==void 0?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=Mte.bind(null,bi,e),[o.memoizedState,e]},useRef:function(e){var t=Rl();return e={current:e},t.memoizedState=e},useState:jB,useDebugValue:JR,useDeferredValue:function(e){return Rl().memoizedState=e},useTransition:function(){var e=jB(!1),t=e[0];return e=Pte.bind(null,e[1]),Rl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=bi,u=Rl();if(pi){if(n===void 0)throw Error(Ut(407));n=n()}else{if(n=t(),ho===null)throw Error(Ut(349));kd&30||d8(o,t,n)}u.memoizedState=n;var h={value:n,getSnapshot:t};return u.queue=h,$B(m8.bind(null,o,h,e),[e]),o.flags|=2048,x0(9,p8.bind(null,o,h,n,t),void 0,null),n},useId:function(){var e=Rl(),t=ho.identifierPrefix;if(pi){var n=Ru,o=Ou;n=(o&~(1<<32-el(o)-1)).toString(32)+n,t=":"+t+"R"+n,n=_0++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Cte++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Rte={readContext:bs,useCallback:S8,useContext:bs,useEffect:QR,useImperativeHandle:w8,useInsertionEffect:v8,useLayoutEffect:x8,useMemo:T8,useReducer:XP,useRef:_8,useState:function(){return XP(v0)},useDebugValue:JR,useDeferredValue:function(e){var t=ws();return E8(t,Ji.memoizedState,e)},useTransition:function(){var e=XP(v0)[0],t=ws().memoizedState;return[e,t]},useMutableSource:h8,useSyncExternalStore:f8,useId:A8,unstable_isNewReconciler:!1},kte={readContext:bs,useCallback:S8,useContext:bs,useEffect:QR,useImperativeHandle:w8,useInsertionEffect:v8,useLayoutEffect:x8,useMemo:T8,useReducer:YP,useRef:_8,useState:function(){return YP(v0)},useDebugValue:JR,useDeferredValue:function(e){var t=ws();return Ji===null?t.memoizedState=e:E8(t,Ji.memoizedState,e)},useTransition:function(){var e=YP(v0)[0],t=ws().memoizedState;return[e,t]},useMutableSource:h8,useSyncExternalStore:f8,useId:A8,unstable_isNewReconciler:!1};function Zs(e,t){if(e&&e.defaultProps){t=wi({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function GI(e,t,n,o){t=e.memoizedState,n=n(o,t),n=n==null?t:wi({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ZT={isMounted:function(e){return(e=e._reactInternals)?Hd(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=Zo(),u=Oh(e),h=zu(o,u);h.payload=t,n!=null&&(h.callback=n),t=Mh(e,h,u),t!==null&&(tl(t,e,u,o),qw(t,e,u))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=Zo(),u=Oh(e),h=zu(o,u);h.tag=1,h.payload=t,n!=null&&(h.callback=n),t=Mh(e,h,u),t!==null&&(tl(t,e,u,o),qw(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zo(),o=Oh(e),u=zu(n,o);u.tag=2,t!=null&&(u.callback=t),t=Mh(e,u,o),t!==null&&(tl(t,e,o,n),qw(t,e,o))}};function UB(e,t,n,o,u,h,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,h,p):t.prototype&&t.prototype.isPureReactComponent?!f0(n,o)||!f0(u,h):!0}function I8(e,t,n){var o=!1,u=Nh,h=t.contextType;return typeof h=="object"&&h!==null?h=bs(h):(u=ya(t)?Od:Bo.current,o=t.contextTypes,h=(o=o!=null)?sg(e,u):Nh),t=new t(n,h),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ZT,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=h),t}function VB(e,t,n,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&ZT.enqueueReplaceState(t,t.state,null)}function WI(e,t,n,o){var u=e.stateNode;u.props=n,u.state=e.memoizedState,u.refs={},WR(e);var h=t.contextType;typeof h=="object"&&h!==null?u.context=bs(h):(h=ya(t)?Od:Bo.current,u.context=sg(e,h)),u.state=e.memoizedState,h=t.getDerivedStateFromProps,typeof h=="function"&&(GI(e,t,h,n),u.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(t=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),t!==u.state&&ZT.enqueueReplaceState(u,u.state,null),_S(e,n,u,o),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function hg(e,t){try{var n="",o=t;do n+=see(o),o=o.return;while(o);var u=n}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:t,stack:u,digest:null}}function KP(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function HI(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Dte=typeof WeakMap=="function"?WeakMap:Map;function O8(e,t,n){n=zu(-1,n),n.tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){SS||(SS=!0,nO=o),HI(e,t)},n}function R8(e,t,n){n=zu(-1,n),n.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var u=t.value;n.payload=function(){return o(u)},n.callback=function(){HI(e,t)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(n.callback=function(){HI(e,t),typeof o!="function"&&(Ih===null?Ih=new Set([this]):Ih.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),n}function GB(e,t,n){var o=e.pingCache;if(o===null){o=e.pingCache=new Dte;var u=new Set;o.set(t,u)}else u=o.get(t),u===void 0&&(u=new Set,o.set(t,u));u.has(n)||(u.add(n),e=Zte.bind(null,e,t,n),t.then(e,e))}function WB(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function HB(e,t,n,o,u){return e.mode&1?(e.flags|=65536,e.lanes=u,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=zu(-1,1),t.tag=2,Mh(n,t,1))),n.lanes|=1),e)}var Lte=Ju.ReactCurrentOwner,pa=!1;function Ho(e,t,n,o){t.child=e===null?s8(t,null,n,o):ug(t,e.child,n,o)}function qB(e,t,n,o,u){n=n.render;var h=t.ref;return Zm(t,u),o=YR(e,t,n,o,h,u),n=KR(),e!==null&&!pa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~u,Gu(e,t,u)):(pi&&n&&NR(t),t.flags|=1,Ho(e,t,o,u),t.child)}function ZB(e,t,n,o,u){if(e===null){var h=n.type;return typeof h=="function"&&!sk(h)&&h.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=h,k8(e,t,h,o,u)):(e=Jw(n.type,null,o,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!(e.lanes&u)){var p=h.memoizedProps;if(n=n.compare,n=n!==null?n:f0,n(p,o)&&e.ref===t.ref)return Gu(e,t,u)}return t.flags|=1,e=Rh(h,o),e.ref=t.ref,e.return=t,t.child=e}function k8(e,t,n,o,u){if(e!==null){var h=e.memoizedProps;if(f0(h,o)&&e.ref===t.ref)if(pa=!1,t.pendingProps=o=h,(e.lanes&u)!==0)e.flags&131072&&(pa=!0);else return t.lanes=e.lanes,Gu(e,t,u)}return qI(e,t,n,o,u)}function D8(e,t,n){var o=t.pendingProps,u=o.children,h=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ri(Bm,Da),Da|=n;else{if(!(n&1073741824))return e=h!==null?h.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ri(Bm,Da),Da|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=h!==null?h.baseLanes:n,ri(Bm,Da),Da|=o}else h!==null?(o=h.baseLanes|n,t.memoizedState=null):o=n,ri(Bm,Da),Da|=o;return Ho(e,t,u,n),t.child}function L8(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function qI(e,t,n,o,u){var h=ya(n)?Od:Bo.current;return h=sg(t,h),Zm(t,u),n=YR(e,t,n,o,h,u),o=KR(),e!==null&&!pa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~u,Gu(e,t,u)):(pi&&o&&NR(t),t.flags|=1,Ho(e,t,n,u),t.child)}function XB(e,t,n,o,u){if(ya(n)){var h=!0;dS(t)}else h=!1;if(Zm(t,u),t.stateNode===null)Yw(e,t),I8(t,n,o),WI(t,n,o,u),o=!0;else if(e===null){var p=t.stateNode,_=t.memoizedProps;p.props=_;var a=p.context,b=n.contextType;typeof b=="object"&&b!==null?b=bs(b):(b=ya(n)?Od:Bo.current,b=sg(t,b));var C=n.getDerivedStateFromProps,A=typeof C=="function"||typeof p.getSnapshotBeforeUpdate=="function";A||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(_!==o||a!==b)&&VB(t,p,o,b),ph=!1;var O=t.memoizedState;p.state=O,_S(t,o,p,u),a=t.memoizedState,_!==o||O!==a||ga.current||ph?(typeof C=="function"&&(GI(t,n,C,o),a=t.memoizedState),(_=ph||UB(t,n,_,o,O,a,b))?(A||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=a),p.props=o,p.state=a,p.context=b,o=_):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{p=t.stateNode,u8(e,t),_=t.memoizedProps,b=t.type===t.elementType?_:Zs(t.type,_),p.props=b,A=t.pendingProps,O=p.context,a=n.contextType,typeof a=="object"&&a!==null?a=bs(a):(a=ya(n)?Od:Bo.current,a=sg(t,a));var k=n.getDerivedStateFromProps;(C=typeof k=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(_!==A||O!==a)&&VB(t,p,o,a),ph=!1,O=t.memoizedState,p.state=O,_S(t,o,p,u);var N=t.memoizedState;_!==A||O!==N||ga.current||ph?(typeof k=="function"&&(GI(t,n,k,o),N=t.memoizedState),(b=ph||UB(t,n,b,o,O,N,a)||!1)?(C||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,N,a),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,N,a)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=N),p.props=o,p.state=N,p.context=a,o=b):(typeof p.componentDidUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),o=!1)}return ZI(e,t,n,o,h,u)}function ZI(e,t,n,o,u,h){L8(e,t);var p=(t.flags&128)!==0;if(!o&&!p)return u&&DB(t,n,!1),Gu(e,t,h);o=t.stateNode,Lte.current=t;var _=p&&typeof n.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&p?(t.child=ug(t,e.child,null,h),t.child=ug(t,null,_,h)):Ho(e,t,_,h),t.memoizedState=o.state,u&&DB(t,n,!0),t.child}function z8(e){var t=e.stateNode;t.pendingContext?kB(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kB(e,t.context,!1),HR(e,t.containerInfo)}function YB(e,t,n,o,u){return lg(),jR(u),t.flags|=256,Ho(e,t,n,o),t.child}var XI={dehydrated:null,treeContext:null,retryLane:0};function YI(e){return{baseLanes:e,cachePool:null,transitions:null}}function F8(e,t,n){var o=t.pendingProps,u=vi.current,h=!1,p=(t.flags&128)!==0,_;if((_=p)||(_=e!==null&&e.memoizedState===null?!1:(u&2)!==0),_?(h=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),ri(vi,u&1),e===null)return UI(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(p=o.children,e=o.fallback,h?(o=t.mode,h=t.child,p={mode:"hidden",children:p},!(o&1)&&h!==null?(h.childLanes=0,h.pendingProps=p):h=KT(p,o,0,null),e=Ad(e,o,n,null),h.return=t,e.return=t,h.sibling=e,t.child=h,t.child.memoizedState=YI(n),t.memoizedState=XI,e):ek(t,p));if(u=e.memoizedState,u!==null&&(_=u.dehydrated,_!==null))return zte(e,t,p,o,_,u,n);if(h){h=o.fallback,p=t.mode,u=e.child,_=u.sibling;var a={mode:"hidden",children:o.children};return!(p&1)&&t.child!==u?(o=t.child,o.childLanes=0,o.pendingProps=a,t.deletions=null):(o=Rh(u,a),o.subtreeFlags=u.subtreeFlags&14680064),_!==null?h=Rh(_,h):(h=Ad(h,p,n,null),h.flags|=2),h.return=t,o.return=t,o.sibling=h,t.child=o,o=h,h=t.child,p=e.child.memoizedState,p=p===null?YI(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},h.memoizedState=p,h.childLanes=e.childLanes&~n,t.memoizedState=XI,o}return h=e.child,e=h.sibling,o=Rh(h,{mode:"visible",children:o.children}),!(t.mode&1)&&(o.lanes=n),o.return=t,o.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function ek(e,t){return t=KT({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function rw(e,t,n,o){return o!==null&&jR(o),ug(t,e.child,null,n),e=ek(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function zte(e,t,n,o,u,h,p){if(n)return t.flags&256?(t.flags&=-257,o=KP(Error(Ut(422))),rw(e,t,p,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(h=o.fallback,u=t.mode,o=KT({mode:"visible",children:o.children},u,0,null),h=Ad(h,u,p,null),h.flags|=2,o.return=t,h.return=t,o.sibling=h,t.child=o,t.mode&1&&ug(t,e.child,null,p),t.child.memoizedState=YI(p),t.memoizedState=XI,h);if(!(t.mode&1))return rw(e,t,p,null);if(u.data==="$!"){if(o=u.nextSibling&&u.nextSibling.dataset,o)var _=o.dgst;return o=_,h=Error(Ut(419)),o=KP(h,o,void 0),rw(e,t,p,o)}if(_=(p&e.childLanes)!==0,pa||_){if(o=ho,o!==null){switch(p&-p){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=u&(o.suspendedLanes|p)?0:u,u!==0&&u!==h.retryLane&&(h.retryLane=u,Vu(e,u),tl(o,e,u,-1))}return ak(),o=KP(Error(Ut(421))),rw(e,t,p,o)}return u.data==="$?"?(t.flags|=128,t.child=e.child,t=Xte.bind(null,e),u._reactRetry=t,null):(e=h.treeContext,Na=Ph(u.nextSibling),ja=t,pi=!0,Ks=null,e!==null&&(fs[ds++]=Ou,fs[ds++]=Ru,fs[ds++]=Rd,Ou=e.id,Ru=e.overflow,Rd=t),t=ek(t,o.children),t.flags|=4096,t)}function KB(e,t,n){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),VI(e.return,t,n)}function QP(e,t,n,o,u){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:u}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=o,h.tail=n,h.tailMode=u)}function N8(e,t,n){var o=t.pendingProps,u=o.revealOrder,h=o.tail;if(Ho(e,t,o.children,n),o=vi.current,o&2)o=o&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&KB(e,n,t);else if(e.tag===19)KB(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(ri(vi,o),!(t.mode&1))t.memoizedState=null;else switch(u){case"forwards":for(n=t.child,u=null;n!==null;)e=n.alternate,e!==null&&vS(e)===null&&(u=n),n=n.sibling;n=u,n===null?(u=t.child,t.child=null):(u=n.sibling,n.sibling=null),QP(t,!1,u,n,h);break;case"backwards":for(n=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&vS(e)===null){t.child=u;break}e=u.sibling,u.sibling=n,n=u,u=e}QP(t,!0,n,null,h);break;case"together":QP(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yw(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gu(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Dd|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ut(153));if(t.child!==null){for(e=t.child,n=Rh(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Rh(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Fte(e,t,n){switch(t.tag){case 3:z8(t),lg();break;case 5:c8(t);break;case 1:ya(t.type)&&dS(t);break;case 4:HR(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,u=t.memoizedProps.value;ri(gS,o._currentValue),o._currentValue=u;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(ri(vi,vi.current&1),t.flags|=128,null):n&t.child.childLanes?F8(e,t,n):(ri(vi,vi.current&1),e=Gu(e,t,n),e!==null?e.sibling:null);ri(vi,vi.current&1);break;case 19:if(o=(n&t.childLanes)!==0,e.flags&128){if(o)return N8(e,t,n);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),ri(vi,vi.current),o)break;return null;case 22:case 23:return t.lanes=0,D8(e,t,n)}return Gu(e,t,n)}var B8,KI,j8,$8;B8=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};KI=function(){};j8=function(e,t,n,o){var u=e.memoizedProps;if(u!==o){e=t.stateNode,yd($l.current);var h=null;switch(n){case"input":u=vI(e,u),o=vI(e,o),h=[];break;case"select":u=wi({},u,{value:void 0}),o=wi({},o,{value:void 0}),h=[];break;case"textarea":u=wI(e,u),o=wI(e,o),h=[];break;default:typeof u.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=hS)}TI(n,o);var p;n=null;for(b in u)if(!o.hasOwnProperty(b)&&u.hasOwnProperty(b)&&u[b]!=null)if(b==="style"){var _=u[b];for(p in _)_.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(o0.hasOwnProperty(b)?h||(h=[]):(h=h||[]).push(b,null));for(b in o){var a=o[b];if(_=u!=null?u[b]:void 0,o.hasOwnProperty(b)&&a!==_&&(a!=null||_!=null))if(b==="style")if(_){for(p in _)!_.hasOwnProperty(p)||a&&a.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in a)a.hasOwnProperty(p)&&_[p]!==a[p]&&(n||(n={}),n[p]=a[p])}else n||(h||(h=[]),h.push(b,n)),n=a;else b==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,_=_?_.__html:void 0,a!=null&&_!==a&&(h=h||[]).push(b,a)):b==="children"?typeof a!="string"&&typeof a!="number"||(h=h||[]).push(b,""+a):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(o0.hasOwnProperty(b)?(a!=null&&b==="onScroll"&&si("scroll",e),h||_===a||(h=[])):(h=h||[]).push(b,a))}n&&(h=h||[]).push("style",n);var b=h;(t.updateQueue=b)&&(t.flags|=4)}};$8=function(e,t,n,o){n!==o&&(t.flags|=4)};function hv(e,t){if(!pi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Ro(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(t)for(var u=e.child;u!==null;)n|=u.lanes|u.childLanes,o|=u.subtreeFlags&14680064,o|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)n|=u.lanes|u.childLanes,o|=u.subtreeFlags,o|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Nte(e,t,n){var o=t.pendingProps;switch(BR(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ro(t),null;case 1:return ya(t.type)&&fS(),Ro(t),null;case 3:return o=t.stateNode,cg(),ci(ga),ci(Bo),ZR(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(tw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ks!==null&&(oO(Ks),Ks=null))),KI(e,t),Ro(t),null;case 5:qR(t);var u=yd(y0.current);if(n=t.type,e!==null&&t.stateNode!=null)j8(e,t,n,o,u),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(Ut(166));return Ro(t),null}if(e=yd($l.current),tw(t)){o=t.stateNode,n=t.type;var h=t.memoizedProps;switch(o[Ll]=t,o[m0]=h,e=(t.mode&1)!==0,n){case"dialog":si("cancel",o),si("close",o);break;case"iframe":case"object":case"embed":si("load",o);break;case"video":case"audio":for(u=0;u<kv.length;u++)si(kv[u],o);break;case"source":si("error",o);break;case"img":case"image":case"link":si("error",o),si("load",o);break;case"details":si("toggle",o);break;case"input":aB(o,h),si("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!h.multiple},si("invalid",o);break;case"textarea":lB(o,h),si("invalid",o)}TI(n,h),u=null;for(var p in h)if(h.hasOwnProperty(p)){var _=h[p];p==="children"?typeof _=="string"?o.textContent!==_&&(h.suppressHydrationWarning!==!0&&ew(o.textContent,_,e),u=["children",_]):typeof _=="number"&&o.textContent!==""+_&&(h.suppressHydrationWarning!==!0&&ew(o.textContent,_,e),u=["children",""+_]):o0.hasOwnProperty(p)&&_!=null&&p==="onScroll"&&si("scroll",o)}switch(n){case"input":Hb(o),sB(o,h,!0);break;case"textarea":Hb(o),uB(o);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(o.onclick=hS)}o=u,t.updateQueue=o,o!==null&&(t.flags|=4)}else{p=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=mV(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=p.createElement(n,{is:o.is}):(e=p.createElement(n),n==="select"&&(p=e,o.multiple?p.multiple=!0:o.size&&(p.size=o.size))):e=p.createElementNS(e,n),e[Ll]=t,e[m0]=o,B8(e,t,!1,!1),t.stateNode=e;e:{switch(p=EI(n,o),n){case"dialog":si("cancel",e),si("close",e),u=o;break;case"iframe":case"object":case"embed":si("load",e),u=o;break;case"video":case"audio":for(u=0;u<kv.length;u++)si(kv[u],e);u=o;break;case"source":si("error",e),u=o;break;case"img":case"image":case"link":si("error",e),si("load",e),u=o;break;case"details":si("toggle",e),u=o;break;case"input":aB(e,o),u=vI(e,o),si("invalid",e);break;case"option":u=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},u=wi({},o,{value:void 0}),si("invalid",e);break;case"textarea":lB(e,o),u=wI(e,o),si("invalid",e);break;default:u=o}TI(n,u),_=u;for(h in _)if(_.hasOwnProperty(h)){var a=_[h];h==="style"?_V(e,a):h==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&gV(e,a)):h==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&a0(e,a):typeof a=="number"&&a0(e,""+a):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(o0.hasOwnProperty(h)?a!=null&&h==="onScroll"&&si("scroll",e):a!=null&&TR(e,h,a,p))}switch(n){case"input":Hb(e),sB(e,o,!1);break;case"textarea":Hb(e),uB(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Fh(o.value));break;case"select":e.multiple=!!o.multiple,h=o.value,h!=null?Gm(e,!!o.multiple,h,!1):o.defaultValue!=null&&Gm(e,!!o.multiple,o.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=hS)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ro(t),null;case 6:if(e&&t.stateNode!=null)$8(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(Ut(166));if(n=yd(y0.current),yd($l.current),tw(t)){if(o=t.stateNode,n=t.memoizedProps,o[Ll]=t,(h=o.nodeValue!==n)&&(e=ja,e!==null))switch(e.tag){case 3:ew(o.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ew(o.nodeValue,n,(e.mode&1)!==0)}h&&(t.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[Ll]=t,t.stateNode=o}return Ro(t),null;case 13:if(ci(vi),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pi&&Na!==null&&t.mode&1&&!(t.flags&128))o8(),lg(),t.flags|=98560,h=!1;else if(h=tw(t),o!==null&&o.dehydrated!==null){if(e===null){if(!h)throw Error(Ut(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(Ut(317));h[Ll]=t}else lg(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ro(t),h=!1}else Ks!==null&&(oO(Ks),Ks=null),h=!0;if(!h)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,t.mode&1&&(e===null||vi.current&1?eo===0&&(eo=3):ak())),t.updateQueue!==null&&(t.flags|=4),Ro(t),null);case 4:return cg(),KI(e,t),e===null&&d0(t.stateNode.containerInfo),Ro(t),null;case 10:return VR(t.type._context),Ro(t),null;case 17:return ya(t.type)&&fS(),Ro(t),null;case 19:if(ci(vi),h=t.memoizedState,h===null)return Ro(t),null;if(o=(t.flags&128)!==0,p=h.rendering,p===null)if(o)hv(h,!1);else{if(eo!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(p=vS(e),p!==null){for(t.flags|=128,hv(h,!1),o=p.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;n!==null;)h=n,e=o,h.flags&=14680066,p=h.alternate,p===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=p.childLanes,h.lanes=p.lanes,h.child=p.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=p.memoizedProps,h.memoizedState=p.memoizedState,h.updateQueue=p.updateQueue,h.type=p.type,e=p.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ri(vi,vi.current&1|2),t.child}e=e.sibling}h.tail!==null&&Mi()>fg&&(t.flags|=128,o=!0,hv(h,!1),t.lanes=4194304)}else{if(!o)if(e=vS(p),e!==null){if(t.flags|=128,o=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),hv(h,!0),h.tail===null&&h.tailMode==="hidden"&&!p.alternate&&!pi)return Ro(t),null}else 2*Mi()-h.renderingStartTime>fg&&n!==1073741824&&(t.flags|=128,o=!0,hv(h,!1),t.lanes=4194304);h.isBackwards?(p.sibling=t.child,t.child=p):(n=h.last,n!==null?n.sibling=p:t.child=p,h.last=p)}return h.tail!==null?(t=h.tail,h.rendering=t,h.tail=t.sibling,h.renderingStartTime=Mi(),t.sibling=null,n=vi.current,ri(vi,o?n&1|2:n&1),t):(Ro(t),null);case 22:case 23:return ok(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&t.mode&1?Da&1073741824&&(Ro(t),t.subtreeFlags&6&&(t.flags|=8192)):Ro(t),null;case 24:return null;case 25:return null}throw Error(Ut(156,t.tag))}function Bte(e,t){switch(BR(t),t.tag){case 1:return ya(t.type)&&fS(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cg(),ci(ga),ci(Bo),ZR(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qR(t),null;case 13:if(ci(vi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ut(340));lg()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ci(vi),null;case 4:return cg(),null;case 10:return VR(t.type._context),null;case 22:case 23:return ok(),null;case 24:return null;default:return null}}var iw=!1,Lo=!1,jte=typeof WeakSet=="function"?WeakSet:Set,cn=null;function Nm(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){Ei(e,t,o)}else n.current=null}function QI(e,t,n){try{n()}catch(o){Ei(e,t,o)}}var QB=!1;function $te(e,t){if(LI=lS,e=HV(),FR(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var u=o.anchorOffset,h=o.focusNode;o=o.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var p=0,_=-1,a=-1,b=0,C=0,A=e,O=null;t:for(;;){for(var k;A!==n||u!==0&&A.nodeType!==3||(_=p+u),A!==h||o!==0&&A.nodeType!==3||(a=p+o),A.nodeType===3&&(p+=A.nodeValue.length),(k=A.firstChild)!==null;)O=A,A=k;for(;;){if(A===e)break t;if(O===n&&++b===u&&(_=p),O===h&&++C===o&&(a=p),(k=A.nextSibling)!==null)break;A=O,O=A.parentNode}A=k}n=_===-1||a===-1?null:{start:_,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(zI={focusedElem:e,selectionRange:n},lS=!1,cn=t;cn!==null;)if(t=cn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,cn=e;else for(;cn!==null;){t=cn;try{var N=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var z=N.memoizedProps,U=N.memoizedState,j=t.stateNode,G=j.getSnapshotBeforeUpdate(t.elementType===t.type?z:Zs(t.type,z),U);j.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var H=t.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ut(163))}}catch(Y){Ei(t,t.return,Y)}if(e=t.sibling,e!==null){e.return=t.return,cn=e;break}cn=t.return}return N=QB,QB=!1,N}function Gv(e,t,n){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&e)===e){var h=u.destroy;u.destroy=void 0,h!==void 0&&QI(t,n,h)}u=u.next}while(u!==o)}}function XT(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function JI(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function U8(e){var t=e.alternate;t!==null&&(e.alternate=null,U8(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ll],delete t[m0],delete t[BI],delete t[Ste],delete t[Tte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function V8(e){return e.tag===5||e.tag===3||e.tag===4}function JB(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||V8(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function eO(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=hS));else if(o!==4&&(e=e.child,e!==null))for(eO(e,t,n),e=e.sibling;e!==null;)eO(e,t,n),e=e.sibling}function tO(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(tO(e,t,n),e=e.sibling;e!==null;)tO(e,t,n),e=e.sibling}var bo=null,Xs=!1;function sh(e,t,n){for(n=n.child;n!==null;)G8(e,t,n),n=n.sibling}function G8(e,t,n){if(jl&&typeof jl.onCommitFiberUnmount=="function")try{jl.onCommitFiberUnmount($T,n)}catch{}switch(n.tag){case 5:Lo||Nm(n,t);case 6:var o=bo,u=Xs;bo=null,sh(e,t,n),bo=o,Xs=u,bo!==null&&(Xs?(e=bo,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):bo.removeChild(n.stateNode));break;case 18:bo!==null&&(Xs?(e=bo,n=n.stateNode,e.nodeType===8?WP(e.parentNode,n):e.nodeType===1&&WP(e,n),c0(e)):WP(bo,n.stateNode));break;case 4:o=bo,u=Xs,bo=n.stateNode.containerInfo,Xs=!0,sh(e,t,n),bo=o,Xs=u;break;case 0:case 11:case 14:case 15:if(!Lo&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){u=o=o.next;do{var h=u,p=h.destroy;h=h.tag,p!==void 0&&(h&2||h&4)&&QI(n,t,p),u=u.next}while(u!==o)}sh(e,t,n);break;case 1:if(!Lo&&(Nm(n,t),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(_){Ei(n,t,_)}sh(e,t,n);break;case 21:sh(e,t,n);break;case 22:n.mode&1?(Lo=(o=Lo)||n.memoizedState!==null,sh(e,t,n),Lo=o):sh(e,t,n);break;default:sh(e,t,n)}}function e4(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new jte),t.forEach(function(o){var u=Yte.bind(null,e,o);n.has(o)||(n.add(o),o.then(u,u))})}}function Hs(e,t){var n=t.deletions;if(n!==null)for(var o=0;o<n.length;o++){var u=n[o];try{var h=e,p=t,_=p;e:for(;_!==null;){switch(_.tag){case 5:bo=_.stateNode,Xs=!1;break e;case 3:bo=_.stateNode.containerInfo,Xs=!0;break e;case 4:bo=_.stateNode.containerInfo,Xs=!0;break e}_=_.return}if(bo===null)throw Error(Ut(160));G8(h,p,u),bo=null,Xs=!1;var a=u.alternate;a!==null&&(a.return=null),u.return=null}catch(b){Ei(u,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)W8(t,e),t=t.sibling}function W8(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Hs(t,e),Ol(e),o&4){try{Gv(3,e,e.return),XT(3,e)}catch(z){Ei(e,e.return,z)}try{Gv(5,e,e.return)}catch(z){Ei(e,e.return,z)}}break;case 1:Hs(t,e),Ol(e),o&512&&n!==null&&Nm(n,n.return);break;case 5:if(Hs(t,e),Ol(e),o&512&&n!==null&&Nm(n,n.return),e.flags&32){var u=e.stateNode;try{a0(u,"")}catch(z){Ei(e,e.return,z)}}if(o&4&&(u=e.stateNode,u!=null)){var h=e.memoizedProps,p=n!==null?n.memoizedProps:h,_=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{_==="input"&&h.type==="radio"&&h.name!=null&&dV(u,h),EI(_,p);var b=EI(_,h);for(p=0;p<a.length;p+=2){var C=a[p],A=a[p+1];C==="style"?_V(u,A):C==="dangerouslySetInnerHTML"?gV(u,A):C==="children"?a0(u,A):TR(u,C,A,b)}switch(_){case"input":xI(u,h);break;case"textarea":pV(u,h);break;case"select":var O=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!h.multiple;var k=h.value;k!=null?Gm(u,!!h.multiple,k,!1):O!==!!h.multiple&&(h.defaultValue!=null?Gm(u,!!h.multiple,h.defaultValue,!0):Gm(u,!!h.multiple,h.multiple?[]:"",!1))}u[m0]=h}catch(z){Ei(e,e.return,z)}}break;case 6:if(Hs(t,e),Ol(e),o&4){if(e.stateNode===null)throw Error(Ut(162));u=e.stateNode,h=e.memoizedProps;try{u.nodeValue=h}catch(z){Ei(e,e.return,z)}}break;case 3:if(Hs(t,e),Ol(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{c0(t.containerInfo)}catch(z){Ei(e,e.return,z)}break;case 4:Hs(t,e),Ol(e);break;case 13:Hs(t,e),Ol(e),u=e.child,u.flags&8192&&(h=u.memoizedState!==null,u.stateNode.isHidden=h,!h||u.alternate!==null&&u.alternate.memoizedState!==null||(rk=Mi())),o&4&&e4(e);break;case 22:if(C=n!==null&&n.memoizedState!==null,e.mode&1?(Lo=(b=Lo)||C,Hs(t,e),Lo=b):Hs(t,e),Ol(e),o&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!C&&e.mode&1)for(cn=e,C=e.child;C!==null;){for(A=cn=C;cn!==null;){switch(O=cn,k=O.child,O.tag){case 0:case 11:case 14:case 15:Gv(4,O,O.return);break;case 1:Nm(O,O.return);var N=O.stateNode;if(typeof N.componentWillUnmount=="function"){o=O,n=O.return;try{t=o,N.props=t.memoizedProps,N.state=t.memoizedState,N.componentWillUnmount()}catch(z){Ei(o,n,z)}}break;case 5:Nm(O,O.return);break;case 22:if(O.memoizedState!==null){n4(A);continue}}k!==null?(k.return=O,cn=k):n4(A)}C=C.sibling}e:for(C=null,A=e;;){if(A.tag===5){if(C===null){C=A;try{u=A.stateNode,b?(h=u.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(_=A.stateNode,a=A.memoizedProps.style,p=a!=null&&a.hasOwnProperty("display")?a.display:null,_.style.display=yV("display",p))}catch(z){Ei(e,e.return,z)}}}else if(A.tag===6){if(C===null)try{A.stateNode.nodeValue=b?"":A.memoizedProps}catch(z){Ei(e,e.return,z)}}else if((A.tag!==22&&A.tag!==23||A.memoizedState===null||A===e)&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===e)break e;for(;A.sibling===null;){if(A.return===null||A.return===e)break e;C===A&&(C=null),A=A.return}C===A&&(C=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:Hs(t,e),Ol(e),o&4&&e4(e);break;case 21:break;default:Hs(t,e),Ol(e)}}function Ol(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(V8(n)){var o=n;break e}n=n.return}throw Error(Ut(160))}switch(o.tag){case 5:var u=o.stateNode;o.flags&32&&(a0(u,""),o.flags&=-33);var h=JB(e);tO(e,h,u);break;case 3:case 4:var p=o.stateNode.containerInfo,_=JB(e);eO(e,_,p);break;default:throw Error(Ut(161))}}catch(a){Ei(e,e.return,a)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ute(e,t,n){cn=e,H8(e)}function H8(e,t,n){for(var o=(e.mode&1)!==0;cn!==null;){var u=cn,h=u.child;if(u.tag===22&&o){var p=u.memoizedState!==null||iw;if(!p){var _=u.alternate,a=_!==null&&_.memoizedState!==null||Lo;_=iw;var b=Lo;if(iw=p,(Lo=a)&&!b)for(cn=u;cn!==null;)p=cn,a=p.child,p.tag===22&&p.memoizedState!==null?r4(u):a!==null?(a.return=p,cn=a):r4(u);for(;h!==null;)cn=h,H8(h),h=h.sibling;cn=u,iw=_,Lo=b}t4(e)}else u.subtreeFlags&8772&&h!==null?(h.return=u,cn=h):t4(e)}}function t4(e){for(;cn!==null;){var t=cn;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lo||XT(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!Lo)if(n===null)o.componentDidMount();else{var u=t.elementType===t.type?n.memoizedProps:Zs(t.type,n.memoizedProps);o.componentDidUpdate(u,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var h=t.updateQueue;h!==null&&BB(t,h,o);break;case 3:var p=t.updateQueue;if(p!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}BB(t,p,n)}break;case 5:var _=t.stateNode;if(n===null&&t.flags&4){n=_;var a=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var C=b.memoizedState;if(C!==null){var A=C.dehydrated;A!==null&&c0(A)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ut(163))}Lo||t.flags&512&&JI(t)}catch(O){Ei(t,t.return,O)}}if(t===e){cn=null;break}if(n=t.sibling,n!==null){n.return=t.return,cn=n;break}cn=t.return}}function n4(e){for(;cn!==null;){var t=cn;if(t===e){cn=null;break}var n=t.sibling;if(n!==null){n.return=t.return,cn=n;break}cn=t.return}}function r4(e){for(;cn!==null;){var t=cn;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{XT(4,t)}catch(a){Ei(t,n,a)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var u=t.return;try{o.componentDidMount()}catch(a){Ei(t,u,a)}}var h=t.return;try{JI(t)}catch(a){Ei(t,h,a)}break;case 5:var p=t.return;try{JI(t)}catch(a){Ei(t,p,a)}}}catch(a){Ei(t,t.return,a)}if(t===e){cn=null;break}var _=t.sibling;if(_!==null){_.return=t.return,cn=_;break}cn=t.return}}var Vte=Math.ceil,wS=Ju.ReactCurrentDispatcher,tk=Ju.ReactCurrentOwner,_s=Ju.ReactCurrentBatchConfig,Mr=0,ho=null,Ui=null,So=0,Da=0,Bm=Gh(0),eo=0,b0=null,Dd=0,YT=0,nk=0,Wv=null,da=null,rk=0,fg=1/0,Au=null,SS=!1,nO=null,Ih=null,ow=!1,xh=null,TS=0,Hv=0,rO=null,Kw=-1,Qw=0;function Zo(){return Mr&6?Mi():Kw!==-1?Kw:Kw=Mi()}function Oh(e){return e.mode&1?Mr&2&&So!==0?So&-So:Ate.transition!==null?(Qw===0&&(Qw=IV()),Qw):(e=Wr,e!==0||(e=window.event,e=e===void 0?16:FV(e.type)),e):1}function tl(e,t,n,o){if(50<Hv)throw Hv=0,rO=null,Error(Ut(185));dx(e,n,o),(!(Mr&2)||e!==ho)&&(e===ho&&(!(Mr&2)&&(YT|=n),eo===4&&yh(e,So)),_a(e,o),n===1&&Mr===0&&!(t.mode&1)&&(fg=Mi()+500,HT&&Wh()))}function _a(e,t){var n=e.callbackNode;Aee(e,t);var o=sS(e,e===ho?So:0);if(o===0)n!==null&&fB(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(n!=null&&fB(n),t===1)e.tag===0?Ete(i4.bind(null,e)):n8(i4.bind(null,e)),bte(function(){!(Mr&6)&&Wh()}),n=null;else{switch(OV(o)){case 1:n=MR;break;case 4:n=PV;break;case 16:n=aS;break;case 536870912:n=MV;break;default:n=aS}n=eG(n,q8.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function q8(e,t){if(Kw=-1,Qw=0,Mr&6)throw Error(Ut(327));var n=e.callbackNode;if(Xm()&&e.callbackNode!==n)return null;var o=sS(e,e===ho?So:0);if(o===0)return null;if(o&30||o&e.expiredLanes||t)t=ES(e,o);else{t=o;var u=Mr;Mr|=2;var h=X8();(ho!==e||So!==t)&&(Au=null,fg=Mi()+500,Ed(e,t));do try{Hte();break}catch(_){Z8(e,_)}while(!0);UR(),wS.current=h,Mr=u,Ui!==null?t=0:(ho=null,So=0,t=eo)}if(t!==0){if(t===2&&(u=II(e),u!==0&&(o=u,t=iO(e,u))),t===1)throw n=b0,Ed(e,0),yh(e,o),_a(e,Mi()),n;if(t===6)yh(e,o);else{if(u=e.current.alternate,!(o&30)&&!Gte(u)&&(t=ES(e,o),t===2&&(h=II(e),h!==0&&(o=h,t=iO(e,h))),t===1))throw n=b0,Ed(e,0),yh(e,o),_a(e,Mi()),n;switch(e.finishedWork=u,e.finishedLanes=o,t){case 0:case 1:throw Error(Ut(345));case 2:ld(e,da,Au);break;case 3:if(yh(e,o),(o&130023424)===o&&(t=rk+500-Mi(),10<t)){if(sS(e,0)!==0)break;if(u=e.suspendedLanes,(u&o)!==o){Zo(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=NI(ld.bind(null,e,da,Au),t);break}ld(e,da,Au);break;case 4:if(yh(e,o),(o&4194240)===o)break;for(t=e.eventTimes,u=-1;0<o;){var p=31-el(o);h=1<<p,p=t[p],p>u&&(u=p),o&=~h}if(o=u,o=Mi()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Vte(o/1960))-o,10<o){e.timeoutHandle=NI(ld.bind(null,e,da,Au),o);break}ld(e,da,Au);break;case 5:ld(e,da,Au);break;default:throw Error(Ut(329))}}}return _a(e,Mi()),e.callbackNode===n?q8.bind(null,e):null}function iO(e,t){var n=Wv;return e.current.memoizedState.isDehydrated&&(Ed(e,t).flags|=256),e=ES(e,t),e!==2&&(t=da,da=n,t!==null&&oO(t)),e}function oO(e){da===null?da=e:da.push.apply(da,e)}function Gte(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var u=n[o],h=u.getSnapshot;u=u.value;try{if(!il(h(),u))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function yh(e,t){for(t&=~nk,t&=~YT,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-el(t),o=1<<n;e[n]=-1,t&=~o}}function i4(e){if(Mr&6)throw Error(Ut(327));Xm();var t=sS(e,0);if(!(t&1))return _a(e,Mi()),null;var n=ES(e,t);if(e.tag!==0&&n===2){var o=II(e);o!==0&&(t=o,n=iO(e,o))}if(n===1)throw n=b0,Ed(e,0),yh(e,t),_a(e,Mi()),n;if(n===6)throw Error(Ut(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ld(e,da,Au),_a(e,Mi()),null}function ik(e,t){var n=Mr;Mr|=1;try{return e(t)}finally{Mr=n,Mr===0&&(fg=Mi()+500,HT&&Wh())}}function Ld(e){xh!==null&&xh.tag===0&&!(Mr&6)&&Xm();var t=Mr;Mr|=1;var n=_s.transition,o=Wr;try{if(_s.transition=null,Wr=1,e)return e()}finally{Wr=o,_s.transition=n,Mr=t,!(Mr&6)&&Wh()}}function ok(){Da=Bm.current,ci(Bm)}function Ed(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,xte(n)),Ui!==null)for(n=Ui.return;n!==null;){var o=n;switch(BR(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&fS();break;case 3:cg(),ci(ga),ci(Bo),ZR();break;case 5:qR(o);break;case 4:cg();break;case 13:ci(vi);break;case 19:ci(vi);break;case 10:VR(o.type._context);break;case 22:case 23:ok()}n=n.return}if(ho=e,Ui=e=Rh(e.current,null),So=Da=t,eo=0,b0=null,nk=YT=Dd=0,da=Wv=null,gd!==null){for(t=0;t<gd.length;t++)if(n=gd[t],o=n.interleaved,o!==null){n.interleaved=null;var u=o.next,h=n.pending;if(h!==null){var p=h.next;h.next=u,o.next=p}n.pending=o}gd=null}return e}function Z8(e,t){do{var n=Ui;try{if(UR(),Zw.current=bS,xS){for(var o=bi.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}xS=!1}if(kd=0,co=Ji=bi=null,Vv=!1,_0=0,tk.current=null,n===null||n.return===null){eo=1,b0=t,Ui=null;break}e:{var h=e,p=n.return,_=n,a=t;if(t=So,_.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var b=a,C=_,A=C.tag;if(!(C.mode&1)&&(A===0||A===11||A===15)){var O=C.alternate;O?(C.updateQueue=O.updateQueue,C.memoizedState=O.memoizedState,C.lanes=O.lanes):(C.updateQueue=null,C.memoizedState=null)}var k=WB(p);if(k!==null){k.flags&=-257,HB(k,p,_,h,t),k.mode&1&&GB(h,b,t),t=k,a=b;var N=t.updateQueue;if(N===null){var z=new Set;z.add(a),t.updateQueue=z}else N.add(a);break e}else{if(!(t&1)){GB(h,b,t),ak();break e}a=Error(Ut(426))}}else if(pi&&_.mode&1){var U=WB(p);if(U!==null){!(U.flags&65536)&&(U.flags|=256),HB(U,p,_,h,t),jR(hg(a,_));break e}}h=a=hg(a,_),eo!==4&&(eo=2),Wv===null?Wv=[h]:Wv.push(h),h=p;do{switch(h.tag){case 3:h.flags|=65536,t&=-t,h.lanes|=t;var j=O8(h,a,t);NB(h,j);break e;case 1:_=a;var G=h.type,H=h.stateNode;if(!(h.flags&128)&&(typeof G.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Ih===null||!Ih.has(H)))){h.flags|=65536,t&=-t,h.lanes|=t;var Y=R8(h,_,t);NB(h,Y);break e}}h=h.return}while(h!==null)}K8(n)}catch(K){t=K,Ui===n&&n!==null&&(Ui=n=n.return);continue}break}while(!0)}function X8(){var e=wS.current;return wS.current=bS,e===null?bS:e}function ak(){(eo===0||eo===3||eo===2)&&(eo=4),ho===null||!(Dd&268435455)&&!(YT&268435455)||yh(ho,So)}function ES(e,t){var n=Mr;Mr|=2;var o=X8();(ho!==e||So!==t)&&(Au=null,Ed(e,t));do try{Wte();break}catch(u){Z8(e,u)}while(!0);if(UR(),Mr=n,wS.current=o,Ui!==null)throw Error(Ut(261));return ho=null,So=0,eo}function Wte(){for(;Ui!==null;)Y8(Ui)}function Hte(){for(;Ui!==null&&!yee();)Y8(Ui)}function Y8(e){var t=J8(e.alternate,e,Da);e.memoizedProps=e.pendingProps,t===null?K8(e):Ui=t,tk.current=null}function K8(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Bte(n,t),n!==null){n.flags&=32767,Ui=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{eo=6,Ui=null;return}}else if(n=Nte(n,t,Da),n!==null){Ui=n;return}if(t=t.sibling,t!==null){Ui=t;return}Ui=t=e}while(t!==null);eo===0&&(eo=5)}function ld(e,t,n){var o=Wr,u=_s.transition;try{_s.transition=null,Wr=1,qte(e,t,n,o)}finally{_s.transition=u,Wr=o}return null}function qte(e,t,n,o){do Xm();while(xh!==null);if(Mr&6)throw Error(Ut(327));n=e.finishedWork;var u=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Ut(177));e.callbackNode=null,e.callbackPriority=0;var h=n.lanes|n.childLanes;if(Cee(e,h),e===ho&&(Ui=ho=null,So=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ow||(ow=!0,eG(aS,function(){return Xm(),null})),h=(n.flags&15990)!==0,n.subtreeFlags&15990||h){h=_s.transition,_s.transition=null;var p=Wr;Wr=1;var _=Mr;Mr|=4,tk.current=null,$te(e,n),W8(n,e),dte(zI),lS=!!LI,zI=LI=null,e.current=n,Ute(n),_ee(),Mr=_,Wr=p,_s.transition=h}else e.current=n;if(ow&&(ow=!1,xh=e,TS=u),h=e.pendingLanes,h===0&&(Ih=null),bee(n.stateNode),_a(e,Mi()),t!==null)for(o=e.onRecoverableError,n=0;n<t.length;n++)u=t[n],o(u.value,{componentStack:u.stack,digest:u.digest});if(SS)throw SS=!1,e=nO,nO=null,e;return TS&1&&e.tag!==0&&Xm(),h=e.pendingLanes,h&1?e===rO?Hv++:(Hv=0,rO=e):Hv=0,Wh(),null}function Xm(){if(xh!==null){var e=OV(TS),t=_s.transition,n=Wr;try{if(_s.transition=null,Wr=16>e?16:e,xh===null)var o=!1;else{if(e=xh,xh=null,TS=0,Mr&6)throw Error(Ut(331));var u=Mr;for(Mr|=4,cn=e.current;cn!==null;){var h=cn,p=h.child;if(cn.flags&16){var _=h.deletions;if(_!==null){for(var a=0;a<_.length;a++){var b=_[a];for(cn=b;cn!==null;){var C=cn;switch(C.tag){case 0:case 11:case 15:Gv(8,C,h)}var A=C.child;if(A!==null)A.return=C,cn=A;else for(;cn!==null;){C=cn;var O=C.sibling,k=C.return;if(U8(C),C===b){cn=null;break}if(O!==null){O.return=k,cn=O;break}cn=k}}}var N=h.alternate;if(N!==null){var z=N.child;if(z!==null){N.child=null;do{var U=z.sibling;z.sibling=null,z=U}while(z!==null)}}cn=h}}if(h.subtreeFlags&2064&&p!==null)p.return=h,cn=p;else e:for(;cn!==null;){if(h=cn,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Gv(9,h,h.return)}var j=h.sibling;if(j!==null){j.return=h.return,cn=j;break e}cn=h.return}}var G=e.current;for(cn=G;cn!==null;){p=cn;var H=p.child;if(p.subtreeFlags&2064&&H!==null)H.return=p,cn=H;else e:for(p=G;cn!==null;){if(_=cn,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:XT(9,_)}}catch(K){Ei(_,_.return,K)}if(_===p){cn=null;break e}var Y=_.sibling;if(Y!==null){Y.return=_.return,cn=Y;break e}cn=_.return}}if(Mr=u,Wh(),jl&&typeof jl.onPostCommitFiberRoot=="function")try{jl.onPostCommitFiberRoot($T,e)}catch{}o=!0}return o}finally{Wr=n,_s.transition=t}}return!1}function o4(e,t,n){t=hg(n,t),t=O8(e,t,1),e=Mh(e,t,1),t=Zo(),e!==null&&(dx(e,1,t),_a(e,t))}function Ei(e,t,n){if(e.tag===3)o4(e,e,n);else for(;t!==null;){if(t.tag===3){o4(t,e,n);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ih===null||!Ih.has(o))){e=hg(n,e),e=R8(t,e,1),t=Mh(t,e,1),e=Zo(),t!==null&&(dx(t,1,e),_a(t,e));break}}t=t.return}}function Zte(e,t,n){var o=e.pingCache;o!==null&&o.delete(t),t=Zo(),e.pingedLanes|=e.suspendedLanes&n,ho===e&&(So&n)===n&&(eo===4||eo===3&&(So&130023424)===So&&500>Mi()-rk?Ed(e,0):nk|=n),_a(e,t)}function Q8(e,t){t===0&&(e.mode&1?(t=Xb,Xb<<=1,!(Xb&130023424)&&(Xb=4194304)):t=1);var n=Zo();e=Vu(e,t),e!==null&&(dx(e,t,n),_a(e,n))}function Xte(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Q8(e,n)}function Yte(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,u=e.memoizedState;u!==null&&(n=u.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(Ut(314))}o!==null&&o.delete(t),Q8(e,n)}var J8;J8=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ga.current)pa=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return pa=!1,Fte(e,t,n);pa=!!(e.flags&131072)}else pa=!1,pi&&t.flags&1048576&&r8(t,mS,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;Yw(e,t),e=t.pendingProps;var u=sg(t,Bo.current);Zm(t,n),u=YR(null,t,o,e,u,n);var h=KR();return t.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ya(o)?(h=!0,dS(t)):h=!1,t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,WR(t),u.updater=ZT,t.stateNode=u,u._reactInternals=t,WI(t,o,e,n),t=ZI(null,t,o,!0,h,n)):(t.tag=0,pi&&h&&NR(t),Ho(null,t,u,n),t=t.child),t;case 16:o=t.elementType;e:{switch(Yw(e,t),e=t.pendingProps,u=o._init,o=u(o._payload),t.type=o,u=t.tag=Qte(o),e=Zs(o,e),u){case 0:t=qI(null,t,o,e,n);break e;case 1:t=XB(null,t,o,e,n);break e;case 11:t=qB(null,t,o,e,n);break e;case 14:t=ZB(null,t,o,Zs(o.type,e),n);break e}throw Error(Ut(306,o,""))}return t;case 0:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:Zs(o,u),qI(e,t,o,u,n);case 1:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:Zs(o,u),XB(e,t,o,u,n);case 3:e:{if(z8(t),e===null)throw Error(Ut(387));o=t.pendingProps,h=t.memoizedState,u=h.element,u8(e,t),_S(t,o,null,n);var p=t.memoizedState;if(o=p.element,h.isDehydrated)if(h={element:o,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){u=hg(Error(Ut(423)),t),t=YB(e,t,o,n,u);break e}else if(o!==u){u=hg(Error(Ut(424)),t),t=YB(e,t,o,n,u);break e}else for(Na=Ph(t.stateNode.containerInfo.firstChild),ja=t,pi=!0,Ks=null,n=s8(t,null,o,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lg(),o===u){t=Gu(e,t,n);break e}Ho(e,t,o,n)}t=t.child}return t;case 5:return c8(t),e===null&&UI(t),o=t.type,u=t.pendingProps,h=e!==null?e.memoizedProps:null,p=u.children,FI(o,u)?p=null:h!==null&&FI(o,h)&&(t.flags|=32),L8(e,t),Ho(e,t,p,n),t.child;case 6:return e===null&&UI(t),null;case 13:return F8(e,t,n);case 4:return HR(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=ug(t,null,o,n):Ho(e,t,o,n),t.child;case 11:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:Zs(o,u),qB(e,t,o,u,n);case 7:return Ho(e,t,t.pendingProps,n),t.child;case 8:return Ho(e,t,t.pendingProps.children,n),t.child;case 12:return Ho(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,u=t.pendingProps,h=t.memoizedProps,p=u.value,ri(gS,o._currentValue),o._currentValue=p,h!==null)if(il(h.value,p)){if(h.children===u.children&&!ga.current){t=Gu(e,t,n);break e}}else for(h=t.child,h!==null&&(h.return=t);h!==null;){var _=h.dependencies;if(_!==null){p=h.child;for(var a=_.firstContext;a!==null;){if(a.context===o){if(h.tag===1){a=zu(-1,n&-n),a.tag=2;var b=h.updateQueue;if(b!==null){b=b.shared;var C=b.pending;C===null?a.next=a:(a.next=C.next,C.next=a),b.pending=a}}h.lanes|=n,a=h.alternate,a!==null&&(a.lanes|=n),VI(h.return,n,t),_.lanes|=n;break}a=a.next}}else if(h.tag===10)p=h.type===t.type?null:h.child;else if(h.tag===18){if(p=h.return,p===null)throw Error(Ut(341));p.lanes|=n,_=p.alternate,_!==null&&(_.lanes|=n),VI(p,n,t),p=h.sibling}else p=h.child;if(p!==null)p.return=h;else for(p=h;p!==null;){if(p===t){p=null;break}if(h=p.sibling,h!==null){h.return=p.return,p=h;break}p=p.return}h=p}Ho(e,t,u.children,n),t=t.child}return t;case 9:return u=t.type,o=t.pendingProps.children,Zm(t,n),u=bs(u),o=o(u),t.flags|=1,Ho(e,t,o,n),t.child;case 14:return o=t.type,u=Zs(o,t.pendingProps),u=Zs(o.type,u),ZB(e,t,o,u,n);case 15:return k8(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,u=t.pendingProps,u=t.elementType===o?u:Zs(o,u),Yw(e,t),t.tag=1,ya(o)?(e=!0,dS(t)):e=!1,Zm(t,n),I8(t,o,u),WI(t,o,u,n),ZI(null,t,o,!0,e,n);case 19:return N8(e,t,n);case 22:return D8(e,t,n)}throw Error(Ut(156,t.tag))};function eG(e,t){return CV(e,t)}function Kte(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gs(e,t,n,o){return new Kte(e,t,n,o)}function sk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qte(e){if(typeof e=="function")return sk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===AR)return 11;if(e===CR)return 14}return 2}function Rh(e,t){var n=e.alternate;return n===null?(n=gs(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Jw(e,t,n,o,u,h){var p=2;if(o=e,typeof e=="function")sk(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case Mm:return Ad(n.children,u,h,t);case ER:p=8,u|=8;break;case mI:return e=gs(12,n,t,u|2),e.elementType=mI,e.lanes=h,e;case gI:return e=gs(13,n,t,u),e.elementType=gI,e.lanes=h,e;case yI:return e=gs(19,n,t,u),e.elementType=yI,e.lanes=h,e;case cV:return KT(n,u,h,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lV:p=10;break e;case uV:p=9;break e;case AR:p=11;break e;case CR:p=14;break e;case dh:p=16,o=null;break e}throw Error(Ut(130,e==null?e:typeof e,""))}return t=gs(p,n,t,u),t.elementType=e,t.type=o,t.lanes=h,t}function Ad(e,t,n,o){return e=gs(7,e,o,t),e.lanes=n,e}function KT(e,t,n,o){return e=gs(22,e,o,t),e.elementType=cV,e.lanes=n,e.stateNode={isHidden:!1},e}function JP(e,t,n){return e=gs(6,e,null,t),e.lanes=n,e}function eM(e,t,n){return t=gs(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Jte(e,t,n,o,u){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=DP(0),this.expirationTimes=DP(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=DP(0),this.identifierPrefix=o,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function lk(e,t,n,o,u,h,p,_,a){return e=new Jte(e,t,n,_,a),t===1?(t=1,h===!0&&(t|=8)):t=0,h=gs(3,null,null,t),e.current=h,h.stateNode=e,h.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},WR(h),e}function ene(e,t,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pm,key:o==null?null:""+o,children:e,containerInfo:t,implementation:n}}function tG(e){if(!e)return Nh;e=e._reactInternals;e:{if(Hd(e)!==e||e.tag!==1)throw Error(Ut(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ya(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ut(171))}if(e.tag===1){var n=e.type;if(ya(n))return t8(e,n,t)}return t}function nG(e,t,n,o,u,h,p,_,a){return e=lk(n,o,!0,e,u,h,p,_,a),e.context=tG(null),n=e.current,o=Zo(),u=Oh(n),h=zu(o,u),h.callback=t??null,Mh(n,h,u),e.current.lanes=u,dx(e,u,o),_a(e,o),e}function QT(e,t,n,o){var u=t.current,h=Zo(),p=Oh(u);return n=tG(n),t.context===null?t.context=n:t.pendingContext=n,t=zu(h,p),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=Mh(u,t,p),e!==null&&(tl(e,u,p,h),qw(e,u,p)),p}function AS(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function a4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function uk(e,t){a4(e,t),(e=e.alternate)&&a4(e,t)}function tne(){return null}var rG=typeof reportError=="function"?reportError:function(e){console.error(e)};function ck(e){this._internalRoot=e}JT.prototype.render=ck.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ut(409));QT(e,t,null,null)};JT.prototype.unmount=ck.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ld(function(){QT(null,e,null,null)}),t[Uu]=null}};function JT(e){this._internalRoot=e}JT.prototype.unstable_scheduleHydration=function(e){if(e){var t=DV();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gh.length&&t!==0&&t<gh[n].priority;n++);gh.splice(n,0,e),n===0&&zV(e)}};function hk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function eE(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function s4(){}function nne(e,t,n,o,u){if(u){if(typeof o=="function"){var h=o;o=function(){var b=AS(p);h.call(b)}}var p=nG(t,o,e,0,null,!1,!1,"",s4);return e._reactRootContainer=p,e[Uu]=p.current,d0(e.nodeType===8?e.parentNode:e),Ld(),p}for(;u=e.lastChild;)e.removeChild(u);if(typeof o=="function"){var _=o;o=function(){var b=AS(a);_.call(b)}}var a=lk(e,0,!1,null,null,!1,!1,"",s4);return e._reactRootContainer=a,e[Uu]=a.current,d0(e.nodeType===8?e.parentNode:e),Ld(function(){QT(t,a,n,o)}),a}function tE(e,t,n,o,u){var h=n._reactRootContainer;if(h){var p=h;if(typeof u=="function"){var _=u;u=function(){var a=AS(p);_.call(a)}}QT(t,p,e,u)}else p=nne(n,t,e,u,o);return AS(p)}RV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Rv(t.pendingLanes);n!==0&&(IR(t,n|1),_a(t,Mi()),!(Mr&6)&&(fg=Mi()+500,Wh()))}break;case 13:Ld(function(){var o=Vu(e,1);if(o!==null){var u=Zo();tl(o,e,1,u)}}),uk(e,1)}};OR=function(e){if(e.tag===13){var t=Vu(e,134217728);if(t!==null){var n=Zo();tl(t,e,134217728,n)}uk(e,134217728)}};kV=function(e){if(e.tag===13){var t=Oh(e),n=Vu(e,t);if(n!==null){var o=Zo();tl(n,e,t,o)}uk(e,t)}};DV=function(){return Wr};LV=function(e,t){var n=Wr;try{return Wr=e,t()}finally{Wr=n}};CI=function(e,t,n){switch(t){case"input":if(xI(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var u=WT(o);if(!u)throw Error(Ut(90));fV(o),xI(o,u)}}}break;case"textarea":pV(e,n);break;case"select":t=n.value,t!=null&&Gm(e,!!n.multiple,t,!1)}};bV=ik;wV=Ld;var rne={usingClientEntryPoint:!1,Events:[mx,km,WT,vV,xV,ik]},fv={findFiberByHostInstance:md,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ine={bundleType:fv.bundleType,version:fv.version,rendererPackageName:fv.rendererPackageName,rendererConfig:fv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ju.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=EV(e),e===null?null:e.stateNode},findFiberByHostInstance:fv.findFiberByHostInstance||tne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var aw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!aw.isDisabled&&aw.supportsFiber)try{$T=aw.inject(ine),jl=aw}catch{}}Wa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rne;Wa.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hk(t))throw Error(Ut(200));return ene(e,t,null,n)};Wa.createRoot=function(e,t){if(!hk(e))throw Error(Ut(299));var n=!1,o="",u=rG;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(u=t.onRecoverableError)),t=lk(e,1,!1,null,null,n,!1,o,u),e[Uu]=t.current,d0(e.nodeType===8?e.parentNode:e),new ck(t)};Wa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ut(188)):(e=Object.keys(e).join(","),Error(Ut(268,e)));return e=EV(t),e=e===null?null:e.stateNode,e};Wa.flushSync=function(e){return Ld(e)};Wa.hydrate=function(e,t,n){if(!eE(t))throw Error(Ut(200));return tE(null,e,t,!0,n)};Wa.hydrateRoot=function(e,t,n){if(!hk(e))throw Error(Ut(405));var o=n!=null&&n.hydratedSources||null,u=!1,h="",p=rG;if(n!=null&&(n.unstable_strictMode===!0&&(u=!0),n.identifierPrefix!==void 0&&(h=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),t=nG(t,null,e,1,n??null,u,!1,h,p),e[Uu]=t.current,d0(e),o)for(e=0;e<o.length;e++)n=o[e],u=n._getVersion,u=u(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,u]:t.mutableSourceEagerHydrationData.push(n,u);return new JT(t)};Wa.render=function(e,t,n){if(!eE(t))throw Error(Ut(200));return tE(null,e,t,!1,n)};Wa.unmountComponentAtNode=function(e){if(!eE(e))throw Error(Ut(40));return e._reactRootContainer?(Ld(function(){tE(null,null,e,!1,function(){e._reactRootContainer=null,e[Uu]=null})}),!0):!1};Wa.unstable_batchedUpdates=ik;Wa.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!eE(n))throw Error(Ut(200));if(e==null||e._reactInternals===void 0)throw Error(Ut(38));return tE(e,t,n,!1,o)};Wa.version="18.3.1-next-f1338f8080-20240426";function iG(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iG)}catch(e){console.error(e)}}iG(),iV.exports=Wa;var ec=iV.exports;const oG=Vr(ec);var l4=ec;dI.createRoot=l4.createRoot,dI.hydrateRoot=l4.hydrateRoot;/**
 * @remix-run/router v1.17.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},w0.apply(this,arguments)}var bh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(bh||(bh={}));const u4="popstate";function one(e){e===void 0&&(e={});function t(o,u){let{pathname:h,search:p,hash:_}=o.location;return aO("",{pathname:h,search:p,hash:_},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function n(o,u){return typeof u=="string"?u:CS(u)}return sne(t,n,null,e)}function Vi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function aG(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ane(){return Math.random().toString(36).substr(2,8)}function c4(e,t){return{usr:e.state,key:e.key,idx:t}}function aO(e,t,n,o){return n===void 0&&(n=null),w0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ug(t):t,{state:n,key:t&&t.key||o||ane()})}function CS(e){let{pathname:t="/",search:n="",hash:o=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(t+=o.charAt(0)==="#"?o:"#"+o),t}function Ug(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}function sne(e,t,n,o){o===void 0&&(o={});let{window:u=document.defaultView,v5Compat:h=!1}=o,p=u.history,_=bh.Pop,a=null,b=C();b==null&&(b=0,p.replaceState(w0({},p.state,{idx:b}),""));function C(){return(p.state||{idx:null}).idx}function A(){_=bh.Pop;let U=C(),j=U==null?null:U-b;b=U,a&&a({action:_,location:z.location,delta:j})}function O(U,j){_=bh.Push;let G=aO(z.location,U,j);b=C()+1;let H=c4(G,b),Y=z.createHref(G);try{p.pushState(H,"",Y)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;u.location.assign(Y)}h&&a&&a({action:_,location:z.location,delta:1})}function k(U,j){_=bh.Replace;let G=aO(z.location,U,j);b=C();let H=c4(G,b),Y=z.createHref(G);p.replaceState(H,"",Y),h&&a&&a({action:_,location:z.location,delta:0})}function N(U){let j=u.location.origin!=="null"?u.location.origin:u.location.href,G=typeof U=="string"?U:CS(U);return G=G.replace(/ $/,"%20"),Vi(j,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,j)}let z={get action(){return _},get location(){return e(u,p)},listen(U){if(a)throw new Error("A history only accepts one active listener");return u.addEventListener(u4,A),a=U,()=>{u.removeEventListener(u4,A),a=null}},createHref(U){return t(u,U)},createURL:N,encodeLocation(U){let j=N(U);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:O,replace:k,go(U){return p.go(U)}};return z}var h4;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(h4||(h4={}));function lne(e,t,n){return n===void 0&&(n="/"),une(e,t,n,!1)}function une(e,t,n,o){let u=typeof t=="string"?Ug(t):t,h=fk(u.pathname||"/",n);if(h==null)return null;let p=sG(e);cne(p);let _=null;for(let a=0;_==null&&a<p.length;++a){let b=bne(h);_=vne(p[a],b,o)}return _}function sG(e,t,n,o){t===void 0&&(t=[]),n===void 0&&(n=[]),o===void 0&&(o="");let u=(h,p,_)=>{let a={relativePath:_===void 0?h.path||"":_,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};a.relativePath.startsWith("/")&&(Vi(a.relativePath.startsWith(o),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(o.length));let b=kh([o,a.relativePath]),C=n.concat(a);h.children&&h.children.length>0&&(Vi(h.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),sG(h.children,t,C,b)),!(h.path==null&&!h.index)&&t.push({path:b,score:yne(b,h.index),routesMeta:C})};return e.forEach((h,p)=>{var _;if(h.path===""||!((_=h.path)!=null&&_.includes("?")))u(h,p);else for(let a of lG(h.path))u(h,p,a)}),t}function lG(e){let t=e.split("/");if(t.length===0)return[];let[n,...o]=t,u=n.endsWith("?"),h=n.replace(/\?$/,"");if(o.length===0)return u?[h,""]:[h];let p=lG(o.join("/")),_=[];return _.push(...p.map(a=>a===""?h:[h,a].join("/"))),u&&_.push(...p),_.map(a=>e.startsWith("/")&&a===""?"/":a)}function cne(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:_ne(t.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const hne=/^:[\w-]+$/,fne=3,dne=2,pne=1,mne=10,gne=-2,f4=e=>e==="*";function yne(e,t){let n=e.split("/"),o=n.length;return n.some(f4)&&(o+=gne),t&&(o+=dne),n.filter(u=>!f4(u)).reduce((u,h)=>u+(hne.test(h)?fne:h===""?pne:mne),o)}function _ne(e,t){return e.length===t.length&&e.slice(0,-1).every((o,u)=>o===t[u])?e[e.length-1]-t[t.length-1]:0}function vne(e,t,n){let{routesMeta:o}=e,u={},h="/",p=[];for(let _=0;_<o.length;++_){let a=o[_],b=_===o.length-1,C=h==="/"?t:t.slice(h.length)||"/",A=d4({path:a.relativePath,caseSensitive:a.caseSensitive,end:b},C),O=a.route;if(!A&&b&&n&&!o[o.length-1].route.index&&(A=d4({path:a.relativePath,caseSensitive:a.caseSensitive,end:!1},C)),!A)return null;Object.assign(u,A.params),p.push({params:u,pathname:kh([h,A.pathname]),pathnameBase:Ene(kh([h,A.pathnameBase])),route:O}),A.pathnameBase!=="/"&&(h=kh([h,A.pathnameBase]))}return p}function d4(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,o]=xne(e.path,e.caseSensitive,e.end),u=t.match(n);if(!u)return null;let h=u[0],p=h.replace(/(.)\/+$/,"$1"),_=u.slice(1);return{params:o.reduce((b,C,A)=>{let{paramName:O,isOptional:k}=C;if(O==="*"){let z=_[A]||"";p=h.slice(0,h.length-z.length).replace(/(.)\/+$/,"$1")}const N=_[A];return k&&!N?b[O]=void 0:b[O]=(N||"").replace(/%2F/g,"/"),b},{}),pathname:h,pathnameBase:p,pattern:e}}function xne(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),aG(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],u="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,_,a)=>(o.push({paramName:_,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(o.push({paramName:"*"}),u+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?u+="\\/*$":e!==""&&e!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,t?void 0:"i"),o]}function bne(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return aG(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function fk(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,o=e.charAt(n);return o&&o!=="/"?null:e.slice(n)||"/"}function wne(e,t){t===void 0&&(t="/");let{pathname:n,search:o="",hash:u=""}=typeof e=="string"?Ug(e):e;return{pathname:n?n.startsWith("/")?n:Sne(n,t):t,search:Ane(o),hash:Cne(u)}}function Sne(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(u=>{u===".."?n.length>1&&n.pop():u!=="."&&n.push(u)}),n.length>1?n.join("/"):"/"}function tM(e,t,n,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Tne(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function uG(e,t){let n=Tne(e);return t?n.map((o,u)=>u===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function cG(e,t,n,o){o===void 0&&(o=!1);let u;typeof e=="string"?u=Ug(e):(u=w0({},e),Vi(!u.pathname||!u.pathname.includes("?"),tM("?","pathname","search",u)),Vi(!u.pathname||!u.pathname.includes("#"),tM("#","pathname","hash",u)),Vi(!u.search||!u.search.includes("#"),tM("#","search","hash",u)));let h=e===""||u.pathname==="",p=h?"/":u.pathname,_;if(p==null)_=n;else{let A=t.length-1;if(!o&&p.startsWith("..")){let O=p.split("/");for(;O[0]==="..";)O.shift(),A-=1;u.pathname=O.join("/")}_=A>=0?t[A]:"/"}let a=wne(u,_),b=p&&p!=="/"&&p.endsWith("/"),C=(h||p===".")&&n.endsWith("/");return!a.pathname.endsWith("/")&&(b||C)&&(a.pathname+="/"),a}const kh=e=>e.join("/").replace(/\/\/+/g,"/"),Ene=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ane=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Cne=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Pne(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const hG=["post","put","patch","delete"];new Set(hG);const Mne=["get",...hG];new Set(Mne);/**
 * React Router v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},S0.apply(this,arguments)}const dk=W.createContext(null),Ine=W.createContext(null),qd=W.createContext(null),nE=W.createContext(null),Zd=W.createContext({outlet:null,matches:[],isDataRoute:!1}),fG=W.createContext(null);function One(e,t){let{relative:n}=t===void 0?{}:t;yx()||Vi(!1);let{basename:o,navigator:u}=W.useContext(qd),{hash:h,pathname:p,search:_}=pG(e,{relative:n}),a=p;return o!=="/"&&(a=p==="/"?o:kh([o,p])),u.createHref({pathname:a,search:_,hash:h})}function yx(){return W.useContext(nE)!=null}function rE(){return yx()||Vi(!1),W.useContext(nE).location}function dG(e){W.useContext(qd).static||W.useLayoutEffect(e)}function Rne(){let{isDataRoute:e}=W.useContext(Zd);return e?Wne():kne()}function kne(){yx()||Vi(!1);let e=W.useContext(dk),{basename:t,future:n,navigator:o}=W.useContext(qd),{matches:u}=W.useContext(Zd),{pathname:h}=rE(),p=JSON.stringify(uG(u,n.v7_relativeSplatPath)),_=W.useRef(!1);return dG(()=>{_.current=!0}),W.useCallback(function(b,C){if(C===void 0&&(C={}),!_.current)return;if(typeof b=="number"){o.go(b);return}let A=cG(b,JSON.parse(p),h,C.relative==="path");e==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:kh([t,A.pathname])),(C.replace?o.replace:o.push)(A,C.state,C)},[t,o,p,h,e])}function pG(e,t){let{relative:n}=t===void 0?{}:t,{future:o}=W.useContext(qd),{matches:u}=W.useContext(Zd),{pathname:h}=rE(),p=JSON.stringify(uG(u,o.v7_relativeSplatPath));return W.useMemo(()=>cG(e,JSON.parse(p),h,n==="path"),[e,p,h,n])}function Dne(e,t){return Lne(e,t)}function Lne(e,t,n,o){yx()||Vi(!1);let{navigator:u}=W.useContext(qd),{matches:h}=W.useContext(Zd),p=h[h.length-1],_=p?p.params:{};p&&p.pathname;let a=p?p.pathnameBase:"/";p&&p.route;let b=rE(),C;if(t){var A;let U=typeof t=="string"?Ug(t):t;a==="/"||(A=U.pathname)!=null&&A.startsWith(a)||Vi(!1),C=U}else C=b;let O=C.pathname||"/",k=O;if(a!=="/"){let U=a.replace(/^\//,"").split("/");k="/"+O.replace(/^\//,"").split("/").slice(U.length).join("/")}let N=lne(e,{pathname:k}),z=jne(N&&N.map(U=>Object.assign({},U,{params:Object.assign({},_,U.params),pathname:kh([a,u.encodeLocation?u.encodeLocation(U.pathname).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?a:kh([a,u.encodeLocation?u.encodeLocation(U.pathnameBase).pathname:U.pathnameBase])})),h,n,o);return t&&z?W.createElement(nE.Provider,{value:{location:S0({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:bh.Pop}},z):z}function zne(){let e=Gne(),t=Pne(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},t),n?W.createElement("pre",{style:u},n):null,null)}const Fne=W.createElement(zne,null);class Nne extends W.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?W.createElement(Zd.Provider,{value:this.props.routeContext},W.createElement(fG.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Bne(e){let{routeContext:t,match:n,children:o}=e,u=W.useContext(dk);return u&&u.static&&u.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=n.route.id),W.createElement(Zd.Provider,{value:t},o)}function jne(e,t,n,o){var u;if(t===void 0&&(t=[]),n===void 0&&(n=null),o===void 0&&(o=null),e==null){var h;if((h=n)!=null&&h.errors)e=n.matches;else return null}let p=e,_=(u=n)==null?void 0:u.errors;if(_!=null){let C=p.findIndex(A=>A.route.id&&(_==null?void 0:_[A.route.id])!==void 0);C>=0||Vi(!1),p=p.slice(0,Math.min(p.length,C+1))}let a=!1,b=-1;if(n&&o&&o.v7_partialHydration)for(let C=0;C<p.length;C++){let A=p[C];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(b=C),A.route.id){let{loaderData:O,errors:k}=n,N=A.route.loader&&O[A.route.id]===void 0&&(!k||k[A.route.id]===void 0);if(A.route.lazy||N){a=!0,b>=0?p=p.slice(0,b+1):p=[p[0]];break}}}return p.reduceRight((C,A,O)=>{let k,N=!1,z=null,U=null;n&&(k=_&&A.route.id?_[A.route.id]:void 0,z=A.route.errorElement||Fne,a&&(b<0&&O===0?(N=!0,U=null):b===O&&(N=!0,U=A.route.hydrateFallbackElement||null)));let j=t.concat(p.slice(0,O+1)),G=()=>{let H;return k?H=z:N?H=U:A.route.Component?H=W.createElement(A.route.Component,null):A.route.element?H=A.route.element:H=C,W.createElement(Bne,{match:A,routeContext:{outlet:C,matches:j,isDataRoute:n!=null},children:H})};return n&&(A.route.ErrorBoundary||A.route.errorElement||O===0)?W.createElement(Nne,{location:n.location,revalidation:n.revalidation,component:z,error:k,children:G(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):G()},null)}var mG=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(mG||{}),PS=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(PS||{});function $ne(e){let t=W.useContext(dk);return t||Vi(!1),t}function Une(e){let t=W.useContext(Ine);return t||Vi(!1),t}function Vne(e){let t=W.useContext(Zd);return t||Vi(!1),t}function gG(e){let t=Vne(),n=t.matches[t.matches.length-1];return n.route.id||Vi(!1),n.route.id}function Gne(){var e;let t=W.useContext(fG),n=Une(PS.UseRouteError),o=gG(PS.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[o]}function Wne(){let{router:e}=$ne(mG.UseNavigateStable),t=gG(PS.UseNavigateStable),n=W.useRef(!1);return dG(()=>{n.current=!0}),W.useCallback(function(u,h){h===void 0&&(h={}),n.current&&(typeof u=="number"?e.navigate(u):e.navigate(u,S0({fromRouteId:t},h)))},[e,t])}function Dv(e){Vi(!1)}function Hne(e){let{basename:t="/",children:n=null,location:o,navigationType:u=bh.Pop,navigator:h,static:p=!1,future:_}=e;yx()&&Vi(!1);let a=t.replace(/^\/*/,"/"),b=W.useMemo(()=>({basename:a,navigator:h,static:p,future:S0({v7_relativeSplatPath:!1},_)}),[a,_,h,p]);typeof o=="string"&&(o=Ug(o));let{pathname:C="/",search:A="",hash:O="",state:k=null,key:N="default"}=o,z=W.useMemo(()=>{let U=fk(C,a);return U==null?null:{location:{pathname:U,search:A,hash:O,state:k,key:N},navigationType:u}},[a,C,A,O,k,N,u]);return z==null?null:W.createElement(qd.Provider,{value:b},W.createElement(nE.Provider,{children:n,value:z}))}function qne(e){let{children:t,location:n}=e;return Dne(sO(t),n)}new Promise(()=>{});function sO(e,t){t===void 0&&(t=[]);let n=[];return W.Children.forEach(e,(o,u)=>{if(!W.isValidElement(o))return;let h=[...t,u];if(o.type===W.Fragment){n.push.apply(n,sO(o.props.children,h));return}o.type!==Dv&&Vi(!1),!o.props.index||!o.props.children||Vi(!1);let p={id:o.props.id||h.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(p.children=sO(o.props.children,h)),n.push(p)}),n}/**
 * React Router DOM v6.24.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lO(){return lO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},lO.apply(this,arguments)}function Zne(e,t){if(e==null)return{};var n={},o=Object.keys(e),u,h;for(h=0;h<o.length;h++)u=o[h],!(t.indexOf(u)>=0)&&(n[u]=e[u]);return n}function Xne(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Yne(e,t){return e.button===0&&(!t||t==="_self")&&!Xne(e)}const Kne=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],Qne="6";try{window.__reactRouterVersion=Qne}catch{}const Jne="startTransition",p4=bR[Jne];function ere(e){let{basename:t,children:n,future:o,window:u}=e,h=W.useRef();h.current==null&&(h.current=one({window:u,v5Compat:!0}));let p=h.current,[_,a]=W.useState({action:p.action,location:p.location}),{v7_startTransition:b}=o||{},C=W.useCallback(A=>{b&&p4?p4(()=>a(A)):a(A)},[a,b]);return W.useLayoutEffect(()=>p.listen(C),[p,C]),W.createElement(Hne,{basename:t,children:n,location:_.location,navigationType:_.action,navigator:p,future:o})}const tre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nre=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jm=W.forwardRef(function(t,n){let{onClick:o,relative:u,reloadDocument:h,replace:p,state:_,target:a,to:b,preventScrollReset:C,unstable_viewTransition:A}=t,O=Zne(t,Kne),{basename:k}=W.useContext(qd),N,z=!1;if(typeof b=="string"&&nre.test(b)&&(N=b,tre))try{let H=new URL(window.location.href),Y=b.startsWith("//")?new URL(H.protocol+b):new URL(b),K=fk(Y.pathname,k);Y.origin===H.origin&&K!=null?b=K+Y.search+Y.hash:z=!0}catch{}let U=One(b,{relative:u}),j=rre(b,{replace:p,state:_,target:a,preventScrollReset:C,relative:u,unstable_viewTransition:A});function G(H){o&&o(H),H.defaultPrevented||j(H)}return W.createElement("a",lO({},O,{href:N||U,onClick:z||h?o:G,ref:n,target:a}))});var m4;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(m4||(m4={}));var g4;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(g4||(g4={}));function rre(e,t){let{target:n,replace:o,state:u,preventScrollReset:h,relative:p,unstable_viewTransition:_}=t===void 0?{}:t,a=Rne(),b=rE(),C=pG(e,{relative:p});return W.useCallback(A=>{if(Yne(A,n)){A.preventDefault();let O=o!==void 0?o:CS(b)===CS(C);a(e,{replace:O,state:u,preventScrollReset:h,relative:p,unstable_viewTransition:_})}},[b,a,C,o,u,n,e,h,p,_])}const ire="/assets/AWS_Logo-Dd15n5Em.png",ore="/assets/ai-icon-CycfU0Iz.svg",are="/assets/history-icon-jktj9hxs.svg",sre="data:image/svg+xml,%3csvg%20width='25'%20height='25'%20viewBox='0%200%2025%2025'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3crect%20width='25'%20height='25'%20fill='url(%23pattern0_52_36)'/%3e%3cdefs%3e%3cpattern%20id='pattern0_52_36'%20patternContentUnits='objectBoundingBox'%20width='1'%20height='1'%3e%3cuse%20xlink:href='%23image0_52_36'%20transform='scale(0.0078125)'/%3e%3c/pattern%3e%3cimage%20id='image0_52_36'%20width='128'%20height='128'%20xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAe4SURBVHic7Z1tjB1VGYCf9+5HWxDpB0pajF+I1gjVECMQoWqw8kPTP9imwA9tut2725Ca1EqgIWYJBKQhxaTNtrPF9ocmhkZpaAyKqYmJREgwGstHQ41NC4SPANlVAoWld19/7Bbv3p2PO3vvfJw57/Nv55w58ybned8zM3tnBgzDMAzD8BEpOoA80T0so48NKNcjfBm4eKbpP8Ax4Aka/Fq2cLK4KPPFCwFmJv4uYABYkNQd4QhwmwxyIvvoiqXyAmjAOmAUuCjlrh8g7GIxP5X1TGYQWimorAC6l49TYxS4scOhjgEbpc7fuxBW6aikAB1kfRSVrQaVEqCLWR9F5apBZQTIIOujqFQ1cF6AHLI+ikpUg1rRAXSCjrGBGs+RfvJfRBngLMtpsBRlLfB0yjFWAU/qPu7UgL6U+5YGJytAB1mvwH562S6beHtWwwg1ljMAPAicl3JcZ6uBcwJ0sNafRhiQQY4mjH8pcABYnXJ8J88NnBEgi6yP3MGjauCEAFlnfcxxK18NSi1AnlkfOVDFq0FpBSgq62PiqWQ1KJ0AZcj6yANUsBqUSoCyZX0UVaoGpRCgzFkfeeCKVIPCBXAl66NwvRoUJoCLWR+Fy9WgEAFcz/ooXKwGuQpQpayPouNqMMUPZZh/ZBBaKLkJUNWsj8KVapC5AD5kfRQuVINMBfAt66MoczXIRACfsz6KslaDrgtgWR9P2apB1wSwrG+fMlWDrghgWT8/ylANOhLAsr5ziq4G8xbAsr67FFUNUgtgWZ8dRVSDVAJY1udDntWgLQEs6/Mnr2qQKICOcQPKL4GPpQziFMqADPGnlPsZTeh+vkiDAwhXp9z1fWC71NkT1yn20TANuBnld6SbfAXG6GWVTX7nyGaO8xpfB+rAuyl2XQDs1oBR1ehEj2zQgO8AjwE9KQ5qa32GzPvcQNghg9wX3hR2oOk1/ziwtN3YEAJ6uM3W+mzRQ/Qwzo+Bu4CFbe7WoMa1spmnWhvClwDhHtqf/FMoa2SQYZv87JH1NKTOTmpcic6d0Ah6mGJ36HitGzRgOXAK6E8Y1LK+YFJXA2FN6/IcVgHWkTz5L1nWF8+sagB/S9xhiltaN4UJ8O2EYV4GrrIz/PIgmznOO6xG+Ut8R9a0bgoTYFXCIDukzqupIjQyR7ZxBmVLQrdL9KHZ53ZhAsTf5m3weMrYjJyQYZ5lukJHox++HhcIF2BR7AA1xtMGZuTKWwnts24rO/2SKKNzTADPMQE8xwTwHBPAc0wAzzEBPMcEqBrC+7HtDc40/2kCVI9nYtreYZJ/N28wAarGFLuI+umYsFO2zq4QJkDFkCGeB24A/tm0+S3gR7zCPa39e/MKzMgPqfME8BU9yGIaXMgmXhRBQ/u2btCABvGVoV/qfNClWI2CsSXAc0wAzzEBPMcE8BwTwHNMAM+x+wAVRAM+iXIvwrXAYpRj1HhABjnS2tcqQMWYebLrKYRbgE8BFyJch/KoBvygtb8JUDWE7cDyiNb79dDsp71NgKqhsS+SuJgJLm3eYAJUj/NjW4ULmv80ATzHBPAcE8BzKnUfQA/RzzjfBNYClwGXkPSsYzKTwOvASYQ/0MPvq/ROhEoIoIfoZ4JhxrmT9C+xbIeVwDdQNnKW9zRgNw3uky3uPyjr/BKgASsZ5xjKz8lm8ltZCPyEHv6l++a+cME1nBZAA74FPAl8oYDDL0N4TAPqBRy7azgrgAasBB4BFhcYRi8wqmOsLTCGjnBSAD3IQuAIxU7+OWoov9L9fKboQOaDkwIwyVamz/LLwgVMzf3JtQs4J4DuYhFwe9FxhHCTjvGlooNIi3uXgR9hDcqShF5vAj9DOcpUh9fsfSxAuQrlDuDzMT0FZR3wXEfHyxn3BCDxhOsN4Bqpz34GrkOO6y/4LWf5M3BlTL+1wEgXj5s5zi0BaMIln3J3lycfANnE20yxNaFbEZejHeGeALAitrWW4XsMh/gr8N+YHufpaOLyVCpcFCD+0q83u9uzM8/XJY1vAhjuYAJ4jgngOSaA55gAnmMCeI4J4DkmgOeYAJ5jAniOCeA5JoDnmACeYwJ4jgngOS4KEP8+fOW9nOKoBC4K8HxM2+kqPbiZBy4KsBOYimi7P89AqoBzAkidP6LcDLzStHkC2CZ19hYUlrO4+LNwZIiHgYd1L59G6GMpJ2U9jaLjchEnBTiHDHOq6Bhcx7klwOguJoDnhAlwJmTb/+llYTahGF0i/p1IbXw38NXYAc7y1dQhGbmge1gGfDa204JZV0+hApxOOM6Ijrh98lhZ+hgh/sR+QjYy0bwhTICkZ+tWs4JH9SE+lzI8IyM04CIN2APcmtB1ztzO/WzcPi5DeCGsLYTTTD+L7xNXAP0x7c+S9P+K7vJRpst+T1JHlA0z91A+JHSSNeA3wI3diM4oDSeAy1u/+Rh+GSjsAPs4ZKVQ7gj74GeoADLICYSh7KMycuKgDPFIWEPkjSAZ5ADwYGYhGXlxlCXRyRx7J1DqbAPq2HLgJsp+lvBdWc9kVJd2zvTRvXwN4QGE67oXnZEhJxBul0EOJ3VsS4Bz6D6up8b3Ub4HfGLe4RlZMA48jnAY5XC7X3hPJUAzuotFnM8KaqV4XavPvEuNl+2ncIZhGEZK/gc3CKA2BicJOQAAAABJRU5ErkJggg=='/%3e%3c/defs%3e%3c/svg%3e";function iE({page:e}){return re.jsx("div",{className:" z-20 fixed overflow-hidden top-0 left-0 w-full justify-between py-4 bg-sky-950 shadow-[0_4px_6px_-1px_rgba(255,255,255,0.2),0_2px_4px_-2px_rgba(255,255,255,0.8)]",children:re.jsxs("div",{className:"flex text-sm text-white items-center",children:[re.jsx("img",{alt:"AWS",src:ire,className:"mx-5 h-5"}),re.jsxs(jm,{className:"mx-6 whitespace-nowrap flex items-center font-ember text-sm",to:"/",children:[re.jsx("span",{children:"AWS LQ"}),e==="YYC Portal"&&re.jsx("div",{className:"py-1 bg-orange-500"})]}),re.jsxs(jm,{className:"mx-6 flex items-center font-ember text-sm",to:"/latency",children:[re.jsx("img",{src:sre,alt:"Home",className:"mr-2 h-5"})," ",re.jsx("span",{children:"Dashboard"}),e==="Dashboard"&&re.jsx("div",{className:"py-1 bg-orange-500"})]}),re.jsxs(jm,{className:"mx-6 whitespace-nowrap flex items-center text-sm font-ember",to:"/history",children:[re.jsx("img",{src:are,alt:"History",className:"mr-2 h-5"})," ",re.jsx("span",{children:"Latency History"}),e==="Latency History"&&re.jsx("div",{className:"py-1 bg-orange-500"})]}),re.jsxs(jm,{className:"mx-6 flex items-center font-ember text-sm",to:"/chatbox",children:[re.jsx("img",{src:ore,alt:"Chatbox",className:"mr-2 h-5"})," ",re.jsx("span",{children:"Chatbot"}),e==="Chatbox"&&re.jsx("div",{className:"py-1 bg-orange-500"})]})]})})}const lre="/assets/world-map-kZTld0sP.svg",ure="/assets/c2r-image-B8uNqJ8l.svg",cre="/assets/r2r-image-CXU8v8oV.svg",y4="/assets/r2c-image-BZnDLF7J.svg",hre="/assets/chatbot-image-kkPVen4E.svg",dv=({text:e,infoHighlighted:t,setInfoHighlighted:n,gradientClass:o})=>{const u=t===e;return re.jsx("button",{className:`flex-grow p-3 mx-1 font-ember rounded-full text-gray-800 hover:text-white transition-colors duration-300 ease-in-out ${u?o:"font-ember hover:bg-gradient-to-r from-indigo-400 to-blue-200"} ${u?"shadow-lg text-white":""}`,onClick:()=>n(e),children:e})};function fre(){const[e,t]=W.useState("Amazon LQ"),n={"Amazon LQ":"Amazon LQ is a streamlined tool for querying latency information. Users are provided with several services that provide latency times between different locations.","Client to Region":"By selecting AWS regions, our system displays latency times from those regions directly to your location.","Region to Region":"View latency times and latency history between any two regions. Change region locations at any time and with ease.","Region to Client":"Users can view latency times not only from their location, but from any location by providing a URL. Latencies from unique locations can connect to any region.","AI Chatbot":"Interact with a friendly chat bot that provides information about several AWS services. Furthermore, the chat bot allows users to view and delete chat history."};return re.jsxs("div",{className:"bg-white min-h-screen pt-16",children:[re.jsx(iE,{page:"YYC Portal"}),re.jsx("div",{className:"flex justify-center",children:re.jsxs("div",{className:"flex justify-center items-center mx-20 py-16 w-3/4",children:[re.jsxs("div",{className:"pt-14",children:[re.jsx("h1",{className:"text-5xl text-sky-950 font-bold font-ember mb-6",children:"AWS LQ"}),re.jsxs("p",{className:"text-normal font-sans text-gray-700 font-ember mb-8 leading-relaxed",children:["Our tools provide precise latency data for location-to-region, ",re.jsx("span",{className:"text-customBtn",children:"region-to-region"}),", ",re.jsx("span",{className:"text-customBtn",children:"region-to-client"}),", and ",re.jsx("span",{className:"text-customBtn",children:"client-to-region"})," testing, helping you ensure efficient and reliable network performance."]}),re.jsx("button",{className:"p-3 px-10 mb-6 rounded-full text-white bg-gradient-to-r from-violet-700 to-indigo-700 font-ember text-base shadow-lg hover:shadow-xl transition-shadow duration-300",children:re.jsx(jm,{to:"/latency",children:"Get Started"})})]}),re.jsx("img",{src:lre,alt:"World Map",className:"w-2/3"})]})}),re.jsx("div",{className:"flex justify-center mb-16",children:re.jsxs("div",{className:"flex justify-evenly w-3/4 py-1 border border-gray-300 rounded-full shadow-sm bg-white",children:[re.jsx(dv,{gradientClass:"bg-gradient-to-r from-violet-400 to-indigo-500",text:"Amazon LQ",infoHighlighted:e,setInfoHighlighted:t}),re.jsx(dv,{gradientClass:"bg-gradient-to-r from-violet-400 to-indigo-500",text:"Client to Region",infoHighlighted:e,setInfoHighlighted:t}),re.jsx(dv,{gradientClass:"bg-gradient-to-r from-violet-400 to-indigo-500",text:"Region to Region",infoHighlighted:e,setInfoHighlighted:t}),re.jsx(dv,{gradientClass:"bg-gradient-to-r from-violet-400 to-indigo-500",text:"Region to Client",infoHighlighted:e,setInfoHighlighted:t}),re.jsx(dv,{gradientClass:"bg-gradient-to-r from-violet-400 to-indigo-500",text:"AI Chatbot",infoHighlighted:e,setInfoHighlighted:t})]})}),re.jsx("div",{className:"flex justify-center",children:re.jsxs("div",{className:"flex items-start w-3/4 mx-0 pb-32",children:[re.jsxs("div",{className:"w-2/5 pt-20",children:[re.jsx("h2",{className:"text-3xl font-bold font-ember text-sky-950 mb-6",children:e}),re.jsx("p",{className:"text-lg text-gray-600 leading-relaxed",children:n[e]})]}),re.jsx("div",{className:"flex-1 md:w-1/3 flex justify-center items-center",children:re.jsx("img",{className:"h-64 pl-20 pt-10 object-contain",src:e==="Amazon LQ"?y4:e==="Client to Region"?ure:e==="Region to Region"?cre:e==="Region to Client"?y4:hre,alt:"Related Illustration"})})]})})]})}var yG={exports:{}},dre="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",pre=dre,mre=pre;function _G(){}function vG(){}vG.resetWarningCache=_G;var gre=function(){function e(o,u,h,p,_,a){if(a!==mre){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:vG,resetWarningCache:_G};return n.PropTypes=n,n};yG.exports=gre();var yre=yG.exports;const En=Vr(yre);var xG={exports:{}};(function(e,t){var n={};(function(o,u){e.exports=u()})(pd,function(){var o,u,h;function p(a,b){if(!o)o=b;else if(!u)u=b;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",A={};o(A),h=b(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}p(["exports"],function(a){var b="3.5.1";let C;const A={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(C==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{C=n.API_URL_REGEX!=null?new RegExp(n.API_URL_REGEX):i}catch{C=i}}return C},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!A.API_URL)return null;try{const i=new URL(A.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function O(i){return A.API_URL_REGEX.test(i)}function k(i){return i.indexOf("mapbox:")===0}function N(i){return A.API_CDN_URL_REGEX.test(i)}function z(i){return A.API_SPRITE_REGEX.test(i)}function U(i){return A.API_STYLE_REGEX.test(i)&&!z(i)}const j={create:"create",load:"load",fullLoad:"fullLoad"},G={mark(i){performance.mark(i)},measure(i,r,s){performance.measure(i,r,s)}};function H(i){const r=i.name.split("?")[0];return N(r)&&r.includes("mapbox-gl.js")?"javascript":N(r)&&r.includes("mapbox-gl.css")?"css":function(s){return A.API_FONTS_REGEX.test(s)}(r)?"fontRange":z(r)?"sprite":U(r)?"style":function(s){return A.API_TILEJSON_REGEX.test(s)}(r)?"tilejson":"other"}function Y(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var K={},ee={};Object.defineProperty(ee,"__esModule",{value:!0}),ee.setMatrixArrayType=function(i){ee.ARRAY_TYPE=ve=i},ee.toRadian=function(i){return i*Ne},ee.equals=function(i,r){return Math.abs(i-r)<=ue*Math.max(1,Math.abs(i),Math.abs(r))},ee.RANDOM=ee.ARRAY_TYPE=ee.EPSILON=void 0;var ue=1e-6;ee.EPSILON=ue;var ve=typeof Float32Array<"u"?Float32Array:Array;ee.ARRAY_TYPE=ve;var Fe=Math.random;ee.RANDOM=Fe;var Ne=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var i=0,r=arguments.length;r--;)i+=arguments[r]*arguments[r];return Math.sqrt(i)});var Oe={};function Le(i){return Le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Le(i)}Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=function(){var i=new Ue.ARRAY_TYPE(4);return Ue.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},Oe.clone=function(i){var r=new Ue.ARRAY_TYPE(4);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r},Oe.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i},Oe.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i},Oe.fromValues=function(i,r,s,c){var f=new Ue.ARRAY_TYPE(4);return f[0]=i,f[1]=r,f[2]=s,f[3]=c,f},Oe.set=function(i,r,s,c,f){return i[0]=r,i[1]=s,i[2]=c,i[3]=f,i},Oe.transpose=function(i,r){if(i===r){var s=r[1];i[1]=r[2],i[2]=s}else i[0]=r[0],i[1]=r[2],i[2]=r[1],i[3]=r[3];return i},Oe.invert=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=s*m-f*c;return g?(i[0]=m*(g=1/g),i[1]=-c*g,i[2]=-f*g,i[3]=s*g,i):null},Oe.adjoint=function(i,r){var s=r[0];return i[0]=r[3],i[1]=-r[1],i[2]=-r[2],i[3]=s,i},Oe.determinant=function(i){return i[0]*i[3]-i[2]*i[1]},Oe.multiply=rt,Oe.rotate=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=Math.sin(s),w=Math.cos(s);return i[0]=c*w+m*x,i[1]=f*w+g*x,i[2]=c*-x+m*w,i[3]=f*-x+g*w,i},Oe.scale=function(i,r,s){var c=r[1],f=r[2],m=r[3],g=s[0],x=s[1];return i[0]=r[0]*g,i[1]=c*g,i[2]=f*x,i[3]=m*x,i},Oe.fromRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=-s,i[3]=c,i},Oe.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=r[1],i},Oe.str=function(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},Oe.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},Oe.LDU=function(i,r,s,c){return i[2]=c[2]/c[0],s[0]=c[0],s[1]=c[1],s[3]=c[3]-i[2]*s[1],[i,r,s]},Oe.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i},Oe.subtract=st,Oe.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]},Oe.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=i[3],g=r[0],x=r[1],w=r[2],E=r[3];return Math.abs(s-g)<=Ue.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-x)<=Ue.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(f-w)<=Ue.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(m-E)<=Ue.EPSILON*Math.max(1,Math.abs(m),Math.abs(E))},Oe.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i},Oe.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i},Oe.sub=Oe.mul=void 0;var Ue=function(i,r){if(i&&i.__esModule)return i;if(i===null||Le(i)!=="object"&&typeof i!="function")return{default:i};var s=et(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function et(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(et=function(c){return c?s:r})(i)}function rt(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=s[0],w=s[1],E=s[2],M=s[3];return i[0]=c*x+m*w,i[1]=f*x+g*w,i[2]=c*E+m*M,i[3]=f*E+g*M,i}function st(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i}Oe.mul=rt,Oe.sub=st;var Ke={};function Ze(i){return Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ze(i)}Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.create=function(){var i=new Xe.ARRAY_TYPE(6);return Xe.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[4]=0,i[5]=0),i[0]=1,i[3]=1,i},Ke.clone=function(i){var r=new Xe.ARRAY_TYPE(6);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r},Ke.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i},Ke.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i},Ke.fromValues=function(i,r,s,c,f,m){var g=new Xe.ARRAY_TYPE(6);return g[0]=i,g[1]=r,g[2]=s,g[3]=c,g[4]=f,g[5]=m,g},Ke.set=function(i,r,s,c,f,m,g){return i[0]=r,i[1]=s,i[2]=c,i[3]=f,i[4]=m,i[5]=g,i},Ke.invert=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=s*m-c*f;return w?(i[0]=m*(w=1/w),i[1]=-c*w,i[2]=-f*w,i[3]=s*w,i[4]=(f*x-m*g)*w,i[5]=(c*g-s*x)*w,i):null},Ke.determinant=function(i){return i[0]*i[3]-i[1]*i[2]},Ke.multiply=lt,Ke.rotate=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=Math.sin(s),M=Math.cos(s);return i[0]=c*M+m*E,i[1]=f*M+g*E,i[2]=c*-E+m*M,i[3]=f*-E+g*M,i[4]=x,i[5]=w,i},Ke.scale=function(i,r,s){var c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=s[0],E=s[1];return i[0]=r[0]*w,i[1]=c*w,i[2]=f*E,i[3]=m*E,i[4]=g,i[5]=x,i},Ke.translate=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=s[0],M=s[1];return i[0]=c,i[1]=f,i[2]=m,i[3]=g,i[4]=c*E+m*M+x,i[5]=f*E+g*M+w,i},Ke.fromRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=-s,i[3]=c,i[4]=0,i[5]=0,i},Ke.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=r[1],i[4]=0,i[5]=0,i},Ke.fromTranslation=function(i,r){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=r[0],i[5]=r[1],i},Ke.str=function(i){return"mat2d("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+")"},Ke.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],1)},Ke.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i},Ke.subtract=gt,Ke.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i},Ke.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i[4]=r[4]+s[4]*c,i[5]=r[5]+s[5]*c,i},Ke.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]},Ke.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=i[3],g=i[4],x=i[5],w=r[0],E=r[1],M=r[2],R=r[3],D=r[4],B=r[5];return Math.abs(s-w)<=Xe.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(c-E)<=Xe.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(f-M)<=Xe.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(m-R)<=Xe.EPSILON*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(g-D)<=Xe.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(x-B)<=Xe.EPSILON*Math.max(1,Math.abs(x),Math.abs(B))},Ke.sub=Ke.mul=void 0;var Xe=function(i,r){if(i&&i.__esModule)return i;if(i===null||Ze(i)!=="object"&&typeof i!="function")return{default:i};var s=de(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function de(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(de=function(c){return c?s:r})(i)}function lt(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=s[0],M=s[1],R=s[2],D=s[3],B=s[4],$=s[5];return i[0]=c*E+m*M,i[1]=f*E+g*M,i[2]=c*R+m*D,i[3]=f*R+g*D,i[4]=c*B+m*$+x,i[5]=f*B+g*$+w,i}function gt(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i[4]=r[4]-s[4],i[5]=r[5]-s[5],i}Ke.mul=lt,Ke.sub=gt;var Se={};function qt(i){return qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},qt(i)}Object.defineProperty(Se,"__esModule",{value:!0}),Se.create=function(){var i=new an.ARRAY_TYPE(9);return an.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},Se.fromMat4=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[4],i[4]=r[5],i[5]=r[6],i[6]=r[8],i[7]=r[9],i[8]=r[10],i},Se.clone=function(i){var r=new an.ARRAY_TYPE(9);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r},Se.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i},Se.fromValues=function(i,r,s,c,f,m,g,x,w){var E=new an.ARRAY_TYPE(9);return E[0]=i,E[1]=r,E[2]=s,E[3]=c,E[4]=f,E[5]=m,E[6]=g,E[7]=x,E[8]=w,E},Se.set=function(i,r,s,c,f,m,g,x,w,E){return i[0]=r,i[1]=s,i[2]=c,i[3]=f,i[4]=m,i[5]=g,i[6]=x,i[7]=w,i[8]=E,i},Se.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},Se.transpose=function(i,r){if(i===r){var s=r[1],c=r[2],f=r[5];i[1]=r[3],i[2]=r[6],i[3]=s,i[5]=r[7],i[6]=c,i[7]=f}else i[0]=r[0],i[1]=r[3],i[2]=r[6],i[3]=r[1],i[4]=r[4],i[5]=r[7],i[6]=r[2],i[7]=r[5],i[8]=r[8];return i},Se.invert=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=r[6],E=r[7],M=r[8],R=M*g-x*E,D=-M*m+x*w,B=E*m-g*w,$=s*R+c*D+f*B;return $?(i[0]=R*($=1/$),i[1]=(-M*c+f*E)*$,i[2]=(x*c-f*g)*$,i[3]=D*$,i[4]=(M*s-f*w)*$,i[5]=(-x*s+f*m)*$,i[6]=B*$,i[7]=(-E*s+c*w)*$,i[8]=(g*s-c*m)*$,i):null},Se.adjoint=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=r[6],E=r[7],M=r[8];return i[0]=g*M-x*E,i[1]=f*E-c*M,i[2]=c*x-f*g,i[3]=x*w-m*M,i[4]=s*M-f*w,i[5]=f*m-s*x,i[6]=m*E-g*w,i[7]=c*w-s*E,i[8]=s*g-c*m,i},Se.determinant=function(i){var r=i[3],s=i[4],c=i[5],f=i[6],m=i[7],g=i[8];return i[0]*(g*s-c*m)+i[1]*(-g*r+c*f)+i[2]*(m*r-s*f)},Se.multiply=Wt,Se.translate=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=r[8],D=s[0],B=s[1];return i[0]=c,i[1]=f,i[2]=m,i[3]=g,i[4]=x,i[5]=w,i[6]=D*c+B*g+E,i[7]=D*f+B*x+M,i[8]=D*m+B*w+R,i},Se.rotate=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=r[8],D=Math.sin(s),B=Math.cos(s);return i[0]=B*c+D*g,i[1]=B*f+D*x,i[2]=B*m+D*w,i[3]=B*g-D*c,i[4]=B*x-D*f,i[5]=B*w-D*m,i[6]=E,i[7]=M,i[8]=R,i},Se.scale=function(i,r,s){var c=s[0],f=s[1];return i[0]=c*r[0],i[1]=c*r[1],i[2]=c*r[2],i[3]=f*r[3],i[4]=f*r[4],i[5]=f*r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i},Se.fromTranslation=function(i,r){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=r[0],i[7]=r[1],i[8]=1,i},Se.fromRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=0,i[3]=-s,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},Se.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=r[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},Se.fromMat2d=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=0,i[3]=r[2],i[4]=r[3],i[5]=0,i[6]=r[4],i[7]=r[5],i[8]=1,i},Se.fromQuat=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=s+s,x=c+c,w=f+f,E=s*g,M=c*g,R=c*x,D=f*g,B=f*x,$=f*w,q=m*g,X=m*x,te=m*w;return i[0]=1-R-$,i[3]=M-te,i[6]=D+X,i[1]=M+te,i[4]=1-E-$,i[7]=B-q,i[2]=D-X,i[5]=B+q,i[8]=1-E-R,i},Se.normalFromMat4=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=r[6],E=r[7],M=r[8],R=r[9],D=r[10],B=r[11],$=r[12],q=r[13],X=r[14],te=r[15],ce=s*x-c*g,he=s*w-f*g,fe=s*E-m*g,Ee=c*w-f*x,we=c*E-m*x,Ie=f*E-m*w,ke=M*q-R*$,$e=M*X-D*$,nt=M*te-B*$,He=R*X-D*q,ut=R*te-B*q,bt=D*te-B*X,ot=ce*bt-he*ut+fe*He+Ee*nt-we*$e+Ie*ke;return ot?(i[0]=(x*bt-w*ut+E*He)*(ot=1/ot),i[1]=(w*nt-g*bt-E*$e)*ot,i[2]=(g*ut-x*nt+E*ke)*ot,i[3]=(f*ut-c*bt-m*He)*ot,i[4]=(s*bt-f*nt+m*$e)*ot,i[5]=(c*nt-s*ut-m*ke)*ot,i[6]=(q*Ie-X*we+te*Ee)*ot,i[7]=(X*fe-$*Ie-te*he)*ot,i[8]=($*we-q*fe+te*ce)*ot,i):null},Se.projection=function(i,r,s){return i[0]=2/r,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/s,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i},Se.str=function(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"},Se.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},Se.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i[6]=r[6]+s[6],i[7]=r[7]+s[7],i[8]=r[8]+s[8],i},Se.subtract=An,Se.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i[8]=r[8]*s,i},Se.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i[4]=r[4]+s[4]*c,i[5]=r[5]+s[5]*c,i[6]=r[6]+s[6]*c,i[7]=r[7]+s[7]*c,i[8]=r[8]+s[8]*c,i},Se.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]},Se.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=i[3],g=i[4],x=i[5],w=i[6],E=i[7],M=i[8],R=r[0],D=r[1],B=r[2],$=r[3],q=r[4],X=r[5],te=r[6],ce=r[7],he=r[8];return Math.abs(s-R)<=an.EPSILON*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(c-D)<=an.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(f-B)<=an.EPSILON*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(m-$)<=an.EPSILON*Math.max(1,Math.abs(m),Math.abs($))&&Math.abs(g-q)<=an.EPSILON*Math.max(1,Math.abs(g),Math.abs(q))&&Math.abs(x-X)<=an.EPSILON*Math.max(1,Math.abs(x),Math.abs(X))&&Math.abs(w-te)<=an.EPSILON*Math.max(1,Math.abs(w),Math.abs(te))&&Math.abs(E-ce)<=an.EPSILON*Math.max(1,Math.abs(E),Math.abs(ce))&&Math.abs(M-he)<=an.EPSILON*Math.max(1,Math.abs(M),Math.abs(he))},Se.sub=Se.mul=void 0;var an=function(i,r){if(i&&i.__esModule)return i;if(i===null||qt(i)!=="object"&&typeof i!="function")return{default:i};var s=dn(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function dn(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(dn=function(c){return c?s:r})(i)}function Wt(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=r[8],D=s[0],B=s[1],$=s[2],q=s[3],X=s[4],te=s[5],ce=s[6],he=s[7],fe=s[8];return i[0]=D*c+B*g+$*E,i[1]=D*f+B*x+$*M,i[2]=D*m+B*w+$*R,i[3]=q*c+X*g+te*E,i[4]=q*f+X*x+te*M,i[5]=q*m+X*w+te*R,i[6]=ce*c+he*g+fe*E,i[7]=ce*f+he*x+fe*M,i[8]=ce*m+he*w+fe*R,i}function An(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i[4]=r[4]-s[4],i[5]=r[5]-s[5],i[6]=r[6]-s[6],i[7]=r[7]-s[7],i[8]=r[8]-s[8],i}Se.mul=Wt,Se.sub=An;var ht={};function Zt(i){return Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Zt(i)}Object.defineProperty(ht,"__esModule",{value:!0}),ht.create=function(){var i=new jt.ARRAY_TYPE(16);return jt.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},ht.clone=function(i){var r=new jt.ARRAY_TYPE(16);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},ht.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},ht.fromValues=function(i,r,s,c,f,m,g,x,w,E,M,R,D,B,$,q){var X=new jt.ARRAY_TYPE(16);return X[0]=i,X[1]=r,X[2]=s,X[3]=c,X[4]=f,X[5]=m,X[6]=g,X[7]=x,X[8]=w,X[9]=E,X[10]=M,X[11]=R,X[12]=D,X[13]=B,X[14]=$,X[15]=q,X},ht.set=function(i,r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X){return i[0]=r,i[1]=s,i[2]=c,i[3]=f,i[4]=m,i[5]=g,i[6]=x,i[7]=w,i[8]=E,i[9]=M,i[10]=R,i[11]=D,i[12]=B,i[13]=$,i[14]=q,i[15]=X,i},ht.identity=er,ht.transpose=function(i,r){if(i===r){var s=r[1],c=r[2],f=r[3],m=r[6],g=r[7],x=r[11];i[1]=r[4],i[2]=r[8],i[3]=r[12],i[4]=s,i[6]=r[9],i[7]=r[13],i[8]=c,i[9]=m,i[11]=r[14],i[12]=f,i[13]=g,i[14]=x}else i[0]=r[0],i[1]=r[4],i[2]=r[8],i[3]=r[12],i[4]=r[1],i[5]=r[5],i[6]=r[9],i[7]=r[13],i[8]=r[2],i[9]=r[6],i[10]=r[10],i[11]=r[14],i[12]=r[3],i[13]=r[7],i[14]=r[11],i[15]=r[15];return i},ht.invert=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=r[6],E=r[7],M=r[8],R=r[9],D=r[10],B=r[11],$=r[12],q=r[13],X=r[14],te=r[15],ce=s*x-c*g,he=s*w-f*g,fe=s*E-m*g,Ee=c*w-f*x,we=c*E-m*x,Ie=f*E-m*w,ke=M*q-R*$,$e=M*X-D*$,nt=M*te-B*$,He=R*X-D*q,ut=R*te-B*q,bt=D*te-B*X,ot=ce*bt-he*ut+fe*He+Ee*nt-we*$e+Ie*ke;return ot?(i[0]=(x*bt-w*ut+E*He)*(ot=1/ot),i[1]=(f*ut-c*bt-m*He)*ot,i[2]=(q*Ie-X*we+te*Ee)*ot,i[3]=(D*we-R*Ie-B*Ee)*ot,i[4]=(w*nt-g*bt-E*$e)*ot,i[5]=(s*bt-f*nt+m*$e)*ot,i[6]=(X*fe-$*Ie-te*he)*ot,i[7]=(M*Ie-D*fe+B*he)*ot,i[8]=(g*ut-x*nt+E*ke)*ot,i[9]=(c*nt-s*ut-m*ke)*ot,i[10]=($*we-q*fe+te*ce)*ot,i[11]=(R*fe-M*we-B*ce)*ot,i[12]=(x*$e-g*He-w*ke)*ot,i[13]=(s*He-c*$e+f*ke)*ot,i[14]=(q*he-$*Ee-X*ce)*ot,i[15]=(M*Ee-R*he+D*ce)*ot,i):null},ht.adjoint=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=r[4],x=r[5],w=r[6],E=r[7],M=r[8],R=r[9],D=r[10],B=r[11],$=r[12],q=r[13],X=r[14],te=r[15];return i[0]=x*(D*te-B*X)-R*(w*te-E*X)+q*(w*B-E*D),i[1]=-(c*(D*te-B*X)-R*(f*te-m*X)+q*(f*B-m*D)),i[2]=c*(w*te-E*X)-x*(f*te-m*X)+q*(f*E-m*w),i[3]=-(c*(w*B-E*D)-x*(f*B-m*D)+R*(f*E-m*w)),i[4]=-(g*(D*te-B*X)-M*(w*te-E*X)+$*(w*B-E*D)),i[5]=s*(D*te-B*X)-M*(f*te-m*X)+$*(f*B-m*D),i[6]=-(s*(w*te-E*X)-g*(f*te-m*X)+$*(f*E-m*w)),i[7]=s*(w*B-E*D)-g*(f*B-m*D)+M*(f*E-m*w),i[8]=g*(R*te-B*q)-M*(x*te-E*q)+$*(x*B-E*R),i[9]=-(s*(R*te-B*q)-M*(c*te-m*q)+$*(c*B-m*R)),i[10]=s*(x*te-E*q)-g*(c*te-m*q)+$*(c*E-m*x),i[11]=-(s*(x*B-E*R)-g*(c*B-m*R)+M*(c*E-m*x)),i[12]=-(g*(R*X-D*q)-M*(x*X-w*q)+$*(x*D-w*R)),i[13]=s*(R*X-D*q)-M*(c*X-f*q)+$*(c*D-f*R),i[14]=-(s*(x*X-w*q)-g*(c*X-f*q)+$*(c*w-f*x)),i[15]=s*(x*D-w*R)-g*(c*D-f*R)+M*(c*w-f*x),i},ht.determinant=function(i){var r=i[0],s=i[1],c=i[2],f=i[3],m=i[4],g=i[5],x=i[6],w=i[7],E=i[8],M=i[9],R=i[10],D=i[11],B=i[12],$=i[13],q=i[14],X=i[15];return(r*g-s*m)*(R*X-D*q)-(r*x-c*m)*(M*X-D*$)+(r*w-f*m)*(M*q-R*$)+(s*x-c*g)*(E*X-D*B)-(s*w-f*g)*(E*q-R*B)+(c*w-f*x)*(E*$-M*B)},ht.multiply=Rn,ht.translate=function(i,r,s){var c,f,m,g,x,w,E,M,R,D,B,$,q=s[0],X=s[1],te=s[2];return r===i?(i[12]=r[0]*q+r[4]*X+r[8]*te+r[12],i[13]=r[1]*q+r[5]*X+r[9]*te+r[13],i[14]=r[2]*q+r[6]*X+r[10]*te+r[14],i[15]=r[3]*q+r[7]*X+r[11]*te+r[15]):(f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=r[8],D=r[9],B=r[10],$=r[11],i[0]=c=r[0],i[1]=f,i[2]=m,i[3]=g,i[4]=x,i[5]=w,i[6]=E,i[7]=M,i[8]=R,i[9]=D,i[10]=B,i[11]=$,i[12]=c*q+x*X+R*te+r[12],i[13]=f*q+w*X+D*te+r[13],i[14]=m*q+E*X+B*te+r[14],i[15]=g*q+M*X+$*te+r[15]),i},ht.scale=function(i,r,s){var c=s[0],f=s[1],m=s[2];return i[0]=r[0]*c,i[1]=r[1]*c,i[2]=r[2]*c,i[3]=r[3]*c,i[4]=r[4]*f,i[5]=r[5]*f,i[6]=r[6]*f,i[7]=r[7]*f,i[8]=r[8]*m,i[9]=r[9]*m,i[10]=r[10]*m,i[11]=r[11]*m,i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},ht.rotate=function(i,r,s,c){var f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee,we,Ie,ke,$e,nt,He,ut=c[0],bt=c[1],ot=c[2],yt=Math.hypot(ut,bt,ot);return yt<jt.EPSILON?null:(ut*=yt=1/yt,bt*=yt,ot*=yt,f=Math.sin(s),m=Math.cos(s),w=r[1],E=r[2],M=r[3],D=r[5],B=r[6],$=r[7],X=r[9],te=r[10],ce=r[11],he=ut*ut*(g=1-m)+m,we=ut*bt*g-ot*f,Ie=bt*bt*g+m,ke=ot*bt*g+ut*f,$e=ut*ot*g+bt*f,nt=bt*ot*g-ut*f,He=ot*ot*g+m,i[0]=(x=r[0])*he+(R=r[4])*(fe=bt*ut*g+ot*f)+(q=r[8])*(Ee=ot*ut*g-bt*f),i[1]=w*he+D*fe+X*Ee,i[2]=E*he+B*fe+te*Ee,i[3]=M*he+$*fe+ce*Ee,i[4]=x*we+R*Ie+q*ke,i[5]=w*we+D*Ie+X*ke,i[6]=E*we+B*Ie+te*ke,i[7]=M*we+$*Ie+ce*ke,i[8]=x*$e+R*nt+q*He,i[9]=w*$e+D*nt+X*He,i[10]=E*$e+B*nt+te*He,i[11]=M*$e+$*nt+ce*He,r!==i&&(i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i)},ht.rotateX=function(i,r,s){var c=Math.sin(s),f=Math.cos(s),m=r[4],g=r[5],x=r[6],w=r[7],E=r[8],M=r[9],R=r[10],D=r[11];return r!==i&&(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[4]=m*f+E*c,i[5]=g*f+M*c,i[6]=x*f+R*c,i[7]=w*f+D*c,i[8]=E*f-m*c,i[9]=M*f-g*c,i[10]=R*f-x*c,i[11]=D*f-w*c,i},ht.rotateY=function(i,r,s){var c=Math.sin(s),f=Math.cos(s),m=r[0],g=r[1],x=r[2],w=r[3],E=r[8],M=r[9],R=r[10],D=r[11];return r!==i&&(i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=m*f-E*c,i[1]=g*f-M*c,i[2]=x*f-R*c,i[3]=w*f-D*c,i[8]=m*c+E*f,i[9]=g*c+M*f,i[10]=x*c+R*f,i[11]=w*c+D*f,i},ht.rotateZ=function(i,r,s){var c=Math.sin(s),f=Math.cos(s),m=r[0],g=r[1],x=r[2],w=r[3],E=r[4],M=r[5],R=r[6],D=r[7];return r!==i&&(i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=m*f+E*c,i[1]=g*f+M*c,i[2]=x*f+R*c,i[3]=w*f+D*c,i[4]=E*f-m*c,i[5]=M*f-g*c,i[6]=R*f-x*c,i[7]=D*f-w*c,i},ht.fromTranslation=function(i,r){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i},ht.fromScaling=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},ht.fromRotation=function(i,r,s){var c,f,m,g=s[0],x=s[1],w=s[2],E=Math.hypot(g,x,w);return E<jt.EPSILON?null:(g*=E=1/E,x*=E,w*=E,c=Math.sin(r),f=Math.cos(r),i[0]=g*g*(m=1-f)+f,i[1]=x*g*m+w*c,i[2]=w*g*m-x*c,i[3]=0,i[4]=g*x*m-w*c,i[5]=x*x*m+f,i[6]=w*x*m+g*c,i[7]=0,i[8]=g*w*m+x*c,i[9]=x*w*m-g*c,i[10]=w*w*m+f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)},ht.fromXRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=c,i[6]=s,i[7]=0,i[8]=0,i[9]=-s,i[10]=c,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},ht.fromYRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=0,i[2]=-s,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=s,i[9]=0,i[10]=c,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},ht.fromZRotation=function(i,r){var s=Math.sin(r),c=Math.cos(r);return i[0]=c,i[1]=s,i[2]=0,i[3]=0,i[4]=-s,i[5]=c,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},ht.fromRotationTranslation=_r,ht.fromQuat2=function(i,r){var s=new jt.ARRAY_TYPE(3),c=-r[0],f=-r[1],m=-r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=c*c+f*f+m*m+g*g;return R>0?(s[0]=2*(x*g+M*c+w*m-E*f)/R,s[1]=2*(w*g+M*f+E*c-x*m)/R,s[2]=2*(E*g+M*m+x*f-w*c)/R):(s[0]=2*(x*g+M*c+w*m-E*f),s[1]=2*(w*g+M*f+E*c-x*m),s[2]=2*(E*g+M*m+x*f-w*c)),_r(i,r,s),i},ht.getTranslation=function(i,r){return i[0]=r[12],i[1]=r[13],i[2]=r[14],i},ht.getScaling=dr,ht.getRotation=function(i,r){var s=new jt.ARRAY_TYPE(3);dr(s,r);var c=1/s[0],f=1/s[1],m=1/s[2],g=r[0]*c,x=r[1]*f,w=r[2]*m,E=r[4]*c,M=r[5]*f,R=r[6]*m,D=r[8]*c,B=r[9]*f,$=r[10]*m,q=g+M+$,X=0;return q>0?(X=2*Math.sqrt(q+1),i[3]=.25*X,i[0]=(R-B)/X,i[1]=(D-w)/X,i[2]=(x-E)/X):g>M&&g>$?(X=2*Math.sqrt(1+g-M-$),i[3]=(R-B)/X,i[0]=.25*X,i[1]=(x+E)/X,i[2]=(D+w)/X):M>$?(X=2*Math.sqrt(1+M-g-$),i[3]=(D-w)/X,i[0]=(x+E)/X,i[1]=.25*X,i[2]=(R+B)/X):(X=2*Math.sqrt(1+$-g-M),i[3]=(x-E)/X,i[0]=(D+w)/X,i[1]=(R+B)/X,i[2]=.25*X),i},ht.fromRotationTranslationScale=function(i,r,s,c){var f=r[0],m=r[1],g=r[2],x=r[3],w=f+f,E=m+m,M=g+g,R=f*w,D=f*E,B=f*M,$=m*E,q=m*M,X=g*M,te=x*w,ce=x*E,he=x*M,fe=c[0],Ee=c[1],we=c[2];return i[0]=(1-($+X))*fe,i[1]=(D+he)*fe,i[2]=(B-ce)*fe,i[3]=0,i[4]=(D-he)*Ee,i[5]=(1-(R+X))*Ee,i[6]=(q+te)*Ee,i[7]=0,i[8]=(B+ce)*we,i[9]=(q-te)*we,i[10]=(1-(R+$))*we,i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i},ht.fromRotationTranslationScaleOrigin=function(i,r,s,c,f){var m=r[0],g=r[1],x=r[2],w=r[3],E=m+m,M=g+g,R=x+x,D=m*E,B=m*M,$=m*R,q=g*M,X=g*R,te=x*R,ce=w*E,he=w*M,fe=w*R,Ee=c[0],we=c[1],Ie=c[2],ke=f[0],$e=f[1],nt=f[2],He=(1-(q+te))*Ee,ut=(B+fe)*Ee,bt=($-he)*Ee,ot=(B-fe)*we,yt=(1-(D+te))*we,it=(X+ce)*we,_t=($+he)*Ie,Tt=(X-ce)*Ie,xt=(1-(D+q))*Ie;return i[0]=He,i[1]=ut,i[2]=bt,i[3]=0,i[4]=ot,i[5]=yt,i[6]=it,i[7]=0,i[8]=_t,i[9]=Tt,i[10]=xt,i[11]=0,i[12]=s[0]+ke-(He*ke+ot*$e+_t*nt),i[13]=s[1]+$e-(ut*ke+yt*$e+Tt*nt),i[14]=s[2]+nt-(bt*ke+it*$e+xt*nt),i[15]=1,i},ht.fromQuat=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=s+s,x=c+c,w=f+f,E=s*g,M=c*g,R=c*x,D=f*g,B=f*x,$=f*w,q=m*g,X=m*x,te=m*w;return i[0]=1-R-$,i[1]=M+te,i[2]=D-X,i[3]=0,i[4]=M-te,i[5]=1-E-$,i[6]=B+q,i[7]=0,i[8]=D+X,i[9]=B-q,i[10]=1-E-R,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},ht.frustum=function(i,r,s,c,f,m,g){var x=1/(s-r),w=1/(f-c),E=1/(m-g);return i[0]=2*m*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*m*w,i[6]=0,i[7]=0,i[8]=(s+r)*x,i[9]=(f+c)*w,i[10]=(g+m)*E,i[11]=-1,i[12]=0,i[13]=0,i[14]=g*m*2*E,i[15]=0,i},ht.perspectiveNO=vr,ht.perspectiveZO=function(i,r,s,c,f){var m,g=1/Math.tan(r/2);return i[0]=g/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=g,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=f*(m=1/(c-f)),i[14]=f*c*m):(i[10]=-1,i[14]=-c),i},ht.perspectiveFromFieldOfView=function(i,r,s,c){var f=Math.tan(r.upDegrees*Math.PI/180),m=Math.tan(r.downDegrees*Math.PI/180),g=Math.tan(r.leftDegrees*Math.PI/180),x=Math.tan(r.rightDegrees*Math.PI/180),w=2/(g+x),E=2/(f+m);return i[0]=w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=E,i[6]=0,i[7]=0,i[8]=-(g-x)*w*.5,i[9]=(f-m)*E*.5,i[10]=c/(s-c),i[11]=-1,i[12]=0,i[13]=0,i[14]=c*s/(s-c),i[15]=0,i},ht.orthoNO=Zr,ht.orthoZO=function(i,r,s,c,f,m,g){var x=1/(r-s),w=1/(c-f),E=1/(m-g);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=E,i[11]=0,i[12]=(r+s)*x,i[13]=(f+c)*w,i[14]=m*E,i[15]=1,i},ht.lookAt=function(i,r,s,c){var f,m,g,x,w,E,M,R,D,B,$=r[0],q=r[1],X=r[2],te=c[0],ce=c[1],he=c[2],fe=s[0],Ee=s[1],we=s[2];return Math.abs($-fe)<jt.EPSILON&&Math.abs(q-Ee)<jt.EPSILON&&Math.abs(X-we)<jt.EPSILON?er(i):(M=$-fe,R=q-Ee,D=X-we,f=ce*(D*=B=1/Math.hypot(M,R,D))-he*(R*=B),m=he*(M*=B)-te*D,g=te*R-ce*M,(B=Math.hypot(f,m,g))?(f*=B=1/B,m*=B,g*=B):(f=0,m=0,g=0),x=R*g-D*m,w=D*f-M*g,E=M*m-R*f,(B=Math.hypot(x,w,E))?(x*=B=1/B,w*=B,E*=B):(x=0,w=0,E=0),i[0]=f,i[1]=x,i[2]=M,i[3]=0,i[4]=m,i[5]=w,i[6]=R,i[7]=0,i[8]=g,i[9]=E,i[10]=D,i[11]=0,i[12]=-(f*$+m*q+g*X),i[13]=-(x*$+w*q+E*X),i[14]=-(M*$+R*q+D*X),i[15]=1,i)},ht.targetTo=function(i,r,s,c){var f=r[0],m=r[1],g=r[2],x=c[0],w=c[1],E=c[2],M=f-s[0],R=m-s[1],D=g-s[2],B=M*M+R*R+D*D;B>0&&(M*=B=1/Math.sqrt(B),R*=B,D*=B);var $=w*D-E*R,q=E*M-x*D,X=x*R-w*M;return(B=$*$+q*q+X*X)>0&&($*=B=1/Math.sqrt(B),q*=B,X*=B),i[0]=$,i[1]=q,i[2]=X,i[3]=0,i[4]=R*X-D*q,i[5]=D*$-M*X,i[6]=M*q-R*$,i[7]=0,i[8]=M,i[9]=R,i[10]=D,i[11]=0,i[12]=f,i[13]=m,i[14]=g,i[15]=1,i},ht.str=function(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"},ht.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])},ht.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i[6]=r[6]+s[6],i[7]=r[7]+s[7],i[8]=r[8]+s[8],i[9]=r[9]+s[9],i[10]=r[10]+s[10],i[11]=r[11]+s[11],i[12]=r[12]+s[12],i[13]=r[13]+s[13],i[14]=r[14]+s[14],i[15]=r[15]+s[15],i},ht.subtract=Ii,ht.multiplyScalar=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i[8]=r[8]*s,i[9]=r[9]*s,i[10]=r[10]*s,i[11]=r[11]*s,i[12]=r[12]*s,i[13]=r[13]*s,i[14]=r[14]*s,i[15]=r[15]*s,i},ht.multiplyScalarAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i[4]=r[4]+s[4]*c,i[5]=r[5]+s[5]*c,i[6]=r[6]+s[6]*c,i[7]=r[7]+s[7]*c,i[8]=r[8]+s[8]*c,i[9]=r[9]+s[9]*c,i[10]=r[10]+s[10]*c,i[11]=r[11]+s[11]*c,i[12]=r[12]+s[12]*c,i[13]=r[13]+s[13]*c,i[14]=r[14]+s[14]*c,i[15]=r[15]+s[15]*c,i},ht.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]},ht.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=i[3],g=i[4],x=i[5],w=i[6],E=i[7],M=i[8],R=i[9],D=i[10],B=i[11],$=i[12],q=i[13],X=i[14],te=i[15],ce=r[0],he=r[1],fe=r[2],Ee=r[3],we=r[4],Ie=r[5],ke=r[6],$e=r[7],nt=r[8],He=r[9],ut=r[10],bt=r[11],ot=r[12],yt=r[13],it=r[14],_t=r[15];return Math.abs(s-ce)<=jt.EPSILON*Math.max(1,Math.abs(s),Math.abs(ce))&&Math.abs(c-he)<=jt.EPSILON*Math.max(1,Math.abs(c),Math.abs(he))&&Math.abs(f-fe)<=jt.EPSILON*Math.max(1,Math.abs(f),Math.abs(fe))&&Math.abs(m-Ee)<=jt.EPSILON*Math.max(1,Math.abs(m),Math.abs(Ee))&&Math.abs(g-we)<=jt.EPSILON*Math.max(1,Math.abs(g),Math.abs(we))&&Math.abs(x-Ie)<=jt.EPSILON*Math.max(1,Math.abs(x),Math.abs(Ie))&&Math.abs(w-ke)<=jt.EPSILON*Math.max(1,Math.abs(w),Math.abs(ke))&&Math.abs(E-$e)<=jt.EPSILON*Math.max(1,Math.abs(E),Math.abs($e))&&Math.abs(M-nt)<=jt.EPSILON*Math.max(1,Math.abs(M),Math.abs(nt))&&Math.abs(R-He)<=jt.EPSILON*Math.max(1,Math.abs(R),Math.abs(He))&&Math.abs(D-ut)<=jt.EPSILON*Math.max(1,Math.abs(D),Math.abs(ut))&&Math.abs(B-bt)<=jt.EPSILON*Math.max(1,Math.abs(B),Math.abs(bt))&&Math.abs($-ot)<=jt.EPSILON*Math.max(1,Math.abs($),Math.abs(ot))&&Math.abs(q-yt)<=jt.EPSILON*Math.max(1,Math.abs(q),Math.abs(yt))&&Math.abs(X-it)<=jt.EPSILON*Math.max(1,Math.abs(X),Math.abs(it))&&Math.abs(te-_t)<=jt.EPSILON*Math.max(1,Math.abs(te),Math.abs(_t))},ht.sub=ht.mul=ht.ortho=ht.perspective=void 0;var jt=function(i,r){if(i&&i.__esModule)return i;if(i===null||Zt(i)!=="object"&&typeof i!="function")return{default:i};var s=At(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function At(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(At=function(c){return c?s:r})(i)}function er(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Rn(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=r[8],D=r[9],B=r[10],$=r[11],q=r[12],X=r[13],te=r[14],ce=r[15],he=s[0],fe=s[1],Ee=s[2],we=s[3];return i[0]=he*c+fe*x+Ee*R+we*q,i[1]=he*f+fe*w+Ee*D+we*X,i[2]=he*m+fe*E+Ee*B+we*te,i[3]=he*g+fe*M+Ee*$+we*ce,i[4]=(he=s[4])*c+(fe=s[5])*x+(Ee=s[6])*R+(we=s[7])*q,i[5]=he*f+fe*w+Ee*D+we*X,i[6]=he*m+fe*E+Ee*B+we*te,i[7]=he*g+fe*M+Ee*$+we*ce,i[8]=(he=s[8])*c+(fe=s[9])*x+(Ee=s[10])*R+(we=s[11])*q,i[9]=he*f+fe*w+Ee*D+we*X,i[10]=he*m+fe*E+Ee*B+we*te,i[11]=he*g+fe*M+Ee*$+we*ce,i[12]=(he=s[12])*c+(fe=s[13])*x+(Ee=s[14])*R+(we=s[15])*q,i[13]=he*f+fe*w+Ee*D+we*X,i[14]=he*m+fe*E+Ee*B+we*te,i[15]=he*g+fe*M+Ee*$+we*ce,i}function _r(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=c+c,w=f+f,E=m+m,M=c*x,R=c*w,D=c*E,B=f*w,$=f*E,q=m*E,X=g*x,te=g*w,ce=g*E;return i[0]=1-(B+q),i[1]=R+ce,i[2]=D-te,i[3]=0,i[4]=R-ce,i[5]=1-(M+q),i[6]=$+X,i[7]=0,i[8]=D+te,i[9]=$-X,i[10]=1-(M+B),i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i}function dr(i,r){var s=r[4],c=r[5],f=r[6],m=r[8],g=r[9],x=r[10];return i[0]=Math.hypot(r[0],r[1],r[2]),i[1]=Math.hypot(s,c,f),i[2]=Math.hypot(m,g,x),i}function vr(i,r,s,c,f){var m,g=1/Math.tan(r/2);return i[0]=g/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=g,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+c)*(m=1/(c-f)),i[14]=2*f*c*m):(i[10]=-1,i[14]=-2*c),i}function Zr(i,r,s,c,f,m,g){var x=1/(r-s),w=1/(c-f),E=1/(m-g);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*E,i[11]=0,i[12]=(r+s)*x,i[13]=(f+c)*w,i[14]=(g+m)*E,i[15]=1,i}function Ii(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i[4]=r[4]-s[4],i[5]=r[5]-s[5],i[6]=r[6]-s[6],i[7]=r[7]-s[7],i[8]=r[8]-s[8],i[9]=r[9]-s[9],i[10]=r[10]-s[10],i[11]=r[11]-s[11],i[12]=r[12]-s[12],i[13]=r[13]-s[13],i[14]=r[14]-s[14],i[15]=r[15]-s[15],i}ht.perspective=vr,ht.ortho=Zr,ht.mul=Rn,ht.sub=Ii;var nn={},rn={};function ea(i){return ea=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ea(i)}Object.defineProperty(rn,"__esModule",{value:!0}),rn.create=ul,rn.clone=function(i){var r=new Ci.ARRAY_TYPE(3);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r},rn.length=It,rn.fromValues=function(i,r,s){var c=new Ci.ARRAY_TYPE(3);return c[0]=i,c[1]=r,c[2]=s,c},rn.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i},rn.set=function(i,r,s,c){return i[0]=r,i[1]=s,i[2]=c,i},rn.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i},rn.subtract=Yt,rn.multiply=Mn,rn.divide=Zn,rn.ceil=function(i,r){return i[0]=Math.ceil(r[0]),i[1]=Math.ceil(r[1]),i[2]=Math.ceil(r[2]),i},rn.floor=function(i,r){return i[0]=Math.floor(r[0]),i[1]=Math.floor(r[1]),i[2]=Math.floor(r[2]),i},rn.min=function(i,r,s){return i[0]=Math.min(r[0],s[0]),i[1]=Math.min(r[1],s[1]),i[2]=Math.min(r[2],s[2]),i},rn.max=function(i,r,s){return i[0]=Math.max(r[0],s[0]),i[1]=Math.max(r[1],s[1]),i[2]=Math.max(r[2],s[2]),i},rn.round=function(i,r){return i[0]=Math.round(r[0]),i[1]=Math.round(r[1]),i[2]=Math.round(r[2]),i},rn.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i},rn.scaleAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i},rn.distance=xr,rn.squaredDistance=Wi,rn.squaredLength=Eo,rn.negate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i},rn.inverse=function(i,r){return i[0]=1/r[0],i[1]=1/r[1],i[2]=1/r[2],i},rn.normalize=function(i,r){var s=r[0],c=r[1],f=r[2],m=s*s+c*c+f*f;return m>0&&(m=1/Math.sqrt(m)),i[0]=r[0]*m,i[1]=r[1]*m,i[2]=r[2]*m,i},rn.dot=ro,rn.cross=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=s[0],x=s[1],w=s[2];return i[0]=f*w-m*x,i[1]=m*g-c*w,i[2]=c*x-f*g,i},rn.lerp=function(i,r,s,c){var f=r[0],m=r[1],g=r[2];return i[0]=f+c*(s[0]-f),i[1]=m+c*(s[1]-m),i[2]=g+c*(s[2]-g),i},rn.hermite=function(i,r,s,c,f,m){var g=m*m,x=g*(2*m-3)+1,w=g*(m-2)+m,E=g*(m-1),M=g*(3-2*m);return i[0]=r[0]*x+s[0]*w+c[0]*E+f[0]*M,i[1]=r[1]*x+s[1]*w+c[1]*E+f[1]*M,i[2]=r[2]*x+s[2]*w+c[2]*E+f[2]*M,i},rn.bezier=function(i,r,s,c,f,m){var g=1-m,x=g*g,w=m*m,E=x*g,M=3*m*x,R=3*w*g,D=w*m;return i[0]=r[0]*E+s[0]*M+c[0]*R+f[0]*D,i[1]=r[1]*E+s[1]*M+c[1]*R+f[1]*D,i[2]=r[2]*E+s[2]*M+c[2]*R+f[2]*D,i},rn.random=function(i,r){r=r||1;var s=2*Ci.RANDOM()*Math.PI,c=2*Ci.RANDOM()-1,f=Math.sqrt(1-c*c)*r;return i[0]=Math.cos(s)*f,i[1]=Math.sin(s)*f,i[2]=c*r,i},rn.transformMat4=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=s[3]*c+s[7]*f+s[11]*m+s[15];return i[0]=(s[0]*c+s[4]*f+s[8]*m+s[12])/(g=g||1),i[1]=(s[1]*c+s[5]*f+s[9]*m+s[13])/g,i[2]=(s[2]*c+s[6]*f+s[10]*m+s[14])/g,i},rn.transformMat3=function(i,r,s){var c=r[0],f=r[1],m=r[2];return i[0]=c*s[0]+f*s[3]+m*s[6],i[1]=c*s[1]+f*s[4]+m*s[7],i[2]=c*s[2]+f*s[5]+m*s[8],i},rn.transformQuat=function(i,r,s){var c=s[0],f=s[1],m=s[2],g=r[0],x=r[1],w=r[2],E=f*w-m*x,M=m*g-c*w,R=c*x-f*g,D=f*R-m*M,B=m*E-c*R,$=c*M-f*E,q=2*s[3];return M*=q,R*=q,B*=2,$*=2,i[0]=g+(E*=q)+(D*=2),i[1]=x+M+B,i[2]=w+R+$,i},rn.rotateX=function(i,r,s,c){var f=[],m=[];return f[0]=r[0]-s[0],f[1]=r[1]-s[1],f[2]=r[2]-s[2],m[0]=f[0],m[1]=f[1]*Math.cos(c)-f[2]*Math.sin(c),m[2]=f[1]*Math.sin(c)+f[2]*Math.cos(c),i[0]=m[0]+s[0],i[1]=m[1]+s[1],i[2]=m[2]+s[2],i},rn.rotateY=function(i,r,s,c){var f=[],m=[];return f[0]=r[0]-s[0],f[1]=r[1]-s[1],f[2]=r[2]-s[2],m[0]=f[2]*Math.sin(c)+f[0]*Math.cos(c),m[1]=f[1],m[2]=f[2]*Math.cos(c)-f[0]*Math.sin(c),i[0]=m[0]+s[0],i[1]=m[1]+s[1],i[2]=m[2]+s[2],i},rn.rotateZ=function(i,r,s,c){var f=[],m=[];return f[0]=r[0]-s[0],f[1]=r[1]-s[1],f[2]=r[2]-s[2],m[0]=f[0]*Math.cos(c)-f[1]*Math.sin(c),m[1]=f[0]*Math.sin(c)+f[1]*Math.cos(c),m[2]=f[2],i[0]=m[0]+s[0],i[1]=m[1]+s[1],i[2]=m[2]+s[2],i},rn.angle=function(i,r){var s=i[0],c=i[1],f=i[2],m=r[0],g=r[1],x=r[2],w=Math.sqrt(s*s+c*c+f*f)*Math.sqrt(m*m+g*g+x*x),E=w&&ro(i,r)/w;return Math.acos(Math.min(Math.max(E,-1),1))},rn.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i},rn.str=function(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"},rn.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]},rn.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=r[0],g=r[1],x=r[2];return Math.abs(s-m)<=Ci.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-g)<=Ci.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(f-x)<=Ci.EPSILON*Math.max(1,Math.abs(f),Math.abs(x))},rn.forEach=rn.sqrLen=rn.len=rn.sqrDist=rn.dist=rn.div=rn.mul=rn.sub=void 0;var Ci=function(i,r){if(i&&i.__esModule)return i;if(i===null||ea(i)!=="object"&&typeof i!="function")return{default:i};var s=ta(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function ta(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(ta=function(c){return c?s:r})(i)}function ul(){var i=new Ci.ARRAY_TYPE(3);return Ci.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function It(i){return Math.hypot(i[0],i[1],i[2])}function Yt(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i}function Mn(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i[2]=r[2]*s[2],i}function Zn(i,r,s){return i[0]=r[0]/s[0],i[1]=r[1]/s[1],i[2]=r[2]/s[2],i}function xr(i,r){return Math.hypot(r[0]-i[0],r[1]-i[1],r[2]-i[2])}function Wi(i,r){var s=r[0]-i[0],c=r[1]-i[1],f=r[2]-i[2];return s*s+c*c+f*f}function Eo(i){var r=i[0],s=i[1],c=i[2];return r*r+s*s+c*c}function ro(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]}rn.sub=Yt,rn.mul=Mn,rn.div=Zn,rn.dist=xr,rn.sqrDist=Wi,rn.len=It,rn.sqrLen=Eo;var Oi,Za=(Oi=ul(),function(i,r,s,c,f,m){var g,x;for(r||(r=3),s||(s=0),x=c?Math.min(c*r+s,i.length):i.length,g=s;g<x;g+=r)Oi[0]=i[g],Oi[1]=i[g+1],Oi[2]=i[g+2],f(Oi,Oi,m),i[g]=Oi[0],i[g+1]=Oi[1],i[g+2]=Oi[2];return i});rn.forEach=Za;var en={};function na(i){return na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},na(i)}Object.defineProperty(en,"__esModule",{value:!0}),en.create=Zl,en.clone=function(i){var r=new pr.ARRAY_TYPE(4);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r},en.fromValues=function(i,r,s,c){var f=new pr.ARRAY_TYPE(4);return f[0]=i,f[1]=r,f[2]=s,f[3]=c,f},en.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i},en.set=function(i,r,s,c,f){return i[0]=r,i[1]=s,i[2]=c,i[3]=f,i},en.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i},en.subtract=Xa,en.multiply=Ya,en.divide=nf,en.ceil=function(i,r){return i[0]=Math.ceil(r[0]),i[1]=Math.ceil(r[1]),i[2]=Math.ceil(r[2]),i[3]=Math.ceil(r[3]),i},en.floor=function(i,r){return i[0]=Math.floor(r[0]),i[1]=Math.floor(r[1]),i[2]=Math.floor(r[2]),i[3]=Math.floor(r[3]),i},en.min=function(i,r,s){return i[0]=Math.min(r[0],s[0]),i[1]=Math.min(r[1],s[1]),i[2]=Math.min(r[2],s[2]),i[3]=Math.min(r[3],s[3]),i},en.max=function(i,r,s){return i[0]=Math.max(r[0],s[0]),i[1]=Math.max(r[1],s[1]),i[2]=Math.max(r[2],s[2]),i[3]=Math.max(r[3],s[3]),i},en.round=function(i,r){return i[0]=Math.round(r[0]),i[1]=Math.round(r[1]),i[2]=Math.round(r[2]),i[3]=Math.round(r[3]),i},en.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i},en.scaleAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i[2]=r[2]+s[2]*c,i[3]=r[3]+s[3]*c,i},en.distance=cl,en.squaredDistance=hl,en.length=sc,en.squaredLength=lc,en.negate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i[3]=-r[3],i},en.inverse=function(i,r){return i[0]=1/r[0],i[1]=1/r[1],i[2]=1/r[2],i[3]=1/r[3],i},en.normalize=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=s*s+c*c+f*f+m*m;return g>0&&(g=1/Math.sqrt(g)),i[0]=s*g,i[1]=c*g,i[2]=f*g,i[3]=m*g,i},en.dot=function(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]+i[3]*r[3]},en.cross=function(i,r,s,c){var f=s[0]*c[1]-s[1]*c[0],m=s[0]*c[2]-s[2]*c[0],g=s[0]*c[3]-s[3]*c[0],x=s[1]*c[2]-s[2]*c[1],w=s[1]*c[3]-s[3]*c[1],E=s[2]*c[3]-s[3]*c[2],M=r[0],R=r[1],D=r[2],B=r[3];return i[0]=R*E-D*w+B*x,i[1]=-M*E+D*g-B*m,i[2]=M*w-R*g+B*f,i[3]=-M*x+R*m-D*f,i},en.lerp=function(i,r,s,c){var f=r[0],m=r[1],g=r[2],x=r[3];return i[0]=f+c*(s[0]-f),i[1]=m+c*(s[1]-m),i[2]=g+c*(s[2]-g),i[3]=x+c*(s[3]-x),i},en.random=function(i,r){var s,c,f,m,g,x;r=r||1;do g=(s=2*pr.RANDOM()-1)*s+(c=2*pr.RANDOM()-1)*c;while(g>=1);do x=(f=2*pr.RANDOM()-1)*f+(m=2*pr.RANDOM()-1)*m;while(x>=1);var w=Math.sqrt((1-g)/x);return i[0]=r*s,i[1]=r*c,i[2]=r*f*w,i[3]=r*m*w,i},en.transformMat4=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3];return i[0]=s[0]*c+s[4]*f+s[8]*m+s[12]*g,i[1]=s[1]*c+s[5]*f+s[9]*m+s[13]*g,i[2]=s[2]*c+s[6]*f+s[10]*m+s[14]*g,i[3]=s[3]*c+s[7]*f+s[11]*m+s[15]*g,i},en.transformQuat=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=s[0],x=s[1],w=s[2],E=s[3],M=E*c+x*m-w*f,R=E*f+w*c-g*m,D=E*m+g*f-x*c,B=-g*c-x*f-w*m;return i[0]=M*E+B*-g+R*-w-D*-x,i[1]=R*E+B*-x+D*-g-M*-w,i[2]=D*E+B*-w+M*-x-R*-g,i[3]=r[3],i},en.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i},en.str=function(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},en.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]},en.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=i[3],g=r[0],x=r[1],w=r[2],E=r[3];return Math.abs(s-g)<=pr.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-x)<=pr.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(f-w)<=pr.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(m-E)<=pr.EPSILON*Math.max(1,Math.abs(m),Math.abs(E))},en.forEach=en.sqrLen=en.len=en.sqrDist=en.dist=en.div=en.mul=en.sub=void 0;var pr=function(i,r){if(i&&i.__esModule)return i;if(i===null||na(i)!=="object"&&typeof i!="function")return{default:i};var s=ac(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function ac(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(ac=function(c){return c?s:r})(i)}function Zl(){var i=new pr.ARRAY_TYPE(4);return pr.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function Xa(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i[2]=r[2]-s[2],i[3]=r[3]-s[3],i}function Ya(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i[2]=r[2]*s[2],i[3]=r[3]*s[3],i}function nf(i,r,s){return i[0]=r[0]/s[0],i[1]=r[1]/s[1],i[2]=r[2]/s[2],i[3]=r[3]/s[3],i}function cl(i,r){return Math.hypot(r[0]-i[0],r[1]-i[1],r[2]-i[2],r[3]-i[3])}function hl(i,r){var s=r[0]-i[0],c=r[1]-i[1],f=r[2]-i[2],m=r[3]-i[3];return s*s+c*c+f*f+m*m}function sc(i){return Math.hypot(i[0],i[1],i[2],i[3])}function lc(i){var r=i[0],s=i[1],c=i[2],f=i[3];return r*r+s*s+c*c+f*f}en.sub=Xa,en.mul=Ya,en.div=nf,en.dist=cl,en.sqrDist=hl,en.len=sc,en.sqrLen=lc;var np=function(){var i=Zl();return function(r,s,c,f,m,g){var x,w;for(s||(s=4),c||(c=0),w=f?Math.min(f*s+c,r.length):r.length,x=c;x<w;x+=s)i[0]=r[x],i[1]=r[x+1],i[2]=r[x+2],i[3]=r[x+3],m(i,i,g),r[x]=i[0],r[x+1]=i[1],r[x+2]=i[2],r[x+3]=i[3];return r}}();function uc(i){return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},uc(i)}en.forEach=np,Object.defineProperty(nn,"__esModule",{value:!0}),nn.create=cc,nn.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i},nn.setAxisAngle=rf,nn.getAxisAngle=function(i,r){var s=2*Math.acos(r[3]),c=Math.sin(s/2);return c>ra.EPSILON?(i[0]=r[0]/c,i[1]=r[1]/c,i[2]=r[2]/c):(i[0]=1,i[1]=0,i[2]=0),s},nn.getAngle=function(i,r){var s=Me(i,r);return Math.acos(2*s*s-1)},nn.multiply=hc,nn.rotateX=function(i,r,s){s*=.5;var c=r[0],f=r[1],m=r[2],g=r[3],x=Math.sin(s),w=Math.cos(s);return i[0]=c*w+g*x,i[1]=f*w+m*x,i[2]=m*w-f*x,i[3]=g*w-c*x,i},nn.rotateY=function(i,r,s){s*=.5;var c=r[0],f=r[1],m=r[2],g=r[3],x=Math.sin(s),w=Math.cos(s);return i[0]=c*w-m*x,i[1]=f*w+g*x,i[2]=m*w+c*x,i[3]=g*w-f*x,i},nn.rotateZ=function(i,r,s){s*=.5;var c=r[0],f=r[1],m=r[2],g=r[3],x=Math.sin(s),w=Math.cos(s);return i[0]=c*w+f*x,i[1]=f*w-c*x,i[2]=m*w+g*x,i[3]=g*w-m*x,i},nn.calculateW=function(i,r){var s=r[0],c=r[1],f=r[2];return i[0]=s,i[1]=c,i[2]=f,i[3]=Math.sqrt(Math.abs(1-s*s-c*c-f*f)),i},nn.exp=De,nn.ln=ne,nn.pow=function(i,r,s){return ne(i,r),Pe(i,i,s),De(i,i),i},nn.slerp=le,nn.random=function(i){var r=ra.RANDOM(),s=ra.RANDOM(),c=ra.RANDOM(),f=Math.sqrt(1-r),m=Math.sqrt(r);return i[0]=f*Math.sin(2*Math.PI*s),i[1]=f*Math.cos(2*Math.PI*s),i[2]=m*Math.sin(2*Math.PI*c),i[3]=m*Math.cos(2*Math.PI*c),i},nn.invert=function(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=s*s+c*c+f*f+m*m,x=g?1/g:0;return i[0]=-s*x,i[1]=-c*x,i[2]=-f*x,i[3]=m*x,i},nn.conjugate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i[3]=r[3],i},nn.fromMat3=be,nn.fromEuler=function(i,r,s,c){var f=.5*Math.PI/180;r*=f,s*=f,c*=f;var m=Math.sin(r),g=Math.cos(r),x=Math.sin(s),w=Math.cos(s),E=Math.sin(c),M=Math.cos(c);return i[0]=m*w*M-g*x*E,i[1]=g*x*M+m*w*E,i[2]=g*w*E-m*x*M,i[3]=g*w*M+m*x*E,i},nn.str=function(i){return"quat("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},nn.setAxes=nn.sqlerp=nn.rotationTo=nn.equals=nn.exactEquals=nn.normalize=nn.sqrLen=nn.squaredLength=nn.len=nn.length=nn.lerp=nn.dot=nn.scale=nn.mul=nn.add=nn.set=nn.copy=nn.fromValues=nn.clone=void 0;var ra=Xl(ee),fl=Xl(Se),ia=Xl(rn),Ri=Xl(en);function rp(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(rp=function(c){return c?s:r})(i)}function Xl(i,r){if(i&&i.__esModule)return i;if(i===null||uc(i)!=="object"&&typeof i!="function")return{default:i};var s=rp(r);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}function cc(){var i=new ra.ARRAY_TYPE(4);return ra.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function rf(i,r,s){s*=.5;var c=Math.sin(s);return i[0]=c*r[0],i[1]=c*r[1],i[2]=c*r[2],i[3]=Math.cos(s),i}function hc(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=s[0],w=s[1],E=s[2],M=s[3];return i[0]=c*M+g*x+f*E-m*w,i[1]=f*M+g*w+m*x-c*E,i[2]=m*M+g*E+c*w-f*x,i[3]=g*M-c*x-f*w-m*E,i}function De(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=Math.sqrt(s*s+c*c+f*f),x=Math.exp(m),w=g>0?x*Math.sin(g)/g:0;return i[0]=s*w,i[1]=c*w,i[2]=f*w,i[3]=x*Math.cos(g),i}function ne(i,r){var s=r[0],c=r[1],f=r[2],m=r[3],g=Math.sqrt(s*s+c*c+f*f),x=g>0?Math.atan2(g,m)/g:0;return i[0]=s*x,i[1]=c*x,i[2]=f*x,i[3]=.5*Math.log(s*s+c*c+f*f+m*m),i}function le(i,r,s,c){var f,m,g,x,w,E=r[0],M=r[1],R=r[2],D=r[3],B=s[0],$=s[1],q=s[2],X=s[3];return(m=E*B+M*$+R*q+D*X)<0&&(m=-m,B=-B,$=-$,q=-q,X=-X),1-m>ra.EPSILON?(f=Math.acos(m),g=Math.sin(f),x=Math.sin((1-c)*f)/g,w=Math.sin(c*f)/g):(x=1-c,w=c),i[0]=x*E+w*B,i[1]=x*M+w*$,i[2]=x*R+w*q,i[3]=x*D+w*X,i}function be(i,r){var s,c=r[0]+r[4]+r[8];if(c>0)s=Math.sqrt(c+1),i[3]=.5*s,i[0]=(r[5]-r[7])*(s=.5/s),i[1]=(r[6]-r[2])*s,i[2]=(r[1]-r[3])*s;else{var f=0;r[4]>r[0]&&(f=1),r[8]>r[3*f+f]&&(f=2);var m=(f+1)%3,g=(f+2)%3;s=Math.sqrt(r[3*f+f]-r[3*m+m]-r[3*g+g]+1),i[f]=.5*s,i[3]=(r[3*m+g]-r[3*g+m])*(s=.5/s),i[m]=(r[3*m+f]+r[3*f+m])*s,i[g]=(r[3*g+f]+r[3*f+g])*s}return i}nn.clone=Ri.clone,nn.fromValues=Ri.fromValues,nn.copy=Ri.copy,nn.set=Ri.set,nn.add=Ri.add,nn.mul=hc;var Pe=Ri.scale;nn.scale=Pe;var Me=Ri.dot;nn.dot=Me,nn.lerp=Ri.lerp;var je=Ri.length;nn.length=je,nn.len=je;var Qe=Ri.squaredLength;nn.squaredLength=Qe,nn.sqrLen=Qe;var ze=Ri.normalize;nn.normalize=ze,nn.exactEquals=Ri.exactEquals,nn.equals=Ri.equals;var tt,Pt,St,Xt=(tt=ia.create(),Pt=ia.fromValues(1,0,0),St=ia.fromValues(0,1,0),function(i,r,s){var c=ia.dot(r,s);return c<-.999999?(ia.cross(tt,Pt,r),ia.len(tt)<1e-6&&ia.cross(tt,St,r),ia.normalize(tt,tt),rf(i,tt,Math.PI),i):c>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(ia.cross(tt,r,s),i[0]=tt[0],i[1]=tt[1],i[2]=tt[2],i[3]=1+c,ze(i,i))});nn.rotationTo=Xt;var ln,Cn,In=(ln=cc(),Cn=cc(),function(i,r,s,c,f,m){return le(ln,r,f,m),le(Cn,s,c,m),le(i,ln,Cn,2*m*(1-m)),i});nn.sqlerp=In;var yn,zn=(yn=fl.create(),function(i,r,s,c){return yn[0]=s[0],yn[3]=s[1],yn[6]=s[2],yn[1]=c[0],yn[4]=c[1],yn[7]=c[2],yn[2]=-r[0],yn[5]=-r[1],yn[8]=-r[2],ze(i,be(i,yn))});nn.setAxes=zn;var Vt={};function Or(i){return Or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Or(i)}Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.create=function(){var i=new sr.ARRAY_TYPE(8);return sr.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[4]=0,i[5]=0,i[6]=0,i[7]=0),i[3]=1,i},Vt.clone=function(i){var r=new sr.ARRAY_TYPE(8);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r},Vt.fromValues=function(i,r,s,c,f,m,g,x){var w=new sr.ARRAY_TYPE(8);return w[0]=i,w[1]=r,w[2]=s,w[3]=c,w[4]=f,w[5]=m,w[6]=g,w[7]=x,w},Vt.fromRotationTranslationValues=function(i,r,s,c,f,m,g){var x=new sr.ARRAY_TYPE(8);x[0]=i,x[1]=r,x[2]=s,x[3]=c;var w=.5*f,E=.5*m,M=.5*g;return x[4]=w*c+E*s-M*r,x[5]=E*c+M*i-w*s,x[6]=M*c+w*r-E*i,x[7]=-w*i-E*r-M*s,x},Vt.fromRotationTranslation=Hi,Vt.fromTranslation=function(i,r){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=.5*r[0],i[5]=.5*r[1],i[6]=.5*r[2],i[7]=0,i},Vt.fromRotation=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},Vt.fromMat4=function(i,r){var s=Vn.create();Kr.getRotation(s,r);var c=new sr.ARRAY_TYPE(3);return Kr.getTranslation(c,r),Hi(i,s,c),i},Vt.copy=qi,Vt.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},Vt.set=function(i,r,s,c,f,m,g,x,w){return i[0]=r,i[1]=s,i[2]=c,i[3]=f,i[4]=m,i[5]=g,i[6]=x,i[7]=w,i},Vt.getDual=function(i,r){return i[0]=r[4],i[1]=r[5],i[2]=r[6],i[3]=r[7],i},Vt.setDual=function(i,r){return i[4]=r[0],i[5]=r[1],i[6]=r[2],i[7]=r[3],i},Vt.getTranslation=function(i,r){var s=r[4],c=r[5],f=r[6],m=r[7],g=-r[0],x=-r[1],w=-r[2],E=r[3];return i[0]=2*(s*E+m*g+c*w-f*x),i[1]=2*(c*E+m*x+f*g-s*w),i[2]=2*(f*E+m*w+s*x-c*g),i},Vt.translate=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=.5*s[0],w=.5*s[1],E=.5*s[2],M=r[4],R=r[5],D=r[6],B=r[7];return i[0]=c,i[1]=f,i[2]=m,i[3]=g,i[4]=g*x+f*E-m*w+M,i[5]=g*w+m*x-c*E+R,i[6]=g*E+c*w-f*x+D,i[7]=-c*x-f*w-m*E+B,i},Vt.rotateX=function(i,r,s){var c=-r[0],f=-r[1],m=-r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=x*g+M*c+w*m-E*f,D=w*g+M*f+E*c-x*m,B=E*g+M*m+x*f-w*c,$=M*g-x*c-w*f-E*m;return Vn.rotateX(i,r,s),i[4]=R*(g=i[3])+$*(c=i[0])+D*(m=i[2])-B*(f=i[1]),i[5]=D*g+$*f+B*c-R*m,i[6]=B*g+$*m+R*f-D*c,i[7]=$*g-R*c-D*f-B*m,i},Vt.rotateY=function(i,r,s){var c=-r[0],f=-r[1],m=-r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=x*g+M*c+w*m-E*f,D=w*g+M*f+E*c-x*m,B=E*g+M*m+x*f-w*c,$=M*g-x*c-w*f-E*m;return Vn.rotateY(i,r,s),i[4]=R*(g=i[3])+$*(c=i[0])+D*(m=i[2])-B*(f=i[1]),i[5]=D*g+$*f+B*c-R*m,i[6]=B*g+$*m+R*f-D*c,i[7]=$*g-R*c-D*f-B*m,i},Vt.rotateZ=function(i,r,s){var c=-r[0],f=-r[1],m=-r[2],g=r[3],x=r[4],w=r[5],E=r[6],M=r[7],R=x*g+M*c+w*m-E*f,D=w*g+M*f+E*c-x*m,B=E*g+M*m+x*f-w*c,$=M*g-x*c-w*f-E*m;return Vn.rotateZ(i,r,s),i[4]=R*(g=i[3])+$*(c=i[0])+D*(m=i[2])-B*(f=i[1]),i[5]=D*g+$*f+B*c-R*m,i[6]=B*g+$*m+R*f-D*c,i[7]=$*g-R*c-D*f-B*m,i},Vt.rotateByQuatAppend=function(i,r,s){var c=s[0],f=s[1],m=s[2],g=s[3],x=r[0],w=r[1],E=r[2],M=r[3];return i[0]=x*g+M*c+w*m-E*f,i[1]=w*g+M*f+E*c-x*m,i[2]=E*g+M*m+x*f-w*c,i[3]=M*g-x*c-w*f-E*m,i[4]=(x=r[4])*g+(M=r[7])*c+(w=r[5])*m-(E=r[6])*f,i[5]=w*g+M*f+E*c-x*m,i[6]=E*g+M*m+x*f-w*c,i[7]=M*g-x*c-w*f-E*m,i},Vt.rotateByQuatPrepend=function(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=s[0],w=s[1],E=s[2],M=s[3];return i[0]=c*M+g*x+f*E-m*w,i[1]=f*M+g*w+m*x-c*E,i[2]=m*M+g*E+c*w-f*x,i[3]=g*M-c*x-f*w-m*E,i[4]=c*(M=s[7])+g*(x=s[4])+f*(E=s[6])-m*(w=s[5]),i[5]=f*M+g*w+m*x-c*E,i[6]=m*M+g*E+c*w-f*x,i[7]=g*M-c*x-f*w-m*E,i},Vt.rotateAroundAxis=function(i,r,s,c){if(Math.abs(c)<sr.EPSILON)return qi(i,r);var f=Math.hypot(s[0],s[1],s[2]);c*=.5;var m=Math.sin(c),g=m*s[0]/f,x=m*s[1]/f,w=m*s[2]/f,E=Math.cos(c),M=r[0],R=r[1],D=r[2],B=r[3];i[0]=M*E+B*g+R*w-D*x,i[1]=R*E+B*x+D*g-M*w,i[2]=D*E+B*w+M*x-R*g,i[3]=B*E-M*g-R*x-D*w;var $=r[4],q=r[5],X=r[6],te=r[7];return i[4]=$*E+te*g+q*w-X*x,i[5]=q*E+te*x+X*g-$*w,i[6]=X*E+te*w+$*x-q*g,i[7]=te*E-$*g-q*x-X*w,i},Vt.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i[2]=r[2]+s[2],i[3]=r[3]+s[3],i[4]=r[4]+s[4],i[5]=r[5]+s[5],i[6]=r[6]+s[6],i[7]=r[7]+s[7],i},Vt.multiply=Yl,Vt.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i[2]=r[2]*s,i[3]=r[3]*s,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=r[7]*s,i},Vt.lerp=function(i,r,s,c){var f=1-c;return hy(r,s)<0&&(c=-c),i[0]=r[0]*f+s[0]*c,i[1]=r[1]*f+s[1]*c,i[2]=r[2]*f+s[2]*c,i[3]=r[3]*f+s[3]*c,i[4]=r[4]*f+s[4]*c,i[5]=r[5]*f+s[5]*c,i[6]=r[6]*f+s[6]*c,i[7]=r[7]*f+s[7]*c,i},Vt.invert=function(i,r){var s=of(r);return i[0]=-r[0]/s,i[1]=-r[1]/s,i[2]=-r[2]/s,i[3]=r[3]/s,i[4]=-r[4]/s,i[5]=-r[5]/s,i[6]=-r[6]/s,i[7]=r[7]/s,i},Vt.conjugate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i[2]=-r[2],i[3]=r[3],i[4]=-r[4],i[5]=-r[5],i[6]=-r[6],i[7]=r[7],i},Vt.normalize=function(i,r){var s=of(r);if(s>0){s=Math.sqrt(s);var c=r[0]/s,f=r[1]/s,m=r[2]/s,g=r[3]/s,x=r[4],w=r[5],E=r[6],M=r[7],R=c*x+f*w+m*E+g*M;i[0]=c,i[1]=f,i[2]=m,i[3]=g,i[4]=(x-c*R)/s,i[5]=(w-f*R)/s,i[6]=(E-m*R)/s,i[7]=(M-g*R)/s}return i},Vt.str=function(i){return"quat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+")"},Vt.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]},Vt.equals=function(i,r){var s=i[0],c=i[1],f=i[2],m=i[3],g=i[4],x=i[5],w=i[6],E=i[7],M=r[0],R=r[1],D=r[2],B=r[3],$=r[4],q=r[5],X=r[6],te=r[7];return Math.abs(s-M)<=sr.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(c-R)<=sr.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(f-D)<=sr.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(m-B)<=sr.EPSILON*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(g-$)<=sr.EPSILON*Math.max(1,Math.abs(g),Math.abs($))&&Math.abs(x-q)<=sr.EPSILON*Math.max(1,Math.abs(x),Math.abs(q))&&Math.abs(w-X)<=sr.EPSILON*Math.max(1,Math.abs(w),Math.abs(X))&&Math.abs(E-te)<=sr.EPSILON*Math.max(1,Math.abs(E),Math.abs(te))},Vt.sqrLen=Vt.squaredLength=Vt.len=Vt.length=Vt.dot=Vt.mul=Vt.setReal=Vt.getReal=void 0;var sr=hi(ee),Vn=hi(nn),Kr=hi(ht);function Rr(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(Rr=function(c){return c?s:r})(i)}function hi(i,r){if(i&&i.__esModule)return i;if(i===null||Or(i)!=="object"&&typeof i!="function")return{default:i};var s=Rr(r);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}function Hi(i,r,s){var c=.5*s[0],f=.5*s[1],m=.5*s[2],g=r[0],x=r[1],w=r[2],E=r[3];return i[0]=g,i[1]=x,i[2]=w,i[3]=E,i[4]=c*E+f*w-m*x,i[5]=f*E+m*g-c*w,i[6]=m*E+c*x-f*g,i[7]=-c*g-f*x-m*w,i}function qi(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i}function Yl(i,r,s){var c=r[0],f=r[1],m=r[2],g=r[3],x=s[4],w=s[5],E=s[6],M=s[7],R=r[4],D=r[5],B=r[6],$=r[7],q=s[0],X=s[1],te=s[2],ce=s[3];return i[0]=c*ce+g*q+f*te-m*X,i[1]=f*ce+g*X+m*q-c*te,i[2]=m*ce+g*te+c*X-f*q,i[3]=g*ce-c*q-f*X-m*te,i[4]=c*M+g*x+f*E-m*w+R*ce+$*q+D*te-B*X,i[5]=f*M+g*w+m*x-c*E+D*ce+$*X+B*q-R*te,i[6]=m*M+g*E+c*w-f*x+B*ce+$*te+R*X-D*q,i[7]=g*M-c*x-f*w-m*E+$*ce-R*q-D*X-B*te,i}Vt.getReal=Vn.copy,Vt.setReal=Vn.copy,Vt.mul=Yl;var hy=Vn.dot;Vt.dot=hy;var Ux=Vn.length;Vt.length=Ux,Vt.len=Ux;var of=Vn.squaredLength;Vt.squaredLength=of,Vt.sqrLen=of;var Sn={};function fy(i){return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},fy(i)}Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.create=py,Sn.clone=function(i){var r=new dl.ARRAY_TYPE(2);return r[0]=i[0],r[1]=i[1],r},Sn.fromValues=function(i,r){var s=new dl.ARRAY_TYPE(2);return s[0]=i,s[1]=r,s},Sn.copy=function(i,r){return i[0]=r[0],i[1]=r[1],i},Sn.set=function(i,r,s){return i[0]=r,i[1]=s,i},Sn.add=function(i,r,s){return i[0]=r[0]+s[0],i[1]=r[1]+s[1],i},Sn.subtract=my,Sn.multiply=gy,Sn.divide=yy,Sn.ceil=function(i,r){return i[0]=Math.ceil(r[0]),i[1]=Math.ceil(r[1]),i},Sn.floor=function(i,r){return i[0]=Math.floor(r[0]),i[1]=Math.floor(r[1]),i},Sn.min=function(i,r,s){return i[0]=Math.min(r[0],s[0]),i[1]=Math.min(r[1],s[1]),i},Sn.max=function(i,r,s){return i[0]=Math.max(r[0],s[0]),i[1]=Math.max(r[1],s[1]),i},Sn.round=function(i,r){return i[0]=Math.round(r[0]),i[1]=Math.round(r[1]),i},Sn.scale=function(i,r,s){return i[0]=r[0]*s,i[1]=r[1]*s,i},Sn.scaleAndAdd=function(i,r,s,c){return i[0]=r[0]+s[0]*c,i[1]=r[1]+s[1]*c,i},Sn.distance=_y,Sn.squaredDistance=vy,Sn.length=xy,Sn.squaredLength=by,Sn.negate=function(i,r){return i[0]=-r[0],i[1]=-r[1],i},Sn.inverse=function(i,r){return i[0]=1/r[0],i[1]=1/r[1],i},Sn.normalize=function(i,r){var s=r[0],c=r[1],f=s*s+c*c;return f>0&&(f=1/Math.sqrt(f)),i[0]=r[0]*f,i[1]=r[1]*f,i},Sn.dot=function(i,r){return i[0]*r[0]+i[1]*r[1]},Sn.cross=function(i,r,s){var c=r[0]*s[1]-r[1]*s[0];return i[0]=i[1]=0,i[2]=c,i},Sn.lerp=function(i,r,s,c){var f=r[0],m=r[1];return i[0]=f+c*(s[0]-f),i[1]=m+c*(s[1]-m),i},Sn.random=function(i,r){r=r||1;var s=2*dl.RANDOM()*Math.PI;return i[0]=Math.cos(s)*r,i[1]=Math.sin(s)*r,i},Sn.transformMat2=function(i,r,s){var c=r[0],f=r[1];return i[0]=s[0]*c+s[2]*f,i[1]=s[1]*c+s[3]*f,i},Sn.transformMat2d=function(i,r,s){var c=r[0],f=r[1];return i[0]=s[0]*c+s[2]*f+s[4],i[1]=s[1]*c+s[3]*f+s[5],i},Sn.transformMat3=function(i,r,s){var c=r[0],f=r[1];return i[0]=s[0]*c+s[3]*f+s[6],i[1]=s[1]*c+s[4]*f+s[7],i},Sn.transformMat4=function(i,r,s){var c=r[0],f=r[1];return i[0]=s[0]*c+s[4]*f+s[12],i[1]=s[1]*c+s[5]*f+s[13],i},Sn.rotate=function(i,r,s,c){var f=r[0]-s[0],m=r[1]-s[1],g=Math.sin(c),x=Math.cos(c);return i[0]=f*x-m*g+s[0],i[1]=f*g+m*x+s[1],i},Sn.angle=function(i,r){var s=i[0],c=i[1],f=r[0],m=r[1],g=Math.sqrt(s*s+c*c)*Math.sqrt(f*f+m*m);return Math.acos(Math.min(Math.max(g&&(s*f+c*m)/g,-1),1))},Sn.zero=function(i){return i[0]=0,i[1]=0,i},Sn.str=function(i){return"vec2("+i[0]+", "+i[1]+")"},Sn.exactEquals=function(i,r){return i[0]===r[0]&&i[1]===r[1]},Sn.equals=function(i,r){var s=i[0],c=i[1],f=r[0],m=r[1];return Math.abs(s-f)<=dl.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(c-m)<=dl.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))},Sn.forEach=Sn.sqrLen=Sn.sqrDist=Sn.dist=Sn.div=Sn.mul=Sn.sub=Sn.len=void 0;var dl=function(i,r){if(i&&i.__esModule)return i;if(i===null||fy(i)!=="object"&&typeof i!="function")return{default:i};var s=dy(void 0);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}(ee);function dy(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(dy=function(c){return c?s:r})(i)}function py(){var i=new dl.ARRAY_TYPE(2);return dl.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0),i}function my(i,r,s){return i[0]=r[0]-s[0],i[1]=r[1]-s[1],i}function gy(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i}function yy(i,r,s){return i[0]=r[0]/s[0],i[1]=r[1]/s[1],i}function _y(i,r){return Math.hypot(r[0]-i[0],r[1]-i[1])}function vy(i,r){var s=r[0]-i[0],c=r[1]-i[1];return s*s+c*c}function xy(i){return Math.hypot(i[0],i[1])}function by(i){var r=i[0],s=i[1];return r*r+s*s}Sn.len=xy,Sn.sub=my,Sn.mul=gy,Sn.div=yy,Sn.dist=_y,Sn.sqrDist=vy,Sn.sqrLen=by;var Vx=function(){var i=py();return function(r,s,c,f,m,g){var x,w;for(s||(s=2),c||(c=0),w=f?Math.min(f*s+c,r.length):r.length,x=c;x<w;x+=s)i[0]=r[x],i[1]=r[x+1],m(i,i,g),r[x]=i[0],r[x+1]=i[1];return r}}();function fc(i){return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},fc(i)}Sn.forEach=Vx,Object.defineProperty(K,"__esModule",{value:!0}),a.aA=K.vec4=a._=K.vec3=K.vec2=K.quat2=a.av=K.quat=a.ad=K.mat4=a.bC=K.mat3=K.mat2d=a.aC=K.mat2=K.glMatrix=void 0;var ip=Ka(ee);K.glMatrix=ip;var op=Ka(Oe);a.aC=K.mat2=op;var Gx=Ka(Ke);K.mat2d=Gx;var Wx=Ka(Se);a.bC=K.mat3=Wx;var Hx=Ka(ht);a.ad=K.mat4=Hx;var dc=Ka(nn);a.av=K.quat=dc;var Ln=Ka(Vt);K.quat2=Ln;var xA=Ka(Sn);K.vec2=xA;var bA=Ka(rn);a._=K.vec3=bA;var wA=Ka(en);function wy(i){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(wy=function(c){return c?s:r})(i)}function Ka(i,r){if(i&&i.__esModule)return i;if(i===null||fc(i)!=="object"&&typeof i!="function")return{default:i};var s=wy(r);if(s&&s.has(i))return s.get(i);var c={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in i)if(m!=="default"&&Object.prototype.hasOwnProperty.call(i,m)){var g=f?Object.getOwnPropertyDescriptor(i,m):null;g&&(g.get||g.set)?Object.defineProperty(c,m,g):c[m]=i[m]}return c.default=i,s&&s.set(i,c),c}a.aA=K.vec4=wA;var Sy=af;function af(i,r,s,c){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=s,this.p2y=c}af.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(r===void 0&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,c=0;c<8;c++){var f=this.sampleCurveX(s)-i;if(Math.abs(f)<r)return s;var m=this.sampleCurveDerivativeX(s);if(Math.abs(m)<1e-6)break;s-=f/m}var g=0,x=1;for(s=i,c=0;c<20&&(f=this.sampleCurveX(s),!(Math.abs(f-i)<r));c++)i>f?g=s:x=s,s=.5*(x-g)+g;return s},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};var sf=Y(Sy),ap=Kl;function Kl(i,r){this.x=i,this.y=r}Kl.prototype={clone:function(){return new Kl(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,r){return this.clone()._rotateAround(i,r)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var r=i.x-this.x,s=i.y-this.y;return r*r+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,r){return Math.atan2(this.x*r-this.y*i,this.x*i+this.y*r)},_matMult:function(i){var r=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=r,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var r=Math.cos(i),s=Math.sin(i),c=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=c,this},_rotateAround:function(i,r){var s=Math.cos(i),c=Math.sin(i),f=r.y+c*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-c*(this.y-r.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Kl.convert=function(i){return i instanceof Kl?i:Array.isArray(i)?new Kl(i[0],i[1]):i};var Lt=Y(ap);const qx=Math.PI/180,lf=180/Math.PI;function Fn(i){return i*qx}function Zi(i){return i*lf}const Zx=[[0,0],[1,0],[1,1],[0,1]];function Ty(i){if(i<=0)return 0;if(i>=1)return 1;const r=i*i,s=r*i;return 4*(i<.5?s:3*(i-r)+s-.75)}function uf(i,r,s,c){const f=new sf(i,r,s,c);return function(m){return f.solve(m)}}const pc=uf(.25,.1,.25,1);function Pn(i,r,s){return Math.min(s,Math.max(r,i))}function Ql(i,r,s){return(s=Pn((s-i)/(r-i),0,1))*s*(3-2*s)}function Jl(i,r,s){const c=s-r,f=((i-r)%c+c)%c+r;return f===r?s:f}function mc(i,r,s){if(!i.length)return s(null,[]);let c=i.length;const f=new Array(i.length);let m=null;i.forEach((g,x)=>{r(g,(w,E)=>{w&&(m=w),f[x]=E,--c==0&&s(m,f)})})}function oa(i){const r=[];for(const s in i)r.push(i[s]);return r}function Xi(i,...r){for(const s of r)for(const c in s)i[c]=s[c];return i}let SA=1;function sp(){return SA++}function lp(){return function i(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function Ey(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Ay(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function up(i,r){i.forEach(s=>{r[s]&&(r[s]=r[s].bind(r))})}function cf(i,r){return i.indexOf(r,i.length-r.length)!==-1}function gc(i,r,s){const c={};for(const f in i)c[f]=r.call(this,i[f],f,i);return c}function eu(i,r,s){const c={};for(const f in i)r.call(this,i[f],f,i)&&(c[f]=i[f]);return c}function Qa(i){return Array.isArray(i)?i.map(Qa):typeof i=="object"&&i?gc(i,Qa):i}const Cy={};function Qr(i){Cy[i]||(typeof console<"u"&&console.warn(i),Cy[i]=!0)}function Ja(i,r,s){return(s.y-i.y)*(r.x-i.x)>(r.y-i.y)*(s.x-i.x)}function io(i){let r=0;for(let s,c,f=0,m=i.length,g=m-1;f<m;g=f++)s=i[f],c=i[g],r+=(c.x-s.x)*(s.y+c.y);return r}function Ps([i,r,s]){const c=Fn(r+90),f=Fn(s);return{x:i*Math.cos(c)*Math.sin(f),y:i*Math.sin(c)*Math.sin(f),z:i*Math.cos(f),azimuthal:r,polar:s}}function ki(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Py(i){const r={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,f,m)=>{const g=f||m;return r[c]=!g||g.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r}let My,cp,yc,hf,Ms,ff,hp=null;function tu(i){try{const r=self[i];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function df(i,r){return[i[4*r],i[4*r+1],i[4*r+2],i[4*r+3]]}function Iy(i,r,s,c){for(;r<s;){const f=r+s>>1;i[f]<c?r=f+1:s=f}return r}function Xx(i,r,s,c){for(;r<s;){const f=r+s>>1;i[f]<=c?r=f+1:s=f}return r}function fp(i){return i>0?1/(1.001-i):1+i}function dp(i){return i>0?1-1/(1.001-i):-i}function _c(){return My==null&&(My=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),My}const Di={now:()=>hf!==void 0?hf:performance.now(),setNow(i){hf=i},restoreNow(){hf=void 0},frame(i){const r=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(i,r=0){const{width:s,height:c}=i;Ms||(Ms=document.createElement("canvas"));const f=Ms.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(s>Ms.width||c>Ms.height)&&(Ms.width=s,Ms.height=c),f.clearRect(-r,-r,s+2*r,c+2*r),f.drawImage(i,0,0,s,c),f.getImageData(-r,-r,s+2*r,c+2*r)},resolveURL:i=>(cp||(cp=document.createElement("a")),cp.href=i,cp.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(yc==null&&(yc=window.matchMedia("(prefers-reduced-motion: reduce)")),yc.matches)},hasCanvasFingerprintNoise(){if(ff!==void 0)return ff;if(!_c())return ff=!1,!1;const i=new OffscreenCanvas(85,1),r=i.getContext("2d",{willReadFrequently:!0});let s=0;for(let f=0;f<i.width;++f)r.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,r.fillRect(f,0,1,1);const c=r.getImageData(0,0,i.width,i.height);s=0;for(let f=0;f<c.data.length;++f)if(f%4!=3&&s++!==c.data[f])return ff=!0,!0;return ff=!1,!1}};function pp(i,r){const s=i.indexOf("?");if(s<0)return`${i}?${new URLSearchParams(r).toString()}`;const c=new URLSearchParams(i.slice(s));for(const f in r)c.set(f,r[f]);return`${i.slice(0,s)}?${c.toString()}`}function Oy(i,r={persistentParams:[]}){const s=i.indexOf("?");if(s<0)return i;const c=new URLSearchParams,f=new URLSearchParams(i.slice(s));for(const g of r.persistentParams){const x=f.get(g);x&&c.set(g,x)}const m=c.toString();return`${i.slice(0,s)}${m.length>0?`?${m}`:""}`}const Yx="mapbox-tiles";let Ry=500,ky=50,Is,mp;function Kx(){try{return caches}catch{}}function pf(){const i=Kx();i&&!Is&&(Is=i.open(Yx))}let gp=1/0;const yp={supported:!1,testSupport:function(i){!Dy&&xc&&(Ly?Qx(i):vc=i)}};let vc,xc,Dy=!1,Ly=!1;const zy=typeof self<"u"?self:{};function Qx(i){const r=i.createTexture();i.bindTexture(i.TEXTURE_2D,r);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,xc),i.isContextLost())return;yp.supported=!0}catch{}i.deleteTexture(r),Dy=!0}zy.document&&(xc=zy.document.createElement("img"),xc.onload=function(){vc&&Qx(vc),vc=null,Ly=!0},xc.onerror=function(){Dy=!0,vc=null},xc.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _p={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(_p);class Fy extends Error{constructor(r,s,c){s===401&&O(c)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const vp=ki()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,mf=function(i,r){if(!(/^file:/.test(s=i.url)||/^file:/.test(vp())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,f){const m=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:vp(),referrerPolicy:c.referrerPolicy,signal:m.signal});let x=!1,w=!1;const E=(M=g.url).indexOf("sku=")>0&&O(M);var M;c.type==="json"&&g.headers.set("Accept","application/json");const R=(B,$,q)=>{if(w)return;if(B&&B.message!=="SecurityError"&&Qr(B.toString()),$&&q)return D($);const X=Date.now();fetch(g).then(te=>{if(te.ok){const ce=E?te.clone():null;return D(te,ce,X)}return f(new Fy(te.statusText,te.status,c.url))}).catch(te=>{te.name!=="AbortError"&&f(new Error(`${te.message} ${c.url}`))})},D=(B,$,q)=>{(c.type==="arrayBuffer"?B.arrayBuffer():c.type==="json"?B.json():B.text()).then(X=>{w||($&&q&&function(te,ce,he){if(pf(),!Is)return;const fe=Py(ce.headers.get("Cache-Control")||"");if(fe["no-store"])return;const Ee={status:ce.status,statusText:ce.statusText,headers:new Headers};ce.headers.forEach((ke,$e)=>Ee.headers.set($e,ke)),fe["max-age"]&&Ee.headers.set("Expires",new Date(he+1e3*fe["max-age"]).toUTCString());const we=Ee.headers.get("Expires");if(!we||new Date(we).getTime()-he<42e4)return;let Ie=Oy(te.url,{persistentParams:["language","worldview"]});if(ce.status===206){const ke=te.headers.get("Range");if(!ke)return;Ee.status=200,Ie=pp(Ie,{range:ke})}(function(ke,$e){if(mp===void 0)try{new Response(new ReadableStream),mp=!0}catch{mp=!1}mp?$e(ke.body):ke.blob().then($e)})(ce,ke=>{const $e=new Response((nt=ce.status)!==200&&nt!==404&&[101,103,204,205,304].includes(nt)?null:ke,Ee);var nt;pf(),Is&&Is.then(He=>He.put(Ie,$e)).catch(He=>Qr(He.message))})}(g,$,q),x=!0,f(null,X,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(X=>{w||f(new Error(X.message))})};return E?function(B,$){if(pf(),!Is)return $(null);Is.then(q=>{let X=Oy(B.url,{persistentParams:["language","worldview"]});const te=B.headers.get("Range");te&&(X=pp(X,{range:te})),q.match(X).then(ce=>{const he=function(fe){if(!fe)return!1;const Ee=new Date(fe.headers.get("Expires")||0),we=Py(fe.headers.get("Cache-Control")||"");return Ee>Date.now()&&!we["no-cache"]}(ce);q.delete(X),he&&q.put(X,ce.clone()),$(null,ce,he)}).catch($)}).catch($)}(g,R):R(null,null),{cancel:()=>{w=!0,x||m.abort()}}}(i,r);if(ki()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,r,void 0,!0)}var s;return function(c,f){const m=new XMLHttpRequest;m.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const g in c.headers)m.setRequestHeader(g,c.headers[g]);return c.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=c.credentials==="include",m.onerror=()=>{f(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let g=m.response;if(c.type==="json")try{g=JSON.parse(m.response)}catch(x){return f(x)}f(null,g,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else f(new Fy(m.statusText,m.status,c.url))},m.send(c.body),{cancel:()=>m.abort()}}(i,r)},nu=function(i,r){return mf(Xi(i,{type:"arrayBuffer"}),r)};function Jx(i){const r=document.createElement("a");return r.href=i,r.protocol===location.protocol&&r.host===location.host}const Ny="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let gf,yf;gf=[],yf=0;const pl=function(i,r){if(yp.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),yf>=A.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:i,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return gf.push(m),m}yf++;let s=!1;const c=()=>{if(!s)for(s=!0,yf--;gf.length&&yf<A.MAX_PARALLEL_IMAGE_REQUESTS;){const m=gf.shift(),{requestParameters:g,callback:x,cancelled:w}=m;w||(m.cancel=pl(g,x).cancel)}},f=nu(i,(m,g,x,w)=>{c(),m?r(m):g&&(self.createImageBitmap?function(E,M){const R=new Blob([new Uint8Array(E)],{type:"image/png"});createImageBitmap(R).then(D=>{M(null,D)}).catch(D=>{M(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(E,M)=>r(E,M,x,w)):function(E,M){const R=new Image;R.onload=()=>{M(null,R),URL.revokeObjectURL(R.src),R.onload=null,requestAnimationFrame(()=>{R.src=Ny})},R.onerror=()=>M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(E)],{type:"image/png"});R.src=E.byteLength?URL.createObjectURL(D):Ny}(g,(E,M)=>r(E,M,x,w)))});return{cancel:()=>{f.cancel(),c()}}},By="01",jy="NO_ACCESS_TOKEN",TA=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wa(i){const r=i.match(TA);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function bc(i){const r=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${r}`}const xp="mapbox.eventData";function e1(i){if(!i)return null;const r=i.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(r[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class _f{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const s=e1(A.ACCESS_TOKEN);let c="";return c=s&&s.u?btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(f,m)=>String.fromCharCode(+("0x"+m)))):A.ACCESS_TOKEN||"",r?`${xp}.${r}:${c}`:`${xp}:${c}`}fetchEventData(){const r=tu("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(r)try{const f=localStorage.getItem(s);f&&(this.eventData=JSON.parse(f));const m=localStorage.getItem(c);m&&(this.anonId=m)}catch{Qr("Unable to read from LocalStorage")}}saveEventData(){const r=tu("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid"),f=this.anonId;if(r&&f)try{localStorage.setItem(c,f),Object.keys(this.eventData).length>=1&&localStorage.setItem(s,JSON.stringify(this.eventData))}catch{Qr("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,s,c,f){if(!A.EVENTS_URL)return;const m=wa(A.EVENTS_URL);m.params.push(`access_token=${f||A.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(r).toISOString()},x=s?Xi(g,s):g,w={url:bc(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};this.pendingRequest=function(E,M){return mf(Xi(E,{method:"POST"}),M)}(w,E=>{this.pendingRequest=null,c(E),this.saveEventData(),this.processRequests(f)})}queueRequest(r,s){this.queue.push(r),this.processRequests(s)}}const t1=new class extends _f{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,r){A.EVENTS_URL&&A.ACCESS_TOKEN&&Array.isArray(i)&&i.some(s=>k(s)||O(s))&&this.queueRequest(Date.now(),r)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=e1(A.ACCESS_TOKEN),s=r?r.u:A.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;Ay(this.anonId)||(this.anonId=lp(),c=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),g=new Date(f),x=(f-this.eventData.lastSuccess)/864e5;c=c||x>=1||x<-1||m.getDate()!==g.getDate()}else c=!0;c?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:By,"enabled.telemetry":!1,userId:this.anonId},m=>{m||(this.eventData.lastSuccess=f,this.eventData.tokenU=s)},i):this.processRequests()}},$y=t1.postTurnstileEvent.bind(t1),vf=new class extends _f{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,r,s,c){this.skuToken=r,this.errorCb=c,A.EVENTS_URL&&(s||A.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(jy)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),Ay(this.anonId)||(this.anonId=lp()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:By,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):r&&(this.success[r]=!0)},i))}remove(){this.errorCb=null}},n1=vf.postMapLoadEvent.bind(vf),r1=new class extends _f{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(i){let r=this.mapInstanceIdMap.get(i);return r||(r=lp(),this.mapInstanceIdMap.set(i,r)),r}getEventId(i){const r=this.eventIdPerMapInstanceMap.get(i)||0;return this.eventIdPerMapInstanceMap.set(i,r+1),r}postStyleLoadEvent(i,r){const{map:s,style:c,importedStyles:f}=r;if(!A.EVENTS_URL||!i&&!A.ACCESS_TOKEN)return;const m=this.getMapInstanceId(s),g={mapInstanceId:m,eventId:this.getEventId(m),style:c};f.length&&(g.importedStyles=f),this.queueRequest({timestamp:Date.now(),payload:g},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:s}=this.queue.shift();this.postEvent(r,s,()=>{},i)}},EA=r1.postStyleLoadEvent.bind(r1),bp=new class extends _f{constructor(){super("gljs.performance")}postPerformanceEvent(i,r){A.EVENTS_URL&&(i||A.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:s}=this.queue.shift(),c=function(f){const m=performance.getEntriesByType("resource"),g=performance.getEntriesByType("mark"),x=function(B){const $={};if(B){for(const q in B)if(q!=="other")for(const X of B[q]){const te=`${q}ResolveRangeMin`,ce=`${q}ResolveRangeMax`,he=`${q}RequestCount`,fe=`${q}RequestCachedCount`;$[te]=Math.min($[te]||1/0,X.startTime),$[ce]=Math.max($[ce]||-1/0,X.responseEnd);const Ee=we=>{$[we]===void 0&&($[we]=0),++$[we]};X.transferSize!==void 0&&X.transferSize===0&&Ee(fe),Ee(he)}}return $}(function(B,$){const q={};if(B)for(const X of B){const te=$(X);q[te]===void 0&&(q[te]=[]),q[te].push(X)}return q}(m,H)),w=window.devicePixelRatio,E=navigator.connection||navigator.mozConnection||navigator.webkitConnection,M=E?E.effectiveType:void 0,R={counters:[],metadata:[],attributes:[]},D=(B,$,q)=>{q!=null&&B.push({name:$,value:q.toString()})};for(const B in x)D(R.counters,B,x[B]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(D(R.counters,"interactionRangeMin",f.interactionRange[0]),D(R.counters,"interactionRangeMax",f.interactionRange[1])),g)for(const B of Object.keys(j)){const $=j[B],q=g.find(X=>X.name===$);q&&D(R.counters,$,q.startTime)}return D(R.counters,"visibilityHidden",f.visibilityHidden),D(R.attributes,"style",function(B){if(B)for(const $ of B){const q=$.name.split("?")[0];if(U(q)){const X=q.split("/").slice(-2);if(X.length===2)return`mapbox://styles/${X[0]}/${X[1]}`}}}(m)),D(R.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),D(R.attributes,"fogEnabled",f.fogEnabled?"true":"false"),D(R.attributes,"projection",f.projection),D(R.attributes,"zoom",f.zoom),D(R.metadata,"devicePixelRatio",w),D(R.metadata,"connectionEffectiveType",M),D(R.metadata,"navigatorUserAgent",navigator.userAgent),D(R.metadata,"screenWidth",window.screen.width),D(R.metadata,"screenHeight",window.screen.height),D(R.metadata,"windowWidth",window.innerWidth),D(R.metadata,"windowHeight",window.innerHeight),D(R.metadata,"mapWidth",f.width/w),D(R.metadata,"mapHeight",f.height/w),D(R.metadata,"webglRenderer",f.renderer),D(R.metadata,"webglVendor",f.vendor),D(R.metadata,"sdkVersion",b),D(R.metadata,"sdkIdentifier","mapbox-gl-js"),R}(s);for(const f of c.metadata);for(const f of c.counters);for(const f of c.attributes);this.postEvent(r,c,()=>{},i)}},AA=bp.postPerformanceEvent.bind(bp),wc=new class extends _f{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,r,s,c){if(!A.API_URL||!A.SESSION_PATH)return;const f=wa(A.API_URL+A.SESSION_PATH);f.params.push(`sku=${r||""}`),f.params.push(`access_token=${c||A.ACCESS_TOKEN||""}`);const m={url:bc(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(g,x){return mf(Xi(g,{method:"GET"}),x)}(m,g=>{this.pendingRequest=null,s(g),this.saveEventData(),this.processRequests(c)})}getSessionAPI(i,r,s,c){this.skuToken=r,this.errorCb=c,A.SESSION_PATH&&A.API_URL&&(s||A.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(jy)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||this.getSession(s,this.skuToken,c=>{c?this.errorCb(c):r&&(this.success[r]=!0)},i)}remove(){this.errorCb=null}},wp=wc.getSessionAPI.bind(wc),xf=new Set;var ru={exports:{}},i1={exports:function(i,r){var s,c,f,m,g,x,w,E;for(c=i.length-(s=3&i.length),f=r,g=3432918353,x=461845907,E=0;E<c;)w=255&i.charCodeAt(E)|(255&i.charCodeAt(++E))<<8|(255&i.charCodeAt(++E))<<16|(255&i.charCodeAt(++E))<<24,++E,f=27492+(65535&(m=5*(65535&(f=(f^=w=(65535&(w=(w=(65535&w)*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*x+(((w>>>16)*x&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(w=0,s){case 3:w^=(255&i.charCodeAt(E+2))<<16;case 2:w^=(255&i.charCodeAt(E+1))<<8;case 1:f^=w=(65535&(w=(w=(65535&(w^=255&i.charCodeAt(E)))*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*x+(((w>>>16)*x&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0}},CA={exports:function(i,r){for(var s,c=i.length,f=r^c,m=0;c>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(s>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++m;switch(c){case 3:f^=(255&i.charCodeAt(m+2))<<16;case 2:f^=(255&i.charCodeAt(m+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(m)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0}},o1=i1.exports,Uy=CA.exports;ru.exports=o1,ru.exports.murmur3=o1,ru.exports.murmur2=Uy;var Sc=Y(ru.exports);function Vy(i,r,s){s[i]&&s[i].indexOf(r)!==-1||(s[i]=s[i]||[],s[i].push(r))}function Tc(i,r,s){if(s&&s[i]){const c=s[i].indexOf(r);c!==-1&&s[i].splice(c,1)}}class po{constructor(r,s={}){Xi(this,s),this.type=r}}class Sp extends po{constructor(r,s={}){super("error",Xi({error:r},s))}}class iu{on(r,s){return this._listeners=this._listeners||{},Vy(r,s,this._listeners),this}off(r,s){return Tc(r,s,this._listeners),Tc(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Vy(r,s,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,s){typeof r=="string"&&(r=new po(r,s||{}));const c=r.type;if(this.listens(c)){r.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const x of f)x.call(this,r);const m=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const x of m)Tc(c,x,this._oneTimeListeners),x.call(this,r);const g=this._eventedParent;g&&(Xi(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(r))}else r instanceof Sp&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}a.F=void 0;var a1={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Tp(i){return(i=Math.round(i))<0?0:i>255?255:i}function Gy(i){return Tp(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function bf(i){return(r=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:r>1?1:r;var r}function wf(i,r,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?i+(r-i)*s*6:2*s<1?r:3*s<2?i+(r-i)*(2/3-s)*6:i}try{a.F={}.parseCSSColor=function(i){var r,s=i.replace(/ /g,"").toLowerCase();if(s in a1)return a1[s].slice();if(s[0]==="#")return s.length===4?(r=parseInt(s.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:s.length===7&&(r=parseInt(s.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var c=s.indexOf("("),f=s.indexOf(")");if(c!==-1&&f+1===s.length){var m=s.substr(0,c),g=s.substr(c+1,f-(c+1)).split(","),x=1;switch(m){case"rgba":if(g.length!==4)return null;x=bf(g.pop());case"rgb":return g.length!==3?null:[Gy(g[0]),Gy(g[1]),Gy(g[2]),x];case"hsla":if(g.length!==4)return null;x=bf(g.pop());case"hsl":if(g.length!==3)return null;var w=(parseFloat(g[0])%360+360)%360/360,E=bf(g[1]),M=bf(g[2]),R=M<=.5?M*(E+1):M+E-M*E,D=2*M-R;return[Tp(255*wf(D,R,w+1/3)),Tp(255*wf(D,R,w)),Tp(255*wf(D,R,w-1/3)),x];default:return null}}return null}}catch{}class Xn{constructor(r,s,c,f=1){this.r=r,this.g=s,this.b=c,this.a=f}static parse(r){if(!r)return;if(r instanceof Xn)return r;if(typeof r!="string")return;const s=a.F(r);return s?new Xn(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[r,s,c,f]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(r)},${Math.round(s)},${Math.round(c)},${f})`}toRenderColor(r){const{r:s,g:c,b:f,a:m}=this;return new PA(r,s,c,f,m)}}class PA{constructor(r,s,c,f,m){if(r){const g=r.image.height,x=g*g;s=m===0?0:s/m*(g-1),c=m===0?0:c/m*(g-1),f=m===0?0:f/m*(g-1);const w=Math.floor(s),E=Math.floor(c),M=Math.floor(f),R=Math.ceil(s),D=Math.ceil(c),B=Math.ceil(f),$=s-w,q=c-E,X=f-M,te=r.image.data,ce=4*(w+E*x+M*g),he=4*(w+E*x+B*g),fe=4*(w+D*x+M*g),Ee=4*(w+D*x+B*g),we=4*(R+E*x+M*g),Ie=4*(R+E*x+B*g),ke=4*(R+D*x+M*g),$e=4*(R+D*x+B*g);if(ce<0||$e>=te.length)throw new Error("out of range");this.r=on(on(on(te[ce],te[he],X),on(te[fe],te[Ee],X),q),on(on(te[we],te[Ie],X),on(te[ke],te[$e],X),q),$)/255*m,this.g=on(on(on(te[ce+1],te[he+1],X),on(te[fe+1],te[Ee+1],X),q),on(on(te[we+1],te[Ie+1],X),on(te[ke+1],te[$e+1],X),q),$)/255*m,this.b=on(on(on(te[ce+2],te[he+2],X),on(te[fe+2],te[Ee+2],X),q),on(on(te[we+2],te[Ie+2],X),on(te[ke+2],te[$e+2],X),q),$)/255*m,this.a=m}else this.r=s,this.g=c,this.b=f,this.a=m}toArray(){const{r,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*r/f,255*s/f,255*c/f,f]}toArray01(){const{r,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[r/f,s/f,c/f,f]}toArray01Scaled(r){const{r:s,g:c,b:f,a:m}=this;return m===0?[0,0,0]:[s/m*r,c/m*r,f/m*r]}toArray01PremultipliedAlpha(){const{r,g:s,b:c,a:f}=this;return[r,s,c,f]}toArray01Linear(){const{r,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[Math.pow(r/f,2.2),Math.pow(s/f,2.2),Math.pow(c/f,2.2),f]}}function on(i,r,s){return i*(1-s)+r*s}function s1(i,r,s){return i.map((c,f)=>on(c,r[f],s))}Xn.black=new Xn(0,0,0,1),Xn.white=new Xn(1,1,1,1),Xn.transparent=new Xn(0,0,0,0),Xn.red=new Xn(1,0,0,1),Xn.blue=new Xn(0,0,1,1);var Ep=Object.freeze({__proto__:null,array:s1,color:function(i,r,s){return new Xn(on(i.r,r.r,s),on(i.g,r.g,s),on(i.b,r.b,s),on(i.a,r.a,s))},number:on});function Wy(i,...r){for(const s of r)for(const c in s)i[c]=s[c];return i}class es extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class Hy{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[c,f]of s)this.bindings[c]=f}concat(r){return new Hy(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Ec={kind:"null"},Bt={kind:"number"},Yn={kind:"string"},Kn={kind:"boolean"},mo={kind:"color"},Ac={kind:"object"},Hn={kind:"value"},Sa={kind:"collator"},Cc={kind:"formatted"},ts={kind:"resolvedImage"};function Ao(i,r){return{kind:"array",itemType:i,N:r}}function Jr(i){if(i.kind==="array"){const r=Jr(i.itemType);return typeof i.N=="number"?`array<${r}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${r}>`}return i.kind}const MA=[Ec,Bt,Yn,Kn,mo,Cc,Ac,Ao(Hn),ts];function Sf(i,r){if(r.kind==="error")return null;if(i.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Sf(i.itemType,r.itemType))&&(typeof i.N!="number"||i.N===r.N))return null}else{if(i.kind===r.kind)return null;if(i.kind==="value"){for(const s of MA)if(!Sf(s,r))return null}}return`Expected ${Jr(i)} but found ${Jr(r)} instead.`}function qy(i,r){return r.some(s=>s.kind===i.kind)}function Pc(i,r){return r.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}class Tf{constructor(r,s,c){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ou{constructor(r,s,c,f,m){this.text=r.normalize?r.normalize():r,this.image=s,this.scale=c,this.fontStack=f,this.textColor=m}}class Yi{constructor(r){this.sections=r}static fromString(r){return new Yi([new ou(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.namePrimary.length!==0)}static factory(r){return r instanceof Yi?r:Yi.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const s of this.sections){if(s.image){r.push(["image",s.image.namePrimary]);continue}r.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),r.push(c)}return r}}class go{constructor(r){this.namePrimary=r.namePrimary,r.nameSecondary&&(this.nameSecondary=r.nameSecondary),this.available=r.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(r,s){return r?new go({namePrimary:r,nameSecondary:s,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function l1(i,r,s,c){return typeof i=="number"&&i>=0&&i<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,r,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,r,s,c]:[i,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yo(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Xn||i instanceof Tf||i instanceof Yi||i instanceof go)return!0;if(Array.isArray(i)){for(const r of i)if(!yo(r))return!1;return!0}if(typeof i=="object"){for(const r in i)if(!yo(i[r]))return!1;return!0}return!1}function fi(i){if(i===null)return Ec;if(typeof i=="string")return Yn;if(typeof i=="boolean")return Kn;if(typeof i=="number")return Bt;if(i instanceof Xn)return mo;if(i instanceof Tf)return Sa;if(i instanceof Yi)return Cc;if(i instanceof go)return ts;if(Array.isArray(i)){const r=i.length;let s;for(const c of i){const f=fi(c);if(s){if(s===f)continue;s=Hn;break}s=f}return Ao(s||Hn,r)}return Ac}function aa(i){const r=typeof i;return i===null?"":r==="string"||r==="number"||r==="boolean"?String(i):i instanceof Xn||i instanceof Yi||i instanceof go?i.toString():JSON.stringify(i)}class Os{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!yo(r[1]))return s.error("invalid value");const c=r[1];let f=fi(c);const m=s.expectedType;return f.kind!=="array"||f.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(f=m),new Os(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Xn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Yi?this.value.serialize():this.value}}class Si{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Zy={string:Yn,number:Bt,boolean:Kn,object:Ac};class Ta{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let c,f=1;const m=r[0];if(m==="array"){let x,w;if(r.length>2){const E=r[1];if(typeof E!="string"||!(E in Zy)||E==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);x=Zy[E],f++}else x=Hn;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);w=r[2],f++}c=Ao(x,w)}else c=Zy[m];const g=[];for(;f<r.length;f++){const x=s.parse(r[f],f,Hn);if(!x)return null;g.push(x)}return new Ta(c,g)}evaluate(r){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(r);if(!Sf(this.type,fi(c)))return c;if(s===this.args.length-1)throw new Si(`Expected value to be of type ${Jr(this.type)}, but found ${Jr(fi(c))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,s=[r.kind];if(r.kind==="array"){const c=r.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const f=r.N;(typeof f=="number"||this.args.length>1)&&s.push(f)}}return s.concat(this.args.map(c=>c.serialize()))}}class Ef{constructor(r){this.type=Cc,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const f=[];let m=!1;for(let g=1;g<=r.length-1;++g){const x=r[g];if(m&&typeof x=="object"&&!Array.isArray(x)){m=!1;let w=null;if(x["font-scale"]&&(w=s.parse(x["font-scale"],1,Bt),!w))return null;let E=null;if(x["text-font"]&&(E=s.parse(x["text-font"],1,Ao(Yn)),!E))return null;let M=null;if(x["text-color"]&&(M=s.parse(x["text-color"],1,mo),!M))return null;const R=f[f.length-1];R.scale=w,R.font=E,R.textColor=M}else{const w=s.parse(r[g],1,Hn);if(!w)return null;const E=w.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,f.push({content:w,scale:null,font:null,textColor:null})}}return new Ef(f)}evaluate(r){return new Yi(this.sections.map(s=>{const c=s.content.evaluate(r);return fi(c)===ts?new ou("",c,null,null,null):new ou(aa(c),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const s of this.sections){r.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),r.push(c)}return r}}class Af{constructor(r,s){this.type=ts,this.inputPrimary=r,this.inputSecondary=s}static parse(r,s){if(r.length<2)return s.error("Expected two or more arguments.");const c=s.parse(r[1],1,Yn);if(!c)return s.error("No image name provided.");if(r.length===2)return new Af(c);const f=s.parse(r[2],1,Yn);return f?new Af(c,f):s.error("Secondary image variant is not a string.")}evaluate(r){const s=go.fromString(this.inputPrimary.evaluate(r),this.inputSecondary?this.inputSecondary.evaluate(r):void 0);return s&&r.availableImages&&(s.available=r.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&r.availableImages&&(s.available=r.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(r){r(this.inputPrimary),this.inputSecondary&&r(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function au(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}const IA={"to-boolean":Kn,"to-color":mo,"to-number":Bt,"to-string":Yn};class Ea{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const c=r[0],f=[];let m=Ec;if(c==="to-array"){if(!Array.isArray(r[1]))return null;const g=r[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);m=Ao(s.expectedType.itemType,g)}else{if(!(g>0&&yo(r[1][0])))return null;m=Ao(fi(r[1][0]),g)}for(let x=0;x<g;x++){const w=r[1][x];let E;if(au(w)==="array")E=s.parse(w,void 0,m.itemType);else{const M=au(w);if(M!==m.itemType.kind)return s.error(`Expected ${m.itemType.kind} but found ${M}.`);E=s.registry.literal.parse(["literal",w===void 0?null:w],s)}if(!E)return null;f.push(E)}}else{if((c==="to-boolean"||c==="to-string")&&r.length!==2)return s.error("Expected one argument.");m=IA[c];for(let g=1;g<r.length;g++){const x=s.parse(r[g],g,Hn);if(!x)return null;f.push(x)}}return new Ea(m,f)}evaluate(r){if(this.type.kind==="boolean")return!!this.args[0].evaluate(r);if(this.type.kind==="color"){let s,c;for(const f of this.args){if(s=f.evaluate(r),c=null,s instanceof Xn)return s;if(typeof s=="string"){const m=r.parseColor(s);if(m)return m}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:l1(s[0],s[1],s[2],s[3]),!c))return new Xn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Si(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(r),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new Si(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Yi.fromString(aa(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?go.fromString(aa(this.args[0].evaluate(r))):this.type.kind==="array"?this.args.map(s=>s.evaluate(r)):aa(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ef([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Af(this.args[0]).serialize();const r=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{r.push(s.serialize())}),r}}const u1=["Unknown","Point","LineString","Polygon"];class c1{constructor(r,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?u1[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-r[0])+this.featureDistanceData.bearing[1]*(f*s-r[1])}return 0}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=Xn.parse(r)),s}getConfig(r){return this.options?this.options.get(r):null}}class oo{constructor(r,s,c,f,m){this.name=r,this.type=s,this._evaluate=c,this.args=f,this._overloadIndex=m}evaluate(r){if(!this._evaluate){const s=oo.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,s){const c=r[0],f=oo.definitions[c];if(!f)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(f)?f[0]:f.type,g=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,x=[];let w=null,E=-1;for(const[M,R]of g){if(Array.isArray(M)&&M.length!==r.length-1)continue;x.push(M),E++,w=new b1(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const D=[];let B=!1;for(let $=1;$<r.length;$++){const q=r[$],X=Array.isArray(M)?M[$-1]:M.type,te=w.parse(q,1+D.length,X);if(!te){B=!0;break}D.push(te)}if(!B)if(Array.isArray(M)&&M.length!==D.length)w.error(`Expected ${M.length} arguments, but found ${D.length} instead.`);else{for(let $=0;$<D.length;$++){const q=Array.isArray(M)?M[$]:M.type,X=D[$];w.concat($+1).checkSubtype(q,X.type)}if(w.errors.length===0)return new oo(c,m,R,D,E)}}if(x.length===1)s.errors.push(...w.errors);else{const M=(x.length?x:g.map(([D])=>D)).map(Xy).join(" | "),R=[];for(let D=1;D<r.length;D++){const B=s.parse(r[D],1+R.length);if(!B)return null;R.push(Jr(B.type))}s.error(`Expected arguments of type ${M}, but found (${R.join(", ")}) instead.`)}return null}static register(r,s){oo.definitions=s;for(const c in s)r[c]=oo}}function Xy(i){return Array.isArray(i)?`(${i.map(Jr).join(", ")})`:`(${Jr(i.type)}...)`}class ml{constructor(r,s,c){this.type=Sa,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const c=r[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const f=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Kn);if(!f)return null;const m=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Kn);if(!m)return null;let g=null;return c.locale&&(g=s.parse(c.locale,1,Yn),!g)?null:new ml(f,m,g)}evaluate(r){return new Tf(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}var Yy={exports:{}};Yy.exports=function(){function i(c,f,m,g,x){for(;g>m;){if(g-m>600){var w=g-m+1,E=f-m+1,M=Math.log(w),R=.5*Math.exp(2*M/3),D=.5*Math.sqrt(M*R*(w-R)/w)*(E-w/2<0?-1:1);i(c,f,Math.max(m,Math.floor(f-E*R/w+D)),Math.min(g,Math.floor(f+(w-E)*R/w+D)),x)}var B=c[f],$=m,q=g;for(r(c,m,f),x(c[g],B)>0&&r(c,m,g);$<q;){for(r(c,$,q),$++,q--;x(c[$],B)<0;)$++;for(;x(c[q],B)>0;)q--}x(c[m],B)===0?r(c,m,q):r(c,++q,g),q<=f&&(m=q+1),f<=q&&(g=q-1)}}function r(c,f,m){var g=c[f];c[f]=c[m],c[m]=g}function s(c,f){return c<f?-1:c>f?1:0}return function(c,f,m,g,x){i(c,f,m||0,g||c.length-1,x||s)}}();var OA=Y(Yy.exports);function RA(i){let r=0;for(let s,c,f=0,m=i.length,g=m-1;f<m;g=f++)s=i[f],c=i[g],r+=(c.x-s.x)*(s.y+c.y);return r}function Cf(i,r){i[0]=Math.min(i[0],r[0]),i[1]=Math.min(i[1],r[1]),i[2]=Math.max(i[2],r[0]),i[3]=Math.max(i[3],r[1])}function Mc(i,r){return!(i[0]<=r[0]||i[2]>=r[2]||i[1]<=r[1]||i[3]>=r[3])}function kA(i,r,s){const c=i[0]-r[0],f=i[1]-r[1],m=i[0]-s[0],g=i[1]-s[1];return c*g-m*f==0&&c*m<=0&&f*g<=0}function Ic(i,r,s=!1){let c=!1;for(let x=0,w=r.length;x<w;x++){const E=r[x];for(let M=0,R=E.length,D=R-1;M<R;D=M++){const B=E[D],$=E[M];if(kA(i,B,$))return s;(m=B)[1]>(f=i)[1]!=(g=$)[1]>f[1]&&f[0]<(g[0]-m[0])*(f[1]-m[1])/(g[1]-m[1])+m[0]&&(c=!c)}}var f,m,g;return c}function Ky(i,r,s,c){const f=c[0]-s[0],m=c[1]-s[1],g=(i[0]-s[0])*m-f*(i[1]-s[1]),x=(r[0]-s[0])*m-f*(r[1]-s[1]);return g>0&&x<0||g<0&&x>0}function Gn(i,r,s,c){return(f=[c[0]-s[0],c[1]-s[1]])[0]*(m=[r[0]-i[0],r[1]-i[1]])[1]-f[1]*m[0]!=0&&!(!Ky(i,r,s,c)||!Ky(s,c,i,r));var f,m}const Rs=8192;function h1(i,r){const s=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,r.z);return[Math.round(s*f*Rs),Math.round(c*f*Rs)]}function DA(i,r){for(let s=0;s<r.length;s++)if(Ic(i,r[s]))return!0;return!1}function LA(i,r,s){for(const c of s)for(let f=0,m=c.length,g=m-1;f<m;g=f++)if(Gn(i,r,c[g],c[f]))return!0;return!1}function Pf(i,r){for(let s=0;s<i.length;++s)if(!Ic(i[s],r))return!1;for(let s=0;s<i.length-1;++s)if(LA(i[s],i[s+1],r))return!1;return!0}function Ap(i,r){for(let s=0;s<r.length;s++)if(Pf(i,r[s]))return!0;return!1}function Oc(i,r,s){const c=[];for(let f=0;f<i.length;f++){const m=[];for(let g=0;g<i[f].length;g++){const x=h1(i[f][g],s);Cf(r,x),m.push(x)}c.push(m)}return c}function f1(i,r,s){const c=[];for(let f=0;f<i.length;f++){const m=Oc(i[f],r,s);c.push(m)}return c}function Qy(i,r,s,c){if(i[0]<s[0]||i[0]>s[2]){const f=.5*c;let m=i[0]-s[0]>f?-c:s[0]-i[0]>f?c:0;m===0&&(m=i[0]-s[2]>f?-c:s[2]-i[0]>f?c:0),i[0]+=m}Cf(r,i)}function Aa(i,r,s,c){const f=Math.pow(2,c.z)*Rs,m=[c.x*Rs,c.y*Rs],g=[];if(!i)return g;for(const x of i)for(const w of x){const E=[w.x+m[0],w.y+m[1]];Qy(E,r,s,f),g.push(E)}return g}function d1(i,r,s,c){const f=Math.pow(2,c.z)*Rs,m=[c.x*Rs,c.y*Rs],g=[];if(!i)return g;for(const w of i){const E=[];for(const M of w){const R=[M.x+m[0],M.y+m[1]];Cf(r,R),E.push(R)}g.push(E)}if(r[2]-r[0]<=f/2){(x=r)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const w of g)for(const E of w)Qy(E,r,s,f)}var x;return g}class gl{constructor(r,s){this.type=Kn,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(yo(r[1])){const c=r[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const m=c.features[f].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new gl(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new gl(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new gl(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,c){const f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=s.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const x=Oc(c.coordinates,m,g),w=Aa(s.geometry(),f,m,g);if(!Mc(f,m))return!1;for(const E of w)if(!Ic(E,x))return!1}if(c.type==="MultiPolygon"){const x=f1(c.coordinates,m,g),w=Aa(s.geometry(),f,m,g);if(!Mc(f,m))return!1;for(const E of w)if(!DA(E,x))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,c){const f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=s.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const x=Oc(c.coordinates,m,g),w=d1(s.geometry(),f,m,g);if(!Mc(f,m))return!1;for(const E of w)if(!Pf(E,x))return!1}if(c.type==="MultiPolygon"){const x=f1(c.coordinates,m,g),w=d1(s.geometry(),f,m,g);if(!Mc(f,m))return!1;for(const E of w)if(!Ap(E,x))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const yl={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Cp=1/298.257223563,p1=Cp*(2-Cp),Mf=Math.PI/180;class If{static fromTile(r,s,c){const f=Math.PI*(1-2*(r+.5)/Math.pow(2,s)),m=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/Mf;return new If(m,c)}static get units(){return yl}constructor(r,s){if(r===void 0)throw new Error("No latitude given.");if(s&&!yl[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(yl).join(", ")}`);const c=6378.137*Mf*(s?yl[s]:1),f=Math.cos(r*Mf),m=1/(1-p1*(1-f*f)),g=Math.sqrt(m);this.kx=c*g*f,this.ky=c*g*m*(1-p1)}distance(r,s){const c=sa(r[0]-s[0])*this.kx,f=(r[1]-s[1])*this.ky;return Math.sqrt(c*c+f*f)}bearing(r,s){const c=sa(s[0]-r[0])*this.kx;return Math.atan2(c,(s[1]-r[1])*this.ky)/Mf}destination(r,s,c){const f=c*Mf;return this.offset(r,Math.sin(f)*s,Math.cos(f)*s)}offset(r,s,c){return[r[0]+s/this.kx,r[1]+c/this.ky]}lineDistance(r){let s=0;for(let c=0;c<r.length-1;c++)s+=this.distance(r[c],r[c+1]);return s}area(r){let s=0;for(let c=0;c<r.length;c++){const f=r[c];for(let m=0,g=f.length,x=g-1;m<g;x=m++)s+=sa(f[m][0]-f[x][0])*(f[m][1]+f[x][1])*(c?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(r,s){let c=0;if(s<=0)return r[0];for(let f=0;f<r.length-1;f++){const m=r[f],g=r[f+1],x=this.distance(m,g);if(c+=x,c>s)return Of(m,g,(s-(c-x))/x)}return r[r.length-1]}pointToSegmentDistance(r,s,c){let[f,m]=s,g=sa(c[0]-f)*this.kx,x=(c[1]-m)*this.ky;if(g!==0||x!==0){const w=(sa(r[0]-f)*this.kx*g+(r[1]-m)*this.ky*x)/(g*g+x*x);w>1?(f=c[0],m=c[1]):w>0&&(f+=g/this.kx*w,m+=x/this.ky*w)}return g=sa(r[0]-f)*this.kx,x=(r[1]-m)*this.ky,Math.sqrt(g*g+x*x)}pointOnLine(r,s){let c=1/0,f=r[0][0],m=r[0][1],g=0,x=0;for(let w=0;w<r.length-1;w++){let E=r[w][0],M=r[w][1],R=sa(r[w+1][0]-E)*this.kx,D=(r[w+1][1]-M)*this.ky,B=0;R===0&&D===0||(B=(sa(s[0]-E)*this.kx*R+(s[1]-M)*this.ky*D)/(R*R+D*D),B>1?(E=r[w+1][0],M=r[w+1][1]):B>0&&(E+=R/this.kx*B,M+=D/this.ky*B)),R=sa(s[0]-E)*this.kx,D=(s[1]-M)*this.ky;const $=R*R+D*D;$<c&&(c=$,f=E,m=M,g=w,x=B)}return{point:[f,m],index:g,t:Math.max(0,Math.min(1,x))}}lineSlice(r,s,c){let f=this.pointOnLine(c,r),m=this.pointOnLine(c,s);if(f.index>m.index||f.index===m.index&&f.t>m.t){const E=f;f=m,m=E}const g=[f.point],x=f.index+1,w=m.index;!Jy(c[x],g[0])&&x<=w&&g.push(c[x]);for(let E=x+1;E<=w;E++)g.push(c[E]);return Jy(c[w],m.point)||g.push(m.point),g}lineSliceAlong(r,s,c){let f=0;const m=[];for(let g=0;g<c.length-1;g++){const x=c[g],w=c[g+1],E=this.distance(x,w);if(f+=E,f>r&&m.length===0&&m.push(Of(x,w,(r-(f-E))/E)),f>=s)return m.push(Of(x,w,(s-(f-E))/E)),m;f>r&&m.push(w)}return m}bufferPoint(r,s){const c=s/this.ky,f=s/this.kx;return[r[0]-f,r[1]-c,r[0]+f,r[1]+c]}bufferBBox(r,s){const c=s/this.ky,f=s/this.kx;return[r[0]-f,r[1]-c,r[2]+f,r[3]+c]}insideBBox(r,s){return sa(r[0]-s[0])>=0&&sa(r[0]-s[2])<=0&&r[1]>=s[1]&&r[1]<=s[3]}}function Jy(i,r){return i[0]===r[0]&&i[1]===r[1]}function Of(i,r,s){const c=sa(r[0]-i[0]);return[i[0]+c*s,i[1]+(r[1]-i[1])*s]}function sa(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}var Rf={exports:{}};(function(i,r){i.exports=function(){var s=function(f,m){if(f===void 0&&(f=[]),m===void 0&&(m=c),this.data=f,this.length=this.data.length,this.compare=m,this.length>0)for(var g=(this.length>>1)-1;g>=0;g--)this._down(g)};function c(f,m){return f<m?-1:f>m?1:0}return s.prototype.push=function(f){this.data.push(f),this.length++,this._up(this.length-1)},s.prototype.pop=function(){if(this.length!==0){var f=this.data[0],m=this.data.pop();return this.length--,this.length>0&&(this.data[0]=m,this._down(0)),f}},s.prototype.peek=function(){return this.data[0]},s.prototype._up=function(f){for(var m=this.data,g=this.compare,x=m[f];f>0;){var w=f-1>>1,E=m[w];if(g(x,E)>=0)break;m[f]=E,f=w}m[f]=x},s.prototype._down=function(f){for(var m=this.data,g=this.compare,x=this.length>>1,w=m[f];f<x;){var E=1+(f<<1),M=m[E],R=E+1;if(R<this.length&&g(m[R],M)<0&&(E=R,M=m[R]),g(M,w)>=0)break;m[f]=M,f=E}m[f]=w},s}()})(Rf);var e_=Y(Rf.exports),Mt=8192;function m1(i,r){return r.dist-i.dist}const t_=100,n_=50;function g1(i){const r=[1/0,1/0,-1/0,-1/0];if(r.length!==i.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1;return!0}function Pp(i){return i[1]-i[0]+1}function ns(i,r){const s=i[1]>=i[0]&&i[1]<r;return s||console.warn("Distance Expression: Index is out of range"),s}function _l(i,r){if(i[0]>i[1])return[null,null];const s=Pp(i);if(r){if(s===2)return[i,null];const c=Math.floor(s/2);return[[i[0],i[0]+c],[i[0]+c,i[1]]]}{if(s===1)return[i,null];const c=Math.floor(s/2)-1;return[[i[0],i[0]+c],[i[0]+c+1,i[1]]]}}function su(i,r){const s=[1/0,1/0,-1/0,-1/0];if(!ns(r,i.length))return s;for(let c=r[0];c<=r[1];++c)Cf(s,i[c]);return s}function Mp(i){const r=[1/0,1/0,-1/0,-1/0];for(let s=0;s<i.length;++s)for(let c=0;c<i[s].length;++c)Cf(r,i[s][c]);return r}function vl(i,r,s){if(g1(i)||g1(r))return NaN;let c=0,f=0;return i[2]<r[0]&&(c=r[0]-i[2]),i[0]>r[2]&&(c=i[0]-r[2]),i[1]>r[3]&&(f=i[1]-r[3]),i[3]<r[1]&&(f=r[1]-i[3]),s.distance([0,0],[c,f])}function zA(i){return 360*i-180}function FA(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function r_(i,r){const s=Math.pow(2,r.z),c=(i.y/Mt+r.y)/s;return[zA((i.x/Mt+r.x)/s),FA(c)]}function NA(i,r){const s=[];for(let c=0;c<i.length;++c)s.push(r_(i[c],r));return s}function y1(i,r,s){const c=s.pointOnLine(r,i).point;return s.distance(i,c)}function xl(i,r,s,c,f){const m=s.slice(c[0],c[1]+1);let g=1/0;for(let x=r[0];x<=r[1];++x)if((g=Math.min(g,y1(i[x],m,f)))===0)return 0;return g}function i_(i,r,s,c,f){const m=Math.min(f.pointToSegmentDistance(i,s,c),f.pointToSegmentDistance(r,s,c)),g=Math.min(f.pointToSegmentDistance(s,i,r),f.pointToSegmentDistance(c,i,r));return Math.min(m,g)}function BA(i,r,s,c,f){if(!ns(r,i.length)||!ns(c,s.length))return NaN;let m=1/0;for(let g=r[0];g<r[1];++g)for(let x=c[0];x<c[1];++x){if(Gn(i[g],i[g+1],s[x],s[x+1]))return 0;m=Math.min(m,i_(i[g],i[g+1],s[x],s[x+1],f))}return m}function _1(i,r,s,c,f){if(!ns(r,i.length)||!ns(c,s.length))return NaN;let m=1/0;for(let g=r[0];g<=r[1];++g)for(let x=c[0];x<=c[1];++x)if((m=Math.min(m,f.distance(i[g],s[x])))===0)return m;return m}function v1(i,r,s){if(Ic(i,r,!0))return 0;let c=1/0;for(const f of r){const m=f.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[m-1]&&(c=Math.min(c,s.pointToSegmentDistance(i,f[m-1],f[0])))===0||(c=Math.min(c,y1(i,f,s)))===0)return c}return c}function Ca(i,r,s,c){if(!ns(r,i.length))return NaN;for(let m=r[0];m<=r[1];++m)if(Ic(i[m],s,!0))return 0;let f=1/0;for(let m=r[0];m<r[1];++m)for(const g of s)for(let x=0,w=g.length,E=w-1;x<w;E=x++){if(Gn(i[m],i[m+1],g[E],g[x]))return 0;f=Math.min(f,i_(i[m],i[m+1],g[E],g[x],c))}return f}function o_(i,r){for(const s of i)for(let c=0;c<=s.length-1;++c)if(Ic(s[c],r,!0))return!0;return!1}function jA(i,r,s,c=1/0){const f=Mp(i),m=Mp(r);if(c!==1/0&&vl(f,m,s)>=c)return c;if(Mc(f,m)){if(o_(i,r))return 0}else if(o_(r,i))return 0;let g=c;for(const x of i)for(let w=0,E=x.length,M=E-1;w<E;M=w++)for(const R of r)for(let D=0,B=R.length,$=B-1;D<B;$=D++){if(Gn(x[M],x[w],R[$],R[D]))return 0;g=Math.min(g,i_(x[M],x[w],R[$],R[D],s))}return g}function kf(i,r,s,c,f,m,g){if(m===null||g===null)return;const x=vl(su(c,m),su(f,g),s);x<r&&i.push({dist:x,range1:m,range2:g})}function Ip(i,r,s,c,f=1/0){let m=Math.min(c.distance(i[0],s[0][0]),f);if(m===0)return m;const g=new e_([{dist:0,range1:[0,i.length-1],range2:[0,0]}],m1),x=r?n_:t_,w=Mp(s);for(;g.length;){const E=g.pop();if(E.dist>=m)continue;const M=E.range1;if(Pp(M)<=x){if(!ns(M,i.length))return NaN;if(r){const R=Ca(i,M,s,c);if((m=Math.min(m,R))===0)return m}else for(let R=M[0];R<=M[1];++R){const D=v1(i[R],s,c);if((m=Math.min(m,D))===0)return m}}else{const R=_l(M,r);if(R[0]!==null){const D=vl(su(i,R[0]),w,c);D<m&&g.push({dist:D,range1:R[0],range2:[0,0]})}if(R[1]!==null){const D=vl(su(i,R[1]),w,c);D<m&&g.push({dist:D,range1:R[1],range2:[0,0]})}}}return m}function x1(i,r,s,c,f,m=1/0){let g=Math.min(m,f.distance(i[0],s[0]));if(g===0)return g;const x=new e_([{dist:0,range1:[0,i.length-1],range2:[0,s.length-1]}],m1),w=r?n_:t_,E=c?n_:t_;for(;x.length;){const M=x.pop();if(M.dist>=g)continue;const R=M.range1,D=M.range2;if(Pp(R)<=w&&Pp(D)<=E){if(!ns(R,i.length)||!ns(D,s.length))return NaN;if(r&&c?g=Math.min(g,BA(i,R,s,D,f)):r||c?r&&!c?g=Math.min(g,xl(s,D,i,R,f)):!r&&c&&(g=Math.min(g,xl(i,R,s,D,f))):g=Math.min(g,_1(i,R,s,D,f)),g===0)return g}else{const B=_l(R,r),$=_l(D,c);kf(x,g,f,i,s,B[0],$[0]),kf(x,g,f,i,s,B[0],$[1]),kf(x,g,f,i,s,B[1],$[0]),kf(x,g,f,i,s,B[1],$[1])}}return g}function a_(i,r,s,c,f=1/0){let m=f;const g=su(i,[0,i.length-1]);for(const x of s)if(!(m!==1/0&&vl(g,su(x,[0,x.length-1]),c)>=m)&&(m=Math.min(m,x1(i,r,x,!0,c,m)),m===0))return m;return m}function Op(i,r,s,c,f=1/0){let m=f;const g=su(i,[0,i.length-1]);for(const x of s){if(m!==1/0&&vl(g,Mp(x),c)>=m)continue;const w=Ip(i,r,x,c,m);if(isNaN(w))return w;if((m=Math.min(m,w))===0)return m}return m}function s_(i){return i==="Point"||i==="MultiPoint"||i==="LineString"||i==="MultiLineString"||i==="Polygon"||i==="MultiPolygon"}class lu{constructor(r,s){this.type=Bt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${r.length-1} instead.`);if(yo(r[1])){const c=r[1];if(c.type==="FeatureCollection"){for(let f=0;f<c.features.length;++f)if(s_(c.features[f].geometry.type))return new lu(c,c.features[f].geometry)}else if(c.type==="Feature"){if(s_(c.geometry.type))return new lu(c,c.geometry)}else if(s_(c.type))return new lu(c,c)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(r){const s=r.geometry(),c=r.canonicalID();if(s!=null&&c!=null){if(r.geometryType()==="Point")return function(f,m,g){const x=[];for(const E of f)for(const M of E)x.push(r_(M,m));const w=new If(x[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?x1(x,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",w):g.type==="MultiLineString"?a_(x,!1,g.coordinates,w):g.type==="Polygon"||g.type==="MultiPolygon"?Op(x,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,w):null}(s,c,this.geometries);if(r.geometryType()==="LineString")return function(f,m,g){const x=[];for(const E of f){const M=[];for(const R of E)M.push(r_(R,m));x.push(M)}const w=new If(x[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return a_(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",x,w);if(g.type==="MultiLineString"){let E=1/0;for(let M=0;M<g.coordinates.length;M++){const R=a_(g.coordinates[M],!0,x,w,E);if(isNaN(R))return R;if((E=Math.min(E,R))===0)return E}return E}if(g.type==="Polygon"||g.type==="MultiPolygon"){let E=1/0;for(let M=0;M<x.length;M++){const R=Op(x[M],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,w,E);if(isNaN(R))return R;if((E=Math.min(E,R))===0)return E}return E}return null}(s,c,this.geometries);if(r.geometryType()==="Polygon")return function(f,m,g){const x=[];for(const E of function(M,R){const D=M.length;if(D<=1)return[M];const B=[];let $,q;for(let X=0;X<D;X++){const te=RA(M[X]);te!==0&&(M[X].area=Math.abs(te),q===void 0&&(q=te<0),q===te<0?($&&B.push($),$=[M[X]]):$.push(M[X]))}return $&&B.push($),B}(f)){const M=[];for(let R=0;R<E.length;++R)M.push(NA(E[R],m));x.push(M)}const w=new If(x[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return Op(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",x,w);if(g.type==="MultiLineString"){let E=1/0;for(let M=0;M<g.coordinates.length;M++){const R=Op(g.coordinates[M],!0,x,w,E);if(isNaN(R))return R;if((E=Math.min(E,R))===0)return E}return E}return g.type==="Polygon"||g.type==="MultiPolygon"?function(E,M,R){let D=1/0;for(const B of E)for(const $ of M){const q=jA(B,$,R,D);if(isNaN(q))return q;if((D=Math.min(D,q))===0)return D}return D}(g.type==="Polygon"?[g.coordinates]:g.coordinates,x,w):null}(s,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Rc(i,r){switch(i){case"string":return aa(r);case"number":return+r;case"boolean":return!!r;case"color":return Xn.parse(r);case"formatted":return Yi.fromString(aa(r));case"resolvedImage":return go.fromString(aa(r))}return r}function Df(i,r,s,c){return c!==void 0&&(i=c*Math.round(i/c)),r!==void 0&&i<r&&(i=r),s!==void 0&&i>s&&(i=s),i}class Li{constructor(r,s,c){this.type=r,this.key=s,this.scope=c}static parse(r,s){let c=s.expectedType;if(c==null&&(c=Hn),r.length<2||r.length>3)return s.error("Invalid number of arguments for 'config' expression.");const f=s.parse(r[1],1);if(!(f instanceof Os))return s.error("Key name of 'config' expression must be a string literal.");if(r.length>=3){const m=s.parse(r[2],2);return m instanceof Os?new Li(c,aa(f.value),aa(m.value)):s.error("Scope of 'config' expression must be a string literal.")}return new Li(c,aa(f.value))}evaluate(r){const s=[this.key,this.scope,r.scope].filter(Boolean).join(""),c=r.getConfig(s);if(!c)return null;const{type:f,value:m,values:g,minValue:x,maxValue:w,stepValue:E}=c,M=c.default.evaluate(r);let R=M;if(m){const D=r.scope;r.scope=(D||"").split("").slice(1).join(""),R=m.evaluate(r),r.scope=D}return f&&(R=Rc(f,R)),R===void 0||x===void 0&&w===void 0&&E===void 0||(typeof R=="number"?R=Df(R,x,w,E):Array.isArray(R)&&(R=R.map(D=>typeof D=="number"?Df(D,x,w,E):D))),m!==void 0&&R!==void 0&&g&&!g.includes(R)&&(R=M,f&&(R=Rc(f,R))),(f&&f!==this.type||R!==void 0&&fi(R)!==this.type)&&(R=Rc(this.type.kind,R)),R}eachChild(){}outputDefined(){return!1}serialize(){const r=["config",this.key];return this.scope&&r.concat(this.key),r}}function bl(i){if(i instanceof oo&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof gl||i instanceof lu)return!1;let r=!0;return i.eachChild(s=>{r&&!bl(s)&&(r=!1)}),r}function Rp(i){if(i instanceof oo&&i.name==="feature-state")return!1;let r=!0;return i.eachChild(s=>{r&&!Rp(s)&&(r=!1)}),r}function l_(i){if(i instanceof Li)return!1;let r=!0;return i.eachChild(s=>{r&&!l_(s)&&(r=!1)}),r}function Lf(i,r){if(i instanceof oo&&r.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(c=>{s&&!Lf(c,r)&&(s=!1)}),s}class kp{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=r[1];return s.scope.has(c)?new kp(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class zf{constructor(r,s=[],c,f=new Hy,m=[],g,x){this.registry=r,this.path=s,this.key=s.map(w=>`[${w}]`).join(""),this.scope=f,this.errors=m,this.expectedType=c,this._scope=g,this.options=x}parse(r,s,c,f,m={}){return s||c?this.concat(s,c,f)._parse(r,m):this._parse(r,m)}_parse(r,s){function c(f,m,g){return g==="assert"?new Ta(m,[f]):g==="coerce"?new Ea(m,[f]):f}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof r[0]=="string"?this.registry[r[0]]:void 0;if(f){let m=f.parse(r,this);if(!m)return null;if(this.expectedType){const g=this.expectedType,x=m.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||x.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(g,x))return null}else m=c(m,g,s.typeAnnotation||"coerce");else m=c(m,g,s.typeAnnotation||"assert")}if(!(m instanceof Os)&&m.type.kind!=="resolvedImage"&&Ff(m)){const g=new c1(this._scope,this.options);try{m=new Os(m.type,m.evaluate(g))}catch(x){return this.error(x.message),null}}return m}return Ea.parse(["to-array",r],this)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,c){const f=typeof r=="number"?this.path.concat(r):this.path,m=c?this.scope.concat(c):this.scope;return new zf(this.registry,f,s||null,m,this.errors,this._scope,this.options)}error(r,...s){const c=`${this.key}${s.map(f=>`[${f}]`).join("")}`;this.errors.push(new es(c,r))}checkSubtype(r,s){const c=Sf(r,s);return c&&this.error(c),c}}var b1=zf;function Ff(i){if(i instanceof kp)return Ff(i.boundExpression);if(i instanceof oo&&i.name==="error"||i instanceof ml||i instanceof gl||i instanceof lu||i instanceof Li)return!1;const r=i instanceof Ea||i instanceof Ta;let s=!0;return i.eachChild(c=>{s=r?s&&Ff(c):s&&c instanceof Os}),!!s&&bl(i)&&Lf(i,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Dp(i,r){const s=i.length-1;let c,f,m=0,g=s,x=0;for(;m<=g;)if(x=Math.floor((m+g)/2),c=i[x],f=i[x+1],c<=r){if(x===s||r<f)return x;m=x+1}else{if(!(c>r))throw new Si("Input is not a number.");g=x-1}return 0}class Nf{constructor(r,s,c){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[f,m]of c)this.labels.push(f),this.outputs.push(m)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(r[1],1,Bt);if(!c)return null;const f=[];let m=null;s.expectedType&&s.expectedType.kind!=="value"&&(m=s.expectedType);for(let g=1;g<r.length;g+=2){const x=g===1?-1/0:r[g],w=r[g+1],E=g,M=g+1;if(typeof x!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(f.length&&f[f.length-1][0]>=x)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const R=s.parse(w,M,m);if(!R)return null;m=m||R.type,f.push([x,R])}return new Nf(m,c,f)}evaluate(r){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(r);const f=this.input.evaluate(r);if(f<=s[0])return c[0].evaluate(r);const m=s.length;return f>=s[m-1]?c[m-1].evaluate(r):c[Dp(s,f)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r}}const Lp=.95047,w1=1.08883,u_=4/29,uu=6/29,S1=3*uu*uu,c_=uu*uu*uu,zp=Math.PI/180,T1=180/Math.PI;function h_(i){return i>c_?Math.pow(i,1/3):i/S1+u_}function Fp(i){return i>uu?i*i*i:S1*(i-u_)}function f_(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Bf(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function E1(i){const r=Bf(i.r),s=Bf(i.g),c=Bf(i.b),f=h_((.4124564*r+.3575761*s+.1804375*c)/Lp),m=h_((.2126729*r+.7151522*s+.072175*c)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-h_((.0193339*r+.119192*s+.9503041*c)/w1)),alpha:i.a}}function A1(i){let r=(i.l+16)/116,s=isNaN(i.a)?r:r+i.a/500,c=isNaN(i.b)?r:r-i.b/200;return r=1*Fp(r),s=Lp*Fp(s),c=w1*Fp(c),new Xn(f_(3.2404542*s-1.5371385*r-.4985314*c),f_(-.969266*s+1.8760108*r+.041556*c),f_(.0556434*s-.2040259*r+1.0572252*c),i.alpha)}function $A(i,r,s){const c=r-i;return i+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const jf={forward:E1,reverse:A1,interpolate:function(i,r,s){return{l:on(i.l,r.l,s),a:on(i.a,r.a,s),b:on(i.b,r.b,s),alpha:on(i.alpha,r.alpha,s)}}},kc={forward:function(i){const{l:r,a:s,b:c}=E1(i),f=Math.atan2(c,s)*T1;return{h:f<0?f+360:f,c:Math.sqrt(s*s+c*c),l:r,alpha:i.a}},reverse:function(i){const r=i.h*zp,s=i.c;return A1({l:i.l,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:i.alpha})},interpolate:function(i,r,s){return{h:$A(i.h,r.h,s),c:on(i.c,r.c,s),l:on(i.l,r.l,s),alpha:on(i.alpha,r.alpha,s)}}};var C1=Object.freeze({__proto__:null,hcl:kc,lab:jf});class $o{constructor(r,s,c,f,m){this.type=r,this.operator=s,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[g,x]of m)this.labels.push(g),this.outputs.push(x)}static interpolationFactor(r,s,c,f){let m=0;if(r.name==="exponential")m=d_(s,r.base,c,f);else if(r.name==="linear")m=d_(s,1,c,f);else if(r.name==="cubic-bezier"){const g=r.controlPoints;m=new sf(g[0],g[1],g[2],g[3]).solve(d_(s,1,c,f))}return m}static parse(r,s){let[c,f,m,...g]=r;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const E=f[1];if(typeof E!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:E}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const E=f.slice(1);if(E.length!==4||E.some(M=>typeof M!="number"||M<0||M>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:E}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(m=s.parse(m,2,Bt),!m)return null;const x=[];let w=null;c==="interpolate-hcl"||c==="interpolate-lab"?w=mo:s.expectedType&&s.expectedType.kind!=="value"&&(w=s.expectedType);for(let E=0;E<g.length;E+=2){const M=g[E],R=g[E+1],D=E+3,B=E+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(x.length&&x[x.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const $=s.parse(R,B,w);if(!$)return null;w=w||$.type,x.push([M,$])}return w.kind==="number"||w.kind==="color"||w.kind==="array"&&w.itemType.kind==="number"&&typeof w.N=="number"?new $o(w,c,f,m,x):s.error(`Type ${Jr(w)} is not interpolatable.`)}evaluate(r){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(r);const f=this.input.evaluate(r);if(f<=s[0])return c[0].evaluate(r);const m=s.length;if(f>=s[m-1])return c[m-1].evaluate(r);const g=Dp(s,f),x=$o.interpolationFactor(this.interpolation,f,s[g],s[g+1]),w=c[g].evaluate(r),E=c[g+1].evaluate(r);return this.operator==="interpolate"?Ep[this.type.kind.toLowerCase()](w,E,x):this.operator==="interpolate-hcl"?kc.reverse(kc.interpolate(kc.forward(w),kc.forward(E),x)):jf.reverse(jf.interpolate(jf.forward(w),jf.forward(E),x))}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,r,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function d_(i,r,s,c){const f=c-s,m=i-s;return f===0?0:r===1?m/f:(Math.pow(r,m)-1)/(Math.pow(r,f)-1)}class Np{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let c=null;const f=s.expectedType;f&&f.kind!=="value"&&(c=f);const m=[];for(const x of r.slice(1)){const w=s.parse(x,1+m.length,c,void 0,{typeAnnotation:"omit"});if(!w)return null;c=c||w.type,m.push(w)}const g=f&&m.some(x=>Sf(f,x.type));return new Np(g?Hn:c,m)}evaluate(r){let s,c=null,f=0;for(const m of this.args){if(f++,c=m.evaluate(r),c&&c instanceof go&&!c.available&&(s||(s=c),c=null,f===this.args.length))return s;if(c!==null)break}return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class Bp{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let m=1;m<r.length-1;m+=2){const g=r[m];if(typeof g!="string")return s.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return s.error("Variable names must contain only alphanumeric characters or '_'.",m);const x=s.parse(r[m+1],m+1);if(!x)return null;c.push([g,x])}const f=s.parse(r[r.length-1],r.length-1,s.expectedType,c);return f?new Bp(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[s,c]of this.bindings)r.push(s,c.serialize());return r.push(this.result.serialize()),r}}class p_{constructor(r,s,c){this.type=r,this.index=s,this.input=c}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Bt),f=s.parse(r[2],2,Ao(s.expectedType||Hn));return c&&f?new p_(f.type.itemType,c,f):null}evaluate(r){const s=this.index.evaluate(r),c=this.input.evaluate(r);if(s<0)throw new Si(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new Si(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new Si(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class m_{constructor(r,s){this.type=Kn,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Hn),f=s.parse(r[2],2,Hn);return c&&f?qy(c.type,[Kn,Yn,Bt,Ec,Hn])?new m_(c,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Jr(c.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(c==null)return!1;if(!Pc(s,["boolean","string","number","null"]))throw new Si(`Expected first argument to be of type boolean, string, number or null, but found ${Jr(fi(s))} instead.`);if(!Pc(c,["string","array"]))throw new Si(`Expected second argument to be of type array or string, but found ${Jr(fi(c))} instead.`);return c.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class jp{constructor(r,s,c){this.type=Bt,this.needle=r,this.haystack=s,this.fromIndex=c}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Hn),f=s.parse(r[2],2,Hn);if(!c||!f)return null;if(!qy(c.type,[Kn,Yn,Bt,Ec,Hn]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Jr(c.type)} instead`);if(r.length===4){const m=s.parse(r[3],3,Bt);return m?new jp(c,f,m):null}return new jp(c,f)}evaluate(r){const s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!Pc(s,["boolean","string","number","null"]))throw new Si(`Expected first argument to be of type boolean, string, number or null, but found ${Jr(fi(s))} instead.`);if(!Pc(c,["string","array"]))throw new Si(`Expected second argument to be of type array or string, but found ${Jr(fi(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(r);return c.indexOf(s,f)}return c.indexOf(s)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Dc{constructor(r,s,c,f,m,g){this.inputType=r,this.type=s,this.input=c,this.cases=f,this.outputs=m,this.otherwise=g}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let c,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const m={},g=[];for(let E=2;E<r.length-1;E+=2){let M=r[E];const R=r[E+1];Array.isArray(M)||(M=[M]);const D=s.concat(E);if(M.length===0)return D.error("Expected at least one branch label.");for(const $ of M){if(typeof $!="number"&&typeof $!="string")return D.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return D.error("Numeric branch labels must be integer values.");if(c){if(D.checkSubtype(c,fi($)))return null}else c=fi($);if(m[String($)]!==void 0)return D.error("Branch labels must be unique.");m[String($)]=g.length}const B=s.parse(R,E,f);if(!B)return null;f=f||B.type,g.push(B)}const x=s.parse(r[1],1,Hn);if(!x)return null;const w=s.parse(r[r.length-1],r.length-1,f);return w?x.type.kind!=="value"&&s.concat(1).checkSubtype(c,x.type)?null:new Dc(c,f,x,m,g,w):null}evaluate(r){const s=this.input.evaluate(r);return(fi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],f={};for(const g of s){const x=f[this.cases[g]];x===void 0?(f[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[x][1].push(g)}const m=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,x]of c)r.push(x.length===1?m(x[0]):x.map(m)),r.push(this.outputs[g].serialize());return r.push(this.otherwise.serialize()),r}}class g_{constructor(r,s,c){this.type=r,this.branches=s,this.otherwise=c}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const f=[];for(let g=1;g<r.length-1;g+=2){const x=s.parse(r[g],g,Kn);if(!x)return null;const w=s.parse(r[g+1],g+1,c);if(!w)return null;f.push([x,w]),c=c||w.type}const m=s.parse(r[r.length-1],r.length-1,c);return m?new g_(c,f,m):null}evaluate(r){for(const[s,c]of this.branches)if(s.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,c]of this.branches)r(s),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class $p{constructor(r,s,c,f){this.type=r,this.input=s,this.beginIndex=c,this.endIndex=f}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=s.parse(r[1],1,Hn),f=s.parse(r[2],2,Bt);if(!c||!f)return null;if(!qy(c.type,[Ao(Hn),Yn,Hn]))return s.error(`Expected first argument to be of type array or string, but found ${Jr(c.type)} instead`);if(r.length===4){const m=s.parse(r[3],3,Bt);return m?new $p(c.type,c,f,m):null}return new $p(c.type,c,f)}evaluate(r){const s=this.input.evaluate(r),c=this.beginIndex.evaluate(r);if(!Pc(s,["string","array"]))throw new Si(`Expected first argument to be of type array or string, but found ${Jr(fi(s))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(r);return s.slice(c,f)}return s.slice(c)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function $f(i,r){return i==="=="||i==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function P1(i,r,s,c){return c.compare(r,s)===0}function cu(i,r,s){const c=i!=="=="&&i!=="!=";return class bG{constructor(m,g,x){this.type=Kn,this.lhs=m,this.rhs=g,this.collator=x,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const x=m[0];let w=g.parse(m[1],1,Hn);if(!w)return null;if(!$f(x,w.type))return g.concat(1).error(`"${x}" comparisons are not supported for type '${Jr(w.type)}'.`);let E=g.parse(m[2],2,Hn);if(!E)return null;if(!$f(x,E.type))return g.concat(2).error(`"${x}" comparisons are not supported for type '${Jr(E.type)}'.`);if(w.type.kind!==E.type.kind&&w.type.kind!=="value"&&E.type.kind!=="value")return g.error(`Cannot compare types '${Jr(w.type)}' and '${Jr(E.type)}'.`);c&&(w.type.kind==="value"&&E.type.kind!=="value"?w=new Ta(E.type,[w]):w.type.kind!=="value"&&E.type.kind==="value"&&(E=new Ta(w.type,[E])));let M=null;if(m.length===4){if(w.type.kind!=="string"&&E.type.kind!=="string"&&w.type.kind!=="value"&&E.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(M=g.parse(m[3],3,Sa),!M)return null}return new bG(w,E,M)}evaluate(m){const g=this.lhs.evaluate(m),x=this.rhs.evaluate(m);if(c&&this.hasUntypedArgument){const w=fi(g),E=fi(x);if(w.kind!==E.kind||w.kind!=="string"&&w.kind!=="number")throw new Si(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${w.kind}, ${E.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const w=fi(g),E=fi(x);if(w.kind!=="string"||E.kind!=="string")return r(m,g,x)}return this.collator?s(m,g,x,this.collator.evaluate(m)):r(m,g,x)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[i];return this.eachChild(g=>{m.push(g.serialize())}),m}}}const UA=cu("==",function(i,r,s){return r===s},P1),M1=cu("!=",function(i,r,s){return r!==s},function(i,r,s,c){return!P1(0,r,s,c)}),I1=cu("<",function(i,r,s){return r<s},function(i,r,s,c){return c.compare(r,s)<0}),O1=cu(">",function(i,r,s){return r>s},function(i,r,s,c){return c.compare(r,s)>0}),R1=cu("<=",function(i,r,s){return r<=s},function(i,r,s,c){return c.compare(r,s)<=0}),y_=cu(">=",function(i,r,s){return r>=s},function(i,r,s,c){return c.compare(r,s)>=0});class Uf{constructor(r,s,c,f,m,g){this.type=Yn,this.number=r,this.locale=s,this.currency=c,this.unit=f,this.minFractionDigits=m,this.maxFractionDigits=g}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const c=s.parse(r[1],1,Bt);if(!c)return null;const f=r[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let m=null;if(f.locale&&(m=s.parse(f.locale,1,Yn),!m))return null;let g=null;if(f.currency&&(g=s.parse(f.currency,1,Yn),!g))return null;let x=null;if(f.unit&&(x=s.parse(f.unit,1,Yn),!x))return null;let w=null;if(f["min-fraction-digits"]&&(w=s.parse(f["min-fraction-digits"],1,Bt),!w))return null;let E=null;return f["max-fraction-digits"]&&(E=s.parse(f["max-fraction-digits"],1,Bt),!E)?null:new Uf(c,m,g,x,w,E)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class __{constructor(r){this.type=Bt,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=s.parse(r[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Jr(c.type)} instead.`):new __(c):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Si(`Expected value to be of type string or array, but found ${Jr(fi(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(s=>{r.push(s.serialize())}),r}}function k1(i){return function(){i=1831565813+(i|=0)|0;let r=Math.imul(i^i>>>15,1|i);return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296}}const hu={"==":UA,"!=":M1,">":O1,"<":I1,">=":y_,"<=":R1,array:Ta,at:p_,boolean:Ta,case:g_,coalesce:Np,collator:ml,format:Ef,image:Af,in:m_,"index-of":jp,interpolate:$o,"interpolate-hcl":$o,"interpolate-lab":$o,length:__,let:Bp,literal:Os,match:Dc,number:Ta,"number-format":Uf,object:Ta,slice:$p,step:Nf,string:Ta,"to-boolean":Ea,"to-color":Ea,"to-number":Ea,"to-string":Ea,var:kp,within:gl,distance:lu,config:Li};function D1(i,[r,s,c,f]){r=r.evaluate(i),s=s.evaluate(i),c=c.evaluate(i);const m=f?f.evaluate(i):1,g=l1(r,s,c,m);if(g)throw new Si(g);return new Xn(r/255*m,s/255*m,c/255*m,m)}function L1(i,[r,s,c,f]){r=r.evaluate(i),s=s.evaluate(i),c=c.evaluate(i);const m=f?f.evaluate(i):1,g=function(E,M,R,D){return typeof E=="number"&&E>=0&&E<=360?typeof M=="number"&&M>=0&&M<=100&&typeof R=="number"&&R>=0&&R<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[E,M,R,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[E,M,R,D]:[E,M,R]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[E,M,R,D]:[E,M,R]).join(", ")}]: 'h' must be between 0 and 360.`}(r,s,c,m);if(g)throw new Si(g);const x=`hsla(${r}, ${s}%, ${c}%, ${m})`,w=Xn.parse(x);if(!w)throw new Si(`Failed to parse HSLA color: ${x}`);return w}function z1(i,r){return i in r}function v_(i,r){const s=r[i];return s===void 0?null:s}function fu(i){return{type:i}}function F1(i){return{result:"success",value:i}}function du(i){return{result:"error",value:i}}function N1(i,r){return!!i&&!!i.parameters&&i.parameters.indexOf(r)>-1}function Up(i){return i["property-type"]==="data-driven"}function VA(i){return N1(i.expression,"measure-light")}function y(i){return N1(i.expression,"zoom")}function l(i){return!!i.expression&&i.expression.interpolated}function d(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function v(i){return i}function S(i,r){const s=r.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",f=c||!(c||i.property!==void 0),m=i.type||(l(r)?"exponential":"interval");if(s&&((i=Wy({},i)).stops&&(i.stops=i.stops.map(E=>[E[0],Xn.parse(E[1])])),i.default=Xn.parse(i.default?i.default:r.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!C1[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let g,x,w;if(m==="exponential")g=L;else if(m==="interval")g=I;else if(m==="categorical"){g=P,x=Object.create(null);for(const E of i.stops)x[E[0]]=E[1];w=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);g=F}if(c){const E={},M=[];for(let B=0;B<i.stops.length;B++){const $=i.stops[B],q=$[0].zoom;E[q]===void 0&&(E[q]={zoom:q,type:i.type,property:i.property,default:i.default,stops:[]},M.push(q)),E[q].stops.push([$[0].value,$[1]])}const R=[];for(const B of M)R.push([E[B].zoom,S(E[B],r)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:$o.interpolationFactor.bind(void 0,D),zoomStops:R.map(B=>B[0]),evaluate:({zoom:B},$)=>L({stops:R,base:i.base},r,B).evaluate(B,$)}}if(f){const E=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:$o.interpolationFactor.bind(void 0,E),zoomStops:i.stops.map(M=>M[0]),evaluate:({zoom:M})=>g(i,r,M,x,w)}}return{kind:"source",evaluate(E,M){const R=M&&M.properties?M.properties[i.property]:void 0;return R===void 0?T(i.default,r.default):g(i,r,R,x,w)}}}function T(i,r,s){return i!==void 0?i:r!==void 0?r:s!==void 0?s:void 0}function P(i,r,s,c,f){return T(typeof s===f?c[s]:void 0,i.default,r.default)}function I(i,r,s){if(au(s)!=="number")return T(i.default,r.default);const c=i.stops.length;if(c===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[c-1][0])return i.stops[c-1][1];const f=Dp(i.stops.map(m=>m[0]),s);return i.stops[f][1]}function L(i,r,s){const c=i.base!==void 0?i.base:1;if(au(s)!=="number")return T(i.default,r.default);const f=i.stops.length;if(f===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[f-1][0])return i.stops[f-1][1];const m=Dp(i.stops.map(M=>M[0]),s),g=function(M,R,D,B){const $=B-D,q=M-D;return $===0?0:R===1?q/$:(Math.pow(R,q)-1)/(Math.pow(R,$)-1)}(s,c,i.stops[m][0],i.stops[m+1][0]),x=i.stops[m][1],w=i.stops[m+1][1];let E=Ep[r.type]||v;if(i.colorSpace&&i.colorSpace!=="rgb"){const M=C1[i.colorSpace];E=(R,D)=>M.reverse(M.interpolate(M.forward(R),M.forward(D),g))}return typeof x.evaluate=="function"?{evaluate(...M){const R=x.evaluate.apply(void 0,M),D=w.evaluate.apply(void 0,M);if(R!==void 0&&D!==void 0)return E(R,D,g)}}:E(x,w,g)}function F(i,r,s){return r.type==="color"?s=Xn.parse(s):r.type==="formatted"?s=Yi.fromString(s.toString()):r.type==="resolvedImage"?s=go.fromString(s.toString()):au(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0),T(s,i.default,r.default)}oo.register(hu,{error:[{kind:"error"},[Yn],(i,[r])=>{throw new Si(r.evaluate(i))}],typeof:[Yn,[Hn],(i,[r])=>Jr(fi(r.evaluate(i)))],"to-rgba":[Ao(Bt,4),[mo],(i,[r])=>r.evaluate(i).toRenderColor(null).toArray()],rgb:[mo,[Bt,Bt,Bt],D1],rgba:[mo,[Bt,Bt,Bt,Bt],D1],hsl:[mo,[Bt,Bt,Bt],L1],hsla:[mo,[Bt,Bt,Bt,Bt],L1],has:{type:Kn,overloads:[[[Yn],(i,[r])=>z1(r.evaluate(i),i.properties())],[[Yn,Ac],(i,[r,s])=>z1(r.evaluate(i),s.evaluate(i))]]},get:{type:Hn,overloads:[[[Yn],(i,[r])=>v_(r.evaluate(i),i.properties())],[[Yn,Ac],(i,[r,s])=>v_(r.evaluate(i),s.evaluate(i))]]},"feature-state":[Hn,[Yn],(i,[r])=>v_(r.evaluate(i),i.featureState||{})],properties:[Ac,[],i=>i.properties()],"geometry-type":[Yn,[],i=>i.geometryType()],id:[Hn,[],i=>i.id()],zoom:[Bt,[],i=>i.globals.zoom],pitch:[Bt,[],i=>i.globals.pitch||0],"distance-from-center":[Bt,[],i=>i.distanceFromCenter()],"measure-light":[Bt,[Yn],(i,[r])=>i.measureLight(r.evaluate(i))],"heatmap-density":[Bt,[],i=>i.globals.heatmapDensity||0],"line-progress":[Bt,[],i=>i.globals.lineProgress||0],"raster-value":[Bt,[],i=>i.globals.rasterValue||0],"raster-particle-speed":[Bt,[],i=>i.globals.rasterParticleSpeed||0],"sky-radial-progress":[Bt,[],i=>i.globals.skyRadialProgress||0],accumulated:[Hn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Bt,fu(Bt),(i,r)=>{let s=0;for(const c of r)s+=c.evaluate(i);return s}],"*":[Bt,fu(Bt),(i,r)=>{let s=1;for(const c of r)s*=c.evaluate(i);return s}],"-":{type:Bt,overloads:[[[Bt,Bt],(i,[r,s])=>r.evaluate(i)-s.evaluate(i)],[[Bt],(i,[r])=>-r.evaluate(i)]]},"/":[Bt,[Bt,Bt],(i,[r,s])=>r.evaluate(i)/s.evaluate(i)],"%":[Bt,[Bt,Bt],(i,[r,s])=>r.evaluate(i)%s.evaluate(i)],ln2:[Bt,[],()=>Math.LN2],pi:[Bt,[],()=>Math.PI],e:[Bt,[],()=>Math.E],"^":[Bt,[Bt,Bt],(i,[r,s])=>Math.pow(r.evaluate(i),s.evaluate(i))],sqrt:[Bt,[Bt],(i,[r])=>Math.sqrt(r.evaluate(i))],log10:[Bt,[Bt],(i,[r])=>Math.log(r.evaluate(i))/Math.LN10],ln:[Bt,[Bt],(i,[r])=>Math.log(r.evaluate(i))],log2:[Bt,[Bt],(i,[r])=>Math.log(r.evaluate(i))/Math.LN2],sin:[Bt,[Bt],(i,[r])=>Math.sin(r.evaluate(i))],cos:[Bt,[Bt],(i,[r])=>Math.cos(r.evaluate(i))],tan:[Bt,[Bt],(i,[r])=>Math.tan(r.evaluate(i))],asin:[Bt,[Bt],(i,[r])=>Math.asin(r.evaluate(i))],acos:[Bt,[Bt],(i,[r])=>Math.acos(r.evaluate(i))],atan:[Bt,[Bt],(i,[r])=>Math.atan(r.evaluate(i))],min:[Bt,fu(Bt),(i,r)=>Math.min(...r.map(s=>s.evaluate(i)))],max:[Bt,fu(Bt),(i,r)=>Math.max(...r.map(s=>s.evaluate(i)))],abs:[Bt,[Bt],(i,[r])=>Math.abs(r.evaluate(i))],round:[Bt,[Bt],(i,[r])=>{const s=r.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[Bt,[Bt],(i,[r])=>Math.floor(r.evaluate(i))],ceil:[Bt,[Bt],(i,[r])=>Math.ceil(r.evaluate(i))],"filter-==":[Kn,[Yn,Hn],(i,[r,s])=>i.properties()[r.value]===s.value],"filter-id-==":[Kn,[Hn],(i,[r])=>i.id()===r.value],"filter-type-==":[Kn,[Yn],(i,[r])=>i.geometryType()===r.value],"filter-<":[Kn,[Yn,Hn],(i,[r,s])=>{const c=i.properties()[r.value],f=s.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Kn,[Hn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s<c}],"filter->":[Kn,[Yn,Hn],(i,[r,s])=>{const c=i.properties()[r.value],f=s.value;return typeof c==typeof f&&c>f}],"filter-id->":[Kn,[Hn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s>c}],"filter-<=":[Kn,[Yn,Hn],(i,[r,s])=>{const c=i.properties()[r.value],f=s.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Kn,[Hn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s<=c}],"filter->=":[Kn,[Yn,Hn],(i,[r,s])=>{const c=i.properties()[r.value],f=s.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Kn,[Hn],(i,[r])=>{const s=i.id(),c=r.value;return typeof s==typeof c&&s>=c}],"filter-has":[Kn,[Hn],(i,[r])=>r.value in i.properties()],"filter-has-id":[Kn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Kn,[Ao(Yn)],(i,[r])=>r.value.indexOf(i.geometryType())>=0],"filter-id-in":[Kn,[Ao(Hn)],(i,[r])=>r.value.indexOf(i.id())>=0],"filter-in-small":[Kn,[Yn,Ao(Hn)],(i,[r,s])=>s.value.indexOf(i.properties()[r.value])>=0],"filter-in-large":[Kn,[Yn,Ao(Hn)],(i,[r,s])=>function(c,f,m,g){for(;m<=g;){const x=m+g>>1;if(f[x]===c)return!0;f[x]>c?g=x-1:m=x+1}return!1}(i.properties()[r.value],s.value,0,s.value.length-1)],all:{type:Kn,overloads:[[[Kn,Kn],(i,[r,s])=>r.evaluate(i)&&s.evaluate(i)],[fu(Kn),(i,r)=>{for(const s of r)if(!s.evaluate(i))return!1;return!0}]]},any:{type:Kn,overloads:[[[Kn,Kn],(i,[r,s])=>r.evaluate(i)||s.evaluate(i)],[fu(Kn),(i,r)=>{for(const s of r)if(s.evaluate(i))return!0;return!1}]]},"!":[Kn,[Kn],(i,[r])=>!r.evaluate(i)],"is-supported-script":[Kn,[Yn],(i,[r])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(r.evaluate(i))}],upcase:[Yn,[Yn],(i,[r])=>r.evaluate(i).toUpperCase()],downcase:[Yn,[Yn],(i,[r])=>r.evaluate(i).toLowerCase()],concat:[Yn,fu(Hn),(i,r)=>r.map(s=>aa(s.evaluate(i))).join("")],"resolved-locale":[Yn,[Sa],(i,[r])=>r.evaluate(i).resolvedLocale()],random:[Bt,[Bt,Bt,Hn],(i,r)=>{const[s,c,f]=r.map(g=>g.evaluate(i));if(s>c||s===c)return s;let m;if(typeof f=="string")m=function(g){let x=0;if(g.length===0)return x;for(let w=0;w<g.length;w++)x=(x<<5)-x+g.charCodeAt(w),x|=0;return x}(f);else{if(typeof f!="number")throw new Si(`Invalid seed input: ${f}`);m=f}return s+k1(m)()*(c-s)}]});class V{constructor(r,s,c,f){this.expression=r,this._warningHistory={},this._evaluator=new c1(c,f),this._defaultValue=s?function(m){return m.type==="color"&&(d(m.default)||Array.isArray(m.default))?new Xn(0,0,0,0):m.type==="color"?Xn.parse(m.default)||null:m.default===void 0?null:m.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,c,f,m,g,x,w){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(r,s,c,f,m,g,x,w){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=w||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Si(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function Z(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in hu}function Q(i,r,s,c){const f=new b1(hu,[],r?function(g){const x={color:mo,string:Yn,number:Bt,enum:Yn,boolean:Kn,formatted:Cc,resolvedImage:ts};return g.type==="array"?Ao(x[g.value]||Hn,g.length):x[g.type]}(r):void 0,void 0,void 0,s,c),m=f.parse(i,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?F1(new V(m,r,s,c)):du(f.errors)}class J{constructor(r,s,c){this.kind=r,this._styleExpression=s,this.isLightConstant=c,this.isStateDependent=r!=="constant"&&!Rp(s.expression),this.isConfigDependent=!l_(s.expression)}evaluateWithoutErrorHandling(r,s,c,f,m,g){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,f,m,g)}evaluate(r,s,c,f,m,g){return this._styleExpression.evaluate(r,s,c,f,m,g)}}class ie{constructor(r,s,c,f,m){this.kind=r,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!Rp(s.expression),this.isLightConstant=m,this.isConfigDependent=!l_(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(r,s,c,f,m,g){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,f,m,g)}evaluate(r,s,c,f,m,g){return this._styleExpression.evaluate(r,s,c,f,m,g)}interpolationFactor(r,s,c){return this.interpolationType?$o.interpolationFactor(this.interpolationType,r,s,c):0}}function oe(i,r,s,c){if((i=Q(i,r,s,c)).result==="error")return i;const f=i.value.expression,m=bl(f);if(!m&&!Up(r))return du([new es("","data expressions not supported")]);const g=Lf(f,["zoom","pitch","distance-from-center"]);if(!g&&!y(r))return du([new es("","zoom expressions not supported")]);const x=Lf(f,["measure-light"]);if(!x&&!VA(r))return du([new es("","measure-light expression not supported")]);const w=r.expression&&r.expression.relaxZoomRestriction,E=se(f);return E||g||w?E instanceof es?du([E]):E instanceof $o&&!l(r)?du([new es("",'"interpolate" expressions cannot be used with this property')]):F1(E?new ie(m?"camera":"composite",i.value,E.labels,E instanceof $o?E.interpolation:void 0,x):new J(m?"constant":"source",i.value,x)):du([new es("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ae{constructor(r,s){this._parameters=r,this._specification=s,Wy(this,S(this._parameters,this._specification))}static deserialize(r){return new ae(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function se(i){let r=null;if(i instanceof Bp)r=se(i.result);else if(i instanceof Np){for(const s of i.args)if(r=se(s),r)break}else(i instanceof Nf||i instanceof $o)&&i.input instanceof oo&&i.input.name==="zoom"&&(r=i);return r instanceof es||i.eachChild(s=>{const c=se(s);c instanceof es?r=c:r&&c&&r!==c&&(r=new es("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}var me=ye,ge=3;function ye(i,r,s){var c=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var f=new Int32Array(this.arrayBuffer);i=f[0],this.d=(r=f[1])+2*(s=f[2]);for(var m=0;m<this.d*this.d;m++){var g=f[ge+m],x=f[ge+m+1];c.push(g===x?null:f.subarray(g,x))}var w=f[ge+c.length+1];this.keys=f.subarray(f[ge+c.length],w),this.bboxes=f.subarray(w),this.insert=this._insertReadonly}else{this.d=r+2*s;for(var E=0;E<this.d*this.d;E++)c.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=i,this.padding=s,this.scale=r/i,this.uid=0;var M=s/r*i;this.min=-M,this.max=i+M}ye.prototype.insert=function(i,r,s,c,f){this._forEachCell(r,s,c,f,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f)},ye.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ye.prototype._insertCell=function(i,r,s,c,f,m){this.cells[f].push(m)},ye.prototype.query=function(i,r,s,c,f){var m=this.min,g=this.max;if(i<=m&&r<=m&&g<=s&&g<=c&&!f)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(i,r,s,c,this._queryCell,x,{},f),x},ye.prototype._queryCell=function(i,r,s,c,f,m,g,x){var w=this.cells[f];if(w!==null)for(var E=this.keys,M=this.bboxes,R=0;R<w.length;R++){var D=w[R];if(g[D]===void 0){var B=4*D;(x?x(M[B+0],M[B+1],M[B+2],M[B+3]):i<=M[B+2]&&r<=M[B+3]&&s>=M[B+0]&&c>=M[B+1])?(g[D]=!0,m.push(E[D])):g[D]=!1}}},ye.prototype._forEachCell=function(i,r,s,c,f,m,g,x){for(var w=this._convertToCellCoord(i),E=this._convertToCellCoord(r),M=this._convertToCellCoord(s),R=this._convertToCellCoord(c),D=w;D<=M;D++)for(var B=E;B<=R;B++){var $=this.d*B+D;if((!x||x(this._convertFromCellCoord(D),this._convertFromCellCoord(B),this._convertFromCellCoord(D+1),this._convertFromCellCoord(B+1)))&&f.call(this,i,r,s,c,$,m,g,x))return}},ye.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},ye.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},ye.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,r=ge+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var f=new Int32Array(r+s+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=r,g=0;g<i.length;g++){var x=i[g];f[ge+g]=m,f.set(x,m),m+=x.length}return f[ge+i.length]=m,f.set(this.keys,m),f[ge+i.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var Ce=Y(me);const Ae={};function pe(i,r,s={}){Object.defineProperty(i,"_classRegistryKey",{value:r,writable:!1}),Ae[r]={klass:i,omit:s.omit||[]}}pe(Object,"Object"),Ce.serialize=function(i,r){const s=i.toArrayBuffer();return r&&r.add(s),{buffer:s}},Ce.deserialize=function(i){return new Ce(i.buffer)},Object.defineProperty(Ce,"name",{value:"Grid"}),pe(Ce,"Grid"),pe(Xn,"Color"),pe(Error,"Error"),pe(Yi,"Formatted"),pe(ou,"FormattedSection"),pe(Fy,"AJAXError"),pe(go,"ResolvedImage"),pe(ae,"StylePropertyFunction"),pe(V,"StyleExpression",{omit:["_evaluator"]}),pe(ie,"ZoomDependentExpression"),pe(J,"ZoomConstantExpression"),pe(oo,"CompoundExpression",{omit:["_evaluate"]});for(const i in hu)Ae[hu[i]._classRegistryKey]||pe(hu[i],`Expression${i}`);function _e(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function xe(i){return self.ImageBitmap&&i instanceof ImageBitmap}function Re(i,r){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(_e(i)||xe(i))return r&&r.add(i),i;if(ArrayBuffer.isView(i)){const s=i;return r&&r.add(s.buffer),s}if(i instanceof ImageData)return r&&r.add(i.data.buffer),i;if(Array.isArray(i)){const s=[];for(const c of i)s.push(Re(c,r));return s}if(i instanceof Map){const s={$name:"Map"};for(const[c,f]of i.entries())s[c]=Re(f);return s}if(typeof i=="object"){const s=i.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=s.serialize?s.serialize(i,r):{};if(!s.serialize){for(const m in i)i.hasOwnProperty(m)&&(Ae[c].omit.indexOf(m)>=0||(f[m]=Re(i[m],r)));i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof i)}function Ge(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||_e(i)||xe(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Ge);if(typeof i=="object"){const r=i.$name||"Object";if(r==="Map"){const f=new Map;for(const m of Object.keys(i))m!=="$name"&&f.set(m,Ge(i[m]));return f}const{klass:s}=Ae[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(i);const c=Object.create(s.prototype);for(const f of Object.keys(i))f!=="$name"&&(c[f]=Ge(i[f]));return c}throw new Error("can't deserialize object of type "+typeof i)}const Te={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519,"CJK Unified Ideographs Extension B":i=>i>=131072&&i<=173791};function We(i){for(const r of i)if(mt(r.charCodeAt(0)))return!0;return!1}function qe(i){for(const r of i)if(!dt(r.charCodeAt(0)))return!1;return!0}function dt(i){return!(Te.Arabic(i)||Te["Arabic Supplement"](i)||Te["Arabic Extended-A"](i)||Te["Arabic Presentation Forms-A"](i)||Te["Arabic Presentation Forms-B"](i))}function mt(i){return!(i!==746&&i!==747&&(i<4352||!(Te["Bopomofo Extended"](i)||Te.Bopomofo(i)||Te["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Te["CJK Compatibility Ideographs"](i)||Te["CJK Compatibility"](i)||Te["CJK Radicals Supplement"](i)||Te["CJK Strokes"](i)||!(!Te["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Te["CJK Unified Ideographs Extension A"](i)||Te["CJK Unified Ideographs"](i)||Te["Enclosed CJK Letters and Months"](i)||Te["Hangul Compatibility Jamo"](i)||Te["Hangul Jamo Extended-A"](i)||Te["Hangul Jamo Extended-B"](i)||Te["Hangul Jamo"](i)||Te["Hangul Syllables"](i)||Te.Hiragana(i)||Te["Ideographic Description Characters"](i)||Te.Kanbun(i)||Te["Kangxi Radicals"](i)||Te["Katakana Phonetic Extensions"](i)||Te.Katakana(i)&&i!==12540||!(!Te["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Te["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Te["Unified Canadian Aboriginal Syllabics"](i)||Te["Unified Canadian Aboriginal Syllabics Extended"](i)||Te["Vertical Forms"](i)||Te["Yijing Hexagram Symbols"](i)||Te["Yi Syllables"](i)||Te["Yi Radicals"](i))))}function ft(i){return!(mt(i)||function(r){return!!(Te["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Te["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Te["Letterlike Symbols"](r)||Te["Number Forms"](r)||Te["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Te["Control Pictures"](r)&&r!==9251||Te["Optical Character Recognition"](r)||Te["Enclosed Alphanumerics"](r)||Te["Geometric Shapes"](r)||Te["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Te["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Te["CJK Symbols and Punctuation"](r)||Te.Katakana(r)||Te["Private Use Area"](r)||Te["CJK Compatibility Forms"](r)||Te["Small Form Variants"](r)||Te["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(i))}function Be(i){return i>=1424&&i<=2303||Te["Arabic Presentation Forms-A"](i)||Te["Arabic Presentation Forms-B"](i)}function Je(i,r){return!(!r&&Be(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Te.Khmer(i))}function ct(i){for(const r of i)if(Be(r.charCodeAt(0)))return!0;return!1}const Ot="deferred",kt="loading",Nt="loaded";let Dt=null,vt="unavailable",at=null;const $t=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(vt="error"),Dt&&Dt(i)};function vn(){mn.fire(new po("pluginStateChange",{pluginStatus:vt,pluginURL:at}))}const mn=new iu,On=function(){return vt},Nn=function(){if(vt!==Ot||!at)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vt=kt,vn(),at&&nu({url:at},i=>{i?$t(i):(vt=Nt,vn())})},lr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>vt===Nt||lr.applyArabicShaping!=null,isLoading:()=>vt===kt,setState(i){vt=i.pluginStatus,at=i.pluginURL},isParsed:()=>lr.applyArabicShaping!=null&&lr.processBidirectionalText!=null&&lr.processStyledBidirectionalText!=null,getPluginURL:()=>at};class pn{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(r){return function(s,c){for(const f of s)if(!Je(f.charCodeAt(0),c))return!1;return!0}(r,lr.isLoaded())}}class tr{constructor(r,s,c,f){this.property=r,this.value=s,this.expression=function(m,g,x,w){if(d(m))return new ae(m,g);if(Z(m)||Array.isArray(m)&&m.length>0){const E=oe(m,g,x,w);if(E.result==="error")throw new Error(E.value.map(M=>`${M.key}: ${M.message}`).join(", "));return E.value}{let E=m;return typeof m=="string"&&g.type==="color"&&(E=Xn.parse(m)),{kind:"constant",isConfigDependent:!1,evaluate:()=>E}}}(s===void 0?r.specification.default:s,r.specification,c,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,c){return this.property.possiblyEvaluate(this,r,s,c)}}class br{constructor(r,s,c){this.property=r,this.value=new tr(r,void 0,s,c)}transitioned(r,s){return new Dn(this.property,this.value,s,Xi({},r.transition,this.transition),r.now)}untransitioned(){return new Dn(this.property,this.value,null,{},0)}}class or{constructor(r,s,c){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._scope=s,this._options=c,this.isConfigDependent=!1}getValue(r){return Qa(this._values[r].value.value)}setValue(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new br(this._values[r].property,this._scope,this._options)),this._values[r].value=new tr(this._values[r].property,s===null?void 0:Qa(s),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[r].value.expression.isConfigDependent}setTransitionOrValue(r,s){s&&(this._options=s);const c=this._properties.properties;if(r)for(const f in r){const m=r[f];if(cf(f,"-transition")){const g=f.slice(0,-11);c[g]&&this.setTransition(g,m)}else c.hasOwnProperty(f)&&this.setValue(f,m)}}getTransition(r){return Qa(this._values[r].transition)}setTransition(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new br(this._values[r].property)),this._values[r].transition=Qa(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(r[s]=c);const f=this.getTransition(s);f!==void 0&&(r[`${s}-transition`]=f)}return r}transitioned(r,s){const c=new gn(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(r,s._values[f]);return c}untransitioned(){const r=new gn(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class Dn{constructor(r,s,c,f,m){const g=f.delay||0,x=f.duration||0;m=m||0,this.property=r,this.value=s,this.begin=m+g,this.end=this.begin+x,r.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(r,s,c){const f=r.now||0,m=this.value.possiblyEvaluate(r,s,c),g=this.prior;if(g){if(f>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(f<this.begin)return g.possiblyEvaluate(r,s,c);{const x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(r,s,c),m,Ty(x))}}return m}}class gn{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,c){const f=new ur(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].possiblyEvaluate(r,s,c);return f}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Er{constructor(r,s,c){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._scope=s,this._options=c,this.isConfigDependent=!1}getValue(r){return Qa(this._values[r].value)}setValue(r,s){this._values[r]=new tr(this._values[r].property,s===null?void 0:Qa(s),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[r].expression.isConfigDependent}serialize(){const r={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(r[s]=c)}return r}possiblyEvaluate(r,s,c){const f=new ur(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].possiblyEvaluate(r,s,c);return f}}class Pr{constructor(r,s,c){this.property=r,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,c,f){return this.property.evaluate(this.value,this.parameters,r,s,c,f)}}class ur{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class pt{constructor(r){this.specification=r}possiblyEvaluate(r,s){return r.expression.evaluate(s)}interpolate(r,s,c){const f=Ep[this.specification.type];return f?f(r,s,c):r}}class zt{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,c,f){return new Pr(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},c,f)}:r.expression,s)}interpolate(r,s,c){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new Pr(this,{kind:"constant",value:void 0},r.parameters);const f=Ep[this.specification.type];return f?new Pr(this,{kind:"constant",value:f(r.value.value,s.value.value,c)},r.parameters):r}evaluate(r,s,c,f,m,g){return r.kind==="constant"?r.value:r.evaluate(s,c,f,m,g)}}class Nr{constructor(r){this.specification=r}possiblyEvaluate(r,s,c,f){return!!r.expression.evaluate(s,null,{},c,f)}interpolate(){return!1}}class nr{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new pn(0,{});for(const c in r){const f=r[c];f.specification.overridable&&this.overridableProperties.push(c);const m=this.defaultPropertyValues[c]=new tr(f,void 0),g=this.defaultTransitionablePropertyValues[c]=new br(f);this.defaultTransitioningPropertyValues[c]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate(s)}}}pe(zt,"DataDrivenProperty"),pe(pt,"DataConstantProperty"),pe(Nr,"ColorRampProperty");var Ve=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Uo(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function zi(i){if(Array.isArray(i))return i.map(zi);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const r={};for(const s in i)r[s]=zi(i[s]);return r}return Uo(i)}function ao(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const r of i.slice(1))if(!ao(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function Ti(i,r="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ao(i)||(i=rs(i));const s=i;let c=!0;try{c=function(E){if(!Vo(E))return E;let M=zi(E);return Pa(M),M=_o(M),M}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const f=Ve[`filter_${r}`],m=Q(c,f);let g=null;if(m.result==="error")throw new Error(m.value.map(E=>`${E.key}: ${E.message}`).join(", "));g=(E,M,R)=>m.value.evaluate(E,M,{},R);let x=null,w=null;if(c!==s){const E=Q(s,f);if(E.result==="error")throw new Error(E.value.map(M=>`${M.key}: ${M.message}`).join(", "));x=(M,R,D,B,$)=>E.value.evaluate(M,R,{},D,void 0,void 0,B,$),w=!bl(E.value.expression)}return{filter:g,dynamicFilter:x||void 0,needGeometry:ks(c),needFeature:!!w}}function _o(i){if(!Array.isArray(i))return i;const r=function(s){if(wl.has(s[0])){for(let c=1;c<s.length;c++)if(Vo(s[c]))return!0}return s}(i);return r===!0?r:r.map(s=>_o(s))}function Pa(i){let r=!1;const s=[];if(i[0]==="case"){for(let c=1;c<i.length-1;c+=2)r=r||Vo(i[c]),s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="match"){r=r||Vo(i[1]);for(let c=2;c<i.length-1;c+=2)s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="step"){r=r||Vo(i[1]);for(let c=1;c<i.length-1;c+=2)s.push(i[c+1])}r&&(i.length=0,i.push("any",...s));for(let c=1;c<i.length;c++)Pa(i[c])}function Vo(i){if(!Array.isArray(i))return!1;if((r=i[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let s=1;s<i.length;s++)if(Vo(i[s]))return!0;return!1}const wl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Sl(i,r){return i<r?-1:i>r?1:0}function ks(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let r=1;r<i.length;r++)if(ks(i[r]))return!0;return!1}function rs(i){if(!i)return!0;const r=i[0];return i.length<=1?r!=="any":r==="=="?Ds(i[1],i[2],"=="):r==="!="?pu(Ds(i[1],i[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Ds(i[1],i[2],r):r==="any"?(s=i.slice(1),["any"].concat(s.map(rs))):r==="all"?["all"].concat(i.slice(1).map(rs)):r==="none"?["all"].concat(i.slice(1).map(rs).map(pu)):r==="in"?Lc(i[1],i.slice(2)):r==="!in"?pu(Lc(i[1],i.slice(2))):r==="has"?zc(i[1]):r!=="!has"||pu(zc(i[1]));var s}function Ds(i,r,s){switch(i){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,i,r]}}function Lc(i,r){if(r.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",i,["literal",r.sort(Sl)]]:["filter-in-small",i,["literal",r]]}}function zc(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function pu(i){return["!",i]}const Fc="";function Vp(i,r){return r?`${i}${Fc}${r}`:i}const Gp="-transition",x_=new Set(["fill","line","background","hillshade","raster"]);class gi extends iu{constructor(r,s,c,f,m){if(super(),this.id=r.id,this.fqid=Vp(this.id,c),this.type=r.type,this.scope=c,this.lut=f,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&r.type!=="sky"&&r.type!=="slot"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),r.slot&&(this.slot=r.slot),s.layout&&(this._unevaluatedLayout=new Er(s.layout,this.scope,m),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),s.paint)){this._transitionablePaint=new or(s.paint,this.scope,m);for(const g in r.paint)this.setPaintProperty(g,r.paint[g]);for(const g in r.layout)this.setLayoutProperty(g,r.layout[g]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ur(s.paint)}}onAdd(r){}onRemove(r){}isDraped(r){return x_.has(this.type)}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s){if(this.type==="custom"&&r==="visibility")return void(this.visibility=s);const c=this._unevaluatedLayout;c._properties.properties[r]&&(c.setValue(r,s),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,r==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(r){return cf(r,Gp)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s){const c=this._transitionablePaint,f=c._properties.properties;if(cf(r,Gp)){const R=r.slice(0,-11);return f[R]&&c.setTransition(R,s||void 0),!1}if(!f[r])return!1;const m=c._values[r],g=m.value.isDataDriven(),x=m.value;c.setValue(r,s),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,this._handleSpecialPaintPropertyUpdate(r);const w=c._values[r].value,E=w.isDataDriven(),M=cf(r,"pattern")||r==="line-dasharray";return E||g||M||this._handleOverridablePaintPropertyUpdate(r,x,w)}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getDefaultProgramParams(r,s,c){return null}_handleOverridablePaintPropertyUpdate(r,s,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){return eu({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(r,s)=>!(r===void 0||s==="layout"&&!Object.keys(r).length||s==="paint"&&!Object.keys(r).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof Pr&&Up(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Ti(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(r){this._stats&&(r.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(r){}queryIntersectsFeature(r,s,c,f,m,g,x,w,E){}queryIntersectsMatchingFeature(r,s,c,f){}}const b_={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Nc{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.add(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...r){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...r){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function rr(i,r=1){let s=0,c=0;return{members:i.map(f=>{const m=b_[f.type].BYTES_PER_ELEMENT,g=s=SL(s,Math.max(r,m)),x=f.components||1;return c=Math.max(c,m),s+=m*x,{name:f.name,type:f.type,components:x,offset:g}}),size:SL(s,Math.max(c,r)),alignment:r}}function SL(i,r){return Math.ceil(i/r)*r}class Ls extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const f=2*r;return this.int16[f+0]=s,this.int16[f+1]=c,r}}Ls.prototype.bytesPerElement=4,pe(Ls,"StructArrayLayout2i4");class B1 extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const m=3*r;return this.int16[m+0]=s,this.int16[m+1]=c,this.int16[m+2]=f,r}}B1.prototype.bytesPerElement=6,pe(B1,"StructArrayLayout3i6");class Bc extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,f)}emplace(r,s,c,f,m){const g=4*r;return this.int16[g+0]=s,this.int16[g+1]=c,this.int16[g+2]=f,this.int16[g+3]=m,r}}Bc.prototype.bytesPerElement=8,pe(Bc,"StructArrayLayout4i8");class GA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,c,f,m)}emplace(r,s,c,f,m,g){const x=5*r;return this.int16[x+0]=s,this.int16[x+1]=c,this.int16[x+2]=f,this.int16[x+3]=m,this.int16[x+4]=g,r}}GA.prototype.bytesPerElement=10,pe(GA,"StructArrayLayout5i10");class WA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,m,g,x)}emplace(r,s,c,f,m,g,x,w){const E=6*r,M=12*r,R=3*r;return this.int16[E+0]=s,this.int16[E+1]=c,this.uint8[M+4]=f,this.uint8[M+5]=m,this.uint8[M+6]=g,this.uint8[M+7]=x,this.float32[R+2]=w,r}}WA.prototype.bytesPerElement=12,pe(WA,"StructArrayLayout2i4ub1f12");class jc extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,f)}emplace(r,s,c,f,m){const g=4*r;return this.float32[g+0]=s,this.float32[g+1]=c,this.float32[g+2]=f,this.float32[g+3]=m,r}}jc.prototype.bytesPerElement=16,pe(jc,"StructArrayLayout4f16");class $c extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const m=3*r;return this.float32[m+0]=s,this.float32[m+1]=c,this.float32[m+2]=f,r}}$c.prototype.bytesPerElement=12,pe($c,"StructArrayLayout3f12");class Uc extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,c,f,m)}emplace(r,s,c,f,m,g){const x=6*r,w=3*r;return this.uint16[x+0]=s,this.uint16[x+1]=c,this.uint16[x+2]=f,this.uint16[x+3]=m,this.float32[w+2]=g,r}}Uc.prototype.bytesPerElement=12,pe(Uc,"StructArrayLayout4ui1f12");class j1 extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,f)}emplace(r,s,c,f,m){const g=4*r;return this.uint16[g+0]=s,this.uint16[g+1]=c,this.uint16[g+2]=f,this.uint16[g+3]=m,r}}j1.prototype.bytesPerElement=8,pe(j1,"StructArrayLayout4ui8");class $1 extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,c,f,m,g)}emplace(r,s,c,f,m,g,x){const w=6*r;return this.int16[w+0]=s,this.int16[w+1]=c,this.int16[w+2]=f,this.int16[w+3]=m,this.int16[w+4]=g,this.int16[w+5]=x,r}}$1.prototype.bytesPerElement=12,pe($1,"StructArrayLayout6i12");class HA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x,w,E,M,R,D){const B=this.length;return this.resize(B+1),this.emplace(B,r,s,c,f,m,g,x,w,E,M,R,D)}emplace(r,s,c,f,m,g,x,w,E,M,R,D,B){const $=12*r;return this.int16[$+0]=s,this.int16[$+1]=c,this.int16[$+2]=f,this.int16[$+3]=m,this.uint16[$+4]=g,this.uint16[$+5]=x,this.uint16[$+6]=w,this.uint16[$+7]=E,this.int16[$+8]=M,this.int16[$+9]=R,this.int16[$+10]=D,this.int16[$+11]=B,r}}HA.prototype.bytesPerElement=24,pe(HA,"StructArrayLayout4i4ui4i24");class qA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,c,f,m,g)}emplace(r,s,c,f,m,g,x){const w=10*r,E=5*r;return this.int16[w+0]=s,this.int16[w+1]=c,this.int16[w+2]=f,this.float32[E+2]=m,this.float32[E+3]=g,this.float32[E+4]=x,r}}qA.prototype.bytesPerElement=20,pe(qA,"StructArrayLayout3i3f20");class ZA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}ZA.prototype.bytesPerElement=4,pe(ZA,"StructArrayLayout1ul4");class Vf extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}Vf.prototype.bytesPerElement=4,pe(Vf,"StructArrayLayout1f4");class Vc extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const f=2*r;return this.uint16[f+0]=s,this.uint16[f+1]=c,r}}Vc.prototype.bytesPerElement=4,pe(Vc,"StructArrayLayout2ui4");class XA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x,w,E,M,R,D,B){const $=this.length;return this.resize($+1),this.emplace($,r,s,c,f,m,g,x,w,E,M,R,D,B)}emplace(r,s,c,f,m,g,x,w,E,M,R,D,B,$){const q=20*r,X=10*r;return this.int16[q+0]=s,this.int16[q+1]=c,this.int16[q+2]=f,this.int16[q+3]=m,this.int16[q+4]=g,this.float32[X+3]=x,this.float32[X+4]=w,this.float32[X+5]=E,this.float32[X+6]=M,this.int16[q+14]=R,this.uint32[X+8]=D,this.uint16[q+18]=B,this.uint16[q+19]=$,r}}XA.prototype.bytesPerElement=40,pe(XA,"StructArrayLayout5i4f1i1ul2ui40");class U1 extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,m,g,x)}emplace(r,s,c,f,m,g,x,w){const E=8*r;return this.int16[E+0]=s,this.int16[E+1]=c,this.int16[E+2]=f,this.int16[E+4]=m,this.int16[E+5]=g,this.int16[E+6]=x,this.int16[E+7]=w,r}}U1.prototype.bytesPerElement=16,pe(U1,"StructArrayLayout3i2i2i16");class YA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,c,f,m)}emplace(r,s,c,f,m,g){const x=4*r,w=8*r;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=f,this.int16[w+6]=m,this.int16[w+7]=g,r}}YA.prototype.bytesPerElement=16,pe(YA,"StructArrayLayout2f1f2i16");class KA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,f)}emplace(r,s,c,f,m){const g=12*r,x=3*r;return this.uint8[g+0]=s,this.uint8[g+1]=c,this.float32[x+1]=f,this.float32[x+2]=m,r}}KA.prototype.bytesPerElement=12,pe(KA,"StructArrayLayout2ub2f12");class Pi extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,c)}emplace(r,s,c,f){const m=3*r;return this.uint16[m+0]=s,this.uint16[m+1]=c,this.uint16[m+2]=f,r}}Pi.prototype.bytesPerElement=6,pe(Pi,"StructArrayLayout3ui6");class QA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee){const we=this.length;return this.resize(we+1),this.emplace(we,r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee)}emplace(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee,we){const Ie=30*r,ke=15*r,$e=60*r;return this.int16[Ie+0]=s,this.int16[Ie+1]=c,this.int16[Ie+2]=f,this.float32[ke+2]=m,this.float32[ke+3]=g,this.uint16[Ie+8]=x,this.uint16[Ie+9]=w,this.uint32[ke+5]=E,this.uint32[ke+6]=M,this.uint32[ke+7]=R,this.uint16[Ie+16]=D,this.uint16[Ie+17]=B,this.uint16[Ie+18]=$,this.float32[ke+10]=q,this.float32[ke+11]=X,this.uint8[$e+48]=te,this.uint8[$e+49]=ce,this.uint8[$e+50]=he,this.uint32[ke+13]=fe,this.int16[Ie+28]=Ee,this.uint8[$e+58]=we,r}}QA.prototype.bytesPerElement=60,pe(QA,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class JA extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee,we,Ie,ke,$e,nt,He,ut,bt,ot,yt,it,_t,Tt){const xt=this.length;return this.resize(xt+1),this.emplace(xt,r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee,we,Ie,ke,$e,nt,He,ut,bt,ot,yt,it,_t,Tt)}emplace(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te,ce,he,fe,Ee,we,Ie,ke,$e,nt,He,ut,bt,ot,yt,it,_t,Tt,xt){const Ft=22*r,wt=44*r,Ct=88*r;return this.float32[Ft+0]=s,this.float32[Ft+1]=c,this.int16[wt+4]=f,this.int16[wt+5]=m,this.int16[wt+6]=g,this.int16[wt+7]=x,this.int16[wt+8]=w,this.int16[wt+9]=E,this.int16[wt+10]=M,this.int16[wt+11]=R,this.int16[wt+12]=D,this.uint16[wt+13]=B,this.uint16[wt+14]=$,this.uint16[wt+15]=q,this.uint16[wt+16]=X,this.uint16[wt+17]=te,this.uint16[wt+18]=ce,this.uint16[wt+19]=he,this.uint16[wt+20]=fe,this.uint16[wt+21]=Ee,this.uint16[wt+22]=we,this.uint16[wt+23]=Ie,this.uint16[wt+24]=ke,this.uint16[wt+25]=$e,this.uint16[wt+26]=nt,this.uint16[wt+27]=He,this.uint32[Ft+14]=ut,this.float32[Ft+15]=bt,this.float32[Ft+16]=ot,this.float32[Ft+17]=yt,this.float32[Ft+18]=it,this.float32[Ft+19]=_t,this.float32[Ft+20]=Tt,this.uint8[Ct+84]=xt,r}}JA.prototype.bytesPerElement=88,pe(JA,"StructArrayLayout2f9i15ui1ul6f1ub88");class Gf extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,c,f,m)}emplace(r,s,c,f,m,g){const x=5*r;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=f,this.float32[x+3]=m,this.float32[x+4]=g,r}}Gf.prototype.bytesPerElement=20,pe(Gf,"StructArrayLayout5f20");class eC extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,m,g,x)}emplace(r,s,c,f,m,g,x,w){const E=7*r;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=f,this.float32[E+3]=m,this.float32[E+4]=g,this.float32[E+5]=x,this.float32[E+6]=w,r}}eC.prototype.bytesPerElement=28,pe(eC,"StructArrayLayout7f28");class Wp extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const c=this.length;return this.resize(c+1),this.emplace(c,r,s)}emplace(r,s,c){const f=2*r;return this.float32[f+0]=s,this.float32[f+1]=c,r}}Wp.prototype.bytesPerElement=8,pe(Wp,"StructArrayLayout2f8");class tC extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,s,c,f)}emplace(r,s,c,f,m){const g=6*r;return this.uint32[3*r+0]=s,this.uint16[g+2]=c,this.uint16[g+3]=f,this.uint16[g+4]=m,r}}tC.prototype.bytesPerElement=12,pe(tC,"StructArrayLayout1ul3ui12");class w_ extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}w_.prototype.bytesPerElement=2,pe(w_,"StructArrayLayout1ui2");class nC extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X){const te=this.length;return this.resize(te+1),this.emplace(te,r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X)}emplace(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te){const ce=16*r;return this.float32[ce+0]=s,this.float32[ce+1]=c,this.float32[ce+2]=f,this.float32[ce+3]=m,this.float32[ce+4]=g,this.float32[ce+5]=x,this.float32[ce+6]=w,this.float32[ce+7]=E,this.float32[ce+8]=M,this.float32[ce+9]=R,this.float32[ce+10]=D,this.float32[ce+11]=B,this.float32[ce+12]=$,this.float32[ce+13]=q,this.float32[ce+14]=X,this.float32[ce+15]=te,r}}nC.prototype.bytesPerElement=64,pe(nC,"StructArrayLayout16f64");class V1 extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,c,f,m,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,c,f,m,g,x)}emplace(r,s,c,f,m,g,x,w){const E=10*r,M=5*r;return this.uint16[E+0]=s,this.uint16[E+1]=c,this.uint16[E+2]=f,this.uint16[E+3]=m,this.float32[M+2]=g,this.float32[M+3]=x,this.float32[M+4]=w,r}}V1.prototype.bytesPerElement=20,pe(V1,"StructArrayLayout4ui3f20");class rC extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.int16[1*r+0]=s,r}}rC.prototype.bytesPerElement=2,pe(rC,"StructArrayLayout1i2");class iC extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint8[1*r+0]=s,r}}iC.prototype.bytesPerElement=1,pe(iC,"StructArrayLayout1ub1");class TL extends Nc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}TL.prototype.size=40;class oC extends XA{get(r){return new TL(this,r)}}pe(oC,"CollisionBoxArray");class EL extends Nc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}EL.prototype.size=60;class AL extends QA{get(r){return new EL(this,r)}}pe(AL,"PlacedSymbolArray");class CL extends Nc{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(r){this._structArray.uint32[this._pos4+14]=r}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(r){this._structArray.float32[this._pos4+18]=r}get occlusionState(){return this._structArray.float32[this._pos4+19]}set occlusionState(r){this._structArray.float32[this._pos4+19]=r}get occlusionOpacity(){return this._structArray.float32[this._pos4+20]}set occlusionOpacity(r){this._structArray.float32[this._pos4+20]=r}get hasIconTextFit(){return this._structArray.uint8[this._pos1+84]}}CL.prototype.size=88;class PL extends JA{get(r){return new CL(this,r)}}pe(PL,"SymbolInstanceArray");class ML extends Vf{getoffsetX(r){return this.float32[1*r+0]}}pe(ML,"GlyphOffsetArray");class IL extends Ls{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}pe(IL,"SymbolLineVertexArray");class OL extends Nc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}OL.prototype.size=12;class RL extends tC{get(r){return new OL(this,r)}}pe(RL,"FeatureIndexArray");class kL extends Vc{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}pe(kL,"FillExtrusionCentroidArray");const XY=rr([{name:"a_pos",components:2,type:"Int16"}],4),YY=rr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Br{constructor(r=[]){this.segments=r}_prepareSegment(r,s,c,f){let m=this.segments[this.segments.length-1];return r>Br.MAX_VERTEX_ARRAY_LENGTH&&Qr(`Max vertices per segment is ${Br.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!m||m.vertexLength+r>Br.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==f)&&(m={vertexOffset:s,primitiveOffset:c,vertexLength:0,primitiveLength:0},f!==void 0&&(m.sortKey=f),this.segments.push(m)),m}prepareSegment(r,s,c,f){return this._prepareSegment(r,s.length,c.length,f)}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,c,f){return new Br([{vertexOffset:r,primitiveOffset:s,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function DL(i,r){return 256*(i=Pn(Math.floor(i),0,255))+Pn(Math.floor(r),0,255)}Br.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pe(Br,"SegmentVector");const KY=rr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),QY=rr([{name:"a_dash",components:4,type:"Uint16"}]);class S_{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(r,s,c,f){this.ids.push(LL(r)),this.positions.push(s,c,f)}eachPosition(r,s){const c=LL(r);let f=0,m=this.ids.length-1;for(;f<m;){const g=f+m>>1;this.ids[g]>=c?m=g:f=g+1}for(;this.ids[f]===c;)s(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(r,s){const c=new Float64Array(r.ids),f=new Uint32Array(r.positions);return aC(c,f,0,c.length-1),s&&(s.add(c.buffer),s.add(f.buffer)),{ids:c,positions:f}}static deserialize(r){const s=new S_;let c;s.ids=r.ids,s.positions=r.positions;for(const f of s.ids)f!==c&&s.uniqueIds.push(f),c=f;return s.indexed=!0,s}}function LL(i){const r=+i;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:Sc(String(i))}function aC(i,r,s,c){for(;s<c;){const f=i[s+c>>1];let m=s-1,g=c+1;for(;;){do m++;while(i[m]<f);do g--;while(i[g]>f);if(m>=g)break;G1(i,m,g),G1(r,3*m,3*g),G1(r,3*m+1,3*g+1),G1(r,3*m+2,3*g+2)}g-s<c-g?(aC(i,r,s,g),s=g+1):(aC(i,r,g+1,c),c=g)}}function G1(i,r,s){const c=i[r];i[r]=i[s],i[s]=c}pe(S_,"FeaturePositionMap");class mu{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,s),this.initialized=!0),!!this.location}set(r,s,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class W1 extends mu{constructor(r){super(r),this.current=0}set(r,s,c){this.fetchUniformLocation(r,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class Co extends mu{constructor(r){super(r),this.current=0}set(r,s,c){this.fetchUniformLocation(r,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class gu extends mu{constructor(r){super(r),this.current=[0,0]}set(r,s,c){this.fetchUniformLocation(r,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class sC extends mu{constructor(r){super(r),this.current=[0,0,0]}set(r,s,c){this.fetchUniformLocation(r,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class lC extends mu{constructor(r){super(r),this.current=[0,0,0,0]}set(r,s,c){this.fetchUniformLocation(r,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class zL extends mu{constructor(r){super(r),this.current=Xn.transparent.toRenderColor(null)}set(r,s,c){this.fetchUniformLocation(r,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const JY=new Float32Array(16);class T_ extends mu{constructor(r){super(r),this.current=JY}set(r,s,c){if(this.fetchUniformLocation(r,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const eK=new Float32Array(9),tK=new Float32Array(4);class uC extends mu{constructor(r){super(r),this.current=tK}set(r,s,c){if(this.fetchUniformLocation(r,s)){for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function cC(i){return[DL(255*i.r,255*i.g),DL(255*i.b,255*i.a)]}class E_{constructor(r,s,c,f){this.value=r,this.uniformNames=s.map(m=>`u_${m}`),this.type=c,this.context=f}setUniform(r,s,c,f,m){const g=f.constantOr(this.value);s.set(r,m,g instanceof Xn?g.toRenderColor(this.context.lut):g)}getBinding(r,s){return this.type==="color"?new zL(r):new Co(r)}}class Hp{constructor(r,s){this.uniformNames=s.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,s,c,f,m){const g=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;g&&s.set(r,m,g)}getBinding(r,s){return s==="u_pattern"||s==="u_dash"?new lC(r):new Co(r)}}class yu{constructor(r,s,c,f){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(m=>({name:`a_${m}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(r,s,c,f,m,g,x){const w=this.paintVertexArray.length,E=this.expression.evaluate(new pn(0,{brightness:g}),s,{},m,f,x);this.paintVertexArray.resize(r),this._setPaintValue(w,r,E,this.context)}updatePaintArray(r,s,c,f,m,g,x){const w=this.expression.evaluate({zoom:0,brightness:x},c,f,void 0,m);this._setPaintValue(r,s,w,this.context)}_setPaintValue(r,s,c,f){if(this.type==="color"){const m=cC(c.toRenderColor(f.lut));for(let g=r;g<s;g++)this.paintVertexArray.emplace(g,m[0],m[1])}else{for(let m=r;m<s;m++)this.paintVertexArray.emplace(m,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zs{constructor(r,s,c,f,m,g){this.expression=r,this.uniformNames=s.map(x=>`u_${x}_t`),this.type=c,this.useIntegerZoom=f,this.context=m,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(r,s,c,f,m,g,x){const w=this.expression.evaluate(new pn(this.context.zoom,{brightness:g}),s,{},m,f,x),E=this.expression.evaluate(new pn(this.context.zoom+1,{brightness:g}),s,{},m,f,x),M=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(M,r,w,E,this.context)}updatePaintArray(r,s,c,f,m,g,x){const w=this.expression.evaluate({zoom:this.context.zoom,brightness:x},c,f,void 0,m),E=this.expression.evaluate({zoom:this.context.zoom+1,brightness:x},c,f,void 0,m);this._setPaintValue(r,s,w,E,this.context)}_setPaintValue(r,s,c,f,m){if(this.type==="color"){const g=cC(c.toRenderColor(m.lut)),x=cC(c.toRenderColor(m.lut));for(let w=r;w<s;w++)this.paintVertexArray.emplace(w,g[0],g[1],x[0],x[1])}else{for(let g=r;g<s;g++)this.paintVertexArray.emplace(g,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s,c,f,m){const g=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,x=Pn(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);s.set(r,m,x)}getBinding(r,s){return new Co(r)}}class Gc{constructor(r,s,c,f,m){this.expression=r,this.layerId=m,this.paintVertexAttributes=(c==="array"?QY:KY).members;for(let g=0;g<s.length;++g);this.paintVertexArray=new f}populatePaintArray(r,s,c,f){const m=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(m,r,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(r,s,c,f,m,g,x){this._setPaintValues(r,s,c.patterns&&c.patterns[this.layerId],g)}_setPaintValues(r,s,c,f){if(!f||!c)return;const m=f[c];if(!m)return;const{tl:g,br:x,pixelRatio:w}=m;for(let E=r;E<s;E++)this.paintVertexArray.emplace(E,g[0],g[1],x[0],x[1],w)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wf{constructor(r,s,c=()=>!0){this.binders={},this._buffers=[],this.context=s;const f=[];for(const m in r.paint._values){const g=r.paint.get(m);if(!c(m)||!(g instanceof Pr&&Up(g.property.specification)))continue;const x=rK(m,r.type),w=g.value,E=g.property.specification.type,M=!!g.property.useIntegerZoom,R=m==="line-dasharray"||m.endsWith("pattern"),D=m==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant";if(w.kind!=="constant"||D)if(w.kind==="source"||D||R){const B=FL(m,E,"source");this.binders[m]=R?new Gc(w,x,E,B,r.id):new yu(w,x,E,B),f.push(`/a_${m}`)}else{const B=FL(m,E,"composite");this.binders[m]=new zs(w,x,E,M,s,B),f.push(`/z_${m}`)}else this.binders[m]=R?new Hp(w.value,x):new E_(w.value,x,E,s),f.push(`/u_${m}`)}this.cacheKey=f.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof yu||s instanceof zs?s.maxValue:0}populatePaintArrays(r,s,c,f,m,g,x){for(const w in this.binders){const E=this.binders[w];E.context=this.context,(E instanceof yu||E instanceof zs||E instanceof Gc)&&E.populatePaintArray(r,s,c,f,m,g,x)}}setConstantPatternPositions(r){for(const s in this.binders){const c=this.binders[s];c instanceof Hp&&c.setConstantPatternPositions(r)}}updatePaintArrays(r,s,c,f,m,g,x,w){let E=!1;const M=Object.keys(r),R=M.length!==0,D=R?M:s.uniqueIds;this.context.lut=m.lut;for(const B in this.binders){const $=this.binders[B];if($.context=this.context,($ instanceof yu||$ instanceof zs||$ instanceof Gc)&&($.expression.isStateDependent===!0||$.expression.isLightConstant===!1)){const q=m.paint.get(B);$.expression=q.value;for(const X of D){const te=r[X.toString()];s.eachPosition(X,(ce,he,fe)=>{const Ee=f.feature(ce);$.updatePaintArray(he,fe,Ee,te,g,x,w)})}if(!R)for(const X of c.uniqueIds){const te=r[X.toString()];c.eachPosition(X,(ce,he,fe)=>{const Ee=f.feature(ce);$.updatePaintArray(he,fe,Ee,te,g,x,w)})}E=!0}}return E}defines(){const r=[];for(const s in this.binders){const c=this.binders[s];(c instanceof E_||c instanceof Hp)&&r.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof yu||c instanceof zs||c instanceof Gc)for(let f=0;f<c.paintVertexAttributes.length;f++)r.push(c.paintVertexAttributes[f].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof E_||c instanceof Hp||c instanceof zs)for(const f of c.uniformNames)r.push(f)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const s=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof E_||f instanceof Hp||f instanceof zs)for(const m of f.uniformNames)s.push({name:m,property:c,binding:f.getBinding(r,m)})}return s}setUniforms(r,s,c,f,m){for(const{name:g,property:x,binding:w}of c)this.binders[x].setUniform(r,w,m,f.get(x),g)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const s=this.binders[r];(s instanceof yu||s instanceof zs||s instanceof Gc)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(r){for(const s in this.binders){const c=this.binders[s];(c instanceof yu||c instanceof zs||c instanceof Gc)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof yu||s instanceof zs||s instanceof Gc)&&s.destroy()}}}class Wc{constructor(r,s,c=()=>!0){this.programConfigurations={};for(const f of r)this.programConfigurations[f.id]=new Wf(f,s,c);this.needsUpload=!1,this._featureMap=new S_,this._featureMapWithoutIds=new S_,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(r,s,c,f,m,g,x,w){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(r,s,f,m,g,x,w);s.id!==void 0?this._featureMap.add(s.id,c,this._bufferOffset,r):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,r),this._idlessCounter+=1),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,c,f,m,g){for(const x of c)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(r,this._featureMap,this._featureMapWithoutIds,s,x,f,m,g||0)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const nK={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function rK(i,r){return nK[i]||[i.replace(`${r}-`,"").replace(/-/g,"_")]}const iK={"line-pattern":{source:Uc,composite:Uc},"fill-pattern":{source:Uc,composite:Uc},"fill-extrusion-pattern":{source:Uc,composite:Uc},"line-dasharray":{source:j1,composite:j1}},oK={color:{source:Wp,composite:jc},number:{source:Vf,composite:Wp}};function FL(i,r,s){const c=iK[i];return c&&c[s]||oK[r][s]}pe(E_,"ConstantBinder"),pe(Hp,"PatternConstantBinder"),pe(yu,"SourceExpressionBinder"),pe(Gc,"PatternCompositeBinder"),pe(zs,"CompositeExpressionBinder"),pe(Wf,"ProgramConfiguration",{omit:["_buffers"]}),pe(Wc,"ProgramConfigurationSet");const Po=Mt/Math.PI/2,hC=5,NL=6,aK=16383,qp=64,fC=[qp,32,16],is=-Po,os=Po;function Zp(i,r,s,c=Po){return s=Fn(s),[i*Math.sin(s)*c,-r*c,i*Math.cos(s)*c]}function Hf(i,r,s){return Zp(Math.cos(Fn(i)),Math.sin(Fn(i)),r,s)}const Xp=63710088e-1,dC=2*Math.PI*Xp;class qn{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new qn(Jl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,c=this.lat*s,f=r.lat*s,m=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((r.lng-this.lng)*s);return Xp*Math.acos(Math.min(m,1))}toBounds(r=0){const s=360*r/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Hc({lng:this.lng-c,lat:this.lat-s},{lng:this.lng+c,lat:this.lat+s})}toEcef(r){return Hf(this.lat,this.lng,Po+r*Po/Xp)}static convert(r){if(r instanceof qn)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new qn(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new qn(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Hc{constructor(r,s){if(r)if(s)this.setSouthWest(r).setNorthEast(s);else if(r.length===4){const c=r;this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]])}else{const c=r;this.setSouthWest(c[0]).setNorthEast(c[1])}}setNorthEast(r){return this._ne=r instanceof qn?new qn(r.lng,r.lat):qn.convert(r),this}setSouthWest(r){return this._sw=r instanceof qn?new qn(r.lng,r.lat):qn.convert(r),this}extend(r){const s=this._sw,c=this._ne;let f,m;if(r instanceof qn)f=r,m=r;else{if(!(r instanceof Hc))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Hc.convert(r)):this.extend(qn.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(qn.convert(r)):this;if(f=r._sw,m=r._ne,!f||!m)return this}return s||c?(s.lng=Math.min(f.lng,s.lng),s.lat=Math.min(f.lat,s.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new qn(f.lng,f.lat),this._ne=new qn(m.lng,m.lat)),this}getCenter(){return new qn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new qn(this.getWest(),this.getNorth())}getSouthEast(){return new qn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:s,lat:c}=qn.convert(r);let f=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(r){return!r||r instanceof Hc?r:new Hc(r)}}var BL={};(function(i,r){(function(s){function c(m,g,x){var w=f(256*m,256*(g=Math.pow(2,x)-g-1),x),E=f(256*(m+1),256*(g+1),x);return w[0]+","+w[1]+","+E[0]+","+E[1]}function f(m,g,x){var w=2*Math.PI*6378137/256/Math.pow(2,x);return[m*w-2*Math.PI*6378137/2,g*w-2*Math.PI*6378137/2]}s.getURL=function(m,g,x,w,E,M){return M=M||{},m+"?"+["bbox="+c(x,w,E),"format="+(M.format||"image/png"),"service="+(M.service||"WMS"),"version="+(M.version||"1.1.1"),"request="+(M.request||"GetMap"),"srs="+(M.srs||"EPSG:3857"),"width="+(M.width||256),"height="+(M.height||256),"layers="+g].join("&")},s.getTileBBox=c,s.getMercCoords=f,Object.defineProperty(s,"__esModule",{value:!0})})(r)})(0,BL);var sK=BL;class qf{constructor(r,s,c){this.z=r,this.x=s,this.y=c,this.key=A_(0,r,r,s,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s){const c=sK.getTileBBox(this.x,this.y,this.z),f=function(m,g,x){let w,E="";for(let M=m;M>0;M--)w=1<<M-1,E+=(g&w?1:0)+(x&w?2:0);return E}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class jL{constructor(r,s){this.wrap=r,this.canonical=s,this.key=A_(r,s.z,s.z,s.x,s.y)}}class yi{constructor(r,s,c,f,m){this.overscaledZ=r,this.wrap=s,this.canonical=new qf(c,+f,+m),this.key=s===0&&r===c?this.canonical.key:A_(s,r,c,f,m)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const s=this.canonical.z-r;return r>this.canonical.z?new yi(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new yi(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s=!0){if(this.overscaledZ===r&&s)return this.key;if(r>this.canonical.z)return A_(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-r;return A_(this.wrap*+s,r,r,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.z<this.canonical.z&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new yi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new yi(s,this.wrap,s,c,f),new yi(s,this.wrap,s,c+1,f),new yi(s,this.wrap,s,c,f+1),new yi(s,this.wrap,s,c+1,f+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new yi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new yi(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new jL(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function A_(i,r,s,c,f){const m=1<<Math.min(s,22);let g=m*(f%m)+c%m;return i&&s<22&&(g+=m*m*((i<0?-2*i-1:2*i)%(1<<2*(22-s)))),16*(32*g+s)+(r-s)}const lK=[i=>{let r=i.canonical.x-1,s=i.wrap;return r<0&&(r=(1<<i.canonical.z)-1,s--),new yi(i.overscaledZ,s,i.canonical.z,r,i.canonical.y)},i=>{let r=i.canonical.x+1,s=i.wrap;return r===1<<i.canonical.z&&(r=0,s++),new yi(i.overscaledZ,s,i.canonical.z,r,i.canonical.y)},i=>new yi(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,(i.canonical.y===0?1<<i.canonical.z:i.canonical.y)-1),i=>new yi(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y===(1<<i.canonical.z)-1?0:i.canonical.y+1)];pe(qf,"CanonicalTileID"),pe(yi,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const uK=0,cK=25.5;function pC(i){return dC*Math.cos(i*Math.PI/180)}function Tl(i){return(180+i)/360}function El(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Mo(i,r){return i/pC(r)}function Go(i){return 360*i-180}function Fi(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function $L(i,r){return i*pC(Fi(r))}const ei=85.051129;function UL(i){return Math.cos(Fn(Pn(i,-ei,ei)))}function Zf(i,r){const s=Pn(r,uK,cK),c=Math.pow(2,s);return UL(i)*dC/(512*c)}function VL(i){return 1/Math.cos(i*Math.PI/180)}function H1(i,r=0){const s=Math.exp(Math.PI*(1-(i.y+r/Mt)/(1<<i.z)*2));return 80150034*s/(s*s+1)/Mt/(1<<i.z)}class so{constructor(r,s,c=0){this.x=+r,this.y=+s,this.z=+c}static fromLngLat(r,s=0){const c=qn.convert(r);return new so(Tl(c.lng),El(c.lat),Mo(s,c.lat))}toLngLat(){return new qn(Go(this.x),Fi(this.y))}toAltitude(){return $L(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/dC*VL(Fi(this.y))}}function mC(i,r,s,c,f,m,g,x,w){const E=(r+c)/2,M=(s+f)/2,R=new Lt(E,M);x(R),function(D,B,$,q,X,te){const ce=$-X,he=q-te;return Math.abs((q-B)*ce-($-D)*he)/Math.hypot(ce,he)}(R.x,R.y,m.x,m.y,g.x,g.y)>=w?(mC(i,r,s,E,M,m,R,x,w),mC(i,E,M,c,f,R,g,x,w)):i.push(g)}function GL(i,r,s){let c=i[0],f=c.x,m=c.y;r(c);const g=[c];for(let x=1;x<i.length;x++){const w=i[x],{x:E,y:M}=w;r(w),mC(g,f,m,E,M,c,w,r,s),f=E,m=M,c=w}return g}function gC(i,r,s,c){if(c(r,s)){const f=r.add(s)._mult(.5);gC(i,r,f,c),gC(i,f,s,c)}else i.push(s)}function hK(i,r){let s=i[0];const c=[s];for(let f=1;f<i.length;f++){const m=i[f];gC(c,s,m,r),s=m}return c}const yC=Math.pow(2,14)-1,WL=-yC-1;function fK(i,r){const s=Math.round(i.x*r),c=Math.round(i.y*r);return i.x=Pn(s,WL,yC),i.y=Pn(c,WL,yC),(s<i.x||s>i.x+1||c<i.y||c>i.y+1)&&Qr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Fs(i,r,s){const c=i.loadGeometry(),f=i.extent,m=Mt/f;if(r&&s&&s.projection.isReprojectedInTileSpace){const g=1<<r.z,{scale:x,x:w,y:E,projection:M}=s,R=D=>{const B=Go((r.x+D.x/f)/g),$=Fi((r.y+D.y/f)/g),q=M.project(B,$);D.x=(q.x*x-w)*f,D.y=(q.y*x-E)*f};for(let D=0;D<c.length;D++)if(i.type!==1)c[D]=GL(c[D],R,1);else{const B=[];for(const $ of c[D])$.x<0||$.x>=f||$.y<0||$.y>=f||(R($),B.push($));c[D]=B}}for(const g of c)for(const x of g)fK(x,m);return c}function _u(i,r){return{type:i.type,id:i.id,properties:i.properties,geometry:r?Fs(i):[]}}function q1(i,r,s,c,f){i.emplaceBack(2*r+(c+1)/2,2*s+(f+1)/2)}function Z1(i,r,s){i.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class _C{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Ls,this.indexArray=new Pi,this.segments=new Br,this.programConfigurations=new Wc(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(r,s){}populate(r,s,c,f){const m=this.layers[0],g=[];let x=null;m.type==="circle"&&(x=m.layout.get("circle-sort-key"));for(const{feature:E,id:M,index:R,sourceLayerIndex:D}of r){const B=this.layers[0]._featureFilter.needGeometry,$=_u(E,B);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),$,c))continue;const q=x?x.evaluate($,{},c):void 0,X={id:M,properties:E.properties,type:E.type,sourceLayerIndex:D,index:R,geometry:B?$.geometry:Fs(E,c,f),patterns:{},sortKey:q};g.push(X)}x&&g.sort((E,M)=>E.sortKey-M.sortKey);let w=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new $1,w=f.projection);for(const E of g){const{geometry:M,index:R,sourceLayerIndex:D}=E,B=r[R].feature;this.addFeature(E,M,R,s.availableImages,c,w,s.brightness),s.featureIndex.insert(B,M,R,D,this.index)}}update(r,s,c,f,m){const g=Object.keys(r).length!==0;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,s,g?this.stateDependentLayers:this.layers,c,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,XY.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,YY.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,s,c,f,m,g,x){for(const w of s)for(const E of w){const M=E.x,R=E.y;if(M<0||M>=Mt||R<0||R>=Mt)continue;if(g){const $=g.projectTilePoint(M,R,m),q=g.upVector(m,M,R),X=this.globeExtVertexArray;Z1(X,$,q),Z1(X,$,q),Z1(X,$,q),Z1(X,$,q)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),B=D.vertexLength;q1(this.layoutVertexArray,M,R,-1,-1),q1(this.layoutVertexArray,M,R,1,-1),q1(this.layoutVertexArray,M,R,1,1),q1(this.layoutVertexArray,M,R,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+2,B+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},f,m,x)}}function vC(i,r){for(let s=0;s<i.length;s++)if(qc(r,i[s]))return!0;for(let s=0;s<r.length;s++)if(qc(i,r[s]))return!0;return!!xC(i,r)}function dK(i,r,s){return!!qc(i,r)||!!bC(r,i,s)}function HL(i,r){if(i.length===1)return ZL(r,i[0]);for(let s=0;s<r.length;s++){const c=r[s];for(let f=0;f<c.length;f++)if(qc(i,c[f]))return!0}for(let s=0;s<i.length;s++)if(ZL(r,i[s]))return!0;for(let s=0;s<r.length;s++)if(xC(i,r[s]))return!0;return!1}function pK(i,r,s){if(i.length>1){if(xC(i,r))return!0;for(let c=0;c<r.length;c++)if(bC(r[c],i,s))return!0}for(let c=0;c<i.length;c++)if(bC(i[c],r,s))return!0;return!1}function xC(i,r){if(i.length===0||r.length===0)return!1;for(let s=0;s<i.length-1;s++){const c=i[s],f=i[s+1];for(let m=0;m<r.length-1;m++)if(mK(c,f,r[m],r[m+1]))return!0}return!1}function mK(i,r,s,c){return Ja(i,s,c)!==Ja(r,s,c)&&Ja(i,r,s)!==Ja(i,r,c)}function bC(i,r,s){const c=s*s;if(r.length===1)return i.distSqr(r[0])<c;for(let f=1;f<r.length;f++)if(qL(i,r[f-1],r[f])<c)return!0;return!1}function qL(i,r,s){const c=r.distSqr(s);if(c===0)return i.distSqr(r);const f=((i.x-r.x)*(s.x-r.x)+(i.y-r.y)*(s.y-r.y))/c;return i.distSqr(f<0?r:f>1?s:s.sub(r)._mult(f)._add(r))}function ZL(i,r){let s,c,f,m=!1;for(let g=0;g<i.length;g++){s=i[g];for(let x=0,w=s.length-1;x<s.length;w=x++)c=s[x],f=s[w],c.y>r.y!=f.y>r.y&&r.x<(f.x-c.x)*(r.y-c.y)/(f.y-c.y)+c.x&&(m=!m)}return m}function qc(i,r){let s=!1;for(let c=0,f=i.length-1;c<i.length;f=c++){const m=i[c],g=i[f];m.y>r.y!=g.y>r.y&&r.x<(g.x-m.x)*(r.y-m.y)/(g.y-m.y)+m.x&&(s=!s)}return s}function XL(i,r,s,c,f){for(const g of i)if(r<=g.x&&s<=g.y&&c>=g.x&&f>=g.y)return!0;const m=[new Lt(r,s),new Lt(r,f),new Lt(c,f),new Lt(c,s)];if(i.length>2){for(const g of m)if(qc(i,g))return!0}for(let g=0;g<i.length-1;g++)if(gK(i[g],i[g+1],m))return!0;return!1}function gK(i,r,s){const c=s[0],f=s[2];if(i.x<c.x&&r.x<c.x||i.x>f.x&&r.x>f.x||i.y<c.y&&r.y<c.y||i.y>f.y&&r.y>f.y)return!1;const m=Ja(i,r,s[0]);return m!==Ja(i,r,s[1])||m!==Ja(i,r,s[2])||m!==Ja(i,r,s[3])}function Yp(i,r,s,c,f,m){let g=r.y-i.y,x=i.x-r.x;if(m=m||0){const w=g*g+x*x;if(w===0)return!0;const E=Math.sqrt(w);g/=E,x/=E}return!((s.x-i.x)*g+(s.y-i.y)*x-m<0||(c.x-i.x)*g+(c.y-i.y)*x-m<0||(f.x-i.x)*g+(f.y-i.y)*x-m<0)}function wC(i,r,s,c,f,m,g){return!(Yp(i,r,c,f,m,g)||Yp(r,s,c,f,m,g)||Yp(s,i,c,f,m,g)||Yp(c,f,i,r,s,g)||Yp(f,m,i,r,s,g)||Yp(m,c,i,r,s,g))}function Kp(i,r,s){const c=r.paint.get(i).value;return c.kind==="constant"?c.value:s.programConfigurations.get(r.id).getMaxValue(i)}function X1(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function YL(i,r,s,c,f){if(!r[0]&&!r[1])return i;const m=Lt.convert(r)._mult(f);s==="viewport"&&m._rotate(-c);const g=[];for(let x=0;x<i.length;x++)g.push(i[x].sub(m));return g}function KL(i,r,s,c){const f=Lt.convert(i)._mult(c);return r==="viewport"&&f._rotate(-s),f}pe(_C,"CircleBucket",{omit:["layers"]});const yK=new nr({"circle-sort-key":new zt(Ve.layout_circle["circle-sort-key"]),visibility:new pt(Ve.layout_circle.visibility)});var _K={paint:new nr({"circle-radius":new zt(Ve.paint_circle["circle-radius"]),"circle-color":new zt(Ve.paint_circle["circle-color"]),"circle-blur":new zt(Ve.paint_circle["circle-blur"]),"circle-opacity":new zt(Ve.paint_circle["circle-opacity"]),"circle-translate":new pt(Ve.paint_circle["circle-translate"]),"circle-translate-anchor":new pt(Ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pt(Ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pt(Ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zt(Ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zt(Ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zt(Ve.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new pt(Ve.paint_circle["circle-emissive-strength"])}),layout:yK};class SC{constructor(r,s){this.pos=r,this.dir=s}intersectsPlane(r,s,c){const f=a._.dot(s,this.dir);if(Math.abs(f)<1e-6)return!1;const m=((r[0]-this.pos[0])*s[0]+(r[1]-this.pos[1])*s[1]+(r[2]-this.pos[2])*s[2])/f;return c[0]=this.pos[0]+this.dir[0]*m,c[1]=this.pos[1]+this.dir[1]*m,c[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(r,s,c){if(a._.equals(this.pos,r)||s===0)return c[0]=c[1]=c[2]=0,!1;const[f,m,g]=this.dir,x=this.pos[0]-r[0],w=this.pos[1]-r[1],E=this.pos[2]-r[2],M=f*f+m*m+g*g,R=2*(x*f+w*m+E*g),D=R*R-4*M*(x*x+w*w+E*E-s*s);if(D<0){const B=Math.max(-R/2,0),$=x+f*B,q=w+m*B,X=E+g*B,te=Math.hypot($,q,X);return c[0]=$*s/te,c[1]=q*s/te,c[2]=X*s/te,!1}{const B=(-R-Math.sqrt(D))/(2*M);if(B<0){const $=Math.hypot(x,w,E);return c[0]=x*s/$,c[1]=w*s/$,c[2]=E*s/$,!1}return c[0]=x+f*B,c[1]=w+m*B,c[2]=E+g*B,!0}}}class TC{constructor(r,s,c,f,m){this.TL=r,this.TR=s,this.BR=c,this.BL=f,this.horizon=m}static fromInvProjectionMatrix(r,s,c){const f=[-1,1,1],m=[1,1,1],g=[1,-1,1],x=[-1,-1,1],w=a._.transformMat4(f,f,r),E=a._.transformMat4(m,m,r),M=a._.transformMat4(g,g,r),R=a._.transformMat4(x,x,r);return new TC(w,E,M,R,s/c)}}function C_(i,r,s){let c=1/0,f=-1/0;const m=[];for(const g of i){a._.sub(m,g,r);const x=a._.dot(m,s);c=Math.min(c,x),f=Math.max(f,x)}return[c,f]}function QL(i,r){let s=!0;for(let c=0;c<i.planes.length;c++){const f=i.planes[c];let m=0;for(let g=0;g<r.length;g++)m+=a._.dot(f,r[g])+f[3]>=0;if(m===0)return 0;m!==r.length&&(s=!1)}return s?2:1}function JL(i,r){for(const s of i.projections){const c=C_(r,i.points[0],s.axis);if(s.projection[1]<c[0]||s.projection[0]>c[1])return 0}return 1}function ez(i,r){let s=0;const c=[0,0,0,0];for(let f=0;f<i.length;f++)c[0]=i[f][0],c[1]=i[f][1],c[2]=i[f][2],c[3]=1,a.aA.dot(c,r)>=0&&s++;return s}class EC{constructor(r,s){this.points=r||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=jr.fromPoints(this.points),this.projections=[],this.frustumEdges=[a._.sub([],this.points[2],this.points[3]),a._.sub([],this.points[0],this.points[3]),a._.sub([],this.points[4],this.points[0]),a._.sub([],this.points[5],this.points[1]),a._.sub([],this.points[6],this.points[2]),a._.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const f=[0,-c[2],c[1]],m=[c[2],0,-c[0]];this.projections.push({axis:f,projection:C_(this.points,this.points[0],f)}),this.projections.push({axis:m,projection:C_(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(r,s,c,f){const m=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const M=a.aA.transformMat4([],E,r),R=1/M[3]/s*m;return a.aA.mul(M,M,[R,R,f?1/M[3]:R,R])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const M=a._.sub([],g[E[0]],g[E[1]]),R=a._.sub([],g[E[2]],g[E[1]]),D=a._.normalize([],a._.cross([],M,R)),B=-a._.dot(D,g[E[1]]);return D.concat(B)}),w=[];for(let E=0;E<g.length;E++)w.push([g[E][0],g[E][1],g[E][2]]);return new EC(w,x)}intersectsPrecise(r,s,c){for(let f=0;f<s.length;f++)if(!ez(r,s[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!ez(r,this.planes[f]))return 0;for(const f of c)for(const m of this.frustumEdges){const g=a._.cross([],f,m),x=a._.length(g);if(x===0)continue;a._.scale(g,g,1/x);const w=C_(this.points,this.points[0],g),E=C_(r,this.points[0],g);if(w[0]>E[1]||E[0]>w[1])return 0}return 1}}class jr{static fromPoints(r){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of r)a._.min(s,s,f),a._.max(c,c,f);return new jr(s,c)}static fromTileIdAndHeight(r,s,c){const f=1<<r.canonical.z,m=r.canonical.x,g=r.canonical.y;return new jr([m/f,g/f,s],[(m+1)/f,(g+1)/f,c])}static applyTransform(r,s){const c=r.getCorners();for(let f=0;f<c.length;++f)a._.transformMat4(c[f],c[f],s);return jr.fromPoints(c)}static projectAabbCorners(r,s){const c=r.getCorners();for(let f=0;f<c.length;++f)a._.transformMat4(c[f],c[f],s);return c}constructor(r,s){this.min=r,this.max=s,this.center=a._.scale([],a._.add([],this.min,this.max),.5)}quadrant(r){const s=[r%2==0,r<2],c=a._.clone(this.min),f=a._.clone(this.max);for(let m=0;m<s.length;m++)c[m]=s[m]?this.min[m]:this.center[m],f[m]=s[m]?this.center[m]:this.max[m];return f[2]=this.max[2],new jr(c,f)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,s=this.max;return[[r[0],r[1],r[2]],[s[0],r[1],r[2]],[s[0],s[1],r[2]],[r[0],s[1],r[2]],[r[0],r[1],s[2]],[s[0],r[1],s[2]],[s[0],s[1],s[2]],[r[0],s[1],s[2]]]}intersects(r){return this.intersectsAabb(r.bounds)?QL(r,this.getCorners()):0}intersectsFlat(r){return this.intersectsAabb(r.bounds)?QL(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(r,s){return s||this.intersects(r)?JL(r,this.getCorners()):0}intersectsPreciseFlat(r,s){return s||this.intersectsFlat(r)?JL(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(r){for(let s=0;s<3;++s)if(this.min[s]>r.max[s]||r.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(r){return!(this.min[0]>r.max[0]||r.min[0]>this.max[0]||this.min[1]>r.max[1]||r.min[1]>this.max[1])}encapsulate(r){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],r.min[s]),this.max[s]=Math.max(this.max[s],r.max[s])}encapsulatePoint(r){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],r[s]),this.max[s]=Math.max(this.max[s],r[s])}closestPoint(r){return[Math.max(Math.min(this.max[0],r[0]),this.min[0]),Math.max(Math.min(this.max[1],r[1]),this.min[1]),Math.max(Math.min(this.max[2],r[2]),this.min[2])]}}pe(jr,"Aabb");const vK=rr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Y1}=vK,tz=rr([{name:"a_pos_3",components:3,type:"Int16"}]);var P_=rr([{name:"a_pos",type:"Int16",components:2}]);function K1(i){return i*Po/Xp}const xK=[new jr([is,is,is],[os,os,os]),new jr([is,is,is],[0,0,os]),new jr([0,is,is],[os,0,os]),new jr([is,0,is],[0,os,os]),new jr([0,0,is],[os,os,os])];function nz(i,r,s,c=!0){const f=a._.scale([],i._camera.position,i.worldSize),m=[r,s,1,1];a.aA.transformMat4(m,m,i.pixelMatrixInverse),a.aA.scale(m,m,1/m[3]);const g=a._.sub([],m,f),x=a._.normalize([],g),w=i.globeMatrix,E=[w[12],w[13],w[14]],M=a._.sub([],E,f),R=a._.length(M),D=a._.normalize([],M),B=i.worldSize/(2*Math.PI),$=a._.dot(D,x),q=Math.asin(B/R);if(q<Math.acos($)){if(!c)return null;const He=[],ut=[];a._.scale(He,x,R/$),a._.normalize(ut,a._.sub(ut,He,M)),a._.normalize(x,a._.add(x,M,a._.scale(x,ut,Math.tan(q)*R)))}const X=[];new SC(f,x).closestPointOnSphere(E,B,X);const te=a._.normalize([],df(w,0)),ce=a._.normalize([],df(w,1)),he=a._.normalize([],df(w,2)),fe=a._.dot(te,X),Ee=a._.dot(ce,X),we=a._.dot(he,X),Ie=Zi(Math.asin(-Ee/B));let ke=Zi(Math.atan2(fe,we));ke=i.center.lng+function(He,ut){const bt=(ut-He+180)%360-180;return bt<-180?bt+360:bt}(i.center.lng,ke);const $e=Tl(ke),nt=Pn(El(Ie),0,1);return new so($e,nt)}class bK{constructor(r,s,c){this.a=a._.sub([],r,c),this.b=a._.sub([],s,c),this.center=c;const f=a._.normalize([],this.a),m=a._.normalize([],this.b);this.angle=Math.acos(a._.dot(f,m))}}function AC(i,r){if(i.angle===0)return null;let s;return s=i.a[r]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[r]/i.a[r]/Math.sin(i.angle)-1/Math.tan(i.angle)),s<0||s>1?null:function(c,f,m,g){const x=Math.sin(m);return c*(Math.sin((1-g)*m)/x)+f*(Math.sin(g*m)/x)}(i.a[r],i.b[r],i.angle,Pn(s,0,1))+i.center[r]}function Al(i){if(i.z<=1)return xK[i.z+2*i.y+i.x];const r=CC(Q1(i));return jr.fromPoints(r)}function vu(i,r,s){return a._.scale(i,i,1-s),a._.scaleAndAdd(i,i,r,s)}function rz(i,r){const s=xu(r.zoom);if(s===0)return Al(i);const c=Q1(i),f=CC(c),m=Tl(c.getWest())*r.worldSize,g=Tl(c.getEast())*r.worldSize,x=El(c.getNorth())*r.worldSize,w=El(c.getSouth())*r.worldSize,E=[m,x,0],M=[g,x,0],R=[m,w,0],D=[g,w,0],B=a.ad.invert([],r.globeMatrix);return a._.transformMat4(E,E,B),a._.transformMat4(M,M,B),a._.transformMat4(R,R,B),a._.transformMat4(D,D,B),f[0]=vu(f[0],R,s),f[1]=vu(f[1],D,s),f[2]=vu(f[2],M,s),f[3]=vu(f[3],E,s),jr.fromPoints(f)}function iz(i,r,s){for(const c of i)a._.transformMat4(c,c,r),a._.scale(c,c,s)}function oz(i,r,s,c){const f=r/i.worldSize,m=i.globeMatrix;if(s.z<=1){const $e=Al(s).getCorners();return iz($e,m,f),jr.fromPoints($e)}const g=Q1(s,c),x=CC(g,Po+K1(i._tileCoverLift));iz(x,m,f);const w=Number.MAX_VALUE,E=[-w,-w,-w],M=[w,w,w];if(g.contains(i.center)){for(const He of x)a._.min(M,M,He),a._.max(E,E,He);E[2]=0;const $e=i.point,nt=[$e.x*f,$e.y*f,0];return a._.min(M,M,nt),a._.max(E,E,nt),new jr(M,E)}if(i._tileCoverLift>0){for(const $e of x)a._.min(M,M,$e),a._.max(E,E,$e);return new jr(M,E)}const R=[m[12]*f,m[13]*f,m[14]*f],D=g.getCenter(),B=Pn(i.center.lat,-ei,ei),$=Pn(D.lat,-ei,ei),q=Tl(i.center.lng),X=El(B);let te=q-Tl(D.lng);const ce=X-El($);te>.5?te-=1:te<-.5&&(te+=1);let he=0;if(Math.abs(te)>Math.abs(ce))he=te>=0?1:3;else{he=ce>=0?0:2;const $e=[m[4]*f,m[5]*f,m[6]*f],nt=-Math.sin(Fn(ce>=0?g.getSouth():g.getNorth()))*Po;a._.scaleAndAdd(R,R,$e,nt)}const fe=x[he],Ee=x[(he+1)%4],we=new bK(fe,Ee,R),Ie=[AC(we,0)||fe[0],AC(we,1)||fe[1],AC(we,2)||fe[2]],ke=xu(i.zoom);if(ke>0){const $e=function({x:He,y:ut,z:bt},ot,yt,it,_t){const Tt=1/(1<<bt);let xt=He*Tt,Ft=xt+Tt,wt=ut*Tt,Ct=wt+Tt,Jt=0;const Kt=(xt+Ft)/2-it;return Kt>.5?Jt=-1:Kt<-.5&&(Jt=1),xt=((xt+Jt)*ot-(it*=ot))*yt+it,Ft=((Ft+Jt)*ot-it)*yt+it,wt=(wt*ot-(_t*=ot))*yt+_t,Ct=(Ct*ot-_t)*yt+_t,[[xt,Ct,0],[Ft,Ct,0],[Ft,wt,0],[xt,wt,0]]}(s,r,i._pixelsPerMercatorPixel,q,X);for(let He=0;He<x.length;He++)vu(x[He],$e[He],ke);const nt=a._.add([],$e[he],$e[(he+1)%4]);a._.scale(nt,nt,.5),vu(Ie,nt,ke)}for(const $e of x)a._.min(M,M,$e),a._.max(E,E,$e);return M[2]=Math.min(fe[2],Ee[2]),a._.min(M,M,Ie),a._.max(E,E,Ie),new jr(M,E)}function Q1({x:i,y:r,z:s},c=!1){const f=1/(1<<s),m=new qn(Go(i*f),r===(1<<s)-1&&c?-90:Fi((r+1)*f)),g=new qn(Go((i+1)*f),r===0&&c?90:Fi(r*f));return new Hc(m,g)}function CC(i,r=Po){const s=Fn(i.getNorth()),c=Fn(i.getSouth()),f=Math.cos(s),m=Math.cos(c),g=Math.sin(s),x=Math.sin(c),w=i.getWest(),E=i.getEast();return[Zp(m,x,w,r),Zp(m,x,E,r),Zp(f,g,E,r),Zp(f,g,w,r)]}function M_(i,r,s,c){const f=1<<s.z,m=(i/Mt+s.x)/f;return Hf(Fi((r/Mt+s.y)/f),Go(m),c)}function J1({min:i,max:r}){return aK/Math.max(r[0]-i[0],r[1]-i[1],r[2]-i[2])}const az=new Float64Array(16);function I_(i){const r=J1(i),s=a.ad.fromScaling(az,[r,r,r]);return a.ad.translate(s,s,a._.negate([],i.min))}function PC(i){const r=a.ad.fromTranslation(az,i.min),s=1/J1(i);return a.ad.scale(r,r,[s,s,s])}function MC(i){const r=Mt/(2*Math.PI);return i/(2*Math.PI)/r}function sz(i,r){return Mt/(512*Math.pow(2,i))*J1(Al(r))}function lz(i,r,s,c,f){const m=MC(s),g=[i,r,-s/(2*Math.PI)],x=a.ad.identity(new Float64Array(16));return a.ad.translate(x,x,g),a.ad.scale(x,x,[m,m,m]),a.ad.rotateX(x,x,Fn(-f)),a.ad.rotateY(x,x,Fn(-c)),x}function xu(i){return Ql(hC,NL,i)}function uz(i,r){const s=Hf(r.lat,r.lng),c=function(m){const g=Hf(m._center.lat,m._center.lng),x=a._.fromValues(0,1,0);let w=a._.cross([],x,g);const E=a.ad.fromRotation([],-m.angle,g);w=a._.transformMat4(w,w,E),a.ad.fromRotation(E,-m._pitch,w);const M=a._.normalize([],g);return a._.scale(M,M,K1(m.cameraToCenterDistance/m.pixelsPerMeter)),a._.transformMat4(M,M,E),a._.add([],g,M)}(i),f=a._.subtract([],c,s);return a._.angle(f,s)}function IC(i,r){return uz(i,r)>Math.PI/2*1.01}const cz=Fn(85),wK=Math.cos(cz),SK=Math.sin(cz),TK=a.ad.create(),hz=i=>{const r=[];return i.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),i.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r};function fz(i,r,s,c,f,m,g,x,w){if(m&&i.queryGeometry.isAboveHorizon)return!1;m&&(w*=i.pixelToTileUnitsFactor);const E=i.tileID.canonical,M=s.projection.upVectorScale(E,s.center.lat,s.worldSize).metersToTile;for(const R of r)for(const D of R){const B=D.add(x),$=f&&s.elevation?s.elevation.exaggeration()*f.getElevationAt(B.x,B.y,!0):0,q=s.projection.projectTilePoint(B.x,B.y,E);if($>0){const he=s.projection.upVector(E,B.x,B.y);q.x+=he[0]*M*$,q.y+=he[1]*M*$,q.z+=he[2]*M*$}const X=m?B:EK(q.x,q.y,q.z,c),te=m?i.tilespaceRays.map(he=>CK(he,$)):i.queryGeometry.screenGeometry,ce=a.aA.transformMat4([],[q.x,q.y,q.z,1],c);if(!g&&m?w*=ce[3]/s.cameraToCenterDistance:g&&!m&&(w*=s.cameraToCenterDistance/ce[3]),m){const he=Fi((D.y/Mt+E.y)/(1<<E.z));w/=s.projection.pixelsPerMeter(he,1)/Mo(1,he)}if(dK(te,X,w))return!0}return!1}function EK(i,r,s,c){const f=a.aA.transformMat4([],[i,r,s,1],c);return new Lt(f[0]/f[3],f[1]/f[3])}const dz=a._.fromValues(0,0,0),AK=a._.fromValues(0,0,1);function CK(i,r){const s=a._.create();return dz[2]=r,i.intersectsPlane(dz,AK,s),new Lt(s[0],s[1])}class pz extends _C{}function mz(i,{width:r,height:s},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==r*s*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(r*s*c);return i.width=r,i.height=s,i.data=f,i}function gz(i,r,s){const{width:c,height:f}=r;c===i.width&&f===i.height||(OC(i,r,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,c),height:Math.min(i.height,f)},s,null),i.width=c,i.height=f,i.data=r.data)}function OC(i,r,s,c,f,m,g,x){if(f.width===0||f.height===0)return r;if(f.width>i.width||f.height>i.height||s.x>i.width-f.width||s.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>r.width||f.height>r.height||c.x>r.width-f.width||c.y>r.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const w=i.data,E=r.data,M=m===4&&x;for(let R=0;R<f.height;R++){const D=((s.y+R)*i.width+s.x)*m,B=((c.y+R)*r.width+c.x)*m;if(M)for(let $=0;$<f.width;$++){const q=D+$*m+3,X=B+$*m;E[X+0]=255,E[X+1]=255,E[X+2]=255,E[X+3]=w[q]}else if(g)for(let $=0;$<f.width;$++){const q=D+$*m,X=B+$*m,te=w[q+3],ce=new Xn(w[q+0]/255*te,w[q+1]/255*te,w[q+2]/255*te,te).toRenderColor(g).toArray();E[X+0]=ce[0],E[X+1]=ce[1],E[X+2]=ce[2],E[X+3]=ce[3]}else for(let $=0;$<f.width*m;$++)E[B+$]=w[D+$]}return r}pe(pz,"HeatmapBucket",{omit:["layers"]});class Zc{constructor(r,s){mz(this,r,1,s)}resize(r){gz(this,new Zc(r),1)}clone(){return new Zc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,c,f,m){OC(r,s,c,f,m,1,null)}}class Ma{constructor(r,s){mz(this,r,4,s)}resize(r){gz(this,new Ma(r),4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Ma({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,c,f,m,g,x){OC(r,s,c,f,m,4,g,x)}}class yz{constructor(r,s){this.width=r.width,this.height=r.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}pe(Zc,"AlphaImage"),pe(Ma,"RGBAImage");const PK=new nr({visibility:new pt(Ve.layout_heatmap.visibility)});var MK={paint:new nr({"heatmap-radius":new zt(Ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zt(Ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pt(Ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nr(Ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pt(Ve.paint_heatmap["heatmap-opacity"])}),layout:PK};function O_(i){const r={},s=i.resolution||256,c=i.clips?i.clips.length:1,f=i.image||new Ma({width:s,height:c}),m=(g,x,w)=>{r[i.evaluationKey]=w;const E=i.expression.evaluate(r);E&&(f.data[g+x+0]=Math.floor(255*E.r/E.a),f.data[g+x+1]=Math.floor(255*E.g/E.a),f.data[g+x+2]=Math.floor(255*E.b/E.a),f.data[g+x+3]=Math.floor(255*E.a))};if(i.clips)for(let g=0,x=0;g<c;++g,x+=4*s)for(let w=0,E=0;w<s;w++,E+=4){const M=w/(s-1),{start:R,end:D}=i.clips[g];m(x,E,R*(1-M)+D*M)}else for(let g=0,x=0;g<s;g++,x+=4)m(0,x,g/(s-1));return f}const IK=new nr({visibility:new pt(Ve.layout_hillshade.visibility)});var OK={paint:new nr({"hillshade-illumination-direction":new pt(Ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pt(Ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pt(Ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pt(Ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pt(Ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pt(Ve.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new pt(Ve.paint_hillshade["hillshade-emissive-strength"])}),layout:IK};const RK=rr([{name:"a_pos",components:2,type:"Int16"}],4),{members:kK}=RK;function R_(i,r,s=2){const c=r&&r.length,f=c?r[0]*s:i.length;let m=_z(i,0,f,s,!0);const g=[];if(!m||m.next===m.prev)return g;let x,w,E;if(c&&(m=function(M,R,D,B){const $=[];for(let q=0,X=R.length;q<X;q++){const te=_z(M,R[q]*B,q<X-1?R[q+1]*B:M.length,B,!1);te===te.next&&(te.steiner=!0),$.push($K(te))}$.sort(NK);for(let q=0;q<$.length;q++)D=BK($[q],D);return D}(i,r,m,s)),i.length>80*s){x=1/0,w=1/0;let M=-1/0,R=-1/0;for(let D=s;D<f;D+=s){const B=i[D],$=i[D+1];B<x&&(x=B),$<w&&(w=$),B>M&&(M=B),$>R&&(R=$)}E=Math.max(M-x,R-w),E=E!==0?32767/E:0}return k_(m,g,s,x,w,E,0),g}function _z(i,r,s,c,f){let m;if(f===function(g,x,w,E){let M=0;for(let R=x,D=w-E;R<w;R+=E)M+=(g[D]-g[R])*(g[R+1]+g[D+1]),D=R;return M}(i,r,s,c)>0)for(let g=r;g<s;g+=c)m=bz(g/c|0,i[g],i[g+1],m);else for(let g=s-c;g>=r;g-=c)m=bz(g/c|0,i[g],i[g+1],m);return m&&eb(m,m.next)&&(L_(m),m=m.next),m}function Xf(i,r){if(!i)return i;r||(r=i);let s,c=i;do if(s=!1,c.steiner||!eb(c,c.next)&&_i(c.prev,c,c.next)!==0)c=c.next;else{if(L_(c),c=r=c.prev,c===c.next)break;s=!0}while(s||c!==r);return r}function k_(i,r,s,c,f,m,g){if(!i)return;!g&&m&&function(w,E,M,R){let D=w;do D.z===0&&(D.z=RC(D.x,D.y,E,M,R)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==w);D.prevZ.nextZ=null,D.prevZ=null,function(B){let $,q=1;do{let X,te=B;B=null;let ce=null;for($=0;te;){$++;let he=te,fe=0;for(let we=0;we<q&&(fe++,he=he.nextZ,he);we++);let Ee=q;for(;fe>0||Ee>0&&he;)fe!==0&&(Ee===0||!he||te.z<=he.z)?(X=te,te=te.nextZ,fe--):(X=he,he=he.nextZ,Ee--),ce?ce.nextZ=X:B=X,X.prevZ=ce,ce=X;te=he}ce.nextZ=null,q*=2}while($>1)}(D)}(i,c,f,m);let x=i;for(;i.prev!==i.next;){const w=i.prev,E=i.next;if(m?LK(i,c,f,m):DK(i))r.push(w.i,i.i,E.i),L_(i),i=E.next,x=E.next;else if((i=E)===x){g?g===1?k_(i=zK(Xf(i),r),r,s,c,f,m,2):g===2&&FK(i,r,s,c,f,m):k_(Xf(i),r,s,c,f,m,1);break}}}function DK(i){const r=i.prev,s=i,c=i.next;if(_i(r,s,c)>=0)return!1;const f=r.x,m=s.x,g=c.x,x=r.y,w=s.y,E=c.y,M=f<m?f<g?f:g:m<g?m:g,R=x<w?x<E?x:E:w<E?w:E,D=f>m?f>g?f:g:m>g?m:g,B=x>w?x>E?x:E:w>E?w:E;let $=c.next;for(;$!==r;){if($.x>=M&&$.x<=D&&$.y>=R&&$.y<=B&&Qp(f,x,m,w,g,E,$.x,$.y)&&_i($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function LK(i,r,s,c){const f=i.prev,m=i,g=i.next;if(_i(f,m,g)>=0)return!1;const x=f.x,w=m.x,E=g.x,M=f.y,R=m.y,D=g.y,B=x<w?x<E?x:E:w<E?w:E,$=M<R?M<D?M:D:R<D?R:D,q=x>w?x>E?x:E:w>E?w:E,X=M>R?M>D?M:D:R>D?R:D,te=RC(B,$,r,s,c),ce=RC(q,X,r,s,c);let he=i.prevZ,fe=i.nextZ;for(;he&&he.z>=te&&fe&&fe.z<=ce;){if(he.x>=B&&he.x<=q&&he.y>=$&&he.y<=X&&he!==f&&he!==g&&Qp(x,M,w,R,E,D,he.x,he.y)&&_i(he.prev,he,he.next)>=0||(he=he.prevZ,fe.x>=B&&fe.x<=q&&fe.y>=$&&fe.y<=X&&fe!==f&&fe!==g&&Qp(x,M,w,R,E,D,fe.x,fe.y)&&_i(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;he&&he.z>=te;){if(he.x>=B&&he.x<=q&&he.y>=$&&he.y<=X&&he!==f&&he!==g&&Qp(x,M,w,R,E,D,he.x,he.y)&&_i(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;fe&&fe.z<=ce;){if(fe.x>=B&&fe.x<=q&&fe.y>=$&&fe.y<=X&&fe!==f&&fe!==g&&Qp(x,M,w,R,E,D,fe.x,fe.y)&&_i(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function zK(i,r){let s=i;do{const c=s.prev,f=s.next.next;!eb(c,f)&&vz(c,s,s.next,f)&&D_(c,f)&&D_(f,c)&&(r.push(c.i,s.i,f.i),L_(s),L_(s.next),s=i=f),s=s.next}while(s!==i);return Xf(s)}function FK(i,r,s,c,f,m){let g=i;do{let x=g.next.next;for(;x!==g.prev;){if(g.i!==x.i&&UK(g,x)){let w=xz(g,x);return g=Xf(g,g.next),w=Xf(w,w.next),k_(g,r,s,c,f,m,0),void k_(w,r,s,c,f,m,0)}x=x.next}g=g.next}while(g!==i)}function NK(i,r){return i.x-r.x}function BK(i,r){const s=function(f,m){let g=m;const x=f.x,w=f.y;let E,M=-1/0;do{if(w<=g.y&&w>=g.next.y&&g.next.y!==g.y){const q=g.x+(w-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(q<=x&&q>M&&(M=q,E=g.x<g.next.x?g:g.next,q===x))return E}g=g.next}while(g!==m);if(!E)return null;const R=E,D=E.x,B=E.y;let $=1/0;g=E;do{if(x>=g.x&&g.x>=D&&x!==g.x&&Qp(w<B?x:M,w,D,B,w<B?M:x,w,g.x,g.y)){const q=Math.abs(w-g.y)/(x-g.x);D_(g,f)&&(q<$||q===$&&(g.x>E.x||g.x===E.x&&jK(E,g)))&&(E=g,$=q)}g=g.next}while(g!==R);return E}(i,r);if(!s)return r;const c=xz(s,i);return Xf(c,c.next),Xf(s,s.next)}function jK(i,r){return _i(i.prev,i,r.prev)<0&&_i(r.next,i,i.next)<0}function RC(i,r,s,c,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function $K(i){let r=i,s=i;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==i);return s}function Qp(i,r,s,c,f,m,g,x){return(f-g)*(r-x)>=(i-g)*(m-x)&&(i-g)*(c-x)>=(s-g)*(r-x)&&(s-g)*(m-x)>=(f-g)*(c-x)}function UK(i,r){return i.next.i!==r.i&&i.prev.i!==r.i&&!function(s,c){let f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==c.i&&f.next.i!==c.i&&vz(f,f.next,s,c))return!0;f=f.next}while(f!==s);return!1}(i,r)&&(D_(i,r)&&D_(r,i)&&function(s,c){let f=s,m=!1;const g=(s.x+c.x)/2,x=(s.y+c.y)/2;do f.y>x!=f.next.y>x&&f.next.y!==f.y&&g<(f.next.x-f.x)*(x-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==s);return m}(i,r)&&(_i(i.prev,i,r.prev)||_i(i,r.prev,r))||eb(i,r)&&_i(i.prev,i,i.next)>0&&_i(r.prev,r,r.next)>0)}function _i(i,r,s){return(r.y-i.y)*(s.x-r.x)-(r.x-i.x)*(s.y-r.y)}function eb(i,r){return i.x===r.x&&i.y===r.y}function vz(i,r,s,c){const f=nb(_i(i,r,s)),m=nb(_i(i,r,c)),g=nb(_i(s,c,i)),x=nb(_i(s,c,r));return f!==m&&g!==x||!(f!==0||!tb(i,s,r))||!(m!==0||!tb(i,c,r))||!(g!==0||!tb(s,i,c))||!(x!==0||!tb(s,r,c))}function tb(i,r,s){return r.x<=Math.max(i.x,s.x)&&r.x>=Math.min(i.x,s.x)&&r.y<=Math.max(i.y,s.y)&&r.y>=Math.min(i.y,s.y)}function nb(i){return i>0?1:i<0?-1:0}function D_(i,r){return _i(i.prev,i,i.next)<0?_i(i,r,i.next)>=0&&_i(i,i.prev,r)>=0:_i(i,r,i.prev)<0||_i(i,i.next,r)<0}function xz(i,r){const s=kC(i.i,i.x,i.y),c=kC(r.i,r.x,r.y),f=i.next,m=r.prev;return i.next=r,r.prev=i,s.next=f,f.prev=s,c.next=s,s.prev=c,m.next=c,c.prev=m,c}function bz(i,r,s,c){const f=kC(i,r,s);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function L_(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function kC(i,r,s){return{i,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function rb(i,r){const s=i.length;if(s<=1)return[i];const c=[];let f,m;for(let g=0;g<s;g++){const x=io(i[g]);x!==0&&(i[g].area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(f&&c.push(f),f=[i[g]]):f.push(i[g]))}if(f&&c.push(f),r>1)for(let g=0;g<c.length;g++)c[g].length<=r||(OA(c[g],r,1,c[g].length-1,VK),c[g]=c[g].slice(0,r));return c}function VK(i,r){return r.area-i.area}function DC(i,r,s){const c=s.patternDependencies;let f=!1;for(const m of r){const g=m.paint.get(`${i}-pattern`);g.isConstant()||(f=!0);const x=g.constantOr(null);x&&(f=!0,c[x]=!0)}return f}function LC(i,r,s,c,f){const m=f.patternDependencies;for(const g of r){const x=g.paint.get(`${i}-pattern`).value;if(x.kind!=="constant"){let w=x.evaluate({zoom:c},s,{},f.availableImages);w=w&&w.name?w.name:w,m[w]=!0,s.patterns[g.id]=w}}return s}class ib{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ls,this.indexArray=new Pi,this.indexArray2=new Vc,this.programConfigurations=new Wc(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new Br,this.segments2=new Br,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=r.projection}updateFootprints(r,s){}populate(r,s,c,f){this.hasPattern=DC("fill",this.layers,s);const m=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:x,id:w,index:E,sourceLayerIndex:M}of r){const R=this.layers[0]._featureFilter.needGeometry,D=_u(x,R);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),D,c))continue;const B=m?m.evaluate(D,{},c,s.availableImages):void 0,$={id:w,properties:x.properties,type:x.type,sourceLayerIndex:M,index:E,geometry:R?D.geometry:Fs(x,c,f),patterns:{},sortKey:B};g.push($)}m&&g.sort((x,w)=>x.sortKey-w.sortKey);for(const x of g){const{geometry:w,index:E,sourceLayerIndex:M}=x;if(this.hasPattern){const R=LC("fill",this.layers,x,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(x,w,E,c,{},s.availableImages,s.brightness);s.featureIndex.insert(r[E].feature,w,E,M,this.index)}}update(r,s,c,f,m){const g=Object.keys(r).length!==0;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,s,g?this.stateDependentLayers:this.layers,c,f,m)}addFeatures(r,s,c,f,m,g){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,c,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,kK),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,c,f,m,g=[],x){for(const w of rb(s,500)){let E=0;for(const q of w)E+=q.length;const M=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),R=M.vertexLength,D=[],B=[];for(const q of w){if(q.length===0)continue;q!==w[0]&&B.push(D.length/2);const X=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),te=X.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(te+q.length-1,te),D.push(q[0].x),D.push(q[0].y);for(let ce=1;ce<q.length;ce++)this.layoutVertexArray.emplaceBack(q[ce].x,q[ce].y),this.indexArray2.emplaceBack(te+ce-1,te+ce),D.push(q[ce].x),D.push(q[ce].y);X.vertexLength+=q.length,X.primitiveLength+=q.length}const $=R_(D,B);for(let q=0;q<$.length;q+=3)this.indexArray.emplaceBack(R+$[q],R+$[q+1],R+$[q+2]);M.vertexLength+=E,M.primitiveLength+=$.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,m,g,f,x)}}pe(ib,"FillBucket",{omit:["layers","patternFeatures"]});const GK=new nr({"fill-sort-key":new zt(Ve.layout_fill["fill-sort-key"]),visibility:new pt(Ve.layout_fill.visibility)});var WK={paint:new nr({"fill-antialias":new pt(Ve.paint_fill["fill-antialias"]),"fill-opacity":new zt(Ve.paint_fill["fill-opacity"]),"fill-color":new zt(Ve.paint_fill["fill-color"]),"fill-outline-color":new zt(Ve.paint_fill["fill-outline-color"]),"fill-translate":new pt(Ve.paint_fill["fill-translate"]),"fill-translate-anchor":new pt(Ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new zt(Ve.paint_fill["fill-pattern"]),"fill-emissive-strength":new pt(Ve.paint_fill["fill-emissive-strength"])}),layout:GK};class zC{constructor(r,s,c,f){if(this.triangleCount=s.length/3,this.min=new Lt(0,0),this.max=new Lt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||r.length===0)return;const[m,g]=[r[0].clone(),r[0].clone()];for(let R=1;R<r.length;++R){const D=r[R];m.x=Math.min(m.x,D.x),m.y=Math.min(m.y,D.y),g.x=Math.max(g.x,D.x),g.y=Math.max(g.y,D.y)}if(f){const R=Math.ceil(Math.max(g.x-m.x,g.y-m.y)/f);c=Math.max(c,R)}if(c===0)return;this.min=m,this.max=g;const x=this.max.sub(this.min);x.x=Math.max(x.x,1),x.y=Math.max(x.y,1);const w=Math.max(x.x,x.y)/c;this.cellsX=Math.max(1,Math.ceil(x.x/w)),this.cellsY=Math.max(1,Math.ceil(x.y/w)),this.xScale=1/w,this.yScale=1/w;const E=[];for(let R=0;R<this.triangleCount;R++){const D=r[s[3*R+0]].sub(this.min),B=r[s[3*R+1]].sub(this.min),$=r[s[3*R+2]].sub(this.min),q=Cl(Math.floor(Math.min(D.x,B.x,$.x)),this.xScale,this.cellsX),X=Cl(Math.floor(Math.max(D.x,B.x,$.x)),this.xScale,this.cellsX),te=Cl(Math.floor(Math.min(D.y,B.y,$.y)),this.yScale,this.cellsY),ce=Cl(Math.floor(Math.max(D.y,B.y,$.y)),this.yScale,this.cellsY),he=new Lt(0,0),fe=new Lt(0,0),Ee=new Lt(0,0),we=new Lt(0,0);for(let Ie=te;Ie<=ce;++Ie){he.y=fe.y=Ie*w,Ee.y=we.y=(Ie+1)*w;for(let ke=q;ke<=X;++ke)he.x=Ee.x=ke*w,fe.x=we.x=(ke+1)*w,(wC(D,B,$,he,fe,we)||wC(D,B,$,he,we,Ee))&&E.push({cellIdx:Ie*this.cellsX+ke,triIdx:R})}}if(E.length===0)return;E.sort((R,D)=>R.cellIdx-D.cellIdx||R.triIdx-D.triIdx);let M=0;for(;M<E.length;){const R=E[M].cellIdx,D={start:this.payload.length,len:0};for(;M<E.length&&E[M].cellIdx===R;)++D.len,this.payload.push(E[M++].triIdx);this.cells[R]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(r,s){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>r.x||r.y>this.max.y||this.min.y>r.y)return;const c=Cl(r.x-this.min.x,this.xScale,this.cellsX),f=Cl(r.y-this.min.y,this.yScale,this.cellsY),m=this.cells[f*this.cellsX+c];if(m){this._lazyInitLookup();for(let g=0;g<m.len;g++){const x=this.payload[m.start+g],w=Math.floor(x/8),E=1<<x%8;if(!(this.lookup[w]&E)&&(this.lookup[w]|=E,s.push(x),s.length===this.triangleCount))return}}}query(r,s,c){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>s.x||r.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const f=Cl(r.x-this.min.x,this.xScale,this.cellsX),m=Cl(s.x-this.min.x,this.xScale,this.cellsX),g=Cl(r.y-this.min.y,this.yScale,this.cellsY),x=Cl(s.y-this.min.y,this.yScale,this.cellsY);for(let w=g;w<=x;w++)for(let E=f;E<=m;E++){const M=this.cells[w*this.cellsX+E];if(M)for(let R=0;R<M.len;R++){const D=this.payload[M.start+R],B=Math.floor(D/8),$=1<<D%8;if(!(this.lookup[B]&$)&&(this.lookup[B]|=$,c.push(D),c.length===this.triangleCount))return}}}}function Cl(i,r,s){return Math.max(0,Math.min(s-1,Math.floor(i*r)))}pe(zC,"TriangleGridIndex");class wz{constructor(r){this.zoom=r.zoom,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(r,s){for(const c of this.footprints)s.push({footprint:c,id:r})}populate(r,s,c,f){const m=[];for(const{feature:g,id:x,index:w,sourceLayerIndex:E}of r){const M=this.layers[0]._featureFilter.needGeometry,R=_u(g,M);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),R,c))continue;const D={id:x,properties:g.properties,type:g.type,sourceLayerIndex:E,index:w,geometry:M?R.geometry:Fs(g,c,f),patterns:{}};m.push(D)}for(const g of m){const{geometry:x,index:w,sourceLayerIndex:E}=g;this.addFeature(g,x,w,c,{},s.availableImages,s.brightness),s.featureIndex.insert(r[w].feature,x,w,E,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(r){}update(r,s,c,f,m){}destroy(){}addFeature(r,s,c,f,m,g=[],x){for(const w of rb(s,2)){const E=[],M=[],R=[],D=new Lt(1/0,1/0),B=new Lt(-1/0,-1/0);for(const X of w)if(X.length!==0){X!==w[0]&&R.push(M.length/2);for(let te=0;te<X.length;te++)M.push(X[te].x),M.push(X[te].y),E.push(X[te]),D.x=Math.min(D.x,X[te].x),D.y=Math.min(D.y,X[te].y),B.x=Math.max(B.x,X[te].x),B.y=Math.max(B.y,X[te].y)}const $=R_(M,R),q=new zC(E,$,8,256);this.footprints.push({vertices:E,indices:$,grid:q,min:D,max:B})}}}pe(wz,"ClipBucket",{omit:["layers"]});const HK=new nr({"clip-layer-types":new pt(Ve.layout_clip["clip-layer-types"])});var qK={paint:new nr({}),layout:HK};const ZK=rr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),XK=rr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),YK=rr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),KK=rr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),QK=rr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:JK}=ZK;var ob={},eQ=ap,Sz=Jp;function Jp(i,r,s,c,f){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=f,i.readFields(tQ,this,r)}function tQ(i,r,s){i==1?r.id=s.readVarint():i==2?function(c,f){for(var m=c.readVarint()+c.pos;c.pos<m;){var g=f._keys[c.readVarint()],x=f._values[c.readVarint()];f.properties[g]=x}}(s,r):i==3?r.type=s.readVarint():i==4&&(r._geometry=s.pos)}function nQ(i){for(var r,s,c=0,f=0,m=i.length,g=m-1;f<m;g=f++)c+=((s=i[g]).x-(r=i[f]).x)*(r.y+s.y);return c}Jp.types=["Unknown","Point","LineString","Polygon"],Jp.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var r,s=i.readVarint()+i.pos,c=1,f=0,m=0,g=0,x=[];i.pos<s;){if(f<=0){var w=i.readVarint();c=7&w,f=w>>3}if(f--,c===1||c===2)m+=i.readSVarint(),g+=i.readSVarint(),c===1&&(r&&x.push(r),r=[]),r.push(new eQ(m,g));else{if(c!==7)throw new Error("unknown command "+c);r&&r.push(r[0].clone())}}return r&&x.push(r),x},Jp.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var r=i.readVarint()+i.pos,s=1,c=0,f=0,m=0,g=1/0,x=-1/0,w=1/0,E=-1/0;i.pos<r;){if(c<=0){var M=i.readVarint();s=7&M,c=M>>3}if(c--,s===1||s===2)(f+=i.readSVarint())<g&&(g=f),f>x&&(x=f),(m+=i.readSVarint())<w&&(w=m),m>E&&(E=m);else if(s!==7)throw new Error("unknown command "+s)}return[g,w,x,E]},Jp.prototype.toGeoJSON=function(i,r,s){var c,f,m=this.extent*Math.pow(2,s),g=this.extent*i,x=this.extent*r,w=this.loadGeometry(),E=Jp.types[this.type];function M(B){for(var $=0;$<B.length;$++){var q=B[$];B[$]=[360*(q.x+g)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+x)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(c=0;c<w.length;c++)R[c]=w[c][0];M(w=R);break;case 2:for(c=0;c<w.length;c++)M(w[c]);break;case 3:for(w=function(B){var $=B.length;if($<=1)return[B];for(var q,X,te=[],ce=0;ce<$;ce++){var he=nQ(B[ce]);he!==0&&(X===void 0&&(X=he<0),X===he<0?(q&&te.push(q),q=[B[ce]]):q.push(B[ce]))}return q&&te.push(q),te}(w),c=0;c<w.length;c++)for(f=0;f<w[c].length;f++)M(w[c][f])}w.length===1?w=w[0]:E="Multi"+E;var D={type:"Feature",geometry:{type:E,coordinates:w},properties:this.properties};return"id"in this&&(D.id=this.id),D};var rQ=Sz,Tz=Ez;function Ez(i,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(iQ,this,r),this.length=this._features.length}function iQ(i,r,s){i===15?r.version=s.readVarint():i===1?r.name=s.readString():i===5?r.extent=s.readVarint():i===2?r._features.push(s.pos):i===3?r._keys.push(s.readString()):i===4&&r._values.push(function(c){for(var f=null,m=c.readVarint()+c.pos;c.pos<m;){var g=c.readVarint()>>3;f=g===1?c.readString():g===2?c.readFloat():g===3?c.readDouble():g===4?c.readVarint64():g===5?c.readVarint():g===6?c.readSVarint():g===7?c.readBoolean():null}return f}(s))}Ez.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var r=this._pbf.readVarint()+this._pbf.pos;return new rQ(this._pbf,r,this.extent,this._keys,this._values)};var oQ=Tz;function aQ(i,r,s){if(i===3){var c=new oQ(s,s.readVarint()+s.pos);c.length&&(r[c.name]=c)}}var FC=ob.VectorTile=function(i,r){this.layers=i.readFields(aQ,{},r)},ab=ob.VectorTileFeature=Sz;ob.VectorTileLayer=Tz;class Yf extends Lt{constructor(r,s,c){super(r,s),this.z=c}}class Az extends Yf{constructor(r,s,c,f){super(r,s,c),this.w=f}}function sb(i,r,s,c){const f=[],m=c===0?(g,x,w,E,M,R)=>{g.push(new Lt(R,w+(R-x)/(E-x)*(M-w)))}:(g,x,w,E,M,R)=>{g.push(new Lt(x+(R-w)/(M-w)*(E-x),R))};for(const g of i){const x=[];for(const w of g){if(w.length<=2)continue;const E=[];for(let D=0;D<w.length-1;D++){const B=w[D].x,$=w[D].y,q=w[D+1].x,X=w[D+1].y,te=c===0?B:$,ce=c===0?q:X;te<r?ce>r&&m(E,B,$,q,X,r):te>s?ce<s&&m(E,B,$,q,X,s):E.push(w[D]),ce<r&&te>=r&&m(E,B,$,q,X,r),ce>s&&te<=s&&m(E,B,$,q,X,s)}let M=w[w.length-1];const R=c===0?M.x:M.y;R>=r&&R<=s&&E.push(M),E.length&&(M=E[E.length-1],E[0].x===M.x&&E[0].y===M.y||E.push(E[0]),x.push(E))}x.length&&f.push(x)}return f}function Cz(i,r,s,c){const f=s==="x"?"y":"x",m=(c-i[s])/(r[s]-i[s]);i[f]=i[f]+(r[f]-i[f])*m,i[s]=c,i.hasOwnProperty("z")&&(i.z=on(i.z,r.z,m)),i.hasOwnProperty("w")&&(i.w=on(i.w,r.w,m))}function Pz(i,r,s,c){const f=s,m=c;for(const g of["x","y"]){let x=i,w=r;x[g]>=w[g]&&(x=r,w=i),x[g]<f&&w[g]>f&&Cz(x,w,g,f),x[g]<m&&w[g]>m&&Cz(w,x,g,m)}}function lb(i,r){return i.x-r.x||i.y-r.y}function Mz(i,r){return lb(i.min,r.min)===0&&lb(i.max,r.max)===0}function NC(i,r){return!(i.min.x>r.max.x||i.max.x<r.min.x||i.min.y>r.max.y||i.max.y<r.min.y)}function BC(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;s++)if(i[s].sourceId!==r[s].sourceId||!Mz(i[s],r[s])||i[s].order!==r[s].order||i[s].clipMask!==r[s].clipMask)return!1;return!0}function Iz(i,r,s){const c=1/Mt,f=1/(1<<s.canonical.z),m=(r.x*c+s.canonical.x)*f+s.wrap,g=(r.y*c+s.canonical.y)*f;return{min:new Lt((i.x*c+s.canonical.x)*f+s.wrap,(i.y*c+s.canonical.y)*f),max:new Lt(m,g)}}function sQ(i,r,s){const c=1<<s.canonical.z,f=((r.x-s.wrap)*c-s.canonical.x)*Mt,m=(r.y*c-s.canonical.y)*Mt;return{min:new Lt(((i.x-s.wrap)*c-s.canonical.x)*Mt,(i.y*c-s.canonical.y)*Mt),max:new Lt(f,m)}}function Oz(i,r,s,c,f,m,g){const x=i.indices,w=i.vertices,E=[];for(let M=c;M<c+f;M+=3){const R=r[s[M+0]+m],D=r[s[M+1]+m],B=r[s[M+2]+m],$=Math.min(R.x,D.x,B.x),q=Math.max(R.x,D.x,B.x),X=Math.min(R.y,D.y,B.y),te=Math.max(R.y,D.y,B.y);E.length=0,i.grid.query(new Lt($,X),new Lt(q,te),E);for(let ce=0;ce<E.length;ce++){const he=E[ce];if(wC(w[x[3*he+0]],w[x[3*he+1]],w[x[3*he+2]],R,D,B,g))return!0}}return!1}function Rz(i,r,s,c){if(!i||!s)return!1;let f=i.vertices;if(!r.canonical.equals(c.canonical)||r.wrap!==c.wrap){if(s.vertices.length<i.vertices.length)return Rz(s,c,i,r);const m=r.canonical,g=c.canonical,x=Math.pow(2,g.z-m.z);f=i.vertices.map(w=>new Lt((w.x+m.x*Mt)*x-g.x*Mt,(w.y+m.y*Mt)*x-g.y*Mt))}return Oz(s,f,i.indices,0,i.indices.length,0,0)}function kz(i,r,s,c){const f=Math.pow(2,c.z-s.z);return new Lt((i+s.x*Mt)*f-c.x*Mt,(r+s.y*Mt)*f-c.y*Mt)}function Dz(i,r){const s=[];r.footprint.grid.queryPoint(i,s);const c=r.footprint.indices,f=r.footprint.vertices;for(let m=0;m<s.length;m++){const g=s[m];if(qc([f[c[3*g+0]],f[c[3*g+1]],f[c[3*g+2]]],i))return!0}return!1}class Lz{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,s){const c=this.toIdx(r,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(r,s){return this.leaves[this.toIdx(r,s)]}toIdx(r,s){return s*this.size+r}}function zz(i,r,s,c){let f=0,m=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(c[g])<1e-15){if(s[g]<i[g]||s[g]>r[g])return null}else{const x=1/c[g];let w=(i[g]-s[g])*x,E=(r[g]-s[g])*x;if(w>E){const M=w;w=E,E=M}if(w>f&&(f=w),E<m&&(m=E),f>m)return null}return f}function Fz(i,r,s,c,f,m,g,x,w,E,M){const R=c-i,D=f-r,B=m-s,$=g-i,q=x-r,X=w-s,te=M[1]*X-M[2]*q,ce=M[2]*$-M[0]*X,he=M[0]*q-M[1]*$,fe=R*te+D*ce+B*he;if(Math.abs(fe)<1e-15)return null;const Ee=1/fe,we=E[0]-i,Ie=E[1]-r,ke=E[2]-s,$e=(we*te+Ie*ce+ke*he)*Ee;if($e<0||$e>1)return null;const nt=Ie*B-ke*D,He=ke*R-we*B,ut=we*D-Ie*R,bt=(M[0]*nt+M[1]*He+M[2]*ut)*Ee;return bt<0||$e+bt>1?null:($*nt+q*He+X*ut)*Ee}function Nz(i,r,s){return(i-r)/(s-r)}function Bz(i,r,s,c,f,m,g,x,w){const E=1<<s,M=m-c,R=g-f,D=(i+1)/E*M+c,B=(r+0)/E*R+f,$=(r+1)/E*R+f;x[0]=(i+0)/E*M+c,x[1]=B,w[0]=D,w[1]=$}class jz{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(m){const g=Math.ceil(Math.log2(m.dim/8)),x=[];let w=Math.ceil(Math.pow(2,g));const E=1/w,M=(B,$,q,X,te)=>{const ce=X?1:0,he=(B+1)*q-ce,fe=$*q,Ee=($+1)*q-ce;te[0]=B*q,te[1]=fe,te[2]=he,te[3]=Ee};let R=new Lz(w);const D=[];for(let B=0;B<w*w;B++){M(B%w,Math.floor(B/w),E,!1,D);const $=Xc(D[0],D[1],m),q=Xc(D[2],D[1],m),X=Xc(D[2],D[3],m),te=Xc(D[0],D[3],m);R.minimums.push(Math.min($,q,X,te)),R.maximums.push(Math.max($,q,X,te)),R.leaves.push(1)}for(x.push(R),w/=2;w>=1;w/=2){const B=x[x.length-1];R=new Lz(w);for(let $=0;$<w*w;$++){M($%w,Math.floor($/w),2,!0,D);const q=B.getElevation(D[0],D[1]),X=B.getElevation(D[2],D[1]),te=B.getElevation(D[2],D[3]),ce=B.getElevation(D[0],D[3]),he=B.isLeaf(D[0],D[1]),fe=B.isLeaf(D[2],D[1]),Ee=B.isLeaf(D[2],D[3]),we=B.isLeaf(D[0],D[3]),Ie=Math.min(q.min,X.min,te.min,ce.min),ke=Math.max(q.max,X.max,te.max,ce.max),$e=he&&fe&&Ee&&we;R.maximums.push(ke),R.minimums.push(Ie),R.leaves.push(ke-Ie<=5&&$e?1:0)}x.push(R)}return x}(this.dem),c=s.length-1,f=s[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(r,s,c,f,m,g,x=1){return zz([r,s,-100],[c,f,this.maximums[0]*x],m,g)}raycast(r,s,c,f,m,g,x=1){if(!this.nodeCount)return null;const w=this.raycastRoot(r,s,c,f,m,g,x);if(w==null)return null;const E=[],M=[],R=[],D=[],B=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:$,t:q,nodex:X,nodey:te,depth:ce}=B.pop();if(this.leaves[$]){Bz(X,te,ce,r,s,c,f,R,D);const fe=1<<ce,Ee=(X+0)/fe,we=(X+1)/fe,Ie=(te+0)/fe,ke=(te+1)/fe,$e=Xc(Ee,Ie,this.dem)*x,nt=Xc(we,Ie,this.dem)*x,He=Xc(we,ke,this.dem)*x,ut=Xc(Ee,ke,this.dem)*x,bt=Fz(R[0],R[1],$e,D[0],R[1],nt,D[0],D[1],He,m,g),ot=Fz(D[0],D[1],He,R[0],D[1],ut,R[0],R[1],$e,m,g),yt=Math.min(bt!==null?bt:Number.MAX_VALUE,ot!==null?ot:Number.MAX_VALUE);if(yt!==Number.MAX_VALUE)return yt;{const it=a._.scaleAndAdd([],m,g,q);if($z($e,nt,ut,He,Nz(it[0],R[0],D[0]),Nz(it[1],R[1],D[1]))>=it[2])return q}continue}let he=0;for(let fe=0;fe<this._siblingOffset.length;fe++){Bz((X<<1)+this._siblingOffset[fe][0],(te<<1)+this._siblingOffset[fe][1],ce+1,r,s,c,f,R,D),R[2]=-100,D[2]=this.maximums[this.childOffsets[$]+fe]*x;const Ee=zz(R,D,m,g);if(Ee!=null){const we=Ee;E[fe]=we;let Ie=!1;for(let ke=0;ke<he&&!Ie;ke++)we>=E[M[ke]]&&(M.splice(ke,0,fe),Ie=!0);Ie||(M[he]=fe),he++}}for(let fe=0;fe<he;fe++){const Ee=M[fe];B.push({idx:this.childOffsets[$]+Ee,t:E[Ee],nodex:(X<<1)+this._siblingOffset[Ee][0],nodey:(te<<1)+this._siblingOffset[Ee][1],depth:ce+1})}}return null}_addNode(r,s,c){return this.minimums.push(r),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(r,s,c,f,m){if(r[f].isLeaf(s,c)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const g=f-1,x=r[g];let w=0,E=0;for(let M=0;M<this._siblingOffset.length;M++){const R=2*s+this._siblingOffset[M][0],D=2*c+this._siblingOffset[M][1],B=x.getElevation(R,D),$=x.isLeaf(R,D),q=this._addNode(B.min,B.max,$);$&&(w|=1<<M),E||(E=q)}for(let M=0;M<this._siblingOffset.length;M++)w&1<<M||this._construct(r,2*s+this._siblingOffset[M][0],2*c+this._siblingOffset[M][1],g,E+M)}}function $z(i,r,s,c,f,m){return on(on(i,s,m),on(r,c,m),f)}function Xc(i,r,s){const c=s.dim,f=Pn(i*c-.5,0,c-1),m=Pn(r*c-.5,0,c-1),g=Math.floor(f),x=Math.floor(m),w=Math.min(g+1,c-1),E=Math.min(x+1,c-1);return $z(s.get(g,x),s.get(w,x),s.get(g,E),s.get(w,E),f-g,m-x)}const lQ={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function uQ(i,r,s){return(256*i*256+256*r+s)/10-1e4}function cQ(i,r,s){return 256*i+r+s/256-32768}class ub{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,s,c,f=!1){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Qr(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const m=this.dim=s.height-2,g=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let w=0;w<m;w++)g[this._idx(-1,w)]=g[this._idx(0,w)],g[this._idx(m,w)]=g[this._idx(m-1,w)],g[this._idx(w,-1)]=g[this._idx(w,0)],g[this._idx(w,m)]=g[this._idx(w,m-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(m,-1)]=g[this._idx(m-1,0)],g[this._idx(-1,m)]=g[this._idx(0,m-1)],g[this._idx(m,m)]=g[this._idx(m-1,m-1)]}const x=c==="terrarium"?cQ:uQ;for(let w=0;w<g.length;++w){const E=4*w;this.floatView[w]=x(this.pixels[E],this.pixels[E+1],this.pixels[E+2])}this._timestamp=Di.now()}_buildQuadTree(){this._tree=new jz(this)}get(r,s,c=!1){c&&(r=Pn(r,-1,this.dim),s=Pn(s,-1,this.dim));const f=this._idx(r,s);return this.floatView[f]}set(r,s,c){const f=this._idx(r,s),m=this.floatView[f];return this.floatView[f]=c,c-m}static getUnpackVector(r){return lQ[r]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}static pack(r,s){const c=[0,0,0,0],f=ub.getUnpackVector(s);let m=Math.floor((r+f[3])/f[2]);return c[2]=m%256,m=Math.floor(m/256),c[1]=m%256,m=Math.floor(m/256),c[0]=m,c}getPixels(){return new yz({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,s,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,m=s*this.dim+this.dim,g=c*this.dim,x=c*this.dim+this.dim;switch(s){case-1:f=m-1;break;case 1:m=f+1}switch(c){case-1:g=x-1;break;case 1:x=g+1}const w=-s*this.dim,E=-c*this.dim;for(let M=g;M<x;M++)for(let R=f;R<m;R++){const D=4*this._idx(R,M),B=4*this._idx(R+w,M+E);this.pixels[D+0]=r.pixels[B+0],this.pixels[D+1]=r.pixels[B+1],this.pixels[D+2]=r.pixels[B+2],this.pixels[D+3]=r.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}pe(ub,"DEMData"),pe(jz,"DemMinMaxQuadTree",{omit:["dem"]});class em{constructor(r,s,c){this._demTile=r,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(r,s,c){const f=c||r.findDEMTileFor(s);if(!f||!f.dem)return;const m=f.dem,g=f.tileID,x=1<<s.canonical.z-g.canonical.z;return new em(f,m.dim/Mt/x,[(s.canonical.x/x-g.canonical.x)*m.dim,(s.canonical.y/x-g.canonical.y)*m.dim])}tileCoordToPixel(r,s){const c=s*this._scale+this._offset[1],f=Math.floor(r*this._scale+this._offset[0]),m=Math.floor(c);return new Lt(f,m)}getElevationAt(r,s,c,f){const m=r*this._scale+this._offset[0],g=s*this._scale+this._offset[1],x=Math.floor(m),w=Math.floor(g),E=this._dem;return f=!!f,c?on(on(E.get(x,w,f),E.get(x,w+1,f),g-w),on(E.get(x+1,w,f),E.get(x+1,w+1,f),g-w),m-x):E.get(x,w,f)}getElevationAtPixel(r,s,c){return this._dem.get(r,s,!!c)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*Mo(1,r)*this._dem.stride}}const Uz={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},hQ=ab.types,fQ=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],dQ=["fill-extrusion-flood-light-ground-radius"],pQ=Math.pow(2,13),mQ=Math.pow(2,15)-1,Vz=new Lt(0,1),Yc=2147483648;function z_(i,r,s,c,f,m,g,x){i.emplaceBack((r<<1)+g,(s<<1)+m,(Math.floor(c*pQ)<<1)+f,Math.round(x))}function cb(i,r,s,c,f,m){i.emplaceBack(r.x,r.y,(s.x<<1)+c,(s.y<<1)+f,m)}function F_(i,r,s){i.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Gz{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Wz{constructor(){this.centroidXY=new Lt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Lt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Lt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Lt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Hz{constructor(){this.acc=new Lt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(r,s){r.min.x===Number.MAX_VALUE&&(r.min.x=r.max.x=s.x,r.min.y=r.max.y=s.y)}appendEdge(r,s,c){this.accCount++,this.acc._add(s);let f=!!this.borders;s.x<r.min.x?(r.min.x=s.x,f=!0):s.x>r.max.x&&(r.max.x=s.x,f=!0),s.y<r.min.y?(r.min.y=s.y,f=!0):s.y>r.max.y&&(r.max.y=s.y,f=!0),((s.x===0||s.x===Mt)&&s.x===c.x)!=((s.y===0||s.y===Mt)&&s.y===c.y)&&this.processBorderOverlap(s,c),f&&this.checkBorderIntersection(s,c)}checkBorderIntersection(r,s){s.x<0!=r.x<0&&this.addBorderIntersection(0,on(s.y,r.y,(0-s.x)/(r.x-s.x))),s.x>Mt!=r.x>Mt&&this.addBorderIntersection(1,on(s.y,r.y,(Mt-s.x)/(r.x-s.x))),s.y<0!=r.y<0&&this.addBorderIntersection(2,on(s.x,r.x,(0-s.y)/(r.y-s.y))),s.y>Mt!=r.y>Mt&&this.addBorderIntersection(3,on(s.x,r.x,(Mt-s.y)/(r.y-s.y)))}addBorderIntersection(r,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[r];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(r,s){if(r.x===s.x){if(r.y===s.y)return;const c=r.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,r.y)}else{const c=r.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,r.x)}}centroid(){return this.accCount===0?new Lt(0,0):new Lt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((r,s)=>r+ +(s[0]!==Number.MAX_VALUE),0):0}}function qz(i,r){const s=i.add(r)._unit(),c=Pn(i.x*s.x+i.y*s.y,-1,1);var f,m,g;return f=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(f)))/4*mQ*((m=i).x*(g=r).y-m.y*g.x<0?-1:1)}const gQ=[i=>i.x<0,i=>i.x>Mt,i=>i.y<0,i=>i.y>Mt];function yQ(i,r,s,c){const f=[4];if(c===0)return f;s._mult(c);const m=i.sub(s),g=r.sub(s),x=[i,r,m,g];for(let w=0;w<4;w++)for(const E of x)if(gQ[w](E)){f.push(w);break}return f}class Zz{constructor(r){this.vertexArray=new GA,this.indexArray=new Pi,this.programConfigurations=new Wc(r.layers,{zoom:r.zoom,lut:r.lut},s=>dQ.includes(s)),this._segments=new Br,this.hiddenByLandmarkVertexArray=new iC,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Br}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(r,s,c,f=!1){const m=r.length;if(m>2){let g=Math.max(0,this._segments.get().length-1);const x=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let w;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const E=r[0],M=r[1];w=qz(E.sub(r[m-1])._perp()._unit(),M.sub(E)._perp()._unit())}for(let E=0;E<m;E++){const M=E===m-1?0:E+1,R=r[E],D=r[M],B=r[M===m-1?0:M+1],$=D.sub(R)._perp()._unit(),q=qz($,B.sub(D)._perp()._unit()),X=w,te=q;if(jC(R,D,s)||f&&Kz(R,s)&&Kz(D,s)){w=q;continue}const ce=x.vertexLength;cb(this.vertexArray,R,D,1,1,X),cb(this.vertexArray,R,D,1,0,X),cb(this.vertexArray,R,D,0,1,te),cb(this.vertexArray,R,D,0,0,te),x.vertexLength+=4;const he=yQ(R,D,$,c);for(const fe of he)this._segmentToGroundQuads[g].push({id:ce,region:fe}),this._segmentToRegionTriCounts[g][fe]+=2,x.primitiveLength+=2;w=q}}}prepareBorderSegments(){if(!this.hasData())return;const r=this._segments.get(),s=r.length;for(let c=0;c<s;c++)this._segmentToGroundQuads[c].sort((f,m)=>f.region-m.region);for(let c=0;c<s;c++){const f=this._segmentToGroundQuads[c],m=r[c],g=this._segmentToRegionTriCounts[c];g.reduce((w,E)=>w+E,0);let x=0;for(let w=0;w<=4;w++){const E=g[w];if(E!==0){let M=this.regionSegments[w];M||(M=this.regionSegments[w]=new Br);const R={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+x,vertexLength:m.vertexLength,primitiveLength:E};M.get().push(R)}x+=E}for(let w=0;w<f.length;w++){const E=f[w].id;this.indexArray.emplaceBack(E,E+1,E+3),this.indexArray.emplaceBack(E,E+3,E+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(r,s,c,f,m,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,r,s,c,f,m,g)}upload(r){this.hasData()&&(this.vertexBuffer=r.createVertexBuffer(this.vertexArray,XK.members),this.indexBuffer=r.createIndexBuffer(this.indexArray))}uploadPaintProperties(r){this.hasData()&&this.programConfigurations.upload(r)}update(r,s,c,f,m,g){this.hasData()&&this.programConfigurations.updatePaintArrays(r,s,c,f,m,g)}updateHiddenByLandmark(r){if(!this.hasData())return;const s=r.groundVertexCount+r.groundVertexArrayOffset;if(r.groundVertexCount===0)return;const c=r.flags&Yc?1:0;for(let f=r.groundVertexArrayOffset;f<s;++f)this.hiddenByLandmarkVertexArray.emplace(f,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(r){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=r.createVertexBuffer(this.hiddenByLandmarkVertexArray,KK.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let r=0;r<=4;r++){const s=this.regionSegments[r];s&&s.destroy()}}}}class hb{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Pi,this.footprintVertices=new Ls,this.footprintSegments=[],this.layoutVertexArray=new Bc,this.centroidVertexArray=new kL,this.indexArray=new Pi,this.programConfigurations=new Wc(r.layers,{zoom:r.zoom,lut:r.lut},s=>fQ.includes(s)),this.segments=new Br,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new Zz(r),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(r,s){}populate(r,s,c,f){this.features=[],this.hasPattern=DC("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=H1(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:g,index:x,sourceLayerIndex:w}of r){const E=this.layers[0]._featureFilter.needGeometry,M=_u(m,E);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),M,c))continue;const R={id:g,sourceLayerIndex:w,index:x,geometry:E?M.geometry:Fs(m,c,f),properties:m.properties,type:m.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(LC("fill-extrusion",this.layers,R,this.zoom,s)):this.addFeature(R,R.geometry,x,c,{},s.availableImages,f,s.brightness),s.featureIndex.insert(m,R.geometry,x,w,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(r,s,c,f,m,g){for(const x of this.features){const{geometry:w}=x;this.addFeature(x,w,x.index,s,c,f,m,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(r,s,c,f,m){const g=Object.keys(r).length!==0;if(g&&!this.stateDependentLayers.length)return;const x=g?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(r,s,x,c,f,m),this.groundEffect.update(r,s,x,c,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,JK),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,QK.members,!0)),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.groundEffect.uploadHiddenByLandmark(r),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,YK.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,c,f,m,g,x,w){const E=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(r,{})/this.tileToMeter,M=[new Lt(0,0),new Lt(Mt,Mt)],R=x.projection,D=R.name==="globe",B=hQ[r.type]==="Polygon",$=new Hz;$.centroidDataIndex=this.centroidData.length;const q=new Wz,X=this.layers[0].paint.get("fill-extrusion-base").evaluate(r,{},f)<=0,te=this.layers[0].paint.get("fill-extrusion-height").evaluate(r,{},f);q.height=te,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new $1);const ce=rb(s,500);for(let ke=ce.length-1;ke>=0;ke--){const $e=ce[ke];($e.length===0||(he=$e[0]).every(nt=>nt.x<=0)||he.every(nt=>nt.x>=Mt)||he.every(nt=>nt.y<=0)||he.every(nt=>nt.y>=Mt))&&ce.splice(ke,1)}var he;let fe;if(D)fe=tF(ce,M,f);else{fe=[];for(const ke of ce)fe.push({polygon:ke,bounds:M})}const Ee=B?this.edgeRadius:0,we=Ee>0&&this.zoom<17,Ie=(ke,$e)=>{if(ke.length===0)return!1;const nt=ke[ke.length-1];return $e.x===nt.x&&$e.y===nt.y};for(const{polygon:ke,bounds:$e}of fe){let nt=0,He=0;for(const yt of ke)B&&!yt[0].equals(yt[yt.length-1])&&yt.push(yt[0]),He+=B?yt.length-1:yt.length;const ut=this.segments.prepareSegment((B?5:4)*He,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);const bt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ot=new Gz;if(ot.vertexOffset=this.footprintVertices.length,ot.indexOffset=3*this.footprintIndices.length,ot.ringIndices=[],B){const yt=[],it=[];nt=ut.vertexLength;for(let Tt=0;Tt<ke.length;Tt++){const xt=ke[Tt];xt.length&&Tt!==0&&it.push(yt.length/2);const Ft=[];let wt,Ct;wt=xt[1].sub(xt[0])._perp()._unit(),ot.ringIndices.push(xt.length-1);for(let Jt=1;Jt<xt.length;Jt++){const Kt=xt[Jt],Ht=xt[Jt===xt.length-1?1:Jt+1],Et=Kt.clone();if(Ee){Ct=Ht.sub(Kt)._perp()._unit();const tn=wt.add(Ct)._unit(),xn=Ee*Math.min(4,1/(wt.x*tn.x+wt.y*tn.y));Et.x+=xn*tn.x,Et.y+=xn*tn.y,Et.x=Math.round(Et.x),Et.y=Math.round(Et.y),wt=Ct}!X||Ee!==0&&!we||Ie(Ft,Et)||Ft.push(Et),z_(this.layoutVertexArray,Et.x,Et.y,0,0,1,1,0),ut.vertexLength++,this.footprintVertices.emplaceBack(Kt.x,Kt.y),yt.push(Kt.x,Kt.y),D&&F_(this.layoutVertexExtArray,R.projectTilePoint(Et.x,Et.y,f),R.upVector(f,Et.x,Et.y))}X&&(Ee===0||we)&&(Ft.length!==0&&Ie(Ft,Ft[0])&&Ft.pop(),this.groundEffect.addData(Ft,$e,E))}const _t=R_(yt,it);for(let Tt=0;Tt<_t.length;Tt+=3)this.footprintIndices.emplaceBack(ot.vertexOffset+_t[Tt+0],ot.vertexOffset+_t[Tt+1],ot.vertexOffset+_t[Tt+2]),this.indexArray.emplaceBack(nt+_t[Tt],nt+_t[Tt+2],nt+_t[Tt+1]),ut.primitiveLength++;ot.indexCount+=_t.length,ot.vertexCount+=this.footprintVertices.length-ot.vertexOffset}for(let yt=0;yt<ke.length;yt++){const it=ke[yt];$.startRing(q,it[0]);let _t=it.length>4&&Qz(it[it.length-2],it[0],it[1]),Tt=Ee?_Q(it[it.length-2],it[0],it[1],Ee):0;const xt=[];let Ft,wt,Ct;wt=it[1].sub(it[0])._perp()._unit();let Jt=!0;for(let Kt=1,Ht=0;Kt<it.length;Kt++){let Et=it[Kt-1],tn=it[Kt];const xn=it[Kt===it.length-1?1:Kt+1];if($.appendEdge(q,tn,Et),jC(tn,Et,$e)){Ee&&(wt=xn.sub(tn)._perp()._unit(),Jt=!Jt);continue}const un=tn.sub(Et)._perp(),Tn=un.x/(Math.abs(un.x)+Math.abs(un.y)),bn=un.y>0?1:0,kn=Et.dist(tn);if(Ht+kn>32768&&(Ht=0),Ee){Ct=xn.sub(tn)._perp()._unit();let Qn=Yz(Et,tn,xn,Xz(wt,Ct),Ee);isNaN(Qn)&&(Qn=0);const Bn=tn.sub(Et)._unit();Et=Et.add(Bn.mult(Tt))._round(),tn=tn.add(Bn.mult(-Qn))._round(),Tt=Qn,wt=Ct,X&&this.zoom>=17&&(Ie(xt,Et)||xt.push(Et),Ie(xt,tn)||xt.push(tn))}const sn=ut.vertexLength,mr=it.length>4&&Qz(Et,tn,xn);let cr=Jz(Ht,_t,Jt);if(z_(this.layoutVertexArray,Et.x,Et.y,Tn,bn,0,0,cr),z_(this.layoutVertexArray,Et.x,Et.y,Tn,bn,0,1,cr),Ht+=kn,cr=Jz(Ht,mr,!Jt),_t=mr,z_(this.layoutVertexArray,tn.x,tn.y,Tn,bn,0,0,cr),z_(this.layoutVertexArray,tn.x,tn.y,Tn,bn,0,1,cr),ut.vertexLength+=4,this.indexArray.emplaceBack(sn+0,sn+1,sn+2),this.indexArray.emplaceBack(sn+1,sn+3,sn+2),ut.primitiveLength+=2,Ee){const Qn=nt+(Kt===1?it.length-2:Kt-2),Bn=Kt===1?nt:Qn+1;if(this.indexArray.emplaceBack(sn+1,Qn,sn+3),this.indexArray.emplaceBack(Qn,Bn,sn+3),ut.primitiveLength+=2,Ft===void 0&&(Ft=sn),!jC(xn,it[Kt],$e)){const Jn=Kt===it.length-1?Ft:ut.vertexLength;this.indexArray.emplaceBack(sn+2,sn+3,Jn),this.indexArray.emplaceBack(sn+3,Jn+1,Jn),this.indexArray.emplaceBack(sn+3,Bn,Jn+1),ut.primitiveLength+=3}Jt=!Jt}if(D){const Qn=this.layoutVertexExtArray,Bn=R.projectTilePoint(Et.x,Et.y,f),Jn=R.projectTilePoint(tn.x,tn.y,f),Ar=R.upVector(f,Et.x,Et.y),wr=R.upVector(f,tn.x,tn.y);F_(Qn,Bn,Ar),F_(Qn,Bn,Ar),F_(Qn,Jn,wr),F_(Qn,Jn,wr)}}B&&(nt+=it.length-1),X&&Ee&&this.zoom>=17&&(xt.length!==0&&Ie(xt,xt[0])&&xt.pop(),this.groundEffect.addData(xt,$e,E,Ee>0))}this.footprintSegments.push(ot),bt.triangleCount=this.indexArray.length-bt.triangleArrayOffset,this.polygonSegments.push(bt),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=$.borders?Vz:this.encodeCentroid($,q),this.centroidData.push(q),$.borders){this.featuresOnBorder.push($);const ke=this.featuresOnBorder.length-1;for(let $e=0;$e<$.borders.length;$e++)$.borders[$e][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[$e].push(ke)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,m,g,f,w),this.groundEffect.addPaintPropertiesData(r,c,m,g,f,w),this.maxHeight=Math.max(this.maxHeight,te)}}sortBorders(){for(let r=0;r<this.borderFeatureIndices.length;r++)this.borderFeatureIndices[r].sort((s,c)=>this.featuresOnBorder[s].borders[r][0]-this.featuresOnBorder[c].borders[r][0])}splitToSubtiles(){const r=[];for(let x=0;x<this.centroidData.length;x++){const w=this.centroidData[x],E=+(w.min.y+w.max.y>Mt),M=2*E+(+(w.min.x+w.max.x>Mt)^E);for(let R=0;R<w.polygonSegLen;R++){const D=w.polygonSegIdx+R;r.push({centroidIdx:x,subtile:M,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const s=new Pi;r.sort((x,w)=>x.triangleSegmentIdx===w.triangleSegmentIdx?x.subtile-w.subtile:x.triangleSegmentIdx-w.triangleSegmentIdx);let c=0,f=0,m=0;for(const x of r){if(x.triangleSegmentIdx!==c)break;m++}const g=r.length;for(;f!==r.length;){c=r[f].triangleSegmentIdx;let x=0,w=f,E=f;for(let M=w;M<m&&r[M].subtile===x;M++)E++;for(;w!==m;){const M=r[w];x=M.subtile;const R=this.centroidData[M.centroidIdx].min.clone(),D=this.centroidData[M.centroidIdx].max.clone(),B={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let $=w;$<E;$++){const q=r[$],X=this.polygonSegments[q.polygonSegmentIdx],te=this.centroidData[q.centroidIdx].min,ce=this.centroidData[q.centroidIdx].max,he=this.indexArray.uint16;for(let fe=X.triangleArrayOffset;fe<X.triangleArrayOffset+X.triangleCount;fe++)s.emplaceBack(he[3*fe],he[3*fe+1],he[3*fe+2]);B.primitiveLength+=X.triangleCount,R.x=Math.min(R.x,te.x),R.y=Math.min(R.y,te.y),D.x=Math.max(D.x,ce.x),D.y=Math.max(D.y,ce.y)}B.primitiveLength>0&&this.triangleSubSegments.push({segment:B,min:R,max:D}),w=E;for(let $=w;$<m&&r[$].subtile===r[w].subtile;$++)E++}f=m;for(let M=f;M<g&&r[M].triangleSegmentIdx===r[f].triangleSegmentIdx;M++)m++}s._trim(),this.indexArray=s}getVisibleSegments(r,s,c){let f=0,m=0;const g=1<<r.canonical.z;if(s){const q=s.getMinMaxForTile(r);q&&(f=q.min,m=q.max)}m+=this.maxHeight;const x=r.toUnwrapped();let w;const E=[x.canonical.x/g+x.wrap,x.canonical.y/g],M=[(x.canonical.x+1)/g+x.wrap,(x.canonical.y+1)/g],R=new Br,D=(q,X,te)=>[q[0]*(1-te[0])+X[0]*te[0],q[1]*(1-te[1])+X[1]*te[1]],B=[],$=[];for(const q of this.triangleSubSegments){B[0]=q.min.x/Mt,B[1]=q.min.y/Mt,$[0]=q.max.x/Mt,$[1]=q.max.y/Mt;const X=D(E,M,B),te=D(E,M,$);if(new jr([X[0],X[1],f],[te[0],te[1],m]).intersectsPrecise(c)===0){w&&(R.segments.push(w),w=void 0);continue}const ce=q.segment;w&&w.vertexOffset!==ce.vertexOffset&&(R.segments.push(w),w=void 0),w?(w.vertexLength+=ce.vertexLength,w.primitiveLength+=ce.primitiveLength):w={vertexOffset:ce.vertexOffset,primitiveLength:ce.primitiveLength,vertexLength:ce.vertexLength,primitiveOffset:ce.primitiveOffset,sortKey:void 0,vaos:{}}}return w&&R.segments.push(w),R}encodeCentroid(r,s){const c=r.centroid(),f=s.span(),m=Math.min(7,Math.round(f.x*this.tileToMeter/10)),g=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new Lt(Pn(c.x,1,Mt-1)<<3|m,Pn(c.y,1,Mt-1)<<3|g)}encodeBorderCentroid(r){if(!r.borders)return new Lt(0,0);const s=r.borders,c=Number.MAX_VALUE;if(s[0][0]!==c||s[1][0]!==c){const f=s[0][0]!==c?0:1;return new Lt(6|(s[0][0]!==c?0:65528),(s[f][0]+s[f][1])/2<<3|6)}{const f=s[2][0]!==c?2:3;return new Lt((s[f][0]+s[f][1])/2<<3|6,6|(s[2][0]!==c?0:65528))}}showCentroid(r){const s=this.centroidData[r.centroidDataIndex];s.flags&=Yc,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(r){this.groundEffect.updateHiddenByLandmark(r);const s=r.vertexArrayOffset,c=r.vertexCount+r.vertexArrayOffset,f=r.flags&Yc?Vz:r.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==f.y||m!==f.x){for(let g=s;g<c;++g)this.centroidVertexArray.emplace(g,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const r of this.centroidData)this.writeCentroidToBuffer(r)}updateReplacement(r,s,c){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const f=s.getReplacementRegionsForTile(r.toUnwrapped());if(BC(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const m=[];for(const g of this.activeReplacements){if(g.order<c)continue;const x=Math.pow(2,g.footprintTileId.canonical.z-r.canonical.z);for(const w of this.centroidData)if(!(w.flags&Yc||g.min.x>w.max.x||w.min.x>g.max.x||g.min.y>w.max.y||w.min.y>g.max.y))for(let E=0;E<w.footprintSegLen;E++){const M=this.footprintSegments[w.footprintSegIdx+E];if(m.length=0,vQ(this.footprintVertices,M.vertexOffset,M.vertexCount,g.footprintTileId.canonical,r.canonical,m),Oz(g.footprint,m,this.footprintIndices.uint16,M.indexOffset,M.indexCount,-M.vertexOffset,-x)){w.flags|=Yc;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(r,s,c){let f=!1;for(let m=0;m<c.footprintSegLen;m++){const g=this.footprintSegments[c.footprintSegIdx+m];let x=0;for(const w of g.ringIndices){for(let E=x,M=w+x-1;E<w+x;M=E++){const R=this.footprintVertices.int16[2*(E+g.vertexOffset)+0],D=this.footprintVertices.int16[2*(E+g.vertexOffset)+1],B=this.footprintVertices.int16[2*(M+g.vertexOffset)+1];D>s!=B>s&&r<(this.footprintVertices.int16[2*(M+g.vertexOffset)+0]-R)*(s-D)/(B-D)+R&&(f=!f)}x=w}}return f}getHeightAtTileCoord(r,s){let c=Number.NEGATIVE_INFINITY,f=!0;const m=4*(r+Mt)*Mt+(s+Mt);if(this.partLookup.hasOwnProperty(m)){const g=this.partLookup[m];return g?{height:g.height,hidden:!!(g.flags&Yc)}:void 0}for(const g of this.centroidData)r>g.max.x||g.min.x>r||s>g.max.y||g.min.y>s||this.footprintContainsPoint(r,s,g)&&g&&g.height>c&&(c=g.height,this.partLookup[m]=g,f=!!(g.flags&Yc));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:f};this.partLookup[m]=void 0}}function Xz(i,r){const s=i.add(r)._unit();return i.x*s.x+i.y*s.y}function _Q(i,r,s,c){const f=r.sub(i)._perp()._unit(),m=s.sub(r)._perp()._unit();return Yz(i,r,s,Xz(f,m),c)}function Yz(i,r,s,c,f){const m=Math.sqrt(1-c*c);return Math.min(i.dist(r)/3,r.dist(s)/3,f*m/c)}function jC(i,r,s){return i.x<s[0].x&&r.x<s[0].x||i.x>s[1].x&&r.x>s[1].x||i.y<s[0].y&&r.y<s[0].y||i.y>s[1].y&&r.y>s[1].y}function Kz(i,r){return i.x<r[0].x||i.x>r[1].x||i.y<r[0].y||i.y>r[1].y}function Qz(i,r,s){if(i.x<0||i.x>=Mt||r.x<0||r.x>=Mt||s.x<0||s.x>=Mt)return!1;const c=s.sub(r),f=c.perp(),m=i.sub(r);return(c.x*m.x+c.y*m.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(m.x*m.x+m.y*m.y))>-.866&&f.x*m.x+f.y*m.y<0}function Jz(i,r,s){const c=r?2|i:-3&i;return s?1|c:-2&c}function eF(){const i=Math.PI/32,r=Math.tan(i),s=Xp;return s*Math.sqrt(1+2*r*r)-s}function tF(i,r,s){const c=1<<s.z,f=Go(s.x/c),m=Go((s.x+1)/c),g=Fi(s.y/c),x=Fi((s.y+1)/c);return function(w,E,M,R,D=0,B){const $=[];if(!w.length||!M||!R)return $;const q=(we,Ie)=>{for(const ke of we)$.push({polygon:ke,bounds:Ie})},X=Math.ceil(Math.log2(M)),te=Math.ceil(Math.log2(R)),ce=X-te,he=[];for(let we=0;we<Math.abs(ce);we++)he.push(ce>0?0:1);for(let we=0;we<Math.min(X,te);we++)he.push(0),he.push(1);let fe=w;if(fe=sb(fe,E[0].y-D,E[1].y+D,1),fe=sb(fe,E[0].x-D,E[1].x+D,0),!fe.length)return $;const Ee=[];for(he.length?Ee.push({polygons:fe,bounds:E,depth:0}):q(fe,E);Ee.length;){const we=Ee.pop(),Ie=we.depth,ke=he[Ie],$e=we.bounds[0],nt=we.bounds[1],He=ke===0?$e.x:$e.y,ut=ke===0?nt.x:nt.y,bt=B?B(ke,He,ut):.5*(He+ut),ot=sb(we.polygons,He-D,bt+D,ke),yt=sb(we.polygons,bt-D,ut+D,ke);if(ot.length){const it=[$e,new Lt(ke===0?bt:nt.x,ke===1?bt:nt.y)];he.length>Ie+1?Ee.push({polygons:ot,bounds:it,depth:Ie+1}):q(ot,it)}if(yt.length){const it=[new Lt(ke===0?bt:$e.x,ke===1?bt:$e.y),nt];he.length>Ie+1?Ee.push({polygons:yt,bounds:it,depth:Ie+1}):q(yt,it)}}return $}(i,r,Math.ceil((m-f)/11.25),Math.ceil((g-x)/11.25),1,(w,E,M)=>{if(w===0)return .5*(E+M);{const R=Fi((s.y+E/Mt)/c);return(El(.5*(Fi((s.y+M/Mt)/c)+R))*c-s.y)*Mt}})}function vQ(i,r,s,c,f,m){const g=Math.pow(2,c.z-f.z);for(let x=0;x<s;x++){let w=i.int16[2*(x+r)+0],E=i.int16[2*(x+r)+1];w=(w+f.x*Mt)*g-c.x*Mt,E=(E+f.y*Mt)*g-c.y*Mt,m.push(new Lt(w,E))}}pe(hb,"FillExtrusionBucket",{omit:["layers","features"]}),pe(Wz,"PartData"),pe(Gz,"FootprintSegment"),pe(Hz,"BorderCentroidData"),pe(Zz,"GroundEffect");const xQ=new nr({visibility:new pt(Ve["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new pt(Ve["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var bQ={paint:new nr({"fill-extrusion-opacity":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zt(Ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zt(Ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zt(Ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zt(Ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new zt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new zt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new pt(Ve["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:xQ};function N_(i,r){return i.x*r.x+i.y*r.y}function nF(i,r){if(i.length===1){let s=0;const c=r[s++];let f;for(;!f||c.equals(f);)if(f=r[s++],!f)return 1/0;for(;s<r.length;s++){const m=r[s],g=i[0],x=f.sub(c),w=m.sub(c),E=g.sub(c),M=N_(x,x),R=N_(x,w),D=N_(w,w),B=N_(E,x),$=N_(E,w),q=M*D-R*R,X=(D*B-R*$)/q,te=(M*$-R*B)/q,ce=c.z*(1-X-te)+f.z*X+m.z*te;if(isFinite(ce))return ce}return 1/0}{let s=1/0;for(const c of r)s=Math.min(s,c.z);return s}}function rF(i,r,s,c,f,m,g,x){const w=g*f.getElevationAt(i,r,!0,!0),E=m[0]!==0,M=E?m[1]===0?g*(m[0]/7-450):g*function(R,D,B){const $=Math.floor(D[0]/8),q=Math.floor(D[1]/8),X=10*(D[0]-8*$),te=10*(D[1]-8*q),ce=R.getElevationAt($,q,!0,!0),he=R.getMeterToDEM(B),fe=Math.floor(.5*(X*he-1)),Ee=Math.floor(.5*(te*he-1)),we=R.tileCoordToPixel($,q),Ie=2*fe+1,ke=2*Ee+1,$e=function(yt,it,_t,Tt,xt){return[yt.getElevationAtPixel(it,_t,!0),yt.getElevationAtPixel(it+xt,_t,!0),yt.getElevationAtPixel(it,_t+xt,!0),yt.getElevationAtPixel(it+Tt,_t+xt,!0)]}(R,we.x-fe,we.y-Ee,Ie,ke),nt=Math.abs($e[0]-$e[1]),He=Math.abs($e[2]-$e[3]),ut=Math.abs($e[0]-$e[2])+Math.abs($e[1]-$e[3]),bt=Math.min(.25,.5*he*(nt+He)/Ie),ot=Math.min(.25,.5*he*ut/ke);return ce+Math.max(bt*X,ot*te)}(f,m,x):w;return{base:w+(s===0)?-1:s,top:E?Math.max(M+c,w+s+2):w+c}}const wQ=rr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:SQ}=wQ,TQ=rr([{name:"a_packed",components:4,type:"Float32"}]),{members:EQ}=TQ,AQ=rr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:CQ}=AQ,PQ=rr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),MQ=rr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),IQ=rr([{name:"a_projected_pos",components:4,type:"Float32"}],4);rr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $C=rr([{name:"a_occlusion_query_opacity",components:1,type:"Float32"}],4),iF=rr([{name:"a_z_offset",components:1,type:"Float32"}],4),OQ=rr([{name:"a_texb",components:2,type:"Uint16"}]),RQ=rr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),kQ=rr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);rr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const oF=rr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),DQ=rr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);rr([{name:"triangle",components:3,type:"Uint16"}]),rr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),rr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Float32",name:"occlusionState"},{type:"Float32",name:"occlusionOpacity"},{type:"Uint8",name:"hasIconTextFit"}]),rr([{type:"Float32",name:"offsetX"}]),rr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class aF{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.image=new Zc({width:r,height:s}),this.positions={},this.uploaded=!1}getDash(r,s){const c=this.getKey(r,s);return this.positions[c]}trim(){const r=this.width,s=this.height=Ey(this.nextRow);this.image.resize({width:r,height:s})}getKey(r,s){return r.join(",")+s}getDashRanges(r,s,c){const f=[];let m=r.length%2==1?-r[r.length-1]*c:0,g=r[0]*c,x=!0;f.push({left:m,right:g,isDash:x,zeroLength:r[0]===0});let w=r[0];for(let E=1;E<r.length;E++){x=!x;const M=r[E];m=w*c,w+=M,g=w*c,f.push({left:m,right:g,isDash:x,zeroLength:M===0})}return f}addRoundDash(r,s,c){const f=s/2;for(let m=-c;m<=c;m++){const g=this.width*(this.nextRow+c+m);let x=0,w=r[x];for(let E=0;E<this.width;E++){E/w.right>1&&(w=r[++x]);const M=Math.abs(E-w.left),R=Math.abs(E-w.right),D=Math.min(M,R);let B;const $=m/c*(f+1);if(w.isDash){const q=f-Math.abs($);B=Math.sqrt(D*D+q*q)}else B=f-Math.sqrt(D*D+$*$);this.image.data[g+E]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(r,s){for(let w=r.length-1;w>=0;--w){const E=r[w],M=r[w+1];E.zeroLength?r.splice(w,1):M&&M.isDash===E.isDash&&(M.left=E.left,r.splice(w,1))}const c=r[0],f=r[r.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const m=this.width*this.nextRow;let g=0,x=r[g];for(let w=0;w<this.width;w++){w/x.right>1&&(x=r[++g]);const E=Math.abs(w-x.left),M=Math.abs(w-x.right),R=Math.min(E,M);this.image.data[m+w]=Math.max(0,Math.min(255,(x.isDash?R:-R)+s+128))}}addDash(r,s){const c=this.getKey(r,s);if(this.positions[c])return this.positions[c];const f=s==="round",m=f?7:0,g=2*m+1;if(this.nextRow+g>this.height)return Qr("LineAtlas out of space"),null;r.length===0&&r.push(1);let x=0;for(let M=0;M<r.length;M++)r[M]<0&&(Qr("Negative value is found in line dasharray, replacing values with 0"),r[M]=0),x+=r[M];if(x!==0){const M=this.width/x,R=this.getDashRanges(r,this.width,M);f?this.addRoundDash(R,M,m):this.addRegularDash(R,s==="square"?.5*M:0)}const w=this.nextRow+m;this.nextRow+=g;const E={tl:[w,m],br:[x,0]};return this.positions[c]=E,E}}pe(aF,"LineAtlas");const LQ=ab.types,zQ=Math.cos(Math.PI/180*37.5),FQ=Math.cos(Math.PI/180*5);class fb{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new WA,this.layoutVertexArray2=new jc,this.patternVertexArray=new $c,this.indexArray=new Pi,this.programConfigurations=new Wc(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new Br,this.maxLineLength=0,this.zOffsetVertexArray=new Vf,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=r.tessellationStep?r.tessellationStep:Mt/64}updateFootprints(r,s){}populate(r,s,c,f){this.hasPattern=DC("line",this.layers,s);const m=this.layers[0].layout.get("line-sort-key"),g=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!g.isConstant()||!!g.constantOr(0);const x=[];for(const{feature:R,id:D,index:B,sourceLayerIndex:$}of r){const q=this.layers[0]._featureFilter.needGeometry,X=_u(R,q);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),X,c))continue;const te=m?m.evaluate(X,{},c):void 0,ce={id:D,properties:R.properties,type:R.type,sourceLayerIndex:$,index:B,geometry:q?X.geometry:Fs(R,c,f),patterns:{},sortKey:te};x.push(ce)}m&&x.sort((R,D)=>R.sortKey-D.sortKey);const{lineAtlas:w,featureIndex:E}=s,M=this.addConstantDashes(w);for(const R of x){const{geometry:D,index:B,sourceLayerIndex:$}=R;if(M&&this.addFeatureDashes(R,w),this.hasPattern){const q=LC("line",this.layers,R,this.zoom,s);this.patternFeatures.push(q)}else this.addFeature(R,D,B,c,w.positions,s.availableImages,s.brightness);E.insert(r[B].feature,D,B,$,this.index)}}addConstantDashes(r){let s=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,m=c.layout.get("line-cap").value;if(f.kind!=="constant"||m.kind!=="constant")s=!0;else{const g=m.value,x=f.value;if(!x)continue;r.addDash(x,g)}}return s}addFeatureDashes(r,s){const c=this.zoom;for(const f of this.layers){const m=f.paint.get("line-dasharray").value,g=f.layout.get("line-cap").value;if(m.kind==="constant"&&g.kind==="constant")continue;let x,w;if(m.kind==="constant"){if(x=m.value,!x)continue}else x=m.evaluate({zoom:c},r);w=g.kind==="constant"?g.value:g.evaluate({zoom:c},r),s.addDash(x,w),r.patterns[f.id]=s.getKey(x,w)}}update(r,s,c,f,m){const g=Object.keys(r).length!==0;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,s,g?this.stateDependentLayers:this.layers,c,f,m)}addFeatures(r,s,c,f,m,g){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,c,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,EQ)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=r.createVertexBuffer(this.patternVertexArray,CQ)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,iF.members,!0)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,SQ),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,c,f,m,g,x){const w=this.layers[0].layout,E=w.get("line-join").evaluate(r,{}),M=w.get("line-cap").evaluate(r,{}),R=w.get("line-miter-limit"),D=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const B of s)this.addLine(B,r,f,E,M,R,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,m,g,f,x)}addLine(r,s,c,f,m,g,x){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const w={zoom:this.zoom,lineProgress:void 0},E=this.layers[0].layout,M=f==="none";if(this.patternJoinNone=this.hasPattern&&M,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<r.length-1;we++)this.totalDistance+=r[we].dist(r[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=LQ[s.type]==="Polygon";let D=r.length;for(;D>=2&&r[D-1].equals(r[D-2]);)D--;let B=0;for(;B<D-1&&r[B].equals(r[B+1]);)B++;if(D<(R?3:2))return;f==="bevel"&&(g=1.05);const $=this.overscaling<=16?15*Mt/(512*this.overscaling):0,q=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let X,te,ce,he,fe,Ee;this.e1=this.e2=-1,R&&(X=r[D-2],fe=r[B].sub(X)._unit()._perp());for(let we=B;we<D;we++){if(ce=we===D-1?R?r[B+1]:void 0:r[we+1],ce&&r[we].equals(ce))continue;if(fe&&(he=fe),X&&(te=X),X=r[we],this.hasZOffset){const it=E.get("line-z-offset").value;if(it.kind==="constant")Ee=it.value;else{if(this.lineClips){const _t=this.totalDistance/(this.lineClips.end-this.lineClips.start);w.lineProgress=(_t*this.lineClips.start+this.distance+(te?te.dist(X):0))/_t}else Qr(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),w.lineProgress=0;Ee=it.evaluate(w,s)}Ee=Ee||0}fe=ce?ce.sub(X)._unit()._perp():he,he=he||fe;const Ie=te&&ce;let ke=Ie?f:R||M?"butt":m;const $e=he.x*fe.x+he.y*fe.y;if(M){const it=function(_t){if(_t.patternJoinNone){const Tt=_t.segmentPoints.length/2,xt=_t.lineSoFar-_t.segmentStart;for(let Ft=0;Ft<Tt;++Ft){const wt=_t.segmentPoints[2*Ft+1],Ct=Math.round(_t.segmentPoints[2*Ft])+.5+.25*wt;_t.patternVertexArray.emplaceBack(Ct,xt,_t.segmentStart),_t.patternVertexArray.emplaceBack(Ct,xt,_t.segmentStart)}_t.segmentPoints.length=0}_t.e1=_t.e2=-1};if(Ie&&$e<FQ){this.updateDistance(te,X),this.addCurrentVertex(X,he,1,1,q,Ee),it(this),this.addCurrentVertex(X,fe,-1,-1,q,Ee);continue}if(te){if(!ce){this.updateDistance(te,X),this.addCurrentVertex(X,he,1,1,q,Ee),it(this);continue}ke="miter"}}let nt=he.add(fe);nt.x===0&&nt.y===0||nt._unit();const He=nt.x*fe.x+nt.y*fe.y,ut=He!==0?1/He:1/0,bt=2*Math.sqrt(2-2*He),ot=He<zQ&&te&&ce,yt=he.x*fe.y-he.y*fe.x>0;if(ot&&we>B){const it=X.dist(te);if(it>2*$){const _t=X.sub(X.sub(te)._mult($/it)._round());this.updateDistance(te,_t),this.addCurrentVertex(_t,he,0,0,q,Ee),te=_t}}if(Ie&&ke==="round"&&(ut<x?ke="miter":ut<=2&&(ke="fakeround")),ke==="miter"&&ut>g&&(ke="bevel"),ke==="bevel"&&(ut>2&&(ke="flipbevel"),ut<g&&(ke="miter")),te&&this.updateDistance(te,X),ke==="miter")nt._mult(ut),this.addCurrentVertex(X,nt,0,0,q,Ee);else if(ke==="flipbevel"){if(ut>100)nt=fe.mult(-1);else{const it=ut*he.add(fe).mag()/he.sub(fe).mag();nt._perp()._mult(it*(yt?-1:1))}this.addCurrentVertex(X,nt,0,0,q,Ee),this.addCurrentVertex(X,nt.mult(-1),0,0,q,Ee)}else if(ke==="bevel"||ke==="fakeround"){const it=-Math.sqrt(ut*ut-1),_t=yt?it:0,Tt=yt?0:it;if(te&&this.addCurrentVertex(X,he,_t,Tt,q,Ee),ke==="fakeround"){const xt=Math.round(180*bt/Math.PI/20);for(let Ft=1;Ft<xt;Ft++){let wt=Ft/xt;if(wt!==.5){const Jt=wt-.5;wt+=wt*Jt*(wt-1)*((1.0904+$e*($e*(3.55645-1.43519*$e)-3.2452))*Jt*Jt+(.848013+$e*(.215638*$e-1.06021)))}const Ct=fe.sub(he)._mult(wt)._add(he)._unit()._mult(yt?-1:1);this.addHalfVertex(X,Ct.x,Ct.y,!1,yt,0,q,Ee)}}ce&&this.addCurrentVertex(X,fe,-_t,-Tt,q,Ee)}else ke==="butt"?this.addCurrentVertex(X,nt,0,0,q,Ee):ke==="square"?(te||this.addCurrentVertex(X,nt,-1,-1,q,Ee),this.addCurrentVertex(X,nt,0,0,q,Ee),te&&this.addCurrentVertex(X,nt,1,1,q,Ee)):ke==="round"&&(te&&(this.addCurrentVertex(X,he,0,0,q,Ee),this.addCurrentVertex(X,he,1,1,q,Ee,!0)),ce&&(this.addCurrentVertex(X,fe,-1,-1,q,Ee,!0),this.addCurrentVertex(X,fe,0,0,q,Ee)));if(ot&&we<D-1){const it=X.dist(ce);if(it>2*$){const _t=X.add(ce.sub(X)._mult($/it)._round());this.updateDistance(X,_t),this.addCurrentVertex(_t,fe,0,0,q,Ee),X=_t}}}}addVerticesTo(r,s,c,f,m,g,x,w,E,M){const R=(s.w-r.w)/this.tessellationStep|0;if(R>1){this.lineSoFar=r.w;const D=(s.x-r.x)/R,B=(s.y-r.y)/R,$=(s.z-r.z)/R,q=(s.w-r.w)/R;for(let X=1;X<R;++X)r.x+=D,r.y+=B,r.z+=$,this.lineSoFar+=q,this.addHalfVertex(r,c,f,M,!1,x,E,r.z),this.addHalfVertex(r,m,g,M,!0,-w,E,r.z)}this.lineSoFar=s.w,this.addHalfVertex(s,c,f,M,!1,x,E,s.z),this.addHalfVertex(s,m,g,M,!0,-w,E,s.z)}addCurrentVertex(r,s,c,f,m,g,x=!1){const w=s.x+s.y*c,E=s.y-s.x*c,M=s.y*f-s.x,R=-s.y-s.x*f;if(g!=null){const B=Mt+10,$=g,q=new Az(r.x,r.y,$,this.lineSoFar),X=sF(r,-10,B),te=this.lineSoFar;if(this.currentVertex)if(X){const ce=this.currentVertexIsOutside,he=this.currentVertex,fe=new Az(r.x,r.y,$,this.lineSoFar);Pz(he,fe,-10,B),sF(fe,-10,B)||(ce&&(this.e1=this.e2=-1,this.lineSoFar=he.w,this.addHalfVertex(he,w,E,x,!1,c,m,he.z),this.addHalfVertex(he,M,R,x,!0,-f,m,he.z)),this.addVerticesTo(he,fe,w,E,M,R,c,f,m,x))}else{const ce=this.currentVertex;this.currentVertexIsOutside&&(Pz(ce,q,-10,B),this.e1=this.e2=-1,this.lineSoFar=ce.w,this.addHalfVertex(ce,w,E,x,!1,c,m,ce.z),this.addHalfVertex(ce,M,R,x,!0,-f,m,ce.z)),this.addVerticesTo(ce,q,w,E,M,R,c,f,m,x)}else X||(this.addHalfVertex(r,w,E,x,!1,c,m,g),this.addHalfVertex(r,M,R,x,!0,-f,m,g));this.currentVertex=q,this.currentVertexIsOutside=X,this.lineSoFar=te}else this.addHalfVertex(r,w,E,x,!1,c,m,g),this.addHalfVertex(r,M,R,x,!0,-f,m,g)}addHalfVertex({x:r,y:s},c,f,m,g,x,w,E){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,x)),this.layoutVertexArray.emplaceBack((r<<1)+(m?1:0),(s<<1)+(g?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),w.primitiveLength++),g?this.e2=M:this.e1=M,E!=null&&this.zOffsetVertexArray.emplaceBack(E)}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}}function sF(i,r,s){return i.x<r||i.x>s||i.y<r||i.y>s}pe(fb,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const NQ=new nr({"line-cap":new zt(Ve.layout_line["line-cap"]),"line-join":new zt(Ve.layout_line["line-join"]),"line-miter-limit":new pt(Ve.layout_line["line-miter-limit"]),"line-round-limit":new pt(Ve.layout_line["line-round-limit"]),"line-sort-key":new zt(Ve.layout_line["line-sort-key"]),"line-z-offset":new zt(Ve.layout_line["line-z-offset"]),visibility:new pt(Ve.layout_line.visibility)});var db={paint:new nr({"line-opacity":new zt(Ve.paint_line["line-opacity"]),"line-color":new zt(Ve.paint_line["line-color"]),"line-translate":new pt(Ve.paint_line["line-translate"]),"line-translate-anchor":new pt(Ve.paint_line["line-translate-anchor"]),"line-width":new zt(Ve.paint_line["line-width"]),"line-gap-width":new zt(Ve.paint_line["line-gap-width"]),"line-offset":new zt(Ve.paint_line["line-offset"]),"line-blur":new zt(Ve.paint_line["line-blur"]),"line-dasharray":new zt(Ve.paint_line["line-dasharray"]),"line-pattern":new zt(Ve.paint_line["line-pattern"]),"line-gradient":new Nr(Ve.paint_line["line-gradient"]),"line-trim-offset":new pt(Ve.paint_line["line-trim-offset"]),"line-trim-fade-range":new pt(Ve.paint_line["line-trim-fade-range"]),"line-trim-color":new pt(Ve.paint_line["line-trim-color"]),"line-emissive-strength":new pt(Ve.paint_line["line-emissive-strength"]),"line-border-width":new zt(Ve.paint_line["line-border-width"]),"line-border-color":new zt(Ve.paint_line["line-border-color"]),"line-occlusion-opacity":new pt(Ve.paint_line["line-occlusion-opacity"])}),layout:NQ};function lF(i,r,s){return r*(Mt/(i.tileSize*Math.pow(2,s-i.tileID.overscaledZ)))}function uF(i,r){return 1/lF(i,1,r.tileZoom)}function cF(i,r,s,c){return i.translatePosMatrix(c||r.tileID.projMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const hF=i=>{const r=[];fF(i)&&r.push("RENDER_LINE_DASH"),i.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT");const s=i.paint.get("line-trim-offset");s[0]===0&&s[1]===0||r.push("RENDER_LINE_TRIM_OFFSET"),i.paint.get("line-border-width").constantOr(1)!==0&&r.push("RENDER_LINE_BORDER");const c=i.layout.get("line-join").constantOr("miter")==="none",f=!!i.paint.get("line-pattern").constantOr(1);return c&&f&&r.push("LINE_JOIN_NONE"),r};function fF(i){const r=i.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}class dF{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const c=r[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}var BQ={read:function(i,r,s,c,f){var m,g,x=8*f-c-1,w=(1<<x)-1,E=w>>1,M=-7,R=s?f-1:0,D=s?-1:1,B=i[r+R];for(R+=D,m=B&(1<<-M)-1,B>>=-M,M+=x;M>0;m=256*m+i[r+R],R+=D,M-=8);for(g=m&(1<<-M)-1,m>>=-M,M+=c;M>0;g=256*g+i[r+R],R+=D,M-=8);if(m===0)m=1-E;else{if(m===w)return g?NaN:1/0*(B?-1:1);g+=Math.pow(2,c),m-=E}return(B?-1:1)*g*Math.pow(2,m-c)},write:function(i,r,s,c,f,m){var g,x,w,E=8*m-f-1,M=(1<<E)-1,R=M>>1,D=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=c?0:m-1,$=c?1:-1,q=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(x=isNaN(r)?1:0,g=M):(g=Math.floor(Math.log(r)/Math.LN2),r*(w=Math.pow(2,-g))<1&&(g--,w*=2),(r+=g+R>=1?D/w:D*Math.pow(2,1-R))*w>=2&&(g++,w/=2),g+R>=M?(x=0,g=M):g+R>=1?(x=(r*w-1)*Math.pow(2,f),g+=R):(x=r*Math.pow(2,R-1)*Math.pow(2,f),g=0));f>=8;i[s+B]=255&x,B+=$,x/=256,f-=8);for(g=g<<f|x,E+=f;E>0;i[s+B]=255&g,B+=$,g/=256,E-=8);i[s+B-$]|=128*q}},pF=Dr,pb=BQ;function Dr(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Dr.Varint=0,Dr.Fixed64=1,Dr.Bytes=2,Dr.Fixed32=5;var UC=4294967296,mF=1/UC,gF=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function bu(i){return i.type===Dr.Bytes?i.readVarint()+i.pos:i.pos+1}function tm(i,r,s){return s?4294967296*r+(i>>>0):4294967296*(r>>>0)+(i>>>0)}function yF(i,r,s){var c=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(c);for(var f=s.pos-1;f>=i;f--)s.buf[f+c]=s.buf[f]}function jQ(i,r){for(var s=0;s<i.length;s++)r.writeVarint(i[s])}function $Q(i,r){for(var s=0;s<i.length;s++)r.writeSVarint(i[s])}function UQ(i,r){for(var s=0;s<i.length;s++)r.writeFloat(i[s])}function VQ(i,r){for(var s=0;s<i.length;s++)r.writeDouble(i[s])}function GQ(i,r){for(var s=0;s<i.length;s++)r.writeBoolean(i[s])}function WQ(i,r){for(var s=0;s<i.length;s++)r.writeFixed32(i[s])}function HQ(i,r){for(var s=0;s<i.length;s++)r.writeSFixed32(i[s])}function qQ(i,r){for(var s=0;s<i.length;s++)r.writeFixed64(i[s])}function ZQ(i,r){for(var s=0;s<i.length;s++)r.writeSFixed64(i[s])}function mb(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+16777216*i[r+3]}function nm(i,r,s){i[s]=r,i[s+1]=r>>>8,i[s+2]=r>>>16,i[s+3]=r>>>24}function _F(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+(i[r+3]<<24)}Dr.prototype={destroy:function(){this.buf=null},readFields:function(i,r,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),f=c>>3,m=this.pos;this.type=7&c,i(f,r,this),this.pos===m&&this.skip(c)}return r},readMessage:function(i,r){return this.readFields(i,r,this.readVarint()+this.pos)},readFixed32:function(){var i=mb(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=_F(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=mb(this.buf,this.pos)+mb(this.buf,this.pos+4)*UC;return this.pos+=8,i},readSFixed64:function(){var i=mb(this.buf,this.pos)+_F(this.buf,this.pos+4)*UC;return this.pos+=8,i},readFloat:function(){var i=pb.read(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=pb.read(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var r,s,c=this.buf;return r=127&(s=c[this.pos++]),s<128?r:(r|=(127&(s=c[this.pos++]))<<7,s<128?r:(r|=(127&(s=c[this.pos++]))<<14,s<128?r:(r|=(127&(s=c[this.pos++]))<<21,s<128?r:function(f,m,g){var x,w,E=g.buf;if(x=(112&(w=E[g.pos++]))>>4,w<128||(x|=(127&(w=E[g.pos++]))<<3,w<128)||(x|=(127&(w=E[g.pos++]))<<10,w<128)||(x|=(127&(w=E[g.pos++]))<<17,w<128)||(x|=(127&(w=E[g.pos++]))<<24,w<128)||(x|=(1&(w=E[g.pos++]))<<31,w<128))return tm(f,x,m);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(s=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,r=this.pos;return this.pos=i,i-r>=12&&gF?function(s,c,f){return gF.decode(s.subarray(c,f))}(this.buf,r,i):function(s,c,f){for(var m="",g=c;g<f;){var x,w,E,M=s[g],R=null,D=M>239?4:M>223?3:M>191?2:1;if(g+D>f)break;D===1?M<128&&(R=M):D===2?(192&(x=s[g+1]))==128&&(R=(31&M)<<6|63&x)<=127&&(R=null):D===3?(w=s[g+2],(192&(x=s[g+1]))==128&&(192&w)==128&&((R=(15&M)<<12|(63&x)<<6|63&w)<=2047||R>=55296&&R<=57343)&&(R=null)):D===4&&(w=s[g+2],E=s[g+3],(192&(x=s[g+1]))==128&&(192&w)==128&&(192&E)==128&&((R=(15&M)<<18|(63&x)<<12|(63&w)<<6|63&E)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,D=1):R>65535&&(R-=65536,m+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),m+=String.fromCharCode(R),g+=D}return m}(this.buf,r,i)},readBytes:function(){var i=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,i);return this.pos=i,r},readPackedVarint:function(i,r){if(this.type!==Dr.Bytes)return i.push(this.readVarint(r));var s=bu(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(r));return i},readPackedSVarint:function(i){if(this.type!==Dr.Bytes)return i.push(this.readSVarint());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Dr.Bytes)return i.push(this.readBoolean());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Dr.Bytes)return i.push(this.readFloat());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Dr.Bytes)return i.push(this.readDouble());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Dr.Bytes)return i.push(this.readFixed32());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Dr.Bytes)return i.push(this.readSFixed32());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Dr.Bytes)return i.push(this.readFixed64());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Dr.Bytes)return i.push(this.readSFixed64());var r=bu(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed64());return i},skip:function(i){var r=7&i;if(r===Dr.Varint)for(;this.buf[this.pos++]>127;);else if(r===Dr.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Dr.Fixed32)this.pos+=4;else{if(r!==Dr.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(i,r){this.writeVarint(i<<3|r)},realloc:function(i){for(var r=this.length||16;r<this.pos+i;)r*=2;if(r!==this.length){var s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),nm(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),nm(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),nm(this.buf,-1&i,this.pos),nm(this.buf,Math.floor(i*mF),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),nm(this.buf,-1&i,this.pos),nm(this.buf,Math.floor(i*mF),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(r,s){var c,f;if(r>=0?(c=r%4294967296|0,f=r/4294967296|0):(f=~(-r/4294967296),4294967295^(c=~(-r%4294967296))?c=c+1|0:(c=0,f=f+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(m,g,x){x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,x.buf[x.pos]=127&(m>>>=7)}(c,0,s),function(m,g){var x=(7&m)<<4;g.buf[g.pos++]|=x|((m>>>=3)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m)))))}(f,s)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var r=this.pos;this.pos=function(c,f,m){for(var g,x,w=0;w<f.length;w++){if((g=f.charCodeAt(w))>55295&&g<57344){if(!x){g>56319||w+1===f.length?(c[m++]=239,c[m++]=191,c[m++]=189):x=g;continue}if(g<56320){c[m++]=239,c[m++]=191,c[m++]=189,x=g;continue}g=x-55296<<10|g-56320|65536,x=null}else x&&(c[m++]=239,c[m++]=191,c[m++]=189,x=null);g<128?c[m++]=g:(g<2048?c[m++]=g>>6|192:(g<65536?c[m++]=g>>12|224:(c[m++]=g>>18|240,c[m++]=g>>12&63|128),c[m++]=g>>6&63|128),c[m++]=63&g|128)}return m}(this.buf,i,this.pos);var s=this.pos-r;s>=128&&yF(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),pb.write(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),pb.write(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var r=i.length;this.writeVarint(r),this.realloc(r);for(var s=0;s<r;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,r){this.pos++;var s=this.pos;i(r,this);var c=this.pos-s;c>=128&&yF(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,r,s){this.writeTag(i,Dr.Bytes),this.writeRawMessage(r,s)},writePackedVarint:function(i,r){r.length&&this.writeMessage(i,jQ,r)},writePackedSVarint:function(i,r){r.length&&this.writeMessage(i,$Q,r)},writePackedBoolean:function(i,r){r.length&&this.writeMessage(i,GQ,r)},writePackedFloat:function(i,r){r.length&&this.writeMessage(i,UQ,r)},writePackedDouble:function(i,r){r.length&&this.writeMessage(i,VQ,r)},writePackedFixed32:function(i,r){r.length&&this.writeMessage(i,WQ,r)},writePackedSFixed32:function(i,r){r.length&&this.writeMessage(i,HQ,r)},writePackedFixed64:function(i,r){r.length&&this.writeMessage(i,qQ,r)},writePackedSFixed64:function(i,r){r.length&&this.writeMessage(i,ZQ,r)},writeBytesField:function(i,r){this.writeTag(i,Dr.Bytes),this.writeBytes(r)},writeFixed32Field:function(i,r){this.writeTag(i,Dr.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(i,r){this.writeTag(i,Dr.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(i,r){this.writeTag(i,Dr.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(i,r){this.writeTag(i,Dr.Fixed64),this.writeSFixed64(r)},writeVarintField:function(i,r){this.writeTag(i,Dr.Varint),this.writeVarint(r)},writeSVarintField:function(i,r){this.writeTag(i,Dr.Varint),this.writeSVarint(r)},writeStringField:function(i,r){this.writeTag(i,Dr.Bytes),this.writeString(r)},writeFloatField:function(i,r){this.writeTag(i,Dr.Fixed32),this.writeFloat(r)},writeDoubleField:function(i,r){this.writeTag(i,Dr.Fixed64),this.writeDouble(r)},writeBooleanField:function(i,r){this.writeVarintField(i,!!r)}};var rm=Y(pF);const XQ=["id","tile","layer","source","sourceLayer","state"];class vF{constructor(r,s,c,f,m){this.type="Feature",this._vectorTileFeature=r,this._z=s,this._x=c,this._y=f,this.properties=r.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of XQ)this[s]!==void 0&&(r[s]=this[s]);return r}}class YQ{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,c){const f=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][f]=this.stateChanges[r][f]||{},Xi(this.stateChanges[r][f],c),this.deletedStates[r]===null){this.deletedStates[r]={};for(const m in this.state[r])m!==f&&(this.deletedStates[r][m]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][f]===null){this.deletedStates[r][f]={};for(const m in this.state[r][f])c[m]||(this.deletedStates[r][f][m]=null)}else for(const m in c)this.deletedStates[r]&&this.deletedStates[r][f]&&this.deletedStates[r][f][m]===null&&delete this.deletedStates[r][f][m]}removeFeatureState(r,s,c){if(this.deletedStates[r]===null)return;const f=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&s!==void 0)this.deletedStates[r][f]!==null&&(this.deletedStates[r][f]=this.deletedStates[r][f]||{},this.deletedStates[r][f][c]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][f])for(c in this.deletedStates[r][f]={},this.stateChanges[r][f])this.deletedStates[r][f][c]=null;else this.deletedStates[r][f]=null;else this.deletedStates[r]=null}getState(r,s){const c=String(s),f=Xi({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const m=this.deletedStates[r][s];if(m===null)return{};for(const g in m)delete f[g]}return f}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const m={};for(const g in this.stateChanges[f])this.state[f][g]||(this.state[f][g]={}),Xi(this.state[f][g],this.stateChanges[f][g]),m[g]=this.state[f][g];c[f]=m}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const m={};if(this.deletedStates[f]===null)for(const g in this.state[f])m[g]={},this.state[f][g]={};else for(const g in this.deletedStates[f]){if(this.deletedStates[f][g]===null)this.state[f][g]={};else if(this.state[f][g])for(const x of Object.keys(this.deletedStates[f][g]))delete this.state[f][g][x];m[g]=this.state[f][g]}c[f]=c[f]||{},Xi(c[f],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in r)r[f].setFeatureState(c,s)}}class xF{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Ce(Mt,16,0),this.featureIndexArray=new RL,this.promoteId=s,this.is3DTile=!1}insert(r,s,c,f,m,g=0,x=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,m,g);const E=this.grid;for(let M=0;M<s.length;M++){const R=s[M],D=[1/0,1/0,-1/0,-1/0];for(let B=0;B<R.length;B++){const $=R[B];D[0]=Math.min(D[0],$.x),D[1]=Math.min(D[1],$.y),D[2]=Math.max(D[2],$.x),D[3]=Math.max(D[3],$.y)}x!==0&&(D[0]-=x,D[1]-=x,D[2]+=x,D[3]+=x),D[0]<Mt&&D[1]<Mt&&D[2]>=0&&D[3]>=0&&E.insert(w,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new FC(new rm(this.rawTileData)).layers,this.sourceLayerCoder=new dF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,s,c,f){this.loadVTLayers();const m=r.params||{},g=Ti(m.filter),x=r.tileResult,w=r.transform,E=x.bufferedTilespaceBounds,M=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,($,q,X,te)=>XL(x.bufferedTilespaceGeometry,$,q,X,te));M.sort(KQ);let R=null;w.elevation&&M.length>0&&(R=em.create(w.elevation,this.tileID));const D={};let B;for(let $=0;$<M.length;$++){const q=M[$];if(q===B)continue;B=q;const X=this.featureIndexArray.get(q);let te=null;if(this.is3DTile){const ce=this.bucketLayerIDs[0][0],he=s[ce];if(he.type!=="model")continue;const{queryFeature:fe,intersectionZ:Ee}=he.queryIntersectsMatchingFeature(x,X.featureIndex,g,w);fe&&this.appendToResult(D,ce,X.featureIndex,fe,Ee)}else this.loadMatchingFeature(D,X,g,m.layers,m.availableImages,s,c,f,(ce,he,fe,Ee=0)=>(te||(te=Fs(ce,this.tileID.canonical,r.tileTransform)),he.queryIntersectsFeature(x,ce,fe,te,this.z,r.transform,r.pixelPosMatrix,R,Ee)))}return D}loadMatchingFeature(r,s,c,f,m,g,x,w,E){const{featureIndex:M,bucketIndex:R,sourceLayerIndex:D,layoutVertexArrayOffset:B}=s,$=this.bucketLayerIDs[R];if(f&&!function(ce,he){for(let fe=0;fe<ce.length;fe++)if(he.indexOf(ce[fe])>=0)return!0;return!1}(f,$))return;const q=this.sourceLayerCoder.decode(D),X=this.vtLayers[q].feature(M);if(c.needGeometry){const ce=_u(X,!0);if(!c.filter(new pn(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!c.filter(new pn(this.tileID.overscaledZ),X))return;const te=this.getId(X,q);for(let ce=0;ce<$.length;ce++){const he=$[ce];if(f&&f.indexOf(he)<0)continue;const fe=g[he];if(!fe)continue;let Ee={};te!==void 0&&w&&(Ee=w.getState(fe.sourceLayer||"_geojsonTileLayer",te));const we=!E||E(X,fe,Ee,B);if(!we)continue;const Ie=new vF(X,this.z,this.x,this.y,te),ke=Xi({},x[he]);ke.paint=bF(ke.paint,fe.paint,X,Ee,m),ke.layout=bF(ke.layout,fe.layout,X,Ee,m),Ie.layer=ke,this.appendToResult(r,he,M,Ie,we)}}appendToResult(r,s,c,f,m){let g=r[s];g===void 0&&(g=r[s]=[]),g.push({featureIndex:c,feature:f,intersectionZ:m})}lookupSymbolFeatures(r,s,c,f,m,g,x,w){const E={};this.loadVTLayers();const M=Ti(m);for(const R of r)this.loadMatchingFeature(E,{bucketIndex:c,sourceLayerIndex:f,featureIndex:R,layoutVertexArrayOffset:0},M,g,x,w,s);return E}loadFeature(r){const{featureIndex:s,sourceLayerIndex:c}=r;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),m=this.vtFeatures[f];if(m[s])return m[s];const g=this.vtLayers[f].feature(s);return m[s]=g,g}hasLayer(r){for(const s of this.bucketLayerIDs)for(const c of s)if(r===c)return!0;return!1}getId(r,s){let c=r.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];f!=null&&(c=r.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function bF(i,r,s,c,f){return gc(i,(m,g)=>{const x=r instanceof ur?r.get(g):null;return x&&x.evaluate?x.evaluate(s,c,f):x})}function KQ(i,r){return r-i}pe(xF,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var Ki=24;const Ns=128;function VC(i,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new pn(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=s;let m=0;for(;m<c.length&&c[m]<=i;)m++;m=Math.max(0,m-1);let g=m;for(;g<c.length&&c[g]<i+1;)g++;g=Math.min(c.length-1,g);const x=c[m],w=c[g];return s.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:w,interpolationType:f}:{kind:"camera",minZoom:x,maxZoom:w,minSize:s.evaluate(new pn(x)),maxSize:s.evaluate(new pn(w)),interpolationType:f}}}function gb(i,{uSize:r,uSizeT:s},{lowerSize:c,upperSize:f}){return i.kind==="source"?c/Ns:i.kind==="composite"?on(c/Ns,f/Ns,s):r}function im(i,r){let s=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:m,maxZoom:g}=i,x=f?Pn($o.interpolationFactor(f,r,m,g),0,1):0;i.kind==="camera"?c=on(i.minSize,i.maxSize,x):s=x}return{uSizeT:s,uSize:c}}var QQ=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ns,evaluateSizeForFeature:gb,evaluateSizeForZoom:im,getSizeData:VC});function JQ(i,r,s){return i.sections.forEach(c=>{c.text=function(f,m,g){const x=m.layout.get("text-transform").evaluate(g,{});return x==="uppercase"?f=f.toLocaleUpperCase():x==="lowercase"&&(f=f.toLocaleLowerCase()),lr.applyArabicShaping&&(f=lr.applyArabicShaping(f)),f}(c.text,r,s)}),i}const B_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function eJ(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function tJ(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}const GC=3;function nJ(i,r,s){r.glyphs=[],i===1&&s.readMessage(rJ,r)}function rJ(i,r,s){if(i===3){const{id:c,bitmap:f,width:m,height:g,left:x,top:w,advance:E}=s.readMessage(iJ,{});r.glyphs.push({id:c,bitmap:new Zc({width:m+2*GC,height:g+2*GC},f),metrics:{width:m,height:g,left:x,top:w,advance:E}})}else i===4?r.ascender=s.readSVarint():i===5&&(r.descender=s.readSVarint())}function iJ(i,r,s){i===1?r.id=s.readVarint():i===2?r.bitmap=s.readBytes():i===3?r.width=s.readVarint():i===4?r.height=s.readVarint():i===5?r.left=s.readSVarint():i===6?r.top=s.readSVarint():i===7&&(r.advance=s.readVarint())}const wF=GC,Ia={horizontal:1,vertical:2,horizontalOnly:3};class j_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,s){const c=new j_;return c.scale=r||1,c.fontStack=s,c}static forImage(r){const s=new j_;return s.imageName=r,s}}class om{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const c=new om;for(let f=0;f<r.sections.length;f++){const m=r.sections[f];m.image?c.addImageSection(m):c.addTextSection(m,s)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCodePoint(r){return this.text.codePointAt(r)}verticalizePunctuation(r){this.text=function(s,c){let f="";for(let m=0;m<s.length;m++){const g=s.charCodeAt(m+1)||null,x=s.charCodeAt(m-1)||null;f+=!c&&(g&&ft(g)&&!B_[s[m+1]]||x&&ft(x)&&!B_[s[m-1]])||!B_[s[m]]?s[m]:B_[s[m]]}return f}(this.text,r)}trim(){let r=0;for(let c=0;c<this.text.length&&yb[this.text.charCodeAt(c)];c++)r++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&yb[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const c=new om;return c.text=this.text.substring(r,s),c.sectionIndex=this.sectionIndex.slice(r,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}addTextSection(r,s){this.text+=r.text,this.sections.push(j_.forText(r.scale,r.fontStack||s));const c=this.sections.length-1;for(let f=0;f<r.text.length;++f)this.sectionIndex.push(c)}addImageSection(r){const s=r.image?r.image.namePrimary:"";if(s.length===0)return void Qr("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(j_.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Qr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function WC(i,r,s,c,f,m,g,x,w,E,M,R,D,B,$){const q=om.fromFeature(i,f);R===Ia.vertical&&q.verticalizePunctuation(D);let X=[];const te=function(we,Ie,ke,$e,nt,He){if(!we)return[];const ut=[],bt=function(_t,Tt,xt,Ft,wt,Ct){let Jt=0;for(let Kt=0;Kt<_t.length();Kt++){const Ht=_t.getSection(Kt);Jt+=SF(_t.getCodePoint(Kt),Ht,Ft,wt,Tt,Ct)}return Jt/Math.max(1,Math.ceil(Jt/xt))}(we,Ie,ke,$e,nt,He),ot=we.text.indexOf("")>=0;let yt=0;for(let _t=0;_t<we.length();_t++){const Tt=we.getSection(_t),xt=we.getCodePoint(_t);if(yb[xt]||(yt+=SF(xt,Tt,$e,nt,Ie,He)),_t<we.length()-1){const Ft=!((it=xt)<11904||!(Te["Bopomofo Extended"](it)||Te.Bopomofo(it)||Te["CJK Compatibility Forms"](it)||Te["CJK Compatibility Ideographs"](it)||Te["CJK Compatibility"](it)||Te["CJK Radicals Supplement"](it)||Te["CJK Strokes"](it)||Te["CJK Symbols and Punctuation"](it)||Te["CJK Unified Ideographs Extension A"](it)||Te["CJK Unified Ideographs"](it)||Te["Enclosed CJK Letters and Months"](it)||Te["Halfwidth and Fullwidth Forms"](it)||Te.Hiragana(it)||Te["Ideographic Description Characters"](it)||Te["Kangxi Radicals"](it)||Te["Katakana Phonetic Extensions"](it)||Te.Katakana(it)||Te["Vertical Forms"](it)||Te["Yi Radicals"](it)||Te["Yi Syllables"](it)));(oJ[xt]||Ft||Tt.imageName)&&ut.push(EF(_t+1,yt,bt,ut,aJ(xt,we.getCodePoint(_t+1),Ft&&ot),!1))}}var it;return AF(EF(we.length(),yt,bt,ut,0,!0))}(q,E,m,r,c,B),{processBidirectionalText:ce,processStyledBidirectionalText:he}=lr;if(ce&&q.sections.length===1){const we=ce(q.toString(),te);for(const Ie of we){const ke=new om;ke.text=Ie,ke.sections=q.sections;for(let $e=0;$e<Ie.length;$e++)ke.sectionIndex.push(0);X.push(ke)}}else if(he){const we=he(q.text,q.sectionIndex,te);for(const Ie of we){const ke=new om;ke.text=Ie[0],ke.sectionIndex=Ie[1],ke.sections=q.sections,X.push(ke)}}else X=function(we,Ie){const ke=[],$e=we.text;let nt=0;for(const He of Ie)ke.push(we.substring(nt,He)),nt=He;return nt<$e.length&&ke.push(we.substring(nt,$e.length)),ke}(q,te);const fe=[],Ee={positionedLines:fe,text:q.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:R,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(we,Ie,ke,$e,nt,He,ut,bt,ot,yt,it,_t){let Tt=0,xt=0,Ft=0;const wt=bt==="right"?1:bt==="left"?0:.5;let Ct=!1;for(const xn of nt){const un=xn.getSections();for(const Tn of un){if(Tn.imageName)continue;const bn=Ie[Tn.fontStack];if(bn&&(Ct=bn.ascender!==void 0&&bn.descender!==void 0,!Ct))break}if(!Ct)break}let Jt=0;for(const xn of nt){xn.trim();const un=xn.getMaxScale(),Tn=(un-1)*Ki,bn={positionedGlyphs:[],lineOffset:0};we.positionedLines[Jt]=bn;const kn=bn.positionedGlyphs;let sn=0;if(!xn.length()){xt+=He,++Jt;continue}let mr=0,cr=0;for(let Bn=0;Bn<xn.length();Bn++){const Jn=xn.getSection(Bn),Ar=xn.getSectionIndex(Bn),wr=xn.getCodePoint(Bn);let Gr=Jn.scale,$r=null,lo=null,Xr=null,Lr=Ki,di=0;const Ni=!(ot===Ia.horizontal||!it&&!mt(wr)||it&&(yb[wr]||(Kt=wr,Te.Arabic(Kt)||Te["Arabic Supplement"](Kt)||Te["Arabic Extended-A"](Kt)||Te["Arabic Presentation Forms-A"](Kt)||Te["Arabic Presentation Forms-B"](Kt))));if(Jn.imageName){const Bi=$e[Jn.imageName];if(!Bi)continue;Xr=Jn.imageName,we.iconsInText=we.iconsInText||!0,lo=Bi.paddedRect;const Sr=Bi.displaySize;Gr=Gr*Ki/_t,$r={width:Sr[0],height:Sr[1],left:0,top:-wF,advance:Ni?Sr[1]:Sr[0],localGlyph:!1},di=Ct?-$r.height*Gr:un*Ki-17-Sr[1]*Gr,Lr=$r.advance;const Io=(Ni?Sr[0]:Sr[1])*Gr-Ki*un;Io>0&&Io>sn&&(sn=Io)}else{const Bi=ke[Jn.fontStack];if(!Bi)continue;Bi[wr]&&(lo=Bi[wr]);const Sr=Ie[Jn.fontStack];if(!Sr)continue;const Io=Sr.glyphs[wr];if(!Io)continue;if($r=Io.metrics,Lr=wr!==8203?Ki:0,Ct){const Su=Sr.ascender!==void 0?Math.abs(Sr.ascender):0,ls=Sr.descender!==void 0?Math.abs(Sr.descender):0,Ws=(Su+ls)*Gr;mr<Ws&&(mr=Ws,cr=(Su-ls)/2*Gr),di=-Su*Gr}else di=(un-Gr)*Ki-17}Ni?(we.verticalizable=!0,kn.push({glyph:wr,imageName:Xr,x:Tt,y:xt+di,vertical:Ni,scale:Gr,localGlyph:$r.localGlyph,fontStack:Jn.fontStack,sectionIndex:Ar,metrics:$r,rect:lo}),Tt+=Lr*Gr+yt):(kn.push({glyph:wr,imageName:Xr,x:Tt,y:xt+di,vertical:Ni,scale:Gr,localGlyph:$r.localGlyph,fontStack:Jn.fontStack,sectionIndex:Ar,metrics:$r,rect:lo}),Tt+=$r.advance*Gr+yt)}kn.length!==0&&(Ft=Math.max(Tt-yt,Ft),Ct?CF(kn,wt,sn,cr,He*un/2):CF(kn,wt,sn,0,He/2)),Tt=0;const Qn=He*un+sn;bn.lineOffset=Math.max(sn,Tn),xt+=Qn,++Jt}var Kt;const Ht=xt,{horizontalAlign:Et,verticalAlign:tn}=HC(ut);(function(xn,un,Tn,bn,kn,sn){const mr=(un-Tn)*kn,cr=-sn*bn;for(const Qn of xn)for(const Bn of Qn.positionedGlyphs)Bn.x+=mr,Bn.y+=cr})(we.positionedLines,wt,Et,tn,Ft,Ht),we.top+=-tn*Ht,we.bottom=we.top+Ht,we.left+=-Et*Ft,we.right=we.left+Ft,we.hasBaseline=Ct}(Ee,r,s,c,X,g,x,w,R,E,D,$),!function(we){for(const Ie of we)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(fe)&&Ee}const yb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oJ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function SF(i,r,s,c,f,m){if(r.imageName){const g=c[r.imageName];return g?g.displaySize[0]*r.scale*Ki/m+f:0}{const g=s[r.fontStack],x=g&&g.glyphs[i];return x?x.metrics.advance*r.scale+f:0}}function TF(i,r,s,c){const f=Math.pow(i-r,2);return c?i<r?f/2:2*f:f+Math.abs(s)*s}function aJ(i,r,s){let c=0;return i===10&&(c-=1e4),s&&(c+=150),i!==40&&i!==65288||(c+=50),r!==41&&r!==65289||(c+=50),c}function EF(i,r,s,c,f,m){let g=null,x=TF(r,s,f,m);for(const w of c){const E=TF(r-w.x,s,f,m)+w.badness;E<=x&&(g=w,x=E)}return{index:i,x:r,priorBreak:g,badness:x}}function AF(i){return i?AF(i.priorBreak).concat(i.index):[]}function HC(i){let r=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function CF(i,r,s,c,f){if(!(r||s||c||f))return;const m=i.length-1,g=i[m],x=(g.x+g.metrics.advance*g.scale)*r;for(let w=0;w<=m;w++)i[w].x-=x,i[w].y+=s+c+f}function sJ(i,r,s,c){const{horizontalAlign:f,verticalAlign:m}=HC(c),g=s[0]-i.displaySize[0]*f,x=s[1]-i.displaySize[1]*m;return{imagePrimary:i,imageSecondary:r,top:x,bottom:x+i.displaySize[1],left:g,right:g+i.displaySize[0]}}function PF(i,r,s,c,f,m){const g=i.imagePrimary;let x;if(g.content){const X=g.content,te=g.pixelRatio||1;x=[X[0]/te,X[1]/te,g.displaySize[0]-X[2]/te,g.displaySize[1]-X[3]/te]}const w=r.left*m,E=r.right*m;let M,R,D,B;s==="width"||s==="both"?(B=f[0]+w-c[3],R=f[0]+E+c[1]):(B=f[0]+(w+E-g.displaySize[0])/2,R=B+g.displaySize[0]);const $=r.top*m,q=r.bottom*m;return s==="height"||s==="both"?(M=f[1]+$-c[0],D=f[1]+q+c[2]):(M=f[1]+($+q-g.displaySize[1])/2,D=M+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:M,right:R,bottom:D,left:B,collisionPadding:x}}class wu extends Lt{constructor(r,s,c,f,m){super(r,s),this.angle=f,this.z=c,m!==void 0&&(this.segment=m)}clone(){return new wu(this.x,this.y,this.z,this.angle,this.segment)}}function MF(i,r,s,c,f){if(r.segment===void 0)return!0;let m=r,g=r.segment+1,x=0;for(;x>-s/2;){if(g--,g<0)return!1;x-=i[g].dist(m),m=i[g]}x+=i[g].dist(i[g+1]),g++;const w=[];let E=0;for(;x<s/2;){const M=i[g],R=i[g+1];if(!R)return!1;let D=i[g-1].angleTo(M)-M.angleTo(R);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:x,angleDelta:D}),E+=D;x-w[0].distance>c;)E-=w.shift().angleDelta;if(E>f)return!1;g++,x+=M.dist(R)}return!0}function IF(i){let r=0;for(let s=0;s<i.length-1;s++)r+=i[s].dist(i[s+1]);return r}function OF(i,r,s){return i?.6*r*s:0}function RF(i,r){return Math.max(i?i.right-i.left:0,r?r.right-r.left:0)}function lJ(i,r,s,c,f,m){const g=OF(s,f,m),x=RF(s,c)*m;let w=0;const E=IF(i)/2;for(let M=0;M<i.length-1;M++){const R=i[M],D=i[M+1],B=R.dist(D);if(w+B>E){const $=(E-w)/B,q=on(R.x,D.x,$),X=on(R.y,D.y,$),te=new wu(q,X,0,D.angleTo(R),M);return!g||MF(i,te,x,g,r)?te:void 0}w+=B}}function uJ(i,r,s,c,f,m,g,x,w){const E=OF(c,m,g),M=RF(c,f),R=M*g,D=i[0].x===0||i[0].x===w||i[0].y===0||i[0].y===w;return r-R<r/4&&(r=R+r/4),kF(i,D?r/2*x%r:(M/2+2*m)*g*x%r,r,E,s,R,D,!1,w)}function kF(i,r,s,c,f,m,g,x,w){const E=m/2,M=IF(i);let R=0,D=r-s,B=[];for(let $=0;$<i.length-1;$++){const q=i[$],X=i[$+1],te=q.dist(X),ce=X.angleTo(q);for(;D+s<R+te;){D+=s;const he=(D-R)/te,fe=on(q.x,X.x,he),Ee=on(q.y,X.y,he);if(fe>=0&&fe<w&&Ee>=0&&Ee<w&&D-E>=0&&D+E<=M){const we=new wu(fe,Ee,0,ce,$);c&&!MF(i,we,m,c,f)||B.push(we)}}R+=te}return x||B.length||g||(B=kF(i,R/2,s,c,f,m,g,!0,w)),B}function DF(i,r,s,c,f){const m=[];for(let g=0;g<i.length;g++){const x=i[g];let w;for(let E=0;E<x.length-1;E++){let M=x[E],R=x[E+1];M.x<r&&R.x<r||(M.x<r?M=new Lt(r,M.y+(r-M.x)/(R.x-M.x)*(R.y-M.y))._round():R.x<r&&(R=new Lt(r,M.y+(r-M.x)/(R.x-M.x)*(R.y-M.y))._round()),M.y<s&&R.y<s||(M.y<s?M=new Lt(M.x+(s-M.y)/(R.y-M.y)*(R.x-M.x),s)._round():R.y<s&&(R=new Lt(M.x+(s-M.y)/(R.y-M.y)*(R.x-M.x),s)._round()),M.x>=c&&R.x>=c||(M.x>=c?M=new Lt(c,M.y+(c-M.x)/(R.x-M.x)*(R.y-M.y))._round():R.x>=c&&(R=new Lt(c,M.y+(c-M.x)/(R.x-M.x)*(R.y-M.y))._round()),M.y>=f&&R.y>=f||(M.y>=f?M=new Lt(M.x+(f-M.y)/(R.y-M.y)*(R.x-M.x),f)._round():R.y>=f&&(R=new Lt(M.x+(f-M.y)/(R.y-M.y)*(R.x-M.x),f)._round()),w&&M.equals(w[w.length-1])||(w=[M],m.push(w)),w.push(R)))))}}return m}function LF(i){let r=0,s=0;for(const g of i)r+=g.w*g.h,s=Math.max(s,g.w);i.sort((g,x)=>x.h-g.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let f=0,m=0;for(const g of i)for(let x=c.length-1;x>=0;x--){const w=c[x];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,m=Math.max(m,g.y+g.h),f=Math.max(f,g.x+g.w),g.w===w.w&&g.h===w.h){const E=c.pop();x<c.length&&(c[x]=E)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(c.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:f,h:m,fill:r/(f*m)||0}}pe(wu,"Anchor");const la=1;class qC{constructor(r,{pixelRatio:s,version:c,stretchX:f,stretchY:m,content:g}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=f,this.stretchY=m,this.content=g,this.version=c}get tl(){return[this.paddedRect.x+la,this.paddedRect.y+la]}get br(){return[this.paddedRect.x+this.paddedRect.w-la,this.paddedRect.y+this.paddedRect.h-la]}get displaySize(){return[(this.paddedRect.w-2*la)/this.pixelRatio,(this.paddedRect.h-2*la)/this.pixelRatio]}}class zF{constructor(r,s,c){const f={},m={};this.haveRenderCallbacks=[];const g=[];this.addImages(r,f,g),this.addImages(s,m,g);const{w:x,h:w}=LF(g),E=new Ma({width:x||1,height:w||1});for(const M in r){const R=r[M],D=f[M].paddedRect;Ma.copy(R.data,E,{x:0,y:0},{x:D.x+la,y:D.y+la},R.data,c,R.sdf)}for(const M in s){const R=s[M],D=m[M].paddedRect,B=D.x+la,$=D.y+la,q=R.data.width,X=R.data.height;Ma.copy(R.data,E,{x:0,y:0},{x:B,y:$},R.data,c),Ma.copy(R.data,E,{x:0,y:X-1},{x:B,y:$-1},{width:q,height:1},c),Ma.copy(R.data,E,{x:0,y:0},{x:B,y:$+X},{width:q,height:1},c),Ma.copy(R.data,E,{x:q-1,y:0},{x:B-1,y:$},{width:1,height:X},c),Ma.copy(R.data,E,{x:0,y:0},{x:B+q,y:$},{width:1,height:X},c)}this.image=E,this.iconPositions=f,this.patternPositions=m}addImages(r,s,c){for(const f in r){const m=r[f],g={x:0,y:0,w:m.data.width+2*la,h:m.data.height+2*la};c.push(g),s[f]=new qC(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(r,s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>r.hasImage(f,c)),r.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const f in r.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[f],r.getImage(f,c),s),this.patchUpdatedImage(this.patternPositions[f],r.getImage(f,c),s)}patchUpdatedImage(r,s,c){if(!r||!s||r.version===s.version)return;r.version=s.version;const[f,m]=r.tl,g=!!Object.keys(this.patternPositions).length;c.update(s.data,{useMipmap:g},{x:f,y:m})}}pe(qC,"ImagePosition"),pe(zF,"ImageAtlas");const $_=1e20;function FF(i,r,s,c,f,m,g,x,w){for(let E=r;E<r+c;E++)NF(i,s*m+E,m,f,g,x,w);for(let E=s;E<s+f;E++)NF(i,E*m+r,1,c,g,x,w)}function NF(i,r,s,c,f,m,g){m[0]=0,g[0]=-$_,g[1]=$_,f[0]=i[r];for(let x=1,w=0,E=0;x<c;x++){f[x]=i[r+x*s];const M=x*x;do{const R=m[w];E=(f[x]-f[R]+M-R*R)/(x-R)/2}while(E<=g[w]&&--w>-1);w++,m[w]=x,g[w]=E,g[w+1]=$_}for(let x=0,w=0;x<c;x++){for(;g[w+1]<x;)w++;const E=m[w],M=x-E;i[r+x*s]=f[E]+M*M}}const Bs=2,ZC={none:0,ideographs:1,all:2};class am{constructor(r,s,c){this.requestManager=r,this.localGlyphMode=s,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r,s){this.urls[s]=r}getGlyphs(r,s,c){const f=[],m=this.urls[s]||A.GLYPHS_URL;for(const g in r)for(const x of r[g])f.push({stack:g,id:x});mc(f,({stack:g,id:x},w)=>{let E=this.entries[g];E||(E=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=E.glyphs[x];if(M!==void 0)return void w(null,{stack:g,id:x,glyph:M});if(M=this._tinySDF(E,g,x),M)return E.glyphs[x]=M,void w(null,{stack:g,id:x,glyph:M});const R=Math.floor(x/256);if(256*R>65535)return void w(new Error("glyphs > 65535 not supported"));if(E.ranges[R])return void w(null,{stack:g,id:x,glyph:M});let D=E.requests[R];D||(D=E.requests[R]=[],am.loadGlyphRange(g,R,m,this.requestManager,(B,$)=>{if($){E.ascender=$.ascender,E.descender=$.descender;for(const q in $.glyphs)this._doesCharSupportLocalGlyph(+q)||(E.glyphs[+q]=$.glyphs[+q]);E.ranges[R]=!0}for(const q of D)q(B,$);delete E.requests[R]})),D.push((B,$)=>{B?w(B):$&&w(null,{stack:g,id:x,glyph:$.glyphs[x]||null})})},(g,x)=>{if(g)c(g);else if(x){const w={};for(const{stack:E,id:M,glyph:R}of x)w[E]===void 0&&(w[E]={}),w[E].glyphs===void 0&&(w[E].glyphs={}),w[E].glyphs[M]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},w[E].ascender=this.entries[E].ascender,w[E].descender=this.entries[E].descender;c(null,w)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==ZC.none&&(this.localGlyphMode===ZC.all?!!this.localFontFamily:!!this.localFontFamily&&(Te["CJK Unified Ideographs"](r)||Te["Hangul Syllables"](r)||Te.Hiragana(r)||Te.Katakana(r)||Te["CJK Symbols and Punctuation"](r)||Te["CJK Unified Ideographs Extension A"](r)||Te["CJK Unified Ideographs Extension B"](r)))}_tinySDF(r,s,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let m=r.tinySDF;if(!m){let q="400";/bold/i.test(s)?q="900":/medium/i.test(s)?q="500":/light/i.test(s)&&(q="200"),m=r.tinySDF=new am.TinySDF({fontFamily:f,fontWeight:q,fontSize:24*Bs,buffer:3*Bs,radius:8*Bs}),m.fontWeight=q}if(this.localGlyphs[m.fontWeight][c])return this.localGlyphs[m.fontWeight][c];const g=String.fromCodePoint(c),{data:x,width:w,height:E,glyphWidth:M,glyphHeight:R,glyphLeft:D,glyphTop:B,glyphAdvance:$}=m.draw(g);return this.localGlyphs[m.fontWeight][c]={id:c,bitmap:new Zc({width:w,height:E},x),metrics:{width:M/Bs,height:R/Bs,left:D/Bs,top:B/Bs-27,advance:$/Bs,localGlyph:!0}}}}am.loadGlyphRange=function(i,r,s,c,f){const m=256*r,g=m+255,x=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",i).replace("{range}",`${m}-${g}`),_p.Glyphs);nu(x,(w,E)=>{if(w)f(w);else if(E){const M={},R=function(D){return new rm(D).readFields(nJ,{})}(E);for(const D of R.glyphs)M[D.id]=D;f(null,{glyphs:M,ascender:R.ascender,descender:R.descender})}})},am.TinySDF=class{constructor({fontSize:i=24,buffer:r=3,radius:s=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:m="normal",fontStyle:g="normal"}={}){this.buffer=r,this.cutoff=c,this.radius=s;const x=this.size=i+4*r,w=this._createCanvas(x),E=this.ctx=w.getContext("2d",{willReadFrequently:!0});E.font=`${g} ${m} ${i}px ${f}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(i){const r=document.createElement("canvas");return r.width=r.height=i,r}draw(i){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:m}=this.ctx.measureText(i),g=Math.ceil(s),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-f))),w=Math.min(this.size-this.buffer,g+Math.ceil(c)),E=x+2*this.buffer,M=w+2*this.buffer,R=Math.max(E*M,0),D=new Uint8ClampedArray(R),B={data:D,width:E,height:M,glyphWidth:x,glyphHeight:w,glyphTop:g,glyphLeft:0,glyphAdvance:r};if(x===0||w===0)return B;const{ctx:$,buffer:q,gridInner:X,gridOuter:te}=this;$.clearRect(q,q,x,w),$.fillText(i,q,q+g);const ce=$.getImageData(q,q,x,w);te.fill($_,0,R),X.fill(0,0,R);for(let he=0;he<w;he++)for(let fe=0;fe<x;fe++){const Ee=ce.data[4*(he*x+fe)+3]/255;if(Ee===0)continue;const we=(he+q)*E+fe+q;if(Ee===1)te[we]=0,X[we]=$_;else{const Ie=.5-Ee;te[we]=Ie>0?Ie*Ie:0,X[we]=Ie<0?Ie*Ie:0}}FF(te,0,0,E,M,E,this.f,this.v,this.z),FF(X,q,q,x,w,E,this.f,this.v,this.z);for(let he=0;he<R;he++){const fe=Math.sqrt(te[he])-Math.sqrt(X[he]);D[he]=Math.round(255-255*(fe/this.radius+this.cutoff))}return B}};const Kc=la;function BF(i,r,s,c){const f=[],m=i.imagePrimary,g=m.pixelRatio,x=m.paddedRect.w-2*Kc,w=m.paddedRect.h-2*Kc,E=i.right-i.left,M=i.bottom-i.top,R=m.stretchX||[[0,x]],D=m.stretchY||[[0,w]],B=(He,ut)=>He+ut[1]-ut[0],$=R.reduce(B,0),q=D.reduce(B,0),X=x-$,te=w-q;let ce=0,he=$,fe=0,Ee=q,we=0,Ie=X,ke=0,$e=te;if(m.content&&c){const He=m.content;ce=_b(R,0,He[0]),fe=_b(D,0,He[1]),he=_b(R,He[0],He[2]),Ee=_b(D,He[1],He[3]),we=He[0]-ce,ke=He[1]-fe,Ie=He[2]-He[0]-he,$e=He[3]-He[1]-Ee}const nt=(He,ut,bt,ot)=>{const yt=vb(He.stretch-ce,he,E,i.left),it=xb(He.fixed-we,Ie,He.stretch,$),_t=vb(ut.stretch-fe,Ee,M,i.top),Tt=xb(ut.fixed-ke,$e,ut.stretch,q),xt=vb(bt.stretch-ce,he,E,i.left),Ft=xb(bt.fixed-we,Ie,bt.stretch,$),wt=vb(ot.stretch-fe,Ee,M,i.top),Ct=xb(ot.fixed-ke,$e,ot.stretch,q),Jt=new Lt(yt,_t),Kt=new Lt(xt,_t),Ht=new Lt(xt,wt),Et=new Lt(yt,wt),tn=new Lt(it/g,Tt/g),xn=new Lt(Ft/g,Ct/g),un=r*Math.PI/180;if(un){const cr=Math.sin(un),Qn=Math.cos(un),Bn=[Qn,-cr,cr,Qn];Jt._matMult(Bn),Kt._matMult(Bn),Et._matMult(Bn),Ht._matMult(Bn)}const Tn=He.stretch+He.fixed,bn=bt.stretch+bt.fixed,kn=ut.stretch+ut.fixed,sn=ot.stretch+ot.fixed,mr=i.imageSecondary;return{tl:Jt,tr:Kt,bl:Et,br:Ht,texPrimary:{x:m.paddedRect.x+Kc+Tn,y:m.paddedRect.y+Kc+kn,w:bn-Tn,h:sn-kn},texSecondary:mr?{x:mr.paddedRect.x+Kc+Tn,y:mr.paddedRect.y+Kc+kn,w:bn-Tn,h:sn-kn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:tn,pixelOffsetBR:xn,minFontScaleX:Ie/g/E,minFontScaleY:$e/g/M,isSDF:s}};if(c&&(m.stretchX||m.stretchY)){const He=jF(R,X,$),ut=jF(D,te,q);for(let bt=0;bt<He.length-1;bt++){const ot=He[bt],yt=He[bt+1];for(let it=0;it<ut.length-1;it++)f.push(nt(ot,ut[it],yt,ut[it+1]))}}else f.push(nt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:w+1}));return f}function _b(i,r,s){let c=0;for(const f of i)c+=Math.max(r,Math.min(s,f[1]))-Math.max(r,Math.min(s,f[0]));return c}function jF(i,r,s){const c=[{fixed:-Kc,stretch:0}];for(const[f,m]of i){const g=c[c.length-1];c.push({fixed:f-g.stretch,stretch:g.stretch}),c.push({fixed:f-g.stretch,stretch:g.stretch+(m-f)})}return c.push({fixed:r+Kc,stretch:s}),c}function vb(i,r,s,c){return i/r*s+c}function xb(i,r,s,c){return i-r*s/c}function cJ(i,r,s,c){const f=r+i.positionedLines[c].lineOffset;return c===0?s+f/2:s+(f+(r+i.positionedLines[c-1].lineOffset))/2}function hJ(i,r=1,s=!1){let c=1/0,f=1/0,m=-1/0,g=-1/0;const x=i[0];for(let B=0;B<x.length;B++){const $=x[B];(!B||$.x<c)&&(c=$.x),(!B||$.y<f)&&(f=$.y),(!B||$.x>m)&&(m=$.x),(!B||$.y>g)&&(g=$.y)}const w=Math.min(m-c,g-f);let E=w/2;const M=new e_([],fJ);if(w===0)return new Lt(c,f);for(let B=c;B<m;B+=w)for(let $=f;$<g;$+=w)M.push(new sm(B+E,$+E,E,i));let R=function(B){let $=0,q=0,X=0;const te=B[0];for(let ce=0,he=te.length,fe=he-1;ce<he;fe=ce++){const Ee=te[ce],we=te[fe],Ie=Ee.x*we.y-we.x*Ee.y;q+=(Ee.x+we.x)*Ie,X+=(Ee.y+we.y)*Ie,$+=3*Ie}return new sm(q/$,X/$,0,B)}(i),D=M.length;for(;M.length;){const B=M.pop();(B.d>R.d||!R.d)&&(R=B,s&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,D)),B.max-R.d<=r||(E=B.h/2,M.push(new sm(B.p.x-E,B.p.y-E,E,i)),M.push(new sm(B.p.x+E,B.p.y-E,E,i)),M.push(new sm(B.p.x-E,B.p.y+E,E,i)),M.push(new sm(B.p.x+E,B.p.y+E,E,i)),D+=4)}return s&&(console.log(`num probes: ${D}`),console.log(`best distance: ${R.d}`)),R.p}function fJ(i,r){return r.max-i.max}class sm{constructor(r,s,c,f){this.p=new Lt(r,s),this.h=c,this.d=function(m,g){let x=!1,w=1/0;for(let E=0;E<g.length;E++){const M=g[E];for(let R=0,D=M.length,B=D-1;R<D;B=R++){const $=M[R],q=M[B];$.y>m.y!=q.y>m.y&&m.x<(q.x-$.x)*(m.y-$.y)/(q.y-$.y)+$.x&&(x=!x),w=Math.min(w,qL(m,$,q))}}return(x?1:-1)*Math.sqrt(w)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const XC=Number.POSITIVE_INFINITY,dJ=Math.sqrt(2);function $F(i,[r,s]){let c=0,f=0;if(s===XC){r<0&&(r=0);const m=r/dJ;switch(i){case"top-right":case"top-left":f=m-7;break;case"bottom-right":case"bottom-left":f=7-m;break;case"bottom":f=7-r;break;case"top":f=r-7}switch(i){case"top-right":case"bottom-right":c=-m;break;case"top-left":case"bottom-left":c=m;break;case"left":c=r;break;case"right":c=-r}}else{switch(r=Math.abs(r),s=Math.abs(s),i){case"top-right":case"top-left":case"top":f=s-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-s}switch(i){case"top-right":case"bottom-right":case"right":c=-r;break;case"top-left":case"bottom-left":case"left":c=r}}return[c,f]}function YC(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pJ(i,r,s,c,f,m,g,x,w,E,M,R,D,B,$){let q=m.textMaxSize.evaluate(r,{},R);q===void 0&&(q=g);const X=i.layers[0].layout,te=X.get("icon-offset").evaluate(r,{},R),ce=VF(s.horizontal)||s.vertical,he=D.name==="globe",fe=Ki,Ee=g/fe,we=i.tilePixelRatio*q/fe,Ie=(yt=i.overscaling,i.zoom>18&&yt>2&&(yt>>=1),Math.max(Mt/(512*yt),1)*X.get("symbol-spacing")),ke=X.get("text-padding")*i.tilePixelRatio,$e=X.get("icon-padding")*i.tilePixelRatio,nt=Fn(X.get("text-max-angle")),He=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",ut=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",bt=X.get("symbol-placement"),ot=Ie/2;var yt;const it=X.get("icon-text-fit").evaluate(r,{},R),_t=X.get("icon-text-fit-padding").evaluate(r,{},R),Tt=it!=="none";let xt;i.hasAnyIconTextFit===!1&&Tt&&(i.hasAnyIconTextFit=!0),c&&Tt&&(i.allowVerticalPlacement&&s.vertical&&(xt=PF(c,s.vertical,it,_t,te,Ee)),ce&&(c=PF(c,ce,it,_t,te,Ee)));const Ft=(wt,Ct,Jt)=>{if(Ct.x<0||Ct.x>=Mt||Ct.y<0||Ct.y>=Mt)return;let Kt=null;if(he){const{x:Ht,y:Et,z:tn}=D.projectTilePoint(Ct.x,Ct.y,Jt);Kt={anchor:new wu(Ht,Et,tn,0,void 0),up:D.upVector(Jt,Ct.x,Ct.y)}}(function(Ht,Et,tn,xn,un,Tn,bn,kn,sn,mr,cr,Qn,Bn,Jn,Ar,wr,Gr,$r,lo,Xr,Lr,di,Ni,Bi,Sr,Io,Su){const ls=Ht.addToLineVertexArray(Et,xn);let Ws,ih,oh,rd,WN,HN,qN,ZN=0,XN=0,YN=0,KN=0,SP=-1,TP=-1;const Il={};let QN=Sc("");const id=tn?tn.anchor:Et,EP=sn.layout.get("icon-text-fit").evaluate(Lr,{},Sr)!=="none";let AP=0,CP=0;if(sn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[AP,CP]=sn.layout.get("text-offset").evaluate(Lr,{},Sr).map(ca=>ca*Ki):(AP=sn.layout.get("text-radial-offset").evaluate(Lr,{},Sr)*Ki,CP=XC),Ht.allowVerticalPlacement&&un.vertical){const ca=un.vertical;if(Ar)HN=KC(ca),kn&&(qN=KC(kn));else{const ha=sn.layout.get("text-rotate").evaluate(Lr,{},Sr)+90;oh=bb(mr,id,Et,cr,Qn,Bn,ca,Jn,ha,wr),kn&&(rd=bb(mr,id,Et,cr,Qn,Bn,kn,$r,ha))}}if(Tn){const ca=sn.layout.get("icon-rotate").evaluate(Lr,{},Sr),ha=BF(Tn,ca,Ni,EP),gm=kn?BF(kn,ca,Ni,EP):void 0;ih=bb(mr,id,Et,cr,Qn,Bn,Tn,$r,ca),ZN=4*ha.length;const JN=Ht.iconSizeData;let od=null;JN.kind==="source"?(od=[Ns*sn.layout.get("icon-size").evaluate(Lr,{},Sr)],od[0]>Qc&&Qr(`${Ht.layerIds[0]}: Value for "icon-size" is >= ${U_}. Reduce your "icon-size".`)):JN.kind==="composite"&&(od=[Ns*di.compositeIconSizes[0].evaluate(Lr,{},Sr),Ns*di.compositeIconSizes[1].evaluate(Lr,{},Sr)],(od[0]>Qc||od[1]>Qc)&&Qr(`${Ht.layerIds[0]}: Value for "icon-size" is >= ${U_}. Reduce your "icon-size".`)),Ht.addSymbols(Ht.icon,ha,od,Xr,lo,Lr,!1,tn,Et,ls.lineStartIndex,ls.lineLength,-1,Bi,Sr,Io,Su),SP=Ht.icon.placedSymbolArray.length-1,gm&&(XN=4*gm.length,Ht.addSymbols(Ht.icon,gm,od,Xr,lo,Lr,Ia.vertical,tn,Et,ls.lineStartIndex,ls.lineLength,-1,Bi,Sr,Io,Su),TP=Ht.icon.placedSymbolArray.length-1)}for(const ca in un.horizontal){const ha=un.horizontal[ca];Ws||(QN=Sc(ha.text),Ar?WN=KC(ha):Ws=bb(mr,id,Et,cr,Qn,Bn,ha,Jn,sn.layout.get("text-rotate").evaluate(Lr,{},Sr),wr));const gm=ha.positionedLines.length===1;if(YN+=UF(Ht,tn,Et,ha,bn,sn,Ar,Lr,wr,ls,un.vertical?Ia.horizontal:Ia.horizontalOnly,gm?Object.keys(un.horizontal):[ca],Il,SP,di,Bi,Sr,Io),gm)break}un.vertical&&(KN+=UF(Ht,tn,Et,un.vertical,bn,sn,Ar,Lr,wr,ls,Ia.vertical,["vertical"],Il,TP,di,Bi,Sr,Io));let ah=-1;const PP=(ca,ha)=>ca?Math.max(ca,ha):ha;ah=PP(WN,ah),ah=PP(HN,ah),ah=PP(qN,ah);const R2=ah>-1?1:0;Ht.glyphOffsetArray.length>=65535&&Qr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Lr.sortKey!==void 0&&Ht.addToSortKeyRanges(Ht.symbolInstances.length,Lr.sortKey),Ht.symbolInstances.emplaceBack(Et.x,Et.y,id.x,id.y,id.z,Il.right>=0?Il.right:-1,Il.center>=0?Il.center:-1,Il.left>=0?Il.left:-1,Il.vertical>=0?Il.vertical:-1,SP,TP,QN,Ws!==void 0?Ws:Ht.collisionBoxArray.length,Ws!==void 0?Ws+1:Ht.collisionBoxArray.length,oh!==void 0?oh:Ht.collisionBoxArray.length,oh!==void 0?oh+1:Ht.collisionBoxArray.length,ih!==void 0?ih:Ht.collisionBoxArray.length,ih!==void 0?ih+1:Ht.collisionBoxArray.length,rd||Ht.collisionBoxArray.length,rd?rd+1:Ht.collisionBoxArray.length,cr,YN,KN,ZN,XN,R2,0,AP,CP,ah,0,1,1,EP?1:0)})(i,Ct,Kt,wt,s,c,f,xt,i.layers[0],i.collisionBoxArray,r.index,r.sourceLayerIndex,i.index,ke,He,w,0,$e,ut,te,r,m,E,M,R,B,$)};if(bt==="line")for(const wt of DF(r.geometry,0,0,Mt,Mt)){const Ct=uJ(wt,Ie,nt,s.vertical||ce,c,fe,we,i.overscaling,Mt);for(const Jt of Ct)ce&&mJ(i,ce.text,ot,Jt)||Ft(wt,Jt,R)}else if(bt==="line-center"){for(const wt of r.geometry)if(wt.length>1){const Ct=lJ(wt,nt,s.vertical||ce,c,fe,we);Ct&&Ft(wt,Ct,R)}}else if(r.type==="Polygon")for(const wt of rb(r.geometry,0)){const Ct=hJ(wt,16);Ft(wt[0],new wu(Ct.x,Ct.y,0,0,void 0),R)}else if(r.type==="LineString")for(const wt of r.geometry)Ft(wt,new wu(wt[0].x,wt[0].y,0,0,void 0),R);else if(r.type==="Point")for(const wt of r.geometry)for(const Ct of wt)Ft([Ct],new wu(Ct.x,Ct.y,0,0,void 0),R)}const U_=255,Qc=U_*Ns;function UF(i,r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X,te){const ce=function(Ee,we,Ie,ke,$e,nt,He,ut){const bt=[];if(we.positionedLines.length===0)return bt;const ot=ke.layout.get("text-rotate").evaluate(nt,{})*Math.PI/180,yt=function(Ft){const wt=Ft[0],Ct=Ft[1],Jt=wt*Ct;return Jt>0?[wt,-Ct]:Jt<0?[-wt,Ct]:wt===0?[Ct,wt]:[Ct,-wt]}(Ie);let it=Math.abs(we.top-we.bottom);for(const Ft of we.positionedLines)it-=Ft.lineOffset;const _t=we.positionedLines.length,Tt=it/_t;let xt=we.top-Ie[1];for(let Ft=0;Ft<_t;++Ft){const wt=we.positionedLines[Ft];xt=cJ(we,Tt,xt,Ft);for(const Ct of wt.positionedGlyphs){if(!Ct.rect)continue;const Jt=Ct.rect||{};let Kt=wF+1,Ht=!0,Et=1,tn=0;if(Ct.imageName){const Xr=He[Ct.imageName];if(!Xr)continue;if(Xr.sdf){Qr("SDF images are not supported in formatted text and will be ignored.");continue}Ht=!1,Et=Xr.pixelRatio,Kt=la/Et}const xn=($e||ut)&&Ct.vertical,un=Ct.metrics.advance*Ct.scale/2,Tn=Ct.metrics,bn=Ct.rect;if(bn===null)continue;ut&&we.verticalizable&&(tn=Ct.imageName?un-Ct.metrics.width*Ct.scale/2:0);const kn=$e?[Ct.x+un,Ct.y]:[0,0];let sn=[0,0],mr=[0,0],cr=!1;$e||(xn?(mr=[Ct.x+un+yt[0],Ct.y+yt[1]-tn],cr=!0):sn=[Ct.x+un+Ie[0],Ct.y+Ie[1]-tn]);const Qn=bn.w*Ct.scale/(Et*(Ct.localGlyph?Bs:1)),Bn=bn.h*Ct.scale/(Et*(Ct.localGlyph?Bs:1));let Jn,Ar,wr,Gr;if(xn){const Xr=Ct.y-xt,Lr=new Lt(-un,un-Xr),di=-Math.PI/2,Ni=new Lt(...mr);Jn=new Lt(-un+sn[0],sn[1]),Jn._rotateAround(di,Lr)._add(Ni),Jn.x+=-Xr+un,Jn.y-=(Tn.left-Kt)*Ct.scale;const Bi=Ct.imageName?Tn.advance*Ct.scale:Ki*Ct.scale,Sr=String.fromCodePoint(Ct.glyph);eJ(Sr)?Jn.x+=(1-Kt)*Ct.scale:tJ(Sr)?Jn.x+=Bi-Tn.height*Ct.scale+(-Kt-1)*Ct.scale:Jn.x+=Ct.imageName||Tn.width+2*Kt===bn.w&&Tn.height+2*Kt===bn.h?(Bi-Bn)/2:(Bi-(Tn.height+2*Kt)*Ct.scale)/2,Ar=new Lt(Jn.x,Jn.y-Qn),wr=new Lt(Jn.x+Bn,Jn.y),Gr=new Lt(Jn.x+Bn,Jn.y-Qn)}else{const Xr=(Tn.left-Kt)*Ct.scale-un+sn[0],Lr=(-Tn.top-Kt)*Ct.scale+sn[1],di=Xr+Qn,Ni=Lr+Bn;Jn=new Lt(Xr,Lr),Ar=new Lt(di,Lr),wr=new Lt(Xr,Ni),Gr=new Lt(di,Ni)}if(ot){let Xr;Xr=$e?new Lt(0,0):cr?new Lt(yt[0],yt[1]):new Lt(Ie[0],Ie[1]),Jn._rotateAround(ot,Xr),Ar._rotateAround(ot,Xr),wr._rotateAround(ot,Xr),Gr._rotateAround(ot,Xr)}const $r=new Lt(0,0),lo=new Lt(0,0);bt.push({tl:Jn,tr:Ar,bl:wr,br:Gr,texPrimary:Jt,texSecondary:void 0,writingMode:we.writingMode,glyphOffset:kn,sectionIndex:Ct.sectionIndex,isSDF:Ht,pixelOffsetTL:$r,pixelOffsetBR:lo,minFontScaleX:0,minFontScaleY:0})}}return bt}(0,c,w,m,g,x,f,i.allowVerticalPlacement),he=i.textSizeData;let fe=null;he.kind==="source"?(fe=[Ns*m.layout.get("text-size").evaluate(x,{},X)],fe[0]>Qc&&Qr(`${i.layerIds[0]}: Value for "text-size" is >= ${U_}. Reduce your "text-size".`)):he.kind==="composite"&&(fe=[Ns*$.compositeTextSizes[0].evaluate(x,{},X),Ns*$.compositeTextSizes[1].evaluate(x,{},X)],(fe[0]>Qc||fe[1]>Qc)&&Qr(`${i.layerIds[0]}: Value for "text-size" is >= ${U_}. Reduce your "text-size".`)),i.addSymbols(i.text,ce,fe,w,g,x,M,r,s,E.lineStartIndex,E.lineLength,B,q,X,te,!1);for(const Ee of R)D[Ee]=i.text.placedSymbolArray.length-1;return 4*ce.length}function VF(i){for(const r in i)return i[r];return null}function bb(i,r,s,c,f,m,g,x,w,E){let M=g.top,R=g.bottom,D=g.left,B=g.right;const $=g.collisionPadding;if($&&(D-=$[0],M-=$[1],B+=$[2],R+=$[3]),w){const q=new Lt(D,M),X=new Lt(B,M),te=new Lt(D,R),ce=new Lt(B,R),he=Fn(w);let fe=new Lt(0,0);E&&(fe=new Lt(E[0],E[1])),q._rotateAround(he,fe),X._rotateAround(he,fe),te._rotateAround(he,fe),ce._rotateAround(he,fe),D=Math.min(q.x,X.x,te.x,ce.x),B=Math.max(q.x,X.x,te.x,ce.x),M=Math.min(q.y,X.y,te.y,ce.y),R=Math.max(q.y,X.y,te.y,ce.y)}return i.emplaceBack(r.x,r.y,r.z,s.x,s.y,D,M,B,R,x,c,f,m),i.length-1}function KC(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const r=i.bottom-i.top;return r>0?Math.max(10,r):null}function mJ(i,r,s,c){const f=i.compareText;if(r in f){const m=f[r];for(let g=m.length-1;g>=0;g--)if(c.dist(m[g])<s)return!0}else f[r]=[];return f[r].push(c),!1}function GF(i,r){const s=i.fovAboveCenter,c=i.elevation?i.elevation.getMinElevationBelowMSL()*r:0,f=(i._camera.position[2]*i.worldSize-c)/Math.cos(i._pitch),m=Math.sin(s)*f/Math.sin(Math.max(Math.PI/2-i._pitch-s,.01)),g=Math.sin(i._pitch)*m+f;return Math.min(1.01*g,f*(1/i._horizonShift))}function Kf(i,r){if(!r.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:r};const s=Math.pow(2,-i.z),c=i.x*s,f=(i.x+1)*s,m=i.y*s,g=(i.y+1)*s,x=Go(c),w=Go(f),E=Fi(m),M=Fi(g),R=r.project(x,E),D=r.project(w,E),B=r.project(w,M),$=r.project(x,M);let q=Math.min(R.x,D.x,B.x,$.x),X=Math.min(R.y,D.y,B.y,$.y),te=Math.max(R.x,D.x,B.x,$.x),ce=Math.max(R.y,D.y,B.y,$.y);const he=s/16;function fe(we,Ie,ke,$e,nt,He){const ut=(ke+nt)/2,bt=($e+He)/2,ot=r.project(Go(ut),Fi(bt)),yt=Math.max(0,q-ot.x,X-ot.y,ot.x-te,ot.y-ce);q=Math.min(q,ot.x),te=Math.max(te,ot.x),X=Math.min(X,ot.y),ce=Math.max(ce,ot.y),yt>he&&(fe(we,ot,ke,$e,ut,bt),fe(ot,Ie,ut,bt,nt,He))}fe(R,D,c,m,f,m),fe(D,B,f,m,f,g),fe(B,$,f,g,c,g),fe($,R,c,g,c,m),q-=he,X-=he,te+=he,ce+=he;const Ee=1/Math.max(te-q,ce-X);return{scale:Ee,x:q*Ee,y:X*Ee,x2:te*Ee,y2:ce*Ee,projection:r}}function WF(i,{x:r,y:s},c=0){return new Lt(((r-c)*i.scale-i.x)*Mt,(s*i.scale-i.y)*Mt)}const gJ=a.ad.identity(new Float32Array(16));class Jc{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,s){return{x:0,y:0,z:0}}unproject(r,s){return new qn(0,0)}projectTilePoint(r,s,c){return{x:r,y:s,z:0}}locationPoint(r,s,c=!0){return r._coordinatePoint(r.locationCoordinate(s),c)}pixelsPerMeter(r,s){return Mo(1,r)*s}pixelSpaceConversion(r,s,c){return 1}farthestPixelDistance(r){return GF(r,r.pixelsPerMeter)}pointCoordinate(r,s,c,f){const m=r.horizonLineFromTop(!1),g=new Lt(s,Math.max(m,c));return r.rayIntersectionCoordinate(r.pointRayIntersection(g,f))}pointCoordinate3D(r,s,c){const f=new Lt(s,c);if(r.elevation)return r.elevation.pointCoordinate(f);{const m=this.pointCoordinate(r,f.x,f.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(r,s){if(r.elevation&&r.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(r,s.x,s.y);const c=r.horizonLineFromTop();return s.y<c}createInversionMatrix(r,s){return gJ}createTileMatrix(r,s,c){let f,m,g;const x=c.canonical,w=a.ad.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const E=Kf(x,this);f=1,m=E.x+c.wrap*E.scale,g=E.y,a.ad.scale(w,w,[f/E.scale,f/E.scale,r.pixelsPerMeter/s])}else f=s/r.zoomScale(x.z),m=(x.x+Math.pow(2,x.z)*c.wrap)*f,g=x.y*f;return a.ad.translate(w,w,[m,g,0]),a.ad.scale(w,w,[f/Mt,f/Mt,1]),w}upVector(r,s,c){return[0,0,1]}upVectorScale(r,s,c){return{metersToTile:1}}}class yJ extends Jc{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[s,c]=this.parallels=r.parallels||[29.5,45.5],f=Math.sin(Fn(s));this.n=(f+Math.sin(Fn(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(r,s){const{n:c,c:f,r0:m}=this,g=Fn(r-this.center[0]),x=Fn(s),w=Math.sqrt(f-2*c*Math.sin(x))/c;return{x:w*Math.sin(g*c),y:w*Math.cos(g*c)-m,z:0}}unproject(r,s){const{n:c,c:f,r0:m}=this,g=m+s;let x=Math.atan2(r,Math.abs(g))*Math.sign(g);g*c<0&&(x-=Math.PI*Math.sign(r)*Math.sign(g));const w=Fn(this.center[0])*c;x=Jl(x,-Math.PI-w,Math.PI-w);const E=Pn(Zi(x/c)+this.center[0],-180,180),M=Math.asin(Pn((f-(r*r+g*g)*c*c)/(2*c),-1,1)),R=Pn(Zi(M),-ei,ei);return new qn(E,R)}}const V_=1.340264,G_=-.081106,W_=893e-6,H_=.003796,wb=Math.sqrt(3)/2;class _J extends Jc{project(r,s){s=s/180*Math.PI,r=r/180*Math.PI;const c=Math.asin(wb*Math.sin(s)),f=c*c,m=f*f*f;return{x:.5*(r*Math.cos(c)/(wb*(V_+3*G_*f+m*(7*W_+9*H_*f)))/Math.PI+.5),y:1-.5*(c*(V_+G_*f+m*(W_+H_*f))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=c*c,m=f*f*f;for(let M,R,D,B=0;B<12&&(R=c*(V_+G_*f+m*(W_+H_*f))-s,D=V_+3*G_*f+m*(7*W_+9*H_*f),M=R/D,c=Pn(c-M,-Math.PI/3,Math.PI/3),f=c*c,m=f*f*f,!(Math.abs(M)<1e-12));++B);const g=wb*r*(V_+3*G_*f+m*(7*W_+9*H_*f))/Math.cos(c),x=Math.asin(Math.sin(c)/wb),w=Pn(180*g/Math.PI,-180,180),E=Pn(180*x/Math.PI,-ei,ei);return new qn(w,E)}}class vJ extends Jc{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){return{x:.5+r/360,y:.5-s/360,z:0}}unproject(r,s){const c=360*(r-.5),f=Pn(360*(.5-s),-ei,ei);return new qn(c,f)}}const lm=Math.PI/2;function Sb(i){return Math.tan((lm+i)/2)}class xJ extends Jc{constructor(r){super(r),this.center=r.center||[0,30];const[s,c]=this.parallels=r.parallels||[30,30];let f=Fn(s),m=Fn(c);this.southernCenter=f+m<0,this.southernCenter&&(f=-f,m=-m);const g=Math.cos(f),x=Sb(f);this.n=f===m?Math.sin(f):Math.log(g/Math.cos(m))/Math.log(Sb(m)/x),this.f=g*Math.pow(Sb(f),this.n)/this.n}project(r,s){s=Fn(s),this.southernCenter&&(s=-s),r=Fn(r-this.center[0]);const c=1e-6,{n:f,f:m}=this;m>0?s<-lm+c&&(s=-lm+c):s>lm-c&&(s=lm-c);const g=m/Math.pow(Sb(s),f);let x=g*Math.sin(f*r),w=m-g*Math.cos(f*r);return x=.5*(x/Math.PI+.5),w=.5*(w/Math.PI+.5),{x,y:this.southernCenter?w:1-w,z:0}}unproject(r,s){r=(2*r-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f}=this,m=f-s,g=Math.sign(m),x=Math.sign(c)*Math.sqrt(r*r+m*m);let w=Math.atan2(r,Math.abs(m))*g;m*c<0&&(w-=Math.PI*Math.sign(r)*g);const E=Pn(Zi(w/c)+this.center[0],-180,180),M=Pn(Zi(2*Math.atan(Math.pow(f/x,1/c))-lm),-ei,ei);return new qn(E,this.southernCenter?-M:M)}}class HF extends Jc{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,s){return{x:Tl(r),y:El(s),z:0}}unproject(r,s){const c=Go(r),f=Fi(s);return new qn(c,f)}}const qF=Fn(ei);class bJ extends Jc{project(r,s){const c=(s=Fn(s))*s,f=c*c;return{x:.5*((r=Fn(r))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=25,m=0,g=c*c;do{g=c*c;const E=g*g;m=(c*(1.007226+g*(.015085+E*(.028874*g-.044475-.005916*E)))-s)/(1.007226+g*(.045255+E*(.259866*g-.311325-.005916*11*E))),c=Pn(c-m,-qF,qF)}while(Math.abs(m)>1e-6&&--f>0);g=c*c;const x=Pn(Zi(r/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),w=Zi(c);return new qn(x,w)}}const ZF=Fn(ei);class wJ extends Jc{project(r,s){s=Fn(s),r=Fn(r);const c=Math.cos(s),f=2/Math.PI,m=Math.acos(c*Math.cos(r/2)),g=Math.sin(m)/m,x=.5*(r*f+2*c*Math.sin(r/2)/g)||0,w=.5*(s+Math.sin(s)/g)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(w/Math.PI+1),z:0}}unproject(r,s){let c=r=(2*r-.5)*Math.PI,f=s=(2*(1-s)-1)*Math.PI,m=25;const g=1e-6;let x=0,w=0;do{const E=Math.cos(f),M=Math.sin(f),R=2*M*E,D=M*M,B=E*E,$=Math.cos(c/2),q=Math.sin(c/2),X=2*$*q,te=q*q,ce=1-B*$*$,he=ce?1/ce:0,fe=ce?Math.acos(E*$)*Math.sqrt(1/ce):0,Ee=.5*(2*fe*E*q+2*c/Math.PI)-r,we=.5*(fe*M+f)-s,Ie=.5*he*(B*te+fe*E*$*D)+1/Math.PI,ke=he*(X*R/4-fe*M*q),$e=.125*he*(R*q-fe*M*B*X),nt=.5*he*(D*$+fe*te*E)+.5,He=ke*$e-nt*Ie;x=(we*ke-Ee*nt)/He,w=(Ee*$e-we*Ie)/He,c=Pn(c-x,-Math.PI,Math.PI),f=Pn(f-w,-ZF,ZF)}while((Math.abs(x)>g||Math.abs(w)>g)&&--m>0);return new qn(Zi(c),Zi(f))}}class XF extends Jc{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Fn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){const{scale:c,cosPhi:f}=this;return{x:Fn(r)*f*c+.5,y:-Math.sin(Fn(s))/f*c+.5,z:0}}unproject(r,s){const{scale:c,cosPhi:f}=this,m=-(s-.5)/c,g=Pn(Zi((r-.5)/c)/f,-180,180),x=Math.asin(Pn(m*f,-1,1)),w=Pn(Zi(x),-ei,ei);return new qn(g,w)}}class SJ extends HF{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,s,c){const f=M_(r,s,c),m=I_(Al(c));return a._.transformMat4(f,f,m),{x:f[0],y:f[1],z:f[2]}}locationPoint(r,s){const c=Hf(s.lat,s.lng),f=a._.normalize([],c),m=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(s),r._centerAltitude):r._centerAltitude,g=Mo(1,0)*Mt*m;a._.scaleAndAdd(c,c,f,g);const x=a.ad.identity(new Float64Array(16));return a.ad.multiply(x,r.pixelMatrix,r.globeMatrix),a._.transformMat4(c,c,x),new Lt(c[0],c[1])}pixelsPerMeter(r,s){return Mo(1,0)*s}pixelSpaceConversion(r,s,c){const f=Mo(1,r)*s,m=on(Mo(1,45)*s,f,c);return this.pixelsPerMeter(r,s)/m}createTileMatrix(r,s,c){const f=PC(Al(c.canonical));return a.ad.multiply(new Float64Array(16),r.globeMatrix,f)}createInversionMatrix(r,s){const{center:c}=r,f=I_(Al(s));return a.ad.rotateY(f,f,Fn(c.lng)),a.ad.rotateX(f,f,Fn(c.lat)),a.ad.scale(f,f,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(r,s,c,f){return nz(r,s,c,!0)||new so(0,0)}pointCoordinate3D(r,s,c){const f=this.pointCoordinate(r,s,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(r,s){return!nz(r,s.x,s.y,!1)}farthestPixelDistance(r){const s=function(f,m){const g=f.cameraToCenterDistance,x=f._centerAltitude*m,w=f._camera,E=f._camera.forward(),M=a._.add([],a._.scale([],E,-g),[0,0,x]),R=f.worldSize/(2*Math.PI),D=[0,0,-R],B=f.width/f.height,$=Math.tan(f.fovAboveCenter),q=a._.scale([],w.up(),$),X=a._.scale([],w.right(),$*B),te=a._.normalize([],a._.add([],a._.add([],E,q),X)),ce=[];let he;if(new SC(M,te).closestPointOnSphere(D,R,ce)){const fe=a._.add([],ce,D),Ee=a._.sub([],fe,M);he=Math.cos(f.fovAboveCenter)*a._.length(Ee)}else{const fe=a._.sub([],M,D),Ee=a._.sub([],D,M);a._.normalize(Ee,Ee);const we=a._.length(fe)-R;he=Math.sqrt(we*(we+2*R));const Ie=Math.acos(he/(R+we))-Math.acos(a._.dot(E,Ee));he*=Math.cos(Ie)}return 1.01*he}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),c=xu(r.zoom);if(c>0){const f=GF(r,Mo(1,r.center.lat)*r.worldSize),m=r.worldSize/(2*Math.PI),g=Math.max(r.width,r.height)/r.worldSize*Math.PI;return on(s,f+m*(1-Math.cos(g)),Math.pow(c,10))}return s}upVector(r,s,c){return M_(s,c,r,1)}upVectorScale(r){return{metersToTile:K1(J1(Al(r)))}}}function YF(i){const r=i.parallels,s=!!r&&Math.abs(r[0]+r[1])<.01;switch(i.name){case"mercator":return new HF(i);case"equirectangular":return new vJ(i);case"naturalEarth":return new bJ(i);case"equalEarth":return new _J(i);case"winkelTripel":return new wJ(i);case"albers":return s?new XF(i):new yJ(i);case"lambertConformalConic":return s?new XF(i):new xJ(i);case"globe":return new SJ(i)}throw new Error(`Invalid projection name: ${i.name}`)}class Qf{constructor(r,s,c,f){this.id=Qf.uniqueIdxCounter,Qf.uniqueIdxCounter++,this.context=r;const m=r.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||f||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=Qf.uniqueIdxCounter,Qf.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Qf.uniqueIdxCounter=0;class um{constructor(r,s,c){this.func=r,this.mask=s,this.range=c}}um.ReadOnly=!1,um.ReadWrite=!0,um.disabled=new um(519,um.ReadOnly,[0,1]);const QC=7680;class JC{constructor(r,s,c,f,m,g){this.test=r,this.ref=s,this.mask=c,this.fail=f,this.depthFail=m,this.pass=g}}JC.disabled=new JC({func:519,mask:0},0,0,QC,QC,QC);const q_=771;class ua{constructor(r,s,c,f){this.blendFunction=r,this.blendColor=s,this.mask=c,this.blendEquation=f}}ua.Replace=[1,0,1,0],ua.disabled=new ua(ua.Replace,Xn.transparent,[!1,!1,!1,!1]),ua.unblended=new ua(ua.Replace,Xn.transparent,[!0,!0,!0,!0]),ua.alphaBlended=new ua([1,q_,1,q_],Xn.transparent,[!0,!0,!0,!0]),ua.alphaBlendedNonPremultiplied=new ua([770,q_,770,q_],Xn.transparent,[!0,!0,!0,!0]),ua.multiply=new ua([774,0,774,0],Xn.transparent,[!0,!0,!0,!0]);const eP=1029,tP=2305;class js{constructor(r,s,c){this.enable=r,this.mode=s,this.frontFace=c}}js.disabled=new js(!1,eP,tP),js.backCCW=new js(!0,eP,tP),js.backCW=new js(!0,eP,2304),js.frontCW=new js(!0,1028,2304),js.frontCCW=new js(!0,1028,tP);const TJ=ab.types,EJ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Tb(i,r,s,c,f,m,g,x,w,E,M,R,D){const B=x?Math.min(Qc,Math.round(x[0])):0,$=x?Math.min(Qc,Math.round(x[1])):0;i.emplaceBack(r,s,Math.round(32*c),Math.round(32*f),m,g,(B<<1)+(w?1:0),$,16*E,16*M,256*R,256*D)}function Eb(i,r,s){i.emplaceBack(r,s)}function Ab(i,r,s,c,f,m,g){i.emplaceBack(r,s,c,f,m,g)}function Cb(i,r,s,c,f){i.emplaceBack(r,s,c,f),i.emplaceBack(r,s,c,f),i.emplaceBack(r,s,c,f),i.emplaceBack(r,s,c,f)}function AJ(i){for(const r of i.sections)if(ct(r.text))return!0;return!1}class nP{constructor(r){this.layoutVertexArray=new HA,this.indexArray=new Pi,this.programConfigurations=r,this.segments=new Br,this.dynamicLayoutVertexArray=new jc,this.opacityVertexArray=new ZA,this.occlusionQueryOpacityVertexArray=new Vf,this.placedSymbolArray=new AL,this.iconTransitioningVertexArray=new Vc,this.globeExtVertexArray=new qA,this.zOffsetVertexArray=new Vf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(r,s,c,f,m){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,PQ.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,IQ.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,EJ,!0),this.occlusionQueryOpacityVertexBuffer=r.createVertexBuffer(this.occlusionQueryOpacityVertexArray,$C.members,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=r.createVertexBuffer(this.iconTransitioningVertexArray,OQ.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,MQ.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,iF.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.occlusionQueryOpacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}pe(nP,"SymbolBuffers");class rP{constructor(r,s,c){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new c,this.segments=new Br,this.collisionVertexArray=new KA,this.collisionVertexArrayExt=new jc}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,RQ.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,kQ.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}pe(rP,"CollisionBuffers");class cm{constructor(r){this.queries=new Map,this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.lut=r.lut,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=a.ad.identity([]),this.placementViewportMatrix=a.ad.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=VC(this.zoom,s["text-size"]),this.iconSizeData=VC(this.zoom,s["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),m=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(g=>Ia[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=r.sourceID,this.projection=r.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new nP(new Wc(this.layers,{zoom:this.zoom,lut:this.lut},r=>/^text/.test(r))),this.icon=new nP(new Wc(this.layers,{zoom:this.zoom,lut:this.lut},r=>/^icon/.test(r))),this.glyphOffsetArray=new ML,this.lineVertexArray=new IL,this.symbolInstances=new PL}calculateGlyphDependencies(r,s,c,f,m){for(let g=0;g<r.length;g++){const x=r.codePointAt(g);if(x===void 0)break;if(s[x]=!0,f&&m&&x<=65535){const w=B_[r.charAt(g)];w&&(s[w.charCodeAt(0)]=!0)}}}updateFootprints(r,s){}updateReplacement(r,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(r.toUnwrapped(),!0);return!BC(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}populate(r,s,c,f){const m=this.layers[0],g=m.layout,x=this.projection.name==="globe",w=g.get("text-font"),E=g.get("text-field"),M=g.get("icon-image"),R=(E.value.kind!=="constant"||E.value.value instanceof Yi&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),D=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,B=g.get("symbol-sort-key");if(this.features=[],!R&&!D)return;const $=s.iconDependencies,q=s.glyphDependencies,X=s.availableImages,te=new pn(this.zoom);for(const{feature:ce,id:he,index:fe,sourceLayerIndex:Ee}of r){const we=m._featureFilter.needGeometry,Ie=_u(ce,we);if(!m._featureFilter.filter(te,Ie,c))continue;if(we||(Ie.geometry=Fs(ce,c,f)),x&&ce.type!==1&&c.z<=5){const He=Ie.geometry,ut=.98078528056,bt=(ot,yt)=>{const it=M_(ot.x,ot.y,c,1),_t=M_(yt.x,yt.y,c,1);return a._.dot(it,_t)<ut};for(let ot=0;ot<He.length;ot++)He[ot]=hK(He[ot],bt)}let ke,$e;if(R){const He=m.getValueAndResolveTokens("text-field",Ie,c,X),ut=Yi.factory(He);AJ(ut)&&(this.hasRTLText=!0),(!this.hasRTLText||On()==="unavailable"||this.hasRTLText&&lr.isParsed())&&(ke=JQ(ut,m,Ie))}if(D){const He=m.getValueAndResolveTokens("icon-image",Ie,c,X);$e=He instanceof go?He:go.fromString(He)}if(!ke&&!$e)continue;const nt=this.sortFeaturesByKey?B.evaluate(Ie,{},c):void 0;if(this.features.push({id:he,text:ke,icon:$e,index:fe,sourceLayerIndex:Ee,geometry:Ie.geometry,properties:ce.properties,type:TJ[ce.type],sortKey:nt}),$e&&($[$e.namePrimary]=!0,$e.nameSecondary&&($[$e.nameSecondary]=!0)),ke){const He=w.evaluate(Ie,{},c).join(","),ut=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ia.vertical)>=0;for(const bt of ke.sections)if(bt.image)$[bt.image.namePrimary]=!0;else{const ot=We(ke.toString()),yt=bt.fontStack||He,it=q[yt]=q[yt]||{};this.calculateGlyphDependencies(bt.text,it,ut,this.allowVerticalPlacement,ot)}}}g.get("symbol-placement")==="line"&&(this.features=function(ce){const he={},fe={},Ee=[];let we=0;function Ie(He){Ee.push(ce[He]),we++}function ke(He,ut,bt){const ot=fe[He];return delete fe[He],fe[ut]=ot,Ee[ot].geometry[0].pop(),Ee[ot].geometry[0]=Ee[ot].geometry[0].concat(bt[0]),ot}function $e(He,ut,bt){const ot=he[ut];return delete he[ut],he[He]=ot,Ee[ot].geometry[0].shift(),Ee[ot].geometry[0]=bt[0].concat(Ee[ot].geometry[0]),ot}function nt(He,ut,bt){const ot=bt?ut[0][ut[0].length-1]:ut[0][0];return`${He}:${ot.x}:${ot.y}`}for(let He=0;He<ce.length;He++){const ut=ce[He],bt=ut.geometry,ot=ut.text?ut.text.toString():null;if(!ot){Ie(He);continue}const yt=nt(ot,bt),it=nt(ot,bt,!0);if(yt in fe&&it in he&&fe[yt]!==he[it]){const _t=$e(yt,it,bt),Tt=ke(yt,it,Ee[_t].geometry);delete he[yt],delete fe[it],fe[nt(ot,Ee[Tt].geometry,!0)]=Tt,Ee[_t].geometry=null}else yt in fe?ke(yt,it,bt):it in he?$e(yt,it,bt):(Ie(He),he[yt]=we-1,fe[it]=we-1)}return Ee.filter(He=>He.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,he)=>ce.sortKey-he.sortKey)}update(r,s,c,f,m){const g=Object.keys(r).length!==0;if(g&&!this.stateDependentLayers.length)return;const x=g?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(r,s,x,c,f,m),this.icon.programConfigurations.updatePaintArrays(r,s,x,c,f,m)}updateOcclusionOpacities(r,s,c){if(!s.useOcclusionQueries)return!1;const f=this;if(f.projection.name==="globe")return!1;let m=!1;f.hasTextData()&&(m=m||f.text.occlusionQueryOpacityVertexArray.length!==0),f.hasIconData()&&(m=m||f.icon.occlusionQueryOpacityVertexArray.length!==0);const g=f.layers[0].paint,x=g.get("icon-occlusion-opacity").constantOr(0),w=g.get("text-occlusion-opacity").constantOr(0);if(!f.layers[0].hasInitialOcclusionOpacityProperties||x===1&&w===1)return!1;let E=!m;for(let B=0;B<f.symbolInstances.length;B++){const $=f.symbolInstances.get(B),q=$.occlusionOpacity;$.occlusionOpacity+=($.occlusionState>.5?1:-1)*s.fadeSpeed*c*.001,$.occlusionOpacity=Pn($.occlusionOpacity,0,1),E=E||$.occlusionOpacity!==q}if(!E)return!1;let M=0,R=0;const D=(B,$,q,X)=>{let te=0,ce=0;q?(te=R,R+=X,ce=R):(te=M,M+=X,ce=M),ce>$.occlusionQueryOpacityVertexArray.length&&$.occlusionQueryOpacityVertexArray.resize(ce);const he=B.occlusionOpacity;for(let fe=0;fe<X;fe++)$.occlusionQueryOpacityVertexArray.emplace(fe+te,he)};for(let B=0;B<f.symbolInstances.length;B++){const $=f.symbolInstances.get(B),{numHorizontalGlyphVertices:q,numVerticalGlyphVertices:X,numIconVertices:te}=$,ce=te>0;if((q>0||X>0)&&(D($,f.text,!1,q),D($,f.text,!1,X)),ce){const{placedIconSymbolIndex:he,verticalPlacedIconSymbolIndex:fe}=$;he>=0&&D($,f.icon,!0,te),fe>=0&&D($,f.icon,!0,$.numVerticalIconVertices)}}return f.hasTextData()&&f.text.occlusionQueryOpacityVertexBuffer&&(f.text.occlusionQueryOpacityVertexBuffer.length<f.text.occlusionQueryOpacityVertexArray.length?f.text.occlusionQueryOpacityVertexBuffer=r.createVertexBuffer(f.text.occlusionQueryOpacityVertexArray,$C.members,!0):f.text.occlusionQueryOpacityVertexBuffer.updateData(f.text.occlusionQueryOpacityVertexArray)),f.hasIconData()&&f.icon.occlusionQueryOpacityVertexBuffer&&(f.icon.occlusionQueryOpacityVertexBuffer.length<f.icon.occlusionQueryOpacityVertexArray.length?f.icon.occlusionQueryOpacityVertexBuffer=r.createVertexBuffer(f.icon.occlusionQueryOpacityVertexArray,$C.members,!0):f.icon.occlusionQueryOpacityVertexBuffer.updateData(f.icon.occlusionQueryOpacityVertexArray)),!0}updateZOffset(){const r=(m,g,x)=>{c+=g,c>m.length&&m.resize(c);for(let w=-g;w<0;w++)m.emplace(w+c,x)},s=(m,g,x)=>{f+=g,f>m.length&&m.resize(f);for(let w=-g;w<0;w++)m.emplace(w+f,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,f=0;for(let m=0;m<this.symbolInstances.length;m++){const g=this.symbolInstances.get(m),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:w,numIconVertices:E}=g,M=g.zOffset,R=E>0;if((x>0||w>0)&&(r(this.text.zOffsetVertexArray,x,M),r(this.text.zOffsetVertexArray,w,M)),R){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:B}=g;D>=0&&s(this.icon.zOffsetVertexArray,E,M),B>=0&&s(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,M)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=YF(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData();for(const r of this.queries.values())r.destroy()}addToLineVertexArray(r,s){const c=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:f,y:m}of s)this.lineVertexArray.emplaceBack(f,m);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,s,c,f,m,g,x,w,E,M,R,D,B,$,q,X){const te=r.indexArray,ce=r.layoutVertexArray,he=r.globeExtVertexArray,fe=r.segments.prepareSegment(4*s.length,ce,te,this.canOverlap?g.sortKey:void 0),Ee=this.glyphOffsetArray.length,we=fe.vertexLength,Ie=this.allowVerticalPlacement&&x===Ia.vertical?Math.PI/2:0,ke=g.text&&g.text.sections;for(let nt=0;nt<s.length;nt++){const{tl:He,tr:ut,bl:bt,br:ot,texPrimary:yt,texSecondary:it,pixelOffsetTL:_t,pixelOffsetBR:Tt,minFontScaleX:xt,minFontScaleY:Ft,glyphOffset:wt,isSDF:Ct,sectionIndex:Jt}=s[nt],Kt=fe.vertexLength,Ht=wt[1];if(Tb(ce,E.x,E.y,He.x,Ht+He.y,yt.x,yt.y,c,Ct,_t.x,_t.y,xt,Ft),Tb(ce,E.x,E.y,ut.x,Ht+ut.y,yt.x+yt.w,yt.y,c,Ct,Tt.x,_t.y,xt,Ft),Tb(ce,E.x,E.y,bt.x,Ht+bt.y,yt.x,yt.y+yt.h,c,Ct,_t.x,Tt.y,xt,Ft),Tb(ce,E.x,E.y,ot.x,Ht+ot.y,yt.x+yt.w,yt.y+yt.h,c,Ct,Tt.x,Tt.y,xt,Ft),w){const{x:Et,y:tn,z:xn}=w.anchor,[un,Tn,bn]=w.up;Ab(he,Et,tn,xn,un,Tn,bn),Ab(he,Et,tn,xn,un,Tn,bn),Ab(he,Et,tn,xn,un,Tn,bn),Ab(he,Et,tn,xn,un,Tn,bn),Cb(r.dynamicLayoutVertexArray,Et,tn,xn,Ie)}else Cb(r.dynamicLayoutVertexArray,E.x,E.y,E.z,Ie);if(X){const Et=it||yt;Eb(r.iconTransitioningVertexArray,Et.x,Et.y),Eb(r.iconTransitioningVertexArray,Et.x+Et.w,Et.y),Eb(r.iconTransitioningVertexArray,Et.x,Et.y+Et.h),Eb(r.iconTransitioningVertexArray,Et.x+Et.w,Et.y+Et.h)}te.emplaceBack(Kt,Kt+1,Kt+2),te.emplaceBack(Kt+1,Kt+2,Kt+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wt[0]),nt!==s.length-1&&Jt===s[nt+1].sectionIndex||r.programConfigurations.populatePaintArrays(ce.length,g,g.index,{},B,$,q,ke&&ke[Jt])}const $e=w?w.anchor:E;r.placedSymbolArray.emplaceBack($e.x,$e.y,$e.z,E.x,E.y,Ee,this.glyphOffsetArray.length-Ee,we,M,R,E.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],x,0,!1,0,D,0)}_commitLayoutVertex(r,s,c,f,m,g,x){r.emplaceBack(s,c,f,m,g,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(r,s,c,f,m,g,x){const w=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),E=w.vertexLength,M=x.tileAnchorX,R=x.tileAnchorY;for(let B=0;B<4;B++)c.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,s,r.padding,x.zOffset),this._commitLayoutVertex(c.layoutVertexArray,f,m,g,M,R,new Lt(r.x1,r.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,m,g,M,R,new Lt(r.x2,r.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,m,g,M,R,new Lt(r.x2,r.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,m,g,M,R,new Lt(r.x1,r.y2)),w.vertexLength+=4;const D=c.indexArray;D.emplaceBack(E,E+1),D.emplaceBack(E+1,E+2),D.emplaceBack(E+2,E+3),D.emplaceBack(E+3,E),w.primitiveLength+=4}_addTextDebugCollisionBoxes(r,s,c,f,m,g){for(let x=f;x<m;x++){const w=c.get(x),E=this.getSymbolInstanceTextSize(r,g,s,x);this._addCollisionDebugVertices(w,E,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(r,s,c,f,m,g){for(let x=f;x<m;x++){const w=c.get(x),E=this.getSymbolInstanceIconSize(r,s,g.placedIconSymbolIndex);this._addCollisionDebugVertices(w,E,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}generateCollisionDebugBuffers(r,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rP(U1,oF.members,Vc),this.iconCollisionBox=new rP(U1,oF.members,Vc);const c=im(this.iconSizeData,r),f=im(this.textSizeData,r);for(let m=0;m<this.symbolInstances.length;m++){const g=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(f,r,s,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(f,r,s,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(c,r,s,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(c,r,s,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(r,s,c,f){const m=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:f),g=gb(this.textSizeData,r,m)/Ki;return this.tilePixelRatio*g}getSymbolInstanceIconSize(r,s,c){const f=this.icon.placedSymbolArray.get(c),m=gb(this.iconSizeData,r,f);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(r,s,c,f){r.emplaceBack(s,-c,-c,f),r.emplaceBack(s,c,-c,f),r.emplaceBack(s,c,c,f),r.emplaceBack(s,-c,c,f)}_updateTextDebugCollisionBoxes(r,s,c,f,m,g){for(let x=f;x<m;x++){const w=c.get(x),E=this.getSymbolInstanceTextSize(r,g,s,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,w.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(r,s,c,f,m,g){for(let x=f;x<m;x++){const w=c.get(x),E=this.getSymbolInstanceIconSize(r,s,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,E,w.padding,g.zOffset)}}updateCollisionDebugBuffers(r,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=im(this.iconSizeData,r),f=im(this.textSizeData,r);for(let m=0;m<this.symbolInstances.length;m++){const g=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(f,r,s,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(f,r,s,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(c,r,s,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._updateIconDebugCollisionBoxes(c,r,s,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,s,c,f,m,g,x,w,E){const M={};if(s<c){const{x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe,featureIndex:Ee}=r.get(s);M.textBox={x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe},M.textFeatureIndex=Ee}if(f<m){const{x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe,featureIndex:Ee}=r.get(f);M.verticalTextBox={x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe},M.verticalTextFeatureIndex=Ee}if(g<x){const{x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe,featureIndex:Ee}=r.get(g);M.iconBox={x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe},M.iconFeatureIndex=Ee}if(w<E){const{x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe,featureIndex:Ee}=r.get(w);M.verticalIconBox={x1:R,y1:D,x2:B,y2:$,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:fe},M.verticalIconFeatureIndex=Ee}return M}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(r,s){const c=r.placedSymbolArray.get(s),f=c.vertexStartIndex+4*c.numGlyphs;for(let m=c.vertexStartIndex;m<f;m+=4)r.indexArray.emplaceBack(m,m+1,m+2),r.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),c=Math.cos(r),f=[],m=[],g=[];for(let x=0;x<this.symbolInstances.length;++x){g.push(x);const w=this.symbolInstances.get(x);f.push(0|Math.round(s*w.tileAnchorX+c*w.tileAnchorY)),m.push(w.featureIndex)}return g.sort((x,w)=>f[x]-f[w]||m[w]-m[x]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let r=0;r<this.symbolInstances.length;++r)this.symbolInstanceIndexesSortedZOffset.push(r)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((r,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(r).zOffset)}addToSortKeyRanges(r,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:w,verticalPlacedIconSymbolIndex:E}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),m>=0&&m!==f&&this.addIndicesForPlacedSymbol(this.text,m),g>=0&&g!==m&&g!==f&&this.addIndicesForPlacedSymbol(this.text,g),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}pe(cm,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),cm.addDynamicAttributes=Cb;class as{constructor(r,s,c,f){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(s,f)}update(r,s,c){const{width:f,height:m}=r,{context:g}=this,{gl:x}=g;if(x.bindTexture(x.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===f&&this.size[1]===m){const{x:w,y:E}=c||{x:0,y:0};if(r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap)x.texSubImage2D(x.TEXTURE_2D,0,w,E,x.RGBA,x.UNSIGNED_BYTE,r);else{let M=this.format,R=x.UNSIGNED_BYTE;this.format===x.R32F&&(M=x.RED,R=x.FLOAT),x.texSubImage2D(x.TEXTURE_2D,0,w,E,f,m,M,R,r.data)}}else if(this.size=[f,m],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap){let w=this.format;this.format===x.R8&&(w=x.RED),x.texImage2D(x.TEXTURE_2D,0,this.format,w,x.UNSIGNED_BYTE,r)}else{let w=this.format,E=this.format,M=x.UNSIGNED_BYTE;this.format===x.DEPTH_COMPONENT&&(w=x.DEPTH_COMPONENT16,M=x.UNSIGNED_SHORT),this.format===x.R8&&(E=x.RED),this.format===x.R32F&&(M=x.FLOAT,E=x.RED),x.texImage2D(x.TEXTURE_2D,0,w,f,m,0,E,M,r.data)}this.useMipmap=!!(s&&s.useMipmap),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(r,s,c=!1){const{context:f}=this,{gl:m}=f;m.bindTexture(m.TEXTURE_2D,this.texture),r!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!c?r===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),s!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(r,s,c,f){const{context:m}=this,{gl:g}=m;g.bindTexture(g.TEXTURE_2D,this.texture),s!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,s),this.magFilter=s),r!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?r===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),c!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,c),this.wrapS=c),f!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,f),this.wrapT=f)}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class Pb{constructor(r,s){this.context=r,this.texture=s}bind(r,s){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),r!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,r),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,r),this.minFilter=r),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrapS=s)}}const ss=32,Pl=33,eh=new Uint16Array(8184);for(let i=0;i<2046;i++){let r=i+2,s=0,c=0,f=0,m=0,g=0,x=0;for(1&r?f=m=g=ss:s=c=x=ss;(r>>=1)>1;){const E=s+f>>1,M=c+m>>1;1&r?(f=s,m=c,s=g,c=x):(s=f,c=m,f=g,m=x),g=E,x=M}const w=4*i;eh[w+0]=s,eh[w+1]=c,eh[w+2]=f,eh[w+3]=m}const Ml=new Uint16Array(2178),th=new Uint8Array(1089),Mb=new Uint16Array(1089);function KF(i){return i===0?-.03125:i===32?.03125:0}var Ib=rr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),CJ=rr([{name:"a_index",type:"Int16",components:1}]);const QF={type:2,extent:Mt,loadGeometry:()=>[[new Lt(0,0),new Lt(Mt+1,0),new Lt(Mt+1,Mt+1),new Lt(0,Mt+1),new Lt(0,0)]]};class Ob{constructor(r,s,c,f,m){this.tileID=r,this.uid=sp(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,f&&f.style&&(this._lastUpdatedBrightness=f.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(r){const s=r+this.timeAdded;s<Di.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Kf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,s,c){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(f,m){const g={};if(!m)return g;for(const x of f){const w=x.layerIds.map(E=>m.getLayer(E)).filter(Boolean);if(w.length!==0){x.layers=w,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(E=>w.filter(M=>M.id===E)[0]));for(const E of w)g[E.fqid]=x}}return g}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const m=this.buckets[f];if(m instanceof cm){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const m=this.buckets[f];if(m instanceof cm&&m.hasRTLText){this.hasRTLText=!0,lr.isLoading()||lr.isLoaded()||On()!=="deferred"||Nn();break}}this.queryPadding=0;for(const f in this.buckets){const m=this.buckets[f],g=s.style.getOwnLayer(f);if(!g)continue;const x=g.queryRadius(m);this.queryPadding=Math.max(this.queryPadding,x)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new oC}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const f in this.buckets){const m=this.buckets[f];m.uploadPending()&&m.upload(r)}const s=r.gl,c=this.imageAtlas;if(c&&!c.uploaded){const f=!!Object.keys(c.patternPositions).length;this.imageAtlasTexture=new as(r,c.image,s.RGBA,{useMipmap:f}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new as(r,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new as(r,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(r,s,c){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,c),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const f=s.style.getBrightness();(this._lastUpdatedBrightness||f)&&(this._lastUpdatedBrightness&&f&&Math.abs(this._lastUpdatedBrightness-f)<.001||(this._lastUpdatedBrightness=f,this.updateBuckets(void 0,s)))}queryRenderedFeatures(r,s,c,f,m,g,x,w){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:x,transform:g,params:m,tileTransform:this.tileTransform},r,s,c):{}}querySourceFeatures(r,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),m=s?s.sourceLayer:"",g=f._geojsonTileLayer||f[m];if(!g)return;const x=Ti(s&&s.filter),{z:w,x:E,y:M}=this.tileID.canonical,R={z:w,x:E,y:M};for(let D=0;D<g.length;D++){const B=g.feature(D);if(x.needGeometry){const X=_u(B,!0);if(!x.filter(new pn(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!x.filter(new pn(this.tileID.overscaledZ),B))continue;const $=c.getId(B,m),q=new vF(B,w,E,M,$);q.tile=R,r.push(q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const r in this.buckets)if(this.buckets[r].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const c=Py(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(s)if(this.expirationTime<s)f=!0;else{const m=this.expirationTime-s;m?this.expirationTime=c+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(r).length!==0&&s&&this.updateBuckets(r,s)}updateBuckets(r,s){if(!this.latestFeatureIndex)return;const c=this.latestFeatureIndex.loadVTLayers(),f=s.style.listImages(),m=s.style.getBrightness();for(const g in this.buckets){if(!s.style.hasLayer(g))continue;const x=this.buckets[g],w=x.layers[0].sourceLayer||"_geojsonTileLayer",E=c[w];let M={};if(r&&(M=r[w],!E||!M||Object.keys(M).length===0))continue;if(x.update(M,E,f,this.imageAtlas&&this.imageAtlas.patternPositions||{},m),x instanceof fb||x instanceof ib){const D=s.style.getOwnSourceCache(x.layers[0].source);s._terrain&&s._terrain.enabled&&D&&x.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(D.id,this.tileID)}const R=s&&s.style&&s.style.getOwnLayer(g);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Di.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=Di.now()+r}setTexture(r,s){const c=s.context,f=c.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof as?this.texture.update(r,{useMipmap:!0}):(this.texture=new as(c,r,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(r,s){const c={};for(const f of s)c[f]=!0;this.dependencies[r]=c}hasDependency(r,s){for(const c of r){const f=this.dependencies[c];if(f){for(const m of s)if(f[m])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=Fs(QF,this.tileID.canonical,this.tileTransform)[0],f=new Ls,m=new w_;for(let g=0;g<c.length;g++){const{x,y:w}=c[g];f.emplaceBack(x,w),m.emplaceBack(g)}m.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(m),this._tileDebugBuffer=r.createVertexBuffer(f,P_.members),this._tileDebugSegments=Br.simpleSegment(0,0,f.length,m.length)}_makeTileBoundsBuffers(r,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=Fs(QF,this.tileID.canonical,this.tileTransform)[0];let f,m;if(this.isRaster){const g=function(x,w){const E=Kf(x,w),M=Math.pow(2,x.z);for(let X=0;X<Pl;X++)for(let te=0;te<Pl;te++){const ce=Go((x.x+(te+KF(te))/ss)/M),he=Fi((x.y+(X+KF(X))/ss)/M),fe=w.project(ce,he),Ee=X*Pl+te;Ml[2*Ee+0]=Math.round((fe.x*E.scale-E.x)*Mt),Ml[2*Ee+1]=Math.round((fe.y*E.scale-E.y)*Mt)}th.fill(0),Mb.fill(0);for(let X=2045;X>=0;X--){const te=4*X,ce=eh[te+0],he=eh[te+1],fe=eh[te+2],Ee=eh[te+3],we=ce+fe>>1,Ie=he+Ee>>1,ke=we+Ie-he,$e=Ie+ce-we,nt=he*Pl+ce,He=Ee*Pl+fe,ut=Ie*Pl+we,bt=Math.hypot((Ml[2*nt+0]+Ml[2*He+0])/2-Ml[2*ut+0],(Ml[2*nt+1]+Ml[2*He+1])/2-Ml[2*ut+1])>=16;th[ut]=th[ut]||(bt?1:0),X<1022&&(th[ut]=th[ut]||th[(he+$e>>1)*Pl+(ce+ke>>1)]||th[(Ee+$e>>1)*Pl+(fe+ke>>1)])}const R=new Bc,D=new Pi;let B=0;function $(X,te){const ce=te*Pl+X;return Mb[ce]===0&&(R.emplaceBack(Ml[2*ce+0],Ml[2*ce+1],X*Mt/ss,te*Mt/ss),Mb[ce]=++B),Mb[ce]-1}function q(X,te,ce,he,fe,Ee){const we=X+ce>>1,Ie=te+he>>1;if(Math.abs(X-fe)+Math.abs(te-Ee)>1&&th[Ie*Pl+we])q(fe,Ee,X,te,we,Ie),q(ce,he,fe,Ee,we,Ie);else{const ke=$(X,te),$e=$(ce,he),nt=$(fe,Ee);D.emplaceBack(ke,$e,nt)}}return q(0,0,ss,ss,ss,0),q(ss,ss,0,0,0,ss),{vertices:R,indices:D}}(this.tileID.canonical,s);f=g.vertices,m=g.indices}else{f=new Bc,m=new Pi;for(const{x,y:w}of c)f.emplaceBack(x,w,0,0);const g=R_(f.int16,void 0,4);for(let x=0;x<g.length;x+=3)m.emplaceBack(g[x],g[x+1],g[x+2])}this._tileBoundsBuffer=r.createVertexBuffer(f,Ib.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(m),this._tileBoundsSegments=Br.simpleSegment(0,0,f.length,m.length)}_makeGlobeTileDebugBuffers(r,s){const c=s.projection;if(!c||c.name!=="globe"||s.freezeTileCoverage)return;const f=this.tileID.canonical,m=I_(rz(f,s)),g=xu(s.zoom);let x;g>0&&(x=a.ad.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,f,s,m,x,g),this._makeGlobeTileDebugTextBuffer(r,f,s,m,x,g)}_globePoint(r,s,c,f,m,g,x){let w=M_(r,s,c);if(g){const E=1<<c.z,M=Tl(f.center.lng),R=El(f.center.lat),D=(c.x+.5)/E-M;let B=0;D>.5?B=-1:D<-.5&&(B=1);let $=(r/Mt+c.x)/E+B,q=(s/Mt+c.y)/E;$=($-M)*f._pixelsPerMercatorPixel+M,q=(q-R)*f._pixelsPerMercatorPixel+R;const X=[$*f.worldSize,q*f.worldSize,0];a._.transformMat4(X,X,g),w=vu(w,X,x)}return a._.transformMat4(w,w,m)}_makeGlobeTileDebugBorderBuffer(r,s,c,f,m,g){const x=new Ls,w=new w_,E=new B1,M=(D,B,$,q,X)=>{const te=($-D)/(X-1),ce=(q-B)/(X-1),he=x.length;for(let fe=0;fe<X;fe++){const Ee=D+fe*te,we=B+fe*ce;x.emplaceBack(Ee,we);const Ie=this._globePoint(Ee,we,s,c,f,m,g);E.emplaceBack(Ie[0],Ie[1],Ie[2]),w.emplaceBack(he+fe)}},R=Mt;M(0,0,R,0,16),M(R,0,R,R,16),M(R,R,0,R,16),M(0,R,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(w),this._tileDebugBuffer=r.createVertexBuffer(x,P_.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(E,tz.members),this._tileDebugSegments=Br.simpleSegment(0,0,x.length,w.length)}_makeGlobeTileDebugTextBuffer(r,s,c,f,m,g){const x=Mt/4,w=new Ls,E=new Pi,M=new B1,R=25;E.reserve(32),w.reserve(R),M.reserve(R);const D=(B,$)=>R*B+$;for(let B=0;B<R;B++){const $=B*x;for(let q=0;q<R;q++){const X=q*x;w.emplaceBack(X,$);const te=this._globePoint(X,$,s,c,f,m,g);M.emplaceBack(te[0],te[1],te[2])}}for(let B=0;B<4;B++)for(let $=0;$<4;$++){const q=D(B,$),X=D(B,$+1),te=D(B+1,$),ce=D(B+1,$+1);E.emplaceBack(q,X,te),E.emplaceBack(te,X,ce)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(E),this._tileDebugTextBuffer=r.createVertexBuffer(w,P_.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(M,tz.members),this._tileDebugTextSegments=Br.simpleSegment(0,0,R,32)}destroy(r=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof as&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const _n={read:function(i,r){return i.readFields(_n._readField,{header_length:0,x:0,y:0,z:0,layers:[]},r)},_readField:function(i,r,s){i===1?r.header_length=s.readFixed32():i===2?r.x=s.readVarint():i===3?r.y=s.readVarint():i===4?r.z=s.readVarint():i===5&&r.layers.push(_n.Layer.read(s,s.readVarint()+s.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};_n.Filter.read=function(i,r){return i.readFields(_n.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},r)},_n.Filter._readField=function(i,r,s){i===1?(r.delta_filter=_n.Filter.Delta.read(s,s.readVarint()+s.pos),r.filter="delta_filter"):i===2?(r.zigzag_filter=_n.Filter.Zigzag.read(s,s.readVarint()+s.pos),r.filter="zigzag_filter"):i===3?(r.bitshuffle_filter=_n.Filter.BitShuffle.read(s,s.readVarint()+s.pos),r.filter="bitshuffle_filter"):i===4&&(r.byteshuffle_filter=_n.Filter.ByteShuffle.read(s,s.readVarint()+s.pos),r.filter="byteshuffle_filter")},_n.Filter.Delta={},_n.Filter.Delta.read=function(i,r){return i.readFields(_n.Filter.Delta._readField,{block_size:0},r)},_n.Filter.Delta._readField=function(i,r,s){i===1&&(r.block_size=s.readVarint())},_n.Filter.Zigzag={},_n.Filter.Zigzag.read=function(i,r){return i.readFields(_n.Filter.Zigzag._readField,{},r)},_n.Filter.Zigzag._readField=function(i,r,s){},_n.Filter.BitShuffle={},_n.Filter.BitShuffle.read=function(i,r){return i.readFields(_n.Filter.BitShuffle._readField,{},r)},_n.Filter.BitShuffle._readField=function(i,r,s){},_n.Filter.ByteShuffle={},_n.Filter.ByteShuffle.read=function(i,r){return i.readFields(_n.Filter.ByteShuffle._readField,{},r)},_n.Filter.ByteShuffle._readField=function(i,r,s){},_n.Codec={},_n.Codec.read=function(i,r){return i.readFields(_n.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},r)},_n.Codec._readField=function(i,r,s){i===1?(r.gzip_data=_n.Codec.GzipData.read(s,s.readVarint()+s.pos),r.codec="gzip_data"):i===2?(r.jpeg_image=_n.Codec.JpegImage.read(s,s.readVarint()+s.pos),r.codec="jpeg_image"):i===3?(r.webp_image=_n.Codec.WebpImage.read(s,s.readVarint()+s.pos),r.codec="webp_image"):i===4&&(r.png_image=_n.Codec.PngImage.read(s,s.readVarint()+s.pos),r.codec="png_image")},_n.Codec.GzipData={},_n.Codec.GzipData.read=function(i,r){return i.readFields(_n.Codec.GzipData._readField,{},r)},_n.Codec.GzipData._readField=function(i,r,s){},_n.Codec.JpegImage={},_n.Codec.JpegImage.read=function(i,r){return i.readFields(_n.Codec.JpegImage._readField,{},r)},_n.Codec.JpegImage._readField=function(i,r,s){},_n.Codec.WebpImage={},_n.Codec.WebpImage.read=function(i,r){return i.readFields(_n.Codec.WebpImage._readField,{},r)},_n.Codec.WebpImage._readField=function(i,r,s){},_n.Codec.PngImage={},_n.Codec.PngImage.read=function(i,r){return i.readFields(_n.Codec.PngImage._readField,{},r)},_n.Codec.PngImage._readField=function(i,r,s){},_n.DataIndexEntry={},_n.DataIndexEntry.read=function(i,r){return i.readFields(_n.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},r)},_n.DataIndexEntry._readField=function(i,r,s){i===1?r.first_byte=s.readFixed64():i===2?r.last_byte=s.readFixed64():i===3?r.filters.push(_n.Filter.read(s,s.readVarint()+s.pos)):i===4?r.codec=_n.Codec.read(s,s.readVarint()+s.pos):i===5?r.offset=s.readFloat():i===6?r.scale=s.readFloat():i===7&&r.bands.push(s.readString())},_n.Layer={},_n.Layer.read=function(i,r){return i.readFields(_n.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},r)},_n.Layer._readField=function(i,r,s){i===1?r.version=s.readVarint():i===2?r.name=s.readString():i===3?r.units=s.readString():i===4?r.tilesize=s.readVarint():i===5?r.buffer=s.readVarint():i===6?r.pixel_format=s.readVarint():i===7&&r.data_index.push(_n.DataIndexEntry.read(s,s.readVarint()+s.pos))};const $s={read:function(i,r){return i.readFields($s._readField,{uint32_values:null,values:null,fixed32_values:null},r)},_readField:function(i,r,s){i===2?(r.uint32_values=$s.Uint32Values.read(s,s.readVarint()+s.pos),r.values="uint32_values"):i===3&&(r.fixed32_values=$s.Fixed32Values.read(s,s.readVarint()+s.pos),r.values="fixed32_values")},Uint32Values:{}};$s.Uint32Values.read=function(i,r){return i.readFields($s.Uint32Values._readField,{values:[]},r)},$s.Uint32Values._readField=function(i,r,s){i===1&&(r.readValuesInto=function(c){if(c.type!==2)throw new Error(`Unsupported pbf type "${c.type}"`);const f=function(g){return g.type===2?g.readVarint()+g.pos:g.pos+1}(c),m=c.pos;return c.pos=f,function(g){c.pos=m;let x=0;for(;c.pos<f;){const w=c.readVarint();g[x++]=w}return g}}(s))},$s.Fixed32Values={},$s.Fixed32Values.read=function(i,r){return i.readFields($s.Fixed32Values._readField,{values:[]},r)},$s.Fixed32Values._readField=function(i,r,s){throw new Error("Not implemented")};/**
 * tiny-lru
 *
 * @copyright 2024 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.2.6
 */class PJ{constructor(r=0,s=0,c=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=r,this.resetTtl=c,this.size=0,this.ttl=s}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(r){if(this.has(r)){const s=this.items[r];delete this.items[r],this.size--,s.prev!==null&&(s.prev.next=s.next),s.next!==null&&(s.next.prev=s.prev),this.first===s&&(this.first=s.next),this.last===s&&(this.last=s.prev)}return this}entries(r=this.keys()){return r.map(s=>[s,this.get(s)])}evict(r=!1){if(r||this.size>0){const s=this.first;delete this.items[s.key],--this.size==0?(this.first=null,this.last=null):(this.first=s.next,this.first.prev=null)}return this}expiresAt(r){let s;return this.has(r)&&(s=this.items[r].expiry),s}get(r){let s;if(this.has(r)){const c=this.items[r];this.ttl>0&&c.expiry<=Date.now()?this.delete(r):(s=c.value,this.set(r,s,!0))}return s}has(r){return r in this.items}keys(){const r=[];let s=this.first;for(;s!==null;)r.push(s.key),s=s.next;return r}set(r,s,c=!1,f=this.resetTtl){let m;if(c||this.has(r)){if(m=this.items[r],m.value=s,c===!1&&f&&(m.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==m){const g=this.last,x=m.next,w=m.prev;this.first===m&&(this.first=m.next),m.next=null,m.prev=this.last,g.next=m,w!==null&&(w.next=x),x!==null&&(x.prev=w)}}else this.max>0&&this.size===this.max&&this.evict(!0),m=this.items[r]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:r,prev:this.last,next:null,value:s},++this.size==1?this.first=m:this.last.next=m;return this.last=m,this}values(r=this.keys()){return r.map(s=>this.get(s))}}function MJ(i,r){if(r.length!==4)throw new Error(`Expected data of dimension 4 but got ${r.length}.`);let s=r[3];for(let c=2;c>=1;c--){const f=c===1?1:0,m=c===2?1:0;for(let g=0;g<r[0];g++){const x=r[1]*g;for(let w=f;w<r[1];w++){const E=r[2]*(w+x);for(let M=m;M<r[2];M++){const R=r[3]*(M+E);for(let D=0;D<r[3];D++){const B=R+D;i[B]+=i[B-s]}}}}s*=r[c]}return i}function IJ(i){for(let r=0,s=i.length;r<s;r++)i[r]=i[r]>>>1^-(1&i[r]);return i}function OJ(i,r){switch(r){case"uint32":return i;case"uint16":for(let s=0;s<i.length;s+=2){const c=i[s],f=i[s+1];i[s]=(240&c)>>4|(61440&c)>>8|(240&f)<<4|61440&f,i[s+1]=15&c|(3840&c)>>4|(15&f)<<8|(3840&f)<<4}return i;case"uint8":for(let s=0;s<i.length;s+=4){const c=i[s],f=i[s+1],m=i[s+2],g=i[s+3];i[s+0]=(192&c)>>6|(192&f)>>4|(192&m)>>2|192&g,i[s+1]=(48&c)>>4|(48&f)>>2|48&m|(48&g)<<2,i[s+2]=(12&c)>>2|12&f|(12&m)<<2|(12&g)<<4,i[s+3]=3&c|(3&f)<<2|(3&m)<<4|(3&g)<<6}return i;default:throw new Error(`Invalid pixel format, "${r}"`)}}class nh extends Error{constructor(r){super(r),this.name="MRTError"}}var Oa=Uint8Array,Z_=Uint16Array,RJ=Int32Array,JF=new Oa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),eN=new Oa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),kJ=new Oa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tN=function(i,r){for(var s=new Z_(31),c=0;c<31;++c)s[c]=r+=1<<i[c-1];var f=new RJ(s[30]);for(c=1;c<30;++c)for(var m=s[c];m<s[c+1];++m)f[m]=m-s[c]<<5|c;return{b:s,r:f}},nN=tN(JF,2),rN=nN.b,DJ=nN.r;rN[28]=258,DJ[258]=28;for(var LJ=tN(eN,0).b,iN=new Z_(32768),oi=0;oi<32768;++oi){var hm=(43690&oi)>>1|(21845&oi)<<1;iN[oi]=((65280&(hm=(61680&(hm=(52428&hm)>>2|(13107&hm)<<2))>>4|(3855&hm)<<4))>>8|(255&hm)<<8)>>1}var X_=function(i,r,s){for(var c=i.length,f=0,m=new Z_(r);f<c;++f)i[f]&&++m[i[f]-1];var g,x=new Z_(r);for(f=1;f<r;++f)x[f]=x[f-1]+m[f-1]<<1;{g=new Z_(1<<r);var w=15-r;for(f=0;f<c;++f)if(i[f])for(var E=f<<4|i[f],M=r-i[f],R=x[i[f]-1]++<<M,D=R|(1<<M)-1;R<=D;++R)g[iN[R]>>w]=E}return g},Y_=new Oa(288);for(oi=0;oi<144;++oi)Y_[oi]=8;for(oi=144;oi<256;++oi)Y_[oi]=9;for(oi=256;oi<280;++oi)Y_[oi]=7;for(oi=280;oi<288;++oi)Y_[oi]=8;var oN=new Oa(32);for(oi=0;oi<32;++oi)oN[oi]=5;var zJ=X_(Y_,9),FJ=X_(oN,5),iP=function(i){for(var r=i[0],s=1;s<i.length;++s)i[s]>r&&(r=i[s]);return r},Us=function(i,r,s){var c=r/8|0;return(i[c]|i[c+1]<<8)>>(7&r)&s},oP=function(i,r){var s=r/8|0;return(i[s]|i[s+1]<<8|i[s+2]<<16)>>(7&r)},NJ=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Vs=function(i,r,s){var c=new Error(r||NJ[i]);if(c.code=i,Error.captureStackTrace&&Error.captureStackTrace(c,Vs),!s)throw c;return c},BJ=new Oa(0),jJ=typeof TextDecoder<"u"&&new TextDecoder;try{jJ.decode(BJ,{stream:!0})}catch{}const $J={gzip_data:"gzip"},UJ={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},VJ={uint32:1,uint16:2,uint8:4},GJ={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class aP{constructor(r=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=r}getLayer(r){return this.layers[r]}getHeaderLength(r){const s=new Uint8Array(r),c=new DataView(r);if(s[0]!==13)throw new nh("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(r){const s=new Uint8Array(r),c=this.getHeaderLength(r);if(s.length<c)throw new nh(`Expected header with length >= ${c} but got buffer of length ${s.length}`);const f=new rm(s.subarray(0,c)),m=_n.read(f);if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new nh(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const g of m.layers)this.layers[g.name]=new WJ(g,{cacheSize:this._cacheSize});return this}createDecodingTask(r){const s=[],c=this.getLayer(r.layerName);for(let f=0;f<c.dataIndex.length;f++){const m=c.dataIndex[f],g=m.first_byte-r.firstByte,x=m.last_byte+1-r.firstByte;if(f<r.firstBlock||f>r.lastBlock||c._blocksInProgress.has(f))continue;const w={layerName:c.name,firstByte:g,lastByte:x,pixelFormat:c.pixelFormat,blockIndex:f,blockShape:[m.bands.length].concat(c.bandShape),buffer:c.buffer,codec:m.codec.codec,filters:m.filters.map(E=>E.filter)};c._blocksInProgress.add(f),s.push(w)}return new aN(s,()=>{s.forEach(f=>c._blocksInProgress.delete(f.blockIndex))},(f,m)=>{if(s.forEach(g=>c._blocksInProgress.delete(g.blockIndex)),f)throw f;m.forEach(g=>{this.getLayer(g.layerName).processDecodedData(g)})})}}class WJ{constructor({version:r,name:s,units:c,tilesize:f,pixel_format:m,buffer:g,data_index:x},w){if(this.version=r,this.version!==1)throw new nh(`Cannot parse raster layer encoded with MRT version ${r}`);this.name=s,this.units=c,this.tileSize=f,this.buffer=g,this.pixelFormat=UJ[m],this.dataIndex=x,this.bandShape=[f+2*g,f+2*g,VJ[this.pixelFormat]],this._decodedBlocks=function(E=1e3,M=0,R=!1){if(isNaN(E)||E<0)throw new TypeError("Invalid max value");if(isNaN(M)||M<0)throw new TypeError("Invalid ttl value");if(typeof R!="boolean")throw new TypeError("Invalid resetTtl value");return new PJ(E,M,R)}(w?w.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(r){const s=r.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.set(s,r.data)}getBlockForBand(r){let s=0;switch(typeof r){case"string":for(const[c,f]of this.dataIndex.entries()){for(const[m,g]of f.bands.entries())if(g===r)return{bandIndex:s+m,blockIndex:c,blockBandIndex:m};s+=f.bands.length}break;case"number":for(const[c,f]of this.dataIndex.entries()){if(r>=s&&r<s+f.bands.length)return{bandIndex:r,blockIndex:c,blockBandIndex:r-s};s+=f.bands.length}break;default:throw new nh(`Invalid band \`${JSON.stringify(r)}\`. Expected string or integer.`)}throw new nh(`Band not found: ${JSON.stringify(r)}`)}getDataRange(r){let s=1/0,c=-1/0,f=1/0,m=-1/0;for(const g of r){const{blockIndex:x}=this.getBlockForBand(g);if(x<0)throw new nh(`Invalid band: ${JSON.stringify(g)}`);const w=this.dataIndex[x];f=Math.min(f,x),m=Math.max(m,x),s=Math.min(s,w.first_byte),c=Math.max(c,w.last_byte)}return{layerName:this.name,firstByte:s,lastByte:c,firstBlock:f,lastBlock:m}}hasBand(r){const{blockIndex:s}=this.getBlockForBand(r);return s>=0}hasDataForBand(r){const{blockIndex:s}=this.getBlockForBand(r);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(r){const{blockIndex:s,blockBandIndex:c}=this.getBlockForBand(r),f=this._decodedBlocks.get(s.toString());if(!f)throw new nh(`Data for band ${JSON.stringify(r)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[s],g=this.bandShape.reduce((E,M)=>E*M,1),x=c*g,w=f.subarray(x,x+g);return{data:w,bytes:new Uint8Array(w.buffer).subarray(w.byteOffset,w.byteOffset+w.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:m.offset,scale:m.scale}}}class aN{constructor(r,s,c){this.tasks=r,this._onCancel=s,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(r,s){this._finalized||(this._onComplete(r,s),this._finalized=!0)}}aP.performDecoding=function(i,r){return Promise.all(r.tasks.map(s=>{const{layerName:c,firstByte:f,lastByte:m,pixelFormat:g,blockShape:x,blockIndex:w,filters:E,codec:M}=s,R=new Uint8Array(i).subarray(f,m+1),D=new Uint32Array(x[0]*x[1]*x[2]);let B;if(M!=="gzip_data")throw new Error(`Unhandled codec: ${M}`);return B=function($,q){if(!globalThis.DecompressionStream&&q==="gzip_data")return Promise.resolve(((he=function(we){we[0]==31&&we[1]==139&&we[2]==8||Vs(6,"invalid gzip data");var Ie=we[3],ke=10;4&Ie&&(ke+=2+(we[10]|we[11]<<8));for(var $e=(Ie>>3&1)+(Ie>>4&1);$e>0;$e-=!we[ke++]);return ke+(2&Ie)}(ce=$))+8>ce.length&&Vs(6,"invalid gzip data"),function(we,Ie,ke,$e){var nt=we.length;if(!nt||Ie.f&&!Ie.l)return ke||new Oa(0);var He=!ke,ut=He||Ie.i!=2,bt=Ie.i;He&&(ke=new Oa(3*nt));var ot,yt,it=function(ih){var oh=ke.length;if(ih>oh){var rd=new Oa(Math.max(2*oh,ih));rd.set(ke),ke=rd}},_t=Ie.f||0,Tt=Ie.p||0,xt=Ie.b||0,Ft=Ie.l,wt=Ie.d,Ct=Ie.m,Jt=Ie.n,Kt=8*nt;do{if(!Ft){_t=Us(we,Tt,1);var Ht=Us(we,Tt+1,3);if(Tt+=3,!Ht){var Et=we[(Bn=4+((Tt+7)/8|0))-4]|we[Bn-3]<<8,tn=Bn+Et;if(tn>nt){bt&&Vs(0);break}ut&&it(xt+Et),ke.set(we.subarray(Bn,tn),xt),Ie.b=xt+=Et,Ie.p=Tt=8*tn,Ie.f=_t;continue}if(Ht==1)Ft=zJ,wt=FJ,Ct=9,Jt=5;else if(Ht==2){var xn=Us(we,Tt,31)+257,un=Us(we,Tt+10,15)+4,Tn=xn+Us(we,Tt+5,31)+1;Tt+=14;for(var bn=new Oa(Tn),kn=new Oa(19),sn=0;sn<un;++sn)kn[kJ[sn]]=Us(we,Tt+3*sn,7);Tt+=3*un;var mr=iP(kn),cr=(1<<mr)-1,Qn=X_(kn,mr);for(sn=0;sn<Tn;){var Bn,Jn=Qn[Us(we,Tt,cr)];if(Tt+=15&Jn,(Bn=Jn>>4)<16)bn[sn++]=Bn;else{var Ar=0,wr=0;for(Bn==16?(wr=3+Us(we,Tt,3),Tt+=2,Ar=bn[sn-1]):Bn==17?(wr=3+Us(we,Tt,7),Tt+=3):Bn==18&&(wr=11+Us(we,Tt,127),Tt+=7);wr--;)bn[sn++]=Ar}}var Gr=bn.subarray(0,xn),$r=bn.subarray(xn);Ct=iP(Gr),Jt=iP($r),Ft=X_(Gr,Ct),wt=X_($r,Jt)}else Vs(1);if(Tt>Kt){bt&&Vs(0);break}}ut&&it(xt+131072);for(var lo=(1<<Ct)-1,Xr=(1<<Jt)-1,Lr=Tt;;Lr=Tt){var di=(Ar=Ft[oP(we,Tt)&lo])>>4;if((Tt+=15&Ar)>Kt){bt&&Vs(0);break}if(Ar||Vs(2),di<256)ke[xt++]=di;else{if(di==256){Lr=Tt,Ft=null;break}var Ni=di-254;di>264&&(Ni=Us(we,Tt,(1<<(Io=JF[sn=di-257]))-1)+rN[sn],Tt+=Io);var Bi=wt[oP(we,Tt)&Xr],Sr=Bi>>4;if(Bi||Vs(3),Tt+=15&Bi,$r=LJ[Sr],Sr>3){var Io=eN[Sr];$r+=oP(we,Tt)&(1<<Io)-1,Tt+=Io}if(Tt>Kt){bt&&Vs(0);break}ut&&it(xt+131072);var Su=xt+Ni;if(xt<$r){var ls=0-$r,Ws=Math.min($r,Su);for(ls+xt<0&&Vs(3);xt<Ws;++xt)ke[xt]=(void 0)[ls+xt]}for(;xt<Su;++xt)ke[xt]=ke[xt-$r]}}Ie.l=Ft,Ie.p=Lr,Ie.b=xt,Ie.f=_t,Ft&&(_t=1,Ie.m=Ct,Ie.d=wt,Ie.n=Jt)}while(!_t);return xt!=ke.length&&He?(ot=ke,((yt=xt)==null||yt>ot.length)&&(yt=ot.length),new Oa(ot.subarray(0,yt))):ke.subarray(0,xt)}(ce.subarray(he,-8),{i:2},new Oa(((X=ce)[(te=X.length)-4]|X[te-3]<<8|X[te-2]<<16|X[te-1]<<24)>>>0))));var X,te,ce,he;const fe=$J[q];if(!fe)throw new Error(`Unhandled codec: ${q}`);const Ee=new globalThis.DecompressionStream(fe);return new Response(new Blob([$]).stream().pipeThrough(Ee)).arrayBuffer().then(we=>new Uint8Array(we))}(R,M).then($=>{const q=$s.read(new rm($));if(q.values==="uint32_values")return q.uint32_values.readValuesInto(D),new GJ[g](D.buffer);throw new Error(`Unhandled numeric data "${q.values}"`)}),B.then($=>{for(let q=E.length-1;q>=0;q--)switch(E[q]){case"delta_filter":MJ($,x);break;case"zigzag_filter":IJ($);break;case"bitshuffle_filter":OJ($,g);break;default:throw new Error(`Unhandled filter "${E[q]}"`)}return{layerName:c,blockIndex:w,data:$}}).catch($=>{throw $})}))};class sN extends Ob{constructor(r,s,c,f,m){super(r,s,c,f,m),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,s){const c=s.context,f=c.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof as?this.texture.update(r,{useMipmap:!1,premultiply:!1}):this.texture=new as(c,r,f.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,s){const c=this._mrt=new aP(30),f=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=nu(f,(m,g,x,w)=>{if(m)s(m);else try{const E=c.getHeaderLength(g);if(E>r)return void(this.request=this.fetchHeader(E,s));c.parseHeader(g),this._isHeaderLoaded=!0;let M=0;for(const R of Object.values(c.layers))M=Math.max(M,R.dataIndex[R.dataIndex.length-1].last_byte);g.byteLength>=M&&(this.entireBuffer=g),s(null,this.entireBuffer||g,x,w)}catch(E){s(E)}}),this.request}fetchBand(r,s,c){const f=this._mrt;if(!this._isHeaderLoaded||!f)return void c(new Error("Tile header is not ready"));const m=this.actor;if(!m)return void c(new Error("Can't fetch tile band without an actor"));let g;const x=(R,D)=>{g.complete(R,D),R?c(R):(this.updateTextureDescriptor(r,s),c(null,this.textureDescriptor&&this.textureDescriptor.img))},w=(R,D)=>{if(R)return c(R);const B=m.send("decodeRasterArray",{buffer:D,task:g},x,void 0,!0);this._workQueue.push(()=>{B&&B.cancel(),g.cancel()})},E=f.getLayer(r);if(!E)return void c(new Error(`Unknown sourceLayer "${r}"`));if(E.hasDataForBand(s))return this.updateTextureDescriptor(r,s),void c(null,this.textureDescriptor?this.textureDescriptor.img:null);const M=E.getDataRange([s]);if(g=f.createDecodingTask(M),!g||g.tasks.length)if(this.flushQueues(),this.entireBuffer)w(null,this.entireBuffer.slice(M.firstByte,M.lastByte+1));else{const R=Object.assign({},this.requestParams,{headers:{Range:`bytes=${M.firstByte}-${M.lastByte}`}}),D=nu(R,w);this._fetchQueue.push(()=>{D.cancel(),g.cancel()})}else c(null)}updateNeeded(r,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,s){if(!this._mrt)return;const c=this._mrt.getLayer(r);if(!c||!c.hasBand(s)||!c.hasDataForBand(s))return;const{bytes:f,tileSize:m,buffer:g,offset:x,scale:w}=c.getBandView(s),E=m+2*g,M={data:f,width:E,height:E},R=this.texture;R&&R instanceof as&&R.update(M,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:r,band:s,img:M,buffer:g,offset:x,tileSize:m,format:c.pixelFormat,mix:[w,256*w,65536*w,16777216*w]}}}class HJ{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,c){const f=r.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const m={value:s,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout(()=>{this.remove(r,m)},c)),this.data[f].push(m),this.order.push(f),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const c=r.wrapped().key,f=s===void 0?0:this.data[c].indexOf(s),m=this.data[c][f];return this.data[c].splice(f,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const c in this.data)for(const f of this.data[c])r(f.value)||s.push(f);for(const c of s)this.remove(c.value.tileID,c)}}class Jf extends iu{constructor(r,s,c){super(),this.id=r,this._onlySymbols=c,s.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new HJ(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new YQ,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="errored"&&(s.state!=="loaded"||!s.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,s){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(r),c.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return oa(this._tiles).map(r=>r.tileID).sort(lN).map(r=>r.key)}getRenderableIds(r,s){const c=[];for(const f in this._tiles)this._isIdRenderable(+f,r,s)&&c.push(this._tiles[f]);return r?c.sort((f,m)=>{const g=f.tileID,x=m.tileID,w=new Lt(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new Lt(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-x.overscaledZ||E.y-w.y||E.x-w.x}).map(f=>f.tileID.key):c.map(f=>f.tileID).sort(lN).map(f=>f.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s,c){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())&&(c||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,s){const c=this._tiles[r];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,r,s)))}_tileLoaded(r,s,c,f){if(f)if(r.state="errored",f.status!==404)this._source.fire(new Sp(f,{tile:r}));else{if(!(r.tileID.key in this._loadedParentTiles))return void this._source.fire(new po("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=Di.now(),c==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new po("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const s=this.getRenderableIds();for(let f=0;f<s.length;f++){const m=s[f];if(r.neighboringTiles&&r.neighboringTiles[m]){const g=this.getTileByID(m);c(r,g),c(g,r)}}function c(f,m){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let g=m.tileID.canonical.x-f.tileID.canonical.x;const x=m.tileID.canonical.y-f.tileID.canonical.y,w=Math.pow(2,f.tileID.canonical.z),E=m.tileID.key;g===0&&x===0||Math.abs(x)>1||(Math.abs(g)>1&&(Math.abs(g+w)===1?g+=w:Math.abs(g-w)===1&&(g-=w)),m.dem&&f.dem&&(f.dem.backfillBorder(m.dem,g,x),f.neighboringTiles&&f.neighboringTiles[E]&&(f.neighboringTiles[E].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,c,f){for(const m in this._tiles){let g=this._tiles[m];if(f[m]||!g.hasData()||g.tileID.overscaledZ<=s||g.tileID.overscaledZ>c)continue;let x=g.tileID;for(;g&&g.tileID.overscaledZ>s+1;){const E=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[E.key],g&&g.hasData()&&(x=E)}let w=x;for(;w.overscaledZ>s;)if(w=w.scaledTo(w.overscaledZ-1),r[w.key]){f[x.key]=x;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const c=this._loadedParentTiles[r.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=r.overscaledZ-1;c>=s;c--){const f=r.scaledTo(c),m=this._getLoadedTile(f);if(m)return m}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,s){s=s||this._source.tileSize;const c=Math.ceil(r.width/s)+1,f=Math.ceil(r.height/s)+1,m=Math.floor(c*f*5),g=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,m):m,x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(x)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const c={};for(const f in this._tiles){const m=this._tiles[f];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+s),c[m.tileID.key]=m}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(r,s,c,f){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let m;if(this.updateCacheSize(r,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain){if(this._source.tileID)m=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new yi(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y));else if(this.tileCoverLift!==0){const w=r.clone();w.tileCoverLift=this.tileCoverLift,m=w.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&r.projection.name==="globe"&&(m.push(new yi(1,0,1,0,0)),m.push(new yi(1,0,1,1,0)),m.push(new yi(1,0,1,0,1)),m.push(new yi(1,0,1,1,1)))}else if(m=r.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile){const w=this._source.hasTile.bind(this._source);m=m.filter(E=>w(E))}}else m=[];if(m.length>0&&this.castsShadows&&f&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!sP(this._source.type)){const w=r.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!c}),E=Math.min(w,this._source.maxzoom),M=r.extendTileCoverForShadows(m,f,E);for(const R of M)this._shadowCasterTiles[R.key]=!0,m.push(R)}const g=this._updateRetainedTiles(m);if(sP(this._source.type)&&m.length!==0){const w={},E={},M=Object.keys(g);for(const D of M){const B=g[D],$=this._tiles[D];if(!$||$.fadeEndTime&&$.fadeEndTime<=Di.now())continue;const q=this.findLoadedParent(B,Math.max(B.overscaledZ-Jf.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),w[q.tileID.key]=q.tileID),E[D]=B}const R=m[m.length-1].overscaledZ;for(const D in this._tiles){const B=this._tiles[D];if(g[D]||!B.hasData())continue;let $=B.tileID;for(;$.overscaledZ>R;){$=$.scaledTo($.overscaledZ-1);const q=this._tiles[$.key];if(q&&q.hasData()&&E[$.key]){g[D]=B.tileID;break}}}for(const D in w)g[D]||(this._coveredTiles[D]=!0,g[D]=w[D])}for(const w in g)this._tiles[w].clearFadeHold();const x=function(w,E){const M=[];for(const R in w)R in E||M.push(R);return M}(this._tiles,g);for(const w of x){const E=this._tiles[w];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const s={};if(r.length===0)return s;const c={},f=r.reduce((E,M)=>Math.min(E,M.overscaledZ),1/0),m=r[0].overscaledZ,g=Math.max(m-Jf.maxOverzooming,this._source.minzoom),x=Math.max(m+Jf.maxUnderzooming,this._source.minzoom),w={};for(const E of r){const M=this._addTile(E);s[E.key]=E,M.hasData()||f<this._source.maxzoom&&(w[E.key]=E)}this._retainLoadedChildren(w,f,x,s);for(const E of r){let M=this._tiles[E.key];if(M.hasData())continue;if(E.canonical.z>=this._source.maxzoom){const D=E.children(this._source.maxzoom)[0],B=this.getTile(D);if(B&&B.hasData()){s[D.key]=D;continue}}else{const D=E.children(this._source.maxzoom);if(s[D[0].key]&&s[D[1].key]&&s[D[2].key]&&s[D[3].key])continue}let R=M.wasRequested();for(let D=E.overscaledZ-1;D>=g;--D){const B=E.scaledTo(D);if(c[B.key]||(c[B.key]=!0,M=this.getTile(B),!M&&R&&(M=this._addTile(B)),M&&(s[B.key]=B,R=M.wasRequested(),M.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let c,f=this._tiles[r].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}s.push(f.key);const m=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;f=m}for(const m of s)this._loadedParentTiles[m]=c}}_addTile(r){let s=this._tiles[r.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const c=!!s;if(!c){const f=this.map?this.map.painter:null,m=this._source.tileSize*r.overscaleFactor();s=this._source.type==="raster-array"?new sN(r,m,this.transform.tileZoom,f,this._isRaster):new Ob(r,m,this.transform.tileZoom,f,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))}return s?(s.uses++,this._tiles[r.key]=s,c||this._source.fire(new po("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const c=s.getExpiryTimeout();c&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},c))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,s,c){const f=[],m=this.transform;if(!m)return f;const g=m.projection.name==="globe",x=Tl(m.center.lng);for(const w in this._tiles){const E=this._tiles[w];if(c&&E.clearQueryDebugViz(),E.holdingForFade())continue;let M;if(g){const R=E.tileID.canonical;if(R.z===0){const D=[Math.abs(Pn(x,...K_(R,-1))-x),Math.abs(Pn(x,...K_(R,1))-x)];M=[0,2*D.indexOf(Math.min(...D))-1]}else{const D=[Math.abs(Pn(x,...K_(R,-1))-x),Math.abs(Pn(x,...K_(R,0))-x),Math.abs(Pn(x,...K_(R,1))-x)];M=[D.indexOf(Math.min(...D))-1]}}else M=[0];for(const R of M){const D=r.containsTile(E,m,s,R);D&&f.push(D)}}return f}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,s){const c=this.getRenderableIds(r,s).map(m=>this._tiles[m].tileID),f=this.transform.projection.name==="globe";for(const m of c)m.projMatrix=this.transform.calculateProjMatrix(m.toUnwrapped()),m.expandedProjMatrix=f?this.transform.calculateProjMatrix(m.toUnwrapped(),!1,!0):m.projMatrix;return c}sortCoordinatesByDistance(r){const s=r.slice(),c=this.transform._camera.position,f=this.transform._camera.forward(),m={};for(const g of s){const x=1/(1<<g.canonical.z);m[g.key]=((g.canonical.x+.5)*x+g.wrap-c[0])*f[0]+((g.canonical.y+.5)*x-c[1])*f[1]-c[2]*f[2]}return s.sort((g,x)=>m[g.key]-m[x.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if(sP(this._source.type))for(const r in this._tiles){const s=this._tiles[r];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=Di.now())return!0}return!1}setFeatureState(r,s,c){this._state.updateState(r=r||"_geojsonTileLayer",s,c)}removeFeatureState(r,s,c){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,c)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,c){const f=this._tiles[r];f&&f.setDependencies(s,c)}reloadTilesForDependencies(r,s){for(const c in this._tiles)this._tiles[c].hasDependency(r,s)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(r,s))}_preloadTiles(r,s){if(!this._sourceLoaded){const x=()=>{this._sourceLoaded&&(this._source.off("data",x),this._preloadTiles(r,s))};return void this._source.on("data",x)}const c=new Map,f=Array.isArray(r)?r:[r],m=this.map.painter.terrain,g=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const x of f){const w=x.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const E of w)c.set(E.key,E);this.usedForTerrain&&x.updateElevation(!1)}mc(Array.from(c.values()),(x,w)=>{const E=new Ob(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(E,M=>{this._source.type==="raster-dem"&&E.dem&&this._backfillDEM(E),w(M,E)})},s)}}function lN(i,r){const s=Math.abs(2*i.wrap)-+(i.wrap<0),c=Math.abs(2*r.wrap)-+(r.wrap<0);return i.overscaledZ-r.overscaledZ||c-s||r.canonical.y-i.canonical.y||r.canonical.x-i.canonical.x}function sP(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function K_(i,r){const s=1<<i.z;return[i.x/s+r,(i.x+1)/s+r]}Jf.maxOverzooming=10,Jf.maxUnderzooming=3;const uN=new class extends zt{possiblyEvaluate(i,r){return r=new pn(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(i,r)}evaluate(i,r,s,c){return r=Xi({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(i,r,s,c)}}(db.paint.properties["line-width"].specification);function cN(i,r){return r>0?r+2*i:i}uN.useIntegerZoom=!0;const qJ=new nr({"symbol-placement":new pt(Ve.layout_symbol["symbol-placement"]),"symbol-spacing":new pt(Ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pt(Ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zt(Ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pt(Ve.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new pt(Ve.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new pt(Ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new pt(Ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new pt(Ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pt(Ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new zt(Ve.layout_symbol["icon-size"]),"icon-text-fit":new zt(Ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zt(Ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new zt(Ve.layout_symbol["icon-image"]),"icon-rotate":new zt(Ve.layout_symbol["icon-rotate"]),"icon-padding":new pt(Ve.layout_symbol["icon-padding"]),"icon-keep-upright":new pt(Ve.layout_symbol["icon-keep-upright"]),"icon-offset":new zt(Ve.layout_symbol["icon-offset"]),"icon-anchor":new zt(Ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pt(Ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pt(Ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pt(Ve.layout_symbol["text-rotation-alignment"]),"text-field":new zt(Ve.layout_symbol["text-field"]),"text-font":new zt(Ve.layout_symbol["text-font"]),"text-size":new zt(Ve.layout_symbol["text-size"]),"text-max-width":new zt(Ve.layout_symbol["text-max-width"]),"text-line-height":new zt(Ve.layout_symbol["text-line-height"]),"text-letter-spacing":new zt(Ve.layout_symbol["text-letter-spacing"]),"text-justify":new zt(Ve.layout_symbol["text-justify"]),"text-radial-offset":new zt(Ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pt(Ve.layout_symbol["text-variable-anchor"]),"text-anchor":new zt(Ve.layout_symbol["text-anchor"]),"text-max-angle":new pt(Ve.layout_symbol["text-max-angle"]),"text-writing-mode":new pt(Ve.layout_symbol["text-writing-mode"]),"text-rotate":new zt(Ve.layout_symbol["text-rotate"]),"text-padding":new pt(Ve.layout_symbol["text-padding"]),"text-keep-upright":new pt(Ve.layout_symbol["text-keep-upright"]),"text-transform":new zt(Ve.layout_symbol["text-transform"]),"text-offset":new zt(Ve.layout_symbol["text-offset"]),"text-allow-overlap":new pt(Ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new pt(Ve.layout_symbol["text-ignore-placement"]),"text-optional":new pt(Ve.layout_symbol["text-optional"]),visibility:new pt(Ve.layout_symbol.visibility)});var lP={paint:new nr({"icon-opacity":new zt(Ve.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new zt(Ve.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new zt(Ve.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new zt(Ve.paint_symbol["text-emissive-strength"]),"icon-color":new zt(Ve.paint_symbol["icon-color"]),"icon-halo-color":new zt(Ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new zt(Ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zt(Ve.paint_symbol["icon-halo-blur"]),"icon-translate":new pt(Ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new pt(Ve.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new zt(Ve.paint_symbol["icon-image-cross-fade"]),"text-opacity":new zt(Ve.paint_symbol["text-opacity"]),"text-occlusion-opacity":new zt(Ve.paint_symbol["text-occlusion-opacity"]),"text-color":new zt(Ve.paint_symbol["text-color"],{runtimeType:mo,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new zt(Ve.paint_symbol["text-halo-color"]),"text-halo-width":new zt(Ve.paint_symbol["text-halo-width"]),"text-halo-blur":new zt(Ve.paint_symbol["text-halo-blur"]),"text-translate":new pt(Ve.paint_symbol["text-translate"]),"text-translate-anchor":new pt(Ve.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new pt(Ve.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new pt(Ve.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new pt(Ve.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new pt(Ve.paint_symbol["icon-color-brightness-max"])}),layout:qJ};class hN{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Ec,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}pe(hN,"FormatSectionOverride",{omit:["defaultValue"]});class Rb extends gi{constructor(r,s,c,f){super(r,lP,s,c,f),this._colorAdjustmentMatrix=a.ad.identity([]),this.hasInitialOcclusionOpacityProperties=r.paint!==void 0&&("icon-occlusion-opacity"in r.paint||"text-occlusion-opacity"in r.paint)}recalculate(r,s){super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const m of c)f.indexOf(m)<0&&f.push(m);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(r,s,c,f){return this._saturation===r&&this._contrast===s&&this._brightnessMin===c&&this._brightnessMax===f||(this._colorAdjustmentMatrix=function(m,g,x,w){m=dp(m),g=fp(g);const E=a.ad.create(),M=m/3,R=1-2*M,D=[R,M,M,0,M,R,M,0,M,M,R,0,0,0,0,1],B=.5-.5*g,$=w-x;return a.ad.multiply(E,[$,0,0,0,0,$,0,0,0,0,$,0,x,x,x,1],[g,0,0,0,0,g,0,0,0,0,g,0,B,B,B,1]),a.ad.multiply(E,E,D),E}(r,s,c,f),this._saturation=r,this._contrast=s,this._brightnessMin=c,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(r,s,c,f){const m=this.layout.get(r).evaluate(s,{},c,f),g=this._unevaluatedLayout._values[r];return g.isDataDriven()||Z(g.value)||!m?m:function(x,w){return w.replace(/{([^{}]+)}/g,(E,M)=>M in x?String(x[M]):"")}(s.properties,m)}createBucket(r){return new cm(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of lP.paint.overridableProperties){if(!Rb.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),c=new hN(s),f=new V(c,s.property.specification,this.scope,this.options);let m=null;m=s.value.kind==="constant"||s.value.kind==="source"?new J("source",f):new ie("composite",f,s.value.zoomStops,s.value._interpolationType),this.paint._values[r]=new Pr(s.property,m,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&Rb.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const c=r.get("text-field"),f=lP.paint.properties[s];let m=!1;const g=x=>{for(const w of x)if(f.overrides&&f.overrides.hasOverride(w))return void(m=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Yi)g(c.value.value.sections);else if(c.value.kind==="source"){const x=E=>{m||(E instanceof Os&&fi(E.value)===Cc?g(E.value.sections):E instanceof Ef?g(E.sections):E.eachChild(x))},w=c.value;w._styleExpression&&x(w._styleExpression.expression)}return m}getProgramIds(){const r=this.paint.get("icon-opacity").constantOr(1)!==0,s=this.paint.get("text-opacity").constantOr(1)!==0,c=[];return r&&c.push("symbolIcon"),s&&c.push("symbolSDF"),c}getDefaultProgramParams(r,s,c){return{config:new Wf(this,{zoom:s,lut:c}),overrideFog:!1}}}const ZJ=new nr({visibility:new pt(Ve.layout_background.visibility)});var XJ={paint:new nr({"background-color":new pt(Ve.paint_background["background-color"]),"background-pattern":new pt(Ve.paint_background["background-pattern"]),"background-opacity":new pt(Ve.paint_background["background-opacity"]),"background-emissive-strength":new pt(Ve.paint_background["background-emissive-strength"])}),layout:ZJ};const YJ=new nr({visibility:new pt(Ve.layout_raster.visibility)});var KJ={paint:new nr({"raster-opacity":new pt(Ve.paint_raster["raster-opacity"]),"raster-color":new Nr(Ve.paint_raster["raster-color"]),"raster-color-mix":new pt(Ve.paint_raster["raster-color-mix"]),"raster-color-range":new pt(Ve.paint_raster["raster-color-range"]),"raster-hue-rotate":new pt(Ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pt(Ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pt(Ve.paint_raster["raster-brightness-max"]),"raster-saturation":new pt(Ve.paint_raster["raster-saturation"]),"raster-contrast":new pt(Ve.paint_raster["raster-contrast"]),"raster-resampling":new pt(Ve.paint_raster["raster-resampling"]),"raster-fade-duration":new pt(Ve.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new pt(Ve.paint_raster["raster-emissive-strength"]),"raster-array-band":new pt(Ve.paint_raster["raster-array-band"]),"raster-elevation":new pt(Ve.paint_raster["raster-elevation"])}),layout:YJ};function kb(i,r,s,c,f,m,g,x){const w=[i,r,1,s,c,1,f,m,1],E=[g,x,1],M=a.bC.adjoint([],w),[R,D,B]=a._.transformMat3(E,E,M);return a.bC.multiply(w,w,[R,0,0,0,D,0,0,0,B])}function fN(i,r,s,c,f,m,g,x){const w=function(E,M,R,D,B,$,q,X){const te=kb(0,0,1,0,1,1,0,1),ce=kb(E,M,R,D,B,$,q,X),he=a.bC.adjoint([],te);return a.bC.multiply(ce,ce,he)}(i,r,s,c,f,m,g,x);return[w[2]/w[8]/Mt,w[5]/w[8]/Mt]}function Db(i){return[i[0],Math.min(Math.max(i[1],-ei),ei)]}class dN extends iu{constructor(r,s,c,f){super(),this.id=r,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=s,this._dirty=!1}load(r,s){if(this._loaded=s||!1,this.fire(new po("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return r&&(this.coordinates=r),this._loaded=!0,void this._finishLoading();this._imageRequest=pl(this.map._requestManager.transformRequest(this.url,_p.Image),(c,f)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new Sp(c)):f&&(this.image=f instanceof HTMLImageElement?Di.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}setTexture(r){if(!(r.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Pb(this.map.painter.context,r.handle),this.width=r.dimensions[0],this.height=r.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new po("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(r){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Pb||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(r){if(this.coordinates=r,this._boundsArray=void 0,this._unsupportedCoords=!1,!r.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=r[0][1],c=r[0][1];for(const m of r)m[1]>c&&(c=m[1]),m[1]<s&&(s=m[1]);const f=(c+s)/2;if(f>ei?this.onNorthPole=!0:f<-ei&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=r.map(so.fromLngLat);this.tileID=function(g){let x=1/0,w=1/0,E=-1/0,M=-1/0;for(const q of g)x=Math.min(x,q.x),w=Math.min(w,q.y),E=Math.max(E,q.x),M=Math.max(M,q.y);const R=Math.max(E-x,M-w),D=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),B=Math.pow(2,D);let $=Math.floor((x+E)/2*B);return $>1&&($-=1),new qf(D,$,Math.floor((w+M)/2*B))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new po("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(r){for(const X in this.tiles){const te=this.tiles[X];te.state!=="loaded"&&(te.state="loaded",te.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=Kf(new qf(0,0,0),this.map.transform.projection),c=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(X){const te=X[1].x-X[0].x,ce=X[1].y-X[0].y,he=X[2].x-X[1].x,fe=X[2].y-X[1].y,Ee=X[3].x-X[2].x,we=X[3].y-X[2].y,Ie=X[0].x-X[3].x,ke=X[0].y-X[3].y,$e=te*fe-he*ce,nt=he*we-Ee*fe,He=Ee*ke-Ie*we,ut=Ie*ce-te*ke;return $e>0&&nt>0&&He>0&&ut>0||$e<0&&nt<0&&He<0&&ut<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=Kf(this.tileID,this.map.transform.projection),[m,g,x,w]=this.coordinates.map(X=>{const te=f.projection.project(X[0],X[1]);return WF(f,te)._round()});this.perspectiveTransform=fN(m.x,m.y,g.x,g.y,x.x,x.y,w.x,w.y);const E=this._boundsArray=new Bc;E.emplaceBack(m.x,m.y,0,0),E.emplaceBack(g.x,g.y,Mt,0),E.emplaceBack(w.x,w.y,0,Mt),E.emplaceBack(x.x,x.y,Mt,Mt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=r.createVertexBuffer(E,Ib.members),this.boundsSegments=Br.simpleSegment(0,0,4,2);const M=[],R=function(X){return[Db(X[0]),Db(X[1]),Db(X[2]),Db(X[3])]}(this.coordinates),[D,B,$,q]=function(X){let te=X[0][0],ce=te,he=X[0][1],fe=he;for(let Ee=1;Ee<X.length;Ee++)X[Ee][0]<te?te=X[Ee][0]:X[Ee][0]>ce&&(ce=X[Ee][0]),X[Ee][1]<he?he=X[Ee][1]:X[Ee][1]>fe&&(fe=X[Ee][1]);return[te,he,ce-te,fe-he]}(R);{const X=new Bc,[te,ce,he,fe]=function(it){let _t=it[0].x,Tt=_t,xt=it[0].y,Ft=xt;for(let wt=1;wt<it.length;wt++)it[wt].x<_t?_t=it[wt].x:it[wt].x>Tt&&(Tt=it[wt].x),it[wt].y<xt?xt=it[wt].y:it[wt].y>Ft&&(Ft=it[wt].y);return[_t,xt,Tt-_t,Ft-xt]}(c),Ee=it=>[(it.x-te)/he,(it.y-ce)/fe],[we,Ie,ke,$e]=c.map(Ee),nt=function(it,_t,Tt,xt,Ft,wt,Ct,Jt){const Kt=kb(0,0,1,0,1,1,0,1),Ht=kb(it,_t,Tt,xt,Ft,wt,Ct,Jt),Et=a.bC.adjoint([],Ht);return a.bC.multiply(Kt,Kt,Et)}(we[0],we[1],Ie[0],Ie[1],ke[0],ke[1],$e[0],$e[1]);this.elevatedGlobePerspectiveTransform=fN(we[0],we[1],Ie[0],Ie[1],ke[0],ke[1],$e[0],$e[1]);const He=(it,_t)=>{M.push(it.lng);const Tt=Math.round((it.lng-D)/$*Mt),xt=Math.round((it.lat-B)/q*Mt),Ft=Ee(_t),wt=a._.transformMat3([],[Ft[0],Ft[1],1],nt),Ct=Math.round(wt[0]/wt[2]*Mt),Jt=Math.round(wt[1]/wt[2]*Mt);X.emplaceBack(Tt,xt,Ct,Jt)},ut=c[3].x-c[0].x,bt=c[3].y-c[0].y,ot=c[2].x-c[1].x,yt=c[2].y-c[1].y;for(let it=0;it<65;it++){const _t=it/64,Tt=[c[0].x+_t*ut,c[0].y+_t*bt],xt=[c[1].x+_t*ot,c[1].y+_t*yt],Ft=xt[0]-Tt[0],wt=xt[1]-Tt[1];for(let Ct=0;Ct<65;Ct++){const Jt=Ct/64,Kt={x:Tt[0]+Ft*Jt,y:Tt[1]+wt*Jt,z:0};He(s.projection.unproject(Kt.x,Kt.y),Kt)}}this.elevatedGlobeVertexBuffer=r.createVertexBuffer(X,Ib.members)}{this.maxLongitudeTriangleSize=0;let X=[],te=new Pi;const ce=(he,fe,Ee)=>{te.emplaceBack(he,fe,Ee);const we=M[he],Ie=M[fe],ke=M[Ee],$e=Math.min(Math.min(we,Ie),ke),nt=Math.max(Math.max(we,Ie),ke)-$e;nt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=nt),X.push($e+nt/2)};for(let he=0;he<64;he++)for(let fe=0;fe<64;fe++){const Ee=65*he+fe,we=Ee+1,Ie=Ee+65,ke=Ie+1;ce(Ee,Ie,we),ce(we,Ie,ke)}[X,te]=function(he,fe){const Ee=Array.from({length:he.length},(ke,$e)=>$e);Ee.sort((ke,$e)=>he[ke]-he[$e]);const we=[],Ie=new Pi;for(let ke=0;ke<Ee.length;ke++){const $e=Ee[ke];we.push(he[$e]);const nt=3*$e,He=nt+1;Ie.emplaceBack(fe.uint16[nt],fe.uint16[He],fe.uint16[He+1])}return[we,Ie]}(X,te),this.elevatedGlobeTrianglesCenterLongitudes=X,this.elevatedGlobeIndexBuffer=r.createIndexBuffer(te)}this.elevatedGlobeSegments=Br.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,$/Mt,0,q/Mt,0,0,B,D,0])}prepare(){const r=Object.keys(this.tiles).length!==0;if(this.tileID&&!r)return;const s=this.map.painter.context,c=s.gl;!this._dirty||this.texture instanceof Pb||(this.texture?this.texture.update(this.image):(this.texture=new as(s,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),r&&this._prepareData(s)}loadTile(r,s){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},s(null)):(r.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(r){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let f=(m=r+180)+360*Math.round((c[0]-m)/360);var m;const g=new Br,x=(R,D)=>{g.segments.push({vertexOffset:0,primitiveOffset:R,vertexLength:s.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},w=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-f)<=w){const R=Xx(c,0,c.length,f+w);return R===c.length||x(R,Iy(c,R+1,c.length,f+360-w)-R),g}f<c[0]&&(f+=360);const E=Iy(c,0,c.length,f-w);if(E===c.length)return x(0,c.length),g;x(0,E-0);const M=Xx(c,E+1,c.length,f+w);return M!==c.length&&x(M,c.length-M),g}}const QJ=(Math.pow(256,2)-1)/16907520;class pN extends gi{constructor(r,s,c,f){super(r,KJ,s,c,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(r){return!(r&&r._source instanceof dN&&(r._source.onNorthPole||r._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(r){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[c,f]=r||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(f)||c===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=O_({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,f])}}const JJ=new nr({visibility:new pt(Ve["layout_raster-particle"].visibility)});var e2={paint:new nr({"raster-particle-array-band":new pt(Ve["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new pt(Ve["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Nr(Ve["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new pt(Ve["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new pt(Ve["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new pt(Ve["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new pt(Ve["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:JJ};class mN extends gi{constructor(r,s,c,f){super(r,e2,s,c,f),this._updateColorRamp(),this.lastInvalidatedAt=Di.now()}onRemove(r){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(r){return!1}_handleSpecialPaintPropertyUpdate(r){r!=="raster-particle-color"&&r!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),r==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=O_({expression:r,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Di.now()}}class t2 extends gi{constructor(r,s){super(r,{},s,null),this.implementation=r,r.slot&&(this.slot=r.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(r){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}const n2=new nr({visibility:new pt(Ve.layout_sky.visibility)});var r2={paint:new nr({"sky-type":new pt(Ve.paint_sky["sky-type"]),"sky-atmosphere-sun":new pt(Ve.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new pt(Ve.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new pt(Ve.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new pt(Ve.paint_sky["sky-gradient-radius"]),"sky-gradient":new Nr(Ve.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new pt(Ve.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new pt(Ve.paint_sky["sky-atmosphere-color"]),"sky-opacity":new pt(Ve.paint_sky["sky-opacity"])}),layout:n2};function uP(i,r,s){const c=[0,0,1],f=a.av.identity([]);return a.av.rotateY(f,f,s?-Fn(i)+Math.PI:Fn(i)),a.av.rotateX(f,f,-Fn(r)),a._.transformQuat(c,c,f),a._.normalize(c,c)}var i2={paint:new nr({})};function gN(i,r){const s=Lb(i.projection,i.zoom,i.width,i.height),c=function(m,g,x,w,E){const M=new qn(x.lng-180*rh,x.lat),R=new qn(x.lng+180*rh,x.lat),D=m.project(M.lng,M.lat),B=m.project(R.lng,R.lat),$=-Math.atan2(B.y-D.y,B.x-D.x),q=so.fromLngLat(x);q.y=Pn(q.y,-1+rh,1-rh);const X=q.toLngLat(),te=m.project(X.lng,X.lat),ce=so.fromLngLat(X);ce.x+=rh;const he=ce.toLngLat(),fe=m.project(he.lng,he.lat),Ee=vN(fe.x-te.x,fe.y-te.y,$),we=so.fromLngLat(X);we.y+=rh;const Ie=we.toLngLat(),ke=m.project(Ie.lng,Ie.lat),$e=vN(ke.x-te.x,ke.y-te.y,$),nt=Math.abs(Ee.x)/Math.abs($e.y),He=a.ad.identity([]);a.ad.rotateZ(He,He,-$*(1-(E?0:w)));const ut=a.ad.identity([]);return a.ad.scale(ut,ut,[1,1-(1-nt)*w,1]),ut[4]=-$e.x/$e.y*w,a.ad.rotateZ(ut,ut,$),a.ad.multiply(ut,He,ut),ut}(i.projection,0,i.center,s,r),f=yN(i);return a.ad.scale(c,c,[f,f,1]),c}function yN(i){const r=i.projection,s=Lb(i.projection,i.zoom,i.width,i.height),c=_N(r,i.center),f=_N(r,qn.convert(r.center));return Math.pow(2,c*s+(1-s)*f)}function Lb(i,r,s,c,f=1/0){const m=i.range;if(!m)return 0;const g=Math.min(f,Math.max(s,c)),x=Math.log(g/1024)/Math.LN2;return Ql(m[0]+x,m[1]+x,r)}const rh=1/4e4;function _N(i,r){const s=Pn(r.lat,-ei,ei),c=new qn(r.lng-180*rh,s),f=new qn(r.lng+180*rh,s),m=i.project(c.lng,s),g=i.project(f.lng,s),x=so.fromLngLat(c),w=so.fromLngLat(f),E=g.x-m.x,M=g.y-m.y,R=w.x-x.x,D=w.y-x.y,B=Math.sqrt((R*R+D*D)/(E*E+M*M));return Math.log(B)/Math.LN2}function vN(i,r,s){const c=Math.cos(s),f=Math.sin(s);return{x:i*c-r*f,y:i*f+r*c}}function xN(i,r,s){a.ad.identity(i),a.ad.rotateZ(i,i,Fn(r[2])),a.ad.rotateX(i,i,Fn(r[0])),a.ad.rotateY(i,i,Fn(r[1])),a.ad.scale(i,i,s),a.ad.multiply(i,i,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function zb(i,r,s,c,f,m,g,x){const w=[s[0]-r[0],s[1]-r[1],0],E=[c[0]-r[0],c[1]-r[1],0];if(a._.length(w)<1e-12||a._.length(E)<1e-12)return a.av.identity(i);const M=a._.cross([],w,E);a._.normalize(M,M),a._.subtract(E,c,r),w[2]=(m-f)*x,E[2]=(g-f)*x;const R=w;return a._.cross(R,w,E),a._.normalize(R,R),a.av.rotationTo(i,M,R)}function cP(i,r,s=!1){const c=xu(r.zoom),f=function(m,g,x){const w=g.worldSize,E=[m[12],m[13],m[14]],M=Fi(E[1]/w),R=Go(E[0]/w),D=a.ad.identity([]),B=Mo(1,M)*w,$=Mo(1,0)*w*Zf(M,g.zoom),q=1/MC(w);let X=$*q;if(x){const fe=Lb(g.projection,g.zoom,g.width,g.height,1024);X=q*g.projection.pixelSpaceConversion(g.center.lat,w,fe)}const te=Hf(M,R);a._.add(te,te,a._.scale([],a._.normalize([],te),B*X*E[2]));const ce=function(fe){const Ee=[fe[0],fe[1],fe[2]];let we=[0,1,0];const Ie=a._.cross([],we,Ee);return a._.cross(we,Ee,Ie),a._.squaredLength(we)===0&&(we=[0,1,0],a._.cross(Ie,Ee,we)),a._.normalize(Ie,Ie),a._.normalize(we,we),a._.normalize(Ee,Ee),[Ie[0],Ie[1],Ie[2],0,we[0],we[1],we[2],0,Ee[0],Ee[1],Ee[2],0,fe[0],fe[1],fe[2],1]}(te);a.ad.scale(D,D,[X,X,X*B]),a.ad.translate(D,D,[-E[0],-E[1],-E[2]]);const he=a.ad.multiply([],g.globeMatrix,ce);return a.ad.multiply(he,he,D),a.ad.multiply(he,he,m),he}(i,r,s);if(c>0){const m=function(g,x){const w=x.worldSize,E=Mo(1,0)*w*Zf(x.center.lat,x.zoom)/MC(w),M=Mo(1,x.center.lat)*w,R=a.ad.identity([]);return a.ad.rotateY(R,R,Fn(x.center.lng)),a.ad.rotateX(R,R,Fn(x.center.lat)),a.ad.translate(R,R,[0,0,Po]),a.ad.scale(R,R,[E,E,E*M]),a.ad.translate(R,R,[x.point.x-.5*w,x.point.y-.5*w,0]),a.ad.multiply(R,R,g),a.ad.multiply(R,x.globeMatrix,R)}(i,r);return function(g,x,w){const E=($,q,X)=>{const te=a._.length($),ce=a._.length(q),he=vu($,q,X);return a._.scale(he,he,1/a._.length(he)*on(te,ce,X))},M=E([g[0],g[1],g[2]],[x[0],x[1],x[2]],w),R=E([g[4],g[5],g[6]],[x[4],x[5],x[6]],w),D=E([g[8],g[9],g[10]],[x[8],x[9],x[10]],w),B=vu([g[12],g[13],g[14]],[x[12],x[13],x[14]],w);return[M[0],M[1],M[2],0,R[0],R[1],R[2],0,D[0],D[1],D[2],0,B[0],B[1],B[2],1]}(f,m,c)}return f}function bN(i,r,s,c){const f=jr.projectAabbCorners(c,s);let m=Number.MAX_VALUE,g=-1;for(let E=0;E<f.length;++E){const M=f[E];M[0]=(.5*M[0]+.5)*r.width,M[1]=(.5-.5*M[1])*r.height,M[2]<m&&(g=E,m=M[2])}const x=E=>new Lt(f[E][0],f[E][1]);let w;switch(g){case 0:case 6:w=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:w=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:w=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:w=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(vC(i,w))return m}const o2=rr([{name:"a_pos_3f",components:3,type:"Float32"}]),a2=rr([{name:"a_color_3f",components:3,type:"Float32"}]),s2=rr([{name:"a_color_4f",components:4,type:"Float32"}]),l2=rr([{name:"a_uv_2f",components:2,type:"Float32"}]),u2=rr([{name:"a_normal_3f",components:3,type:"Float32"}]),c2=rr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),h2=rr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class Fb{constructor(r,s,c,f){this.message=(r?`${r}: `:"")+c,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function wN(i,r){const s=i.indexOf("://")===-1;try{return new URL(i,s&&r?"http://example.com":void 0),!0}catch{return!1}}class SN{constructor(r,s){this.feature=r,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class TN{constructor(){this.instancedDataArray=new nC,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class hP{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=r.projection,this.index=r.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(r,s){}populate(r,s,c,f){this.tileToMeter=H1(c);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:x,index:w,sourceLayerIndex:E}of r){const M=x??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),R=_u(g,m);if(!this.layers[0]._featureFilter.filter(new pn(this.zoom),R,c))continue;const D={id:M,sourceLayerIndex:E,index:w,geometry:m?R.geometry:Fs(g,c,f),properties:g.properties,type:g.type,patterns:{}},B=this.addFeature(D,D.geometry,R);B&&s.featureIndex.insert(g,D.geometry,w,E,this.index,this.instancesPerModel[B].instancedDataArray.length,Mt/32)}this.lookup=null}update(r,s,c,f){for(const m in this.instancesPerModel){const g=this.instancesPerModel[m];for(const x in r)g.idToFeaturesIndex.hasOwnProperty(x)&&(this.evaluate(g.features[g.idToFeaturesIndex[x]],r[x],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let r=!1;for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];for(const f of c.features){const m=this.layers[0],g=f.feature,x=this.canonical,w=m.paint.get("model-rotation").evaluate(g,{},x),E=m.paint.get("model-scale").evaluate(g,{},x),M=m.paint.get("model-translation").evaluate(g,{},x);a._.exactEquals(f.rotation,w)&&a._.exactEquals(f.scale,E)&&a._.exactEquals(f.translation,M)||(this.evaluate(f,f.featureStates,c,!0),r=!0)}}return r}updateReplacement(r,s,c){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const f=s.getReplacementRegionsForTile(r.toUnwrapped(),!0);if(BC(this.activeReplacements,f))return!1;this.activeReplacements=f;let m=!1;for(const g in this.instancesPerModel){const x=this.instancesPerModel[g],w=x.instancedDataArray;for(const E of x.features){const M=E.instancedDataOffset,R=E.instancedDataCount;for(let D=0;D<R;D++){const B=16*(D+M);let $=w.float32[B+0];$=$>Mt?$-Mt:$;const q=Math.floor($),X=w.float32[B+1];let te=!1;for(const ce of this.activeReplacements)if(!(ce.order<c||ce.order===1/0)&&ce.clipMask&Uz.Model&&!(ce.min.x>q||q>ce.max.x||ce.min.y>X||X>ce.max.y)&&(te=Dz(kz(q,X,r.canonical,ce.footprintTileId.canonical),ce),te))break;w.float32[B]=te?$+Mt:$,m=m||te}}}return m}isEmpty(){for(const r in this.instancesPerModel)if(this.instancesPerModel[r].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(r){if(!this.uploaded)for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=r.createVertexBuffer(c.instancedDataArray,c2.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const r=this.layers[0].modelManager;if(r&&this.modelUris)for(const s of this.modelUris)r.removeModel(s,"")}addFeature(r,s,c){const f=this.layers[0],m=f.layout.get("model-id").evaluate(c,{},this.canonical);if(!m)return Qr(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),m;wN(m,!1)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new TN);const g=this.instancesPerModel[m],x=g.instancedDataArray,w=new SN(c,x.length);for(const E of s)for(const M of E){if(M.x<0||M.x>=Mt||M.y<0||M.y>=Mt)continue;const R=(this.lookupDim-1)/Mt,D=this.lookupDim*(M.y*R|0)+M.x*R|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const B=x.length;x.resize(B+1),g.instancesEvaluatedElevation.push(0),x.float32[16*B]=M.x,x.float32[16*B+1]=M.y}return w.instancedDataCount=g.instancedDataArray.length-w.instancedDataOffset,w.instancedDataCount>0&&(r.id&&(g.idToFeaturesIndex[r.id]=g.features.length),g.features.push(w),this.evaluate(w,{},g,!1)),m}getModelUris(){return this.modelUris}evaluate(r,s,c,f){const m=this.layers[0],g=r.feature,x=this.canonical,w=r.rotation=m.paint.get("model-rotation").evaluate(g,s,x),E=r.scale=m.paint.get("model-scale").evaluate(g,s,x),M=r.translation=m.paint.get("model-translation").evaluate(g,s,x),R=m.paint.get("model-color").evaluate(g,s,x);R.a=m.paint.get("model-color-mix-intensity").evaluate(g,s,x);const D=[];this.maxVerticalOffset<M[2]&&(this.maxVerticalOffset=M[2]),this.maxScale=Math.max(Math.max(this.maxScale,E[0]),Math.max(E[1],E[2])),xN(D,w,E);const B=Math.round(100*R.a)+R.b/1.05;for(let $=0;$<r.instancedDataCount;++$){const q=r.instancedDataOffset+$,X=16*q,te=c.instancedDataArray.float32;let ce=0;f&&(ce=te[X+6]-c.instancesEvaluatedElevation[q]);const he=0|te[X+1];te[X]=(0|te[X])+R.r/1.05,te[X+1]=he+R.g/1.05,te[X+2]=B,te[X+3]=1/(x.z>10?this.tileToMeter:H1(x,he)),te[X+4]=M[0],te[X+5]=M[1],te[X+6]=M[2]+ce,te[X+7]=D[0],te[X+8]=D[1],te[X+9]=D[2],te[X+10]=D[4],te[X+11]=D[5],te[X+12]=D[6],te[X+13]=D[8],te[X+14]=D[9],te[X+15]=D[10],c.instancesEvaluatedElevation[q]=M[2]}}}pe(hP,"ModelBucket",{omit:["layers"]}),pe(TN,"PerModelAttributes"),pe(SN,"ModelFeature");const f2=new nr({visibility:new pt(Ve.layout_model.visibility),"model-id":new zt(Ve.layout_model["model-id"])});var d2={paint:new nr({"model-opacity":new pt(Ve.paint_model["model-opacity"]),"model-rotation":new zt(Ve.paint_model["model-rotation"]),"model-scale":new zt(Ve.paint_model["model-scale"]),"model-translation":new zt(Ve.paint_model["model-translation"]),"model-color":new zt(Ve.paint_model["model-color"]),"model-color-mix-intensity":new zt(Ve.paint_model["model-color-mix-intensity"]),"model-type":new pt(Ve.paint_model["model-type"]),"model-cast-shadows":new pt(Ve.paint_model["model-cast-shadows"]),"model-receive-shadows":new pt(Ve.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new pt(Ve.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new zt(Ve.paint_model["model-emissive-strength"]),"model-roughness":new zt(Ve.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new zt(Ve.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new pt(Ve.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new pt(Ve.paint_model["model-front-cutoff"])}),layout:f2};const ed=64,fm={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function EN(i,r,s,c,f,m,g,x,w,E=!1){const M=s.zoom,R=s.project(c),D=Zf(c.lat,M),B=1/D;a.ad.identity(i),a.ad.translate(i,i,[R.x+g[0]*B,R.y+g[1]*B,g[2]]);let $=1,q=1;const X=s.worldSize;if(E){if(s.projection.name==="mercator"){let fe=0;s.elevation&&(fe=s.elevation.getAtPointOrZero(new so(R.x/X,R.y/X),0));const Ee=a.aA.transformMat4([],[R.x,R.y,fe,1],s.projMatrix)[3]/s.cameraToCenterDistance;$=Ee,q=Ee*Zf(s.center.lat,M)}else if(s.projection.name==="globe"){const fe=cP(i,s),Ee=a.ad.multiply([],s.projMatrix,fe),we=[0,0,0,1];a.aA.transformMat4(we,we,Ee);const Ie=we[3]/s.cameraToCenterDistance,ke=xu(M),$e=s.projection.pixelsPerMeter(c.lat,X)*Zf(c.lat,M),nt=s.projection.pixelsPerMeter(s.center.lat,X)*Zf(s.center.lat,M);$=Ie/on($e,UL(s.center.lat),ke),q=Ie*D/$e,$*=nt,q*=nt}}else $=B;a.ad.scale(i,i,[$,$,q]);const te=[...i],ce=r.orientation,he=[];if(xN(he,[ce[0]+f[0],ce[1]+f[1],ce[2]+f[2]],m),a.ad.multiply(i,te,he),x&&s.elevation){let fe=0;const Ee=[];if(w&&s.elevation){fe=function(ke,$e,nt,He,ut){const bt=$e.elevation;if(!bt)return 0;const ot=jr.projectAabbCorners(nt,He),yt=Mo(1,ut.lat)*$e.worldSize,it=function(tn,xn){const un=[0,0,1],Tn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const bn of Tn){const kn=tn[bn.corners[0]],sn=tn[bn.corners[1]],mr=tn[bn.corners[2]],cr=[sn[0]-kn[0],sn[1]-kn[1],xn*(sn[2]-kn[2])],Qn=a._.cross(cr,cr,[mr[0]-kn[0],mr[1]-kn[1],xn*(mr[2]-kn[2])]);a._.normalize(Qn,Qn),bn.dotProductWithUp=a._.dot(Qn,un)}return Tn.sort((bn,kn)=>bn.dotProductWithUp-kn.dotProductWithUp),Tn[0].corners}(ot,yt),_t=ot[it[0]],Tt=ot[it[1]],xt=ot[it[2]],Ft=ot[it[3]],wt=bt.getAtPointOrZero(new so(_t[0]/$e.worldSize,_t[1]/$e.worldSize),0),Ct=bt.getAtPointOrZero(new so(Tt[0]/$e.worldSize,Tt[1]/$e.worldSize),0),Jt=bt.getAtPointOrZero(new so(xt[0]/$e.worldSize,xt[1]/$e.worldSize),0),Kt=bt.getAtPointOrZero(new so(Ft[0]/$e.worldSize,Ft[1]/$e.worldSize),0),Ht=(wt+Kt)/2,Et=(Ct+Jt)/2;return Ht>Et?Ct<Jt?zb(ke,Tt,Ft,_t,Ct,Kt,wt,yt):zb(ke,xt,_t,Ft,Jt,wt,Kt,yt):wt<Kt?zb(ke,_t,Tt,xt,wt,Ct,Jt,yt):zb(ke,Ft,xt,Tt,Kt,Jt,Ct,yt),Math.max(Ht,Et)}(Ee,s,r.aabb,i,c);const we=a.ad.fromQuat([],Ee),Ie=a.ad.multiply([],we,he);a.ad.multiply(i,te,Ie)}else fe=s.elevation.getAtPointOrZero(new so(R.x/X,R.y/X),0);fe!==0&&(i[14]+=fe)}}function Q_(i,r,s=!1){i.uploaded||(i.gfxTexture=new as(r,i.image,s?r.gl.R8:r.gl.RGBA,{useMipmap:i.sampler.minFilter>=r.gl.NEAREST_MIPMAP_NEAREST}),i.uploaded=!0,i.image=null)}function p2(i,r,s){i.indexBuffer=r.createIndexBuffer(i.indexArray,!1,!0),i.vertexBuffer=r.createVertexBuffer(i.vertexArray,o2.members,!1,!0),i.normalArray&&(i.normalBuffer=r.createVertexBuffer(i.normalArray,u2.members,!1,!0)),i.texcoordArray&&(i.texcoordBuffer=r.createVertexBuffer(i.texcoordArray,l2.members,!1,!0)),i.colorArray&&(i.colorBuffer=r.createVertexBuffer(i.colorArray,(i.colorArray.bytesPerElement===12?a2:s2).members,!1,!0)),i.featureArray&&(i.pbrBuffer=r.createVertexBuffer(i.featureArray,h2.members,!0)),i.segments=Br.simpleSegment(0,0,i.vertexArray.length,i.indexArray.length);const c=i.material;c.pbrMetallicRoughness.baseColorTexture&&Q_(c.pbrMetallicRoughness.baseColorTexture,r),c.pbrMetallicRoughness.metallicRoughnessTexture&&Q_(c.pbrMetallicRoughness.metallicRoughnessTexture,r),c.normalTexture&&Q_(c.normalTexture,r),c.occlusionTexture&&Q_(c.occlusionTexture,r,s),c.emissionTexture&&Q_(c.emissionTexture,r)}function fP(i,r,s){if(i.meshes)for(const c of i.meshes)p2(c,r,s);if(i.children)for(const c of i.children)fP(c,r,s)}function Nb(i){if(i.meshes)for(const r of i.meshes)r.indexArray.destroy(),r.vertexArray.destroy(),r.colorArray&&r.colorArray.destroy(),r.normalArray&&r.normalArray.destroy(),r.texcoordArray&&r.texcoordArray.destroy(),r.featureArray&&r.featureArray.destroy();if(i.children)for(const r of i.children)Nb(r)}function dP(i){if(i.meshes)for(const s of i.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((r=s.material).pbrMetallicRoughness.baseColorTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),r.pbrMetallicRoughness.metallicRoughnessTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),r.normalTexture&&r.normalTexture.gfxTexture&&r.normalTexture.gfxTexture.destroy(),r.emissionTexture&&r.emissionTexture.gfxTexture&&r.emissionTexture.gfxTexture.destroy(),r.occlusionTexture&&r.occlusionTexture.gfxTexture&&r.occlusionTexture.gfxTexture.destroy()));var r;if(i.children)for(const s of i.children)dP(s)}class m2{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class g2{constructor(){this.tasks={},this.taskQueue=[],up(["process"],this),this.invoker=new m2(this.process),this.nextId=0}add(r,s){const c=this.nextId++,f=function({type:m,isSymbolTile:g,zoom:x}){return x=x||0,m==="message"?0:m!=="maybePrepare"||g?m!=="parseTile"||g?m==="parseTile"&&g?300-x:m==="maybePrepare"&&g?400-x:500:200-x:100-x}(s);if(f===0){try{r()}finally{}return null}return this.tasks[c]={fn:r,metadata:s,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const s=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let r=null,s=1/0;for(let f=0;f<this.taskQueue.length;f++){const m=this.tasks[this.taskQueue[f]];m.priority<s&&(s=m.priority,r=f)}if(r===null)return null;const c=this.taskQueue[r];return this.taskQueue.splice(r,1),c}remove(){this.invoker.remove()}}class AN{constructor(r,s,c){this.target=r,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},up(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new g2}send(r,s,c,f,m=!1,g){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=g,this.callbacks[x]=c);const w=new Set;return this.target.postMessage({id:x,type:r,hasCallback:!!c,targetMapId:f,mustQueue:m,sourceMapId:this.mapId,data:Re(s,w)},w),{cancel:()=>{c&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(r){const s=r.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(s.mustQueue||ki()){const f=this.callbacks[c],m=this.scheduler.add(()=>this.processTask(c,s),f&&f.metadata||{type:"message"});m&&(this.cancelCallbacks[c]=m)}else this.processTask(c,s)}processTask(r,s){if(delete this.cancelCallbacks[r],s.type==="<response>"){const c=this.callbacks[r];delete this.callbacks[r],c&&(s.error?c(Ge(s.error)):c(null,Ge(s.data)))}else{const c=new Set,f=s.hasCallback?(g,x)=>{this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:g?Re(g):null,data:Re(x,c)},c)}:g=>{},m=Ge(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,m,f);else if(this.parent.getWorkerSource){const g=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,g[0],m.source,m.scope)[g[1]](m,f)}else f(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class dm{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=sp();const c=this.workerPool.acquire(this.id);for(let f=0;f<c.length;f++){const m=new dm.Actor(c[f],s,this.id);m.name=`Worker ${f}`,this.actors.push(m)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,s,c){mc(this.actors,(f,m)=>{f.send(r,s,m)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}dm.Actor=AN;var J_={workerUrl:"",workerClass:null,workerParams:void 0};function y2(){return J_.workerClass!=null?new J_.workerClass:new self.Worker(J_.workerUrl,J_.workerParams)}const pP="mapboxgl_preloaded_worker_pool";class ev{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<ev.workerCount;)this.workers.push(new y2);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[pP]}numActive(){return Object.keys(this.active).length}}let tv;function Bb(){return tv||(tv=new ev),tv}ev.workerCount=2;let jb,mP,Gs,pm,gP,mm=null;function CN(){return ki()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:mP||A.DRACO_URL}function PN(){if(ki()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(pm)return pm;const i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return pm=WebAssembly.validate(i)?A.MESHOPT_SIMD_URL:A.MESHOPT_URL,pm}const $b={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_2={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},nv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function MN(i,r,s){const c=s.json.bufferViews.length,f=s.buffers.length;r.bufferView=c,s.json.bufferViews[c]={buffer:f,byteLength:i.byteLength},s.buffers[f]=i}const yP="KHR_draco_mesh_compression";function v2(i,r){const s=i.extensions&&i.extensions[yP];if(!s)return;const c=new Gs.Decoder,f=kN(r,s.bufferView),m=new Gs.Mesh;if(!c.DecodeArrayToMesh(f,f.byteLength,m))throw new Error("Failed to decode Draco mesh");const g=r.json.accessors[i.indices],x=$b[g.componentType],w=g.count*x.BYTES_PER_ELEMENT,E=Gs._malloc(w);x===Uint16Array?c.GetTrianglesUInt16Array(m,w,E):c.GetTrianglesUInt32Array(m,w,E),MN(Gs.memory.buffer.slice(E,E+w),g,r),Gs._free(E);for(const M of Object.keys(s.attributes)){const R=c.GetAttributeByUniqueId(m,s.attributes[M]),D=r.json.accessors[i.attributes[M]],B=_2[D.componentType],$=D.count*nv[D.type]*$b[D.componentType].BYTES_PER_ELEMENT,q=Gs._malloc($);c.GetAttributeDataArrayForAllPoints(m,R,Gs[B],$,q),MN(Gs.memory.buffer.slice(q,q+$),D,r),Gs._free(q)}c.destroy(),m.destroy(),delete i.extensions[yP]}const Ub="EXT_meshopt_compression";function x2(i,r){if(!i.extensions||!i.extensions[Ub])return;const s=i.extensions[Ub],c=new Uint8Array(r.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),f=new Uint8Array(s.count*s.byteStride);gP.decodeGltfBuffer(f,s.count,s.byteStride,c,s.mode,s.filter),i.buffer=r.buffers.length,i.byteOffset=0,r.buffers[i.buffer]=f.buffer,delete i.extensions[Ub]}const IN=1179937895,ON=new TextDecoder("utf8");function RN(i,r){return new URL(i,r).href}function b2(i,r,s,c){return fetch(RN(i.uri,c)).then(f=>f.arrayBuffer()).then(f=>{r.buffers[s]=f})}function kN(i,r){const s=i.json.bufferViews[r];return new Uint8Array(i.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function w2(i,r,s,c){if(i.uri){const f=RN(i.uri,c);return fetch(f).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{r.images[s]=m})}if(i.bufferView!==void 0){const f=kN(r,i.bufferView),m=new Blob([f],{type:i.mimeType});return createImageBitmap(m).then(g=>{r.images[s]=g})}}function DN(i,r=0,s){const c={json:null,images:[],buffers:[]};if(new Uint32Array(i,r,1)[0]===IN){const M=new Uint32Array(i,r);let R=2;const D=(M[R++]>>2)-3,B=M[R++]>>2;if(R++,c.json=JSON.parse(ON.decode(M.subarray(R,R+B))),R+=B,R<D){const $=M[R++];R++;const q=r+(R<<2);c.buffers[0]=i.slice(q,q+$)}}else c.json=JSON.parse(ON.decode(new Uint8Array(i,r)));const{buffers:f,images:m,meshes:g,extensionsUsed:x,bufferViews:w}=c.json;let E=Promise.resolve();if(f){const M=[];for(let R=0;R<f.length;R++){const D=f[R];D.uri?M.push(b2(D,c,R,s)):c.buffers[R]||(c.buffers[R]=null)}E=Promise.all(M)}return E.then(()=>{const M=[],R=x&&x.includes(yP),D=x&&x.includes(Ub);if(R&&M.push(function(){if(!Gs)return jb||(jb=function(B){let $,q=null;function X(){$=new Uint8Array(q.buffer)}function te(){throw new Error("Unexpected Draco error.")}const ce={a:{a:te,d:function(he,fe,Ee){return $.copyWithin(he,fe,fe+Ee)},c:function(he){const fe=$.length,Ee=Math.max(he>>>0,Math.ceil(1.2*fe)),we=Math.ceil((Ee-fe)/65536);try{return q.grow(we),X(),!0}catch{return!1}},b:te}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(B,ce):B.then(he=>he.arrayBuffer()).then(he=>WebAssembly.instantiate(he,ce))).then(he=>{const{Rb:fe,Qb:Ee,P:we,T:Ie,X:ke,Ja:$e,La:nt,Qa:He,Va:ut,Wa:bt,eb:ot,jb:yt,f:it,e:_t,yb:Tt,zb:xt,Ab:Ft,Bb:wt,Db:Ct,Gb:Jt}=he.instance.exports;q=_t;const Kt=(()=>{let Ht=0,Et=0,tn=0,xn=0;return un=>{tn&&(fe(xn),fe(Ht),Et+=tn,tn=Ht=0),Ht||(Et+=128,Ht=Ee(Et));const Tn=un.length+7&-8;let bn=Ht;Tn>=Et&&(tn=Tn,bn=xn=Ee(Tn));for(let kn=0;kn<un.length;kn++)$[bn+kn]=un[kn];return bn}})();return X(),it(),{memory:_t,_free:fe,_malloc:Ee,Mesh:class{constructor(){this.ptr=we()}destroy(){Ie(this.ptr)}},Decoder:class{constructor(){this.ptr=$e()}destroy(){yt(this.ptr)}DecodeArrayToMesh(Ht,Et,tn){const xn=Kt(Ht),un=nt(this.ptr,xn,Et,tn.ptr);return!!ke(un)}GetAttributeByUniqueId(Ht,Et){return{ptr:He(this.ptr,Ht.ptr,Et)}}GetTrianglesUInt16Array(Ht,Et,tn){ut(this.ptr,Ht.ptr,Et,tn)}GetTrianglesUInt32Array(Ht,Et,tn){bt(this.ptr,Ht.ptr,Et,tn)}GetAttributeDataArrayForAllPoints(Ht,Et,tn,xn,un){ot(this.ptr,Ht.ptr,Et.ptr,tn,xn,un)}},DT_INT8:Tt(),DT_UINT8:xt(),DT_INT16:Ft(),DT_UINT16:wt(),DT_UINT32:Ct(),DT_FLOAT32:Jt()}})}(fetch(CN())),jb.then(B=>{Gs=B,jb=void 0}))}()),D&&M.push(function(){if(gP)return;const B=function($){let q;const X=WebAssembly.instantiateStreaming($,{}).then(he=>{q=he.instance,q.exports.__wasm_call_ctors()}),te={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ce={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:X,supported:!0,decodeGltfBuffer(he,fe,Ee,we,Ie,ke){(function($e,nt,He,ut,bt,ot,yt){const it=$e.exports.sbrk,_t=ut+3&-4,Tt=it(_t*bt),xt=it(ot.length),Ft=new Uint8Array($e.exports.memory.buffer);Ft.set(ot,xt);const wt=nt(Tt,ut,bt,xt,ot.length);if(wt===0&&yt&&yt(Tt,_t,bt),He.set(Ft.subarray(Tt,Tt+ut*bt)),it(Tt-it(0)),wt!==0)throw new Error(`Malformed buffer data: ${wt}`)})(q,q.exports[ce[Ie]],he,fe,Ee,we,q.exports[te[ke]])}}}(fetch(PN()));return B.ready.then(()=>{gP=B})}()),m)for(let B=0;B<m.length;B++)M.push(w2(m[B],c,B,s));return(M.length?Promise.all(M):Promise.resolve()).then(()=>{if(R&&g)for(const{primitives:B}of g)for(const $ of B)v2($,c);if(D&&g&&w)for(const B of w)x2(B,c);return c})})}function td(i,r){const s=i.json.bufferViews[r.bufferView],c=$b[r.componentType];return new c(i.buffers[s.buffer],(r.byteOffset||0)+(s.byteOffset||0),r.count*(s.byteStride&&s.byteStride!==nv[r.type]*c.BYTES_PER_ELEMENT?s.byteStride/c.BYTES_PER_ELEMENT:nv[r.type]))}function _P(i,r,s,c){const f=$b[r.componentType],m=function(M){switch(M){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),g=i.json.bufferViews[r.bufferView],x=g.byteStride?g.byteStride/f.BYTES_PER_ELEMENT:nv[r.type],w=s.float32,E=w.length/s.capacity;for(let M=0,R=0;M<r.count*x;M+=x,R+=E)for(let D=0;D<E;D++)w[R+D]=c[M+D]*m;s._trim()}function S2(i,r,s){const c=i.indices,f=i.attributes,m={};m.indexArray=new Pi;const g=r.json.accessors[c],x=g.count/3;m.indexArray.reserve(x);const w=td(r,g);for(let D=0;D<x;D++)m.indexArray.emplaceBack(w[3*D],w[3*D+1],w[3*D+2]);m.indexArray._trim(),m.vertexArray=new $c;const E=r.json.accessors[f.POSITION];m.vertexArray.reserve(E.count);const M=td(r,E);for(let D=0;D<E.count;D++)m.vertexArray.emplaceBack(M[3*D],M[3*D+1],M[3*D+2]);if(m.vertexArray._trim(),m.aabb=new jr(E.min,E.max),m.centroid=function(D,B){const $=[0,0,0],q=D.length;if(q>0){for(let X=0;X<q;X++){const te=3*D[X];$[0]+=B[te],$[1]+=B[te+1],$[2]+=B[te+2]}$[0]/=q,$[1]/=q,$[2]/=q}return $}(w,M),f.COLOR_0!==void 0){const D=r.json.accessors[f.COLOR_0],B=nv[D.type],$=td(r,D);m.colorArray=B===3?new $c:new jc,m.colorArray.resize(D.count),_P(r,D,m.colorArray,$)}if(f.NORMAL!==void 0){m.normalArray=new $c;const D=r.json.accessors[f.NORMAL];m.normalArray.resize(D.count);const B=td(r,D);_P(r,D,m.normalArray,B)}if(f.TEXCOORD_0!==void 0&&s.length>0){m.texcoordArray=new Wp;const D=r.json.accessors[f.TEXCOORD_0];m.texcoordArray.resize(D.count);const B=td(r,D);_P(r,D,m.texcoordArray,B)}if(f._FEATURE_ID_RGBA4444!==void 0){const D=r.json.accessors[f._FEATURE_ID_RGBA4444];r.json.extensionsUsed&&r.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=td(r,D))}f._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(td(r,r.json.accessors[f._FEATURE_RGBA4444]).buffer));const R=i.material;return m.material=function(D,B){const{emissiveFactor:$=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:X=.5,normalTexture:te,occlusionTexture:ce,emissiveTexture:he,doubleSided:fe}=D,{baseColorFactor:Ee=[1,1,1,1],metallicFactor:we=1,roughnessFactor:Ie=1,baseColorTexture:ke,metallicRoughnessTexture:$e}=D.pbrMetallicRoughness||{},nt=ce?B[ce.index]:void 0;if(ce&&ce.extensions&&ce.extensions.KHR_texture_transform&&nt){const He=ce.extensions.KHR_texture_transform;nt.offsetScale=[He.offset[0],He.offset[1],He.scale[0],He.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Xn(...Ee),metallicFactor:we,roughnessFactor:Ie,baseColorTexture:ke?B[ke.index]:void 0,metallicRoughnessTexture:$e?B[$e.index]:void 0},doubleSided:fe,emissiveFactor:$,alphaMode:q,alphaCutoff:X,normalTexture:te?B[te.index]:void 0,occlusionTexture:nt,emissionTexture:he?B[he.index]:void 0,defined:D.defined===void 0}}(R!==void 0?r.json.materials[R]:{defined:!1},s),m}function LN(i,r,s){const{matrix:c,rotation:f,translation:m,scale:g,mesh:x,extras:w,children:E}=i,M={};if(M.matrix=c||a.ad.fromRotationTranslationScale([],f||[0,0,0,1],m||[0,0,0],g||[1,1,1]),x!==void 0){M.meshes=s[x];const R=M.anchor=[0,0];for(const D of M.meshes){const{min:B,max:$}=D.aabb;R[0]+=B[0]+$[0],R[1]+=B[1]+$[1]}R[0]=Math.floor(R[0]/M.meshes.length/2),R[1]=Math.floor(R[1]/M.meshes.length/2)}if(w&&(w.id&&(M.id=w.id),w.lights&&(M.lights=function(R){if(!R.length)return[];const D=function(te){const ce=atob(te),he=new Uint8Array(ce.length);for(let fe=0;fe<ce.length;fe++)he[fe]=ce.codePointAt(fe);return he}(R),B=[],$=D.length/24,q=new Uint16Array(D.buffer),X=new Float32Array(D.buffer);for(let te=0;te<$;te++){const ce=q[2*te*6]/30,he=q[2*te*6+1]/30,fe=q[2*te*6+10]/100,Ee=X[6*te+1],we=X[6*te+2],Ie=X[6*te+3],ke=X[6*te+4],$e=Ie-Ee,nt=ke-we,He=Math.hypot($e,nt);B.push({pos:[Ee+.5*$e,we+.5*nt,he],normal:[nt/He,-$e/He,0],width:He,height:ce,depth:fe,points:[Ee,we,Ie,ke]})}return B}(w.lights))),E){const R=[];for(const D of E)R.push(LN(r.json.nodes[D],r,s));M.children=R}return M}function T2(i){if(i.vertices.length===0||i.indices.length===0)return null;const r=new zC(i.vertices,i.indices,8,256),[s,c]=[r.min.clone(),r.max.clone()];return{vertices:i.vertices,indices:i.indices,grid:r,min:s,max:c}}function E2(i){if(!i.extras||!i.extras.ground)return null;const r=i.extras.ground;if(!r||!Array.isArray(r)||r.length===0)return null;const s=r[0];if(!s||!Array.isArray(s)||s.length===0)return null;const c=[];for(const g of s){if(!Array.isArray(g)||g.length!==2)continue;const x=g[0],w=g[1];typeof x=="number"&&typeof w=="number"&&c.push(new Lt(x,w))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let f=0;for(let g=0;g<c.length;g++){const x=c[g],w=c[(g+1)%c.length],E=c[(g+2)%c.length];f+=(x.x-w.x)*(E.y-w.y)-(E.x-w.x)*(x.y-w.y)}f>0&&c.reverse();const m=R_(c.flatMap(g=>[g.x,g.y]),[]);return m.length===0?null:{vertices:c,indices:m}}function A2(i,r){const s=[],c=[];let f=0;const m=[];for(const g of i){f=s.length;const x=g.vertexArray.float32,w=g.indexArray.uint16;for(let E=0;E<g.vertexArray.length;E++)m[0]=x[3*E+0],m[1]=x[3*E+1],m[2]=x[3*E+2],a._.transformMat4(m,m,r),s.push(new Lt(m[0],m[1]));for(let E=0;E<3*g.indexArray.length;E++)c.push(w[E]+f)}if(c.length%3!=0)return null;for(let g=0;g<c.length;g+=3){const x=s[c[g+0]],w=s[c[g+1]],E=s[c[g+2]];(x.x-w.x)*(E.y-w.y)-(E.x-w.x)*(x.y-w.y)>0&&([c[g+1],c[g+2]]=[c[g+2],c[g+1]])}return{vertices:s,indices:c}}function zN(i){const r=function(w,E){const M=[],R=WebGL2RenderingContext;if(w.json.textures)for(const D of w.json.textures){const B={magFilter:R.LINEAR,minFilter:R.NEAREST,wrapS:R.REPEAT,wrapT:R.REPEAT};D.sampler!==void 0&&Object.assign(B,w.json.samplers[D.sampler]),M.push({image:E[D.source],sampler:B,uploaded:!1})}return M}(i,i.images),s=function(w,E){const M=[];for(const R of w.json.meshes){const D=[];for(const B of R.primitives)D.push(S2(B,w,E));M.push(D)}return M}(i,r),{scenes:c,scene:f,nodes:m}=i.json,g=c?c[f||0].nodes:m,x=[];for(const w of g)x.push(LN(m[w],i,s));return function(w,E,M){const R={},D=new Set;for(let B=0;B<w.length;B++){const $=M[E[B]];if(!$.extras)continue;const q=$.extras["mapbox:footprint:version"],X=$.extras["mapbox:footprint:id"];(q||X)&&D.add(B),q==="1.0.0"&&X&&(R[X]=B)}for(let B=0;B<w.length;B++){if(D.has(B))continue;const $=w[B],q=M[E[B]];if(!q.extras)continue;let X=null;$.id in R&&(X=A2(w[R[$.id]].meshes,$.matrix)),X||(X=E2(q)),X&&($.footprint=T2(X))}if(D.size>0){const B=Array.from(D.values()).sort(($,q)=>$-q);for(let $=B.length-1;$>=0;$--)w.splice(B[$],1)}}(x,g,i.json.nodes),x}function C2(i){i.heightmap=new Float32Array(4096),i.heightmap.fill(-1);const r=i.vertexArray.float32,s=i.aabb.min[0]-1,c=i.aabb.min[1]-1,f=ed/(i.aabb.max[0]-s+2),m=ed/(i.aabb.max[1]-c+2);for(let g=0;g<r.length;g+=3){const x=r[g+2],w=(r[g+0]-s)*f|0,E=(r[g+1]-c)*m|0;x>i.heightmap[E*ed+w]&&(i.heightmap[E*ed+w]=x)}}function P2(i,r){const s={};s.indexArray=new Pi,s.indexArray.reserve(4*i.length),s.vertexArray=new $c,s.vertexArray.reserve(10*i.length),s.colorArray=new jc,s.vertexArray.reserve(10*i.length);let c=0;for(const g of i){const x=Math.min(10,Math.max(4,1.3*g.height))*r,w=[-g.normal[1],g.normal[0],0],E=Math.min(.29,.1*g.width/g.depth),M=g.width-2*g.depth*r*(E+.01),R=a._.scaleAndAdd([],g.pos,w,M/2),D=a._.scaleAndAdd([],g.pos,w,-M/2),B=[R[0],R[1],R[2]+g.height],$=[D[0],D[1],D[2]+g.height],q=a._.scaleAndAdd([],g.normal,w,E);a._.scale(q,q,x);const X=a._.scaleAndAdd([],g.normal,w,-E);a._.scale(X,X,x),a._.add(q,R,q),a._.add(X,D,X),R[2]+=.1,D[2]+=.1,s.vertexArray.emplaceBack(q[0],q[1],q[2]),s.vertexArray.emplaceBack(X[0],X[1],X[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack($[0],$[1],$[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(q[0],q[1],q[2]),s.vertexArray.emplaceBack(X[0],X[1],X[2]);const te=M/x/2;s.colorArray.emplaceBack(-te-E,-1,te,.8),s.colorArray.emplaceBack(te+E,-1,te,.8),s.colorArray.emplaceBack(-te,0,te,1.3),s.colorArray.emplaceBack(te,0,te,1.3),s.colorArray.emplaceBack(te+E,-.8,te,.7),s.colorArray.emplaceBack(te+E,-.8,te,.7),s.colorArray.emplaceBack(0,0,te,1.3),s.colorArray.emplaceBack(0,0,te,1.3),s.colorArray.emplaceBack(te+E,-1.2,te,.8),s.colorArray.emplaceBack(te+E,-1.2,te,.8),s.indexArray.emplaceBack(6+c,4+c,8+c),s.indexArray.emplaceBack(7+c,9+c,5+c),s.indexArray.emplaceBack(0+c,1+c,2+c),s.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const f={defined:!0,emissiveFactor:[0,0,0]},m={};return m.baseColorFactor=Xn.white,f.pbrMetallicRoughness=m,s.material=f,s.aabb=new jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}const vP=new Float32Array(262144),nd=new Uint8Array(262144);function FN(i){let r=0;if(i.meshes)for(const s of i.meshes)r=Math.max(r,s.aabb.max[2]);if(i.children)for(const s of i.children)r=Math.max(r,FN(s));return r}function NN(i,r,s){if(i.meshes)for(const c of i.meshes)c.aabb.min[0]!==1/0&&s.insert(r,c.aabb.min[0],c.aabb.min[1],c.aabb.max[0],c.aabb.max[1]);if(i.children)for(const c of i.children)NN(c,r,s)}const BN=["","wall","door","roof","window","lamp","logo"];class jN{constructor(r){this.node=r,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:r.id,geometry:[],properties:{height:FN(r)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let r=0;const s=new jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==r&&(c.transformedAabb=jr.applyTransform(c.aabb,this.node.matrix),s.encapsulate(c.transformedAabb)),r++;this.aabb=s}return this.aabb}}class Vb{constructor(r,s,c,f,m,g){this.id=s,this.modelTraits|=fm.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=fm.HasMapboxMeshFeatures),f&&(this.modelTraits|=fm.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=m,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const x of r)this.nodesInfo.push(new jN(x)),NN(x,g.featureIndexArray.length,g.grid),g.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,g.bucketLayerIDs.length-1,0)}updateFootprints(r,s){for(const c of this.getNodesInfo()){const f=c.node;f.footprint&&s.push({footprint:f.footprint,id:r})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(r){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const c of s){const f=c.node;this.uploaded?this.updatePbrBuffer(f):fP(f,r,!0)}for(const c of s)Nb(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(r){let s=!1;if(!r.meshes)return s;for(const c of r.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),s=!0);return s}needsReEvaluation(r,s,c){const f=r.transform.projectionOptions,m=r.style.getBrightness(),g=this.brightness!==m;return!!(!this.uploaded||this.dirty||f.name!==this.projection.name||rv(c.paint.get("model-color").value,g)||rv(c.paint.get("model-color-mix-intensity").value,g)||rv(c.paint.get("model-roughness").value,g)||rv(c.paint.get("model-emissive-strength").value,g)||rv(c.paint.get("model-height-based-emissive-strength-multiplier").value,g))&&(this.projection=f,this.brightness=m,!0)}evaluateScale(r,s){if(r.transform.zoom===this.zoom)return;this.zoom=r.transform.zoom;const c=this.getNodesInfo(),f=this.id.canonical;for(const m of c){const g=m.feature;m.evaluatedScale=s.paint.get("model-scale").evaluate(g,{},f)}}evaluate(r){const s=this.getNodesInfo();for(const c of s){if(!c.node.meshes)continue;const f=c.feature,m=c.node.meshes&&c.node.meshes[0].featureData,g=c.evaluatedColor[2],x=c.evaluatedRMEA[2],w=this.id.canonical;if(c.hasTranslucentParts=!1,m){for(let E=0;E<BN.length;E++){const M=BN[E];M.length&&(f.properties.part=M);const R=r.paint.get("model-color").evaluate(f,{},w).toRenderColor(null),D=r.paint.get("model-color-mix-intensity").evaluate(f,{},w);c.evaluatedColor[E]=[R.r,R.g,R.b,D],c.evaluatedRMEA[E][0]=r.paint.get("model-roughness").evaluate(f,{},w),c.evaluatedRMEA[E][2]=r.paint.get("model-emissive-strength").evaluate(f,{},w),c.evaluatedRMEA[E][3]=R.a,c.emissionHeightBasedParams[E]=r.paint.get("model-height-based-emissive-strength-multiplier").evaluate(f,{},w),!c.hasTranslucentParts&&R.a<1&&(c.hasTranslucentParts=!0)}delete f.properties.part,I2(c,g!==c.evaluatedColor[2]||x!==c.evaluatedRMEA[2],this.modelTraits)}else c.evaluatedRMEA[0][2]=r.paint.get("model-emissive-strength").evaluate(f,{},w);c.evaluatedScale=r.paint.get("model-scale").evaluate(f,{},w),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(r,s,c,f){const m=r.findDEMTileFor(c);if(m&&(m.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const g=em.create(r,c,m);if(!g)return;this.modelTraits&fm.HasMapboxMeshFeatures&&this.updateDEM(r,g,c,f);for(const x of this.getNodesInfo()){const w=x.node;if(!w.footprint||!w.footprint.vertices||!w.footprint.vertices.length)continue;const E=w.footprint.vertices;let M=g.getElevationAt(E[0].x,E[0].y,!0,!0);for(let R=1;R<E.length;R++)M=Math.min(M,g.getElevationAt(E[R].x,E[R].y,!0,!0));w.elevation=M}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=s}}updateDEM(r,s,c,f){let m=s._dem._modifiedForSources[f];if(m===void 0&&(s._dem._modifiedForSources[f]=[],m=s._dem._modifiedForSources[f]),m.includes(c.canonical))return;const g=s._dem.dim;m.push(c.canonical);let x=!1;for(const w of this.getNodesInfo()){const E=w.node;if(!E.footprint||!E.footprint.grid)continue;const M=E.footprint.grid,R=s.tileCoordToPixel(M.min.x,M.min.y),D=s.tileCoordToPixel(M.max.x,M.max.y),B=Math.min(Math.min(g-D.y,R.x),Math.min(R.y,g-D.x));if(B<0)continue;const $=Pn(B,2,5);let q=Math.max(0,R.x-$),X=Math.max(0,R.y-$),te=Math.min(D.x+$,g-1),ce=Math.min(D.y+$,g-1);for(let we=X;we<=ce;++we)for(let Ie=q;Ie<=te;++Ie)nd[we*g+Ie]=255;let he=0,fe=0;for(let we=0;we<M.cellsY;++we)for(let Ie=0;Ie<M.cellsX;++Ie){if(!M.cells[we*M.cellsX+Ie])continue;const ke=s.tileCoordToPixel(M.min.x+Ie/M.xScale,M.min.y+we/M.yScale),$e=s.tileCoordToPixel(M.min.x+(Ie+1)/M.xScale,M.min.y+(we+1)/M.yScale);for(let nt=ke.y;nt<=Math.min($e.y+1,g-1);++nt)for(let He=ke.x;He<=Math.min($e.x+1,g-1);++He)nd[nt*g+He]===255&&(nd[nt*g+He]=0,he+=s.getElevationAtPixel(He,nt),fe++)}const Ee=he/fe;q=Math.max(1,R.x-$),X=Math.max(1,R.y-$),te=Math.min(D.x+$,g-2),ce=Math.min(D.y+$,g-2),x=!0;for(let we=X;we<=ce;++we)for(let Ie=q;Ie<=te;++Ie)nd[we*g+Ie]===0&&(vP[we*g+Ie]=s._dem.set(Ie,we,Ee));for(let we=1;we<$;++we){q=Math.max(1,R.x-we),X=Math.max(1,R.y-we),te=Math.min(D.x+we,g-2),ce=Math.min(D.y+we,g-2);for(let Ie=X;Ie<=ce;++Ie)for(let ke=q;ke<=te;++ke){const $e=Ie*g+ke;if(nd[$e]===255){let nt=0,He=0,ut=-1,bt=-1;for(let ot=-1;ot<=1;++ot)for(let yt=-1;yt<=1;++yt){const it=(Ie+ot)*g+ke+yt;if(nd[it]>=we)continue;const _t=vP[it],Tt=Math.abs(_t);Tt>He&&(nt=_t,He=Tt,ut=yt,bt=ot)}if(He>.1){const ot=1-(we+.5*Math.abs(ut*bt))/$;let yt=s._dem.get(ke,Ie)+nt*ot;const it=s._dem.get(ke+ut,Ie+bt),_t=s._dem.get(ke-ut,Ie-bt,!0);(yt-it)*(yt-_t)>0&&(yt=(it+_t)/2),vP[$e]=s._dem.set(ke,Ie,yt),nd[$e]=we}}}}}x&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Di.now())}getNodesInfo(){return this.nodesInfo}destroy(){const r=this.getNodesInfo();for(const s of r)Nb(s.node),dP(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(r,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(r.toUnwrapped()),f=this.getNodesInfo();for(let m=0;m<this.nodesInfo.length;m++){const g=f[m].node;f[m].hiddenByReplacement=!!g.footprint&&!c.find(x=>x.footprint===g.footprint)}}getHeightAtTileCoord(r,s){const c=this.getNodesInfo(),f=[],m=[0,0,0],g=a.ad.identity([]);for(let x=0;x<this.nodesInfo.length;x++){const w=c[x],E=w.node.meshes[0],M=E.transformedAabb;if(r<M.min[0]||s<M.min[1]||r>M.max[0]||s>M.max[1])continue;if(w.node.hidden===!0)return{height:0,maxHeight:w.feature.properties.height,hidden:!1,verticalScale:w.evaluatedScale[2]};a.ad.invert(g,w.node.matrix),m[0]=r,m[1]=s,a._.transformMat4(m,m,g);const R=(m[0]-E.aabb.min[0])/(E.aabb.max[0]-E.aabb.min[0])*ed|0,D=Math.min(63,(m[1]-E.aabb.min[1])/(E.aabb.max[1]-E.aabb.min[1])*ed|0)*ed+Math.min(63,R),B=E.heightmap[D];if(!(B<0&&w.node.footprint))return w.hiddenByReplacement?void 0:{height:B,maxHeight:w.feature.properties.height,hidden:!1,verticalScale:w.evaluatedScale[2]};if(w.node.footprint.grid.query(new Lt(r,s),new Lt(r,s),f),f.length>0)return{height:void 0,maxHeight:w.feature.properties.height,hidden:w.hiddenByReplacement,verticalScale:w.evaluatedScale[2]}}}}function rv(i,r){return!i.isLightConstant&&r}function M2(i,r,s,c,f,m,g,x){let w=(61440&r|(61440&r)>>4)>>8,E=(3840&r|(3840&r)>>4)>>4,M=240&r|(240&r)>>4;s[3]>0&&(w=on(w,255*s[0],s[3]),E=on(E,255*s[1],s[3]),M=on(M,255*s[2],s[3]));const R=w<<8|E,D=M<<8|Math.floor(255*c[3]),B=function(we){const Ie=Pn(we,0,2);return Math.min(Math.round(.5*Ie*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],$=Pn(f[0],0,1),q=Pn(f[1],0,1),X=Pn(f[2],0,1),te=Pn(f[3],0,1);let ce,he,fe,Ee;if($!==q&&g!==m&&q!==$){const we=g-m;he=1/(we*(q-$)),fe=-(m+we*$)/(we*(q-$));const Ie=Pn(f[4],-1,1);Ee=Math.pow(10,Ie),ce=255*X<<8|255*te}else ce=65535,he=0,fe=1,Ee=1;if(i.emplaceBack(R,D,B,ce,he,fe,Ee),x){const we=x.length;x.clear();for(let Ie=0;Ie<we;Ie++)x.emplaceBack(R,D,B,ce,he,fe,Ee)}}function I2(i,r,s){const c=i.node;let f=0;const m=s&fm.HasMeshoptCompression;for(const g of c.meshes){if(c.lights&&c.lightMeshIndex===f||!g.featureData)continue;g.featureArray=new V1,g.featureArray.reserve(g.featureData.length);let x=r;for(const w of g.featureData){const E=m?65535&w:w>>16&65535,M=m?w>>16&65535:65535&w,R=(15&M)<8?15&M:0,D=i.evaluatedRMEA[R],B=i.evaluatedColor[R],$=i.emissionHeightBasedParams[R];let q;if(x&&R===2&&c.lights&&(q=new V1,q.resize(10*c.lights.length)),M2(g.featureArray,E,B,D,$,g.aabb.min[2],g.aabb.max[2],q),q&&x){x=!1;const X=c.meshes[c.lightMeshIndex];X.featureArray=q,X.featureArray._trim()}}g.featureArray._trim(),f++}}function $N(i,r,s,c){const f=1<<i.z;r.lat=Fi((c/Mt+i.y)/f),r.lng=Go((s/Mt+i.x)/f)}pe(Vb,"Tiled3dModelBucket",{omit:["layers"]}),pe(jN,"Tiled3dModelFeature");const O2={circle:class extends gi{constructor(i,r,s,c){super(i,_K,r,s,c)}createBucket(i){return new _C(i)}queryRadius(i){const r=i;return Kp("circle-radius",this,r)+Kp("circle-stroke-width",this,r)+X1(this.paint.get("circle-translate"))}queryIntersectsFeature(i,r,s,c,f,m,g,x){const w=KL(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),E=this.paint.get("circle-radius").evaluate(r,s)+this.paint.get("circle-stroke-width").evaluate(r,s);return fz(i,c,m,g,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",w,E)}getProgramIds(){return["circle"]}getDefaultProgramParams(i,r,s){const c=hz(this);return{config:new Wf(this,{zoom:r,lut:s}),defines:c,overrideFog:!1}}},heatmap:class extends gi{createBucket(i){return new pz(i)}constructor(i,r,s,c){super(i,MK,r,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=O_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Kp("heatmap-radius",this,i)}queryIntersectsFeature(i,r,s,c,f,m,g,x){const w=this.paint.get("heatmap-radius").evaluate(r,s);return fz(i,c,m,g,x,!0,!0,new Lt(0,0),w)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(i,r,s){return i==="heatmap"?{config:new Wf(this,{zoom:r,lut:s}),overrideFog:!1}:{}}},hillshade:class extends gi{constructor(i,r,s,c){super(i,OK,r,s,c)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(i,r,s){return{overrideFog:!1}}},fill:class extends gi{constructor(i,r,s,c){super(i,WK,r,s,c)}getProgramIds(){const i=this.paint.get("fill-pattern"),r=i&&i.constantOr(1),s=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(i,r,s){return{config:new Wf(this,{zoom:r,lut:s}),overrideFog:!1}}recalculate(i,r){super.recalculate(i,r);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new ib(i)}queryRadius(){return X1(this.paint.get("fill-translate"))}queryIntersectsFeature(i,r,s,c,f,m){return!i.queryGeometry.isAboveHorizon&&HL(YL(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends gi{constructor(i,r,s,c){super(i,bQ,r,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new hb(i)}queryRadius(){return X1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(i,r,s,c,f,m,g,x,w){const E=KL(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),M=this.paint.get("fill-extrusion-height").evaluate(r,s),R=this.paint.get("fill-extrusion-base").evaluate(r,s),D=[0,0],B=x&&m.elevation,$=m.elevation?m.elevation.exaggeration():1,q=i.tile.getBucket(this);if(B&&q instanceof hb){const fe=q.centroidVertexArray,Ee=w+1;Ee<fe.length&&(D[0]=fe.geta_centroid_pos0(Ee),D[1]=fe.geta_centroid_pos1(Ee))}if(D[0]===0&&D[1]===1)return!1;m.projection.name==="globe"&&(c=tF([c],[new Lt(0,0),new Lt(Mt,Mt)],i.tileID.canonical).map(fe=>fe.polygon).flat());const X=B?x:null,[te,ce]=function(fe,Ee,we,Ie,ke,$e,nt,He,ut,bt,ot){return fe.projection.name==="globe"?function(yt,it,_t,Tt,xt,Ft,wt,Ct,Jt,Kt,Ht){const Et=[],tn=[],xn=yt.projection.upVectorScale(Ht,yt.center.lat,yt.worldSize).metersToTile,un=[0,0,0,1],Tn=[0,0,0,1],bn=(sn,mr,cr,Qn)=>{sn[0]=mr,sn[1]=cr,sn[2]=Qn,sn[3]=1},kn=eF();_t>0&&(_t+=kn),Tt+=kn;for(const sn of it){const mr=[],cr=[];for(const Qn of sn){const Bn=Qn.x+xt.x,Jn=Qn.y+xt.y,Ar=yt.projection.projectTilePoint(Bn,Jn,Ht),wr=yt.projection.upVector(Ht,Qn.x,Qn.y);let Gr=_t,$r=Tt;if(wt){const lo=rF(Bn,Jn,_t,Tt,wt,Ct,Jt,Kt);Gr+=lo.base,$r+=lo.top}_t!==0?bn(un,Ar.x+wr[0]*xn*Gr,Ar.y+wr[1]*xn*Gr,Ar.z+wr[2]*xn*Gr):bn(un,Ar.x,Ar.y,Ar.z),bn(Tn,Ar.x+wr[0]*xn*$r,Ar.y+wr[1]*xn*$r,Ar.z+wr[2]*xn*$r),a._.transformMat4(un,un,Ft),a._.transformMat4(Tn,Tn,Ft),mr.push(new Yf(un[0],un[1],un[2])),cr.push(new Yf(Tn[0],Tn[1],Tn[2]))}Et.push(mr),tn.push(cr)}return[Et,tn]}(fe,Ee,we,Ie,ke,$e,nt,He,ut,bt,ot):nt?function(yt,it,_t,Tt,xt,Ft,wt,Ct,Jt){const Kt=[],Ht=[],Et=[0,0,0,1];for(const tn of yt){const xn=[],un=[];for(const Tn of tn){const bn=Tn.x+Tt.x,kn=Tn.y+Tt.y,sn=rF(bn,kn,it,_t,Ft,wt,Ct,Jt);Et[0]=bn,Et[1]=kn,Et[2]=sn.base,Et[3]=1,a.aA.transformMat4(Et,Et,xt),Et[3]=Math.max(Et[3],1e-5);const mr=new Yf(Et[0]/Et[3],Et[1]/Et[3],Et[2]/Et[3]);Et[0]=bn,Et[1]=kn,Et[2]=sn.top,Et[3]=1,a.aA.transformMat4(Et,Et,xt),Et[3]=Math.max(Et[3],1e-5);const cr=new Yf(Et[0]/Et[3],Et[1]/Et[3],Et[2]/Et[3]);xn.push(mr),un.push(cr)}Kt.push(xn),Ht.push(un)}return[Kt,Ht]}(Ee,we,Ie,ke,$e,nt,He,ut,bt):function(yt,it,_t,Tt,xt){const Ft=[],wt=[],Ct=xt[8]*it,Jt=xt[9]*it,Kt=xt[10]*it,Ht=xt[11]*it,Et=xt[8]*_t,tn=xt[9]*_t,xn=xt[10]*_t,un=xt[11]*_t;for(const Tn of yt){const bn=[],kn=[];for(const sn of Tn){const mr=sn.x+Tt.x,cr=sn.y+Tt.y,Qn=xt[0]*mr+xt[4]*cr+xt[12],Bn=xt[1]*mr+xt[5]*cr+xt[13],Jn=xt[2]*mr+xt[6]*cr+xt[14],Ar=xt[3]*mr+xt[7]*cr+xt[15],wr=Qn+Ct,Gr=Bn+Jt,$r=Jn+Kt,lo=Math.max(Ar+Ht,1e-5),Xr=Qn+Et,Lr=Bn+tn,di=Jn+xn,Ni=Math.max(Ar+un,1e-5);bn.push(new Yf(wr/lo,Gr/lo,$r/lo)),kn.push(new Yf(Xr/Ni,Lr/Ni,di/Ni))}Ft.push(bn),wt.push(kn)}return[Ft,wt]}(Ee,we,Ie,ke,$e)}(m,c,R,M,E,g,X,D,$,m.center.lat,i.tileID.canonical),he=i.queryGeometry;return function(fe,Ee,we){let Ie=1/0;HL(we,Ee)&&(Ie=nF(we,Ee[0]));for(let ke=0;ke<Ee.length;ke++){const $e=Ee[ke],nt=fe[ke];for(let He=0;He<$e.length-1;He++){const ut=$e[He],bt=[ut,$e[He+1],nt[He+1],nt[He],ut];vC(we,bt)&&(Ie=Math.min(Ie,nF(we,bt)))}}return Ie!==1/0&&Ie}(te,ce,he.isPointQuery()?he.screenBounds:he.screenGeometry)}},line:class extends gi{constructor(i,r,s,c){super(i,db,r,s,c),db.layout&&(this.layout=new ur(db.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Nf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,r){super.recalculate(i,r),this.paint._values["line-floorwidth"]=uN.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new fb(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(i,r,s){const c=hF(this);return{config:new Wf(this,{zoom:r,lut:s}),defines:c,overrideFog:!1}}queryRadius(i){const r=i,s=cN(Kp("line-width",this,r),Kp("line-gap-width",this,r)),c=Kp("line-offset",this,r);return s/2+Math.abs(c)+X1(this.paint.get("line-translate"))}queryIntersectsFeature(i,r,s,c,f,m){if(i.queryGeometry.isAboveHorizon)return!1;const g=YL(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,i.pixelToTileUnitsFactor),x=i.pixelToTileUnitsFactor/2*cN(this.paint.get("line-width").evaluate(r,s),this.paint.get("line-gap-width").evaluate(r,s)),w=this.paint.get("line-offset").evaluate(r,s);return w&&(c=function(E,M){const R=[],D=new Lt(0,0);for(let B=0;B<E.length;B++){const $=E[B],q=[];for(let X=0;X<$.length;X++){const te=$[X],ce=$[X+1],he=X===0?D:te.sub($[X-1])._unit()._perp(),fe=X===$.length-1?D:ce.sub(te)._unit()._perp(),Ee=he._add(fe)._unit();Ee._mult(1/(Ee.x*fe.x+Ee.y*fe.y)),q.push(Ee._mult(M)._add(te))}R.push(q)}return R}(c,w*i.pixelToTileUnitsFactor)),function(E,M,R){for(let D=0;D<M.length;D++){const B=M[D];if(E.length>=3){for(let $=0;$<B.length;$++)if(qc(E,B[$]))return!0}if(pK(E,B,R))return!0}return!1}(g,c,x)}isTileClipped(){return!0}isDraped(i){const r=this.layout.get("line-z-offset");return r.isConstant()&&!r.constantOr(0)}},symbol:Rb,background:class extends gi{constructor(i,r,s,c){super(i,XJ,r,s,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(i,r,s){return{overrideFog:!1}}},raster:pN,"raster-particle":mN,sky:class extends gi{constructor(i,r,s,c){super(i,r2,r,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=O_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(i,r){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,m=i.style.light,g=m.properties.get("position");return f&&m.properties.get("anchor")==="viewport"&&Qr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?uP(g.azimuthal,90-g.polar,r):uP(c[0],90-c[1],r)}const s=this.paint.get("sky-gradient-center");return uP(s[0],90-s[1],r)}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}},slot:class extends gi{constructor(i,r,s,c){super(i,i2,r,null)}},model:class extends gi{constructor(i,r,s,c){super(i,d2,r,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new hP(i)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(i){return i instanceof Vb?Mt-1:0}queryIntersectsFeature(i,r,s,c,f,m){if(!this.modelManager)return!1;const g=this.modelManager,x=i.tile.getBucket(this);if(!(x&&x instanceof hP))return!1;const w=x;for(const E in w.instancesPerModel){const M=w.instancesPerModel[E],R=r.id!==void 0?r.id:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0;if(M.idToFeaturesIndex.hasOwnProperty(R)){const D=M.features[M.idToFeaturesIndex[R]],B=g.getModel(E,this.scope);if(!B)return!1;let $=a.ad.create();const q=new qn(0,0),X=w.canonical;let te=Number.MAX_VALUE;for(let ce=0;ce<D.instancedDataCount;++ce){const he=16*(D.instancedDataOffset+ce),fe=M.instancedDataArray.float32,Ee=[fe[he+4],fe[he+5],fe[he+6]];$N(X,q,fe[he],0|fe[he+1]),EN($,B,m,q,D.rotation,D.scale,Ee,!1,!1,!1),m.projection.name==="globe"&&($=cP($,m));const we=a.ad.multiply([],m.projMatrix,$),Ie=i.queryGeometry,ke=bN(Ie.isPointQuery()?Ie.screenBounds:Ie.screenGeometry,m,we,B.aabb);ke!=null&&(te=Math.min(ke,te))}return te!==Number.MAX_VALUE&&te}}return!1}_handleOverridablePaintPropertyUpdate(i,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven()||i!=="model-color"&&i!=="model-color-mix-intensity"&&i!=="model-rotation"&&i!=="model-scale"&&i!=="model-translation"&&i!=="model-emissive-strength")}_isPropertyZoomDependent(i){const r=this._transitionablePaint._values[i];return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof ie}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(i,r,s,c){const f=i.tile,m=f.getBucket(this);let g=null,x=Number.MAX_VALUE;if(!(m&&m instanceof Vb))return{queryFeature:g,intersectionZ:x};const w=m.getNodesInfo()[r];if(w.hiddenByReplacement||!w.node.meshes||!s.filter(new pn(f.tileID.overscaledZ),w.feature,f.tileID.canonical))return{queryFeature:g,intersectionZ:x};const E=w.node,M=c.calculatePosMatrix(f.tileID.toUnwrapped(),c.worldSize),R=w.evaluatedScale;let D=0;c.elevation&&E.elevation&&(D=E.elevation*c.elevation.exaggeration()),a.ad.translate(M,M,[(E.anchor?E.anchor[0]:0)*(R[0]-1),(E.anchor?E.anchor[1]:0)*(R[1]-1),D]),a.ad.scale(M,M,R),a.ad.multiply(M,M,E.matrix);const B=i.queryGeometry,$=B.isPointQuery()?B.screenBounds:B.screenGeometry,q=function(te){const ce=a.ad.multiply([],M,te.matrix),he=a.ad.multiply(ce,c.expandedFarZProjMatrix,ce);for(let fe=0;fe<te.meshes.length;++fe){const Ee=te.meshes[fe];if(fe===te.lightMeshIndex)continue;const we=bN($,c,he,Ee.aabb);we!=null&&(x=Math.min(we,x))}if(te.children)for(const fe of te.children)q(fe)};if(q(E),x===Number.MAX_VALUE)return{queryFeature:g,intersectionZ:x};const X=new qn(0,0);return $N(f.tileID.canonical,X,w.node.anchor[0],w.node.anchor[1]),g={type:"Feature",geometry:{type:"Point",coordinates:[X.lng,X.lat]},properties:w.feature.properties,id:w.feature.id,state:{},layer:this.serialize()},{queryFeature:g,intersectionZ:x}}},clip:class extends gi{constructor(i,r,s,c){super(i,qK,r,s,c)}recalculate(i,r){super.recalculate(i,r)}createBucket(i){return new wz(i)}isTileClipped(){return!0}is3D(){return!0}}};pe(aN,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const UN=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xP{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const m=UN[15&c];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(r,2,1),[x]=new Uint32Array(r,4,1);return new xP(x,g,m,r)}constructor(r,s=64,c=Float64Array,f){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const m=UN.indexOf(this.ArrayType),g=2*r*this.ArrayType.BYTES_PER_ELEMENT,x=r*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-x%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+w,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+g+x+w),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+w,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=s,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return bP(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:x}=this,w=[0,m.length-1,0],E=[];for(;w.length;){const M=w.pop()||0,R=w.pop()||0,D=w.pop()||0;if(R-D<=x){for(let X=D;X<=R;X++){const te=g[2*X],ce=g[2*X+1];te>=r&&te<=c&&ce>=s&&ce<=f&&E.push(m[X])}continue}const B=D+R>>1,$=g[2*B],q=g[2*B+1];$>=r&&$<=c&&q>=s&&q<=f&&E.push(m[B]),(M===0?r<=$:s<=q)&&(w.push(D),w.push(B-1),w.push(1-M)),(M===0?c>=$:f>=q)&&(w.push(B+1),w.push(R),w.push(1-M))}return E}within(r,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:m,nodeSize:g}=this,x=[0,f.length-1,0],w=[],E=c*c;for(;x.length;){const M=x.pop()||0,R=x.pop()||0,D=x.pop()||0;if(R-D<=g){for(let X=D;X<=R;X++)GN(m[2*X],m[2*X+1],r,s)<=E&&w.push(f[X]);continue}const B=D+R>>1,$=m[2*B],q=m[2*B+1];GN($,q,r,s)<=E&&w.push(f[B]),(M===0?r-c<=$:s-c<=q)&&(x.push(D),x.push(B-1),x.push(1-M)),(M===0?r+c>=$:s+c>=q)&&(x.push(B+1),x.push(R),x.push(1-M))}return w}}function bP(i,r,s,c,f,m){if(f-c<=s)return;const g=c+f>>1;VN(i,r,g,c,f,m),bP(i,r,s,c,g-1,1-m),bP(i,r,s,g+1,f,1-m)}function VN(i,r,s,c,f,m){for(;f>c;){if(f-c>600){const E=f-c+1,M=s-c+1,R=Math.log(E),D=.5*Math.exp(2*R/3),B=.5*Math.sqrt(R*D*(E-D)/E)*(M-E/2<0?-1:1);VN(i,r,s,Math.max(c,Math.floor(s-M*D/E+B)),Math.min(f,Math.floor(s+(E-M)*D/E+B)),m)}const g=r[2*s+m];let x=c,w=f;for(iv(i,r,c,s),r[2*f+m]>g&&iv(i,r,c,f);x<w;){for(iv(i,r,x,w),x++,w--;r[2*x+m]<g;)x++;for(;r[2*w+m]>g;)w--}r[2*c+m]===g?iv(i,r,c,w):(w++,iv(i,r,w,f)),w<=s&&(c=w+1),s<=w&&(f=w-1)}}function iv(i,r,s,c){wP(i,s,c),wP(r,2*s,2*c),wP(r,2*s+1,2*c+1)}function wP(i,r,s){const c=i[r];i[r]=i[s],i[s]=c}function GN(i,r,s,c){const f=i-s,m=r-c;return f*f+m*m}a.$=Ql,a.A=Lf,a.B=bl,a.C=Xn,a.D=oo,a.E=iu,a.G=ao,a.H=d,a.I=Qf,a.J=VA,a.K=function(i){const r=i.value;let s=[];if(!r)return s;const c=au(r);return c!=="string"?(s=s.concat([new Fb(i.key,r,`string expected, "${c}" found`)]),s):(wN(r,!0)||(s=s.concat([new Fb(i.key,r,`invalid url "${r}"`)])),s)},a.L=Ve,a.M=class{constructor(i,r,s,c){this.id=i,this.position=r!=null?new qn(r[0],r[1]):new qn(0,0),this.orientation=s??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(i,r){if(a.ad.multiply(i.matrix,r,i.matrix),i.meshes)for(const s of i.meshes){const c=jr.applyTransform(s.aabb,i.matrix);this.aabb.encapsulate(c)}if(i.children)for(const s of i.children)this._applyTransformations(s,i.matrix)}computeBoundsAndApplyParent(){const i=a.ad.identity([]);for(const r of this.nodes)this._applyTransformations(r,i)}computeModelMatrix(i,r,s,c,f,m,g=!1){EN(this.matrix,this,i.transform,this.position,r,s,c,f,m,g)}upload(i){if(!this.uploaded){for(const r of this.nodes)fP(r,i);for(const r of this.nodes)Nb(r);this.uploaded=!0}}destroy(){for(const i of this.nodes)dP(i)}},a.N=nr,a.O=pt,a.P=Lt,a.Q=class{constructor(i){this.specification=i}possiblyEvaluate(i,r){return Ps(i.expression.evaluate(r))}interpolate(i,r,s){return{x:on(i.x,r.x,s),y:on(i.y,r.y,s),z:on(i.z,r.z,s),azimuthal:on(i.azimuthal,r.azimuthal,s),polar:on(i.polar,r.polar,s)}}},a.R=_p,a.S=rC,a.T=as,a.U=or,a.V=Fb,a.W=Xi,a.X=pn,a.Y=so,a.Z=ie,a.a=ua,a.a$=function(i){const{x:r,y:s}=i.point,{lng:c,lat:f}=i._center;return lz(r,s,i.worldSize,c,f)},a.a0=ur,a.a1=xu,a.a2=on,a.a3=Mt,a.a4=s1,a.a5=class{constructor(i){this.specification=i}possiblyEvaluate(i,r){return function([s,c]){const f=Ps([1,s,c]);return{x:f.x,y:f.y,z:f.z}}(i.expression.evaluate(r))}interpolate(i,r,s){return{x:on(i.x,r.x,s),y:on(i.y,r.y,s),z:on(i.z,r.z,s)}}},a.a6=T_,a.a7=W1,a.a8=gu,a.a9=zL,a.aB=function(i,r){const{x:s,y:c}=i.point,f=lz(s,c,i.worldSize/i._pixelsPerMercatorPixel,0,0);return a.ad.multiply(f,f,PC(Al(r)))},a.aD=im,a.aE=Ia,a.aF=gb,a.aG=function(i,r,s,c,f){const m=5*r+2;i.float32[m+0]=s,i.float32[m+1]=c,i.float32[m+2]=f},a.aH=Cb,a.aI=qn,a.aJ=YF,a.aK=jL,a.aL=yi,a.aM=EC,a.aN=yN,a.aO=qf,a.aP=oz,a.aQ=function(i,r,s,c,f,m,g,x,w){if(w.name==="globe")return oz(i,r,new qf(s,c,f),!1);const E=Kf({z:s,x:c,y:f},w);return new jr([(m+E.x/E.scale)*r,r*(E.y/E.scale),g],[(m+E.x2/E.scale)*r,r*(E.y2/E.scale),x])},a.aR=function(i,r,s){let c=0;for(let f=0;f<2;++f)i[f]>0&&(c+=(i[f]-0)*(i[f]-0)),r[f]<0&&(c+=(0-r[f])*(0-r[f]));return c},a.aS=ei,a.aT=SC,a.aU=NL,a.aV=function(i){const r=a.ad.identity(new Float64Array(16));a.ad.multiply(r,i.pixelMatrix,i.globeMatrix);const s=[0,is,0],c=[0,os,0];return a._.transformMat4(s,s,r),a._.transformMat4(c,c,r),[s[0]>0&&s[0]<=i.width&&s[1]>0&&s[1]<=i.height&&!IC(i,new qn(i.center.lat,90)),c[0]>0&&c[0]<=i.width&&c[1]>0&&c[1]<=i.height&&!IC(i,new qn(i.center.lat,-90))]},a.aW=function(i,r){const{scale:s}=i.tileTransform,c=s*Mt/(i.tileSize*Math.pow(2,r.zoom-i.tileID.overscaledZ+i.tileID.canonical.z));return a.aC.scale(new Float32Array(4),r.inverseAdjustmentMatrix,[c,c])},a.aX=Lb,a.aY=gN,a.aZ=function(i){const r=gN(i,!0);return a.aC.invert([],[r[0],r[1],r[4],r[5]])},a.a_=TC,a.aa=Co,a.ab=Fn,a.ac=function(i,r,s){const c=Math.sqrt(i*i+r*r+s*s),f=c>0?Math.acos(s/c)*lf:0;let m=i!==0||r!==0?Math.atan2(-r,-i)*lf+90:0;return m<0&&(m+=360),[c,m,f]},a.ae=um,a.af=js,a.ag=JC,a.ah=function(i,r){const s={};for(let c=0;c<r.length;c++){const f=r[c];f in i&&(s[f]=i[f])}return s},a.ai=Hc,a.aj=Tl,a.ak=El,a.al=Vp,a.am=function(i){gp++,gp>ky&&(i.getActor().send("enforceCacheSizeLimit",Ry),gp=0)},a.an=$y,a.ao=class{constructor(i){this.entries={},this.scheduler=i}request(i,r,s,c){const f=this.entries[i]=this.entries[i]||{callbacks:[]};if(f.result){const[m,g]=f.result;return this.scheduler?this.scheduler.add(()=>{c(m,g)},r):c(m,g),()=>{}}return f.callbacks.push(c),f.cancel||(f.cancel=s((m,g)=>{f.result=[m,g];for(const x of f.callbacks)this.scheduler?this.scheduler.add(()=>{x(m,g)},r):x(m,g);setTimeout(()=>delete this.entries[i],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(m=>m!==c),f.callbacks.length||(f.cancel(),delete this.entries[i]))}}},a.ap=function(i,r,s){const c=JSON.stringify(i.request);return i.data&&(this.deduped.entries[c]={result:[null,i.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},f=>{const m=nu(i.request,(g,x,w,E)=>{g?f(g):x&&f(null,{vectorTile:s?void 0:new FC(new rm(x)),rawData:x,cacheControl:w,expires:E})});return()=>{m.cancel(),f()}},r)},a.aq=sC,a.ar=class extends mu{constructor(i){super(i),this.current=eK}set(i,r,s){if(this.fetchUniformLocation(i,r)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},a.as=lC,a.at=Pn,a.au=Jl,a.aw=df,a.ax=Mo,a.ay=Fi,a.az=function(i,r,s){i[4*r+0]=s[0],i[4*r+1]=s[1],i[4*r+2]=s[2],i[4*r+3]=s[3]},a.b=Br,a.b$=Yc,a.b0=Zi,a.b1=hC,a.b2=function(i){const r=Math.round((i+45+360)%360/90)%4;return Zx[r]},a.b3=45,a.b4=pC,a.b5=H1,a.b6=jr,a.b7=Ps,a.b8=function(i){return[Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)]},a.b9=Ty,a.bA=function(i,r){return[Math.pow(i[0],2.2)*r,Math.pow(i[1],2.2)*r,Math.pow(i[2],2.2)*r]},a.bB=lF,a.bD=sz,a.bE=dp,a.bF=fp,a.bG=256,a.bH=function(i,r){const s=[0,0,0],c=I_(Al(r.canonical));return a._.transformMat4(s,s,c),a._.transformMat4(s,s,i),s},a.bI=i=>({u_camera_to_center_distance:new Co(i),u_extrude_scale:new uC(i),u_device_pixel_ratio:new Co(i),u_matrix:new T_(i),u_inv_rot_matrix:new T_(i),u_merc_center:new gu(i),u_tile_id:new sC(i),u_zoom_transition:new Co(i),u_up_dir:new sC(i),u_emissive_strength:new Co(i)}),a.bJ=i=>({u_matrix:new T_(i),u_pixels_to_tile_units:new uC(i),u_device_pixel_ratio:new Co(i),u_units_to_pixels:new gu(i),u_dash_image:new W1(i),u_gradient_image:new W1(i),u_image_height:new Co(i),u_texsize:new gu(i),u_tile_units_to_pixels:new Co(i),u_alpha_discard_threshold:new Co(i),u_trim_offset:new gu(i),u_trim_fade_range:new gu(i),u_trim_color:new lC(i),u_emissive_strength:new Co(i)}),a.bK=i=>({u_matrix:new T_(i),u_texsize:new gu(i),u_pixels_to_tile_units:new uC(i),u_device_pixel_ratio:new Co(i),u_image:new W1(i),u_units_to_pixels:new gu(i),u_tile_units_to_pixels:new Co(i),u_alpha_discard_threshold:new Co(i),u_trim_offset:new gu(i)}),a.bL=YA,a.bM=DQ,a.bN=Ki,a.bO=QQ,a.bP=$F,a.bQ=HC,a.bR=hz,a.bS=(i,r,s,c,f,m)=>{const g=i.transform,x=g.projection.name==="globe";let w;if(m.paint.get("circle-pitch-alignment")==="map")if(x){const M=sz(g.zoom,r.canonical)*g._pixelsPerMercatorPixel;w=Float32Array.from([M,0,0,M])}else w=g.calculatePixelsToTileUnitsMatrix(s);else w=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const E={u_camera_to_center_distance:i.transform.getCameraToCenterDistance(g.projection),u_matrix:i.translatePosMatrix(r.projMatrix,s,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Di.devicePixelRatio,u_extrude_scale:w,u_inv_rot_matrix:TK,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(x){E.u_inv_rot_matrix=c,E.u_merc_center=f,E.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],E.u_zoom_transition=xu(g.zoom);const M=f[0]*Mt,R=f[1]*Mt;E.u_up_dir=g.projection.upVector(new qf(0,0,0),M,R)}return E},a.bT=hF,a.bU=(i,r,s,c,f,m)=>{const g=i.transform;return{u_matrix:cF(i,r,s,c),u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:g.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:f,u_image:0,u_tile_units_to_pixels:uF(r,g),u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:m}},a.bV=(i,r,s,c,f,m,g)=>{const x=i.transform,w=x.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:cF(i,r,s,c),u_pixels_to_tile_units:w,u_device_pixel_ratio:m,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:fF(s)&&r.lineAtlasTexture?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:uF(r,i.transform),u_alpha_discard_threshold:0,u_trim_offset:g,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength")}},a.bW=Ey,a.bX=O_,a.bY=eF,a.bZ=lK,a.b_=hb,a.ba=function(i,r,s){const c=xu(s.zoom),f=i.style.map._antialias,m=r.options.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return c===0&&!f&&!m},a.bb=function(i){const r=i.pixelsPerMeter,s=r/Mo(1,i.center.lat),c=a.ad.identity(new Float64Array(16));return a.ad.translate(c,c,[i.point.x,i.point.y,0]),a.ad.scale(c,c,[s,s,r]),Float32Array.from(c)},a.bc=Q1,a.bd=function(i){const r=ei-5;i=Pn(i,-r,r)/r*90;const s=Math.pow(Math.abs(Math.sin(Fn(i))),3);return Math.round(s*(fC.length-1))},a.be=function(i,r,s,c){const f=r.getNorth(),m=r.getSouth(),g=r.getWest(),x=r.getEast(),w=1<<i.z,E=x-g,M=f-m,R=E/qp,D=-M/fC[s],B=[0,R,0,D,0,0,f,g,0];if(i.z>0){const $=180/c;a.bC.multiply(B,B,[$/E+1,0,0,0,$/M+1,0,-.5*$/R,.5*$/D,1])}return B[2]=w,B[5]=i.x,B[8]=i.y,B},a.bf=I_,a.bg=Al,a.bh=function(i,r,s){const c=a.ad.identity(new Float64Array(16)),f=(r/(1<<i)-.5)*Math.PI*2;return a.ad.rotateY(c,s.globeMatrix,f),Float32Array.from(c)},a.bi=_c,a.bj=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.bk=pN,a.bl=mN,a.bm=dN,a.bn=function(i,r){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){r(null,s)};for(let c=0;c<i.length;c++){const f=document.createElement("source");Jx(i[c])||(s.crossOrigin="Anonymous"),f.src=i[c],s.appendChild(f)}return{cancel:()=>{}}},a.bo=Pb,a.bp=up,a.bq=class{isDataAvailableAtPoint(i){const r=this._source();if(this.isUsingMockSource()||!r||i.y<0||i.y>1)return!1;const s=r.getSource().maxzoom,c=1<<s,f=Math.floor(i.x),m=Math.floor((i.x-f)*c),g=Math.floor(i.y*c),x=this.findDEMTileFor(new yi(s,f,s,m,g));return!(!x||!x.dem)}getAtPointOrZero(i,r=0){return this.getAtPoint(i,r)||0}getAtPoint(i,r,s=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const c=this._source();if(!c||i.y<0||i.y>1)return r;const f=c.getSource().maxzoom,m=1<<f,g=Math.floor(i.x),x=i.x-g,w=new yi(f,g,f,Math.floor(x*m),Math.floor(i.y*m)),E=this.findDEMTileFor(w);if(!E||!E.dem)return r;const M=E.dem,R=1<<E.tileID.canonical.z,D=(x*R-E.tileID.canonical.x)*M.dim,B=(i.y*R-E.tileID.canonical.y)*M.dim,$=Math.floor(D),q=Math.floor(B);return(s?this.exaggeration():1)*on(on(M.get($,q),M.get($,q+1),B-q),on(M.get($+1,q),M.get($+1,q+1),B-q),D-$)}getAtTileOffset(i,r,s){const c=1<<i.canonical.z;return this.getAtPointOrZero(new so(i.wrap+(i.canonical.x+r/Mt)/c,(i.canonical.y+s/Mt)/c))}getAtTileOffsetFunc(i,r,s,c){return f=>{const m=this.getAtTileOffset(i,f.x,f.y),g=c.upVector(i.canonical,f.x,f.y),x=c.upVectorScale(i.canonical,r,s).metersToTile;return a._.scale(g,g,m*x),g}}getForTilePoints(i,r,s,c){if(this.isUsingMockSource())return!1;const f=em.create(this,i,c);return!!f&&(r.forEach(m=>{m[2]=this.exaggeration()*f.getElevationAt(m[0],m[1],s)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(i);if(!r||!r.dem)return null;const s=r.dem.tree,c=r.tileID,f=1<<i.canonical.z-c.canonical.z;let m=i.canonical.x/f-c.canonical.x,g=i.canonical.y/f-c.canonical.y,x=0;for(let w=0;w<i.canonical.z-c.canonical.z&&!s.leaves[x];w++){m*=2,g*=2;const E=2*Math.floor(g)+Math.floor(m);x=s.childOffsets[x]+E,m%=1,g%=1}return{min:this.exaggeration()*s.minimums[x],max:this.exaggeration()*s.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,r,s){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const i=this.visibleDemTiles;if(i.length===0)return null;let r=!1,s=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const f of i){const m=this.getMinMaxForTile(f.tileID);m&&(s=Math.min(s,m.min),c=Math.max(c,m.max),r=!0)}return r?{min:s,max:c}:null}},a.br=P_,a.bs=K1,a.bt=Ls,a.bu=Pi,a.bv=Jf,a.bw=dm,a.bx=Bb,a.by=Ob,a.bz=yz,a.c=zN,a.c$=mf,a.c0=450,a.c1=7,a.c2=QJ,a.c3=sN,a.c4=256,a.c5=rz,a.c6=PC,a.c7=rr,a.c8=$c,a.c9=Gf,a.cA=function(i){let r=1/0,s=1/0,c=-1/0,f=-1/0;for(const m of i)r=Math.min(r,m.x),s=Math.min(s,m.y),c=Math.max(c,m.x),f=Math.max(f,m.y);return{min:new Lt(r,s),max:new Lt(c,f)}},a.cB=qc,a.cC=GL,a.cD=Po,a.cE=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.cF=DF,a.cG=vC,a.cH=kz,a.cI=Dz,a.cJ=YC,a.cK=xP,a.cL=function(i){return i({pluginStatus:vt,pluginURL:at}),mn.on("pluginStateChange",i),i},a.cM=am,a.cN=ZC,a.cO=vp,a.cP=$t,a.cQ=k,a.cR=Oy,a.cS=Sc,a.cT=Qa,a.cU=function(i){const r=i.indexOf(Fc);return r>=0?i.slice(0,r):i},a.cV=function(i){return i.indexOf(Fc)>=0},a.cW=function(i){const r=i.indexOf(Fc);return r>=0?i.slice(r+1):""},a.cX=function(i){const r=[],s=i.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},a.cY=function(i,r,s,c){return i.type==="custom"?new t2(i,r):new O2[i.type](i,r,s,c)},a.cZ=eu,a.c_=mn,a.ca=1,a.cb=q_,a.cc=0,a.cd=eC,a.ce=function(i,r,s,c,f){return Pn((i-r)/(s-r)*(f-c)+c,c,f)},a.cf=k1,a.cg=Zf,a.ch=class{constructor(i,r,s,c){this.context=i,this.format=c,this.size=s,this.texture=i.gl.createTexture();const[f,m,g]=this.size,{gl:x}=i;x.bindTexture(x.TEXTURE_3D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(!1);let w=this.format,E=x.UNSIGNED_BYTE;this.format===x.DEPTH_COMPONENT&&(w=x.DEPTH_COMPONENT16,E=x.UNSIGNED_SHORT),this.format===x.R8&&(c=x.RED),this.format===x.R32F&&(E=x.FLOAT,c=x.RED),x.texImage3D(x.TEXTURE_3D,0,w,f,m,g,0,c,E,r.data)}bind(i,r){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_3D,this.texture),i!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,i),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,i),this.minFilter=i),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,r),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,r),this.wrapS=r)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}},a.ci=cP,a.cj=[1,1,1],a.ck=em,a.cl=fm,a.cm=Vc,a.cn=Wp,a.co=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Lt(1/0,1/0),max:new Lt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(i,r=!1){const s=Iz(new Lt(0,0),new Lt(Mt,Mt),i),c=[];if(r&&!NC(s,this._globalClipBounds))return c;for(const f of this._activeRegions){if(f.hiddenByOverlap||!NC(s,f))continue;const m=sQ(f.min,f.max,i);c.push({min:m.min,max:m.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask})}return c}setSources(i){this._setSources(i.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const s=[];for(const c of r.cache.getVisibleCoordinates()){const f=r.cache.getTile(c).buckets[r.layer];f&&f.updateFootprints(c.toUnwrapped(),s)}return s},getOrder:()=>r.order,getClipMask:()=>r.clipMask})))}_addSource(i){const r=i.getFootprints();if(r.length===0)return;const s=i.getOrder(),c=i.getClipMask();for(const f of r){if(!f.footprint)continue;const m=Iz(f.footprint.min,f.footprint.max,f.id);this._activeRegions.push({min:m.min,max:m.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:f.id,footprint:f.footprint,order:s,clipMask:c})}this._sourceIds.push(i.getSourceId())}_computeReplacement(){this._activeRegions.sort((r,s)=>r.priority-s.priority||lb(r.min,s.min)||lb(r.max,s.max));let i=this._activeRegions.length!==this._prevRegions.length;if(!i){let r=0;for(;!i&&r!==this._activeRegions.length;){const s=this._activeRegions[r],c=this._prevRegions[r];i=s.priority!==c.priority||!Mz(s,c)||s.order!==c.order||s.clipMask!==c.clipMask,++r}}if(i){++this._updateTime;for(const s of this._activeRegions)s.order!==1/0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const r=s=>{const c=this._activeRegions;if(s>=c.length)return s;const f=c[s].priority;for(;s<c.length&&c[s].priority===f;)++s;return s};if(this._sourceIds.length>1){let s=0,c=r(s);for(;s!==c;){let f=s;const m=s;for(;f!==c;){const g=this._activeRegions[f];g.hiddenByOverlap=!1;for(let x=0;x<m;x++){const w=this._activeRegions[x];if(!w.hiddenByOverlap&&g.order===1/0&&NC(g,w)&&(g.hiddenByOverlap=Rz(g.footprint,g.tileId,w.footprint,w.tileId),g.hiddenByOverlap))break}++f}s=c,c=r(s)}}}}_setSources(i){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=i.length-1;r>=0;r--)this._addSource(i[r]);this._computeReplacement()}},a.cp=Bc,a.cq=Ib,a.cr=w_,a.cs=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy()}_fillGridMeshWithLods(i,r){const s=new Ls,c=new Pi,f=[],m=i+1+2,g=r[0]+1,x=r[0]+1+(1+r.length),w=(E,M,R)=>{let D=E===m-1?E-2:E===0?E:E-1;return D+=R?24575:0,[D,M]};for(let E=0;E<m;++E)s.emplaceBack(...w(E,0,!0));for(let E=0;E<g;++E)for(let M=0;M<m;++M)s.emplaceBack(...w(M,E,(M===0||M===m-1)&&!0));for(let E=0;E<r.length;++E){const M=r[E];for(let R=0;R<m;++R)s.emplaceBack(...w(R,M,!0))}for(let E=0;E<r.length;++E){const M=c.length,R=r[E]+1+2,D=new Pi;for(let q=0;q<R-1;q++){const X=q===R-2,te=X?m*(x-r.length+E-q):m;for(let ce=0;ce<m-1;ce++){const he=q*m+ce;q===0||X||ce===0||ce===m-2?(D.emplaceBack(he+1,he,he+te),D.emplaceBack(he+te,he+te+1,he+1)):(c.emplaceBack(he+1,he,he+te),c.emplaceBack(he+te,he+te+1,he+1))}}const B=Br.simpleSegment(0,M,s.length,c.length-M);for(let q=0;q<D.uint16.length;q+=3)c.emplaceBack(D.uint16[q],D.uint16[q+1],D.uint16[q+2]);const $=Br.simpleSegment(0,M,s.length,c.length-M);f.push({withoutSkirts:B,withSkirts:$})}return{vertices:s,indices:c,segments:f}}_createGrid(i){const r=this._fillGridMeshWithLods(qp,fC);this._gridSegments=r.segments,this._gridBuffer=i.createVertexBuffer(r.vertices,P_.members),this._gridIndexBuffer=i.createIndexBuffer(r.indices,!0)}_createPoles(i){const r=new Pi;for(let g=0;g<=qp;g++)r.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=i.createIndexBuffer(r,!0);const s=new Gf,c=new Gf,f=new Gf,m=new Gf;this._poleSegments=[];for(let g=0,x=0;g<hC;g++){const w=360/(1<<g);s.emplaceBack(0,-Po,0,.5,0),c.emplaceBack(0,-Po,0,.5,1),f.emplaceBack(0,-Po,0,.5,.5),m.emplaceBack(0,-Po,0,.5,.5);for(let E=0;E<=qp;E++){let M=E/qp,R=0;const D=on(0,w,M),[B,$,q]=Zp(wK,SK,D,Po);s.emplaceBack(B,$,q,M,R),c.emplaceBack(B,$,q,M,1-R);const X=Fn(D);M=.5+.5*Math.sin(X),R=.5+.5*Math.cos(X),f.emplaceBack(B,$,q,M,R),m.emplaceBack(B,$,q,M,1-R)}this._poleSegments.push(Br.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(s,Y1,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(c,Y1,!1),this._texturedPoleNorthVertexBuffer=i.createVertexBuffer(f,Y1,!1),this._texturedPoleSouthVertexBuffer=i.createVertexBuffer(m,Y1,!1)}getGridBuffers(i,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}},a.ct=function(i){return xf.has(i)},a.cu=Uz,a.cv=function(i,r,s=0,c=!0){const f=new Lt(s,s),m=i.sub(f),g=r.add(f),x=[m,new Lt(g.x,m.y),g,new Lt(m.x,g.y)];return c&&x.push(m.clone()),x},a.cw=function(i,r){const s=[];for(let c=0;c<i.length;c++){const f=Jl(c-1,-1,i.length-1),m=Jl(c+1,-1,i.length-1),g=i[c],x=i[m],w=i[f].sub(g).unit(),E=x.sub(g).unit(),M=E.angleWithSep(w.x,w.y),R=w.add(E).unit().mult(-1*r/Math.sin(M/2));s.push(g.add(R))}return s},a.cx=WF,a.cy=XL,a.cz=function(i,r,s=0){return a._.fromValues(((r.x-s)*i.scale-i.x)*Mt,(r.y*i.scale-i.y)*Mt,$L(r.z,r.y))},a.d=Sp,a.d$=ap,a.d0=uf,a.d1=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.d2=pc,a.d3=VL,a.d4=Hf,a.d5=function([i,r,s]){const c=Math.hypot(i,r,s),f=Math.atan2(i,s),m=.5*Math.PI-Math.acos(-r/c);return new qn(Zi(f),Zi(m))},a.d6=Go,a.d7=Xp,a.d8=A,a.d9=IC,a.dA=function(i){const r=Kx();if(!r)return;const s=r.delete(Yx);i&&s.catch(i).then(()=>i())},a.dB=J_,a.dC=CN,a.dD=function(i){mP=Di.resolveURL(i),mm||(mm=new dm(Bb(),new iu)),mm.broadcast("setDracoUrl",mP)},a.dE=PN,a.dF=function(i){pm=Di.resolveURL(i),mm||(mm=new dm(Bb(),new iu)),mm.broadcast("setMeshoptUrl",pm)},a.dG=oa,a.dH=pe,a.dI=Zc,a.dJ=Bs,a.dK=Kf,a.dL=oC,a.dM=dF,a.dN=xF,a.dO=aF,a.dP=gc,a.dQ=zF,a.dR=cm,a.dS=function(i,r,s,c,f,m,g,x,w,E,M){i.createArrays(),i.tilePixelRatio=Mt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const R=i.layers[0].layout,D=i.layers[0]._unevaluatedLayout._values,B={};if(i.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ce}=i.textSizeData;B.compositeTextSizes=[D["text-size"].possiblyEvaluate(new pn(te),x),D["text-size"].possiblyEvaluate(new pn(ce),x)]}if(i.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ce}=i.iconSizeData;B.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new pn(te),x),D["icon-size"].possiblyEvaluate(new pn(ce),x)]}B.layoutTextSize=D["text-size"].possiblyEvaluate(new pn(w+1),x),B.layoutIconSize=D["icon-size"].possiblyEvaluate(new pn(w+1),x),B.textMaxSize=D["text-size"].possiblyEvaluate(new pn(18),x);const $=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",q=R.get("text-size");let X=!1;for(const te of i.features)if(te.icon&&te.icon.nameSecondary){X=!0;break}for(const te of i.features){const ce=R.get("text-font").evaluate(te,{},x).join(","),he=q.evaluate(te,{},x),fe=B.layoutTextSize.evaluate(te,{},x),Ee=(B.layoutIconSize.evaluate(te,{},x),{horizontal:{},vertical:void 0}),we=te.text;let Ie,ke=[0,0];if(we){const He=we.toString(),ut=R.get("text-letter-spacing").evaluate(te,{},x)*Ki,bt=R.get("text-line-height").evaluate(te,{},x)*Ki,ot=qe(He)?ut:0,yt=R.get("text-anchor").evaluate(te,{},x),it=R.get("text-variable-anchor");if(!it){const wt=R.get("text-radial-offset").evaluate(te,{},x);ke=wt?$F(yt,[wt*Ki,XC]):R.get("text-offset").evaluate(te,{},x).map(Ct=>Ct*Ki)}let _t=$?"center":R.get("text-justify").evaluate(te,{},x);const Tt=R.get("symbol-placement")==="point",xt=Tt?R.get("text-max-width").evaluate(te,{},x)*Ki:1/0,Ft=wt=>{i.allowVerticalPlacement&&We(He)&&(Ee.vertical=WC(we,r,s,f,ce,xt,bt,yt,wt,ot,ke,Ia.vertical,!0,fe,he))};if(!$&&it){const wt=_t==="auto"?it.map(Jt=>YC(Jt)):[_t];let Ct=!1;for(let Jt=0;Jt<wt.length;Jt++){const Kt=wt[Jt];if(!Ee.horizontal[Kt])if(Ct)Ee.horizontal[Kt]=Ee.horizontal[0];else{const Ht=WC(we,r,s,f,ce,xt,bt,"center",Kt,ot,ke,Ia.horizontal,!1,fe,he);Ht&&(Ee.horizontal[Kt]=Ht,Ct=Ht.positionedLines.length===1)}}Ft("left")}else{if(_t==="auto"&&(_t=YC(yt)),Tt||R.get("text-writing-mode").indexOf("horizontal")>=0||!We(He)){const wt=WC(we,r,s,f,ce,xt,bt,yt,_t,ot,ke,Ia.horizontal,!1,fe,he);wt&&(Ee.horizontal[_t]=wt)}Ft(Tt?"left":_t)}}let $e=!1;if(te.icon&&te.icon.namePrimary){const He=c[te.icon.namePrimary];He&&(Ie=sJ(f[te.icon.namePrimary],te.icon.nameSecondary?f[te.icon.nameSecondary]:void 0,R.get("icon-offset").evaluate(te,{},x),R.get("icon-anchor").evaluate(te,{},x)),$e=He.sdf,i.sdfIcons===void 0?i.sdfIcons=He.sdf:i.sdfIcons!==He.sdf&&Qr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(He.pixelRatio!==i.pixelRatio||R.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const nt=VF(Ee.horizontal)||Ee.vertical;i.iconsInText||(i.iconsInText=!!nt&&nt.iconsInText),(nt||Ie)&&pJ(i,te,Ee,Ie,c,B,fe,0,ke,$e,g,x,E,M,X)}m&&i.generateCollisionDebugBuffers(w,i.collisionBoxArray)},a.dT=fb,a.dU=ib,a.dV=FC,a.dW=rm,a.dX=ub,a.dY=aP,a.dZ=ab,a.d_=ob,a.da=uz,a.db=function(i){const r=[0,0,0],s=a.ad.identity(new Float64Array(16));return a.ad.multiply(s,i.pixelMatrix,i.globeMatrix),a._.transformMat4(r,r,s),new Lt(r[0],r[1])},a.dc=G,a.dd=j,a.de=function(i){const r=i.navigator?i.navigator.userAgent:null;return!!function(s){if(hp==null){const c=s.navigator?s.navigator.userAgent:null;hp=!!s.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return hp}(i)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.df=sp,a.dg=class{constructor(i,r,s){this._transformRequestFn=i,this._customAccessToken=r,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const i=function(){let r="";for(let s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",By,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,r){return this._transformRequestFn&&this._transformRequestFn(i,r)||{url:i}}normalizeStyleURL(i,r){if(!k(i))return i;const s=wa(i);return s.params.push(`sdk=js-${b}`),s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeGlyphsURL(i,r){if(!k(i))return i;const s=wa(i);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeModelURL(i,r){if(!k(i))return i;const s=wa(i);return s.path=`/models/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeSourceURL(i,r,s,c){if(!k(i))return i;const f=wa(i);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),s&&f.params.push(`language=${s}`),c&&f.params.push(`worldview=${c}`),this._makeAPIURL(f,this._customAccessToken||r)}normalizeSpriteURL(i,r,s,c){const f=wa(i);return k(i)?(f.path=`/styles/v1${f.path}/sprite${r}${s}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${r}${s}`,bc(f))}normalizeTileURL(i,r,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!k(i))return i;const c=wa(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||s&&c.authority!=="raster"&&s===512?"@2x":""}${yp.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${A.RASTER_URL_PREFIX}${c.path}`:c.authority==="rasterarrays"?c.path=`/${A.RASTERARRAYS_URL_PREFIX}${c.path}`:c.authority==="3dtiles"?c.path=`/${A.TILES3D_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${A.TILE_URL_VERSION}${c.path}`);const f=this._customAccessToken||function(m){for(const g of m){const x=g.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(c.params)||A.ACCESS_TOKEN;return A.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(i,r){const s=wa(i);if(!s.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!s.path.match(/\.[\w]+$/))return i;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${A.RASTER_URL_PREFIX}/`,"")}`:s.path.match(/^\/rasterarrays\/v1\//)?c+=`rasterarrays/${s.path.replace(`/${A.RASTERARRAYS_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${A.TILE_URL_VERSION}/`,"")}`;let f=s.params;return r&&(f=f.filter(m=>!m.match(/^access_token=/))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(i,r){const s=!!r&&k(r),c=[];for(const f of i.tiles||[])O(f)?c.push(this.canonicalizeTileURL(f,s)):c.push(f);return c}_makeAPIURL(i,r){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=wa(A.API_URL);if(i.protocol=c.protocol,i.authority=c.authority,i.protocol==="http"){const f=i.params.indexOf("secure");f>=0&&i.params.splice(f,1)}if(c.path!=="/"&&(i.path=`${c.path}${i.path}`),!A.REQUIRE_ACCESS_TOKEN)return bc(i);if(r=r||A.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return i.params=i.params.filter(f=>f.indexOf("access_token")===-1),i.params.push(`access_token=${r||""}`),bc(i)}},a.dh=function(i,r){r?xf.add(i):xf.delete(i)},a.di=yp,a.dj=AA,a.dk=wp,a.dl=jy,a.dm=n1,a.dn=EA,a.dp=function(i){xf.delete(i)},a.dq=wc,a.dr=vf,a.ds=mc,a.dt=b,a.du=function(i,r){Ry=i,ky=r},a.dv=function(i,r,s=!1){if(vt===Ot||vt===kt||vt===Nt)throw new Error("setRTLTextPlugin cannot be called multiple times.");at=Di.resolveURL(i),vt=Ot,Dt=r,vn(),s||Nn()},a.dw=On,a.dx=function(){Bb().acquire(pP)},a.dy=function(){const i=tv;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(pP),tv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.dz=ev,a.e=Di,a.e0=pF,a.e1=Y,a.e2=nu,a.e3=function(i){let r=0;if(new Uint32Array(i,0,1)[0]!==IN){const s=new Uint32Array(i,0,7),[,,c,f,m,g]=s;r=s.byteLength+f+m+g+m,(c!==i.byteLength||r>=i.byteLength)&&Qr("Invalid b3dm header information.")}return DN(i,r)},a.e4=function(i,r){const s=zN(i);for(const c of s){for(const f of c.meshes)C2(f);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(P2(c.lights,r)))}return s},a.e5=Vb,a.e6=AN,a.e7=lr,a.e8=function(i){pf(),Is&&Is.then(r=>{r.keys().then(s=>{for(let c=0;c<s.length-i;c++)r.delete(s[c])})})},a.f=po,a.g=function(i,r){return mf(Xi(i,{type:"json"}),r)},a.h=pl,a.i=Ma,a.j=LF,a.k=qC,a.l=function(i){return fetch(i).then(r=>r.arrayBuffer()).then(r=>DN(r,0,i))},a.m=class extends Fb{},a.n=au,a.o=Wy,a.p=CJ,a.q=Up,a.r=y,a.s=l,a.t=Z,a.u=Uo,a.v=zi,a.w=Qr,a.x=oe,a.y=Q,a.z=Rp}),p(["./shared"],function(a){function b(De){const ne=De?De.url.toString():void 0;return ne?performance.getEntriesByName(ne):[]}function C(De){if(typeof De=="number"||typeof De=="boolean"||typeof De=="string"||De==null)return JSON.stringify(De);if(Array.isArray(De)){let le="[";for(const be of De)le+=`${C(be)},`;return`${le}]`}let ne="{";for(const le of Object.keys(De).sort())ne+=`${le}:${C(De[le])},`;return`${ne}}`}function A(De){let ne="";for(const le of a.cE)ne+=`/${C(De[le])}`;return ne}class O{constructor(ne){this.keyCache={},this._layers={},this._layerConfigs={},ne&&this.replace(ne)}replace(ne,le){this._layerConfigs={},this._layers={},this.update(ne,[],le)}update(ne,le,be){this._options=be;for(const Me of ne)this._layerConfigs[Me.id]=Me,(this._layers[Me.id]=a.cY(Me,this.scope,null,this._options)).compileFilter(),this.keyCache[Me.id]&&delete this.keyCache[Me.id];for(const Me of le)delete this.keyCache[Me],delete this._layerConfigs[Me],delete this._layers[Me];this.familiesBySource={};const Pe=function(Me,je){const Qe={};for(let tt=0;tt<Me.length;tt++){const Pt=je&&je[Me[tt].id]||A(Me[tt]);je&&(je[Me[tt].id]=Pt);let St=Qe[Pt];St||(St=Qe[Pt]=[]),St.push(Me[tt])}const ze=[];for(const tt in Qe)ze.push(Qe[tt]);return ze}(a.dG(this._layerConfigs),this.keyCache);for(const Me of Pe){const je=Me.map(Xt=>this._layers[Xt.id]),Qe=je[0];if(Qe.visibility==="none")continue;const ze=Qe.source||"";let tt=this.familiesBySource[ze];tt||(tt=this.familiesBySource[ze]={});const Pt=Qe.sourceLayer||"_geojsonTileLayer";let St=tt[Pt];St||(St=tt[Pt]=[]),St.push(je)}}}const k=1*a.dJ;class N{constructor(ne){const le={},be=[];for(const Qe in ne){const ze=ne[Qe],tt=le[Qe]={};for(const Pt in ze.glyphs){const St=ze.glyphs[+Pt];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const Xt=St.metrics.localGlyph?k:1,ln={x:0,y:0,w:St.bitmap.width+2*Xt,h:St.bitmap.height+2*Xt};be.push(ln),tt[Pt]=ln}}const{w:Pe,h:Me}=a.j(be),je=new a.dI({width:Pe||1,height:Me||1});for(const Qe in ne){const ze=ne[Qe];for(const tt in ze.glyphs){const Pt=ze.glyphs[+tt];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const St=le[Qe][tt],Xt=Pt.metrics.localGlyph?k:1;a.dI.copy(Pt.bitmap,je,{x:0,y:0},{x:St.x+Xt,y:St.y+Xt},Pt.bitmap)}}this.image=je,this.positions=le}}a.dH(N,"GlyphAtlas");class z{constructor(ne){this.tileID=new a.aL(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.tileZoom=ne.tileZoom,this.uid=ne.uid,this.zoom=ne.zoom,this.lut=ne.lut,this.canonical=ne.tileID.canonical,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.scope=ne.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.promoteId=ne.promoteId,this.isSymbolTile=ne.isSymbolTile,this.tileTransform=a.dK(ne.tileID.canonical,ne.projection),this.projection=ne.projection,this.brightness=ne.brightness,this.extraShadowCaster=!!ne.extraShadowCaster,this.tessellationStep=ne.tessellationStep}parse(ne,le,be,Pe,Me){this.status="parsing",this.data=ne,this.collisionBoxArray=new a.dL;const je=new a.dM(Object.keys(ne.layers).sort()),Qe=new a.dN(this.tileID,this.promoteId);Qe.bucketLayerIDs=[];const ze={},tt=new a.dO(256,256),Pt={featureIndex:Qe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:tt,availableImages:be,brightness:this.brightness},St=le.familiesBySource[this.source];for(const Vt in St){const Or=ne.layers[Vt];if(!Or)continue;let sr=!1,Vn=!1,Kr=!1;for(const Hi of St[Vt])Hi[0].type==="symbol"?sr=!0:Vn=!0,Hi[0].is3D()&&Hi[0].type!=="model"&&(Kr=!0);if(this.extraShadowCaster&&!Kr||this.isSymbolTile===!0&&!sr||this.isSymbolTile===!1&&!Vn)continue;Or.version===1&&a.w(`Vector tile source "${this.source}" layer "${Vt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Rr=je.encode(Vt),hi=[];for(let Hi=0;Hi<Or.length;Hi++){const qi=Or.feature(Hi),Yl=Qe.getId(qi,Vt);hi.push({feature:qi,id:Yl,index:Hi,sourceLayerIndex:Rr})}for(const Hi of St[Vt]){const qi=Hi[0];(!this.extraShadowCaster||qi.is3D()&&qi.type!=="model")&&(this.isSymbolTile!==void 0&&qi.type==="symbol"!==this.isSymbolTile||qi.minzoom&&this.zoom<Math.floor(qi.minzoom)||qi.maxzoom&&this.zoom>=qi.maxzoom||qi.visibility!=="none"&&(U(Hi,this.zoom,Pt.brightness,be),(ze[qi.id]=qi.createBucket({index:Qe.bucketLayerIDs.length,layers:Hi,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(hi,Pt,this.tileID.canonical,this.tileTransform),Qe.bucketLayerIDs.push(Hi.map(Yl=>Yl.id))))}}let Xt,ln,Cn,In;tt.trim();const yn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},zn=()=>{if(Xt)return this.status="done",Me(Xt);if(this.extraShadowCaster)this.status="done",Me(null,{buckets:a.dG(ze).filter(Vt=>!Vt.isEmpty()),featureIndex:Qe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Pt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(ln&&Cn&&In){const Vt=new N(ln),Or=new a.dQ(Cn,In,this.lut);for(const sr in ze){const Vn=ze[sr];Vn instanceof a.dR?(U(Vn.layers,this.zoom,Pt.brightness,be),a.dS(Vn,ln,Vt.positions,Cn,Or.iconPositions,this.showCollisionBoxes,be,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Vn.hasPattern&&(Vn instanceof a.dT||Vn instanceof a.dU||Vn instanceof a.b_)&&(U(Vn.layers,this.zoom,Pt.brightness,be),Vn.addFeatures(Pt,this.tileID.canonical,Or.patternPositions,be,this.tileTransform,this.brightness))}this.status="done",Me(null,{buckets:a.dG(ze).filter(sr=>!sr.isEmpty()),featureIndex:Qe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vt.image,lineAtlas:tt,imageAtlas:Or,brightness:Pt.brightness})}};if(!this.extraShadowCaster){const Vt=a.dP(Pt.glyphDependencies,Vn=>Object.keys(Vn).map(Number));Object.keys(Vt).length?Pe.send("getGlyphs",{uid:this.uid,stacks:Vt,scope:this.scope},(Vn,Kr)=>{Xt||(Xt=Vn,ln=Kr,zn())},void 0,!1,yn):ln={};const Or=Object.keys(Pt.iconDependencies);Or.length?Pe.send("getImages",{icons:Or,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Vn,Kr)=>{Xt||(Xt=Vn,Cn=Kr,zn())},void 0,!1,yn):Cn={};const sr=Object.keys(Pt.patternDependencies);sr.length?Pe.send("getImages",{icons:sr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Vn,Kr)=>{Xt||(Xt=Vn,In=Kr,zn())},void 0,!1,yn):In={}}zn()}}function U(De,ne,le,be){const Pe=new a.X(ne,{brightness:le});for(const Me of De)Me.recalculate(Pe,be)}class j extends a.E{constructor(ne,le,be,Pe,Me,je){super(),this.actor=ne,this.layerIndex=le,this.availableImages=be,this.loadVectorData=Me||a.ap,this.loading={},this.loaded={},this.deduped=new a.ao(ne.scheduler),this.isSpriteLoaded=Pe,this.scheduler=ne.scheduler,this.brightness=je}loadTile(ne,le){const be=ne.uid,Pe=ne&&ne.request,Me=Pe&&Pe.collectResourceTiming,je=this.loading[be]=new z(ne);je.abort=this.loadVectorData(ne,(Qe,ze)=>{const tt=!this.loading[be];if(delete this.loading[be],tt||Qe||!ze)return je.status="done",tt||(this.loaded[be]=je),le(Qe);const Pt=ze.rawData,St={};ze.expires&&(St.expires=ze.expires),ze.cacheControl&&(St.cacheControl=ze.cacheControl),je.vectorTile=ze.vectorTile||new a.dV(new a.dW(Pt));const Xt=()=>{je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,(ln,Cn)=>{if(ln||!Cn)return le(ln);const In={};if(Me){const yn=b(Pe);yn.length>0&&(In.resourceTiming=JSON.parse(JSON.stringify(yn)))}le(null,a.W({rawTileData:Pt.slice(0)},Cn,St,In))})};this.isSpriteLoaded?Xt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Xt,{type:"parseTile",isSymbolTile:ne.isSymbolTile,zoom:ne.tileZoom}):Xt()}),this.loaded=this.loaded||{},this.loaded[be]=je})}reloadTile(ne,le){const be=this.loaded,Pe=ne.uid;if(be&&be[Pe]){const Me=be[Pe];Me.showCollisionBoxes=ne.showCollisionBoxes,Me.projection=ne.projection,Me.brightness=ne.brightness,Me.tileTransform=a.dK(ne.tileID.canonical,ne.projection),Me.extraShadowCaster=ne.extraShadowCaster,Me.lut=ne.lut;const je=(Qe,ze)=>{const tt=Me.reloadCallback;tt&&(delete Me.reloadCallback,Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,tt)),le(Qe,ze)};Me.status==="parsing"?Me.reloadCallback=je:Me.status==="done"&&(Me.vectorTile?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,je):je())}else le(null,void 0)}abortTile(ne,le){const be=ne.uid,Pe=this.loading[be];Pe&&(Pe.abort&&Pe.abort(),delete this.loading[be]),le()}removeTile(ne,le){const be=this.loaded,Pe=ne.uid;be&&be[Pe]&&delete be[Pe],le()}}class G{loadTile(ne,le){const{uid:be,encoding:Pe,rawImageData:Me,padding:je}=ne,Qe=ImageBitmap&&Me instanceof ImageBitmap?this.getImageData(Me,je):Me;le(null,new a.dX(be,Qe,Pe,je<1))}getImageData(ne,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const be=this.offscreenCanvasContext.getImageData(-le,-le,ne.width+2*le,ne.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),be}}class H{decodeRasterArray({task:ne,buffer:le},be){a.dY.performDecoding(le,ne).then(Pe=>{be(null,Pe)},Pe=>{be(Pe)})}}const Y=a.dZ.prototype.toGeoJSON;let K=class{constructor(De){this._feature=De,this.extent=a.a3,this.type=De.type,this.properties=De.tags,"id"in De&&!isNaN(De.id)&&(this.id=parseInt(De.id,10))}loadGeometry(){if(this._feature.type===1){const De=[];for(const ne of this._feature.geometry)De.push([new a.P(ne[0],ne[1])]);return De}{const De=[];for(const ne of this._feature.geometry){const le=[];for(const be of ne)le.push(new a.P(be[0],be[1]));De.push(le)}return De}}toGeoJSON(De,ne,le){return Y.call(this,De,ne,le)}},ee=class{constructor(De){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.a3,this.length=De.length,this._features=De}feature(De){return new K(this._features[De])}};const ue=64/4096;class ve{constructor(){this.features=new Map}clear(){this.features.clear()}load(ne=[],le){for(const be of ne){const Pe=be.id;if(Pe==null)continue;let Me=this.features.get(Pe);Me&&this.updateCache(Me,le),be.geometry?(Me=Ne(be),this.updateCache(Me,le),this.features.set(Pe,Me)):this.features.delete(Pe),this.updateCache(Me,le)}}updateCache(ne,le){for(const{canonical:be,uid:Pe}of Object.values(le)){const{z:Me,x:je,y:Qe}=be;Fe(ne,Math.pow(2,Me),je,Qe)&&delete le[Pe]}}getTile(ne,le,be){const Pe=Math.pow(2,ne),Me=[];for(const je of this.features.values())Fe(je,Pe,le,be)&&Me.push(et(je,Pe,le,be));return{features:Me}}getFeatures(){return[...this.features.values()]}}function Fe({minX:De,minY:ne,maxX:le,maxY:be},Pe,Me,je){return De<(Me+1+ue)/Pe&&ne<(je+1+ue)/Pe&&le>(Me-ue)/Pe&&be>(je-ue)/Pe}function Ne(De){const{id:ne,geometry:le,properties:be}=De;if(!le)return;if(le.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Pe,coordinates:Me}=le,je={id:ne,type:1,geometry:[],tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Qe=je.geometry;if(Pe==="Point")Oe(Me,Qe,je);else if(Pe==="MultiPoint")for(const ze of Me)Oe(ze,Qe,je);else if(Pe==="LineString")je.type=2,Le(Me,Qe,je);else if(Pe==="MultiLineString")je.type=2,Ue(Me,Qe,je);else if(Pe==="Polygon")je.type=3,Ue(Me,Qe,je,!0);else{if(Pe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");je.type=3;for(const ze of Me)Ue(ze,Qe,je,!0)}return je}function Oe([De,ne],le,be){const Pe=a.aj(De);let Me=a.ak(ne);Me=Me<0?0:Me>1?1:Me,le.push(Pe,Me),be.minX=Math.min(be.minX,Pe),be.minY=Math.min(be.minY,Me),be.maxX=Math.max(be.maxX,Pe),be.maxY=Math.max(be.maxY,Me)}function Le(De,ne,le,be=!1,Pe=!1){const Me=[];for(const je of De)Oe(je,Me,le);ne.push(Me),be&&function(je,Qe){let ze=0;for(let tt=0,Pt=je.length,St=Pt-2;tt<Pt;St=tt,tt+=2)ze+=(je[tt]-je[St])*(je[tt+1]+je[St+1]);if(ze>0===Qe)for(let tt=0,Pt=je.length;tt<Pt/2;tt+=2){const St=je[tt],Xt=je[tt+1];je[tt]=je[Pt-2-tt],je[tt+1]=je[Pt-1-tt],je[Pt-2-tt]=St,je[Pt-1-tt]=Xt}}(Me,Pe)}function Ue(De,ne,le,be=!1){for(let Pe=0;Pe<De.length;Pe++)Le(De[Pe],ne,le,be,Pe===0)}function et(De,ne,le,be){const{id:Pe,type:Me,geometry:je,tags:Qe}=De,ze=[];if(Me===1)rt(je,ne,le,be,ze);else for(const tt of je)ze.push(rt(tt,ne,le,be));return{id:Pe,type:Me,geometry:ze,tags:Qe}}function rt(De,ne,le,be,Pe=[]){for(let Me=0;Me<De.length;Me+=2)Pe.push(st(De[Me],De[Me+1],ne,le,be));return Pe}function st(De,ne,le,be,Pe){return[Math.round(a.a3*(De*le-be)),Math.round(a.a3*(ne*le-Pe))]}var Ke={exports:{}},Ze=a.d$,Xe=a.d_.VectorTileFeature,de=lt;function lt(De,ne){this.options=ne||{},this.features=De,this.length=De.length}function gt(De,ne){this.id=typeof De.id=="number"?De.id:void 0,this.type=De.type,this.rawGeometry=De.type===1?[De.geometry]:De.geometry,this.properties=De.tags,this.extent=ne||4096}lt.prototype.feature=function(De){return new gt(this.features[De],this.options.extent)},gt.prototype.loadGeometry=function(){var De=this.rawGeometry;this.geometry=[];for(var ne=0;ne<De.length;ne++){for(var le=De[ne],be=[],Pe=0;Pe<le.length;Pe++)be.push(new Ze(le[Pe][0],le[Pe][1]));this.geometry.push(be)}return this.geometry},gt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var De=this.geometry,ne=1/0,le=-1/0,be=1/0,Pe=-1/0,Me=0;Me<De.length;Me++)for(var je=De[Me],Qe=0;Qe<je.length;Qe++){var ze=je[Qe];ne=Math.min(ne,ze.x),le=Math.max(le,ze.x),be=Math.min(be,ze.y),Pe=Math.max(Pe,ze.y)}return[ne,be,le,Pe]},gt.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var Se=a.e0,qt=de;function an(De){var ne=new Se;return function(le,be){for(var Pe in le.layers)be.writeMessage(3,dn,le.layers[Pe])}(De,ne),ne.finish()}function dn(De,ne){var le;ne.writeVarintField(15,De.version||1),ne.writeStringField(1,De.name||""),ne.writeVarintField(5,De.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<De.length;le++)be.feature=De.feature(le),ne.writeMessage(2,Wt,be);var Pe=be.keys;for(le=0;le<Pe.length;le++)ne.writeStringField(3,Pe[le]);var Me=be.values;for(le=0;le<Me.length;le++)ne.writeMessage(4,At,Me[le])}function Wt(De,ne){var le=De.feature;le.id!==void 0&&ne.writeVarintField(1,le.id),ne.writeMessage(2,An,De),ne.writeVarintField(3,le.type),ne.writeMessage(4,jt,le)}function An(De,ne){var le=De.feature,be=De.keys,Pe=De.values,Me=De.keycache,je=De.valuecache;for(var Qe in le.properties){var ze=le.properties[Qe],tt=Me[Qe];if(ze!==null){tt===void 0&&(be.push(Qe),Me[Qe]=tt=be.length-1),ne.writeVarint(tt);var Pt=typeof ze;Pt!=="string"&&Pt!=="boolean"&&Pt!=="number"&&(ze=JSON.stringify(ze));var St=Pt+":"+ze,Xt=je[St];Xt===void 0&&(Pe.push(ze),je[St]=Xt=Pe.length-1),ne.writeVarint(Xt)}}}function ht(De,ne){return(ne<<3)+(7&De)}function Zt(De){return De<<1^De>>31}function jt(De,ne){for(var le=De.loadGeometry(),be=De.type,Pe=0,Me=0,je=le.length,Qe=0;Qe<je;Qe++){var ze=le[Qe],tt=1;be===1&&(tt=ze.length),ne.writeVarint(ht(1,tt));for(var Pt=be===3?ze.length-1:ze.length,St=0;St<Pt;St++){St===1&&be!==1&&ne.writeVarint(ht(2,Pt-1));var Xt=ze[St].x-Pe,ln=ze[St].y-Me;ne.writeVarint(Zt(Xt)),ne.writeVarint(Zt(ln)),Pe+=Xt,Me+=ln}be===3&&ne.writeVarint(ht(7,1))}}function At(De,ne){var le=typeof De;le==="string"?ne.writeStringField(1,De):le==="boolean"?ne.writeBooleanField(7,De):le==="number"&&(De%1!=0?ne.writeDoubleField(3,De):De<0?ne.writeSVarintField(6,De):ne.writeVarintField(5,De))}Ke.exports=an,Ke.exports.fromVectorTileJs=an,Ke.exports.fromGeojsonVt=function(De,ne){ne=ne||{};var le={};for(var be in De)le[be]=new qt(De[be].features,ne),le[be].name=be,le[be].version=ne.version,le[be].extent=ne.extent;return an({layers:le})},Ke.exports.GeoJSONWrapper=qt;var er=a.e1(Ke.exports);const Rn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:De=>De},_r=Math.fround||(dr=new Float32Array(1),De=>(dr[0]=+De,dr[0]));var dr;const vr=3,Zr=5,Ii=6;class nn{constructor(ne){this.options=Object.assign(Object.create(Rn),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:le,minZoom:be,maxZoom:Pe}=this.options;le&&console.time("total time");const Me=`prepare ${ne.length} points`;le&&console.time(Me),this.points=ne;const je=[];for(let ze=0;ze<ne.length;ze++){const tt=ne[ze];if(!tt.geometry)continue;const[Pt,St]=tt.geometry.coordinates,Xt=_r(Ci(Pt)),ln=_r(ta(St));je.push(Xt,ln,1/0,ze,-1,1),this.options.reduce&&je.push(0)}let Qe=this.trees[Pe+1]=this._createTree(je);le&&console.timeEnd(Me);for(let ze=Pe;ze>=be;ze--){const tt=+Date.now();Qe=this.trees[ze]=this._createTree(this._cluster(Qe,ze)),le&&console.log("z%d: %d clusters in %dms",ze,Qe.numItems,+Date.now()-tt)}return le&&console.timeEnd("total time"),this}getClusters(ne,le){let be=((ne[0]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,ne[1]));let Me=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)be=-180,Me=180;else if(be>Me){const St=this.getClusters([be,Pe,180,je],le),Xt=this.getClusters([-180,Pe,Me,je],le);return St.concat(Xt)}const Qe=this.trees[this._limitZoom(le)],ze=Qe.range(Ci(be),ta(je),Ci(Me),ta(Pe)),tt=Qe.data,Pt=[];for(const St of ze){const Xt=this.stride*St;Pt.push(tt[Xt+Zr]>1?rn(tt,Xt,this.clusterProps):this.points[tt[Xt+vr]])}return Pt}getChildren(ne){const le=this._getOriginId(ne),be=this._getOriginZoom(ne),Pe="No cluster with the specified id.",Me=this.trees[be];if(!Me)throw new Error(Pe);const je=Me.data;if(le*this.stride>=je.length)throw new Error(Pe);const Qe=this.options.radius/(this.options.extent*Math.pow(2,be-1)),ze=Me.within(je[le*this.stride],je[le*this.stride+1],Qe),tt=[];for(const Pt of ze){const St=Pt*this.stride;je[St+4]===ne&&tt.push(je[St+Zr]>1?rn(je,St,this.clusterProps):this.points[je[St+vr]])}if(tt.length===0)throw new Error(Pe);return tt}getLeaves(ne,le,be){const Pe=[];return this._appendLeaves(Pe,ne,le=le||10,be=be||0,0),Pe}getTile(ne,le,be){const Pe=this.trees[this._limitZoom(ne)],Me=Math.pow(2,ne),{extent:je,radius:Qe}=this.options,ze=Qe/je,tt=(be-ze)/Me,Pt=(be+1+ze)/Me,St={features:[]};return this._addTileFeatures(Pe.range((le-ze)/Me,tt,(le+1+ze)/Me,Pt),Pe.data,le,be,Me,St),le===0&&this._addTileFeatures(Pe.range(1-ze/Me,tt,1,Pt),Pe.data,Me,be,Me,St),le===Me-1&&this._addTileFeatures(Pe.range(0,tt,ze/Me,Pt),Pe.data,-1,be,Me,St),St.features.length?St:null}getClusterExpansionZoom(ne){let le=this._getOriginZoom(ne)-1;for(;le<=this.options.maxZoom;){const be=this.getChildren(ne);if(le++,be.length!==1)break;ne=be[0].properties.cluster_id}return le}_appendLeaves(ne,le,be,Pe,Me){const je=this.getChildren(le);for(const Qe of je){const ze=Qe.properties;if(ze&&ze.cluster?Me+ze.point_count<=Pe?Me+=ze.point_count:Me=this._appendLeaves(ne,ze.cluster_id,be,Pe,Me):Me<Pe?Me++:ne.push(Qe),ne.length===be)break}return Me}_createTree(ne){const le=new a.cK(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let be=0;be<ne.length;be+=this.stride)le.add(ne[be],ne[be+1]);return le.finish(),le.data=ne,le}_addTileFeatures(ne,le,be,Pe,Me,je){for(const Qe of ne){const ze=Qe*this.stride,tt=le[ze+Zr]>1;let Pt,St,Xt;if(tt)Pt=ea(le,ze,this.clusterProps),St=le[ze],Xt=le[ze+1];else{const In=this.points[le[ze+vr]];Pt=In.properties;const[yn,zn]=In.geometry.coordinates;St=Ci(yn),Xt=ta(zn)}const ln={type:1,geometry:[[Math.round(this.options.extent*(St*Me-be)),Math.round(this.options.extent*(Xt*Me-Pe))]],tags:Pt};let Cn;Cn=tt||this.options.generateId?le[ze+vr]:this.points[le[ze+vr]].id,Cn!==void 0&&(ln.id=Cn),je.features.push(ln)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,le){const{radius:be,extent:Pe,reduce:Me,minPoints:je}=this.options,Qe=be/(Pe*Math.pow(2,le)),ze=ne.data,tt=[],Pt=this.stride;for(let St=0;St<ze.length;St+=Pt){if(ze[St+2]<=le)continue;ze[St+2]=le;const Xt=ze[St],ln=ze[St+1],Cn=ne.within(ze[St],ze[St+1],Qe),In=ze[St+Zr];let yn=In;for(const zn of Cn){const Vt=zn*Pt;ze[Vt+2]>le&&(yn+=ze[Vt+Zr])}if(yn>In&&yn>=je){let zn,Vt=Xt*In,Or=ln*In,sr=-1;const Vn=(St/Pt<<5)+(le+1)+this.points.length;for(const Kr of Cn){const Rr=Kr*Pt;if(ze[Rr+2]<=le)continue;ze[Rr+2]=le;const hi=ze[Rr+Zr];Vt+=ze[Rr]*hi,Or+=ze[Rr+1]*hi,ze[Rr+4]=Vn,Me&&(zn||(zn=this._map(ze,St,!0),sr=this.clusterProps.length,this.clusterProps.push(zn)),Me(zn,this._map(ze,Rr)))}ze[St+4]=Vn,tt.push(Vt/yn,Or/yn,1/0,Vn,-1,yn),Me&&tt.push(sr)}else{for(let zn=0;zn<Pt;zn++)tt.push(ze[St+zn]);if(yn>1)for(const zn of Cn){const Vt=zn*Pt;if(!(ze[Vt+2]<=le)){ze[Vt+2]=le;for(let Or=0;Or<Pt;Or++)tt.push(ze[Vt+Or])}}}}return tt}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,le,be){if(ne[le+Zr]>1){const je=this.clusterProps[ne[le+Ii]];return be?Object.assign({},je):je}const Pe=this.points[ne[le+vr]].properties,Me=this.options.map(Pe);return be&&Me===Pe?Object.assign({},Me):Me}}function rn(De,ne,le){return{type:"Feature",id:De[ne+vr],properties:ea(De,ne,le),geometry:{type:"Point",coordinates:[(be=De[ne],360*(be-.5)),ul(De[ne+1])]}};var be}function ea(De,ne,le){const be=De[ne+Zr],Pe=be>=1e4?`${Math.round(be/1e3)}k`:be>=1e3?Math.round(be/100)/10+"k":be,Me=De[ne+Ii],je=Me===-1?{}:Object.assign({},le[Me]);return Object.assign(je,{cluster:!0,cluster_id:De[ne+vr],point_count:be,point_count_abbreviated:Pe})}function Ci(De){return De/360+.5}function ta(De){const ne=Math.sin(De*Math.PI/180),le=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return le<0?0:le>1?1:le}function ul(De){const ne=(180-360*De)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function It(De,ne,le,be){let Pe=be;const Me=ne+(le-ne>>1);let je,Qe=le-ne;const ze=De[ne],tt=De[ne+1],Pt=De[le],St=De[le+1];for(let Xt=ne+3;Xt<le;Xt+=3){const ln=Yt(De[Xt],De[Xt+1],ze,tt,Pt,St);if(ln>Pe)je=Xt,Pe=ln;else if(ln===Pe){const Cn=Math.abs(Xt-Me);Cn<Qe&&(je=Xt,Qe=Cn)}}Pe>be&&(je-ne>3&&It(De,ne,je,be),De[je+2]=Pe,le-je>3&&It(De,je,le,be))}function Yt(De,ne,le,be,Pe,Me){let je=Pe-le,Qe=Me-be;if(je!==0||Qe!==0){const ze=((De-le)*je+(ne-be)*Qe)/(je*je+Qe*Qe);ze>1?(le=Pe,be=Me):ze>0&&(le+=je*ze,be+=Qe*ze)}return je=De-le,Qe=ne-be,je*je+Qe*Qe}function Mn(De,ne,le,be){const Pe={id:De??null,type:ne,geometry:le,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")Zn(Pe,le);else if(ne==="Polygon")Zn(Pe,le[0]);else if(ne==="MultiLineString")for(const Me of le)Zn(Pe,Me);else if(ne==="MultiPolygon")for(const Me of le)Zn(Pe,Me[0]);return Pe}function Zn(De,ne){for(let le=0;le<ne.length;le+=3)De.minX=Math.min(De.minX,ne[le]),De.minY=Math.min(De.minY,ne[le+1]),De.maxX=Math.max(De.maxX,ne[le]),De.maxY=Math.max(De.maxY,ne[le+1])}function xr(De,ne,le,be){if(!ne.geometry)return;const Pe=ne.geometry.coordinates;if(Pe&&Pe.length===0)return;const Me=ne.geometry.type,je=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let Qe=[],ze=ne.id;if(le.promoteId?ze=ne.properties[le.promoteId]:le.generateId&&(ze=be||0),Me==="Point")Wi(Pe,Qe);else if(Me==="MultiPoint")for(const tt of Pe)Wi(tt,Qe);else if(Me==="LineString")Eo(Pe,Qe,je,!1);else if(Me==="MultiLineString"){if(le.lineMetrics){for(const tt of Pe)Qe=[],Eo(tt,Qe,je,!1),De.push(Mn(ze,"LineString",Qe,ne.properties));return}ro(Pe,Qe,je,!1)}else if(Me==="Polygon")ro(Pe,Qe,je,!0);else{if(Me!=="MultiPolygon"){if(Me==="GeometryCollection"){for(const tt of ne.geometry.geometries)xr(De,{id:ze,geometry:tt,properties:ne.properties},le,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const tt of Pe){const Pt=[];ro(tt,Pt,je,!0),Qe.push(Pt)}}De.push(Mn(ze,Me,Qe,ne.properties))}function Wi(De,ne){ne.push(Oi(De[0]),Za(De[1]),0)}function Eo(De,ne,le,be){let Pe,Me,je=0;for(let ze=0;ze<De.length;ze++){const tt=Oi(De[ze][0]),Pt=Za(De[ze][1]);ne.push(tt,Pt,0),ze>0&&(je+=be?(Pe*Pt-tt*Me)/2:Math.sqrt(Math.pow(tt-Pe,2)+Math.pow(Pt-Me,2))),Pe=tt,Me=Pt}const Qe=ne.length-3;ne[2]=1,It(ne,0,Qe,le),ne[Qe+2]=1,ne.size=Math.abs(je),ne.start=0,ne.end=ne.size}function ro(De,ne,le,be){for(let Pe=0;Pe<De.length;Pe++){const Me=[];Eo(De[Pe],Me,le,be),ne.push(Me)}}function Oi(De){return De/360+.5}function Za(De){const ne=Math.sin(De*Math.PI/180),le=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return le<0?0:le>1?1:le}function en(De,ne,le,be,Pe,Me,je,Qe){if(be/=ne,Me>=(le/=ne)&&je<be)return De;if(je<le||Me>=be)return null;const ze=[];for(const tt of De){const Pt=tt.geometry;let St=tt.type;const Xt=Pe===0?tt.minX:tt.minY,ln=Pe===0?tt.maxX:tt.maxY;if(Xt>=le&&ln<be){ze.push(tt);continue}if(ln<le||Xt>=be)continue;let Cn=[];if(St==="Point"||St==="MultiPoint")na(Pt,Cn,le,be,Pe);else if(St==="LineString")pr(Pt,Cn,le,be,Pe,!1,Qe.lineMetrics);else if(St==="MultiLineString")Zl(Pt,Cn,le,be,Pe,!1);else if(St==="Polygon")Zl(Pt,Cn,le,be,Pe,!0);else if(St==="MultiPolygon")for(const In of Pt){const yn=[];Zl(In,yn,le,be,Pe,!0),yn.length&&Cn.push(yn)}if(Cn.length){if(Qe.lineMetrics&&St==="LineString"){for(const In of Cn)ze.push(Mn(tt.id,St,In,tt.tags));continue}St!=="LineString"&&St!=="MultiLineString"||(Cn.length===1?(St="LineString",Cn=Cn[0]):St="MultiLineString"),St!=="Point"&&St!=="MultiPoint"||(St=Cn.length===3?"Point":"MultiPoint"),ze.push(Mn(tt.id,St,Cn,tt.tags))}}return ze.length?ze:null}function na(De,ne,le,be,Pe){for(let Me=0;Me<De.length;Me+=3){const je=De[Me+Pe];je>=le&&je<=be&&Xa(ne,De[Me],De[Me+1],De[Me+2])}}function pr(De,ne,le,be,Pe,Me,je){let Qe=ac(De);const ze=Pe===0?Ya:nf;let tt,Pt,St=De.start;for(let yn=0;yn<De.length-3;yn+=3){const zn=De[yn],Vt=De[yn+1],Or=De[yn+2],sr=De[yn+3],Vn=De[yn+4],Kr=Pe===0?zn:Vt,Rr=Pe===0?sr:Vn;let hi=!1;je&&(tt=Math.sqrt(Math.pow(zn-sr,2)+Math.pow(Vt-Vn,2))),Kr<le?Rr>le&&(Pt=ze(Qe,zn,Vt,sr,Vn,le),je&&(Qe.start=St+tt*Pt)):Kr>be?Rr<be&&(Pt=ze(Qe,zn,Vt,sr,Vn,be),je&&(Qe.start=St+tt*Pt)):Xa(Qe,zn,Vt,Or),Rr<le&&Kr>=le&&(Pt=ze(Qe,zn,Vt,sr,Vn,le),hi=!0),Rr>be&&Kr<=be&&(Pt=ze(Qe,zn,Vt,sr,Vn,be),hi=!0),!Me&&hi&&(je&&(Qe.end=St+tt*Pt),ne.push(Qe),Qe=ac(De)),je&&(St+=tt)}let Xt=De.length-3;const ln=De[Xt],Cn=De[Xt+1],In=Pe===0?ln:Cn;In>=le&&In<=be&&Xa(Qe,ln,Cn,De[Xt+2]),Xt=Qe.length-3,Me&&Xt>=3&&(Qe[Xt]!==Qe[0]||Qe[Xt+1]!==Qe[1])&&Xa(Qe,Qe[0],Qe[1],Qe[2]),Qe.length&&ne.push(Qe)}function ac(De){const ne=[];return ne.size=De.size,ne.start=De.start,ne.end=De.end,ne}function Zl(De,ne,le,be,Pe,Me){for(const je of De)pr(je,ne,le,be,Pe,Me,!1)}function Xa(De,ne,le,be){De.push(ne,le,be)}function Ya(De,ne,le,be,Pe,Me){const je=(Me-ne)/(be-ne);return Xa(De,Me,le+(Pe-le)*je,1),je}function nf(De,ne,le,be,Pe,Me){const je=(Me-le)/(Pe-le);return Xa(De,ne+(be-ne)*je,Me,1),je}function cl(De,ne){const le=[];for(let be=0;be<De.length;be++){const Pe=De[be],Me=Pe.type;let je;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")je=hl(Pe.geometry,ne);else if(Me==="MultiLineString"||Me==="Polygon"){je=[];for(const Qe of Pe.geometry)je.push(hl(Qe,ne))}else if(Me==="MultiPolygon"){je=[];for(const Qe of Pe.geometry){const ze=[];for(const tt of Qe)ze.push(hl(tt,ne));je.push(ze)}}le.push(Mn(Pe.id,Me,je,Pe.tags))}return le}function hl(De,ne){const le=[];le.size=De.size,De.start!==void 0&&(le.start=De.start,le.end=De.end);for(let be=0;be<De.length;be+=3)le.push(De[be]+ne,De[be+1],De[be+2]);return le}function sc(De,ne){if(De.transformed)return De;const le=1<<De.z,be=De.x,Pe=De.y;for(const Me of De.features){const je=Me.geometry,Qe=Me.type;if(Me.geometry=[],Qe===1)for(let ze=0;ze<je.length;ze+=2)Me.geometry.push(lc(je[ze],je[ze+1],ne,le,be,Pe));else for(let ze=0;ze<je.length;ze++){const tt=[];for(let Pt=0;Pt<je[ze].length;Pt+=2)tt.push(lc(je[ze][Pt],je[ze][Pt+1],ne,le,be,Pe));Me.geometry.push(tt)}}return De.transformed=!0,De}function lc(De,ne,le,be,Pe,Me){return[Math.round(le*(De*be-Pe)),Math.round(le*(ne*be-Me))]}function np(De,ne,le,be,Pe){const Me=ne===Pe.maxZoom?0:Pe.tolerance/((1<<ne)*Pe.extent),je={features:[],numPoints:0,numSimplified:0,numFeatures:De.length,source:null,x:le,y:be,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Qe of De)uc(je,Qe,Me,Pe);return je}function uc(De,ne,le,be){const Pe=ne.geometry,Me=ne.type,je=[];if(De.minX=Math.min(De.minX,ne.minX),De.minY=Math.min(De.minY,ne.minY),De.maxX=Math.max(De.maxX,ne.maxX),De.maxY=Math.max(De.maxY,ne.maxY),Me==="Point"||Me==="MultiPoint")for(let Qe=0;Qe<Pe.length;Qe+=3)je.push(Pe[Qe],Pe[Qe+1]),De.numPoints++,De.numSimplified++;else if(Me==="LineString")ra(je,Pe,De,le,!1,!1);else if(Me==="MultiLineString"||Me==="Polygon")for(let Qe=0;Qe<Pe.length;Qe++)ra(je,Pe[Qe],De,le,Me==="Polygon",Qe===0);else if(Me==="MultiPolygon")for(let Qe=0;Qe<Pe.length;Qe++){const ze=Pe[Qe];for(let tt=0;tt<ze.length;tt++)ra(je,ze[tt],De,le,!0,tt===0)}if(je.length){let Qe=ne.tags||null;if(Me==="LineString"&&be.lineMetrics){Qe={};for(const tt in ne.tags)Qe[tt]=ne.tags[tt];Qe.mapbox_clip_start=Pe.start/Pe.size,Qe.mapbox_clip_end=Pe.end/Pe.size}const ze={geometry:je,type:Me==="Polygon"||Me==="MultiPolygon"?3:Me==="LineString"||Me==="MultiLineString"?2:1,tags:Qe};ne.id!==null&&(ze.id=ne.id),De.features.push(ze)}}function ra(De,ne,le,be,Pe,Me){const je=be*be;if(be>0&&ne.size<(Pe?je:be))return void(le.numPoints+=ne.length/3);const Qe=[];for(let ze=0;ze<ne.length;ze+=3)(be===0||ne[ze+2]>je)&&(le.numSimplified++,Qe.push(ne[ze],ne[ze+1])),le.numPoints++;Pe&&function(ze,tt){let Pt=0;for(let St=0,Xt=ze.length,ln=Xt-2;St<Xt;ln=St,St+=2)Pt+=(ze[St]-ze[ln])*(ze[St+1]+ze[ln+1]);if(Pt>0===tt)for(let St=0,Xt=ze.length;St<Xt/2;St+=2){const ln=ze[St],Cn=ze[St+1];ze[St]=ze[Xt-2-St],ze[St+1]=ze[Xt-1-St],ze[Xt-2-St]=ln,ze[Xt-1-St]=Cn}}(Qe,Me),De.push(Qe)}const fl={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ia{constructor(ne,le){const be=(le=this.options=function(Me,je){for(const Qe in je)Me[Qe]=je[Qe];return Me}(Object.create(fl),le)).debug;if(be&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Pe=function(Me,je){const Qe=[];if(Me.type==="FeatureCollection")for(let ze=0;ze<Me.features.length;ze++)xr(Qe,Me.features[ze],je,ze);else xr(Qe,Me.type==="Feature"?Me:{geometry:Me},je);return Qe}(ne,le);this.tiles={},this.tileCoords=[],be&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Pe=function(Me,je){const Qe=je.buffer/je.extent;let ze=Me;const tt=en(Me,1,-1-Qe,Qe,0,-1,2,je),Pt=en(Me,1,1-Qe,2+Qe,0,-1,2,je);return(tt||Pt)&&(ze=en(Me,1,-Qe,1+Qe,0,-1,2,je)||[],tt&&(ze=cl(tt,1).concat(ze)),Pt&&(ze=ze.concat(cl(Pt,-1)))),ze}(Pe,le),Pe.length&&this.splitTile(Pe,0,0,0),be&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ne,le,be,Pe,Me,je,Qe){const ze=[ne,le,be,Pe],tt=this.options,Pt=tt.debug;for(;ze.length;){Pe=ze.pop(),be=ze.pop(),le=ze.pop(),ne=ze.pop();const St=1<<le,Xt=Ri(le,be,Pe);let ln=this.tiles[Xt];if(!ln&&(Pt>1&&console.time("creation"),ln=this.tiles[Xt]=np(ne,le,be,Pe,tt),this.tileCoords.push({z:le,x:be,y:Pe}),Pt)){Pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,be,Pe,ln.numFeatures,ln.numPoints,ln.numSimplified),console.timeEnd("creation"));const hi=`z${le}`;this.stats[hi]=(this.stats[hi]||0)+1,this.total++}if(ln.source=ne,Me==null){if(le===tt.indexMaxZoom||ln.numPoints<=tt.indexMaxPoints)continue}else{if(le===tt.maxZoom||le===Me)continue;if(Me!=null){const hi=Me-le;if(be!==je>>hi||Pe!==Qe>>hi)continue}}if(ln.source=null,ne.length===0)continue;Pt>1&&console.time("clipping");const Cn=.5*tt.buffer/tt.extent,In=.5-Cn,yn=.5+Cn,zn=1+Cn;let Vt=null,Or=null,sr=null,Vn=null,Kr=en(ne,St,be-Cn,be+yn,0,ln.minX,ln.maxX,tt),Rr=en(ne,St,be+In,be+zn,0,ln.minX,ln.maxX,tt);ne=null,Kr&&(Vt=en(Kr,St,Pe-Cn,Pe+yn,1,ln.minY,ln.maxY,tt),Or=en(Kr,St,Pe+In,Pe+zn,1,ln.minY,ln.maxY,tt),Kr=null),Rr&&(sr=en(Rr,St,Pe-Cn,Pe+yn,1,ln.minY,ln.maxY,tt),Vn=en(Rr,St,Pe+In,Pe+zn,1,ln.minY,ln.maxY,tt),Rr=null),Pt>1&&console.timeEnd("clipping"),ze.push(Vt||[],le+1,2*be,2*Pe),ze.push(Or||[],le+1,2*be,2*Pe+1),ze.push(sr||[],le+1,2*be+1,2*Pe),ze.push(Vn||[],le+1,2*be+1,2*Pe+1)}}getTile(ne,le,be){ne=+ne,le=+le,be=+be;const Pe=this.options,{extent:Me,debug:je}=Pe;if(ne<0||ne>24)return null;const Qe=1<<ne,ze=Ri(ne,le=le+Qe&Qe-1,be);if(this.tiles[ze])return sc(this.tiles[ze],Me);je>1&&console.log("drilling down to z%d-%d-%d",ne,le,be);let tt,Pt=ne,St=le,Xt=be;for(;!tt&&Pt>0;)Pt--,St>>=1,Xt>>=1,tt=this.tiles[Ri(Pt,St,Xt)];return tt&&tt.source?(je>1&&(console.log("found parent tile z%d-%d-%d",Pt,St,Xt),console.time("drilling down")),this.splitTile(tt.source,Pt,St,Xt,ne,le,be),je>1&&console.timeEnd("drilling down"),this.tiles[ze]?sc(this.tiles[ze],Me):null):null}}function Ri(De,ne,le){return 32*((1<<De)*le+ne)+De}function rp(De,ne){const le=De.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const be=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!be)return ne(null,null);const Pe=new ee(be.features);let Me=er(Pe);Me.byteOffset===0&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),ne(null,{vectorTile:Pe,rawData:Me.buffer})}class Xl extends j{constructor(ne,le,be,Pe,Me,je){super(ne,le,be,Pe,rp,je),Me&&(this.loadGeoJSON=Me),this._dynamicIndex=new ve}loadData(ne,le){const be=ne&&ne.request,Pe=be&&be.collectResourceTiming;this.loadGeoJSON(ne,(Me,je)=>{if(Me||!je)return le(Me);if(typeof je!="object")return le(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{try{if(ne.filter){const ze=a.y(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map(tt=>`${tt.key}: ${tt.message}`).join(", "));je.features=je.features.filter(tt=>ze.value.evaluate({zoom:0},tt))}ne.dynamic?(je.type==="Feature"&&(je={type:"FeatureCollection",features:[je]}),ne.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(je.features,this.loaded),ne.cluster&&(je.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ne.cluster?new nn(function({superclusterOptions:ze,clusterProperties:tt}){if(!tt||!ze)return ze;const Pt={},St={},Xt={accumulated:null,zoom:0},ln={properties:null},Cn=Object.keys(tt);for(const In of Cn){const[yn,zn]=tt[In],Vt=a.y(zn),Or=a.y(typeof yn=="string"?[yn,["accumulated"],["get",In]]:yn);Pt[In]=Vt.value,St[In]=Or.value}return ze.map=In=>{ln.properties=In;const yn={};for(const zn of Cn)yn[zn]=Pt[zn].evaluate(Xt,ln);return yn},ze.reduce=(In,yn)=>{ln.properties=yn;for(const zn of Cn)Xt.accumulated=In[zn],In[zn]=St[zn].evaluate(Xt,ln)},ze}(ne)).load(je.features):ne.dynamic?this._dynamicIndex:function(ze,tt){return new ia(ze,tt)}(je,ne.geojsonVtOptions)}catch(ze){return le(ze)}const Qe={};if(Pe){const ze=b(be);ze&&(Qe.resourceTiming={},Qe.resourceTiming[ne.source]=JSON.parse(JSON.stringify(ze)))}le(null,Qe)}})}reloadTile(ne,le){const be=this.loaded;return be&&be[ne.uid]?ne.partial?le(null,void 0):super.reloadTile(ne,le):this.loadTile(ne,le)}loadGeoJSON(ne,le){if(ne.request)a.g(ne.request,le);else{if(typeof ne.data!="string")return le(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(ne.data))}catch{return le(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ne,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(be){le(be)}}getClusterChildren(ne,le){try{le(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(be){le(be)}}getClusterLeaves(ne,le){try{le(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(be){le(be)}}}class cc{constructor(ne,le){this.tileID=new a.aL(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.tileZoom=ne.tileZoom,this.uid=ne.uid,this.zoom=ne.zoom,this.canonical=ne.tileID.canonical,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ne.projection,this.brightness=le}parse(ne,le,be,Pe){this.status="parsing";const Me=new a.aL(be.tileID.overscaledZ,be.tileID.wrap,be.tileID.canonical.z,be.tileID.canonical.x,be.tileID.canonical.y),je={},Qe=le.familiesBySource[be.source],ze=new a.dN(Me,be.promoteId);return ze.bucketLayerIDs=[],ze.is3DTile=!0,a.e3(ne).then(tt=>{if(!tt)return Pe(new Error("Could not parse tile"));const Pt=a.e4(tt,1/a.b5(be.tileID.canonical)),St=tt.json.extensionsUsed&&tt.json.extensionsUsed.includes("MAPBOX_mesh_features")||tt.json.asset.extras&&tt.json.asset.extras.MAPBOX_mesh_features,Xt=tt.json.extensionsUsed&&tt.json.extensionsUsed.includes("EXT_meshopt_compression"),ln=new a.X(this.zoom,{brightness:this.brightness});for(const Cn in Qe)for(const In of Qe[Cn]){const yn=In[0];ze.bucketLayerIDs.push(In.map(Vt=>Vt.id)),yn.recalculate(ln,[]);const zn=new a.e5(Pt,Me,St,Xt,this.brightness,ze);St||(zn.needsUpload=!0),je[yn.fqid]=zn,zn.evaluate(yn)}this.status="done",Pe(null,{buckets:je,featureIndex:ze})}).catch(tt=>Pe(new Error(tt.message)))}}class rf{constructor(ne,le,be,Pe,Me,je){this.actor=ne,this.layerIndex=le,this.brightness=je,this.loading={},this.loaded={}}loadTile(ne,le){const be=ne.uid,Pe=this.loading[be]=new cc(ne,this.brightness);a.e2(ne.request,(Me,je)=>{const Qe=!this.loading[be];return delete this.loading[be],Qe||Me?(Pe.status="done",Qe||(this.loaded[be]=Pe),le(Me)):je&&je.byteLength!==0?void Pe.parse(je,this.layerIndex,ne,(ze,tt)=>{Pe.status="done",this.loaded=this.loaded||{},this.loaded[be]=Pe,ze||!tt?le(ze):le(null,tt)}):(Pe.status="done",this.loaded[be]=Pe,le())})}reloadTile(ne,le){const be=this.loaded,Pe=ne.uid;if(be&&be[Pe]){const Me=be[Pe];Me.projection=ne.projection,Me.brightness=ne.brightness;const je=(Qe,ze)=>{Me.reloadCallback&&(delete Me.reloadCallback,this.loadTile(ne,le)),le(Qe,ze)};Me.status==="parsing"?Me.reloadCallback=je:Me.status==="done"&&this.loadTile(ne,le)}}abortTile(ne,le){const be=ne.uid;this.loading[be]&&delete this.loading[be],le()}removeTile(ne,le){const be=this.loaded,Pe=ne.uid;be&&be[Pe]&&delete be[Pe],le()}}class hc{constructor(ne){this.self=ne,this.actor=new a.e6(ne,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.aJ({name:"mercator"}),this.workerSourceTypes={vector:j,geojson:Xl,"batched-model":rf},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,be)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=be},this.self.registerRTLTextPlugin=le=>{if(a.e7.isParsed())throw new Error("RTL text plugin already registered.");a.e7.applyArabicShaping=le.applyArabicShaping,a.e7.processBidirectionalText=le.processBidirectionalText,a.e7.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(ne,le,be){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],delete this.rasterArrayWorkerSource,be()}checkIfReady(ne,le,be){be()}setReferrer(ne,le){this.referrer=le}spriteLoaded(ne,{scope:le,isLoaded:be}){if(this.isSpriteLoaded[ne]||(this.isSpriteLoaded[ne]={}),this.isSpriteLoaded[ne][le]=be,this.workerSources[ne]&&this.workerSources[ne][le])for(const Pe in this.workerSources[ne][le]){const Me=this.workerSources[ne][le][Pe];for(const je in Me){const Qe=Me[je];Qe instanceof j&&(Qe.isSpriteLoaded=be,Qe.fire(new a.f("isSpriteLoaded")))}}}setImages(ne,{scope:le,images:be},Pe){if(this.availableImages[ne]||(this.availableImages[ne]={}),this.availableImages[ne][le]=be,this.workerSources[ne]&&this.workerSources[ne][le]){for(const Me in this.workerSources[ne][le]){const je=this.workerSources[ne][le][Me];for(const Qe in je)je[Qe].availableImages=be}Pe()}else Pe()}setProjection(ne,le){this.projections[ne]=a.aJ(le)}setBrightness(ne,le,be){this.brightness=le,be()}setLayers(ne,le,be){this.getLayerIndex(ne,le.scope).replace(le.layers,le.options),be()}updateLayers(ne,le,be){this.getLayerIndex(ne,le.scope).update(le.layers,le.removedIds,le.options),be()}loadTile(ne,le,be){le.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,le.type,le.source,le.scope).loadTile(le,be)}loadDEMTile(ne,le,be){this.getDEMWorkerSource(ne,le.source,le.scope).loadTile(le,be)}decodeRasterArray(ne,le,be){this.getRasterArrayWorkerSource().decodeRasterArray(le,be)}reloadTile(ne,le,be){le.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,le.type,le.source,le.scope).reloadTile(le,be)}abortTile(ne,le,be){this.getWorkerSource(ne,le.type,le.source,le.scope).abortTile(le,be)}removeTile(ne,le,be){this.getWorkerSource(ne,le.type,le.source,le.scope).removeTile(le,be)}removeSource(ne,le,be){if(!(this.workerSources[ne]&&this.workerSources[ne][le.scope]&&this.workerSources[ne][le.scope][le.type]&&this.workerSources[ne][le.scope][le.type][le.source]))return;const Pe=this.workerSources[ne][le.scope][le.type][le.source];delete this.workerSources[ne][le.scope][le.type][le.source],Pe.removeSource!==void 0?Pe.removeSource(le,be):be()}loadWorkerSource(ne,le,be){try{this.self.importScripts(le.url),be()}catch(Pe){be(Pe.toString())}}syncRTLPluginState(ne,le,be){try{a.e7.setState(le);const Pe=a.e7.getPluginURL();if(a.e7.isLoaded()&&!a.e7.isParsed()&&Pe!=null){this.self.importScripts(Pe);const Me=a.e7.isParsed();be(Me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Pe}`),Me)}}catch(Pe){be(Pe.toString())}}setDracoUrl(ne,le){this.dracoUrl=le}getAvailableImages(ne,le){this.availableImages[ne]||(this.availableImages[ne]={});let be=this.availableImages[ne][le];return be||(be=[]),be}getLayerIndex(ne,le){this.layerIndexes[ne]||(this.layerIndexes[ne]={});let be=this.layerIndexes[ne][le];return be||(be=this.layerIndexes[ne][le]=new O,be.scope=le),be}getWorkerSource(ne,le,be,Pe){return this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][Pe]||(this.workerSources[ne][Pe]={}),this.workerSources[ne][Pe][le]||(this.workerSources[ne][Pe][le]={}),this.isSpriteLoaded[ne]||(this.isSpriteLoaded[ne]={}),this.workerSources[ne][Pe][le][be]||(this.workerSources[ne][Pe][le][be]=new this.workerSourceTypes[le]({send:(Me,je,Qe,ze,tt,Pt)=>{this.actor.send(Me,je,Qe,ne,tt,Pt)},scheduler:this.actor.scheduler},this.getLayerIndex(ne,Pe),this.getAvailableImages(ne,Pe),this.isSpriteLoaded[ne][Pe],void 0,this.brightness)),this.workerSources[ne][Pe][le][be]}getDEMWorkerSource(ne,le,be){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][be]||(this.demWorkerSources[ne][be]={}),this.demWorkerSources[ne][be][le]||(this.demWorkerSources[ne][be][le]=new G),this.demWorkerSources[ne][be][le]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new H),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ne,le){a.e8(le)}getWorkerPerformanceMetrics(ne,le,be){be(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new hc(self)),hc}),p(["./shared"],function(a){function b(y,l){if(Array.isArray(y)){if(!Array.isArray(l)||y.length!==l.length)return!1;for(let d=0;d<y.length;d++)if(!b(y[d],l[d]))return!1;return!0}if(typeof y=="object"&&y!==null&&l!==null){if(typeof l!="object"||Object.keys(y).length!==Object.keys(l).length)return!1;for(const d in y)if(!b(y[d],l[d]))return!1;return!0}return y===l}var C=A;function A(y){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,S,T=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(T);try{S=new Worker(P),v=!0}catch{v=!1}return S&&S.terminate(),URL.revokeObjectURL(P),v}()?function(){var v=document.createElement("canvas");v.width=v.height=1;var S=v.getContext("2d");if(!S)return!1;var T=S.getImageData(0,0,1,1);return T&&T.width===v.width}()?(O[d=l&&l.failIfMajorPerformanceCaveat]===void 0&&(O[d]=function(v){var S,T=function(P){var I=document.createElement("canvas"),L=Object.create(A.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=P,I.getContext("webgl2",L)}(v);if(!T)return!1;try{S=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!S||T.isContextLost())&&(T.shaderSource(S,"void main() {}"),T.compileShader(S),T.getShaderParameter(S,T.COMPILE_STATUS)===!0)}(d)),O[d]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var d}(y)}var O={};function k(y,l,d){const v=document.createElement(y);return l!=null&&(v.className=l),d&&d.appendChild(v),v}function N(y,l,d){const v=document.createElementNS("http://www.w3.org/2000/svg",y);for(const S of Object.keys(l))v.setAttributeNS(null,S,String(l[S]));return d&&d.appendChild(v),v}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const z=typeof document<"u"?document.documentElement&&document.documentElement.style:null,U=z&&z.userSelect!==void 0?"userSelect":"WebkitUserSelect";let j;function G(){z&&U&&(j=z[U],z[U]="none")}function H(){z&&U&&(z[U]=j)}function Y(y){y.preventDefault(),y.stopPropagation(),window.removeEventListener("click",Y,!0)}function K(){window.addEventListener("click",Y,!0),window.setTimeout(()=>{window.removeEventListener("click",Y,!0)},0)}function ee(y,l){const d=y.getBoundingClientRect();return Fe(y,d,l)}function ue(y,l){const d=y.getBoundingClientRect(),v=[];for(let S=0;S<l.length;S++)v.push(Fe(y,d,l[S]));return v}function ve(y){return window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button}function Fe(y,l,d){const v=y.offsetWidth===l.width?1:y.offsetWidth/l.width;return new a.P((d.clientX-l.left)*v,(d.clientY-l.top)*v)}class Ne{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(l,d){this._updatedSourceCaches[l]=d,this.setDirty()}discardSourceCacheUpdate(l){delete this._updatedSourceCaches[l]}updateLayer(l){const d=l.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(l.id),this.setDirty()}removeLayer(l){const d=l.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][l.id]=l,this._updatedLayers[d].delete(l.id),this._updatedPaintProps.delete(l.fqid),this.setDirty()}getRemovedLayer(l){return this._removedLayers[l.scope]?this._removedLayers[l.scope][l.id]:null}discardLayerRemoval(l){this._removedLayers[l.scope]&&delete this._removedLayers[l.scope][l.id]}getLayerUpdatesByScope(){const l={};for(const d in this._updatedLayers)l[d]=l[d]||{},l[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)l[d]=l[d]||{},l[d].removedIds=Object.keys(this._removedLayers[d]);return l}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(l){this._updatedPaintProps.add(l.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(l){this._updatedImages.add(l),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const Oe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Le{constructor(l,d,v,S,T,P){this.length=d.length,this.attributes=v,this.itemSize=d.bytesPerElement,this.dynamicDraw=S,this.instanceCount=P,this.context=l;const I=l.gl;this.buffer=I.createBuffer(),l.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||T||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let v=0;v<this.attributes.length;v++){const S=d.attributes[this.attributes[v].name];S!==void 0&&l.enableVertexAttribArray(S)}}setVertexAttribPointers(l,d,v){for(let S=0;S<this.attributes.length;S++){const T=this.attributes[S],P=d.attributes[T.name];P!==void 0&&l.vertexAttribPointer(P,T.components,l[Oe[T.type]],!1,this.itemSize,T.offset+this.itemSize*(v||0))}}setVertexAttribDivisor(l,d,v){for(let S=0;S<this.attributes.length;S++){const T=d.attributes[this.attributes[S].name];T!==void 0&&this.instanceCount&&this.instanceCount>0&&l.vertexAttribDivisor(T,v)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ue{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class et extends Ue{getDefault(){return a.C.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class rt extends Ue{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class st extends Ue{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Ke extends Ue{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ze extends Ue{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Xe extends Ue{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class de extends Ue{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class lt extends Ue{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class gt extends Ue{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class Se extends Ue{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class qt extends Ue{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class an extends Ue{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class dn extends Ue{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class Wt extends Ue{getDefault(){const l=this.gl;return[l.ONE,l.ZERO,l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class An extends Ue{getDefault(){return a.C.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ht extends Ue{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(l,l),this.current=l,this.dirty=!1)}}class Zt extends Ue{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class jt extends Ue{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class At extends Ue{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let er=class extends Ue{getDefault(){return null}set(y){(y!==this.current||this.dirty)&&(this.gl.useProgram(y),this.current=y,this.dirty=!1)}};class Rn extends Ue{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class _r extends Ue{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class dr extends Ue{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class vr extends Ue{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Zr extends Ue{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Ii extends Ue{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class nn extends Ue{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class rn extends Ue{getDefault(){return null}set(l){this.gl&&(l!==this.current||this.dirty)&&(this.gl.bindVertexArray(l),this.current=l,this.dirty=!1)}}class ea extends Ue{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Ci extends Ue{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class ta extends Ue{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class ul extends Ue{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class It extends ul{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Yt extends ul{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Mn extends ul{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Zn extends Yt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xr{constructor(l,d,v,S,T){this.context=l,this.width=d,this.height=v;const P=this.framebuffer=l.gl.createFramebuffer();S&&(this.colorAttachment=new It(l,P)),T&&(this.depthAttachmentType=T,this.depthAttachment=T==="renderbuffer"?new Yt(l,P):new Mn(l,P))}destroy(){const l=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&l.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&l.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&l.deleteTexture(d)}l.deleteFramebuffer(this.framebuffer)}}class Wi{constructor(l,d){this.gl=l,this.clearColor=new et(this),this.clearDepth=new rt(this),this.clearStencil=new st(this),this.colorMask=new Ke(this),this.depthMask=new Ze(this),this.stencilMask=new Xe(this),this.stencilFunc=new de(this),this.stencilOp=new lt(this),this.stencilTest=new gt(this),this.depthRange=new Se(this),this.depthTest=new qt(this),this.depthFunc=new an(this),this.blend=new dn(this),this.blendFunc=new Wt(this),this.blendColor=new An(this),this.blendEquation=new ht(this),this.cullFace=new Zt(this),this.cullFaceSide=new jt(this),this.frontFace=new At(this),this.program=new er(this),this.activeTexture=new Rn(this),this.viewport=new _r(this),this.bindFramebuffer=new dr(this),this.bindRenderbuffer=new vr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new Ii(this),this.bindElementBuffer=new nn(this),this.bindVertexArrayOES=new rn(this),this.pixelStoreUnpack=new ea(this),this.pixelStoreUnpackPremultiplyAlpha=new Ci(this),this.pixelStoreUnpackFlipY=new ta(this),this.options=d?{...d}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=l.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),this.maxPointSize=l.getParameter(l.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d,v){return new a.I(this,l,d,v)}createVertexBuffer(l,d,v,S,T){return new Le(this,l,d,v,S,T)}createRenderbuffer(l,d,v){const S=this.gl,T=S.createRenderbuffer();return this.bindRenderbuffer.set(T),S.renderbufferStorage(S.RENDERBUFFER,l,d,v),this.bindRenderbuffer.set(null),T}createFramebuffer(l,d,v,S){return new xr(this,l,d,v,S)}clear({color:l,depth:d,stencil:v,colorMask:S}){const T=this.gl;let P=0;l&&(P|=T.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set(S||[!0,!0,!0,!0])),d!==void 0&&(P|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),v!==void 0&&(P|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),T.clear(P)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){b(l.blendFunction,a.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor),l.blendEquation?this.blendEquation.set(l.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(l.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Eo{constructor(l){this._gl=l.gl,this._query=this._gl.createQuery(),this._isFree=!0}begin(){this._gl.beginQuery(this._gl.ANY_SAMPLES_PASSED,this._query),this._isFree=!1}end(){this._gl.endQuery(this._gl.ANY_SAMPLES_PASSED)}isResultAvailable(){return this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE)}consumeResult(){const l=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT);return this._isFree=!0,l}isFree(){return this._isFree}destroy(){this._gl.deleteQuery(this._query)}}class ro{constructor(l){this.useOcclusionQueries=!0,this.visualizeOcclusions="none",this.occlusionQueryFrameWindow=5,this.occluderSize=32,this.fadeSpeed=7,this.depthOffset=-1e-4,l.registerParameter(this,["Symbols"],"useOcclusionQueries"),l.registerParameter(this,["Symbols"],"visualizeOcclusions",{options:{none:"none",zPass:"zPass",zTest:"zTest"}}),l.registerParameter(this,["Symbols"],"occlusionQueryFrameWindow",{min:1,max:30,step:1}),l.registerParameter(this,["Symbols"],"occluderSize",{min:1,max:100,step:1}),l.registerParameter(this,["Symbols"],"fadeSpeed",{min:.1,max:50,step:.1}),l.registerParameter(this,["Symbols"],"depthOffset",{min:-.001,max:0,step:1e-4})}}class Oi{constructor(l,d,v,S){const T={width:v[0],height:v[1],data:null},P=l.gl;this.targetColorTexture=new a.T(l,T,P.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new a.T(l,T,P.RGBA,{useMipmap:!1}),this.context=l,this.updateParticleTexture(d,S),this.lastInvalidatedAt=0}updateParticleTexture(l,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const v=this.context.gl,S=d.width*d.height;this.particleTexture0=new a.T(this.context,d,v.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,d,v.RGBA,{premultiply:!1,useMipmap:!1});const T=new a.S;T.reserve(S);for(let P=0;P<S;P++)T.emplaceBack(P);this.particleIndexBuffer=this.context.createVertexBuffer(T,a.p.members,!0),this.particleSegment=a.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(l){return!(this.lastInvalidatedAt<l&&(this.lastInvalidatedAt=a.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class Za extends a.E{constructor(l){super(),this.requestManager=l,this.models={"":{}},this.numModelsLoading={}}loadModel(l,d){return a.l(this.requestManager.transformRequest(d,a.R.Model).url).then(v=>{if(!v)return;const S=a.c(v),T=new a.M(l,void 0,void 0,S);return T.computeBoundsAndApplyParent(),T}).catch(v=>{if(v&&v.status===404)return null;this.fire(new a.d(new Error(`Could not load model ${l} from ${d}: ${v.message}`)))})}load(l,d){this.models[d]||(this.models[d]={});const v=Object.keys(l);this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+v.length;const S=[];for(const T of v)S.push(this.loadModel(T,l[T]));Promise.allSettled(S).then(T=>{for(let P=0;P<T.length;P++){const{status:I,value:L}=T[P];I==="fulfilled"&&L&&(this.models[d][v[P]]={model:L,numReferences:1})}this.numModelsLoading[d]-=v.length,this.fire(new a.f("data",{dataType:"style"}))}).catch(T=>{this.fire(new a.d(new Error(`Could not load models: ${T.message}`)))})}isLoaded(){for(const l in this.numModelsLoading)if(this.numModelsLoading[l]>0)return!1;return!0}hasModel(l,d){return!!this.getModel(l,d)}getModel(l,d){return this.models[d]||(this.models[d]={}),this.models[d][l]?this.models[d][l].model:void 0}addModel(l,d,v){this.models[v]||(this.models[v]={}),this.hasModel(l,v)&&this.models[v][l].numReferences++,this.load({[l]:this.requestManager.normalizeModelURL(d)},v)}addModels(l,d){this.models[d]||(this.models[d]={});const v={};for(const S in l)this.models[d][S]={},v[S]=this.requestManager.normalizeModelURL(l[S]);this.load(v,d)}addModelsFromBucket(l,d){this.models[d]||(this.models[d]={});const v={};for(const S of l)this.hasModel(S,d)?this.models[d][S].numReferences++:v[S]=this.requestManager.normalizeModelURL(S);this.load(v,d)}removeModel(l,d){if(this.models[d]&&this.models[d][l]&&(this.models[d][l].numReferences--,this.models[d][l].numReferences===0)){const v=this.models[d][l].model;delete this.models[d][l],v.destroy()}}listModels(l){return this.models[l]||(this.models[l]={}),Object.keys(this.models[l])}upload(l,d){this.models[d]||(this.models[d]={});for(const v in this.models[d])this.models[d][v].model&&this.models[d][v].model.upload(l.context)}}function en(y){const{userImage:l}=y;return!!(l&&l.render&&l.render())&&(y.data.replace(new Uint8Array(l.data.buffer)),!0)}class na extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(l){this.images[l]={},this.loaded[l]=!1,this.updatedImages[l]={},this.patterns[l]={},this.callbackDispatchedThisFrame[l]={},this.atlasImage[l]=new a.i({width:1,height:1})}isLoaded(){for(const l in this.loaded)if(!this.loaded[l])return!1;return!0}setLoaded(l,d){if(this.loaded[d]!==l&&(this.loaded[d]=l,l)){for(const{ids:v,callback:S}of this.requestors)this._notify(v,d,S);this.requestors=[]}}hasImage(l,d){return!!this.getImage(l,d)}getImage(l,d){return this.images[d][l]}addImage(l,d,v){this._validate(l,v)&&(this.images[d][l]=v)}_validate(l,d){let v=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new a.d(new Error(`Image "${l}" has invalid "stretchX" value`))),v=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new a.d(new Error(`Image "${l}" has invalid "stretchY" value`))),v=!1),this._validateContent(d.content,d)||(this.fire(new a.d(new Error(`Image "${l}" has invalid "content" value`))),v=!1),v}_validateStretch(l,d){if(!l)return!0;let v=0;for(const S of l){if(S[0]<v||S[1]<S[0]||d<S[1])return!1;v=S[1]}return!0}_validateContent(l,d){return!(l&&(l.length!==4||l[0]<0||d.data.width<l[0]||l[1]<0||d.data.height<l[1]||l[2]<0||d.data.width<l[2]||l[3]<0||d.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,d,v){v.version=this.images[d][l].version+1,this.images[d][l]=v,this.updatedImages[d][l]=!0}removeImage(l,d){const v=this.images[d][l];delete this.images[d][l],delete this.patterns[d][l],v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(l){return Object.keys(this.images[l])}getImages(l,d,v){let S=!0;const T=!!this.loaded[d];if(!T)for(const P of l)this.images[d][P]||(S=!1);T||S?this._notify(l,d,v):this.requestors.push({ids:l,scope:d,callback:v})}getUpdatedImages(l){return this.updatedImages[l]}_notify(l,d,v){const S={};for(const T of l){this.images[d][T]||this.fire(new a.f("styleimagemissing",{id:T}));const P=this.images[d][T];P?S[T]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:a.w(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}v(null,S)}getPixelSize(l){const{width:d,height:v}=this.atlasImage[l];return{width:d,height:v}}getPattern(l,d,v){const S=this.patterns[d][l],T=this.getImage(l,d);if(!T)return null;if(S&&S.position.version===T.version)return S.position;if(S)S.position.version=T.version;else{const P={w:T.data.width+2,h:T.data.height+2,x:0,y:0},I=new a.k(P,T);this.patterns[d][l]={bin:P,position:I}}return this._updatePatternAtlas(d,v),this.patterns[d][l].position}bind(l,d){const v=l.gl;let S=this.atlasTexture[d];S?this.dirty&&(S.update(this.atlasImage[d]),this.dirty=!1):(S=new a.T(l,this.atlasImage[d],v.RGBA),this.atlasTexture[d]=S),S.bind(v.LINEAR,v.CLAMP_TO_EDGE)}_updatePatternAtlas(l,d){const v=[];for(const I in this.patterns[l])v.push(this.patterns[l][I].bin);const{w:S,h:T}=a.j(v),P=this.atlasImage[l];P.resize({width:S||1,height:T||1});for(const I in this.patterns[l]){const{bin:L}=this.patterns[l][I],F=L.x+1,V=L.y+1,Z=this.images[l][I].data,Q=Z.width,J=Z.height;a.i.copy(Z,P,{x:0,y:0},{x:F,y:V},{width:Q,height:J},d),a.i.copy(Z,P,{x:0,y:J-1},{x:F,y:V-1},{width:Q,height:1},d),a.i.copy(Z,P,{x:0,y:0},{x:F,y:V+J},{width:Q,height:1},d),a.i.copy(Z,P,{x:Q-1,y:0},{x:F-1,y:V},{width:1,height:J},d),a.i.copy(Z,P,{x:0,y:0},{x:F+Q,y:V},{width:1,height:J},d)}this.dirty=!0}beginFrame(){for(const l in this.images)this.callbackDispatchedThisFrame[l]={}}dispatchRenderCallbacks(l,d){for(const v of l){if(this.callbackDispatchedThisFrame[d][v])continue;this.callbackDispatchedThisFrame[d][v]=!0;const S=this.images[d][v];en(S)&&this.updateImage(v,d,S)}}}function pr(y){const l=y.key,d=y.value,v=y.valueSpec||{},S=y.objectElementValidators||{},T=y.style,P=y.styleSpec;let I=[];const L=a.n(d);if(L!=="object")return[new a.V(l,d,`object expected, ${L} found`)];for(const F in d){const V=F.split(".")[0];let Z;S[V]?Z=S[V]:v[V]?Z=ne:S["*"]?Z=S["*"]:v["*"]&&(Z=ne),Z?I=I.concat(Z({key:(l&&`${l}.`)+F,value:d[F],valueSpec:v[V]||v["*"],style:T,styleSpec:P,object:d,objectKey:F},d)):I.push(new a.m(l,d[F],`unknown property "${F}"`))}for(const F in v)S[F]||v[F].required&&v[F].default===void 0&&d[F]===void 0&&I.push(new a.V(l,d,`missing required property "${F}"`));return I}function ac(y){const l=y.value,d=y.valueSpec,v=y.style,S=y.styleSpec,T=y.key,P=y.arrayElementValidator||ne;if(a.n(l)!=="array")return[new a.V(T,l,`array expected, ${a.n(l)} found`)];if(d.length&&l.length!==d.length)return[new a.V(T,l,`array length ${d.length} expected, length ${l.length} found`)];if(d["min-length"]&&l.length<d["min-length"])return[new a.V(T,l,`array length at least ${d["min-length"]} expected, length ${l.length} found`)];let I={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};S.$version<7&&(I.function=d.function),a.n(d.value)==="object"&&(I=d.value);let L=[];for(let F=0;F<l.length;F++)L=L.concat(P({array:l,arrayIndex:F,value:l[F],valueSpec:I,style:v,styleSpec:S,key:`${T}[${F}]`},!0));return L}function Zl(y){const l=y.key,d=y.value,v=y.valueSpec;let S=a.n(d);if(S==="number"&&d!=d&&(S="NaN"),S!=="number")return[new a.V(l,d,`number expected, ${S} found`)];if("minimum"in v){let T=v.minimum;if(a.n(v.minimum)==="array"&&(T=v.minimum[y.arrayIndex]),d<T)return[new a.V(l,d,`${d} is less than the minimum value ${T}`)]}if("maximum"in v){let T=v.maximum;if(a.n(v.maximum)==="array"&&(T=v.maximum[y.arrayIndex]),d>T)return[new a.V(l,d,`${d} is greater than the maximum value ${T}`)]}return[]}function Xa(y){const l=y.valueSpec,d=a.u(y.value.type);let v,S,T,P={};const I=d!=="categorical"&&y.value.property===void 0,L=!I,F=a.n(y.value.stops)==="array"&&a.n(y.value.stops[0])==="array"&&a.n(y.value.stops[0][0])==="object",V=pr({key:y.key,value:y.value,valueSpec:y.styleSpec.function,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{stops:function(J){if(d==="identity")return[new a.V(J.key,J.value,'identity function may not have a "stops" property')];let ie=[];const oe=J.value;return ie=ie.concat(ac({key:J.key,value:oe,valueSpec:J.valueSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:Z})),a.n(oe)==="array"&&oe.length===0&&ie.push(new a.V(J.key,oe,"array must have at least one stop")),ie},default:function(J){return ne({key:J.key,value:J.value,valueSpec:l,style:J.style,styleSpec:J.styleSpec})}}});return d==="identity"&&I&&V.push(new a.V(y.key,y.value,'missing required property "property"')),d==="identity"||y.value.stops||V.push(new a.V(y.key,y.value,'missing required property "stops"')),d==="exponential"&&y.valueSpec.expression&&!a.s(y.valueSpec)&&V.push(new a.V(y.key,y.value,"exponential functions not supported")),y.styleSpec.$version>=8&&(L&&!a.q(y.valueSpec)?V.push(new a.V(y.key,y.value,"property functions not supported")):I&&!a.r(y.valueSpec)&&V.push(new a.V(y.key,y.value,"zoom functions not supported"))),d!=="categorical"&&!F||y.value.property!==void 0||V.push(new a.V(y.key,y.value,'"property" property is required')),V;function Z(J){let ie=[];const oe=J.value,ae=J.key;if(a.n(oe)!=="array")return[new a.V(ae,oe,`array expected, ${a.n(oe)} found`)];if(oe.length!==2)return[new a.V(ae,oe,`array length 2 expected, length ${oe.length} found`)];if(F){if(a.n(oe[0])!=="object")return[new a.V(ae,oe,`object expected, ${a.n(oe[0])} found`)];if(oe[0].zoom===void 0)return[new a.V(ae,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new a.V(ae,oe,"object stop key must have value")];const se=a.u(oe[0].zoom);if(typeof se!="number")return[new a.V(ae,oe[0].zoom,"stop zoom values must be numbers")];if(T&&T>se)return[new a.V(ae,oe[0].zoom,"stop zoom values must appear in ascending order")];se!==T&&(T=se,S=void 0,P={}),ie=ie.concat(pr({key:`${ae}[0]`,value:oe[0],valueSpec:{zoom:{}},style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:Zl,value:Q}}))}else ie=ie.concat(Q({key:`${ae}[0]`,value:oe[0],valueSpec:{},style:J.style,styleSpec:J.styleSpec},oe));return a.t(a.v(oe[1]))?ie.concat([new a.V(`${ae}[1]`,oe[1],"expressions are not allowed in function stops.")]):ie.concat(ne({key:`${ae}[1]`,value:oe[1],valueSpec:l,style:J.style,styleSpec:J.styleSpec}))}function Q(J,ie){const oe=a.n(J.value),ae=a.u(J.value),se=J.value!==null?J.value:ie;if(v){if(oe!==v)return[new a.V(J.key,se,`${oe} stop domain type must match previous stop domain type ${v}`)]}else v=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean"&&typeof ae!="number"&&typeof ae!="string"&&typeof ae!="boolean")return[new a.V(J.key,se,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&d!=="categorical"){let me=`number expected, ${oe} found`;return a.q(l)&&d===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(J.key,se,me)]}return d!=="categorical"||oe!=="number"||typeof ae=="number"&&isFinite(ae)&&Math.floor(ae)===ae?d!=="categorical"&&oe==="number"&&typeof ae=="number"&&typeof S=="number"&&S!==void 0&&ae<S?[new a.V(J.key,se,"stop domain values must appear in ascending order")]:(S=ae,d==="categorical"&&ae in P?[new a.V(J.key,se,"stop domain values must be unique")]:(P[ae]=!0,[])):[new a.V(J.key,se,`integer expected, found ${String(ae)}`)]}}function Ya(y){const l=(y.expressionContext==="property"?a.x:a.y)(a.v(y.value),y.valueSpec);if(l.result==="error")return l.value.map(v=>new a.V(`${y.key}${v.key}`,y.value,v.message));const d=l.value.expression||l.value._styleExpression.expression;if(y.expressionContext==="property"&&y.propertyKey==="text-font"&&!d.outputDefined())return[new a.V(y.key,y.value,`Invalid data expression for "${y.propertyKey}". Output values must be contained as literals within the expression.`)];if(y.expressionContext==="property"&&y.propertyType==="layout"&&!a.z(d))return[new a.V(y.key,y.value,'"feature-state" data expressions are not supported with layout properties.')];if(y.expressionContext==="filter")return nf(d,y);if(y.expressionContext&&y.expressionContext.indexOf("cluster")===0){if(!a.A(d,["zoom","feature-state"]))return[new a.V(y.key,y.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(y.expressionContext==="cluster-initial"&&!a.B(d))return[new a.V(y.key,y.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function nf(y,l){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(l.valueSpec&&l.valueSpec.expression)for(const S of l.valueSpec.expression.parameters)d.delete(S);if(d.size===0)return[];const v=[];return y instanceof a.D&&d.has(y.name)?[new a.V(l.key,l.value,`["${y.name}"] expression is not supported in a filter for a ${l.object.type} layer with id: ${l.object.id}`)]:(y.eachChild(S=>{v.push(...nf(S,l))}),v)}function cl(y){const l=y.key,d=y.value,v=y.valueSpec,S=[];return Array.isArray(v.values)?v.values.indexOf(a.u(d))===-1&&S.push(new a.V(l,d,`expected one of [${v.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(v.values).indexOf(a.u(d))===-1&&S.push(new a.V(l,d,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(d)} found`)),S}function hl(y){return a.G(a.v(y.value))?Ya(a.o({},y,{expressionContext:"filter",valueSpec:y.styleSpec[`filter_${y.layerType||"fill"}`]})):sc(y)}function sc(y){const l=y.value,d=y.key;if(a.n(l)!=="array")return[new a.V(d,l,`array expected, ${a.n(l)} found`)];const v=y.styleSpec;let S,T=[];if(l.length<1)return[new a.V(d,l,"filter array must have at least 1 element")];switch(T=T.concat(cl({key:`${d}[0]`,value:l[0],valueSpec:v.filter_operator,style:y.style,styleSpec:y.styleSpec})),a.u(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&a.u(l[1])==="$type"&&T.push(new a.V(d,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&T.push(new a.V(d,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(S=a.n(l[1]),S!=="string"&&T.push(new a.V(`${d}[1]`,l[1],`string expected, ${S} found`)));for(let P=2;P<l.length;P++)S=a.n(l[P]),a.u(l[1])==="$type"?T=T.concat(cl({key:`${d}[${P}]`,value:l[P],valueSpec:v.geometry_type,style:y.style,styleSpec:y.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&T.push(new a.V(`${d}[${P}]`,l[P],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let P=1;P<l.length;P++)T=T.concat(sc({key:`${d}[${P}]`,value:l[P],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":S=a.n(l[1]),l.length!==2?T.push(new a.V(d,l,`filter array for "${l[0]}" operator must have 2 elements`)):S!=="string"&&T.push(new a.V(`${d}[1]`,l[1],`string expected, ${S} found`))}return T}function lc(y,l){const d=y.key,v=y.style,S=y.layer,T=y.styleSpec,P=y.value,I=y.objectKey,L=T[`${l}_${y.layerType}`];if(!L)return[];const F=I.match(/^(.*)-transition$/);if(l==="paint"&&F&&L[F[1]]&&L[F[1]].transition)return ne({key:d,value:P,valueSpec:T.transition,style:v,styleSpec:T});const V=y.valueSpec||L[I];if(!V)return[new a.m(d,P,`unknown property "${I}"`)];let Z;if(a.n(P)==="string"&&a.q(V)&&!V.tokens&&(Z=/^{([^}]+)}$/.exec(P))){const J=`\`{ "type": "identity", "property": ${Z?JSON.stringify(Z[1]):'"_"'} }\``;return[new a.V(d,P,`"${I}" does not support interpolation syntax
Use an identity property function instead: ${J}.`)]}const Q=[];if(y.layerType==="symbol")I!=="text-field"||!v||v.glyphs||v.imports||Q.push(new a.V(d,P,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&a.H(a.v(P))&&a.u(P.type)==="identity"&&Q.push(new a.V(d,P,'"text-font" does not support identity functions'));else if(y.layerType==="model"&&l==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&a.q(V)&&(a.J(V)||a.r(V))){const J=a.x(a.v(P),V),ie=J.value.expression||J.value._styleExpression.expression;ie&&!a.A(ie,["measure-light"])&&(I==="model-emissive-strength"&&a.B(ie)&&a.z(ie)||Q.push(new a.V(d,P,`${I} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Q.concat(ne({key:y.key,value:P,valueSpec:V,style:v,styleSpec:T,expressionContext:"property",propertyType:l,propertyKey:I}))}function np(y){return lc(y,"paint")}function uc(y){return lc(y,"layout")}function ra(y){let l=[];const d=y.value,v=y.key,S=y.style,T=y.styleSpec;d.type||d.ref||l.push(new a.V(v,d,'either "type" or "ref" is required'));let P=a.u(d.type);const I=a.u(d.ref);if(d.id){const L=a.u(d.id);for(let F=0;F<y.arrayIndex;F++){const V=S.layers[F];a.u(V.id)===L&&l.push(new a.V(v,d.id,`duplicate layer id "${d.id}", previously used at line ${V.id.__line__}`))}}if("ref"in d){let L;["type","source","source-layer","filter","layout"].forEach(F=>{F in d&&l.push(new a.V(v,d[F],`"${F}" is prohibited for ref layers`))}),S.layers.forEach(F=>{a.u(F.id)===I&&(L=F)}),L?L.ref?l.push(new a.V(v,d.ref,"ref cannot reference another ref layer")):P=a.u(L.type):typeof I=="string"&&l.push(new a.V(v,d.ref,`ref layer "${I}" not found`))}else if(P!=="background"&&P!=="sky"&&P!=="slot")if(d.source){const L=S.sources&&S.sources[d.source],F=L&&a.u(L.type);L?F==="vector"&&P==="raster"?l.push(new a.V(v,d.source,`layer "${d.id}" requires a raster source`)):F==="raster"&&P!=="raster"?l.push(new a.V(v,d.source,`layer "${d.id}" requires a vector source`)):F!=="vector"||d["source-layer"]?F==="raster-dem"&&P!=="hillshade"?l.push(new a.V(v,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="raster-array"||["raster","raster-particle"].includes(P)?P!=="line"||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||F==="geojson"&&L.lineMetrics?P==="raster-particle"&&F!=="raster-array"&&l.push(new a.V(v,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):l.push(new a.V(v,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new a.V(v,d.source,"raster-array source can only be used with layer type 'raster'.")):l.push(new a.V(v,d,`layer "${d.id}" must specify a "source-layer"`)):l.push(new a.V(v,d.source,`source "${d.source}" not found`))}else l.push(new a.V(v,d,'missing required property "source"'));return l=l.concat(pr({key:v,value:d,valueSpec:T.layer,style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ne({key:`${v}.type`,value:d.type,valueSpec:T.layer.type,style:y.style,styleSpec:y.styleSpec,object:d,objectKey:"type"}),filter:L=>hl(a.o({layerType:P},L)),layout:L=>pr({layer:d,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":F=>uc(a.o({layerType:P},F))}}),paint:L=>pr({layer:d,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":F=>np(a.o({layerType:P,layer:d},F))}})}})),l}function fl(y){const l=y.value,d=y.key,v=a.n(l);return v!=="string"?[new a.V(d,l,`string expected, ${v} found`)]:[]}const ia={promoteId:function({key:y,value:l}){if(a.n(l)==="string")return fl({key:y,value:l});{const d=[];for(const v in l)d.push(...fl({key:`${y}.${v}`,value:l[v]}));return d}}};function Ri(y){const l=y.value,d=y.key,v=y.styleSpec,S=y.style;if(!l.type)return[new a.V(d,l,'"type" is required')];const T=a.u(l.type);let P=[];switch(["vector","raster","raster-dem","raster-array"].includes(T)&&(l.url||l.tiles||P.push(new a.m(d,l,'Either "url" or "tiles" is required.'))),T){case"vector":case"raster":case"raster-dem":case"raster-array":return P=P.concat(pr({key:d,value:l,valueSpec:v[`source_${T.replace("-","_")}`],style:y.style,styleSpec:v,objectElementValidators:ia})),P;case"geojson":if(P=pr({key:d,value:l,valueSpec:v.source_geojson,style:S,styleSpec:v,objectElementValidators:ia}),l.cluster)for(const I in l.clusterProperties){const[L,F]=l.clusterProperties[I],V=typeof L=="string"?[L,["accumulated"],["get",I]]:L;P.push(...Ya({key:`${d}.${I}.map`,value:F,expressionContext:"cluster-map"})),P.push(...Ya({key:`${d}.${I}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return P;case"video":return pr({key:d,value:l,valueSpec:v.source_video,style:S,styleSpec:v});case"image":return pr({key:d,value:l,valueSpec:v.source_image,style:S,styleSpec:v});case"canvas":return[new a.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cl({key:`${d}.type`,value:l.type,valueSpec:{values:rp(v)},style:S,styleSpec:v})}}function rp(y){return y.source.reduce((l,d)=>{const v=y[d];return v.type.type==="enum"&&(l=l.concat(Object.keys(v.type.values))),l},[])}function Xl(y){const l=y.value,d=y.styleSpec,v=d.light,S=y.style;let T=[];const P=a.n(l);if(l===void 0)return T;if(P!=="object")return T=T.concat([new a.V("light",l,`object expected, ${P} found`)]),T;for(const I in l){const L=I.match(/^(.*)-transition$/);T=T.concat(L&&v[L[1]]&&v[L[1]].transition?ne({key:I,value:l[I],valueSpec:d.transition,style:S,styleSpec:d}):v[I]?ne({key:I,value:l[I],valueSpec:v[I],style:S,styleSpec:d}):[new a.V(I,l[I],`unknown property "${I}"`)])}return T}function cc(y){const l=y.value;let d=[];if(!l)return d;const v=a.n(l);if(v!=="object")return d=d.concat([new a.V("light-3d",l,`object expected, ${v} found`)]),d;const S=y.styleSpec,T=S["light-3d"],P=y.key,I=y.style,L=y.style.lights;for(const Z of["type","id"])if(!(Z in l))return d=d.concat([new a.V("light-3d",l,`missing property ${Z} on light`)]),d;if(l.type&&L)for(let Z=0;Z<y.arrayIndex;Z++){const Q=a.u(l.type),J=L[Z];a.u(J.type)===Q&&d.push(new a.V(P,l.id,`duplicate light type "${l.type}", previously defined at line ${J.id.__line__}`))}const F=`properties_light_${l.type}`;if(!(F in S))return d=d.concat([new a.V("light-3d",l,`Invalid light type ${l.type}`)]),d;const V=S[F];for(const Z in l)if(Z==="properties"){const Q=l[Z],J=a.n(Q);if(J!=="object")return d=d.concat([new a.V("properties",Q,`object expected, ${J} found`)]),d;for(const ie in Q)d=d.concat(V[ie]?ne({key:ie,value:Q[ie],valueSpec:V[ie],style:I,styleSpec:S}):[new a.m(y.key,Q[ie],`unknown property "${ie}"`)])}else{const Q=Z.match(/^(.*)-transition$/);d=d.concat(Q&&T[Q[1]]&&T[Q[1]].transition?ne({key:Z,value:l[Z],valueSpec:S.transition,style:I,styleSpec:S}):T[Z]?ne({key:Z,value:l[Z],valueSpec:T[Z],style:I,styleSpec:S}):[new a.m(Z,l[Z],`unknown property "${Z}"`)])}return d}function rf(y){const l=y.value,d=y.key,v=y.style,S=y.styleSpec,T=S.terrain;let P=[];const I=a.n(l);if(l===void 0||I==="null")return P;if(I!=="object")return P=P.concat([new a.V("terrain",l,`object expected, ${I} found`)]),P;for(const L in l){const F=L.match(/^(.*)-transition$/);P=P.concat(F&&T[F[1]]&&T[F[1]].transition?ne({key:L,value:l[L],valueSpec:S.transition,style:v,styleSpec:S}):T[L]?ne({key:L,value:l[L],valueSpec:T[L],style:v,styleSpec:S}):[new a.m(L,l[L],`unknown property "${L}"`)])}if(l.source){const L=v.sources&&v.sources[l.source],F=L&&a.u(L.type);L?F!=="raster-dem"&&P.push(new a.V(d,l.source,`terrain cannot be used with a source of type ${String(F)}, it only be used with a "raster-dem" source type`)):P.push(new a.V(d,l.source,`source "${l.source}" not found`))}else P.push(new a.V(d,l,'terrain is missing required property "source"'));return P}function hc(y){const l=y.value,d=y.style,v=y.styleSpec,S=v.fog;let T=[];const P=a.n(l);if(l===void 0)return T;if(P!=="object")return T=T.concat([new a.V("fog",l,`object expected, ${P} found`)]),T;for(const I in l){const L=I.match(/^(.*)-transition$/);T=T.concat(L&&S[L[1]]&&S[L[1]].transition?ne({key:I,value:l[I],valueSpec:v.transition,style:d,styleSpec:v}):S[I]?ne({key:I,value:l[I],valueSpec:S[I],style:d,styleSpec:v}):[new a.m(I,l[I],`unknown property "${I}"`)])}return T}const De={"*":()=>[],array:ac,boolean:function(y){const l=y.value,d=y.key,v=a.n(l);return v!=="boolean"?[new a.V(d,l,`boolean expected, ${v} found`)]:[]},number:Zl,color:function(y){const l=y.key,d=y.value,v=a.n(d);return v!=="string"?[new a.V(l,d,`color expected, ${v} found`)]:a.F(d)===null?[new a.V(l,d,`color expected, "${d}" found`)]:[]},enum:cl,filter:hl,function:Xa,layer:ra,object:pr,source:Ri,model:a.K,light:Xl,"light-3d":cc,terrain:rf,fog:hc,string:fl,formatted:function(y){return fl(y).length===0?[]:Ya(y)},resolvedImage:function(y){return fl(y).length===0?[]:Ya(y)},projection:function(y){const l=y.value,d=y.styleSpec,v=d.projection,S=y.style;let T=[];const P=a.n(l);if(P==="object")for(const I in l)T=T.concat(ne({key:I,value:l[I],valueSpec:v[I],style:S,styleSpec:d}));else P!=="string"&&(T=T.concat([new a.V("projection",l,`object or string expected, ${P} found`)]));return T},import:function(y){const{value:l,styleSpec:d}=y,{data:v,...S}=l;Object.defineProperty(S,"__line__",{value:l.__line__,enumerable:!1});let T=pr(a.o({},y,{value:S,valueSpec:d.import}));return a.u(S.id)===""&&T.push(new a.V(`${y.key}.id`,S,"import id can't be an empty string")),v&&(T=T.concat(be(v,d,{key:`${y.key}.data`}))),T}};function ne(y,l=!1){const d=y.value,v=y.valueSpec,S=y.styleSpec;if(v.expression&&a.H(a.u(d)))return Xa(y);if(v.expression&&a.t(a.v(d)))return Ya(y);if(v.type&&De[v.type]){const T=De[v.type](y);return l===!0&&T.length>0&&a.n(y.value)==="array"?Ya(y):T}return pr(a.o({},y,{valueSpec:v.type?S[v.type]:v}))}function le(y){const l=y.value,d=y.key,v=fl(y);return v.length||(l.indexOf("{fontstack}")===-1&&v.push(new a.V(d,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&v.push(new a.V(d,l,'"glyphs" url must include a "{range}" token'))),v}function be(y,l=a.L,d={}){return ne({key:d.key||"",value:y,valueSpec:l.$root,styleSpec:l,style:y,objectElementValidators:{glyphs:le,"*":()=>[]}})}function Pe(y,l=a.L){return In(be(y,l))}const Me=y=>In(Ri(y)),je=y=>In(Xl(y)),Qe=y=>In(cc(y)),ze=y=>In(rf(y)),tt=y=>In(hc(y)),Pt=y=>In(ra(y)),St=y=>In(hl(y)),Xt=y=>In(np(y)),ln=y=>In(uc(y)),Cn=y=>In(a.K(y));function In(y){return y.slice().sort((l,d)=>l.line&&d.line?l.line-d.line:0)}function yn(y,l){let d=!1;if(l&&l.length)for(const v of l)v instanceof a.m?a.w(v.message):(y.fire(new a.d(new Error(v.message))),d=!0);return d}const zn=new a.N({anchor:new a.O(a.L.light.anchor),position:new a.Q(a.L.light.position),color:new a.O(a.L.light.color),intensity:new a.O(a.L.light.intensity)});class Vt extends a.E{constructor(l,d="flat"){super(),this._transitionable=new a.U(zn),this.setLight(l,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,d,v={}){this._validate(je,l,v)||(this._transitionable.setTransitionOrValue(l),this.id=d)}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,v){return(!v||v.validate!==!1)&&yn(this,l.call(Pe,a.W({value:d,style:{glyphs:!0,sprite:!0},styleSpec:a.L})))}}const Or=new a.N({source:new a.O(a.L.terrain.source),exaggeration:new a.O(a.L.terrain.exaggeration)});let sr=class extends a.E{constructor(y,l,d,v){super(),this.scope=d,this._transitionable=new a.U(Or,d,v),this._transitionable.setTransitionOrValue(y,v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(y,l){this._transitionable.setTransitionOrValue(y,l)}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}getExaggeration(y){return this._transitioning.possiblyEvaluate(new a.X(y)).get("exaggeration")}isZoomDependent(){const y=this._transitionable._values.exaggeration;return y!=null&&y.value!=null&&y.value.expression!=null&&y.value.expression instanceof a.Z}};const Vn=45,Kr=65,Rr=.05;function hi(y,l,d,v){const S=a.$(Vn,Kr,d),[T,P]=Hi(y,v);let I=1-Math.min(1,Math.exp((l-T)/(P-T)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*S*y.alpha}function Hi(y,l){const d=.5/Math.tan(.5*l);return[y.range[0]+d,y.range[1]+d]}function qi(y,l,d,v,S){const T=a._.transformMat4([],[l,d,v],S.mercatorFogMatrix);return hi(y,a._.length(T),S.pitch,S._fov)}function Yl(y,l,d,v,S,T,P){const I=[[d,v,0],[S,v,0],[S,T,0],[d,T,0]];let L=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(const V of I){const Z=a._.transformMat4([],V,l),Q=a._.length(Z);L=Math.min(L,Q),F=Math.max(F,Q)}return[hi(y,L,P.pitch,P._fov),hi(y,F,P.pitch,P._fov)]}const hy=new a.N({range:new a.O(a.L.fog.range),color:new a.O(a.L.fog.color),"high-color":new a.O(a.L.fog["high-color"]),"space-color":new a.O(a.L.fog["space-color"]),"horizon-blend":new a.O(a.L.fog["horizon-blend"]),"star-intensity":new a.O(a.L.fog["star-intensity"]),"vertical-range":new a.O(a.L.fog["vertical-range"])});class Ux extends a.E{constructor(l,d,v,S){super(),this._transitionable=new a.U(hy,v,new Map(S)),this.set(l,S),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new a.a0(hy),this.scope=v}get state(){const l=this._transform,d=l.projection.name==="globe",v=a.a1(l.zoom),S=this.properties.get("range"),T=[.5,3];return{range:d?[a.a2(T[0],S[0],v),a.a2(T[1],S[1],v)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,d,v={}){if(this._validate(tt,l,v))return;const S=a.W({},l);for(const T of Object.keys(a.L.fog))S[T]===void 0&&(S[T]=a.L.fog[T].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.$(Vn,Kr,l))*d.a}getOpacityAtLatLng(l,d){return this._transform.projection.supportsFog?function(v,S,T){const P=a.Y.fromLngLat(S),I=T.elevation?T.elevation.getAtPointOrZero(P):0;return qi(v,P.x,P.y,I,T)}(this.state,l,d):0}getOpacityForTile(l){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(l.toUnwrapped());return Yl(this.state,d,0,0,a.a3,a.a3,this._transform)}getOpacityForBounds(l,d,v,S,T){return this._transform.projection.supportsFog?Yl(this.state,l,d,v,S,T,this._transform):[1,1]}getFovAdjustedRange(l){return this._transform.projection.supportsFog?Hi(this.state,l):[0,1]}isVisibleOnFrustum(l){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const v of d){const S=l.points[v];let T;if(S[2]>=0)T=S;else{const P=l.points[v-4];T=a.a4(P,S,P[2]/(P[2]-S[2]))}if(qi(this.state,T[0],T[1],0,this._transform)>=Rr)return!0}return!1}updateConfig(l){this._transitionable.setTransitionOrValue(this._options,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,v){return(!v||v.validate!==!1)&&yn(this,l.call(Pe,a.W({value:d,style:{glyphs:!0,sprite:!0},styleSpec:a.L})))}}class of extends a.E{constructor(l,d,v,S){super(),this.scope=v,this._options=l,this.properties=new a.a0(d),this._transitionable=new a.U(d,v,new Map(S)),this._transitionable.setTransitionOrValue(l.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(l){this._transitionable.setTransitionOrValue(this._options.properties,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(l,d){this._options=l,this._transitionable.setTransitionOrValue(l.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Sn=new a.N({color:new a.O(a.L.properties_light_ambient.color),intensity:new a.O(a.L.properties_light_ambient.intensity)}),fy=new a.N({direction:new a.a5(a.L.properties_light_directional.direction),color:new a.O(a.L.properties_light_directional.color),intensity:new a.O(a.L.properties_light_directional.intensity),"cast-shadows":new a.O(a.L.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.O(a.L.properties_light_directional["shadow-intensity"])});var dl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,dy=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,py=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,my="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",gy=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,yy=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,_y=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,vy=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,xy=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec4 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,by=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Vx=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const fc=[];dc(dl,fc),dc(py,fc),dc(dy,fc);const ip={"_prelude_fog.vertex.glsl":yy,"_prelude_terrain.vertex.glsl":gy,"_prelude_shadow.vertex.glsl":by,"_prelude_fog.fragment.glsl":_y,"_prelude_shadow.fragment.glsl":Vx,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":vy,"_prelude_raster_particle.glsl":xy},op={};Ln("",gy),Ln(_y,yy),Ln(Vx,by),Ln(vy,""),Ln(xy,"");const Gx=Ln(dy,py),Wx=dl;var Hx={background:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ln("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ln(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ln(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ln("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ln("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ln("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Ln(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Ln(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Ln(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Ln(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform lowp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/clamp(u_trim_fade_range[0],1e-4,1.0)));float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/clamp(u_trim_fade_range[1],1e-4,1.0)));float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Ln("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Ln("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ln(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp float speed=velocity==INVALID_VELOCITY ? 0.0 : length(velocity);highp float reset_rate_bump=speed*u_reset_rate;highp vec2 particle_pos_min=-u_particle_pos_offset;highp vec2 particle_pos_max=vec2(1.0)+u_particle_pos_offset;highp vec2 pos_drop_rate=vec2(1.0)-step(particle_pos_min,pos)+step(particle_pos_max,pos);highp float drop_rate=max(u_reset_rate+reset_rate_bump,length(pos_drop_rate));highp float drop=step(1.0-drop_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:Ln(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
out_color*=alpha;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;
#endif
}`),symbolSDF:Ln(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Ln(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Ln("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Ln(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,my),skyboxGradient:Ln(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,my),skyboxCapture:Ln(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ln(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#else
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Ln(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Ln(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Ln("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function dc(y,l){const d=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let v of d)if(v=v.trim(),v[0]==="#"&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=v.split(" ");for(const T of S)l.includes(T)||l.push(T)}}function Ln(y,l){const d=/#include\s+"([^"]+)"/g,v=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=l.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(F=>{const V=F.split(" ");return V[V.length-1]}),S=[...new Set(S)]);const T={},P=[],I=[];if(y=y.replace(d,(F,V)=>(I.push(V),"")),(l=l.replace(d,(F,V)=>(P.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let L=[...fc];dc(y,L),dc(l,L);for(const F of[...P,...I])ip[F]||console.error(`Undefined include: ${F}`),op[F]||(op[F]=[],dc(ip[F],op[F])),L=[...L,...op[F]];return{fragmentSource:y=y.replace(v,(F,V,Z,Q,J)=>(T[J]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${J}
in ${Z} ${Q} ${J};
#else
uniform ${Z} ${Q} u_${J};
#endif
`:V==="initialize"?`
#ifdef HAS_UNIFORM_u_${J}
    ${Z} ${Q} ${J} = u_${J};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    in ${Z} ${Q} ${J};
#endif
`:V==="initialize-attribute"?"":void 0)),vertexSource:l=l.replace(v,(F,V,Z,Q,J)=>{const ie=Q==="float"?"vec2":Q,oe=J.match(/color/)?"color":ie;return V==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${J}
in ${Z} ${Q} a_${J};
#endif
`:T[J]?V==="define"?`
#ifndef HAS_UNIFORM_u_${J}
uniform lowp float u_${J}_t;
in ${Z} ${ie} a_${J};
out ${Z} ${Q} ${J};
#else
uniform ${Z} ${Q} u_${J};
#endif
`:V==="initialize"?oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${J}
    ${J} = a_${J};
#else
    ${Z} ${Q} ${J} = u_${J};
#endif
`:`
#ifndef HAS_UNIFORM_u_${J}
    ${J} = unpack_mix_${oe}(a_${J}, u_${J}_t);
#else
    ${Z} ${Q} ${J} = u_${J};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    in ${Z} ${Q} a_${J};
    out ${Z} ${Q} ${J};
#endif
`:V==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    ${J} = a_${J};
#endif
`:void 0:V==="define"?`
#ifndef HAS_UNIFORM_u_${J}
uniform lowp float u_${J}_t;
in ${Z} ${ie} a_${J};
#else
uniform ${Z} ${Q} u_${J};
#endif
`:V==="define-instanced"?oe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${J}0;
in vec4 a_${J}1;
in vec4 a_${J}2;
in vec4 a_${J}3;
#else
uniform ${Z} ${Q} u_${J};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Z} ${ie} a_${J};
#else
uniform ${Z} ${Q} u_${J};
#endif
`:V==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    ${Z} ${Q} ${J} = a_${J};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${J}
    ${Z} ${Q} ${J} = a_${J};
#else
    ${Z} ${Q} ${J} = u_${J};
#endif
`:`
#ifndef HAS_UNIFORM_u_${J}
    ${Z} ${Q} ${J} = unpack_mix_${oe}(a_${J}, u_${J}_t);
#else
    ${Z} ${Q} ${J} = u_${J};
#endif
`}),staticAttributes:S,usedDefines:L,vertexIncludes:P,fragmentIncludes:I}}class xA{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,d,v,S,T,P,I,L){this.context=l;let F=this.boundPaintVertexBuffers.length!==S.length;for(let Z=0;!F&&Z<S.length;Z++)this.boundPaintVertexBuffers[Z]!==S[Z]&&(F=!0);let V=this.boundDynamicVertexBuffers.length!==I.length;for(let Z=0;!V&&Z<I.length;Z++)this.boundDynamicVertexBuffers[Z]!==I[Z]&&(V=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==v||F||V||this.boundIndexBuffer!==T||this.boundVertexOffset!==P)this.freshBind(d,v,S,T,P,I,L);else{l.bindVertexArrayOES.set(this.vao);for(const Z of I)Z&&(Z.bind(),L&&Z.instanceCount&&Z.setVertexAttribDivisor(l.gl,d,L));T&&T.dynamicDraw&&T.bind()}}freshBind(l,d,v,S,T,P,I){const L=l.numAttributes,F=this.context,V=F.gl;this.vao&&this.destroy(),this.vao=F.gl.createVertexArray(),F.bindVertexArrayOES.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=S,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=P,d.enableAttributes(V,l),d.bind(),d.setVertexAttribPointers(V,l,T);for(const Z of v)Z.enableAttributes(V,l),Z.bind(),Z.setVertexAttribPointers(V,l,T);for(const Z of P)Z&&(Z.enableAttributes(V,l),Z.bind(),Z.setVertexAttribPointers(V,l,T),I&&Z.instanceCount&&Z.setVertexAttribDivisor(V,l,I));S&&S.bind(),F.currentNumAttributes=L}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function bA(y,l){const d=Math.pow(2,l.canonical.z),v=l.canonical.y;return[new a.Y(0,v/d).toLngLat().lat,new a.Y(0,(v+1)/d).toLngLat().lat]}function wA(y,l,d,v,S,T,P){const I=y.context,L=I.gl,F=d.hillshadeFBO;if(!F)return;y.prepareDrawTile();const V=y.isTileAffectedByFog(l),Z=y.getOrCreateProgram("hillshade",{overrideFog:V});I.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,F.colorAttachment.get());const Q=((ae,se,me,ge)=>{const ye=me.paint.get("hillshade-shadow-color"),Ce=me.paint.get("hillshade-highlight-color"),Ae=me.paint.get("hillshade-accent-color"),pe=me.paint.get("hillshade-emissive-strength");let _e=a.ab(me.paint.get("hillshade-illumination-direction"));if(me.paint.get("hillshade-illumination-anchor")==="viewport")_e-=ae.transform.angle;else if(ae.style&&ae.style.enable3dLights()&&ae.style.directionalLight){const Re=ae.style.directionalLight.properties.get("direction"),Ge=a.ac(Re.x,Re.y,Re.z);_e=a.ab(Ge[1])}const xe=!ae.options.moving;return{u_matrix:ge||ae.transform.calculateProjMatrix(se.tileID.toUnwrapped(),xe),u_image:0,u_latrange:bA(0,se.tileID),u_light:[me.paint.get("hillshade-exaggeration"),_e],u_shadow:ye.toRenderColor(me.lut),u_highlight:Ce.toRenderColor(me.lut),u_emissive_strength:pe,u_accent:Ae.toRenderColor(me.lut)}})(y,d,v,y.terrain?l.projMatrix:null);y.uploadCommonUniforms(I,Z,l.toUnwrapped());const{tileBoundsBuffer:J,tileBoundsIndexBuffer:ie,tileBoundsSegments:oe}=y.getTileBoundsBuffers(d);Z.draw(y,L.TRIANGLES,S,T,P,a.af.disabled,Q,v.id,J,ie,oe)}function wy(y,l,d){if(!l.needsDEMTextureUpload)return;const v=y.context,S=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||y.getTileTexture(d.stride);const T=d.getPixels();l.demTexture?l.demTexture.update(T,{premultiply:!1}):l.demTexture=new a.T(v,T,S.R32F,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Ka(y,l,d){const v=y.context,S=v.gl;if(!l.dem)return;const T=l.dem;if(v.activeTexture.set(S.TEXTURE1),wy(y,l,T),!l.demTexture)return;l.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const P=T.dim;v.activeTexture.set(S.TEXTURE0);let I=l.hillshadeFBO;if(!I){const Q=new a.T(v,{width:P,height:P,data:null},S.RGBA);Q.bind(S.LINEAR,S.CLAMP_TO_EDGE),I=l.hillshadeFBO=v.createFramebuffer(P,P,!0,"renderbuffer"),I.colorAttachment.set(Q.texture)}v.bindFramebuffer.set(I.framebuffer),v.viewport.set([0,0,P,P]);const{tileBoundsBuffer:L,tileBoundsIndexBuffer:F,tileBoundsSegments:V}=y.getMercatorTileBoundsBuffers(),Z=[];y.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),y.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(y,S.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.unblended,a.af.disabled,((Q,J)=>{const ie=J.stride,oe=a.ad.create();return a.ad.ortho(oe,0,a.a3,-a.a3,0,0,1),a.ad.translate(oe,oe,[0,-a.a3,0]),{u_matrix:oe,u_image:1,u_dimension:[ie,ie],u_zoom:Q.overscaledZ}})(l.tileID,T),d.id,L,F,V),l.needsHillshadePrepare=!1}function Sy(y,l,d,v,S){const T=function(P,I){if(P)return S(P);if(I){if(y.url&&I.tiles&&y.tiles&&delete y.tiles,I.variants){if(!Array.isArray(I.variants))return S(new Error("variants must be an array"));for(const F of I.variants){if(F==null||typeof F!="object"||F.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(F.capabilities))return S(new Error("capabilities must be an array"));if(F.capabilities.length===1&&F.capabilities[0]==="meshopt"){I=a.W(I,F);break}}}const L=a.ah(a.W(I,y),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(L.vectorLayers=I.vector_layers,L.vectorLayerIds=L.vectorLayers.map(F=>F.id)),I.raster_layers&&(L.rasterLayers=I.raster_layers,L.rasterLayerIds=L.rasterLayers.map(F=>F.id)),L.tiles=l.canonicalizeTileset(L,y.url),S(null,L)}};return y.url?a.g(l.transformRequest(l.normalizeSourceURL(y.url,null,d,v),a.R.Source),T):a.e.frame(()=>T(null,y))}class af{constructor(l,d,v){this.bounds=a.ai.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=v||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),v=Math.floor(a.aj(this.bounds.getWest())*d),S=Math.floor(a.ak(this.bounds.getNorth())*d),T=Math.ceil(a.aj(this.bounds.getEast())*d),P=Math.ceil(a.ak(this.bounds.getSouth())*d);return l.x>=v&&l.x<T&&l.y>=S&&l.y<P}}class sf extends a.E{constructor(l,d,v,S){super(),this.id=l,this.dispatcher=v,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.W({type:"raster"},d),a.W(this,a.ah(d,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"})),this._tileJSONRequest=Sy(this._options,this.map._requestManager,null,null,(d,v)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new a.d(d)):v&&(a.W(this,v),v.bounds&&(this.tileBounds=new af(v.bounds,this.minzoom,this.maxzoom)),a.an(v.tiles),this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))),l&&l(d)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=a.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(l){this.cancelTileJSONRequest()}serialize(){return a.W({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,d){const v=a.e.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);l.request=a.h(this.map._requestManager.transformRequest(S,a.R.Tile),(T,P,I,L)=>(delete l.request,l.aborted?(l.state="unloaded",d(null)):T?(l.state="errored",d(T)):P?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:I,expires:L}),l.setTexture(P,this.map.painter),l.state="loaded",a.am(this.dispatcher),void d(null)):d(null)))}abortTile(l,d){l.request&&(l.request.cancel(),delete l.request),d&&d()}unloadTile(l,d){l.texture&&l.texture instanceof a.T?(l.destroy(!0),l.texture&&l.texture instanceof a.T&&this.map.painter.saveTileTexture(l.texture)):l.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ap extends a.E{constructor(l,d,v,S){if(super(),this.id=l,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.W(this,a.ah(d,["url","scheme","tileSize","promoteId"])),this._options=a.W({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new a.ao}load(l){this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map._worldview;this._tileJSONRequest=Sy(this._options,this.map._requestManager,d,v,(S,T)=>{this._tileJSONRequest=null,this._loaded=!0,S?(d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),v&&v.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new a.d(S))):T&&(a.W(this,T),T.bounds&&(this.tileBounds=new af(T.bounds,this.minzoom,this.maxzoom)),a.an(T.tiles,this.map._requestManager._customAccessToken),this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))),l&&l(S)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=a.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(l){this.cancelTileJSONRequest()}serialize(){return a.W({},this._options)}loadTile(l,d){const v=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),S=this.map._requestManager.transformRequest(v,a.R.Tile),T=this.map.style?this.map.style.getLut(this.scope):null,P={request:S,data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,lut:T?{image:T.image.clone()}:null,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:l.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(P.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=d:l.request=l.actor.send("reloadTile",P,I.bind(this));else if(l.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",P,I.bind(this),void 0,!0);else{const L=a.ap.call({deduped:this._deduped},P,(F,V)=>{F||!V?I.call(this,F):(P.data={cacheControl:V.cacheControl,expires:V.expires,rawData:V.rawData.slice(0)},l.actor&&l.actor.send("loadTile",P,I.bind(this),void 0,!0))},!0);l.request={cancel:L}}function I(L,F){return delete l.request,l.aborted?d(null):L&&L.status!==404?d(L):(F&&F.resourceTiming&&(l.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&l.setExpiryData(F),l.loadVectorData(F,this.map.painter),a.am(this.dispatcher),d(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(l,d){l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope}),l.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const Kl=y=>({u_matrix:new a.a6(y),u_image0:new a.a7(y),u_skirt_height:new a.aa(y),u_ground_shadow_factor:new a.aq(y)}),Lt=(y,l,d)=>({u_matrix:y,u_image0:0,u_skirt_height:l,u_ground_shadow_factor:d}),qx=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:d,u_zoom_transition:S,u_merc_center:T,u_image0:0,u_frustum_tl:P,u_frustum_tr:I,u_frustum_br:L,u_frustum_bl:F,u_globe_pos:V,u_globe_radius:Z,u_viewport:Q,u_grid_matrix:oe?Float32Array.from(oe):new Float32Array(9),u_skirt_height:J,u_far_z_cutoff:ie});class lf{constructor(l=0,d=0,v=0,S=0){if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(v)||v<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=v,this.right=S}interpolate(l,d,v){return d.top!=null&&l.top!=null&&(this.top=a.a2(l.top,d.top,v)),d.bottom!=null&&l.bottom!=null&&(this.bottom=a.a2(l.bottom,d.bottom,v)),d.left!=null&&l.left!=null&&(this.left=a.a2(l.left,d.left,v)),d.right!=null&&l.right!=null&&(this.right=a.a2(l.right,d.right,v)),this}getCenter(l,d){const v=a.at((this.left+l-this.right)/2,0,l),S=a.at((this.top+d-this.bottom)/2,0,d);return new a.P(v,S)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new lf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fn(y,l){const d=a.aw(y,3);a.ad.fromQuat(y,l),a.az(y,3,d)}function Zi(y,l){const d=a.av.identity([]);return a.av.rotateZ(d,d,-l),a.av.rotateX(d,d,-y),d}function Zx(y,l){const d=[y[0],y[1],0],v=[l[0],l[1],0];if(a._.length(d)>=1e-15){const P=a._.normalize([],d);a._.scale(v,P,a._.dot(v,P)),l[0]=v[0],l[1]=v[1]}const S=a._.cross([],l,y);if(a._.len(S)<1e-15)return null;const T=Math.atan2(-S[1],S[0]);return Zi(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),T)}class Ty{constructor(l,d){this.position=l,this.orientation=d}get position(){return this._position}set position(l){if(l){const d=l instanceof a.Y?l:new a.Y(l[0],l[1],l[2]);this._renderWorldCopies&&(d.x=a.au(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(l,d){if(this.orientation=null,!this.position)return;const v=this.position,S=this._elevation?this._elevation.getAtPointOrZero(a.Y.fromLngLat(l)):0,T=a.Y.fromLngLat(l,S),P=[T.x-v.x,T.y-v.y,T.z-v.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Zx(P,d)}setPitchBearing(l,d){this.orientation=Zi(a.ab(l),a.ab(-d))}}class uf{constructor(l,d){this._transform=a.ad.identity([]),this.orientation=d,this.position=l}get mercatorPosition(){const l=this.position;return new a.Y(l[0],l[1],l[2])}get position(){const l=a.aw(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var d;l&&a.az(this._transform,3,[(d=l)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||a.av.identity([]),l&&Fn(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,d){this._orientation=Zi(l,d),Fn(this._transform,this._orientation)}forward(){const l=a.aw(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=a.aw(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=a.aw(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,d){const v=new Float64Array(16);return a.ad.invert(v,this.getWorldToCamera(l,d)),v}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(l,d,v){const S=this.position;a._.scale(S,S,-l);const T=new Float64Array(16);return a.ad.fromScaling(T,[v,v,v]),a.ad.translate(T,T,S),T[10]*=d,T}getWorldToCamera(l,d){const v=new Float64Array(16),S=new Float64Array(4),T=this.position;return a.av.conjugate(S,this._orientation),a._.scale(T,T,-l),a.ad.fromQuat(v,S),a.ad.translate(v,v,T),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=d,v[9]*=d,v[10]*=d,v[11]*=d,v}getCameraToClipPerspective(l,d,v,S){const T=new Float64Array(16);return a.ad.perspective(T,l,d,v,S),T}getCameraToClipOrthographic(l,d,v,S,T,P){const I=new Float64Array(16);return a.ad.ortho(I,l,d,v,S,T,P),I}getDistanceToElevation(l,d=!1){const v=l===0?0:a.ax(l,d?a.ay(this.position[1]):this.position[1]),S=this.forward();return(v-this.position[2])/S[2]}clone(){return new uf([...this.position],[...this.orientation])}}const pc={unknown:0,flipRequired:1,flipNotRequired:2},Pn=Math.tan(85*Math.PI/180);function Ql(y,l,d,v,S,T,P){const I=a.ad.create();if(d)if(T.name==="globe"){const L=a.aB(S,l);a.ad.multiply(I,I,L)}else{const L=a.aC.invert([],P);I[0]=L[0],I[1]=L[1],I[4]=L[2],I[5]=L[3],v||a.ad.rotateZ(I,I,S.angle)}else a.ad.multiply(I,S.labelPlaneMatrix,y);return I}function Jl(y,l,d,v,S,T,P){const I=Ql(y,l,d,v,S,T,P);return T.name==="globe"&&d||(I[2]=I[6]=I[10]=I[14]=0),I}function mc(y,l,d,v,S,T,P){if(d){if(T.name==="globe"){const I=Ql(y,l,d,v,S,T,P);return a.ad.invert(I,I),a.ad.multiply(I,y,I),I}{const I=a.ad.clone(y),L=a.ad.identity([]);return L[0]=P[0],L[1]=P[1],L[4]=P[2],L[5]=P[3],a.ad.multiply(I,I,L),v||a.ad.rotateZ(I,I,-S.angle),I}}return S.glCoordMatrix}function oa(y,l,d,v){const S=[y,l,d,1];d?a.aA.transformMat4(S,S,v):Qa(S,S,v);const T=S[3];return S[0]/=T,S[1]/=T,S[2]/=T,S}function Xi(y,l){return Math.min(.5+y/l*.5,1.5)}function SA(y,l){const d=y[0]/y[3],v=y[1]/y[3];return d>=-l[0]&&d<=l[0]&&v>=-l[1]&&v<=l[1]}function sp(y,l,d,v,S,T,P,I,L,F){const V=d.transform,Z=v?y.textSizeData:y.iconSizeData,Q=a.aD(Z,d.transform.zoom),J=V.projection.name==="globe",ie=[256/d.width*2+1,256/d.height*2+1],oe=v?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;oe.clear();let ae=null;J&&(ae=v?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const se=y.lineVertexArray,me=v?y.text.placedSymbolArray:y.icon.placedSymbolArray,ge=d.transform.width/d.transform.height;let ye,Ce=!1;for(let Ae=0;Ae<me.length;Ae++){const pe=me.get(Ae),{numGlyphs:_e,writingMode:xe}=pe;if(xe!==a.aE.vertical||Ce||ye===a.aE.horizontal||(Ce=!0),ye=xe,(pe.hidden||xe===a.aE.vertical)&&!Ce){eu(_e,oe);continue}Ce=!1;const Re=new a.P(pe.tileAnchorX,pe.tileAnchorY);let{x:Ge,y:Te,z:We}=V.projection.projectTilePoint(Re.x,Re.y,F.canonical);if(L){const[Nt,Dt,vt]=L(Re);Ge+=Nt,Te+=Dt,We+=vt}const qe=[Ge,Te,We,1];if(a.aA.transformMat4(qe,qe,l),!SA(qe,ie)){eu(_e,oe);continue}const dt=qe[3],mt=Xi(d.transform.getCameraToCenterDistance(V.projection),dt),ft=a.aF(Z,Q,pe),Be=P?ft/mt:ft*mt,Je=oa(Ge,Te,We,S);if(Je[3]<=0){eu(_e,oe);continue}let ct={};const Ot=P?null:L,kt=Ay(pe,Be,!1,I,l,S,T,y.glyphOffsetArray,se,oe,ae,Je,Re,ct,ge,Ot,V.projection,F,P);Ce=kt.useVertical,Ot&&kt.needsFlipping&&(ct={}),(kt.notEnoughRoom||Ce||kt.needsFlipping&&Ay(pe,Be,!0,I,l,S,T,y.glyphOffsetArray,se,oe,ae,Je,Re,ct,ge,Ot,V.projection,F,P).notEnoughRoom)&&eu(_e,oe)}v?(y.text.dynamicLayoutVertexBuffer.updateData(oe),ae&&y.text.globeExtVertexBuffer&&y.text.globeExtVertexBuffer.updateData(ae)):(y.icon.dynamicLayoutVertexBuffer.updateData(oe),ae&&y.icon.globeExtVertexBuffer&&y.icon.globeExtVertexBuffer.updateData(ae))}function lp(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe){const{lineStartIndex:ae,glyphStartIndex:se,segment:me}=I,ge=se+I.numGlyphs,ye=ae+I.lineLength,Ce=l.getoffsetX(se),Ae=l.getoffsetX(ge-1),pe=gc(y*Ce,d,v,S,T,P,me,ae,ye,L,F,V,Z,Q,!0,J,ie,oe);if(!pe)return null;const _e=gc(y*Ae,d,v,S,T,P,me,ae,ye,L,F,V,Z,Q,!0,J,ie,oe);return _e?{first:pe,last:_e}:null}function Ey(y,l,d,v){return y===a.aE.horizontal&&Math.abs(v)>Math.abs(d)?{useVertical:!0}:y===a.aE.vertical?v>0?{needsFlipping:!0}:null:l!==pc.unknown&&function(S,T){return S===0||Math.abs(T/S)>Pn}(d,v)?l===pc.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function Ay(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae,se,me){const ge=l/24,ye=y.lineOffsetX*ge,Ce=y.lineOffsetY*ge,{lineStartIndex:Ae,glyphStartIndex:pe,numGlyphs:_e,segment:xe,writingMode:Re,flipState:Ge}=y,Te=Ae+y.lineLength,We=qe=>{if(V){const[Be,Je,ct]=qe.up,Ot=F.length;a.aG(V,Ot+0,Be,Je,ct),a.aG(V,Ot+1,Be,Je,ct),a.aG(V,Ot+2,Be,Je,ct),a.aG(V,Ot+3,Be,Je,ct)}const[dt,mt,ft]=qe.point;a.aH(F,dt,mt,ft,qe.angle)};if(_e>1){const qe=lp(ge,I,ye,Ce,d,Z,Q,y,L,T,J,oe,!1,ae,se,me);if(!qe)return{notEnoughRoom:!0};if(v&&!d){let[dt,mt,ft]=qe.first.point,[Be,Je,ct]=qe.last.point;[dt,mt]=oa(dt,mt,ft,P),[Be,Je]=oa(Be,Je,ct,P);const Ot=Ey(Re,Ge,(Be-dt)*ie,Je-mt);if(y.flipState=Ot&&Ot.needsFlipping?pc.flipRequired:pc.flipNotRequired,Ot)return Ot}We(qe.first);for(let dt=pe+1;dt<pe+_e-1;dt++){const mt=gc(ge*I.getoffsetX(dt),ye,Ce,d,Z,Q,xe,Ae,Te,L,T,J,oe,!1,!1,ae,se,me);if(!mt)return F.length-=4*(dt-pe),{notEnoughRoom:!0};We(mt)}We(qe.last)}else{if(v&&!d){const dt=oa(Q.x,Q.y,0,S),mt=Ae+xe+1,ft=new a.P(L.getx(mt),L.gety(mt)),Be=oa(ft.x,ft.y,0,S),Je=Be[3]>0?Be:cf(Q,ft,dt,1,S,void 0,ae,se.canonical),ct=Ey(Re,Ge,(Je[0]-dt[0])*ie,Je[1]-dt[1]);if(y.flipState=ct&&ct.needsFlipping?pc.flipRequired:pc.flipNotRequired,ct)return ct}const qe=gc(ge*I.getoffsetX(pe),ye,Ce,d,Z,Q,xe,Ae,Te,L,T,J,oe,!1,!1,ae,se,me);if(!qe)return{notEnoughRoom:!0};We(qe)}return{}}function up(y,l,d,v,S){const{x:T,y:P,z:I}=v.projectTilePoint(y.x,y.y,l);if(!S)return oa(T,P,I,d);const[L,F,V]=S(y);return oa(T+L,P+F,I+V,d)}function cf(y,l,d,v,S,T,P,I){const L=up(y.sub(l)._unit()._add(y),I,S,P,T);return a._.sub(L,d,L),a._.normalize(L,L),a._.scaleAndAdd(L,d,L,v)}function gc(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae,se){const me=v?y-l:y+l;let ge=me>0?1:-1,ye=0;v&&(ge*=-1,ye=Math.PI),ge<0&&(ye+=Math.PI);let Ce=I+P+(ge>0?0:1)|0,Ae=S,pe=S,_e=0,xe=0;const Re=Math.abs(me),Ge=[],Te=[];let We=T,qe=We;const dt=()=>cf(qe,We,pe,Re-_e+1,V,Q,oe,ae.canonical);for(;_e+xe<=Re;){if(Ce+=ge,Ce<I||Ce>=L)return null;if(pe=Ae,qe=We,Ge.push(pe),J&&Te.push(qe),We=new a.P(F.getx(Ce),F.gety(Ce)),Ae=Z[Ce],!Ae){const Dt=up(We,ae.canonical,V,oe,Q);Ae=Dt[3]>0?Z[Ce]=Dt:dt()}_e+=xe,xe=a._.distance(pe,Ae)}ie&&Q&&(Z[Ce]&&(Ae=dt(),xe=a._.distance(pe,Ae)),Z[Ce]=Ae);const mt=(Re-_e)/xe,ft=We.sub(qe)._mult(mt)._add(qe),Be=a._.sub([],Ae,pe),Je=a._.scaleAndAdd([],pe,Be,mt);let ct=[0,0,1],Ot=Be[0],kt=Be[1];if(se&&(ct=oe.upVector(ae.canonical,ft.x,ft.y),ct[0]!==0||ct[1]!==0||ct[2]!==1)){const Dt=[ct[2],0,-ct[0]],vt=a._.cross([],ct,Dt);a._.normalize(Dt,Dt),a._.normalize(vt,vt),Ot=a._.dot(Be,Dt),kt=a._.dot(Be,vt)}if(d){const Dt=a._.cross([],ct,Be);a._.normalize(Dt,Dt),a._.scaleAndAdd(Je,Je,Dt,d*ge)}const Nt=ye+Math.atan2(kt,Ot);return Ge.push(Je),J&&Te.push(ft),{point:Je,angle:Nt,path:Ge,tilePath:Te,up:ct}}function eu(y,l){const d=l.length,v=d+4*y;l.resize(v),l.float32.fill(-1/0,4*d,4*v)}function Qa(y,l,d){const v=l[0],S=l[1];return y[0]=d[0]*v+d[4]*S+d[12],y[1]=d[1]*v+d[5]*S+d[13],y[3]=d[3]*v+d[7]*S+d[15],y}const Cy=(y,l,d)=>(1-d)*y+d*l,Qr=y=>y*y*y*y*y;class Ja{constructor(l,d,v,S,T,P,I){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=v??0,this._maxPitch=S??60,this.setProjection(P),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new a.aI(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new lf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new uf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const l=new Ja(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(l,d=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||v)&&this._updateCameraOnTerrain(),(l||v)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return a.ah(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=a.aJ(this.projectionOptions);const v=!b(d,this.getProjection());return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(l){return this._orthographicProjectionAtLowPitch!==l&&(this._orthographicProjectionAtLowPitch=l,this._calcMatrices(),!0)}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.aJ({name:"mercator"});const d=l!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.ax(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.au(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const d=-l*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=a.aC.create(),a.aC.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=a.at(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=a.ab(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(l){this._tileCoverLift!==l&&(this._tileCoverLift=l)}_updateCameraOnTerrain(){const l=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&l===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||l===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const v=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&v.exaggeration()&&this._centerAltitudeValidForExaggeration!==v.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*v.exaggeration(),this._centerAltitudeValidForExaggeration=v.exaggeration()):(this._centerAltitude=l||0,this._centerAltitudeValidForExaggeration=v.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let S=0,T=0;for(let P=0;P<d.length;P++){const I=new a.P(d[P][0]*this.width,v+d[P][1]*(this.height-v)),L=l.pointCoordinate(I);if(!L)continue;const F=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);S+=L[3]*F,T+=F}return T===0?NaN:S/T}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const l=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*d,S=this._mercatorZfromZoom(l),T=this._mercatorZfromZoom(this._maxZoom),P=Math.max(S-v,T);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let v;v=l.z<this._camera.position[2]?[d.x,d.y,d.z]:[l.x,l.y,l.z];const S=a._.length(a._.sub([],this._camera.position,v));return a.at(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let d=!1;if(l.orientation&&!a.av.exactEquals(l.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(l.orientation)),l.position){const v=[l.position.x,l.position.y,l.position.z];a._.exactEquals(v,this._camera.position)||(this._setCameraPosition(v),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,d=new Ty;return d.position=new a.Y(l[0],l[1],l[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(l){if(!a.av.length(l))return!1;a.av.normalize(l,l);const d=a._.transformQuat([],[0,0,-1],l),v=a._.transformQuat([],[0,-1,0],l);if(v[2]<0)return!1;const S=Zx(d,v);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(l){const d=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;l[2]=a.at(l[2],S/v,S/d),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,v){this._unmodified=!1,this._edgeInsets.interpolate(l,d,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new a.aK(0,l)];if(this.renderWorldCopies){const v=this.pointCoordinate(new a.P(0,0)),S=this.pointCoordinate(new a.P(this.width,0)),T=this.pointCoordinate(new a.P(this.width,this.height)),P=this.pointCoordinate(new a.P(0,this.height)),I=Math.floor(Math.min(v.x,S.x,T.x,P.x)),L=Math.floor(Math.max(v.x,S.x,T.x,P.x)),F=1;for(let V=I-F;V<=L+F;V++)V!==0&&d.push(new a.aK(V,l))}return d}isLODDisabled(l){return(!l||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(l,d,v){let S=[];if(d[0]===0&&d[1]===0)return S;for(const P of l){const I=P.canonical,L=P.overscaledZ,F=P.wrap,V=1<<I.z,Z=I.x+1<V,Q=I.x>0,J=I.y+1<V,ie=I.y>0,oe=P.wrap-(Q?0:1),ae=P.wrap+(Z?0:1),se=Q?I.x-1:V-1,me=Z?I.x+1:0;d[0]<0?(S.push(new a.aL(L,ae,I.z,me,I.y)),d[1]<0&&J&&(S.push(new a.aL(L,F,I.z,I.x,I.y+1)),S.push(new a.aL(L,ae,I.z,me,I.y+1))),d[1]>0&&ie&&(S.push(new a.aL(L,F,I.z,I.x,I.y-1)),S.push(new a.aL(L,ae,I.z,me,I.y-1)))):d[0]>0?(S.push(new a.aL(L,oe,I.z,se,I.y)),d[1]<0&&J&&(S.push(new a.aL(L,F,I.z,I.x,I.y+1)),S.push(new a.aL(L,oe,I.z,se,I.y+1))),d[1]>0&&ie&&(S.push(new a.aL(L,F,I.z,I.x,I.y-1)),S.push(new a.aL(L,oe,I.z,se,I.y-1)))):d[1]<0&&J?S.push(new a.aL(L,F,I.z,I.x,I.y+1)):ie&&S.push(new a.aL(L,F,I.z,I.x,I.y-1))}if(S.length>1){S.sort((L,F)=>L.overscaledZ-F.overscaledZ||L.wrap-F.wrap||L.canonical.z-F.canonical.z||L.canonical.x-F.canonical.x||L.canonical.y-F.canonical.y);let P=0,I=0;for(;I<S.length;)S[I].equals(S[P])?++I:S[++P]=S[I++];S.length=P+1}const T=[];for(const P of S)S.some(I=>P.isChildOf(I))||T.push(P);return S=T.filter(P=>!l.some(I=>!!(P.overscaledZ<v&&I.isChildOf(P))||P.equals(I)||P.isChildOf(I))),S}coveringTiles(l){let d=this.coveringZoomLevel(l);const v=d,S=this.elevation&&this.elevation.exaggeration(),T=S&&!l.isTerrainDEM,P=this.projection.name==="mercator";if(l.minzoom!==void 0&&d<l.minzoom)return[];l.maxzoom!==void 0&&d>l.maxzoom&&(d=l.maxzoom);const I=this.locationCoordinate(this.center),L=this.center.lat,F=1<<d,V=[F*I.x,F*I.y,0],Z=this.projection.name==="globe",Q=!Z,J=a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,Q),ie=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),oe=F*a.ax(1,this.center.lat),ae=this._camera.position[2]/a.ax(1,this.center.lat),se=[F*ie.x,F*ie.y,ae*(Q?1:oe)],me=Z||S,ge=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),ye=this.isLODDisabled(!0)?d:0;let Ce;if(this._elevation&&l.isTerrainDEM)Ce=1e4*this._elevation.exaggeration();else if(this._elevation){const Be=this._elevation.getMinMaxForVisibleTiles();Ce=Be?Be.max:this._centerAltitude}else Ce=this._centerAltitude;const Ae=l.isTerrainDEM?-Ce:this._elevation?this._elevation.getMinElevationBelowMSL():0,pe=this.projection.isReprojectedInTileSpace?a.aN(this):1,_e=Be=>{const ct=new a.Y(Be.x+25e-6,Be.y,Be.z),Ot=new a.Y(Be.x,Be.y+25e-6,Be.z),kt=Be.toLngLat(),Nt=ct.toLngLat(),Dt=Ot.toLngLat(),vt=this.locationCoordinate(kt),at=this.locationCoordinate(Nt),$t=this.locationCoordinate(Dt),vn=Math.hypot(at.x-vt.x,at.y-vt.y),mn=Math.hypot($t.x-vt.x,$t.y-vt.y);return Math.sqrt(vn*mn)*pe/25e-6},xe=Be=>{const Je=Ce,ct=Ae;return{aabb:a.aQ(this,F,0,0,0,Be,ct,Je,this.projection),zoom:0,x:0,y:0,minZ:ct,maxZ:Je,wrap:Be,fullyVisible:!1}},Re=[];let Ge=[];const Te=d,We=l.reparseOverscaled?v:d,qe=Be=>Be*Be,dt=qe((ae-this._centerAltitude)*oe),mt=Be=>{if(!this._elevation||!Be.tileID||!P)return;const Je=this._elevation.getMinMaxForTile(Be.tileID),ct=Be.aabb;Je?(ct.min[2]=Je.min,ct.max[2]=Je.max,ct.center[2]=(ct.min[2]+ct.max[2])/2):(Be.shouldSplit=ft(Be),Be.shouldSplit||(ct.min[2]=ct.max[2]=ct.center[2]=this._centerAltitude))},ft=Be=>{if(Be.zoom<ye)return!0;if(Be.zoom===Te)return!1;if(Be.shouldSplit!=null)return Be.shouldSplit;const Je=Be.aabb.distanceX(se),ct=Be.aabb.distanceY(se);let Ot=dt,kt=1;if(Z){Ot=qe(Be.aabb.distanceZ(se));const vt=Math.pow(2,Be.zoom),at=a.ay((Be.y+1)/vt),$t=a.ay(Be.y/vt),vn=Math.min(Math.max(L,at),$t),mn=a.b4(vn)/a.b4(L);if(kt=vn===L?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,mn/this._mercatorScaleRatio),this.zoom<=a.b1&&Be.zoom===Te-1&&mn>=.9)return!0}else if(T&&(Ot=qe(Be.aabb.distanceZ(se)*oe)),this.projection.isReprojectedInTileSpace&&v<=5){const vt=Math.pow(2,Be.zoom),at=_e(new a.Y((Be.x+.5)/vt,(Be.y+.5)/vt));kt=at>.85?1:at}const Nt=Je*Je+ct*ct+Ot,Dt=qe((1<<Te-Be.zoom)*ge*kt*((vt,at)=>{if(at*qe(.707)<vt)return 1;const $t=Math.sqrt(at/vt);return $t/(1.4144271570014144+(Math.pow(1.1,$t-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ot,dt),Nt));return Nt<Dt};if(this.renderWorldCopies)for(let Be=1;Be<=3;Be++)Re.push(xe(-Be)),Re.push(xe(Be));for(Re.push(xe(0));Re.length>0;){const Be=Re.pop(),Je=Be.x,ct=Be.y;let Ot=Be.fullyVisible;const kt=()=>this.projection.name==="globe"&&(Be.y===0||Be.y===(1<<Be.zoom)-1);if(!Ot){let Nt=me?Be.aabb.intersects(J):Be.aabb.intersectsFlat(J);if(Nt===0&&kt()){const Dt=new a.aO(Be.zoom,Je,ct);Nt=a.aP(this,F,Dt,!0).intersects(J)}if(Nt===0)continue;Ot=Nt===2}if(Be.zoom!==Te&&ft(Be))for(let Nt=0;Nt<4;Nt++){const Dt=(Je<<1)+Nt%2,vt=(ct<<1)+(Nt>>1),at={aabb:P?Be.aabb.quadrant(Nt):a.aQ(this,F,Be.zoom+1,Dt,vt,Be.wrap,Be.minZ,Be.maxZ,this.projection),zoom:Be.zoom+1,x:Dt,y:vt,wrap:Be.wrap,fullyVisible:Ot,tileID:void 0,shouldSplit:void 0,minZ:Be.minZ,maxZ:Be.maxZ};T&&!Z&&(at.tileID=new a.aL(Be.zoom+1===Te?We:Be.zoom+1,Be.wrap,Be.zoom+1,Dt,vt),mt(at)),Re.push(at)}else{const Nt=Be.zoom===Te?We:Be.zoom;if(l.minzoom&&l.minzoom>Nt)continue;if(!Ot){let $t=me?Be.aabb.intersectsPrecise(J):Be.aabb.intersectsPreciseFlat(J);if($t===0&&kt()){const vn=new a.aO(Be.zoom,Je,ct);$t=a.aP(this,F,vn,!0).intersectsPrecise(J)}if($t===0)continue}const Dt=V[0]-(.5+Je+(Be.wrap<<Be.zoom))*(1<<d-Be.zoom),vt=V[1]-.5-ct,at=Be.tileID?Be.tileID:new a.aL(Nt,Be.wrap,Be.zoom,Je,ct);Ge.push({tileID:at,distanceSq:Dt*Dt+vt*vt})}}if(this.fogCullDistSq){const Be=this.fogCullDistSq,Je=this.horizonLineFromTop();Ge=Ge.filter(ct=>{const Ot=[0,0,0,1],kt=[a.a3,a.a3,0,1],Nt=this.calculateFogTileMatrix(ct.tileID.toUnwrapped());a.aA.transformMat4(Ot,Ot,Nt),a.aA.transformMat4(kt,kt,Nt);const Dt=a.aA.min([],Ot,kt),vt=a.aA.max([],Ot,kt),at=a.aR(Dt,vt);if(at===0)return!0;let $t=!1;const vn=this._elevation;if(vn&&at>Be&&Je!==0){const mn=this.calculateProjMatrix(ct.tileID.toUnwrapped());let On;l.isTerrainDEM||(On=vn.getMinMaxForTile(ct.tileID)),On||(On={min:Ae,max:Ce});const Nn=a.b2(this.rotation),lr=[Nn[0]*a.a3,Nn[1]*a.a3,On.max];a._.transformMat4(lr,lr,mn),$t=(1-lr[1])*this.height*.5<Je}return at<Be||$t})}return Ge.sort((Be,Je)=>Be.distanceSq-Je.distanceSq).map(Be=>Be.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=a.at(l.lat,-a.aS,a.aS),v=this.projection.project(l.lng,d);return new a.P(v.x*this.worldSize,v.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.ax(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,d){let v,S;const T=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;v=(d.x-T.x)/I,S=(d.y-T.y)/I}else{const I=this.pointCoordinate(d),L=this.pointCoordinate(T);v=I.x-L.x,S=I.y-L.y}const P=this.locationCoordinate(l);this.setLocation(new a.Y(P.x-v,P.y-S))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,d){const v=d?a.ax(d,l.lat):void 0,S=this.projection.project(l.lng,l.lat);return new a.Y(S.x,S.y,v)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,d){const v=d??this._centerAltitude,S=[l.x,l.y,0,1],T=[l.x,l.y,1,1];a.aA.transformMat4(S,S,this.pixelMatrixInverse),a.aA.transformMat4(T,T,this.pixelMatrixInverse);const P=T[3];a.aA.scale(S,S,1/S[3]),a.aA.scale(T,T,1/P);const I=S[2],L=T[2];return{p0:S,p1:T,t:I===L?0:(v-I)/(L-I)}}screenPointToMercatorRay(l){const d=[l.x,l.y,0,1],v=[l.x,l.y,1,1];return a.aA.transformMat4(d,d,this.pixelMatrixInverse),a.aA.transformMat4(v,v,this.pixelMatrixInverse),a.aA.scale(d,d,1/d[3]),a.aA.scale(v,v,1/v[3]),d[2]=a.ax(d[2],this._center.lat)*this.worldSize,v[2]=a.ax(v[2],this._center.lat)*this.worldSize,a.aA.scale(d,d,1/this.worldSize),a.aA.scale(v,v,1/this.worldSize),new a.aT([d[0],d[1],d[2]],a._.normalize([],a._.sub([],v,d)))}rayIntersectionCoordinate(l){const{p0:d,p1:v,t:S}=l,T=a.ax(d[2],this._center.lat),P=a.ax(v[2],this._center.lat);return new a.Y(a.a2(d[0],v[0],S)/this.worldSize,a.a2(d[1],v[1],S)/this.worldSize,a.a2(T,P,S))}pointCoordinate(l,d=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,d)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let d=this.projection.pointCoordinate3D(this,l.x,l.y);if(d)return new a.Y(d[0],d[1],d[2]);let v=0,S=this.horizonLineFromTop();if(l.y>S)return this.pointCoordinate(l);const T=.02*S,P=l.clone();for(let I=0;I<10&&S-v>T;I++){P.y=a.a2(v,S,.66);const L=this.projection.pointCoordinate3D(this,P.x,P.y);L?(S=P.y,d=L):v=P.y}return d?new a.Y(d[0],d[1],d[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=a.aU)return!this.isPointAboveHorizon(l);const d=this.pointCoordinate(l);return d.y>=0&&d.y<=1}_coordinatePoint(l,d){const v=d&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,S=[l.x*this.worldSize,l.y*this.worldSize,v+l.toAltitude(),1];return a.aA.transformMat4(S,S,this.pixelMatrix),S[3]>0?new a.P(S[0]/S[3],S[1]/S[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:d}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,T=this.pointLocation3D(new a.P(d,l)),P=this.pointLocation3D(new a.P(S,l)),I=this.pointLocation3D(new a.P(S,v)),L=this.pointLocation3D(new a.P(d,v));let F=Math.min(T.lng,P.lng,I.lng,L.lng),V=Math.max(T.lng,P.lng,I.lng,L.lng),Z=Math.min(T.lat,P.lat,I.lat,L.lat),Q=Math.max(T.lat,P.lat,I.lat,L.lat);const J=Math.pow(2,-this.zoom)/16*270,ie=this.projection.name==="globe"?1:4,oe=(ae,se,me,ge,ye)=>{const Ce=(ae+me)/2,Ae=(se+ge)/2,pe=new a.P(Ce,Ae),{lng:_e,lat:xe}=this.pointLocation3D(pe),Re=Math.max(0,F-_e,Z-xe,_e-V,xe-Q);F=Math.min(F,_e),V=Math.max(V,_e),Z=Math.min(Z,xe),Q=Math.max(Q,xe),(ye<ie||Re>J)&&(oe(ae,se,Ce,Ae,ye+1),oe(Ce,Ae,me,ge,ye+1))};if(oe(d,l,S,l,1),oe(S,l,S,v,1),oe(S,v,d,v,1),oe(d,v,d,l,1),this.projection.name==="globe"){const[ae,se]=a.aV(this);ae?(Q=90,V=180,F=-180):se&&(Z=-90,V=180,F=-180)}return new a.ai(new a.aI(F,Z),new a.aI(V,Q))}_getBoundsRectangular(l,d){const{top:v,left:S}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,I=new a.P(S,v),L=new a.P(P,v),F=new a.P(P,T),V=new a.P(S,T);let Z=this.pointCoordinate(I,l),Q=this.pointCoordinate(L,l);const J=this.pointCoordinate(F,d),ie=this.pointCoordinate(V,d),oe=(ae,se)=>(se.y-ae.y)/(se.x-ae.x);return Z.y>1&&Q.y>=0?Z=new a.Y((1-ie.y)/oe(ie,Z)+ie.x,1):Z.y<0&&Q.y<=1&&(Z=new a.Y(-ie.y/oe(ie,Z)+ie.x,0)),Q.y>1&&Z.y>=0?Q=new a.Y((1-J.y)/oe(J,Q)+J.x,1):Q.y<0&&Z.y<=1&&(Q=new a.Y(-J.y/oe(J,Q)+J.x,0)),new a.ai().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(J))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=l.visibleDemTiles.reduce((v,S)=>{if(S.dem){const T=S.dem.tree;v.min=Math.min(v.min,T.minimums[0]),v.max=Math.max(v.max,T.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*l.exaggeration(),d.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,v=this.height/2-d*(1-this._horizonShift);return l?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-a.aS,this.maxLat=a.aS,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.aj(this.minLng)*this.tileSize,this.worldMaxX=a.aj(this.maxLng)*this.tileSize,this.worldMinY=a.ak(this.maxLat)*this.tileSize,this.worldMaxY=a.ak(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,d){return this.projection.createTileMatrix(this,d,l)}calculateDistanceTileData(l){const d=l.key,v=this._distanceTileDataCache;if(v[d])return v[d];const S=l.canonical,T=1/this.height,P=this.cameraWorldSize,I=P/this.zoomScale(S.z),L=(S.x+Math.pow(2,S.z)*l.wrap)*I,F=S.y*I,V=this.point;V.x*=P/this.worldSize,V.y*=P/this.worldSize;const Z=this.angle,Q=Math.sin(-Z),J=-Math.cos(-Z);return v[d]={bearing:[Q,J],center:[(V.x-L)*T,(V.y-F)*T],scale:I/a.a3*T},v[d]}calculateFogTileMatrix(l){const d=l.key,v=this._fogTileMatrixCache;if(v[d])return v[d];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return a.ad.multiply(S,this.worldToFogMatrix,S),v[d]=new Float32Array(S),v[d]}calculateProjMatrix(l,d=!1,v=!1){const S=l.key;let T;if(T=v?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,T[S])return T[S];const P=this.calculatePosMatrix(l,this.worldSize);let I;return I=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:v?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,a.ad.multiply(P,I,P),T[S]=new Float32Array(P),T[S]}calculatePixelsToTileUnitsMatrix(l){const d=l.tileID.key,v=this._pixelsToTileUnitsCache;if(v[d])return v[d];const S=a.aW(l,this);return v[d]=S,v[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const l=1/this.worldSize,d=a.ad.fromScaling([],[l,l,l]);return a.ad.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const l=this._elevation;this._updateCameraState();const d=a.ax(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(d),S=this._camera.forward(),T=a.ax(1,this._center.lat);v[2]/=T,S[2]/=T,a._.normalize(S,S);const P=l.raycast(v,S,l.exaggeration());if(P){const I=a._.scaleAndAdd([],v,S,P),L=new a.Y(I[0],I[1],a.ax(I[2],a.ay(I[1]))),F=(L.z+a._.length([L.x-v[0],L.y-v[1],L.z-v[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(F),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const d=this._elevation,v=a.ax(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(v),T=d.getAtPointOrZero(new a.Y(...S)),P=this.pixelsPerMeter/this.worldSize*T,I=this._minimumHeightOverTerrain(),L=S[2]-P;if(L<=I)if(L<0||l){const F=this.locationCoordinate(this._center,this._centerAltitude),V=[S[0],S[1],F.z-S[2]],Z=a._.length(V);V[2]-=(I-L)/this._pixelsPerMercatorPixel;const Q=a._.length(V);if(Q===0)return;a._.scale(V,V,Z/Q*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],F.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const Q=this.center;return Q.lat=a.at(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(Q.lng=a.at(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const d=this._unmodified,{x:v,y:S}=this.point;let T=0,P=v,I=S;const L=this.width/2,F=this.height/2,V=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(S-F<V&&(I=V+F),S+F>Z&&(I=Z-F),Z-V<this.height&&(T=Math.max(T,this.height/(Z-V)),I=(Z+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,J=this.worldMaxX*this.scale,ie=this.worldSize/2-(Q+J)/2;P=(v+ie+this.worldSize)%this.worldSize-ie,P-L<Q&&(P=Q+L),P+L>J&&(P=J-L),J-Q<this.width&&(T=Math.max(T,this.width/(J-Q)),P=(J+Q)/2)}P===v&&I===S||(this.center=this.unproject(new a.P(P,I))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.projection.name==="globe",v=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.ax(1,this.center.lat)/a.ax(1,a.b3));const S=a.aX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?v:1,P=this._camera.getWorldToCamera(this.worldSize,T);let I;const L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(L[8]=2*-l.x/this.width,L[9]=2*l.y/this.height,this.isOrthographic){let xe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Re=xe*this.aspect,Ge=-Re,Te=-xe;Re-=l.x,Ge-=l.x,xe+=l.y,Te+=l.y,I=this._camera.getCameraToClipOrthographic(Ge,Re,Te,xe,this._nearZ,this._farZ),((We,qe,dt,mt)=>{for(let ft=0;ft<16;ft++)We[ft]=Cy(qe[ft],dt[ft],mt)})(I,I,L,Qr(this.pitch>=15?1:this.pitch/15))}else I=L;const F=a.ad.mul([],L,P);let V=a.ad.mul([],I,P);if(this.projection.isReprojectedInTileSpace){const xe=this.locationCoordinate(this.center),Re=a.ad.identity([]);a.ad.translate(Re,Re,[xe.x*this.worldSize,xe.y*this.worldSize,0]),a.ad.multiply(Re,Re,a.aY(this)),a.ad.translate(Re,Re,[-xe.x*this.worldSize,-xe.y*this.worldSize,0]),a.ad.multiply(V,V,Re),a.ad.multiply(F,F,Re),this.inverseAdjustmentMatrix=a.aZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.ad.scale([],V,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=V,this.invProjMatrix=a.ad.invert(new Float64Array(16),this.projMatrix),d){const xe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);xe[8]=2*-l.x/this.width,xe[9]=2*l.y/this.height,this.expandedFarZProjMatrix=a.ad.mul([],xe,P)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=a.ad.invert([],I);this.frustumCorners=a.a_.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const Q=new Float32Array(16);a.ad.identity(Q),a.ad.scale(Q,Q,[1,-1,1]),a.ad.rotateX(Q,Q,this._pitch),a.ad.rotateZ(Q,Q,this.angle);const J=a.ad.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.ad.clone(J);const ie=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;J[8]=2*-l.x/this.width,J[9]=2*(l.y+ie)/this.height,this.skyboxMatrix=a.ad.multiply(Q,J,Q);const oe=this.point,ae=oe.x,se=oe.y,me=this.width%2/2,ge=this.height%2/2,ye=Math.cos(this.angle),Ce=Math.sin(this.angle),Ae=ae-Math.round(ae)+ye*me+Ce*ge,pe=se-Math.round(se)+ye*ge+Ce*me,_e=new Float64Array(V);if(a.ad.translate(_e,_e,[Ae>.5?Ae-1:Ae,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=_e,V=a.ad.create(),a.ad.scale(V,V,[this.width/2,-this.height/2,1]),a.ad.translate(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=a.ad.create(),a.ad.scale(V,V,[1,-1,1]),a.ad.translate(V,V,[-1,-1,0]),a.ad.scale(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=a.ad.multiply(new Float64Array(16),this.labelPlaneMatrix,F),this._calcFogMatrices(),this._distanceTileDataCache={},V=a.ad.invert(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=V,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.a$(this);const xe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a._.transformMat4(xe,xe,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=V;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,v=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,T=[l,l,d];a._.scale(T,T,S),a._.scale(v,v,-1),a._.multiply(v,v,T);const P=a.ad.create();a.ad.translate(P,P,v),a.ad.scale(P,P,T),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,d,S)}_computeCameraPosition(l){const d=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),S=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-l/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-v[0]*T,S.y/this.worldSize-v[1]*T,l/this.worldSize*this._centerAltitude-v[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],S=l[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(T=Math.min((d-v)/S,1)),this._camera.position=a._.scaleAndAdd([],this._camera.position,l,T),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,d=this._camera.forward(),{pitch:v,bearing:S}=this._camera.getPitchBearing(),T=a.ax(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.ab(this._maxPitch)),I=Math.max((l[2]-T)/Math.cos(v),P),L=this._zoomFromMercatorZ(I);a._.scaleAndAdd(l,l,d,I),this._pitch=a.at(v,a.ab(this.minPitch),a.ab(this.maxPitch)),this.angle=a.au(S,-Math.PI,Math.PI),this._setZoom(a.at(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.Y(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let d=0,v=a.aU,S=0,T=1/0;for(;v-d>1e-6&&v>d;){const P=d+.5*(v-d),I=this.tileSize*Math.pow(2,P),L=this.getCameraToCenterDistance(this.projection,P,I),F=this.scaleZoom(L/(l*this.tileSize)),V=Math.abs(P-F);V<T&&(T=V,S=P),P<F?d=P:v=P}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,d){const v=Math.min(l.x,d.x),S=Math.max(l.x,d.x),T=Math.min(l.y,d.y),P=Math.max(l.y,d.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new a.P(v,T),new a.P(S,P),new a.P(v,P),new a.P(S,T)],L=this.renderWorldCopies?-3:0,F=this.renderWorldCopies?4:1;for(const V of I){const Z=this.pointRayIntersection(V);if(Z.t<0)return!0;const Q=this.rayIntersectionCoordinate(Z);if(Q.x<L||Q.y<0||Q.x>F||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.b0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(l,d){const v=a._.length(a._.sub([],this._camera.position,l)),S=this._zoomFromMercatorZ(v)+d;return v-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const l=function([d,v,S],T){const P=[d,v,S,1];a.aA.transformMat4(P,P,T);const I=P[3]=Math.max(P[3],1e-6);return P[0]/=I,P[1]/=I,P[2]/=I,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,l))}}getCameraToCenterDistance(l,d=this.zoom,v=this.worldSize){const S=a.aX(l,d,this.width,this.height,1024),T=l.pixelSpaceConversion(this.center.lat,v,S);let P=.5/Math.tan(.5*this._fov)*this.height*T;return this.isOrthographic&&(P=Cy(1,P,Qr(this.pitch>=15?1:this.pitch/15))),P}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.ad.multiply(l,l,this.globeMatrix),l}getFrustum(l){return a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,this.projection.zAxisUnit==="meters")}}const io={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},Ps=(y,l)=>{if(l>0&&y.terrain&&a.w("Cutoff is currently disabled on terrain"),l<=0||y.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=y.transform,v=Math.max(Math.abs(d._zoom-(y.minCutoffZoom-1)),1),S=d.isLODDisabled(!1)?a.$(60,45,d.pitch):a.$(30,15,d.pitch),T=d._farZ-d._nearZ,P=l*d.height,I=((1-(L=S))*d.cameraToCenterDistance+L*(d._farZ+P))*v;var L;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(I-d._nearZ)/T,(I-P-d._nearZ)/T]}}},ki={cascadeCount:2,shadowMapResolution:2048};class Py{constructor(l,d){this.aabb=l,this.lastCascade=d}}class My{add(l,d){const v=this.receivers[l.key];v!==void 0?(v.aabb.min[0]=Math.min(v.aabb.min[0],d.min[0]),v.aabb.min[1]=Math.min(v.aabb.min[1],d.min[1]),v.aabb.min[2]=Math.min(v.aabb.min[2],d.min[2]),v.aabb.max[0]=Math.max(v.aabb.max[0],d.max[0]),v.aabb.max[1]=Math.max(v.aabb.max[1],d.max[1]),v.aabb.max[2]=Math.max(v.aabb.max[2],d.max[2])):this.receivers[l.key]=new Py(d,null)}clear(){this.receivers={}}get(l){return this.receivers[l.key]}computeRequiredCascades(l,d,v){const S=a.b6.fromPoints(l.points);let T=0;for(const P in this.receivers){const I=this.receivers[P];if(!I||!S.intersectsAabb(I.aabb))continue;I.aabb.min=S.closestPoint(I.aabb.min),I.aabb.max=S.closestPoint(I.aabb.max);const L=I.aabb.getCorners();for(let F=0;F<v.length;F++){let V=!0;for(const Z of L){const Q=[Z[0]*d,Z[1]*d,Z[2]];if(a._.transformMat4(Q,Q,v[F].matrix),Q[0]<-1||Q[0]>1||Q[1]<-1||Q[1]>1){V=!1;break}}if(I.lastCascade=F,T=Math.max(T,F),V)break}}return T+1}}class cp{constructor(l){this.painter=l,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new My,this._depthMode=new a.ae(l.context.gl.LEQUAL,a.ae.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,l.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),l.tp.registerParameter(ki,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),l.tp.registerParameter(ki,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),l.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const l of this._cascades)l.texture.destroy(),l.framebuffer.destroy();this._cascades=[]}updateShadowParameters(l,d){const v=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const S=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||S<=0||(this._shadowLayerCount=v.style.order.reduce((ie,oe)=>{const ae=v.style._mergedLayers[oe];return ie+(ae.hasShadowPass()&&!ae.isHidden(l.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const T=v.context,P=ki.shadowMapResolution,I=ki.shadowMapResolution;if(this._cascades.length===0||ki.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ie=0;ie<ki.cascadeCount;++ie){const oe=v._shadowMapDebug,ae=T.gl,se=T.createFramebuffer(P,I,oe,"texture"),me=new a.T(T,{width:P,height:I,data:null},ae.DEPTH_COMPONENT);if(se.depthAttachment.set(me.texture),oe){const ge=new a.T(T,{width:P,height:I,data:null},ae.RGBA);se.colorAttachment.set(ge.texture)}this._cascades.push({framebuffer:se,texture:me,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.aM,scale:0})}}this.shadowDirection=hf(d);let L=0;if(l.elevation){const ie=l.elevation,oe=[1e4,-1e4];ie.visibleDemTiles.filter(ae=>ae.dem).forEach(ae=>{const se=ae.dem.tree;oe[0]=Math.min(oe[0],se.minimums[0]),oe[1]=Math.max(oe[1],se.maximums[0])}),oe[0]!==1e4&&(L=(oe[1]-oe[0])*ie.exaggeration())}const F=1.5*l.cameraToCenterDistance,V=3*F,Z=new Float64Array(16);for(let ie=0;ie<this._cascades.length;++ie){const oe=this._cascades[ie];let ae=l.height/50,se=1;ki.cascadeCount===1?se=V:ie===0?se=F:(ae=F,se=V);const[me,ge]=ff(l,this.shadowDirection,ae,se,ki.shadowMapResolution,L);oe.scale=l.scale,oe.matrix=me,oe.boundingSphereRadius=ge,a.ad.invert(Z,oe.matrix),oe.frustum=a.aM.fromInvProjectionMatrix(Z,1,0,!0),oe.far=se}const Q=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Q].far,this._cascades[Q].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ki.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ki.shadowMapResolution,this._uniformValues.u_shadowmap_0=io.ShadowMap0,this._uniformValues.u_shadowmap_1=io.ShadowMap0+1,this._groundShadowTiles=v.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const J=v.transform.elevation;for(const ie of this._groundShadowTiles){let oe={min:0,max:0};if(J){const ae=J.getMinMaxForTile(ie);ae&&(oe=ae)}this.addShadowReceiver(ie.toUnwrapped(),oe.min,oe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(l){this._enabled=l}drawShadowPass(l,d){if(!this.enabled)return;const v=this.painter,S=v.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(v.transform.getFrustum(0),v.transform.worldSize,this._cascades),S.viewport.set([0,0,ki.shadowMapResolution,ki.shadowMapResolution]);for(let T=0;T<this._numCascadesToRender;++T){v.currentShadowCascade=T,S.bindFramebuffer.set(this._cascades[T].framebuffer.framebuffer),S.clear({color:a.C.white,depth:1});for(const P of l.order){const I=l._mergedLayers[P];if(!I.hasShadowPass()||I.isHidden(v.transform.zoom))continue;const L=l.getLayerSourceCache(I),F=L?d[L.id]:void 0;(I.type==="model"||F&&F.length)&&v.renderLayer(v,L,I,F)}}v.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const l=this.painter,d=l.style,v=l.context,S=d.directionalLight,T=d.ambientLight;if(!S||!T)return;const P=[],I=Ps(l,l.longestCutoffRange);I.shouldRenderCutoff&&P.push("RENDER_CUTOFF");const L=Ms(d,S,T),F=new a.ae(v.gl.LEQUAL,a.ae.ReadOnly,l.depthRangeFor3D);for(const V of this._groundShadowTiles){const Z=V.toUnwrapped(),Q=l.isTileAffectedByFog(V),J=l.getOrCreateProgram("groundShadow",{defines:P,overrideFog:Q});this.setupShadows(Z,J),l.uploadCommonUniforms(v,J,Z,null,I);const ie={u_matrix:l.transform.calculateProjMatrix(Z),u_ground_shadow_factor:L};J.draw(l,v.gl.TRIANGLES,F,a.ag.disabled,a.a.multiply,a.af.disabled,ie,"ground_shadow",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments,{},l.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?a.a.unblended:a.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(l){const d=this.painter.transform,v=d.calculatePosMatrix(l,d.worldSize);return a.ad.multiply(v,this._cascades[this.painter.currentShadowCascade].matrix,v),Float32Array.from(v)}calculateShadowPassMatrixFromMatrix(l){return a.ad.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}setupShadows(l,d,v,S=0){if(!this.enabled)return;const T=this.painter.transform,P=this.painter.context,I=P.gl,L=this._uniformValues,F=new Float64Array(16),V=T.calculatePosMatrix(l,T.worldSize);for(let Z=0;Z<this._cascades.length;Z++)a.ad.multiply(F,this._cascades[Z].matrix,V),L[Z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(F),P.activeTexture.set(I.TEXTURE0+io.ShadowMap0+Z),this._cascades[Z].texture.bind(I.NEAREST,I.CLAMP_TO_EDGE);if(this.useNormalOffset=!!v,this.useNormalOffset){const Z=a.b5(l.canonical),Q=2/T.tileSize*a.a3/ki.shadowMapResolution,J=Q*this._cascades[0].boundingSphereRadius,ie=Q*this._cascades[this._cascades.length-1].boundingSphereRadius,oe=(v==="vector-tile"?1:3)/Math.pow(2,S-l.canonical.z-(1-T.zoom+Math.floor(T.zoom)));L.u_shadow_normal_offset=[Z,J*oe,ie*oe],L.u_shadow_bias=[6e-5,.0012,.012]}else L.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(P,L)}setupShadowsFromMatrix(l,d,v=!1){if(!this.enabled)return;const S=this.painter.context,T=S.gl,P=this._uniformValues,I=new Float64Array(16);for(let L=0;L<ki.cascadeCount;L++)a.ad.multiply(I,this._cascades[L].matrix,l),P[L===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),S.activeTexture.set(T.TEXTURE0+io.ShadowMap0+L),this._cascades[L].texture.bind(T.NEAREST,T.CLAMP_TO_EDGE);this.useNormalOffset=v,v?(P.u_shadow_normal_offset=[1,5,5],P.u_shadow_bias=[6e-5,.0012,.012]):P.u_shadow_bias=[36e-5,.0012,.012],d.setShadowUniformValues(S,P)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(l,d,v,S){if(S[2]>=0)return{};const T=function(L,F,V){const Z=V/(1<<L.canonical.z);return new a.b6([L.canonical.x*Z+L.wrap*V,L.canonical.y*Z+L.wrap*V,0],[(L.canonical.x+1)*Z+L.wrap*V,(L.canonical.y+1)*Z+L.wrap*V,F])}(l,d,v).getCorners(),P=d/-S[2];S[0]<0?(a._.add(T[0],T[0],[S[0]*P,0,0]),a._.add(T[3],T[3],[S[0]*P,0,0])):S[0]>0&&(a._.add(T[1],T[1],[S[0]*P,0,0]),a._.add(T[2],T[2],[S[0]*P,0,0])),S[1]<0?(a._.add(T[0],T[0],[0,S[1]*P,0]),a._.add(T[1],T[1],[0,S[1]*P,0])):S[1]>0&&(a._.add(T[2],T[2],[0,S[1]*P,0]),a._.add(T[3],T[3],[0,S[1]*P,0]));const I={};return I.vertices=T,I.planes=[yc(T[1],T[0],T[4]),yc(T[2],T[1],T[5]),yc(T[3],T[2],T[6]),yc(T[0],T[3],T[7])],I}addShadowReceiver(l,d,v){this._receivers.add(l,a.b6.fromTileIdAndHeight(l,d,v))}getMaxCascadeForTile(l){const d=this._receivers.get(l);return d&&d.lastCascade?d.lastCascade:0}}function yc(y,l,d){const v=a._.sub([],d,l),S=a._.sub([],y,l),T=a._.cross([],v,S),P=a._.length(T);return P===0?[0,0,1,0]:(a._.scale(T,T,1/P),[T[0],T[1],T[2],-a._.dot(T,l)])}function hf(y){const l=y.properties.get("direction"),d=a.ac(l.x,l.y,l.z);d[2]=a.at(d[2],0,75);const v=a.b7([d[0],d[1],d[2]]);return a._.fromValues(v.x,v.y,v.z)}function Ms(y,l,d){const v=l.properties.get("color"),S=l.properties.get("intensity"),T=l.properties.get("direction"),P=[T.x,T.y,T.z],I=d.properties.get("color"),L=d.properties.get("intensity"),F=Math.max(a._.dot([0,0,1],P),0),V=[0,0,0];a._.scale(V,I.toRenderColor(y.getLut(l.scope)).toArray01Linear().slice(0,3),L);const Z=[0,0,0];return a._.scale(Z,v.toRenderColor(y.getLut(d.scope)).toArray01Linear().slice(0,3),F*S),a.b8([V[0]>0?V[0]/(V[0]+Z[0]):0,V[1]>0?V[1]/(V[1]+Z[1]):0,V[2]>0?V[2]/(V[2]+Z[2]):0])}function ff(y,l,d,v,S,T){const P=y.zoom,I=y.scale,L=y.worldSize,F=1/L,V=y.aspect,Z=Math.sqrt(1+V*V)*Math.tan(.5*y.fovX),Q=Z*Z,J=v-d,ie=v+d;let oe,ae;Q>J/ie?(oe=v,ae=v*Z):(oe=.5*ie*(1+Q),ae=.5*Math.sqrt(J*J+2*(v*v+d*d)*Q+ie*ie*Q*Q));const se=y.projection.pixelsPerMeter(y.center.lat,L),me=y._camera.getCameraToWorldMercator(),ge=[0,0,-oe*F];a._.transformMat4(ge,ge,me);let ye=ae*F;const Ce=y._edgeInsets;if(!(Ce.left===0&&Ce.top===0&&Ce.right===0&&Ce.bottom===0||Ce.left===Ce.right&&Ce.top===Ce.bottom)){const Ot=y._camera.getWorldToCamera(y.worldSize,y.projection.zAxisUnit==="meters"?se:1),kt=y._camera.getCameraToClipPerspective(y._fov,y.width/y.height,d,v);kt[8]=2*-y.centerOffset.x/y.width,kt[9]=2*y.centerOffset.y/y.height;const Nt=new Float64Array(16);a.ad.mul(Nt,kt,Ot);const Dt=new Float64Array(16);a.ad.invert(Dt,Nt);const vt=a.aM.fromInvProjectionMatrix(Dt,L,P,!0);for(const at of vt.points){const $t=((Ae=at)[0]/=I,Ae[1]/=I,Ae[2]=a.ax(Ae[2],y._center.lat),Ae);ye=Math.max(ye,a._.len(a._.subtract([],ge,$t)))}}var Ae;ye*=S/(S-1);const pe=Math.acos(l[2]),_e=Math.atan2(-l[0],-l[1]),xe=new uf;xe.position=ge,xe.setPitchBearing(pe,_e);const Re=xe.getWorldToCamera(L,se),Ge=ye*L,Te=Math.min(y._mercatorZfromZoom(17)*L*-2,-2*Ge),We=xe.getCameraToClipOrthographic(-Ge,Ge,-Ge,Ge,Te,(Ge+T*se)/l[2]),qe=new Float64Array(16);a.ad.multiply(qe,We,Re);const dt=a._.fromValues(Math.floor(1e6*ge[0])/1e6*L,Math.floor(1e6*ge[1])/1e6*L,0),mt=.5*S,ft=[0,0,0];a._.transformMat4(ft,dt,qe),a._.scale(ft,ft,mt);const Be=[Math.floor(ft[0]),Math.floor(ft[1]),Math.floor(ft[2])],Je=[0,0,0];a._.sub(Je,ft,Be),a._.scale(Je,Je,-1/mt);const ct=new Float64Array(16);return a.ad.identity(ct),a.ad.translate(ct,ct,Je),a.ad.multiply(qe,ct,qe),[qe,Ge]}function hp(y,l){return y!=null&&l!=null&&!(!y.hasData()||!l.hasData())&&y.demTexture!=null&&l.demTexture!=null&&y.tileID.key!==l.tileID.key}const tu=new class{constructor(){this.operations={}}newMorphing(y,l,d,v,S){if(y in this.operations){const T=this.operations[y];T.to.tileID.key!==d.tileID.key&&(T.queued=d)}else this.operations[y]={startTime:v,phase:0,duration:S,from:l,to:d,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const l=this.operations[y];return{from:l.from,to:l.to,phase:l.phase}}update(y){for(const l in this.operations){const d=this.operations[l];for(d.phase=(y-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,y)){delete this.operations[l];break}}}_nextOp(y,l){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=l,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},df={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Iy(y,l,d){if(l===0)return 0;const v=l<1&&d===514?.25/l:1;return 6*Math.pow(1.5,22-y)*Math.max(l,1)*v}function Xx(y,l){const d=1<<y.z;return!l&&(y.x===0||y.x===d-1)||y.y===0||y.y===d-1}const fp=y=>({u_matrix:y});function dp(y,l,d,v,S){if(S>0){const T=a.e.now(),P=(T-y.timeAdded)/S,I=l?(T-l.timeAdded)/S:-1,L=d.getSource(),F=v.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),V=!l||Math.abs(l.tileID.overscaledZ-F)>Math.abs(y.tileID.overscaledZ-F),Z=V&&y.refreshedUponExpiration?1:a.at(V?P:1-I,0,1);return y.refreshedUponExpiration&&P>=1&&(y.refreshedUponExpiration=!1),l?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class _c extends sf{constructor(l,d,v,S){super(l,d,v,S),this.type="raster-array",this.maxzoom=22,this._options=a.W({type:"raster-array"},d)}triggerRepaint(l){const d=this.map.painter._terrain,v=this.map.style.getSourceCache(this.id);d&&d.enabled&&v&&d._clearRenderCacheForTile(v.id,l.tileID),this.map.triggerRepaint()}loadTile(l,d){const v=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(v,a.R.Tile);l.requestParams=S,l.actor||(l.actor=this.dispatcher.getActor()),l.request=l.fetchHeader(void 0,(T,P,I,L)=>{if(delete l.request,l.aborted)return l.state="unloaded",d(null);if(T)return T.code===20?void 0:(l.state="errored",d(T));this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:I,expires:L}),l.state="empty",d(null)})}unloadTile(l,d){const v=l.texture;v&&v instanceof a.T?(l.destroy(!0),this.map.painter.saveTileTexture(v)):(l.destroy(),l.flushQueues(),l._isHeaderLoaded=!1,delete l._mrt,delete l.textureDescriptor),l.fbo&&(l.fbo.destroy(),delete l.fbo),delete l.request,delete l.requestParams,delete l.neighboringTiles,l.state="unloaded"}prepareTile(l,d,v){l._isHeaderLoaded&&(l.state!=="empty"&&(l.state="reloading"),l.fetchBand(d,v,(S,T)=>{if(S)return l.state="errored",this.fire(new a.d(S)),void this.triggerRepaint(l);T&&(l.setTexture(T,this.map.painter),l.state="loaded",this.triggerRepaint(l))}))}getInitialBand(l){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:T})=>T===l),v=d&&d.fields,S=v&&v.bands&&v.bands;return S?S[0]:0}getTextureDescriptor(l,d,v){if(!l)return;const S=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let T=null;d instanceof a.bk?T=d.paint.get("raster-array-band"):d instanceof a.bl&&(T=d.paint.get("raster-particle-array-band"));const P=T||this.getInitialBand(S);if(P!=null)if(l.textureDescriptor){if(!l.updateNeeded(S,P)||v)return Object.assign({},l.textureDescriptor,{texture:l.texture})}else this.prepareTile(l,S,P)}}const Di={vector:ap,raster:sf,"raster-dem":class extends sf{constructor(y,l,d,v){super(y,l,d,v),this.type="raster-dem",this.maxzoom=22,this._options=a.W({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(y,l){const d=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(S,T){S&&(y.state="errored",l(S)),T&&(y.dem=T,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",l(null))}y.request=a.h(this.map._requestManager.transformRequest(d,a.R.Tile),(function(S,T,P,I){if(delete y.request,y.aborted)y.state="unloaded",l(null);else if(S)y.state="errored",l(S);else if(T){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:P,expires:I});const L=ImageBitmap&&T instanceof ImageBitmap&&a.bi(),F=1-(T.width-a.bj(T.width))/2;F<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const V=L?T:a.e.getImageData(T,F),Z={uid:y.uid,coord:y.tileID,source:this.id,scope:this.scope,rawImageData:V,encoding:this.encoding,padding:F};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadDEMTile",Z,v.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(y){const l=y.canonical,d=Math.pow(2,l.z),v=(l.x-1+d)%d,S=l.x===0?y.wrap-1:y.wrap,T=(l.x+1+d)%d,P=l.x+1===d?y.wrap+1:y.wrap,I={};return I[new a.aL(y.overscaledZ,S,l.z,v,l.y).key]={backfilled:!1},I[new a.aL(y.overscaledZ,P,l.z,T,l.y).key]={backfilled:!1},l.y>0&&(I[new a.aL(y.overscaledZ,S,l.z,v,l.y-1).key]={backfilled:!1},I[new a.aL(y.overscaledZ,y.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},I[new a.aL(y.overscaledZ,P,l.z,T,l.y-1).key]={backfilled:!1}),l.y+1<d&&(I[new a.aL(y.overscaledZ,S,l.z,v,l.y+1).key]={backfilled:!1},I[new a.aL(y.overscaledZ,y.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},I[new a.aL(y.overscaledZ,P,l.z,T,l.y+1).key]={backfilled:!1}),I}},"raster-array":_c,geojson:class extends a.E{constructor(y,l,d,v){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(v),this._data=l.data,this._options=a.W({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.minzoom!==void 0&&(this.minzoom=l.minzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const S=a.a3/this.tileSize;this.workerOptions=a.W({source:this.id,scope:this.scope,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*S,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*S,extent:a.a3,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:a.a3,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*S,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter,dynamic:l.dynamic},l.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}updateData(y){return this._options.dynamic?typeof y!="string"&&(y.type==="Feature"&&(y={type:"FeatureCollection",features:[y]}),y.type!=="FeatureCollection")?this.fire(new a.d(new Error("Data to update should be a feature or a feature collection."))):(this._coalesce&&typeof y!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"?this._data.features.push(...y.features):this._data=y,this._updateWorkerData(!0),this):this.fire(new a.d(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")))}getClusterExpansionZoom(y,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id,scope:this.scope},l),this}getClusterChildren(y,l){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id,scope:this.scope},l),this}getClusterLeaves(y,l,d,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:y,limit:l,offset:d},v),this}_updateWorkerData(y=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.f("dataloading",{dataType:"source"})),this._loaded=!1;const l=a.W({append:y},this.workerOptions);l.scope=this.scope;const d=this._data;typeof d=="string"?(l.request=this.map._requestManager.transformRequest(a.e.resolveURL(d),a.R.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(v,S)=>{if(this._loaded=!0,this._pendingLoad=null,v)this.fire(new a.d(v));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(T.resourceTiming=S.resourceTiming[this.id]),y&&(this._partialReload=!0),this.fire(new a.f("data",T)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(y),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(y,l){const d=y.actor?"reloadTile":"loadTile";y.actor=this.actor;const v=this.map.style?this.map.style.getLut(this.scope):null,S=this._partialReload,T={type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:v?{image:v.image.clone()}:null,scope:this.scope,pixelRatio:a.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:S};y.request=this.actor.send(d,T,(P,I)=>S&&!I?(y.state="loaded",l(null)):(delete y.request,y.destroy(),y.aborted?l(null):P?l(P):(y.loadVectorData(I,this.map.painter,d==="reloadTile"),l(null))),void 0,d==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y,l){this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id,scope:this.scope}),y.destroy()}onRemove(y){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.W({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.bm{constructor(y,l,d,v){super(y,l,d,v),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const l of y.urls)this.urls.push(this.map._requestManager.transformRequest(l,a.R.Source).url);a.bn(this.urls,(l,d)=>{this._loaded=!0,l?this.fire(new a.d(l)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const l=this.video.seekable;y<l.start(0)||y>l.end(0)?this.fire(new a.d(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,l=y.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(y,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.bm,model:class extends a.E{constructor(y,l,d,v){super(),this.id=y,this.type="model",this.models=[],this._loaded=!1,this._options=l}load(){const y=[];for(const l in this._options.models){const d=this._options.models[l],v=a.l(this.map._requestManager.transformRequest(d.uri,a.R.Model).url).then(S=>{if(!S)return;const T=a.c(S),P=new a.M(l,d.position,d.orientation,T);P.computeBoundsAndApplyParent(),this.models.push(P)}).catch(S=>{this.fire(new a.d(new Error(`Could not load model ${l} from ${d.uri}: ${S.message}`)))});y.push(v)}return Promise.allSettled(y).then(()=>{this._loaded=!0,this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(l=>{this.fire(new a.d(new Error(`Could not load models: ${l.message}`)))})}onAdd(y){this.map=y,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(y,l){}serialize(){return{type:"model"}}},"batched-model":class extends a.E{constructor(y,l,d,v){super(),this.type="batched-model",this.id=y,this.tileSize=512,this._options=l,this.tiles=this._options.tiles,this.maxzoom=l.maxzoom||19,this.minzoom=l.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(v)}onAdd(y){this.map=y,this.load()}load(y){this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map._worldview;this._tileJSONRequest=Sy(this._options,this.map._requestManager,l,d,(v,S)=>{this._tileJSONRequest=null,this._loaded=!0,v?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new a.d(v))):S&&(a.W(this,S),S.bounds&&(this.tileBounds=new af(S.bounds,this.minzoom,this.maxzoom)),a.an(S.tiles,this.map._requestManager._customAccessToken),this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))),y&&y(v)})}hasTransition(){return!1}hasTile(y){return!this.tileBounds||this.tileBounds.contains(y.canonical)}loaded(){return this._loaded}loadTile(y,l){const d=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(d,a.R.Tile),data:void 0,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,tileSize:this.tileSize*y.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:y.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(y.actor&&y.state!=="expired")if(y.state==="loading")y.reloadCallback=l;else{if(y.buckets){const T=Object.values(y.buckets);for(const P of T)P.dirty=!0;return void(y.state="loaded")}y.request=y.actor.send("reloadTile",v,S.bind(this))}else y.actor=this.dispatcher.getActor(),y.request=y.actor.send("loadTile",v,S.bind(this),void 0,!0);function S(T,P){return y.aborted?l(null):T&&T.status!==404?l(T):(P&&(P.resourceTiming&&(y.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&y.setExpiryData(P),y.buckets={...y.buckets,...P.buckets},P.featureIndex&&(y.latestFeatureIndex=P.featureIndex)),y.state="loaded",void l(null))}}serialize(){return a.W({},this._options)}},canvas:class extends a.bm{constructor(y,l,d,v){super(y,l,d,v),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(T=>typeof T!="number"))||this.fire(new a.d(new a.V(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.d(new a.V(`sources.${y}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new a.d(new a.V(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new a.d(new a.V(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.d(new a.V(`sources.${y}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.d(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(y){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context;this.texture?!y&&!this._playing||this.texture instanceof a.bo||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends a.E{constructor(y,l,d,v){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=l,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.d(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.d(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new af(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),a.W(this,a.ah(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.ah(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this._map=y,this._loaded=!1,this.fire(new a.f("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:l,y:d,z:v}=y.canonical;return this._implementation.hasTile({x:l,y:d,z:v})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,l){const{x:d,y:v,z:S}=y.tileID.canonical,T=new AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:d,y:v,z:S},{signal:T.signal})).then((function(P){return delete y.request,y.aborted?(y.state="unloaded",l(null)):P===void 0?(y.state="errored",l(null)):P===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",l(null)):function(I){return I instanceof ImageData||I instanceof HTMLCanvasElement||I instanceof ImageBitmap||I instanceof HTMLImageElement}(P)?(this.loadTileData(y,P),y.state="loaded",void l(null)):(y.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(P=>{P.code!==20&&(y.state="errored",l(P))}),y.request.cancel=()=>T.abort()}loadTileData(y,l){y.setTexture(l,this._map.painter)}unloadTile(y,l){if(y.texture&&y.texture instanceof a.T?(y.destroy(!0),y.texture&&y.texture instanceof a.T&&this._map.painter.saveTileTexture(y.texture)):y.destroy(),this._implementation.unloadTile){const{x:d,y:v,z:S}=y.tileID.canonical;this._implementation.unloadTile({x:d,y:v,z:S})}l&&l()}abortTile(y,l){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),l&&l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){const y=a.al(this.id,this.scope);this._map.style.clearSource(y)}_update(){this.fire(new a.f("data",{dataType:"source",sourceDataType:"content"}))}}},pp=function(y,l,d,v){const S=new Di[l.type](y,l,d,v);if(S.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${S.id}`);return a.bp(["load","abort","unload","serialize","prepare"],S),S};class Oy extends a.bv{constructor(l){const d={type:"raster-dem",maxzoom:l.transform.maxZoom},v=new a.bw(a.bx(),null),S=pp("mock-dem",d,v,l.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,d){l.state="loaded",d(null)}}class Yx extends a.bv{constructor(l){const d=pp("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new a.bw(a.bx(),null),l.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,d,v){if(l.freezeTileCoverage)return;this.transform=l;const S=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,P)=>{if(T[P.key]="",!this._tiles[P.key]){const I=new a.by(P,this._source.tileSize*P.overscaleFactor(),l.tileZoom);I.state="loaded",this._tiles[P.key]=I}return T},{});for(const T in this._tiles)T in S||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(l){const d=this.proxyCachedFBO[l];if(d!==void 0){const v=Object.values(d);this.renderCachePool.push(...v),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ry extends a.aL{constructor(l,d,v){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=d,this.projMatrix=v}}class ky extends a.bq{constructor(l,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},l.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,S,T]=function(L){const F=new a.bt,V=new a.bu,Z=131;F.reserve(17161),V.reserve(33800);const Q=a.a3/128,J=a.a3+Q/2,ie=J+Q;for(let ae=-Q;ae<ie;ae+=Q)for(let se=-Q;se<ie;se+=Q){const me=se<0||se>J||ae<0||ae>J?24575:0,ge=a.at(Math.round(se),0,a.a3),ye=a.at(Math.round(ae),0,a.a3);F.emplaceBack(ge+me,ye)}const oe=(ae,se)=>{const me=se*Z+ae;V.emplaceBack(me+1,me,me+Z),V.emplaceBack(me+Z,me+Z+1,me+1)};for(let ae=1;ae<129;ae++)for(let se=1;se<129;se++)oe(se,ae);return[0,129].forEach(ae=>{for(let se=0;se<130;se++)oe(se,ae),oe(ae,se)}),[F,V,32768]}(),P=l.context;this.gridBuffer=P.createVertexBuffer(v,a.br.members),this.gridIndexBuffer=P.createIndexBuffer(S),this.gridSegments=a.b.simpleSegment(0,0,v.length,S.length),this.gridNoSkirtSegments=a.b.simpleSegment(0,0,v.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Yx(d.map),this.orthoMatrix=a.ad.create(),a.ad.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.a3,0,a.a3,0,1);const I=P.gl;this._overlapStencilMode=new a.ag({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Oy(d.map),this._pendingGroundEffectLayers=[]}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),this._style=l,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,d,v){if(l&&l.terrain){this._style!==l&&(this.style=l,this._evaluationZoom=void 0);const S=l.terrain.properties,T=l.terrain.drapeRenderMode===0,P=l.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.e.now();const I=l.terrain&&l.terrain.scope,L=S.get("source"),F=T?this._mockSourceCache:l.getSourceCache(L,I);if(!F)return void a.w(`Couldn't find terrain source "${L}".`);if(this.sourceCache=F,this._exaggeration=P?this.calculateExaggeration(d):S.get("exaggeration"),!d.projection.requiresDraping&&P&&this._exaggeration===0)return void this._disable();this.enabled=!0;const V=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(d,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,V(),this._initializing=!0),V(),d.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(l){const d=this._previousCameraAltitude,v=l.getFreeCameraOptions().position.z/l.pixelsPerMeter*l.worldSize;this._previousCameraAltitude=v;const S=d!=null?v-d:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const T=l.zoom,P=this._style.terrain;if(!this._previousUpdateTimestamp)return P.getExaggeration(T);let I=T-this._previousZoom;const L=this._previousUpdateTimestamp;let F=T;this._evaluationZoom!=null&&(F=this._evaluationZoom,Math.abs(T-F)>.5&&(I=.5*(T-F+I)),I*S<0&&(F+=I)),this._evaluationZoom=F;const V=P.getExaggeration(F),Z=V===P.getExaggeration(Math.max(0,F-.1));if(Z&&Math.abs(V-this._exaggeration)<.01)return V;let Q=Math.min(.1,.00375*(this._updateTimestamp-L));return(Z||V<.1||Math.abs(I)<1e-4)&&(Q=Math.min(.2,4*Q)),a.a2(this._exaggeration,V,Q)}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._mergedSourceCaches)this._style._mergedSourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=v._centerAltitude===0&&this.getAtPointOrZero(a.Y.fromLngLat(v.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=d.getIds().map(L=>{const F=d.getTileByID(L).tileID;return F.projMatrix=v.calculateProjMatrix(F.toUnwrapped()),F});(function(L,F){const V=F.transform.pointCoordinate(F.transform.getCameraPoint()),Z=new a.P(V.x,V.y);L.sort((Q,J)=>{if(J.overscaledZ-Q.overscaledZ)return J.overscaledZ-Q.overscaledZ;const ie=new a.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),oe=new a.P(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),ae=Z.mult(1<<Q.canonical.z);return ae.x-=.5,ae.y-=.5,ae.distSqr(ie)-ae.distSqr(oe)})})(S,this.painter);const T=this.proxyToSource||{};this.proxyToSource={},S.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const P=this._style._mergedSourceCaches;for(const L in P){const F=P[L];if(!F.used||(F!==this.sourceCache&&this.resetTileLookupCache(F.id),this._setupProxiedCoordsForOrtho(F,l[L],T),F.usedForTerrain))continue;const V=l[L];F.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[d.id]=S.map(L=>new Ry(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1;const I={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const F=this.terrainTileForTile[L.key];if(!F)continue;const V=F.tileID.key;V in I||(this._visibleDemTiles.push(F),I[V]=V)}}_assignTerrainTiles(l){this._initializing||l.forEach(d=>{if(this.terrainTileForTile[d.key])return;const v=this._findTileCoveringTileID(d,this.sourceCache);v&&(this.terrainTileForTile[d.key]=v)})}_prepareDEMTextures(){const l=this.painter.context,d=l.gl;for(const v in this.terrainTileForTile){const S=this.terrainTileForTile[v],T=S.dem;!T||S.demTexture&&!S.needsDEMTextureUpload||(l.activeTexture.set(d.TEXTURE1),wy(this.painter,S,T))}}_prepareDemTileUniforms(l,d,v,S){if(!d||d.demTexture==null)return!1;const T=l.tileID.canonical,P=Math.pow(2,d.tileID.canonical.z-T.z),I=S||"";return v[`u_dem_tl${I}`]=[T.x*P%1,T.y*P%1],v[`u_dem_scale${I}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,d=l.gl;if(!this._emptyDepthBufferTexture){const v=new a.i({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.T(l,v,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let l=0;const d=this._visibleDemTiles.reduce((v,S)=>{if(!S.dem)return v;const T=S.dem.tree.minimums[0];return T>0&&l++,v+T},0);return l?d/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,d=l.gl;l.activeTexture.set(d.TEXTURE2);const v=this._getLoadedAreaMinimum(),[S,T]=(()=>{const I=new a.bz({width:1,height:1},new Float32Array([v]));return[d.R32F,I]})();this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(T,{premultiply:!1}):P=this._emptyDEMTexture=new a.T(l,T,S,{premultiply:!1}),P}setupElevationDraw(l,d,v){const S=this.painter.context,T=S.gl,P={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};P.u_exaggeration=this.exaggeration();let I=null,L=null,F=1;if(v&&v.morphing&&this._useVertexMorphing){const J=v.morphing.srcDemTile,ie=v.morphing.dstDemTile;F=v.morphing.phase,J&&ie&&(this._prepareDemTileUniforms(l,J,P,"_prev")&&(L=J),this._prepareDemTileUniforms(l,ie,P)&&(I=ie))}const V=J=>J&&J.demTexture&&this.painter.linearFloatFilteringSupported()?T.LINEAR:T.NEAREST;let Z=null;var Q;if(this.enabled?L&&I?(Z=I.demTexture,S.activeTexture.set(T.TEXTURE4),L.demTexture.bind(V(L),T.CLAMP_TO_EDGE),P.u_dem_lerp=F):(I=this.terrainTileForTile[l.tileID.key],Z=this._prepareDemTileUniforms(l,I,P)?I.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,S.activeTexture.set(T.TEXTURE2),Z&&(P.u_dem_size=(Q=Z).size[0]===1?1:Q.size[0]-2,Z.bind(V(I),T.CLAMP_TO_EDGE)),S.activeTexture.set(T.TEXTURE3),v&&v.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),v&&v.useMeterToDem&&I){const J=(1<<I.tileID.canonical.z)*a.ax(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=J}if(v&&v.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),d.setTerrainUniformValues(S,P),this.painter.transform.projection.name==="globe"){const J=this.globeUniformValues(this.painter.transform,l.tileID.canonical,v&&v.useDenormalizedUpVectorScale);d.setGlobeUniformValues(S,J)}}globeUniformValues(l,d,v){const S=l.projection;return{u_tile_tl_up:S.upVector(d,0,0),u_tile_tr_up:S.upVector(d,a.a3,0),u_tile_br_up:S.upVector(d,a.a3,a.a3),u_tile_bl_up:S.upVector(d,0,a.a3),u_tile_up_scale:v?a.bs(1):S.upVectorScale(d,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const d=this.painter,v=this.painter.context;l.length!==0&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,T,P,I,L){if(S.transform.projection.name==="globe")(function(F,V,Z,Q,J){const ie=F.context,oe=ie.gl;let ae,se;const me=F.transform,ge=a.ba(F,ie,me),ye=(We,qe)=>{if(se===qe)return;const dt=[df[qe],"PROJECTION_GLOBE_VIEW"];ge&&dt.push("CUSTOM_ANTIALIASING");const mt=F.isTileAffectedByFog(We);ae=F.getOrCreateProgram("globeRaster",{defines:dt,overrideFog:mt}),se=qe},Ce=F.colorModeForRenderPass(),Ae=new a.ae(oe.LEQUAL,a.ae.ReadWrite,F.depthRangeFor3D);tu.update(J);const pe=a.bb(me),_e=[a.aj(me.center.lng),a.ak(me.center.lat)],xe=F.globeSharedBuffers,Re=[me.width*a.e.devicePixelRatio,me.height*a.e.devicePixelRatio],Ge=Float32Array.from(me.globeMatrix),Te={useDenormalizedUpVectorScale:!0};{const We=F.transform,qe=Iy(We.zoom,V.exaggeration(),V.sourceCache._source.tileSize);se=-1;const dt=oe.TRIANGLES;for(const mt of Q){const ft=Z.getTile(mt),Be=a.ag.disabled,Je=V.prevTerrainTileForTile[mt.key],ct=V.terrainTileForTile[mt.key];hp(Je,ct)&&tu.newMorphing(mt.key,Je,ct,J,250),ie.activeTexture.set(oe.TEXTURE0),ft.texture&&ft.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Ot=tu.getMorphValuesForProxy(mt.key),kt=Ot?1:0;Ot&&a.o(Te,{morphing:{srcDemTile:Ot.from,dstDemTile:Ot.to,phase:a.b9(Ot.phase)}});const Nt=a.bc(mt.canonical),Dt=a.bd(Nt.getCenter().lat),vt=a.be(mt.canonical,Nt,Dt,We.worldSize/We._pixelsPerMercatorPixel),at=a.bf(a.bg(mt.canonical)),$t=qx(We.expandedFarZProjMatrix,Ge,pe,at,a.a1(We.zoom),_e,We.frustumCorners.TL,We.frustumCorners.TR,We.frustumCorners.BR,We.frustumCorners.BL,We.globeCenterInViewSpace,We.globeRadius,Re,qe,We._farZ,vt);if(ye(mt,kt),ae&&(V.setupElevationDraw(ft,ae,Te),F.uploadCommonUniforms(ie,ae,mt.toUnwrapped()),xe)){const[vn,mn,On]=xe.getGridBuffers(Dt,qe!==0);ae.draw(F,dt,Ae,Be,Ce,a.af.backCCW,$t,"globe_raster",vn,mn,On)}}}if(xe&&(F.renderDefaultNorthPole||F.renderDefaultSouthPole)){const We=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ge&&We.push("CUSTOM_ANTIALIASING"),ae=F.getOrCreateProgram("globeRaster",{defines:We});for(const qe of Q){const{x:dt,y:mt,z:ft}=qe.canonical,Be=mt===0,Je=mt===(1<<ft)-1,[ct,Ot,kt,Nt]=xe.getPoleBuffers(ft,!1);if(Nt&&(Be||Je)){const Dt=Z.getTile(qe);ie.activeTexture.set(oe.TEXTURE0),Dt.texture&&Dt.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);let vt=a.bh(ft,dt,me);const at=a.bf(a.bg(qe.canonical)),$t=(vn,mn)=>vn.draw(F,oe.TRIANGLES,Ae,a.ag.disabled,Ce,a.af.disabled,qx(me.expandedFarZProjMatrix,vt,vt,at,0,_e,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,Re,0,me._farZ),"globe_pole_raster",mn,kt,Nt);V.setupElevationDraw(Dt,ae,Te),F.uploadCommonUniforms(ie,ae,qe.toUnwrapped()),Be&&F.renderDefaultNorthPole&&$t(ae,ct),Je&&F.renderDefaultSouthPole&&(vt=a.ad.scale(a.ad.create(),vt,[1,-1,1]),$t(ae,Ot))}}}})(S,T,P,I,L);else{const F=S.context,V=F.gl;let Z,Q;const J=S.shadowRenderer,ie=Ps(S,S.longestCutoffRange),oe=Ce=>{if(Q===Ce)return;const Ae=[];Ae.push(df[Ce]),ie.shouldRenderCutoff&&Ae.push("RENDER_CUTOFF"),Z=S.getOrCreateProgram("terrainRaster",{defines:Ae}),Q=Ce},ae=S.colorModeForRenderPass(),se=new a.ae(V.LEQUAL,a.ae.ReadWrite,S.depthRangeFor3D);tu.update(L);const me=S.transform,ge=Iy(me.zoom,T.exaggeration(),T.sourceCache._source.tileSize);let ye=[0,0,0];if(J){const Ce=S.style.directionalLight,Ae=S.style.ambientLight;Ce&&Ae&&(ye=Ms(S.style,Ce,Ae))}{Q=-1;const Ce=V.TRIANGLES,[Ae,pe]=[T.gridIndexBuffer,T.gridSegments];for(const _e of I){const xe=P.getTile(_e),Re=a.ag.disabled,Ge=T.prevTerrainTileForTile[_e.key],Te=T.terrainTileForTile[_e.key];hp(Ge,Te)&&tu.newMorphing(_e.key,Ge,Te,L,250),F.activeTexture.set(V.TEXTURE0),xe.texture&&xe.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const We=tu.getMorphValuesForProxy(_e.key),qe=We?1:0;let dt;We&&(dt={morphing:{srcDemTile:We.from,dstDemTile:We.to,phase:a.b9(We.phase)}});const mt=Lt(_e.projMatrix,Xx(_e.canonical,me.renderWorldCopies)?ge/10:ge,ye);if(oe(qe),!Z)continue;T.setupElevationDraw(xe,Z,dt);const ft=_e.toUnwrapped();J&&J.setupShadows(ft,Z),S.uploadCommonUniforms(F,Z,ft,null,ie),Z.draw(S,Ce,se,Re,ae,a.af.backCCW,mt,"terrain_raster",T.gridBuffer,Ae,pe)}}}}(d,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;const d=this.painter,v=this.painter.context,S=this.proxySourceCache,T=this.proxiedCoords[S.id],P=this._drapedRenderBatches.shift(),I=d.style.order,L=[];let F=0;for(const V of T){const Z=S.getTileByID(V.proxyTileKey),Q=S.proxyCachedFBO[V.key]?S.proxyCachedFBO[V.key][l]:void 0,J=Q!==void 0?S.renderCache[Q]:this.pool[F++],ie=Q!==void 0;if(Z.texture=J.tex,ie&&!J.dirty){L.push(Z.tileID);continue}let oe;v.bindFramebuffer.set(J.fb.framebuffer),this.renderedToTile=!1,J.dirty&&(v.clear({color:a.C.transparent,stencil:0}),J.dirty=!1);for(let ae=P.start;ae<=P.end;++ae){const se=d.style._mergedLayers[I[ae]];if(se.isHidden(d.transform.zoom))continue;const me=d.style.getLayerSourceCache(se),ge=me?this.proxyToSource[V.key][me.id]:[V];if(!ge)continue;const ye=ge;v.viewport.set([0,0,J.fb.width,J.fb.height]),oe!==(me?me.id:null)&&(this._setupStencil(J,ge,se,me),oe=me?me.id:null),d.renderLayer(d,me,se,ye)}if(this._drapedRenderBatches.length===0)for(const ae of this._pendingGroundEffectLayers){const se=d.style._mergedLayers[I[ae]];if(se.isHidden(d.transform.zoom))continue;const me=d.style.getLayerSourceCache(se),ge=me?this.proxyToSource[V.key][me.id]:[V];if(!ge)continue;const ye=ge;v.viewport.set([0,0,J.fb.width,J.fb.height]),oe!==(me?me.id:null)&&(this._setupStencil(J,ge,se,me),oe=me?me.id:null),d.renderLayer(d,me,se,ye)}this.renderedToTile?(J.dirty=!0,L.push(Z.tileID)):ie||--F,F===5&&(F=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,d.width,d.height]),P.end+1}postRender(){}isLayerOrderingCorrect(l){const d=l.order.length;let v=-1,S=d;for(let T=0;T<d;++T)this._style.isLayerDraped(l._mergedLayers[l.order[T]])?v=Math.max(v,T):S=Math.min(S,T);return S>v}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{l=Math.min(l,d.dem.tree.minimums[0])}),l===0?l:(l-30)*this._exaggeration}raycast(l,d,v){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const P=T.tileID,I=1<<P.overscaledZ,{x:L,y:F}=P.canonical,V=L/I,Z=(L+1)/I,Q=F/I,J=(F+1)/I;return{minx:V,miny:Q,maxx:Z,maxy:J,t:T.dem.tree.raycastRoot(V,Q,Z,J,l,d,v),tile:T}});S.sort((T,P)=>(T.t!==null?T.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const T of S){if(T.t==null)return null;const P=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,l,d,v);if(P!=null)return P}return null}_createFBO(){const l=this.painter.context,d=l.gl,v=this.drapeBufferSize;l.activeTexture.set(d.TEXTURE0);const S=new a.T(l,{width:v[0],height:v[1],data:null},d.RGBA);S.bind(d.LINEAR,d.CLAMP_TO_EDGE);const T=l.createFramebuffer(v[0],v[1],!0,null);return T.colorAttachment.set(S.texture),T.depthAttachment=new Zn(l,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:T,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const d=this._style._mergedLayers[l],v=d.isHidden(this.painter.transform.zoom);return d.type==="custom"?!v&&d.shouldRedrape():!v&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const v of this._style.getSources())if(v instanceof ap){l=!0;break}if(!l)return;const d={};for(let v=0;v<this._style.order.length;++v){const S=this._style._mergedLayers[this._style.order[v]],T=this._style.getLayerSourceCache(S);if(T&&!d[T.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof a.Z){d[T.id]=!0;for(const P of this.proxyCoords){const I=this.proxyToSource[P.key][T.id];if(I)for(const L of I)this._clearRenderCacheForTile(T.id,L)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const v in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[v]._source instanceof sf){l=!0;break}if(!l)return;const d={};for(let v=0;v<this._style.order.length;++v){const S=this._style._mergedLayers[this._style.order[v]],T=this._style.getLayerSourceCache(S);if(!T||d[T.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const P=S.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const L=this.proxyToSource[I.key][T.id];if(L)for(const F of L){const V=dp(T.getTile(F),T.findLoadedParent(F,0),T,this.painter.transform,P);(V.opacity!==1||V.mix!==0)&&this._clearRenderCacheForTile(T.id,F)}}}}_setupDrapedRenderBatches(){const l=this._style.order,d=l.length;if(d===0)return;const v=[];this._pendingGroundEffectLayers=[];let S,T=0,P=this._style._mergedLayers[l[T]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++T<d;)P=this._style._mergedLayers[l[T]];for(;T<d;++T){const I=this._style._mergedLayers[l[T]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?S===void 0&&(S=T):(I.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(T),S!==void 0&&(v.push({start:S,end:T-1}),S=void 0)))}if(S!==void 0&&v.push({start:S,end:T-1}),v.length!==0){const I=v[v.length-1];this._pendingGroundEffectLayers.every(L=>L>I.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=v}_setupRenderCache(l){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const P=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let I=0;I<P.length;++I){const L=Object.values(P[I]);d.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,S=this._tilesDirty;for(let P=v.length-1;P>=0;P--){const I=v[P];if(d.getTileByID(I.key),d.proxyCachedFBO[I.key]!==void 0){const L=l[I.key],F=this.proxyToSource[I.key];let V=0;for(const Z in F){const Q=F[Z],J=L[Z];if(!J||J.length!==Q.length||Q.some((ie,oe)=>ie!==J[oe]||S[Z]&&S[Z].hasOwnProperty(ie.key))){V=-1;break}++V}for(const Z in d.proxyCachedFBO[I.key])d.renderCache[d.proxyCachedFBO[I.key][Z]].dirty=V<0||V!==Object.values(L).length}}const T=[...this._drapedRenderBatches];T.sort((P,I)=>I.end-I.start-(P.end-P.start));for(const P of T)for(const I of v){if(d.proxyCachedFBO[I.key])continue;let L=d.renderCachePool.pop();L===void 0&&d.renderCache.length<50&&(L=d.renderCache.length,d.renderCache.push(this._createFBO())),L!==void 0&&(d.proxyCachedFBO[I.key]={},d.proxyCachedFBO[I.key][P.start]=L,d.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(l,d,v,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,P=T.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let I;if(v.isTileClipped())I=d.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):a.ag.disabled}_renderTileClippingMasks(l,d){const v=this.painter,S=this.painter.context,T=S.gl;v._tileClippingMaskIDs={},S.setColorMode(a.a.disabled),S.setDepthMode(a.ae.disabled);const P=v.getOrCreateProgram("clippingMask");for(const I of l){const L=v._tileClippingMaskIDs[I.key]=--d;P.draw(v,T.TRIANGLES,a.ae.disabled,new a.ag({func:T.ALWAYS,mask:0},L,255,T.KEEP,T.KEEP,T.REPLACE),a.a.disabled,a.af.disabled,fp(I.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(l){const d=this.painter.transform;if(l.x<0||l.x>d.width||l.y<0||l.y>d.height)return null;const v=[l.x,l.y,1,1];a.aA.transformMat4(v,v,d.pixelMatrixInverse),a.aA.scale(v,v,1/v[3]),v[0]/=d.worldSize,v[1]/=d.worldSize;const S=d._camera.position,T=a.ax(1,d.center.lat),P=[S[0],S[1],S[2]/T,0],I=a._.subtract([],v.slice(0,3),P);a._.normalize(I,I);const L=this.raycast(P,I,this._exaggeration);return L!==null&&L?(a._.scaleAndAdd(P,P,I,L),P[3]=P[2],P[2]*=T,P):null}drawDepth(){const l=this.painter,d=l.context,v=this.proxySourceCache,S=Math.ceil(l.width),T=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=d.gl,I=d.createFramebuffer(S,T,!0,"renderbuffer");d.activeTexture.set(P.TEXTURE0);const L=new a.T(d,{width:S,height:T,data:null},P.RGBA);L.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.colorAttachment.set(L.texture);const F=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,S,T);I.depthAttachment.set(F),this._depthFBO=I,this._depthTexture=L}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,S,T]),function(P,I,L,F){if(P.transform.projection.name==="globe")return;const V=P.context,Z=V.gl;V.clear({depth:1});const Q=P.getOrCreateProgram("terrainDepth"),J=new a.ae(Z.LESS,a.ae.ReadWrite,P.depthRangeFor3D);for(const ie of F){const oe=L.getTile(ie),ae=Lt(ie.projMatrix,0,[0,0,0]);I.setupElevationDraw(oe,Q),Q.draw(P,Z.TRIANGLES,J,a.ag.disabled,a.a.unblended,a.af.backCCW,ae,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(l,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,d,v){if(l.getSource()instanceof a.bm)return this._setupProxiedCoordsForImageSource(l,d,v);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const S=this.proxiedCoords[l.id]=[],T=this.proxyCoords;for(let L=0;L<T.length;L++){const F=T[L],V=this._findTileCoveringTileID(F,l);if(V){const Z=this._createProxiedId(F,V,v[F.key]&&v[F.key][l.id]);S.push(Z),this.proxyToSource[F.key][l.id]=[Z]}}let P=!1;const I=new Set;for(let L=0;L<d.length;L++){const F=l.getTile(d[L]);if(!F||!F.hasData())continue;const V=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==F.tileID.canonical.z){const Z=this.proxyToSource[V.tileID.key][l.id],Q=this._createProxiedId(V.tileID,F,v[V.tileID.key]&&v[V.tileID.key][l.id]);Z?Z.splice(Z.length-1,0,Q):this.proxyToSource[V.tileID.key][l.id]=[Q];const J=this.proxyToSource[V.tileID.key][l.id];I.has(J)||I.add(J),S.push(Q),P=!0}}if(this._sourceTilesOverlap[l.id]=P,P&&this._debugParams.sortTilesHiZFirst)for(const L of I)L.sort((F,V)=>V.overscaledZ-F.overscaledZ)}_setupProxiedCoordsForImageSource(l,d,v){if(!l.getSource().loaded())return;const S=this.proxiedCoords[l.id]=[],T=this.proxyCoords,P=l.getSource(),I=P.tileID;if(!I)return;const L=new a.P(I.x,I.y)._div(1<<I.z),F=P.coordinates.map(a.Y.fromLngLat).reduce((Z,Q)=>(Z.min.x=Math.min(Z.min.x,Q.x-L.x),Z.min.y=Math.min(Z.min.y,Q.y-L.y),Z.max.x=Math.max(Z.max.x,Q.x-L.x),Z.max.y=Math.max(Z.max.y,Q.y-L.y),Z),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(Z,Q)=>{const J=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ie=Z.canonical.y/(1<<Z.canonical.z),oe=a.a3/(1<<Z.canonical.z),ae=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),se=Q.canonical.y/(1<<Q.canonical.z);return J+oe<ae+F.min.x||J>ae+F.max.x||ie+oe<se+F.min.y||ie>se+F.max.y};for(let Z=0;Z<T.length;Z++){const Q=T[Z];for(let J=0;J<d.length;J++){const ie=l.getTile(d[J]);if(!ie||!ie.hasData()||V(Q,ie.tileID))continue;const oe=this._createProxiedId(Q,ie,v[Q.key]&&v[Q.key][l.id]),ae=this.proxyToSource[Q.key][l.id];ae?ae.push(oe):this.proxyToSource[Q.key][l.id]=[oe],S.push(oe)}}}_createProxiedId(l,d,v){let S=this.orthoMatrix;if(v){const T=v.find(P=>P.key===d.tileID.key);if(T)return T}if(d.tileID.key!==l.key){const T=l.canonical.z-d.tileID.canonical.z;let P,I,L;S=a.ad.create();const F=d.tileID.wrap-l.wrap<<l.overscaledZ;T>0?(P=a.a3>>T,I=P*((d.tileID.canonical.x<<T)-l.canonical.x+F),L=P*((d.tileID.canonical.y<<T)-l.canonical.y)):(P=a.a3<<-T,I=a.a3*(d.tileID.canonical.x-(l.canonical.x+F<<-T)),L=a.a3*(d.tileID.canonical.y-(l.canonical.y<<-T))),a.ad.ortho(S,0,P,0,P,0,1),a.ad.translate(S,S,[I,L,0])}return new Ry(d.tileID,l.key,S)}_findTileCoveringTileID(l,d){let v=d.getTile(l);if(v&&v.hasData())return v;const S=this._findCoveringTileCache[d.id],T=S[l.key];if(v=T?d.getTileByID(T):null,v&&v.hasData()||T===null)return v;let P=v?v.tileID:l,I=P.overscaledZ;const L=d.getSource().minzoom,F=[];if(!T){const Z=d.getSource().maxzoom;if(l.canonical.z>=Z){const Q=l.canonical.z-Z;d.getSource().reparseOverscaled?(I=Math.max(l.canonical.z+2,d.transform.tileZoom),P=new a.aL(I,l.wrap,Z,l.canonical.x>>Q,l.canonical.y>>Q)):Q!==0&&(I=Z,P=new a.aL(I,l.wrap,Z,l.canonical.x>>Q,l.canonical.y>>Q))}P.key!==l.key&&(F.push(P.key),v=d.getTile(P))}const V=Z=>{F.forEach(Q=>{S[Q]=Z}),F.length=0};for(I-=1;I>=L&&(!v||!v.hasData());I--){v&&V(v.tileID.key);const Z=P.calculateScaledKey(I);if(v=d.getTileByID(Z),v&&v.hasData())break;const Q=S[Z];if(Q===null)break;Q===void 0?F.push(Z):v=d.getTileByID(Q)}return V(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,d){let v=this._tilesDirty[l];v||(v=this._tilesDirty[l]={}),v[d.key]=!0}}function Is(y,l,d){const v=function(I,L,F){const V=a._.dot(L,I),Z=a._.dot(F,[.2126,.7152,.0722]),Q=(ie,oe,ae)=>(1-ae)*ie+ae*oe,J=Q(1-.3*Math.min(Z,1),1,Math.min(V+1,1));return Q(.92,1,Math.asin(a.at(L[2],-1,1))/Math.PI+.5)*J}(y,[0,0,1],l),S=[0,0,0];a._.scale(S,d.slice(0,3),v);const T=[0,0,0];a._.scale(T,l.slice(0,3),y[2]);const P=[0,0,0];return a._.add(P,S,T),a.b8(P)}const mp=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Kx=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class pf{static cacheKey(l,d,v,S){let T=`${d}${S?S.cacheKey:""}`;for(const P of v)l.usedDefines.includes(P)&&(T+=`/${P}`);return T}constructor(l,d,v,S,T,P){const I=l.gl;this.program=I.createProgram(),this.configuration=S,this.name=d,this.fixedDefines=[...P];const L=S?S.getBinderAttributes():[],F=(v.staticAttributes||[]).concat(L);let V=S?S.defines():[];V=V.concat(P.map(ae=>`#define ${ae}`));const Z=`#version 300 es
`;let Q=Z+V.concat("precision mediump float;",Wx,Gx.fragmentSource).join(`
`);for(const ae of v.fragmentIncludes)Q+=`
${ip[ae]}`;Q+=`
${v.fragmentSource}`;let J=Z+V.concat("precision highp float;",Wx,Gx.vertexSource).join(`
`);for(const ae of v.vertexIncludes)J+=`
${ip[ae]}`;J+=`
${v.vertexSource}`;const ie=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ie,Q),I.compileShader(ie),I.attachShader(this.program,ie);const oe=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(oe,J),I.compileShader(oe),I.attachShader(this.program,oe),this.attributes={},this.numAttributes=F.length;for(let ae=0;ae<this.numAttributes;ae++)if(F[ae]){const se=F[ae].startsWith("a_")?F[ae]:`a_${F[ae]}`;I.bindAttribLocation(this.program,ae,se),this.attributes[se]=ae}I.linkProgram(this.program),I.deleteShader(oe),I.deleteShader(ie),this.fixedUniforms=T(l),this.binderUniforms=S?S.getUniforms(l):[],P.includes("TERRAIN")&&(this.terrainUniforms=(ae=>({u_dem:new a.a7(ae),u_dem_prev:new a.a7(ae),u_dem_tl:new a.a8(ae),u_dem_scale:new a.aa(ae),u_dem_tl_prev:new a.a8(ae),u_dem_scale_prev:new a.aa(ae),u_dem_size:new a.aa(ae),u_dem_lerp:new a.aa(ae),u_exaggeration:new a.aa(ae),u_depth:new a.a7(ae),u_depth_size_inv:new a.a8(ae),u_meter_to_dem:new a.aa(ae),u_label_plane_matrix_inv:new a.a6(ae)}))(l)),P.includes("GLOBE")&&(this.globeUniforms=(ae=>({u_tile_tl_up:new a.aq(ae),u_tile_tr_up:new a.aq(ae),u_tile_br_up:new a.aq(ae),u_tile_bl_up:new a.aq(ae),u_tile_up_scale:new a.aa(ae)}))(l)),P.includes("FOG")&&(this.fogUniforms=(ae=>({u_fog_matrix:new a.a6(ae),u_fog_range:new a.a8(ae),u_fog_color:new a.as(ae),u_fog_horizon_blend:new a.aa(ae),u_fog_vertical_limit:new a.a8(ae),u_fog_temporal_offset:new a.aa(ae),u_frustum_tl:new a.aq(ae),u_frustum_tr:new a.aq(ae),u_frustum_br:new a.aq(ae),u_frustum_bl:new a.aq(ae),u_globe_pos:new a.aq(ae),u_globe_radius:new a.aa(ae),u_globe_transition:new a.aa(ae),u_is_globe:new a.a7(ae),u_viewport:new a.a8(ae)}))(l)),P.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ae=>({u_cutoff_params:new a.as(ae)}))(l)),P.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ae=>({u_lighting_ambient_color:new a.aq(ae),u_lighting_directional_dir:new a.aq(ae),u_lighting_directional_color:new a.aq(ae),u_ground_radiance:new a.aq(ae)}))(l)),P.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ae=>({u_light_matrix_0:new a.a6(ae),u_light_matrix_1:new a.a6(ae),u_fade_range:new a.a8(ae),u_shadow_normal_offset:new a.aq(ae),u_shadow_intensity:new a.aa(ae),u_shadow_texel_size:new a.aa(ae),u_shadow_map_resolution:new a.aa(ae),u_shadow_direction:new a.aq(ae),u_shadow_bias:new a.aq(ae),u_shadowmap_0:new a.a7(ae),u_shadowmap_1:new a.a7(ae)}))(l))}}setTerrainUniformValues(l,d){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const S in d)v[S]&&v[S].set(this.program,S,d[S])}}setGlobeUniformValues(l,d){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const S in d)v[S]&&v[S].set(this.program,S,d[S])}}setFogUniformValues(l,d){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}}setCutoffUniformValues(l,d){if(!this.cutoffUniforms)return;const v=this.cutoffUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}}setLightsUniformValues(l,d){if(!this.lightsUniforms)return;const v=this.lightsUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}}setShadowUniformValues(l,d){if(this.failedToCreate||!this.shadowUniforms)return;const v=this.shadowUniforms;l.program.set(this.program);for(const S in d)v[S].set(this.program,S,d[S])}_drawDebugWireframe(l,d,v,S,T,P,I,L,F,V){const Z=l.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const Q=l.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||l._terrain&&l._terrain.renderingToTexture||!mp.includes(this.name))||!(!Z.layers3D||!Kx.includes(this.name))))return;const J=Q.gl,ie=l.wireframeDebugCache.getLinesFromTrianglesBuffer(l.frameCounter,T,Q);if(!ie)return;const oe=[...this.fixedDefines];oe.push("DEBUG_WIREFRAME");const ae=l.getOrCreateProgram(this.name,{config:this.configuration,defines:oe});Q.program.set(ae.program);const se=(ye,Ce,Ae)=>{if(Ce[ye]&&Ae[ye])for(const pe in Ce[ye])Ae[ye][pe]&&Ae[ye][pe].set(Ae.program,pe,Ce[ye][pe].current)};F&&F.setUniforms(ae.program,Q,ae.binderUniforms,I,{zoom:L}),se("fixedUniforms",this,ae),se("terrainUniforms",this,ae),se("globeUniforms",this,ae),se("fogUniforms",this,ae),se("lightsUniforms",this,ae),se("shadowUniforms",this,ae),ie.bind(),Q.setColorMode(new a.a([J.ONE,J.ONE_MINUS_SRC_ALPHA,J.ZERO,J.ONE],a.C.transparent,[!0,!0,!0,!1])),Q.setDepthMode(new a.ae(d.func===J.LESS?J.LEQUAL:d.func,a.ae.ReadOnly,d.range)),Q.setStencilMode(a.ag.disabled);const me=3*P.primitiveLength*2,ge=3*P.primitiveOffset*2*2;V&&V>1?J.drawElementsInstanced(J.LINES,me,J.UNSIGNED_SHORT,ge,V):J.drawElements(J.LINES,me,J.UNSIGNED_SHORT,ge),T.bind(),Q.program.set(this.program),Q.setDepthMode(d),Q.setStencilMode(v),Q.setColorMode(S)}draw(l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae){const se=l.context,me=se.gl;if(this.failedToCreate)return;se.program.set(this.program),se.setDepthMode(v),se.setStencilMode(S),se.setColorMode(T),se.setCullFace(P);for(const Ce of Object.keys(this.fixedUniforms))this.fixedUniforms[Ce].set(this.program,Ce,I[Ce]);ie&&ie.setUniforms(this.program,se,this.binderUniforms,Q,{zoom:J});const ge={[me.POINTS]:1,[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[d],ye=ae&&ae>0?1:void 0;for(const Ce of Z.get()){const Ae=Ce.vaos||(Ce.vaos={});(Ae[L]||(Ae[L]=new xA)).bind(se,this,F,ie?ie.getPaintVertexBuffers():[],V,Ce.vertexOffset,oe||[],ye),ae&&ae>1?me.drawElementsInstanced(d,Ce.primitiveLength*ge,me.UNSIGNED_SHORT,Ce.primitiveOffset*ge*2,ae):V?me.drawElements(d,Ce.primitiveLength*ge,me.UNSIGNED_SHORT,Ce.primitiveOffset*ge*2):me.drawArrays(d,Ce.vertexOffset,Ce.vertexLength),d===me.TRIANGLES&&V&&this._drawDebugWireframe(l,v,S,T,V,Ce,Q,J,ie,ae)}}}function gp(y,l){const d=Math.pow(2,l.tileID.overscaledZ),v=l.tileSize*Math.pow(2,y.transform.tileZoom)/d,S=v*(l.tileID.canonical.x+l.tileID.wrap*d),T=v*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture?l.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.bB(l,1,y.transform.tileZoom),u_pixel_coord_upper:[S>>16,T>>16],u_pixel_coord_lower:[65535&S,65535&T]}}const yp=a.ad.create(),vc=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe)=>{const ae=l.style.light,se=ae.properties.get("position"),me=[se.x,se.y,se.z],ge=a.bC.create();ae.properties.get("anchor")==="viewport"&&(a.bC.fromRotation(ge,-l.transform.angle),a._.transformMat3(me,me,ge));const ye=ae.properties.get("color"),Ce=l.transform,Ae={u_matrix:y,u_lightpos:me,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[ye.r,ye.g,ye.b],u_vertical_gradient:+d,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:yp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:T,u_flood_light_color:Z,u_vertical_scale:Q,u_flood_light_intensity:J,u_ground_shadow_factor:ie,u_emissive_strength:oe};return Ce.projection.name==="globe"&&(Ae.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],Ae.u_zoom_transition=L,Ae.u_inv_rot_matrix=V,Ae.u_merc_center=F,Ae.u_up_dir=Ce.projection.upVector(new a.aO(0,0,0),F[0]*a.a3,F[1]*a.a3),Ae.u_height_lift=I),Ae},xc=(y,l,d)=>({u_matrix:y,u_edge_radius:l,u_vertical_scale:d}),Dy=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J)=>{const ie=vc(y,l,d,v,S,T,P,L,F,V,Z,Q,J,1,[0,0,0],0),oe={u_height_factor:-Math.pow(2,P.overscaledZ)/I.tileSize/8};return a.W(ie,gp(l,I),oe)},Ly=(y,l)=>({u_matrix:y,u_emissive_strength:l}),zy=(y,l,d,v)=>a.W(Ly(y,l),gp(d,v)),Qx=(y,l,d)=>({u_matrix:y,u_world:d,u_emissive_strength:l}),_p=(y,l,d,v,S)=>a.W(zy(y,l,d,v),{u_world:S}),Fy=(y,l,d,v)=>{const S=a.a3/d.tileSize;return{u_matrix:y,u_camera_to_center_distance:l.getCameraToCenterDistance(v),u_extrude_scale:[l.pixelsToGLUnits[0]/S,l.pixelsToGLUnits[1]/S]}},vp=(y,l,d=1)=>({u_matrix:y,u_color:l.toRenderColor(null),u_overlay:0,u_overlay_scale:d}),mf=a.ad.create(),nu=(y,l,d,v,S,T,P)=>{const I=y.transform,L=I.projection.name==="globe",F=L?a.bD(I.zoom,l.canonical)*I._pixelsPerMercatorPixel:a.bB(d,1,T),V={u_matrix:l.projMatrix,u_extrude_scale:F,u_intensity:P,u_inv_rot_matrix:mf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){V.u_inv_rot_matrix=v,V.u_merc_center=S,V.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],V.u_zoom_transition=a.a1(I.zoom);const Z=S[0]*a.a3,Q=S[1]*a.a3;V.u_up_dir=I.projection.upVector(new a.aO(0,0,0),Z,Q)}return V};function Jx(y,[l,d,v,S],[T,P]){if(T===P)return[0,0,0,0];const I=255*(y-1)/(y*(P-T));return[l*I,d*I,v*I,S*I]}function Ny(y,l,[d,v]){return d===v?0:.5/y+(l-d)*(y-1)/(y*(v-d))}const gf=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae,se,me,ge,ye)=>({u_matrix:y,u_normalize_matrix:l,u_globe_matrix:d,u_merc_matrix:v,u_grid_matrix:S,u_tl_parent:T,u_scale_parent:F,u_fade_t:V.mix,u_opacity:V.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:a.bE(Z.paint.get("raster-saturation")),u_contrast_factor:a.bF(Z.paint.get("raster-contrast")),u_spin_weights:yf(Z.paint.get("raster-hue-rotate")),u_perspective_transform:Q,u_raster_elevation:J,u_zoom_transition:P,u_merc_center:I,u_cutoff_params:L,u_colorization_mix:Jx(a.bG,oe,se),u_colorization_offset:Ny(a.bG,ae,se),u_color_ramp:ie,u_texture_offset:[ge/(me+2*ge),me/(me+2*ge)],u_texture_res:[me+2*ge,me+2*ge],u_emissive_strength:ye});function yf(y){y*=Math.PI/180;const l=Math.sin(y),d=Math.cos(y);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const pl=.15,By=(y,l,d,v,S,T,P,I,L,F,V,Z)=>({u_matrix:y,u_normalize_matrix:l,u_globe_matrix:d,u_merc_matrix:v,u_grid_matrix:S,u_tl_parent:T,u_scale_parent:F,u_fade_t:V.mix,u_opacity:V.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:P,u_merc_center:I,u_cutoff_params:L}),jy=(y,l,d,v,S,T,P,I,L,F)=>({u_particle_texture:y,u_particle_texture_side_len:l,u_tile_offset:d,u_velocity:v,u_color_ramp:T,u_velocity_res:S,u_max_speed:P,u_uv_offset:I,u_data_scale:L,u_data_offset:F,u_particle_pos_scale:1.3,u_particle_pos_offset:[pl,pl]}),TA=(y,l,d,v,S,T,P,I,L,F)=>({u_particle_texture:y,u_particle_texture_side_len:l,u_velocity:d,u_velocity_res:v,u_max_speed:S,u_speed_factor:T,u_reset_rate:P,u_rand_seed:Math.random(),u_uv_offset:I,u_data_scale:L,u_data_offset:F,u_particle_pos_scale:1.3,u_particle_pos_offset:[pl,pl]}),wa=a.ad.create(),bc=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae,se)=>{const me=S.transform,ge={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:me.getCameraToCenterDistance(oe),u_rotate_symbol:+d,u_aspect_ratio:me.width/me.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:P,u_coord_matrix:I,u_is_text:+L,u_pitch_with_map:+v,u_texsize:F,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:wa,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:wa,u_up_vector:[0,-1,0],u_color_adj_mat:ae,u_icon_transition:se||0};return oe.name==="globe"&&(ge.u_tile_id=[V.canonical.x,V.canonical.y,1<<V.canonical.z],ge.u_zoom_transition=Z,ge.u_inv_rot_matrix=J,ge.u_merc_center=Q,ge.u_camera_forward=me._camera.forward(),ge.u_ecef_origin=a.bH(me.globeMatrix,V.toUnwrapped()),ge.u_tile_matrix=Float32Array.from(me.globeMatrix),ge.u_up_vector=ie),ge},xp=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae)=>a.W(bc(y,l,d,v,S,T,P,I,L,F,Z,Q,J,ie,oe,ae),{u_gamma_scale:v?S.transform.getCameraToCenterDistance(ae)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:a.e.devicePixelRatio,u_is_halo:+V,undefined:void 0}),e1=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe)=>a.W(xp(y,l,d,v,S,T,P,I,!0,L,!0,V,Z,Q,J,ie,oe),{u_texsize_icon:F,u_texture_icon:1}),_f=(y,l,d,v)=>({u_matrix:y,u_emissive_strength:l,u_opacity:d,u_color:v}),t1=(y,l,d,v,S,T,P,I)=>a.W(function(L,F,V,Z,Q){const{width:J,height:ie}=Z.imageManager.getPixelSize(F),oe=Math.pow(2,Q.tileID.overscaledZ),ae=Q.tileSize*Math.pow(2,Z.transform.tileZoom)/oe,se=ae*(Q.tileID.canonical.x+Q.tileID.wrap*oe),me=ae*Q.tileID.canonical.y;return{u_image:0,u_pattern_tl:V.tl,u_pattern_br:V.br,u_texsize:[J,ie],u_pattern_size:V.displaySize,u_tile_units_to_pixels:1/a.bB(Q,1,Z.transform.tileZoom),u_pixel_coord_upper:[se>>16,me>>16],u_pixel_coord_lower:[65535&se,65535&me]}}(0,T,P,v,I),{u_matrix:y,u_emissive_strength:l,u_opacity:d}),$y=new Float32Array(a.ad.identity([])),vf=(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J=[0,0,0],ie)=>{const oe=S.style.light,ae=oe.properties.get("position"),se=[-ae.x,-ae.y,ae.z],me=a.bC.create();oe.properties.get("anchor")==="viewport"&&(a.bC.fromRotation(me,-S.transform.angle),a._.transformMat3(se,se,me));const ge=V.alphaMode==="MASK",ye=oe.properties.get("color").toRenderColor(null),Ce=Q.paint.get("model-ambient-occlusion-intensity"),Ae=Q.paint.get("model-color").constantOr(a.C.white).toRenderColor(null),pe=Q.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:y,u_lighting_matrix:l,u_normal_matrix:d,u_node_matrix:v||$y,u_lightpos:se,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[ye.r,ye.g,ye.b],u_camera_pos:J,u_opacity:T,u_baseTextureIsAlpha:0,u_alphaMask:+ge,u_alphaCutoff:V.alphaCutoff,u_baseColorFactor:[P.r,P.g,P.b,P.a],u_emissiveFactor:[I[0],I[1],I[2],1],u_metallicFactor:L,u_roughnessFactor:F,u_baseColorTexture:io.BaseColor,u_metallicRoughnessTexture:io.MetallicRoughness,u_normalTexture:io.Normal,u_occlusionTexture:io.Occlusion,u_emissionTexture:io.Emission,u_lutTexture:io.LUT,u_color_mix:[Ae.r,Ae.g,Ae.b,pe],u_aoIntensity:Ce,u_emissive_strength:Z,u_occlusionTextureTransform:ie||[0,0,0,0]}},n1=(y,l=$y,d=$y)=>({u_matrix:y,u_instance:l,u_node_matrix:d}),r1=(y,l,d,v,S)=>({u_matrix:Float32Array.from(y),u_anchorPos:l,u_screenSizePx:d,u_occluderSizePx:v,u_color:S}),EA={fillExtrusion:y=>({u_matrix:new a.a6(y),u_lightpos:new a.aq(y),u_lightintensity:new a.aa(y),u_lightcolor:new a.aq(y),u_vertical_gradient:new a.aa(y),u_opacity:new a.aa(y),u_edge_radius:new a.aa(y),u_ao:new a.a8(y),u_tile_id:new a.aq(y),u_zoom_transition:new a.aa(y),u_inv_rot_matrix:new a.a6(y),u_merc_center:new a.a8(y),u_up_dir:new a.aq(y),u_height_lift:new a.aa(y),u_flood_light_color:new a.aq(y),u_vertical_scale:new a.aa(y),u_flood_light_intensity:new a.aa(y),u_ground_shadow_factor:new a.aq(y),u_emissive_strength:new a.aa(y)}),fillExtrusionDepth:y=>({u_matrix:new a.a6(y),u_edge_radius:new a.aa(y),u_vertical_scale:new a.aa(y)}),fillExtrusionPattern:y=>({u_matrix:new a.a6(y),u_lightpos:new a.aq(y),u_lightintensity:new a.aa(y),u_lightcolor:new a.aq(y),u_vertical_gradient:new a.aa(y),u_height_factor:new a.aa(y),u_edge_radius:new a.aa(y),u_ao:new a.a8(y),u_tile_id:new a.aq(y),u_zoom_transition:new a.aa(y),u_inv_rot_matrix:new a.a6(y),u_merc_center:new a.a8(y),u_up_dir:new a.aq(y),u_height_lift:new a.aa(y),u_image:new a.a7(y),u_texsize:new a.a8(y),u_pixel_coord_upper:new a.a8(y),u_pixel_coord_lower:new a.a8(y),u_tile_units_to_pixels:new a.aa(y),u_opacity:new a.aa(y)}),fillExtrusionGroundEffect:y=>({u_matrix:new a.a6(y),u_opacity:new a.aa(y),u_ao_pass:new a.aa(y),u_meter_to_tile:new a.aa(y),u_ao:new a.a8(y),u_flood_light_intensity:new a.aa(y),u_flood_light_color:new a.aq(y),u_attenuation:new a.aa(y),u_edge_radius:new a.aa(y),u_fb:new a.a7(y),u_fb_size:new a.aa(y)}),fill:y=>({u_matrix:new a.a6(y),u_emissive_strength:new a.aa(y)}),fillPattern:y=>({u_matrix:new a.a6(y),u_emissive_strength:new a.aa(y),u_image:new a.a7(y),u_texsize:new a.a8(y),u_pixel_coord_upper:new a.a8(y),u_pixel_coord_lower:new a.a8(y),u_tile_units_to_pixels:new a.aa(y)}),fillOutline:y=>({u_matrix:new a.a6(y),u_emissive_strength:new a.aa(y),u_world:new a.a8(y)}),fillOutlinePattern:y=>({u_matrix:new a.a6(y),u_emissive_strength:new a.aa(y),u_world:new a.a8(y),u_image:new a.a7(y),u_texsize:new a.a8(y),u_pixel_coord_upper:new a.a8(y),u_pixel_coord_lower:new a.a8(y),u_tile_units_to_pixels:new a.aa(y)}),circle:a.bI,collisionBox:y=>({u_matrix:new a.a6(y),u_camera_to_center_distance:new a.aa(y),u_extrude_scale:new a.a8(y)}),collisionCircle:y=>({u_matrix:new a.a6(y),u_inv_matrix:new a.a6(y),u_camera_to_center_distance:new a.aa(y),u_viewport_size:new a.a8(y)}),debug:y=>({u_color:new a.a9(y),u_matrix:new a.a6(y),u_overlay:new a.a7(y),u_overlay_scale:new a.aa(y)}),clippingMask:y=>({u_matrix:new a.a6(y)}),heatmap:y=>({u_extrude_scale:new a.aa(y),u_intensity:new a.aa(y),u_matrix:new a.a6(y),u_inv_rot_matrix:new a.a6(y),u_merc_center:new a.a8(y),u_tile_id:new a.aq(y),u_zoom_transition:new a.aa(y),u_up_dir:new a.aq(y)}),heatmapTexture:y=>({u_image:new a.a7(y),u_color_ramp:new a.a7(y),u_opacity:new a.aa(y)}),hillshade:y=>({u_matrix:new a.a6(y),u_image:new a.a7(y),u_latrange:new a.a8(y),u_light:new a.a8(y),u_shadow:new a.a9(y),u_highlight:new a.a9(y),u_emissive_strength:new a.aa(y),u_accent:new a.a9(y)}),hillshadePrepare:y=>({u_matrix:new a.a6(y),u_image:new a.a7(y),u_dimension:new a.a8(y),u_zoom:new a.aa(y)}),line:a.bJ,linePattern:a.bK,raster:y=>({u_matrix:new a.a6(y),u_normalize_matrix:new a.a6(y),u_globe_matrix:new a.a6(y),u_merc_matrix:new a.a6(y),u_grid_matrix:new a.ar(y),u_tl_parent:new a.a8(y),u_scale_parent:new a.aa(y),u_fade_t:new a.aa(y),u_opacity:new a.aa(y),u_image0:new a.a7(y),u_image1:new a.a7(y),u_brightness_low:new a.aa(y),u_brightness_high:new a.aa(y),u_saturation_factor:new a.aa(y),u_contrast_factor:new a.aa(y),u_spin_weights:new a.aq(y),u_perspective_transform:new a.a8(y),u_raster_elevation:new a.aa(y),u_zoom_transition:new a.aa(y),u_merc_center:new a.a8(y),u_cutoff_params:new a.as(y),u_colorization_mix:new a.as(y),u_colorization_offset:new a.aa(y),u_color_ramp:new a.a7(y),u_texture_offset:new a.a8(y),u_texture_res:new a.a8(y),u_emissive_strength:new a.aa(y)}),rasterParticle:y=>({u_matrix:new a.a6(y),u_normalize_matrix:new a.a6(y),u_globe_matrix:new a.a6(y),u_merc_matrix:new a.a6(y),u_grid_matrix:new a.ar(y),u_tl_parent:new a.a8(y),u_scale_parent:new a.aa(y),u_fade_t:new a.aa(y),u_opacity:new a.aa(y),u_image0:new a.a7(y),u_image1:new a.a7(y),u_raster_elevation:new a.aa(y),u_zoom_transition:new a.aa(y),u_merc_center:new a.a8(y),u_cutoff_params:new a.as(y)}),rasterParticleTexture:y=>({u_texture:new a.a7(y),u_opacity:new a.aa(y)}),rasterParticleDraw:y=>({u_particle_texture:new a.a7(y),u_particle_texture_side_len:new a.aa(y),u_tile_offset:new a.a8(y),u_velocity:new a.a7(y),u_color_ramp:new a.a7(y),u_velocity_res:new a.a8(y),u_max_speed:new a.aa(y),u_uv_offset:new a.a8(y),u_data_scale:new a.as(y),u_data_offset:new a.aa(y),u_particle_pos_scale:new a.aa(y),u_particle_pos_offset:new a.a8(y)}),rasterParticleUpdate:y=>({u_particle_texture:new a.a7(y),u_particle_texture_side_len:new a.aa(y),u_velocity:new a.a7(y),u_velocity_res:new a.a8(y),u_max_speed:new a.aa(y),u_speed_factor:new a.aa(y),u_reset_rate:new a.aa(y),u_rand_seed:new a.aa(y),u_uv_offset:new a.a8(y),u_data_scale:new a.as(y),u_data_offset:new a.aa(y),u_particle_pos_scale:new a.aa(y),u_particle_pos_offset:new a.a8(y)}),symbolIcon:y=>({u_is_size_zoom_constant:new a.a7(y),u_is_size_feature_constant:new a.a7(y),u_size_t:new a.aa(y),u_size:new a.aa(y),u_camera_to_center_distance:new a.aa(y),u_rotate_symbol:new a.a7(y),u_aspect_ratio:new a.aa(y),u_fade_change:new a.aa(y),u_matrix:new a.a6(y),u_label_plane_matrix:new a.a6(y),u_coord_matrix:new a.a6(y),u_is_text:new a.a7(y),u_pitch_with_map:new a.a7(y),u_texsize:new a.a8(y),u_tile_id:new a.aq(y),u_zoom_transition:new a.aa(y),u_inv_rot_matrix:new a.a6(y),u_merc_center:new a.a8(y),u_camera_forward:new a.aq(y),u_tile_matrix:new a.a6(y),u_up_vector:new a.aq(y),u_ecef_origin:new a.aq(y),u_texture:new a.a7(y),u_icon_transition:new a.aa(y),u_color_adj_mat:new a.a6(y)}),symbolSDF:y=>({u_is_size_zoom_constant:new a.a7(y),u_is_size_feature_constant:new a.a7(y),u_size_t:new a.aa(y),u_size:new a.aa(y),u_camera_to_center_distance:new a.aa(y),u_rotate_symbol:new a.a7(y),u_aspect_ratio:new a.aa(y),u_fade_change:new a.aa(y),u_matrix:new a.a6(y),u_label_plane_matrix:new a.a6(y),u_coord_matrix:new a.a6(y),u_is_text:new a.a7(y),u_pitch_with_map:new a.a7(y),u_texsize:new a.a8(y),u_texture:new a.a7(y),u_gamma_scale:new a.aa(y),u_device_pixel_ratio:new a.aa(y),u_tile_id:new a.aq(y),u_zoom_transition:new a.aa(y),u_inv_rot_matrix:new a.a6(y),u_merc_center:new a.a8(y),u_camera_forward:new a.aq(y),u_tile_matrix:new a.a6(y),u_up_vector:new a.aq(y),u_ecef_origin:new a.aq(y),u_is_halo:new a.a7(y)}),symbolTextAndIcon:y=>({u_is_size_zoom_constant:new a.a7(y),u_is_size_feature_constant:new a.a7(y),u_size_t:new a.aa(y),u_size:new a.aa(y),u_camera_to_center_distance:new a.aa(y),u_rotate_symbol:new a.a7(y),u_aspect_ratio:new a.aa(y),u_fade_change:new a.aa(y),u_matrix:new a.a6(y),u_label_plane_matrix:new a.a6(y),u_coord_matrix:new a.a6(y),u_is_text:new a.a7(y),u_pitch_with_map:new a.a7(y),u_texsize:new a.a8(y),u_texsize_icon:new a.a8(y),u_texture:new a.a7(y),u_texture_icon:new a.a7(y),u_gamma_scale:new a.aa(y),u_device_pixel_ratio:new a.aa(y),u_is_halo:new a.a7(y)}),background:y=>({u_matrix:new a.a6(y),u_emissive_strength:new a.aa(y),u_opacity:new a.aa(y),u_color:new a.a9(y)}),backgroundPattern:y=>({u_matrix:new a.a6(y),u_emissive_strength:new a.aa(y),u_opacity:new a.aa(y),u_image:new a.a7(y),u_pattern_tl:new a.a8(y),u_pattern_br:new a.a8(y),u_texsize:new a.a8(y),u_pattern_size:new a.a8(y),u_pixel_coord_upper:new a.a8(y),u_pixel_coord_lower:new a.a8(y),u_tile_units_to_pixels:new a.aa(y)}),terrainRaster:Kl,terrainDepth:Kl,skybox:y=>({u_matrix:new a.a6(y),u_sun_direction:new a.aq(y),u_cubemap:new a.a7(y),u_opacity:new a.aa(y),u_temporal_offset:new a.aa(y)}),skyboxGradient:y=>({u_matrix:new a.a6(y),u_color_ramp:new a.a7(y),u_center_direction:new a.aq(y),u_radius:new a.aa(y),u_opacity:new a.aa(y),u_temporal_offset:new a.aa(y)}),skyboxCapture:y=>({u_matrix_3f:new a.ar(y),u_sun_direction:new a.aq(y),u_sun_intensity:new a.aa(y),u_color_tint_r:new a.as(y),u_color_tint_m:new a.as(y),u_luminance:new a.aa(y)}),globeRaster:y=>({u_proj_matrix:new a.a6(y),u_globe_matrix:new a.a6(y),u_normalize_matrix:new a.a6(y),u_merc_matrix:new a.a6(y),u_zoom_transition:new a.aa(y),u_merc_center:new a.a8(y),u_image0:new a.a7(y),u_grid_matrix:new a.ar(y),u_skirt_height:new a.aa(y),u_far_z_cutoff:new a.aa(y),u_frustum_tl:new a.aq(y),u_frustum_tr:new a.aq(y),u_frustum_br:new a.aq(y),u_frustum_bl:new a.aq(y),u_globe_pos:new a.aq(y),u_globe_radius:new a.aa(y),u_viewport:new a.a8(y)}),globeAtmosphere:y=>({u_frustum_tl:new a.aq(y),u_frustum_tr:new a.aq(y),u_frustum_br:new a.aq(y),u_frustum_bl:new a.aq(y),u_horizon:new a.aa(y),u_transition:new a.aa(y),u_fadeout_range:new a.aa(y),u_color:new a.as(y),u_high_color:new a.as(y),u_space_color:new a.as(y),u_temporal_offset:new a.aa(y),u_horizon_angle:new a.aa(y)}),model:y=>({u_matrix:new a.a6(y),u_lighting_matrix:new a.a6(y),u_normal_matrix:new a.a6(y),u_node_matrix:new a.a6(y),u_lightpos:new a.aq(y),u_lightintensity:new a.aa(y),u_lightcolor:new a.aq(y),u_camera_pos:new a.aq(y),u_opacity:new a.aa(y),u_baseColorFactor:new a.as(y),u_emissiveFactor:new a.as(y),u_metallicFactor:new a.aa(y),u_roughnessFactor:new a.aa(y),u_baseTextureIsAlpha:new a.a7(y),u_alphaMask:new a.a7(y),u_alphaCutoff:new a.aa(y),u_baseColorTexture:new a.a7(y),u_metallicRoughnessTexture:new a.a7(y),u_normalTexture:new a.a7(y),u_occlusionTexture:new a.a7(y),u_emissionTexture:new a.a7(y),u_lutTexture:new a.a7(y),u_color_mix:new a.as(y),u_aoIntensity:new a.aa(y),u_emissive_strength:new a.aa(y),u_occlusionTextureTransform:new a.as(y)}),modelDepth:y=>({u_matrix:new a.a6(y),u_instance:new a.a6(y),u_node_matrix:new a.a6(y)}),groundShadow:y=>({u_matrix:new a.a6(y),u_ground_shadow_factor:new a.aq(y)}),stars:y=>({u_matrix:new a.a6(y),u_up:new a.aq(y),u_right:new a.aq(y),u_intensity_multiplier:new a.aa(y)}),occlusion:y=>({u_matrix:new a.a6(y),u_anchorPos:new a.aq(y),u_screenSizePx:new a.a8(y),u_occluderSizePx:new a.a8(y),u_color:new a.as(y)})};function bp(y,l,d){const v=l.createTileMatrix(y,y.worldSize,d.toUnwrapped());return a.ad.multiply(new Float32Array(16),y.projMatrix,v)}function AA(y,l,d){if(l.projection.name===d.projection.name)return y.projMatrix;const v=d.clone();return v.setProjection(l.projection),bp(v,l.getProjection(),y)}function wc(y,l,d){return l.name===d.projection.name?y.projMatrix:bp(d,l,y)}let wp;function xf(y,l,d,v,S,T,P){const I=y.context,L=I.gl,F=y.transform,V=y.getOrCreateProgram("collisionBox"),Z=[];let Q=0,J=0;for(let ye=0;ye<v.length;ye++){const Ce=v[ye],Ae=l.getTile(Ce),pe=Ae.getBucket(d);if(!pe)continue;const _e=AA(Ce,pe,F);let xe=_e;S[0]===0&&S[1]===0||(xe=y.translatePosMatrix(_e,Ae,S,T));const Re=P?pe.textCollisionBox:pe.iconCollisionBox,Ge=pe.collisionCircleArray;if(Ge.length>0){const Te=a.ad.create(),We=xe;a.ad.mul(Te,pe.placementInvProjMatrix,F.glCoordMatrix),a.ad.mul(Te,Te,pe.placementViewportMatrix),Z.push({circleArray:Ge,circleOffset:J,transform:We,invTransform:Te,projection:pe.getProjection()}),Q+=Ge.length/4,J=Q}Re&&(y.terrain&&y.terrain.setupElevationDraw(Ae,V),V.draw(y,L.LINES,a.ae.disabled,a.ag.disabled,y.colorModeForRenderPass(),a.af.disabled,Fy(xe,F,Ae,pe.getProjection()),d.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,null,F.zoom,null,[Re.collisionVertexBuffer,Re.collisionVertexBufferExt]))}if(!P||!Z.length)return;const ie=y.getOrCreateProgram("collisionCircle"),oe=new a.bL;oe.resize(4*Q),oe._trim();let ae=0;for(const ye of Z)for(let Ce=0;Ce<ye.circleArray.length/4;Ce++){const Ae=4*Ce,pe=ye.circleArray[Ae+0],_e=ye.circleArray[Ae+1],xe=ye.circleArray[Ae+2],Re=ye.circleArray[Ae+3];oe.emplace(ae++,pe,_e,xe,Re,0),oe.emplace(ae++,pe,_e,xe,Re,1),oe.emplace(ae++,pe,_e,xe,Re,2),oe.emplace(ae++,pe,_e,xe,Re,3)}(!wp||wp.length<2*Q)&&(wp=function(ye){const Ce=2*ye,Ae=new a.bu;Ae.resize(Ce),Ae._trim();for(let pe=0;pe<Ce;pe++){const _e=6*pe;Ae.uint16[_e+0]=4*pe+0,Ae.uint16[_e+1]=4*pe+1,Ae.uint16[_e+2]=4*pe+2,Ae.uint16[_e+3]=4*pe+2,Ae.uint16[_e+4]=4*pe+3,Ae.uint16[_e+5]=4*pe+0}return Ae}(Q));const se=I.createIndexBuffer(wp,!0),me=I.createVertexBuffer(oe,a.bM.members,!0);for(const ye of Z){const Ce={u_matrix:ye.transform,u_inv_matrix:ye.invTransform,u_camera_to_center_distance:(ge=F).getCameraToCenterDistance(ye.projection),u_viewport_size:[ge.width,ge.height]};ie.draw(y,L.TRIANGLES,a.ae.disabled,a.ag.disabled,y.colorModeForRenderPass(),a.af.disabled,Ce,d.id,me,se,a.b.simpleSegment(0,2*ye.circleOffset,ye.circleArray.length,ye.circleArray.length/2),null,F.zoom)}var ge;me.destroy(),se.destroy()}const ru=a.ad.create();function i1(y){const l=y._camera.getWorldToCamera(y.worldSize,1),d=a.ad.multiply([],l,y.globeMatrix);a.ad.invert(d,d);const v=[0,0,0],S=[0,1,0,0];return a.aA.transformMat4(S,S,d),v[0]=S[0],v[1]=S[1],v[2]=S[2],a._.normalize(v,v),v}function CA({width:y,height:l,anchor:d,textOffset:v,textScale:S},T){const{horizontalAlign:P,verticalAlign:I}=a.bQ(d),L=-(P-.5)*y,F=-(I-.5)*l,V=a.bP(d,v);return new a.P((L/S+V[0])*T,(F/S+V[1])*T)}function o1(y,l,d,v,S,T,P,I,L,F,V){const Z=y.text.placedSymbolArray,Q=y.text.dynamicLayoutVertexArray,J=y.icon.dynamicLayoutVertexArray,ie={},oe=y.getProjection(),ae=wc(I,oe,T),se=T.elevation,me=oe.upVectorScale(I.canonical,T.center.lat,T.worldSize).metersToTile;Q.clear();for(let ge=0;ge<Z.length;ge++){const ye=Z.get(ge),{tileAnchorX:Ce,tileAnchorY:Ae,numGlyphs:pe}=ye,_e=ye.hidden||!ye.crossTileID||y.allowVerticalPlacement&&!ye.placedOrientation?null:v[ye.crossTileID];if(_e){let xe=0,Re=0,Ge=0;if(se){const ct=se?se.getAtTileOffset(I,Ce,Ae):0,[Ot,kt,Nt]=oe.upVector(I.canonical,Ce,Ae);xe=ct*Ot*me,Re=ct*kt*me,Ge=ct*Nt*me}let[Te,We,qe,dt]=oa(ye.projectedAnchorX+xe,ye.projectedAnchorY+Re,ye.projectedAnchorZ+Ge,d?ae:P);const mt=Xi(T.getCameraToCenterDistance(oe),dt);let ft=S.evaluateSizeForFeature(y.textSizeData,F,ye)*mt/a.bN;d&&(ft*=y.tilePixelRatio/L);const Be=CA(_e,ft);d?({x:Te,y:We,z:qe}=oe.projectTilePoint(Ce+Be.x,Ae+Be.y,I.canonical),[Te,We,qe]=oa(Te+xe,We+Re,qe+Ge,P)):(l&&Be._rotate(-T.angle),Te+=Be.x,We+=Be.y,qe=0);const Je=y.allowVerticalPlacement&&ye.placedOrientation===a.aE.vertical?Math.PI/2:0;for(let ct=0;ct<pe;ct++)a.aH(Q,Te,We,qe,Je);V&&ye.associatedIconIndex>=0&&(ie[ye.associatedIconIndex]={x:Te,y:We,z:qe,angle:Je})}else eu(pe,Q)}if(V){J.clear();const ge=y.icon.placedSymbolArray;for(let ye=0;ye<ge.length;ye++){const Ce=ge.get(ye),{numGlyphs:Ae}=Ce,pe=ie[ye];if(Ce.hidden||!pe)eu(Ae,J);else{const{x:_e,y:xe,z:Re,angle:Ge}=pe;for(let Te=0;Te<Ae;Te++)a.aH(J,_e,xe,Re,Ge)}}y.icon.dynamicLayoutVertexBuffer.updateData(J)}y.text.dynamicLayoutVertexBuffer.updateData(Q)}function Uy(y,l,d,v,S,T,P={}){const I=d.paint.get("icon-translate"),L=d.paint.get("text-translate"),F=d.paint.get("icon-translate-anchor"),V=d.paint.get("text-translate-anchor"),Z=d.layout.get("icon-rotation-alignment"),Q=d.layout.get("text-rotation-alignment"),J=d.layout.get("icon-pitch-alignment"),ie=d.layout.get("text-pitch-alignment"),oe=d.layout.get("icon-keep-upright"),ae=d.layout.get("text-keep-upright"),se=d.paint.get("icon-color-saturation"),me=d.paint.get("icon-color-contrast"),ge=d.paint.get("icon-color-brightness-min"),ye=d.paint.get("icon-color-brightness-max"),Ce=d.paint.get("icon-occlusion-opacity").constantOr(0),Ae=d.paint.get("text-occlusion-opacity").constantOr(0),pe=y.context,_e=pe.gl,xe=y.transform,Re=Z==="map",Ge=Q==="map",Te=J==="map",We=ie==="map",qe=Ce!==1,dt=Ae!==1,mt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ft=!1;const Be=y.depthModeForSublayer(0,a.ae.ReadOnly),Je=[a.aj(xe.center.lng),a.ak(xe.center.lat)],ct=d.layout.get("text-variable-anchor"),Ot=xe.projection.name==="globe",kt=[],Nt=[0,-1,0];for(const Dt of v){const vt=l.getTile(Dt),at=vt.getBucket(d);if(!at||at.projection.name==="mercator"&&Ot||at.fullyClipped)continue;const $t=at.projection.name==="globe",vn=$t?a.a1(xe.zoom):0,mn=wc(Dt,at.getProjection(),xe),On=xe.calculatePixelsToTileUnitsMatrix(vt),Nn=ct&&at.hasTextData(),lr=at.hasIconTextFit()&&Nn&&at.hasIconData(),pn=at.getProjection().createInversionMatrix(xe,Dt.canonical),tr=()=>{const pt=Re&&d.layout.get("symbol-placement")!=="point",zt=[];d.hasInitialOcclusionOpacityProperties&&qe&&y.symbolParams.useOcclusionQueries&&!$t&&!Ot&&zt.push("OCCLUSION_QUERIES"),d.hasInitialOcclusionOpacityProperties||zt.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH");const Nr=pt||lr,nr=d.paint.get("icon-image-cross-fade").constantOr(0);y.terrainRenderModeElevated()&&Te&&zt.push("PITCH_WITH_MAP_TERRAIN"),$t&&(zt.push("PROJECTION_GLOBE_VIEW"),Nr&&zt.push("PROJECTED_POS_ON_VIEWPORT")),nr>0&&zt.push("ICON_TRANSITION"),at.icon.zOffsetVertexBuffer&&zt.push("Z_OFFSET"),se===0&&me===0&&ge===0&&ye===1||zt.push("COLOR_ADJUSTMENT");const Ve=at.icon.programConfigurations.get(d.id),Uo=y.getOrCreateProgram(at.sdfIcons?"symbolSDF":"symbolIcon",{config:Ve,defines:zt});let zi;const ao=vt.imageAtlasTexture?vt.imageAtlasTexture.size:[0,0],Ti=at.iconSizeData,_o=a.aD(Ti,xe.zoom),Pa=Te||xe.pitch!==0,Vo=Ql(mn,vt.tileID.canonical,Te,Re,xe,at.getProjection(),On),wl=mc(mn,vt.tileID.canonical,Te,Re,xe,at.getProjection(),On),Sl=y.translatePosMatrix(wl,vt,I,F,!0),ks=y.translatePosMatrix(mn,vt,I,F),rs=Nr?ru:Vo,Ds=Re&&!Te&&!pt;let Lc=Nt;!Ot&&!xe.mercatorFromTransition||Re||(Lc=i1(xe));const zc=$t?Lc:Nt;if(at.sdfIcons&&!at.iconsInText)zi=xp(Ti.kind,_o,Ds,Te,y,ks,rs,Sl,!1,ao,!0,Dt,vn,Je,pn,zc,at.getProjection());else{const gi=d.getColorAdjustmentMatrix(se,me,ge,ye);zi=bc(Ti.kind,_o,Ds,Te,y,ks,rs,Sl,!1,ao,Dt,vn,Je,pn,zc,at.getProjection(),gi,nr)}const pu=vt.imageAtlasTexture?vt.imageAtlasTexture:null,Fc=d.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear,Vp=at.sdfIcons||y.options.rotating||y.options.zooming||Fc||Pa?_e.LINEAR:_e.NEAREST,Gp=at.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,x_=y.terrain&&Te&&pt?a.ad.invert(a.ad.create(),Vo):ru;if(pt&&at.icon){const gi=xe.elevation,b_=gi?gi.getAtTileOffsetFunc(Dt,xe.center.lat,xe.worldSize,at.getProjection()):null,Nc=Jl(mn,vt.tileID.canonical,Te,Re,xe,at.getProjection(),On);sp(at,mn,y,!1,Nc,wl,Te,oe,b_,Dt)}return{program:Uo,buffers:at.icon,uniformValues:zi,atlasTexture:pu,atlasTextureIcon:null,atlasInterpolation:Vp,atlasInterpolationIcon:null,isSDF:at.sdfIcons,hasHalo:Gp,tile:vt,labelPlaneMatrixInv:x_}},br=()=>{const pt=Ge&&d.layout.get("symbol-placement")!=="point",zt=[],Nr=pt||ct||lr;d.hasInitialOcclusionOpacityProperties&&dt&&y.symbolParams.useOcclusionQueries&&!$t&&!Ot&&zt.push("OCCLUSION_QUERIES"),d.hasInitialOcclusionOpacityProperties||zt.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH"),y.terrainRenderModeElevated()&&We&&zt.push("PITCH_WITH_MAP_TERRAIN"),$t&&(zt.push("PROJECTION_GLOBE_VIEW"),Nr&&zt.push("PROJECTED_POS_ON_VIEWPORT")),at.text.zOffsetVertexBuffer&&zt.push("Z_OFFSET");const nr=at.text.programConfigurations.get(d.id),Ve=y.getOrCreateProgram(at.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:nr,defines:zt});let Uo,zi=[0,0],ao=null;const Ti=at.textSizeData;at.iconsInText&&(zi=vt.imageAtlasTexture?vt.imageAtlasTexture.size:[0,0],ao=vt.imageAtlasTexture?vt.imageAtlasTexture:null,Uo=We||xe.pitch!==0||y.options.rotating||y.options.zooming||Ti.kind==="composite"||Ti.kind==="camera"?_e.LINEAR:_e.NEAREST);const _o=vt.glyphAtlasTexture?vt.glyphAtlasTexture.size:[0,0],Pa=a.aD(Ti,xe.zoom),Vo=Ql(mn,vt.tileID.canonical,We,Ge,xe,at.getProjection(),On),wl=mc(mn,vt.tileID.canonical,We,Ge,xe,at.getProjection(),On),Sl=y.translatePosMatrix(wl,vt,L,V,!0),ks=y.translatePosMatrix(mn,vt,L,V),rs=Nr?ru:Vo,Ds=Ge&&!We&&!pt;let Lc=Nt;!Ot&&!xe.mercatorFromTransition||Ge||(Lc=i1(xe));const zc=$t?Lc:Nt;let pu;pu=at.iconsInText?e1(Ti.kind,Pa,Ds,We,y,ks,rs,Sl,_o,zi,Dt,vn,Je,pn,zc,at.getProjection()):xp(Ti.kind,Pa,Ds,We,y,ks,rs,Sl,!0,_o,!0,Dt,vn,Je,pn,zc,at.getProjection());const Fc=vt.glyphAtlasTexture?vt.glyphAtlasTexture:null,Vp=_e.LINEAR,Gp=d.paint.get("text-halo-width").constantOr(1)!==0,x_=y.terrain&&We&&pt?a.ad.invert(a.ad.create(),Vo):ru;if(pt&&at.text){const gi=xe.elevation,b_=gi?gi.getAtTileOffsetFunc(Dt,xe.center.lat,xe.worldSize,at.getProjection()):null,Nc=Jl(mn,vt.tileID.canonical,We,Ge,xe,at.getProjection(),On);sp(at,mn,y,!0,Nc,wl,We,ae,b_,Dt)}return{program:Ve,buffers:at.text,uniformValues:pu,atlasTexture:Fc,atlasTextureIcon:ao,atlasInterpolation:Vp,atlasInterpolationIcon:Uo,isSDF:!0,hasHalo:Gp,tile:vt,labelPlaneMatrixInv:x_}},or=at.icon.segments.get().length,Dn=at.text.segments.get().length,gn=or&&!P.onlyText?tr():null,Er=Dn&&!P.onlyIcons?br():null,Pr=d.paint.get("icon-opacity").constantOr(1),ur=d.paint.get("text-opacity").constantOr(1);if(mt&&at.canOverlap){ft=!0;const pt=Pr&&!P.onlyText?at.icon.segments.get():[],zt=ur&&!P.onlyIcons?at.text.segments.get():[];for(const Nr of pt)kt.push({segments:new a.b([Nr]),sortKey:Nr.sortKey,state:gn});for(const Nr of zt)kt.push({segments:new a.b([Nr]),sortKey:Nr.sortKey,state:Er})}else P.onlyText||kt.push({segments:Pr?at.icon.segments:new a.b([]),sortKey:0,state:gn}),P.onlyIcons||kt.push({segments:ur?at.text.segments:new a.b([]),sortKey:0,state:Er})}ft&&kt.sort((Dt,vt)=>Dt.sortKey-vt.sortKey);for(const Dt of kt){const vt=Dt.state;if(vt)if(y.terrain&&y.terrain.setupElevationDraw(vt.tile,vt.program,{useDepthForOcclusion:!d.hasInitialOcclusionOpacityProperties&&xe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:vt.labelPlaneMatrixInv}),pe.activeTexture.set(_e.TEXTURE0),vt.atlasTexture&&vt.atlasTexture.bind(vt.atlasInterpolation,_e.CLAMP_TO_EDGE,!0),vt.atlasTextureIcon&&(pe.activeTexture.set(_e.TEXTURE1),vt.atlasTextureIcon&&vt.atlasTextureIcon.bind(vt.atlasInterpolationIcon,_e.CLAMP_TO_EDGE,!0)),y.uploadCommonLightUniforms(y.context,vt.program),vt.hasHalo){const at=vt.uniformValues;at.u_is_halo=1,Sc(vt.buffers,Dt.segments,d,y,vt.program,Be,S,T,at,2),at.u_is_halo=0}else{if(vt.isSDF){const at=vt.uniformValues;vt.hasHalo&&(at.u_is_halo=1,Sc(vt.buffers,Dt.segments,d,y,vt.program,Be,S,T,at,1)),at.u_is_halo=0}Sc(vt.buffers,Dt.segments,d,y,vt.program,Be,S,T,vt.uniformValues,1)}}}function Sc(y,l,d,v,S,T,P,I,L,F){const V=v.context.gl,Z=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.iconTransitioningVertexBuffer,y.globeExtVertexBuffer,y.zOffsetVertexBuffer];y.occlusionQueryOpacityVertexBuffer.length>0&&Z.push(y.occlusionQueryOpacityVertexBuffer),S.draw(v,V.TRIANGLES,T,P,I,a.af.disabled,L,d.id,y.layoutVertexBuffer,y.indexBuffer,l,d.paint,v.transform.zoom,y.programConfigurations.get(d.id),Z,F)}function Vy(y,l,d,v,S,T,P){const I=y.context.gl,L=d.paint.get("fill-pattern"),F=L&&L.constantOr(1);let V,Z,Q,J,ie;P?(Z=F&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=I.LINES):(Z=F?"fillPattern":"fill",V=I.TRIANGLES);for(const oe of v){const ae=l.getTile(oe);if(F&&!ae.patternsLoaded())continue;const se=ae.getBucket(d);if(!se)continue;y.prepareDrawTile();const me=se.programConfigurations.get(d.id),ge=y.isTileAffectedByFog(oe),ye=y.getOrCreateProgram(Z,{config:me,overrideFog:ge});F&&(y.context.activeTexture.set(I.TEXTURE0),ae.imageAtlasTexture&&ae.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),me.updatePaintBuffers());const Ce=L.constantOr(null);if(Ce&&ae.imageAtlas){const _e=ae.imageAtlas.patternPositions[Ce.toString()];_e&&me.setConstantPatternPositions(_e)}const Ae=y.translatePosMatrix(oe.projMatrix,ae,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),pe=d.paint.get("fill-emissive-strength");if(P){J=se.indexBuffer2,ie=se.segments2;const _e=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];Q=Z==="fillOutlinePattern"&&F?_p(Ae,pe,y,ae,_e):Qx(Ae,pe,_e)}else J=se.indexBuffer,ie=se.segments,Q=F?zy(Ae,pe,y,ae):Ly(Ae,pe);y.uploadCommonUniforms(y.context,ye,oe.toUnwrapped()),ye.draw(y,V,S,y.stencilModeForClipping(oe),T,a.af.disabled,Q,d.id,se.layoutVertexBuffer,J,ie,d.paint,y.transform.zoom,me,void 0)}}function Tc(y,l,d,v,S,T,P,I){d.resetLayerRenderingStats(y);const L=y.context,F=L.gl,V=y.transform,Z=d.paint.get("fill-extrusion-pattern"),Q=Z.constantOr(1),J=d.paint.get("fill-extrusion-opacity"),ie=y.style.enable3dLights(),oe=d.paint.get(ie&&!Q?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ae=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe],se=d.layout.get("fill-extrusion-edge-radius"),me=se>0&&!d.paint.get("fill-extrusion-rounded-roof"),ge=me?0:se,ye=V.projection.name==="globe"?a.bY():0,Ce=V.projection.name==="globe",Ae=Ce?a.a1(V.zoom):0,pe=[a.aj(V.center.lng),a.ak(V.center.lat)],_e=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(d.lut).toArray01().slice(0,3),xe=d.paint.get("fill-extrusion-flood-light-intensity"),Re=d.paint.get("fill-extrusion-vertical-scale"),Ge=Ps(y,d.paint.get("fill-extrusion-cutoff-fade-range")),Te=d.paint.get("fill-extrusion-emissive-strength"),We=[];let qe;Ce&&We.push("PROJECTION_GLOBE_VIEW"),ae[0]>0&&We.push("FAUX_AO"),me&&We.push("ZERO_ROOF_RADIUS"),I&&We.push("HAS_CENTROID"),xe>0&&We.push("FLOOD_LIGHT"),Ge.shouldRenderCutoff&&We.push("RENDER_CUTOFF");const dt=y.renderPass==="shadow",mt=y.shadowRenderer,ft=dt&&!!mt;y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!0);let Be=[0,0,0];if(mt){const Ot=y.style.directionalLight,kt=y.style.ambientLight;Ot&&kt&&(Be=Ms(y.style,Ot,kt)),qe=We.concat(["SHADOWS_SINGLE_CASCADE"])}const Je=ft?"fillExtrusionDepth":Q?"fillExtrusionPattern":"fillExtrusion",ct=d.getLayerRenderingStats();for(const Ot of v){const kt=l.getTile(Ot),Nt=kt.getBucket(d);if(!Nt||Nt.projection.name!==V.projection.name)continue;let Dt=!1;mt&&(Dt=mt.getMaxCascadeForTile(Ot.toUnwrapped())===0);const vt=y.isTileAffectedByFog(Ot),at=Nt.programConfigurations.get(d.id),$t=y.getOrCreateProgram(Je,{config:at,defines:Dt?qe:We,overrideFog:vt});if(y.terrain&&y.terrain.setupElevationDraw(kt,$t,{useMeterToDem:!0}),!Nt.centroidVertexBuffer){const pn=$t.attributes.a_centroid_pos;pn!==void 0&&F.vertexAttrib2f(pn,0,0)}!dt&&mt&&mt.setupShadows(kt.tileID.toUnwrapped(),$t,"vector-tile",kt.tileID.overscaledZ),Q&&(y.context.activeTexture.set(F.TEXTURE0),kt.imageAtlasTexture&&kt.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),at.updatePaintBuffers());const vn=Z.constantOr(null);if(vn&&kt.imageAtlas){const pn=kt.imageAtlas.patternPositions[vn.toString()];pn&&at.setConstantPatternPositions(pn)}const mn=d.paint.get("fill-extrusion-vertical-gradient");let On;if(dt&&mt){if(Gy(kt.tileID,Nt,y))continue;const pn=mt.calculateShadowPassMatrixFromTile(kt.tileID.toUnwrapped());On=xc(pn,ge,Re)}else{const pn=y.translatePosMatrix(Ot.expandedProjMatrix,kt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),tr=V.projection.createInversionMatrix(V,Ot.canonical);On=Q?Dy(pn,y,mn,J,ae,ge,Ot,kt,ye,Ae,pe,tr,_e,Re):vc(pn,y,mn,J,ae,ge,Ot,ye,Ae,pe,tr,_e,Re,xe,Be,Te)}y.uploadCommonUniforms(L,$t,Ot.toUnwrapped(),null,Ge);let Nn=Nt.segments;if(V.projection.name==="mercator"&&!dt&&(Nn=Nt.getVisibleSegments(kt.tileID,y.terrain,y.transform.getFrustum(0)),!Nn.get().length))continue;if(ct)if(dt)for(const pn of Nn.get())ct.numRenderedVerticesInShadowPass+=pn.primitiveLength;else for(const pn of Nn.get())ct.numRenderedVerticesInTransparentPass+=pn.primitiveLength;const lr=[];(y.terrain||I)&&lr.push(Nt.centroidVertexBuffer),Ce&&lr.push(Nt.layoutVertexExtBuffer),$t.draw(y,L.gl.TRIANGLES,S,T,P,a.af.backCCW,On,d.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nn,d.paint,y.transform.zoom,at,lr)}y.shadowRenderer&&(y.shadowRenderer.useNormalOffset=!1)}function po(y,l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae,se,me){const ge=y.context,ye=ge.gl,Ce=y.transform,Ae=y.transform.zoom,pe=[],_e=Ps(y,d.paint.get("fill-extrusion-cutoff-fade-range"));F==="clear"?(pe.push("CLEAR_SUBPASS"),me&&(pe.push("CLEAR_FROM_TEXTURE"),ge.activeTexture.set(ye.TEXTURE0),me.bind(ye.LINEAR,ye.CLAMP_TO_EDGE))):F==="sdf"&&pe.push("SDF_SUBPASS"),ae&&pe.push("HAS_CENTROID"),_e.shouldRenderCutoff&&pe.push("RENDER_CUTOFF");const xe=d.layout.get("fill-extrusion-edge-radius"),Re=(Ge,Te,We,qe,dt)=>{const mt=Te.programConfigurations.get(d.id),ft=y.isTileAffectedByFog(Ge),Be=y.getOrCreateProgram("fillExtrusionGroundEffect",{config:mt,defines:pe,overrideFog:ft}),Je=((Ot,kt,Nt,Dt,vt,at,$t,vn,mn,On,Nn)=>({u_matrix:kt,u_opacity:Nt,u_ao_pass:Dt?1:0,u_meter_to_tile:vt,u_ao:at,u_flood_light_intensity:$t,u_flood_light_color:vn,u_attenuation:mn,u_edge_radius:On,u_fb:0,u_fb_size:Nn}))(0,qe,V,L,dt,[Z,Q*dt],J,ie,oe,Ae>=17?0:xe*dt,me?me.size[0]:0),ct=[];ae&&ct.push(Te.hiddenByLandmarkVertexBuffer),y.uploadCommonUniforms(ge,Be,Ge.toUnwrapped(),null,_e),Be.draw(y,ge.gl.TRIANGLES,S,T,P,I,Je,d.id,Te.vertexBuffer,Te.indexBuffer,We,d.paint,Ae,mt,ct)};for(const Ge of v){const Te=l.getTile(Ge),We=Te.getBucket(d);if(!We||We.projection.name!==Ce.projection.name||!We.groundEffect||We.groundEffect&&!We.groundEffect.hasData())continue;const qe=We.groundEffect,dt=1/We.tileToMeter;{const mt=y.translatePosMatrix(Ge.projMatrix,Te,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),ft=qe.getDefaultSegment();Re(Ge,qe,ft,mt,dt)}if(se)for(let mt=0;mt<4;mt++){const ft=a.bZ[mt](Ge),Be=l.getTile(ft);if(!Be)continue;const Je=Be.getBucket(d);if(!Je||Je.projection.name!==Ce.projection.name||!Je.groundEffect||Je.groundEffect&&!Je.groundEffect.hasData())continue;const ct=Je.groundEffect;let Ot,kt;mt===0?(Ot=[-a.a3,0,0],kt=1):mt===1?(Ot=[a.a3,0,0],kt=0):mt===2?(Ot=[0,-a.a3,0],kt=3):(Ot=[0,a.a3,0],kt=2);const Nt=ct.regionSegments[kt];if(!Nt)continue;const Dt=new Float32Array(16);a.ad.translate(Dt,Ge.projMatrix,Ot),Re(Ge,ct,Nt,y.translatePosMatrix(Dt,Te,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),dt)}}}function Sp(y,l,d,v,S,T,P){v.centroidVertexArray.length===0&&v.createCentroidsBuffer();const I=T?T.findDEMTileFor(d):null;if(!(I&&I.dem||P))return;const L=se=>new a.P(Math.ceil((se+a.c0)*a.c1),0),F=se=>{const me=l.getSource().minzoom,ge=Ce=>{const Ae=l.getTileByID(Ce);if(Ae&&Ae.hasData())return Ae.getBucket(S)},ye=[0,-1,1];for(const Ce of ye){if(se.overscaledZ+Ce<me)continue;const Ae=ge(se.calculateScaledKey(se.overscaledZ+Ce));if(Ae)return Ae}},V=[0,0,0],Z=(se,me)=>(V[0]=Math.min(se.min.y,me.min.y),V[1]=Math.max(se.max.y,me.max.y),V[2]=a.a3-me.min.x>se.max.x?me.min.x-a.a3:se.max.x,V),Q=(se,me)=>(V[0]=Math.min(se.min.x,me.min.x),V[1]=Math.max(se.max.x,me.max.x),V[2]=a.a3-me.min.y>se.max.y?me.min.y-a.a3:se.max.y,V),J=[(se,me)=>Z(se,me),(se,me)=>Z(me,se),(se,me)=>Q(se,me),(se,me)=>Q(me,se)],ie=(se,me,ge,ye,Ce,Ae,pe)=>{if(!T)return 0;const _e=[[Ae?ge:se,Ae?se:ge,0],[Ae?ge:me,Ae?me:ge,0]],xe=pe<0?a.a3+pe:pe,Re=[Ae?xe:(se+me)/2,Ae?(se+me)/2:xe,0];return ge===0&&pe<0||ge!==0&&pe>0?T.getForTilePoints(Ce,[Re],!0,ye):_e.push(Re),T.getForTilePoints(d,_e,!0,I),Math.max(_e[0][2],_e[1][2],Re[2])/T.exaggeration()};for(let se=0;se<4;se++){const me=v.borderFeatureIndices[se];if(me.length===0)continue;const ge=a.bZ[se](d),ye=F(ge);if(!(ye&&ye instanceof a.b_)||v.borderDoneWithNeighborZ[se]===ye.canonical.z)continue;ye.centroidVertexArray.length===0&&ye.createCentroidsBuffer();const Ce=T?T.findDEMTileFor(ge):null;if(!(Ce&&Ce.dem||P))continue;const Ae=(se<2?1:5)-se,pe=ye.borderDoneWithNeighborZ[Ae]!==v.canonical.z,_e=ye.borderFeatureIndices[Ae];let xe=0;if(v.canonical.z!==ye.canonical.z){for(const Re of me)v.showCentroid(v.featuresOnBorder[Re]);if(pe)for(const Re of _e)ye.showCentroid(ye.featuresOnBorder[Re]);v.borderDoneWithNeighborZ[se]=ye.canonical.z,ye.borderDoneWithNeighborZ[Ae]=v.canonical.z}for(const Re of me){const Ge=v.featuresOnBorder[Re],Te=v.centroidData[Ge.centroidDataIndex],We=Ge.borders[se];let qe;for(;xe<_e.length;){qe=ye.featuresOnBorder[_e[xe]];const dt=qe.borders[Ae];if(dt[1]>We[0]+3||dt[0]>We[0]-3)break;ye.showCentroid(qe),xe++}if(qe&&xe<_e.length){const dt=xe;let mt=0;for(;!(qe.borders[Ae][0]>We[1]-3)&&(mt++,++xe!==_e.length);)qe=ye.featuresOnBorder[_e[xe]];if(qe=ye.featuresOnBorder[_e[dt]],mt>1){const Je=qe.borders[Ae];Math.abs(We[0]-Je[0])<3&&Math.abs(We[1]-Je[1])<3&&(mt=1,xe=dt+1)}else if(mt===0){v.showCentroid(Ge);continue}const ft=ye.centroidData[qe.centroidDataIndex];P&&mt===1&&(((oe=Te).flags|(ae=ft).flags)&a.b$?(oe.flags|=a.b$,ae.flags|=a.b$):(oe.flags&=~a.b$,ae.flags&=~a.b$));const Be=Ge.intersectsCount()>1||qe.intersectsCount()>1;if(mt>1)xe=dt,Te.centroidXY=ft.centroidXY=new a.P(0,0);else if(Ce&&Ce.dem&&!Be){const Je=J[se](Te,ft),ct=se%2?a.a3-1:0,Ot=ie(Je[0],Math.min(a.a3-1,Je[1]),ct,Ce,ge,se<2,Je[2]);Te.centroidXY=ft.centroidXY=L(Ot)}else Be?Te.centroidXY=ft.centroidXY=new a.P(0,0):(Te.centroidXY=v.encodeBorderCentroid(Ge),ft.centroidXY=ye.encodeBorderCentroid(qe));v.writeCentroidToBuffer(Te),ye.writeCentroidToBuffer(ft)}else v.showCentroid(Ge)}v.borderDoneWithNeighborZ[se]=ye.canonical.z,ye.borderDoneWithNeighborZ[Ae]=v.canonical.z}var oe,ae;(v.needsCentroidUpdate||!v.centroidVertexBuffer&&v.centroidVertexArray.length!==0)&&v.uploadCentroid(y)}const iu=[1,0,0],a1=[0,1,0],Tp=[0,0,1];function Gy(y,l,d){const v=d.transform,S=d.shadowRenderer;if(!S)return!0;const T=y.toUnwrapped(),P=v.tileSize*S._cascades[d.currentShadowCascade].scale;let I=l.maxHeight;if(v.elevation){const oe=v.elevation.getMinMaxForTile(y);oe&&(I+=oe.max)}const L=[...S.shadowDirection];L[2]=-L[2];const F=S.computeSimplifiedTileShadowVolume(T,I,P,L);if(!F)return!1;const V=[iu,a1,Tp,L,[L[0],0,L[2]],[0,L[1],L[2]]],Z=v.projection.name==="globe",Q=v.scaleZoom(P),J=a.aM.fromInvProjectionMatrix(v.invProjMatrix,v.worldSize,Q,!Z),ie=S.getCurrentCascadeFrustum();return J.intersectsPrecise(F.vertices,F.planes,V)===0||ie.intersectsPrecise(F.vertices,F.planes,V)===0}function bf(y){return[y[0]*a.c2,y[1]*a.c2,y[2]*a.c2,0]}function wf(y,l,d,v,S,T,P,I,L){const F=v.getSource(),V=d.globeSharedBuffers;if(!V)return;let Z,Q,J;if(l&&(Z=v.getTile(l)),F instanceof a.bm?(Q=F.texture,J=a.bh(0,0,d.transform)):Z&&l&&(Q=Z.texture,J=a.bh(l.canonical.z,l.canonical.x,d.transform)),!Q||!J)return;y||(J=a.ad.scale(a.ad.create(),J,[1,-1,1]));const ie=d.context,oe=ie.gl,ae=S.paint.get("raster-resampling")==="nearest"?oe.NEAREST:oe.LINEAR,se=d.colorModeForDrapableLayerRenderPass(T),me=P.defines;me.push("GLOBE_POLES");const ge=new a.ae(oe.LEQUAL,a.ae.ReadWrite,d.depthRangeFor3D),ye=Float32Array.from(d.transform.expandedFarZProjMatrix),Ce=Float32Array.from(a.bf(a.bg(new a.aO(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),ie.activeTexture.set(oe.TEXTURE0),Q.bind(ae,oe.CLAMP_TO_EDGE),ie.activeTexture.set(oe.TEXTURE1),Q.bind(ae,oe.CLAMP_TO_EDGE),Q.useMipmap&&ie.extTextureFilterAnisotropic&&d.transform.pitch>20&&oe.texParameterf(oe.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax);const[Ae,pe,_e,xe]=l?V.getPoleBuffers(l.canonical.z,!1):V.getPoleBuffers(0,!0),Re=S.paint.get("raster-elevation");let Ge;y?(Ge=Ae,d.renderDefaultNorthPole=Re!==0):(Ge=pe,d.renderDefaultSouthPole=Re!==0);const Te=bf(P.mix),We=((dt,mt,ft,Be,Je,ct,Ot,kt,Nt,Dt,vt,at,$t)=>gf(dt,mt,ft,new Float32Array(16),new Float32Array(9),[0,0],Be,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ct,[0,0],kt,2,Dt,vt,at,1,0,$t))(ye,Ce,J,a.a1(d.transform.zoom),0,S,0,Re,0,Te,P.offset,P.range,T),qe=d.getOrCreateProgram("raster",{defines:me});d.uploadCommonUniforms(ie,qe,null),qe.draw(d,oe.TRIANGLES,ge,L,se,I,We,S.id,Ge,_e,xe)}function Xn(y){const l=y._nearZ,d=y.projection.farthestPixelDistance(y),v=d-l,S=.2*y.height,T=l+S;return[l,d,(T-S-l)/v,(T-l)/v]}function PA(y,l,d,v){if(y)return l instanceof _c&&y instanceof a.c3?l.getTextureDescriptor(y,d,!0):{texture:y.texture,mix:bf(v.mix),offset:v.offset,buffer:0,tileSize:1}}function on(y,l,d){if(!y)return null;const v=l.getTextureDescriptor(y,d,!0);if(!v)return null;let{texture:S,mix:T,offset:P,tileSize:I,buffer:L,format:F}=v;if(!S||!F)return null;let V=!1;return F==="uint32"&&(V=!0,T[3]=0,T=Jx(a.c4,T,[0,d.paint.get("raster-particle-max-speed")]),P=Ny(a.c4,P,[0,d.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[L/(I+2*L),I/(I+2*L)],tileSize:I,scalarData:V,scale:T,offset:P,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[F]]}}function s1(y){const l=y._nearZ,d=y.projection.farthestPixelDistance(y),v=d-l,S=.2*y.height,T=l+S;return[l,d,(T-S-l)/v,(T-l)/v]}const Ep=new a.C(1,0,0,1),Wy=new a.C(0,1,0,1),es=new a.C(0,0,1,1),Hy=new a.C(1,0,1,1),Ec=new a.C(0,1,1,1);function Bt(y,l,d,v,S,T,P){const I=y.context,L=y.transform,F=I.gl,V=L.projection.name==="globe",Z=V?["PROJECTION_GLOBE_VIEW"]:[];let Q=a.ad.clone(d.projMatrix);if(V&&a.a1(L.zoom)>0){const Te=a.c5(d.canonical,L),We=a.c6(Te);Q=a.ad.multiply(new Float32Array(16),L.globeMatrix,We),a.ad.multiply(Q,L.projMatrix,Q)}const J=a.ad.create();J[12]+=2*S/(a.e.devicePixelRatio*L.width),J[13]+=2*T/(a.e.devicePixelRatio*L.height),a.ad.multiply(Q,J,Q);const ie=y.getOrCreateProgram("debug",{defines:Z}),oe=l.getTileByID(d.key);y.terrain&&y.terrain.setupElevationDraw(oe,ie);const ae=a.ae.disabled,se=a.ag.disabled,me=y.colorModeForRenderPass(),ge="$debug";I.activeTexture.set(F.TEXTURE0),y.emptyTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),V?oe._makeGlobeTileDebugBuffers(y.context,L):oe._makeDebugTileBoundsBuffers(y.context,L.projection);const ye=oe._tileDebugBuffer||y.debugBuffer,Ce=oe._tileDebugIndexBuffer||y.debugIndexBuffer,Ae=oe._tileDebugSegments||y.debugSegments;if(ie.draw(y,F.LINE_STRIP,ae,se,me,a.af.disabled,vp(Q,v),ge,ye,Ce,Ae,null,null,null,[oe._globeTileDebugBorderBuffer]),P){const Te=oe.latestRawTileData,We=Math.floor((Te&&Te.byteLength||0)/1024);let qe=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(qe+=` => ${d.overscaledZ}`),qe+=` ${oe.state}`,qe+=` ${We}kb`,function(dt,mt){dt.initDebugOverlayCanvas();const ft=dt.debugOverlayCanvas,Be=dt.context.gl,Je=dt.debugOverlayCanvas.getContext("2d");Je.clearRect(0,0,ft.width,ft.height),Je.shadowColor="white",Je.shadowBlur=2,Je.lineWidth=1.5,Je.strokeStyle="white",Je.textBaseline="top",Je.font="bold 36px Open Sans, sans-serif",Je.fillText(mt,5,5),Je.strokeText(mt,5,5),dt.debugOverlayTexture.update(ft),dt.debugOverlayTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE)}(y,qe)}const pe=l.getTile(d).tileSize,_e=512/Math.min(pe,512)*(d.overscaledZ/L.zoom)*.5,xe=oe._tileDebugTextBuffer||y.debugBuffer,Re=oe._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,Ge=oe._tileDebugTextSegments||y.debugSegments;ie.draw(y,F.TRIANGLES,ae,se,a.a.alphaBlended,a.af.disabled,vp(Q,a.C.transparent,_e),ge,xe,Re,Ge,null,null,null,[oe._globeTileDebugTextBuffer])}function Yn(y,l,d,v){mo(y,0,l+d/2,y.transform.width,d,v)}function Kn(y,l,d,v){mo(y,l-d/2,0,d,y.transform.height,v)}function mo(y,l,d,v,S,T){const P=y.context,I=P.gl;I.enable(I.SCISSOR_TEST),I.scissor(l*a.e.devicePixelRatio,d*a.e.devicePixelRatio,v*a.e.devicePixelRatio,S*a.e.devicePixelRatio),P.clear({color:T}),I.disable(I.SCISSOR_TEST)}const Ac=a.c7([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Hn}=Ac;function Sa(y,l,d,v){y.emplaceBack(l,d,v)}class Cc{constructor(l){this.vertexArray=new a.c8,this.indices=new a.bu,Sa(this.vertexArray,-1,-1,1),Sa(this.vertexArray,1,-1,1),Sa(this.vertexArray,-1,1,1),Sa(this.vertexArray,1,1,1),Sa(this.vertexArray,-1,-1,-1),Sa(this.vertexArray,1,-1,-1),Sa(this.vertexArray,-1,1,-1),Sa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Hn),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=a.b.simpleSegment(0,0,36,12)}}function ts(y,l,d,v,S,T){const P=y.context.gl,I=l.paint.get("sky-atmosphere-color"),L=l.paint.get("sky-atmosphere-halo-color"),F=l.paint.get("sky-atmosphere-sun-intensity"),V=((Z,Q,J,ie,oe)=>({u_matrix_3f:Z,u_sun_direction:Q,u_sun_intensity:J,u_color_tint_r:[ie.r,ie.g,ie.b,ie.a],u_color_tint_m:[oe.r,oe.g,oe.b,oe.a],u_luminance:5e-5}))(a.bC.fromMat4(a.bC.create(),v),S,F,I,L);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+T,l.skyboxTexture,0),d.draw(y,P.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.unblended,a.af.frontCW,V,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const Ao=a.c7([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Jr{constructor(l){const d=new a.c9;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const v=new a.bu;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(d,Ao.members),this.indexBuffer=l.createIndexBuffer(v),this.segments=a.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const MA=a.c7([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Sf{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class qy{constructor(l){this.colorModeAlphaBlendedWriteRGB=new a.a([a.ca,a.cb,a.ca,a.cb],a.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new a.a([a.ca,a.cc,a.ca,a.cc],a.C.transparent,[!1,!1,!1,!0]),this.params=new Sf,this.updateNeeded=!0,l.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),l.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),l.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),l.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(l){const d=l.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Jr(d);const v=this.params.sizeRange,S=this.params.intensityRange,T=function(V){const Z=a.cf(30),Q=[];for(let J=0;J<V;++J){const ie=2*Math.PI*Z(),oe=Math.acos(1-2*Z())-.5*Math.PI;Q.push(a._.fromValues(Math.cos(oe)*Math.cos(ie),Math.cos(oe)*Math.sin(ie),Math.sin(oe)))}return Q}(this.params.starsCount),P=a.cf(300),I=new a.cd,L=new a.bu;let F=0;for(let V=0;V<T.length;++V){const Z=a._.scale([],T[V],200),Q=Math.max(0,1+.01*v*(1*P()-.5)),J=Math.max(0,1+.01*S*(1*P()-.5));I.emplaceBack(Z[0],Z[1],Z[2],-1,-1,Q,J),I.emplaceBack(Z[0],Z[1],Z[2],1,-1,Q,J),I.emplaceBack(Z[0],Z[1],Z[2],1,1,Q,J),I.emplaceBack(Z[0],Z[1],Z[2],-1,1,Q,J),L.emplaceBack(F+0,F+1,F+2),L.emplaceBack(F+0,F+2,F+3),F+=4}this.starsVx=d.createVertexBuffer(I,MA.members),this.starsIdx=d.createIndexBuffer(L),this.starsSegments=a.b.simpleSegment(0,0,I.length,L.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(l,d){const v=l.context,S=v.gl,T=l.transform,P=new a.ae(S.LEQUAL,a.ae.ReadOnly,[0,1]),I=a.a1(T.zoom),L=l.style.getLut(d.scope),F=d.properties.get("color").toRenderColor(L).toArray01(),V=d.properties.get("high-color").toRenderColor(L).toArray01(),Z=d.properties.get("space-color").toRenderColor(L).toArray01PremultipliedAlpha(),Q=5e-4,J=a.ce(d.properties.get("horizon-blend"),0,1,Q,.25),ie=a.ba(l,v,T)&&J===Q?T.worldSize/(2*Math.PI*1.025)-1:T.globeRadius,oe=l.frameCounter/1e3%1,ae=a._.length(T.globeCenterInViewSpace),se=Math.sqrt(Math.pow(ae,2)-Math.pow(ie,2)),me=Math.acos(se/ae),ge=ye=>{const Ce=T.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ye&&Ce.push("ALPHA_PASS");const Ae=l.getOrCreateProgram("globeAtmosphere",{defines:Ce}),pe=((xe,Re,Ge,Te,We,qe,dt,mt,ft,Be,Je,ct)=>({u_frustum_tl:xe,u_frustum_tr:Re,u_frustum_br:Ge,u_frustum_bl:Te,u_horizon:We,u_transition:qe,u_fadeout_range:dt,u_color:mt,u_high_color:ft,u_space_color:Be,u_temporal_offset:Je,u_horizon_angle:ct}))(T.frustumCorners.TL,T.frustumCorners.TR,T.frustumCorners.BR,T.frustumCorners.BL,T.frustumCorners.horizon,I,J,F,V,Z,oe,me);l.uploadCommonUniforms(v,Ae);const _e=this.atmosphereBuffer;_e&&Ae.draw(l,S.TRIANGLES,P,a.ag.disabled,ye?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,a.af.backCW,pe,ye?"atmosphere_glow_alpha":"atmosphere_glow",_e.vertexBuffer,_e.indexBuffer,_e.segments)};ge(!1),ge(!0)}drawStars(l,d){const v=a.at(d.properties.get("star-intensity"),0,1);if(v===0)return;const S=l.context,T=S.gl,P=l.transform,I=l.getOrCreateProgram("stars"),L=a.av.identity([]);a.av.rotateX(L,L,-P._pitch),a.av.rotateZ(L,L,-P.angle),a.av.rotateX(L,L,a.ab(P._center.lat)),a.av.rotateY(L,L,-a.ab(P._center.lng));const F=a.ad.fromQuat(new Float32Array(16),L),V=a.ad.multiply([],P.starsProjMatrix,F),Z=a.bC.fromMat4([],F),Q=a.bC.invert([],Z),J=[0,1,0];a._.transformMat3(J,J,Q),a._.scale(J,J,this.params.sizeMultiplier);const ie=[1,0,0];a._.transformMat3(ie,ie,Q),a._.scale(ie,ie,this.params.sizeMultiplier);const oe=(ae=J,se=ie,me=v,{u_matrix:Float32Array.from(V),u_up:ae,u_right:se,u_intensity_multiplier:me});var ae,se,me;l.uploadCommonUniforms(S,I),this.starsVx&&this.starsIdx&&I.draw(l,T.TRIANGLES,a.ae.disabled,a.ag.disabled,this.colorModeAlphaBlendedWriteRGB,a.af.disabled,oe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Pc(y,l){const d=[...y],v=l.cameraWorldSizeForFog/l.worldSize,S=a.ad.identity([]);return a.ad.scale(S,S,[v,v,1]),a.ad.multiply(d,S,d),a.ad.multiply(d,l.worldToFogMatrix,d),d}function Tf(y,l,d,v,S){const T=d.material,P=v.context,{baseColorTexture:I,metallicRoughnessTexture:L}=T.pbrMetallicRoughness,{normalTexture:F,occlusionTexture:V,emissionTexture:Z}=T;function Q(J,ie,oe){if(J&&(y.push(ie),P.activeTexture.set(P.gl.TEXTURE0+oe),J.gfxTexture)){const{minFilter:ae,magFilter:se,wrapS:me,wrapT:ge}=J.sampler;J.gfxTexture.bindExtraParam(ae,se,me,ge)}}Q(I,"HAS_TEXTURE_u_baseColorTexture",io.BaseColor),Q(L,"HAS_TEXTURE_u_metallicRoughnessTexture",io.MetallicRoughness),Q(F,"HAS_TEXTURE_u_normalTexture",io.Normal),Q(V,"HAS_TEXTURE_u_occlusionTexture",io.Occlusion),Q(Z,"HAS_TEXTURE_u_emissionTexture",io.Emission),S&&(S.texture||(S.texture=new a.ch(v.context,S.image,[S.image.height,S.image.height,S.image.height],P.gl.RGBA)),P.activeTexture.set(P.gl.TEXTURE0+io.LUT),S.texture&&S.texture.bind(P.gl.LINEAR,P.gl.CLAMP_TO_EDGE),y.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(y.push("HAS_ATTRIBUTE_a_uv_2f"),l.push(d.texcoordBuffer)),d.colorBuffer&&(y.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),l.push(d.colorBuffer)),d.normalBuffer&&(y.push("HAS_ATTRIBUTE_a_normal_3f"),l.push(d.normalBuffer)),d.pbrBuffer&&(y.push("HAS_ATTRIBUTE_a_pbr"),y.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),l.push(d.pbrBuffer)),T.alphaMode!=="OPAQUE"&&T.alphaMode!=="MASK"||y.push("UNPREMULT_TEXTURE_IN_SHADER"),T.defined||y.push("DIFFUSE_SHADED"),y.push("USE_STANDARD_DERIVATIVES")}function ou(y,l,d,v,S,T){const P=d.paint.get("model-opacity"),I=l.context,L=new a.ae(l.context.gl.LEQUAL,a.ae.ReadWrite,l.depthRangeFor3D),F=l.transform,V=y.mesh,Z=V.material,Q=Z.pbrMetallicRoughness,J=l.style.fog;let ie;ie=l.transform.projection.zAxisUnit==="pixels"?[...y.nodeModelMatrix]:a.ad.multiply([],v.zScaleMatrix,y.nodeModelMatrix),a.ad.multiply(ie,v.negCameraPosMatrix,ie);const oe=a.ad.invert([],ie);a.ad.transpose(oe,oe);const ae=d.paint.get("model-emissive-strength").constantOr(0),se=vf(new Float32Array(y.worldViewProjection),new Float32Array(ie),new Float32Array(oe),null,l,P,Q.baseColorFactor.toRenderColor(null),Z.emissiveFactor,Q.metallicFactor,Q.roughnessFactor,Z,ae,d),me={defines:[]},ge=[];Tf(me.defines,ge,V,l,d.lut);const ye=l.shadowRenderer;ye&&(ye.useNormalOffset=!1);let Ce=null;if(J){const _e=Pc(y.nodeModelMatrix,l.transform);if(Ce=new Float32Array(_e),F.projection.name!=="globe"){const xe=V.aabb.min,Re=V.aabb.max,[Ge,Te]=J.getOpacityForBounds(_e,xe[0],xe[1],Re[0],Re[1]);me.overrideFog=Ge>=Rr||Te>=Rr}}const Ae=Ps(l,d.paint.get("model-cutoff-fade-range"));Ae.shouldRenderCutoff&&me.defines.push("RENDER_CUTOFF");const pe=l.getOrCreateProgram("model",me);l.uploadCommonUniforms(I,pe,null,Ce,Ae),l.renderPass!=="shadow"&&ye&&ye.setupShadowsFromMatrix(y.nodeModelMatrix,pe),pe.draw(l,I.gl.TRIANGLES,L,S,T,V.material.doubleSided?a.af.disabled:a.af.backCCW,se,d.id,V.vertexBuffer,V.indexBuffer,V.segments,d.paint,l.transform.zoom,void 0,ge)}function Yi(y,l,d,v,S,T,P){let I;I=y.projection.name==="globe"?a.ci(d,y):[...d],a.ad.multiply(I,I,l.matrix);const L=a.ad.multiply([],v,I);if(l.meshes)for(const F of l.meshes){if(F.material.alphaMode!=="BLEND"){P.push({mesh:F,depth:0,modelIndex:S,worldViewProjection:L,nodeModelMatrix:I});continue}const V=a._.transformMat4([],F.centroid,L);V[2]>0&&T.push({mesh:F,depth:V[2],modelIndex:S,worldViewProjection:L,nodeModelMatrix:I})}if(l.children)for(const F of l.children)Yi(y,F,d,v,S,T,P)}function go(y,l,d,v){const S=d.shadowRenderer;if(!S)return;const T=S.getShadowPassDepthMode(),P=S.getShadowPassColorMode(),I=S.calculateShadowPassMatrixFromMatrix(l),L=n1(I);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,T,a.ag.disabled,P,a.af.backCCW,L,v.id,y.vertexBuffer,y.indexBuffer,y.segments,v.paint,d.transform.zoom,void 0,void 0)}function l1(y,l,d){const v=l.updateZoomBasedPaintProperties(),S=function(T,P,I){let L,F,V,Z=T.terrain?T.terrain.exaggeration():0;if(T.terrain&&Z>0){const Q=T.terrain,J=Q.findDEMTileFor(I);J&&J.dem?L=a.ck.create(Q,I,J):Z=0}if(Z===0&&(P.terrainElevationMin=0,P.terrainElevationMax=0),Z===P.validForExaggeration&&(Z===0||L&&L._demTile&&L._demTile.tileID===P.validForDEMTile.id&&L._dem._timestamp===P.validForDEMTile.timestamp))return!1;for(const Q in P.instancesPerModel){const J=P.instancesPerModel[Q];for(let ie=0;ie<J.instancedDataArray.length;++ie){const oe=(L?Z*L.getElevationAt(0|J.instancedDataArray.float32[16*ie],0|J.instancedDataArray.float32[16*ie+1],!0,!0):0)+J.instancesEvaluatedElevation[ie];J.instancedDataArray.float32[16*ie+6]=oe,F=F?Math.min(P.terrainElevationMin,oe):oe,V=V?Math.max(P.terrainElevationMax,oe):oe}}return P.terrainElevationMin=F||0,P.terrainElevationMax=V||0,P.validForExaggeration=Z,P.validForDEMTile=L&&L._demTile?{id:L._demTile.tileID,timestamp:L._dem._timestamp}:{id:void 0,timestamp:0},!0}(y,l,d);(v||S)&&(l.uploaded=!1,l.upload(y.context))}const yo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.b6([0,0,0],[a.a3,a.a3,0])};function fi(y,l){const d=1<<y.canonical.z,v=l.getFreeCameraOptions().position,S=l.elevation,T=y.canonical.x/d,P=(y.canonical.x+1)/d,I=y.canonical.y/d,L=(y.canonical.y+1)/d;let F=l._centerAltitude;if(S){const J=S.getMinMaxForTile(y);J&&J.max>F&&(F=J.max)}const V=a.at(v.x,T,P)-v.x,Z=a.at(v.y,I,L)-v.y,Q=a.ax(F,l.center.lat)-v.z;return l._zoomFromMercatorZ(Math.sqrt(V*V+Z*Z+Q*Q))}function aa(y,l,d,v,S,T,P){const I=y.context,L=y.renderPass==="shadow",F=y.shadowRenderer,V=L&&F?F.getShadowPassDepthMode():new a.ae(I.gl.LEQUAL,a.ae.ReadWrite,y.depthRangeFor3D),Z=y.isTileAffectedByFog(T);if(d.meshes)for(const Q of d.meshes){const J=["MODEL_POSITION_ON_GPU"],ie=[];let oe,ae,se;v.instancedDataArray.length>20&&J.push("INSTANCED_ARRAYS");const me=Ps(y,l.paint.get("model-cutoff-fade-range"));if(me.shouldRenderCutoff&&J.push("RENDER_CUTOFF"),L&&F)oe=y.getOrCreateProgram("modelDepth",{defines:J}),ae=n1(P.shadowTileMatrix,P.shadowTileMatrix,Float32Array.from(d.matrix)),se=F.getShadowPassColorMode();else{Tf(J,ie,Q,y,l.lut),oe=y.getOrCreateProgram("model",{defines:J,overrideFog:Z});const ye=Q.material,Ce=ye.pbrMetallicRoughness,Ae=l.paint.get("model-opacity"),pe=l.paint.get("model-emissive-strength").constantOr(0);ae=vf(T.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,y,Ae,Ce.baseColorFactor.toRenderColor(null),ye.emissiveFactor,Ce.metallicFactor,Ce.roughnessFactor,ye,pe,l,S),F&&(P.shadowUniformsInitialized?oe.setShadowUniformValues(I,F.getShadowUniformValues()):(F.setupShadows(T.toUnwrapped(),oe,"model-tile",T.overscaledZ),P.shadowUniformsInitialized=!0)),se=me.shouldRenderCutoff||Ae<1||ye.alphaMode!=="OPAQUE"?a.a.alphaBlended:a.a.unblended}y.uploadCommonUniforms(I,oe,T.toUnwrapped(),null,me);const ge=Q.material.doubleSided?a.af.disabled:a.af.backCCW;if(v.instancedDataArray.length>20)ie.push(v.instancedDataBuffer),oe.draw(y,I.gl.TRIANGLES,V,a.ag.disabled,se,ge,ae,l.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,l.paint,y.transform.zoom,void 0,ie,v.instancedDataArray.length);else{const ye=L?"u_instance":"u_normal_matrix";for(let Ce=0;Ce<v.instancedDataArray.length;++Ce)ae[ye]=new Float32Array(v.instancedDataArray.arrayBuffer,64*Ce,16),oe.draw(y,I.gl.TRIANGLES,V,a.ag.disabled,se,ge,ae,l.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,l.paint,y.transform.zoom,void 0,ie)}}if(d.children)for(const Q of d.children)aa(y,l,Q,v,S,T,P)}const Os=[1,-1,1];function Si(y,l,d,v){if(!d.modelManager)return!0;const S=d.modelManager;if(!d.shadowRenderer)return!0;const T=d.shadowRenderer,P=l.aabb;let I=!0,L=y.maxHeight;if(L===0){let V=0;for(const Z in y.instancesPerModel){const Q=S.getModel(Z,v);Q?V=Math.max(V,Math.max(Math.max(Q.aabb.max[0],Q.aabb.max[1]),Q.aabb.max[2])):I=!1}L=y.maxScale*V*1.41+y.maxVerticalOffset,I&&(y.maxHeight=L)}P.max[2]=L,P.min[2]+=y.terrainElevationMin,P.max[2]+=y.terrainElevationMax,a._.transformMat4(P.min,P.min,l.tileMatrix),a._.transformMat4(P.max,P.max,l.tileMatrix);const F=P.intersects(T.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(y.isInsideFirstShadowMapFrustum=F===2),F===0}function Zy(y,l){const d=y.uniformValues.u_cutoff_params[0],v=y.uniformValues.u_cutoff_params[1],S=y.uniformValues.u_cutoff_params[2],T=y.uniformValues.u_cutoff_params[3];return v===d||T===S?1:a.at(((l-d)/(v-d)-S)/(T-S),0,1)}function Ta(y,l,d,v){if(l.pitch<20)return 1;const S=l.getWorldToCameraMatrix(),T=a.ad.multiply([],S,y),P=[...d.min,1];let I=a.aA.transformMat4([],P,T),L=I,F=I;P[1]=d.max[1],I=a.aA.transformMat4([],P,T),L=I[1]<L[1]?I:L,F=I[1]>F[1]?I:F,P[0]=d.max[0],I=a.aA.transformMat4([],P,T),L=I[1]<L[1]?I:L,F=I[1]>F[1]?I:F,P[1]=d.min[1],I=a.aA.transformMat4([],P,T),L=I[1]<L[1]?I:L,F=I[1]>F[1]?I:F;const V=a.at(v[0],0,1),Z=100*l.pixelsPerMeter*a.at(v[1],0,1),Q=a.at(v[2],0,1),J=a._.lerp([],L,F,V),ie=Math.tan(.5*l.fovX),oe=-J[2]*ie;if(Z===0)return J[1]<-Math.abs(oe)?Q:1;const ae=(-Math.abs(oe)-J[1])/Z,se=(ge,ye,Ce)=>(1-Ce)*ge+Ce*ye,me=a.at(se(1,Q,ae),Q,1);return se(1,me,a.at((l.pitch-20)/20,0,1))}class Ef{}class Af{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(l,d,v){{const Z=this._storage.get(d.id);if(Z)return Z.lastUsedFrameIdx=l,Z.buf}const S=v.gl,T=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),P=new ArrayBuffer(T),I=new Int16Array(P);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(P));const L=new a.cm;for(let Z=0;Z<T/2;Z+=3){const Q=I[Z],J=I[Z+1],ie=I[Z+2];L.emplaceBack(Q,J),L.emplaceBack(J,ie),L.emplaceBack(ie,Q)}const F=v.bindVertexArrayOES.current,V=new Ef;return V.buf=new a.I(v,L),V.lastUsedFrameIdx=l,this._storage.set(d.id,V),v.bindVertexArrayOES.set(F),V.buf}update(l){for(const[d,v]of this._storage)l-v.lastUsedFrameIdx>30&&(v.buf.destroy(),this._storage.delete(d))}destroy(){for(const[l,d]of this._storage)d.buf.destroy(),this._storage.delete(l)}}const au=a.c7([{type:"Float32",name:"a_offset_xy",components:2}]);class IA{constructor(l){const d=new a.cn,v=new a.bu;d.emplaceBack(-1,-1),d.emplaceBack(1,-1),d.emplaceBack(1,1),d.emplaceBack(-1,1),v.emplaceBack(0,1,2),v.emplaceBack(0,2,3),this.segments=a.b.simpleSegment(0,0,d.length,v.length),this.vx=l.createVertexBuffer(d,au.members),this.idx=l.createIndexBuffer(v)}destroy(){this.vx.destroy(),this.idx.destroy()}}const Ea={symbol:function(y,l,d,v,S){if(y.renderPass!=="translucent")return;const T=a.ag.disabled,P=y.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(F,V,Z,Q,J,ie,oe){const ae=V.transform,se=J==="map",me=ie==="map";for(const ge of F){const ye=Q.getTile(ge),Ce=ye.getBucket(Z);if(!Ce||!Ce.text||!Ce.text.segments.get().length)continue;const Ae=a.aD(Ce.textSizeData,ae.zoom),pe=wc(ge,Ce.getProjection(),ae),_e=ae.calculatePixelsToTileUnitsMatrix(ye),xe=Ql(pe,ye.tileID.canonical,me,se,ae,Ce.getProjection(),_e),Re=Ce.hasIconTextFit()&&Ce.hasIconData();if(Ae){const Ge=Math.pow(2,ae.zoom-ye.tileID.overscaledZ);o1(Ce,se,me,oe,a.bO,ae,xe,ge,Ge,Ae,Re)}}}(v,y,d,l,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),S);const I=d.paint.get("icon-opacity").constantOr(1)!==0,L=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(I||L)?Uy(y,l,d,v,T,P):(I&&Uy(y,l,d,v,T,P,{onlyIcons:!0}),L&&Uy(y,l,d,v,T,P,{onlyText:!0}),function(F,V,Z,Q){if(!F.symbolParams.useOcclusionQueries)return;const J=F.context.gl,ie=F.transform,oe=Z.paint,ae=oe.get("icon-occlusion-opacity").constantOr(0),se=oe.get("text-occlusion-opacity").constantOr(0);if(!Z.hasInitialOcclusionOpacityProperties||ae===1&&se===1)return;const me=ie.projection.name==="globe";for(const ge of Q){const ye=V.getTile(ge),Ce=ye.getBucket(Z);if(!Ce||Ce.projection.name==="mercator"&&me||Ce.fullyClipped)continue;if(Ce.projection.name==="globe"){a.w(`Occlusion not supported for globe mode. Layer: ${Z.type}`);continue}const Ae=wc(ge,Ce.getProjection(),ie),pe=a.ad.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,F.symbolParams.depthOffset,1),_e=a.ad.multiply([],pe,Ae),xe=F.symbolParams.visualizeOcclusions!=="none"?1:F.symbolParams.occlusionQueryFrameWindow;for(let Re=0;Re<Ce.symbolInstances.length;Re++){const Ge=Ce.symbolInstances.get(Re),Te=F.style.placement.opacities[Ge.crossTileID];if(Te&&Te.isHidden()||(F.frameCounter+Re)%xe!=0)continue;const We=Ge.tileAnchorX,qe=Ge.tileAnchorY,dt=Ge.zOffset;let mt;if(F.symbolParams.visualizeOcclusions==="none"){const Ot=Ce.queries.get(Re);if(Ot){if(!Ot.isFree()){if(!Ot.isResultAvailable())continue;const kt=Ot.consumeResult();Ge.occlusionState=kt===0?0:1;continue}mt=Ot}else mt=new Eo(F.context),Ce.queries.set(Re,mt)}const ft=F.getOrCreateProgram("occlusion"),Be=F.symbolParams.occluderSize,Je=r1(_e,[We,qe,dt],[ie.width,ie.height],[Be,Be],F.symbolParams.visualizeOcclusions==="zPass"?[1,0,0,.8]:[1,.4,.2,.9]);F.terrain&&F.terrain.setupElevationDraw(ye,ft,{useDepthForOcclusion:!1,labelPlaneMatrixInv:void 0}),F.symbolParams.visualizeOcclusions==="none"&&mt&&mt.begin();const ct=new a.ae(F.symbolParams.visualizeOcclusions==="zPass"?F.context.gl.ALWAYS:F.context.gl.LEQUAL,a.ae.ReadOnly,F.depthRangeFor3D);ft.draw(F,J.TRIANGLES,ct,a.ag.disabled,F.symbolParams.visualizeOcclusions!=="none"?a.a.alphaBlendedNonPremultiplied:a.a.disabled,a.af.disabled,Je,"occlusion",F.occlusionBuffers.vx,F.occlusionBuffers.idx,F.occlusionBuffers.segments),F.symbolParams.visualizeOcclusions==="none"&&mt&&mt.end()}}}(y,l,d,v)),l.map.showCollisionBoxes&&(xf(y,l,d,v,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),xf(y,l,d,v,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(y,l,d,v){if(y.renderPass!=="translucent")return;const S=d.paint.get("circle-opacity"),T=d.paint.get("circle-stroke-width"),P=d.paint.get("circle-stroke-opacity"),I=d.layout.get("circle-sort-key").constantOr(1)!==void 0,L=d.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(T.constantOr(1)===0||P.constantOr(1)===0))return;const F=y.context,V=F.gl,Z=y.transform,Q=y.depthModeForSublayer(0,a.ae.ReadOnly),J=a.ag.disabled,ie=y.colorModeForDrapableLayerRenderPass(L),oe=Z.projection.name==="globe",ae=[a.aj(Z.center.lng),a.ak(Z.center.lat)],se=[];for(let ge=0;ge<v.length;ge++){const ye=v[ge],Ce=l.getTile(ye),Ae=Ce.getBucket(d);if(!Ae||Ae.projection.name!==Z.projection.name)continue;const pe=Ae.programConfigurations.get(d.id),_e=a.bR(d),xe=y.isTileAffectedByFog(ye);oe&&_e.push("PROJECTION_GLOBE_VIEW");const Re=y.getOrCreateProgram("circle",{config:pe,defines:_e,overrideFog:xe}),Ge=Ae.layoutVertexBuffer,Te=Ae.globeExtVertexBuffer,We=Ae.indexBuffer,qe=Z.projection.createInversionMatrix(Z,ye.canonical),dt={programConfiguration:pe,program:Re,layoutVertexBuffer:Ge,globeExtVertexBuffer:Te,indexBuffer:We,uniformValues:a.bS(y,ye,Ce,qe,ae,d),tile:Ce};if(I){const mt=Ae.segments.get();for(const ft of mt)se.push({segments:new a.b([ft]),sortKey:ft.sortKey,state:dt})}else se.push({segments:Ae.segments,sortKey:0,state:dt})}I&&se.sort((ge,ye)=>ge.sortKey-ye.sortKey);const me={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const ge of se){const{programConfiguration:ye,program:Ce,layoutVertexBuffer:Ae,globeExtVertexBuffer:pe,indexBuffer:_e,uniformValues:xe,tile:Re}=ge.state,Ge=ge.segments;y.terrain&&y.terrain.setupElevationDraw(Re,Ce,me),y.uploadCommonUniforms(F,Ce,Re.tileID.toUnwrapped()),Ce.draw(y,V.TRIANGLES,Q,J,ie,a.af.disabled,xe,d.id,Ae,_e,Ge,d.paint,Z.zoom,ye,[pe])}},heatmap:function(y,l,d,v){if(d.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const S=y.context,T=S.gl,P=a.ag.disabled,I=new a.a([T.ONE,T.ONE,T.ONE,T.ONE],a.C.transparent,[!0,!0,!0,!0]);(function(J,ie,oe,ae){const se=J.gl,me=ie.width*ae,ge=ie.height*ae;J.activeTexture.set(se.TEXTURE1),J.viewport.set([0,0,me,ge]);let ye=oe.heatmapFbo;if(!ye||ye&&(ye.width!==me||ye.height!==ge)){ye&&ye.destroy();const Ce=se.createTexture();se.bindTexture(se.TEXTURE_2D,Ce),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),ye=oe.heatmapFbo=J.createFramebuffer(me,ge,!0,null),function(Ae,pe,_e,xe,Re,Ge){const Te=Ae.gl;Te.texImage2D(Te.TEXTURE_2D,0,Ae.extRenderToTextureHalfFloat?Te.RGBA16F:Te.RGBA,Re,Ge,0,Te.RGBA,Ae.extRenderToTextureHalfFloat?Te.HALF_FLOAT:Te.UNSIGNED_BYTE,null),xe.colorAttachment.set(_e)}(J,0,Ce,ye,me,ge)}else se.bindTexture(se.TEXTURE_2D,ye.colorAttachment.get()),J.bindFramebuffer.set(ye.framebuffer)})(S,y,d,y.transform.projection.name==="globe"?.5:.25),S.clear({color:a.C.transparent});const L=y.transform,F=L.projection.name==="globe",V=F?["PROJECTION_GLOBE_VIEW"]:[],Z=F?a.af.frontCCW:a.af.disabled,Q=[a.aj(L.center.lng),a.ak(L.center.lat)];for(let J=0;J<v.length;J++){const ie=v[J];if(l.hasRenderableParent(ie))continue;const oe=l.getTile(ie),ae=oe.getBucket(d);if(!ae||ae.projection.name!==L.projection.name)continue;const se=y.isTileAffectedByFog(ie),me=ae.programConfigurations.get(d.id),ge=y.getOrCreateProgram("heatmap",{config:me,defines:V,overrideFog:se}),{zoom:ye}=y.transform;y.terrain&&y.terrain.setupElevationDraw(oe,ge),y.uploadCommonUniforms(S,ge,ie.toUnwrapped());const Ce=L.projection.createInversionMatrix(L,ie.canonical);ge.draw(y,T.TRIANGLES,a.ae.disabled,P,I,Z,nu(y,ie,oe,Ce,Q,ye,d.paint.get("heatmap-intensity")),d.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,d.paint,y.transform.zoom,me,F?[ae.globeExtVertexBuffer]:null)}S.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(S,T){const P=S.context,I=P.gl,L=T.heatmapFbo;if(!L)return;P.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,L.colorAttachment.get()),P.activeTexture.set(I.TEXTURE1);let F=T.colorRampTexture;F||(F=T.colorRampTexture=new a.T(P,T.colorRamp,I.RGBA)),F.bind(I.LINEAR,I.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,I.TRIANGLES,a.ae.disabled,a.ag.disabled,S.colorModeForRenderPass(),a.af.disabled,((V,Z,Q,J)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,T),T.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,T.paint,S.transform.zoom)}(y,d))},line:function(y,l,d,v){if(y.renderPass!=="translucent")return;const S=d.paint.get("line-opacity"),T=d.paint.get("line-width");if(S.constantOr(1)===0||T.constantOr(1)===0)return;const P=d.paint.get("line-emissive-strength"),I=d.paint.get("line-occlusion-opacity"),L=y.context,F=L.gl,V=d.layout.get("line-z-offset"),Z=!V.isConstant()||!!V.constantOr(0),Q=Z?new a.ae(y.depthOcclusion?F.GREATER:F.LEQUAL,a.ae.ReadOnly,y.depthRangeFor3D):y.depthModeForSublayer(0,a.ae.ReadOnly),J=y.colorModeForDrapableLayerRenderPass(P),ie=y.terrain&&y.terrain.renderingToTexture,oe=ie?1:a.e.devicePixelRatio,ae=d.paint.get("line-dasharray"),se=ae.constantOr(1),me=d.layout.get("line-cap"),ge=ae.constantOr(null),ye=me.constantOr(null),Ce=d.paint.get("line-pattern"),Ae=Ce.constantOr(1),pe=Ce.constantOr(null),_e=d.paint.get("line-opacity").constantOr(1);let xe=!Ae&&_e!==1||y.depthOcclusion&&I>0&&I<1;const Re=d.paint.get("line-gradient"),Ge=Ae?"linePattern":"line",Te=a.bT(d);let We;if(ie&&y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(xe=!1),I!==0&&y.depthOcclusion){const dt=d.paint._values["line-opacity"];dt&&dt.value&&dt.value.kind==="constant"?We=dt.value:a.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}if(Z&&(y.forceTerrainMode=!0),!Z&&I!==0&&y.terrain&&!ie)return void a.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const qe=xe&&Z?y.stencilModeFor3D():a.ag.disabled;for(const dt of v){const mt=l.getTile(dt);if(Ae&&!mt.patternsLoaded())continue;const ft=mt.getBucket(d);if(!ft)continue;y.prepareDrawTile();const Be=ft.programConfigurations.get(d.id),Je=y.isTileAffectedByFog(dt),ct=y.getOrCreateProgram(Ge,{config:Be,defines:Z?[...Te,"ELEVATED"]:Te,overrideFog:Je});if(pe&&mt.imageAtlas){const at=mt.imageAtlas.patternPositions[pe.toString()];at&&Be.setConstantPatternPositions(at)}if(!Ae&&ge&&ye&&mt.lineAtlas){const at=mt.lineAtlas.getDash(ge,ye);at&&Be.setConstantPatternPositions(at)}let[Ot,kt]=d.paint.get("line-trim-offset");(ye==="round"||ye==="square")&&Ot!==kt&&(Ot===0&&(Ot-=1),kt===1&&(kt+=1));const Nt=ie?dt.projMatrix:null,Dt=Ae?a.bU(y,mt,d,Nt,oe,[Ot,kt]):a.bV(y,mt,d,Nt,ft.lineClipsArray.length,oe,[Ot,kt]);if(Re){const at=ft.gradients[d.id];let $t=at.texture;if(d.gradientVersion!==at.version){let vn=256;if(d.stepInterpolant){const mn=l.getSource().maxzoom,On=dt.canonical.z===mn?Math.ceil(1<<y.transform.maxZoom-dt.canonical.z):1;vn=a.at(a.bW(ft.maxLineLength/a.a3*1024*On),256,L.maxTextureSize)}at.gradient=a.bX({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:vn,image:at.gradient||void 0,clips:ft.lineClipsArray}),at.texture?at.texture.update(at.gradient):at.texture=new a.T(L,at.gradient,F.RGBA),at.version=d.gradientVersion,$t=at.texture}L.activeTexture.set(F.TEXTURE1),$t.bind(d.stepInterpolant?F.NEAREST:F.LINEAR,F.CLAMP_TO_EDGE)}se&&(L.activeTexture.set(F.TEXTURE0),mt.lineAtlasTexture&&mt.lineAtlasTexture.bind(F.LINEAR,F.REPEAT),Be.updatePaintBuffers()),Ae&&(L.activeTexture.set(F.TEXTURE0),mt.imageAtlasTexture&&mt.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Be.updatePaintBuffers()),Z&&y.terrain.setupElevationDraw(mt,ct),y.uploadCommonUniforms(L,ct,dt.toUnwrapped());const vt=at=>{We!=null&&(We.value=_e*I),ct.draw(y,F.TRIANGLES,Q,at,J,a.af.disabled,Dt,d.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,d.paint,y.transform.zoom,Be,[ft.layoutVertexBuffer2,ft.patternVertexBuffer,ft.zOffsetVertexBuffer]),We!=null&&(We.value=_e)};if(xe&&!Z){const at=y.stencilModeForClipping(dt).ref;at===0&&ie&&L.clear({stencil:0});const $t={func:F.EQUAL,mask:255};Dt.u_alpha_discard_threshold=.8,vt(new a.ag($t,at,255,F.KEEP,F.KEEP,F.INVERT)),Dt.u_alpha_discard_threshold=0,vt(new a.ag($t,at,255,F.KEEP,F.KEEP,F.KEEP))}else xe&&Z&&(Dt.u_alpha_discard_threshold=.001),vt(Z?qe:y.stencilModeForClipping(dt))}xe&&(y.resetStencilClippingMasks(),ie&&L.clear({stencil:0})),I===0||y.depthOcclusion||ie||y.layersWithOcclusionOpacity.push(y.currentLayer),Z&&(y.forceTerrainMode=!1)},fill:function(y,l,d,v){const S=d.paint.get("fill-color"),T=d.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const P=d.paint.get("fill-emissive-strength"),I=y.colorModeForDrapableLayerRenderPass(P),L=d.paint.get("fill-pattern"),F=y.opaquePassEnabledForLayer()&&!L.constantOr(1)&&S.constantOr(a.C.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===F){const V=y.depthModeForSublayer(1,y.renderPass==="opaque"?a.ae.ReadWrite:a.ae.ReadOnly);Vy(y,l,d,v,V,I,!1)}if(y.renderPass==="translucent"&&d.paint.get("fill-antialias")){const V=y.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,a.ae.ReadOnly);Vy(y,l,d,v,V,I,!0)}},"fill-extrusion":function(y,l,d,v){const S=d.paint.get("fill-extrusion-opacity"),T=y.context,P=T.gl,I=y.terrain,L=I&&I.renderingToTexture;if(S===0)return;const F=y.conflationActive&&y.style.isLayerClipped(d,l.getSource()),V=y.style.order.indexOf(d.fqid);if(F&&function(Z,Q,J,ie,oe){for(const ae of ie){const se=Q.getTile(ae).getBucket(J);se&&(se.updateReplacement(ae,Z.replacementSource,oe),se.uploadCentroid(Z.context))}}(y,l,d,v,V),I||F)for(const Z of v){const Q=l.getTile(Z).getBucket(d);Q&&Sp(y.context,l,Z,Q,d,I,F)}if(y.renderPass==="shadow"&&y.shadowRenderer){const Z=y.shadowRenderer;if(I&&S<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.Z)return;const Q=Z.getShadowPassDepthMode(),J=Z.getShadowPassColorMode();Tc(y,l,d,v,Q,a.ag.disabled,J,F)}else if(y.renderPass==="translucent"){const Z=!d.paint.get("fill-extrusion-pattern").constantOr(1),Q=d.paint.get("fill-extrusion-color").constantOr(a.C.white);if(!L&&Q.a!==0){const J=new a.ae(y.context.gl.LEQUAL,a.ae.ReadWrite,y.depthRangeFor3D);S===1&&Z?Tc(y,l,d,v,J,a.ag.disabled,a.a.unblended,F):(Tc(y,l,d,v,J,a.ag.disabled,a.a.disabled,F),Tc(y,l,d,v,J,y.stencilModeFor3D(),y.colorModeForRenderPass(),F),y.resetStencilClippingMasks())}if(y.style.enable3dLights()&&Z&&(!I&&y.transform.projection.name!=="globe"||L)){const J=d.paint.get("fill-extrusion-opacity"),ie=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ae=d.paint.get("fill-extrusion-flood-light-intensity"),se=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(d.lut).toArray01().slice(0,3),me=ie>0&&oe>0,ge=ae>0,ye=(Ae,pe,_e)=>(1-_e)*Ae+_e*pe,Ce=Ae=>{const pe=y.depthModeForSublayer(1,a.ae.ReadOnly,P.LEQUAL,!0),_e=d.paint.get(Ae?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),xe=ye(.1,3,_e),Re=y._showOverdrawInspector;if(!Re){const Ge=new a.ag({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),Te=new a.a([P.ONE,P.ONE,P.ONE,P.ONE],a.C.transparent,[!1,!1,!1,!0],P.MIN);po(y,l,d,v,pe,Ge,Te,a.af.disabled,Ae,"sdf",J,ie,oe,ae,se,xe,F,!1)}{const Ge=Re?a.ag.disabled:new a.ag({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),Te=Re?y.colorModeForRenderPass():new a.a([P.ONE_MINUS_DST_ALPHA,P.DST_ALPHA,P.ONE,P.ONE],a.C.transparent,[!0,!0,!0,!0]);po(y,l,d,v,pe,Ge,Te,a.af.disabled,Ae,"color",J,ie,oe,ae,se,xe,F,!1)}};if(L){const Ae=(pe,_e,xe)=>{const Re=y.depthModeForSublayer(1,a.ae.ReadOnly,P.LEQUAL,!1),Ge=d.paint.get(pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Te=ye(.1,3,Ge);{const We=new a.a([P.ONE,P.ONE,P.ONE,P.ONE],a.C.transparent,[!1,!1,!1,!0]);po(y,l,d,v,Re,a.ag.disabled,We,a.af.disabled,pe,"clear",J,ie,oe,ae,se,Te,F,_e)}{const We=new a.ag({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),qe=new a.a([P.ONE,P.ONE,P.ONE,P.ONE],a.C.transparent,[!1,!1,!1,!0],P.MIN);po(y,l,d,v,Re,We,qe,a.af.disabled,pe,"sdf",J,ie,oe,ae,se,Te,F,_e)}{const We=pe?P.ZERO:P.ONE_MINUS_DST_ALPHA,qe=new a.ag({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),dt=new a.a([We,P.DST_ALPHA,P.ONE_MINUS_DST_ALPHA,P.ZERO],a.C.transparent,[!0,!0,!0,!0]);po(y,l,d,v,Re,qe,dt,a.af.disabled,pe,"color",J,ie,oe,ae,se,Te,F,_e)}{const We=new a.a([P.ONE,P.ONE,P.ONE,pe?P.ZERO:P.ONE],a.C.transparent,[!1,!1,!1,!0],pe?P.FUNC_ADD:P.MAX);po(y,l,d,v,Re,a.ag.disabled,We,a.af.disabled,pe,"clear",J,ie,oe,ae,se,Te,F,_e,xe)}};if(me||ge){let pe;if(y.prepareDrawTile(),I){const _e=I.drapeBufferSize[0],xe=I.drapeBufferSize[1];pe=I.framebufferCopyTexture,pe&&(!pe||pe.size[0]===_e&&pe.size[1]===xe)||(pe&&pe.destroy(),pe=I.framebufferCopyTexture=new a.T(T,new a.i({width:_e,height:xe}),P.RGBA)),pe.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.copyTexImage2D(P.TEXTURE_2D,0,P.RGBA,0,0,_e,xe,0)}me&&Ae(!0,!1,pe),ge&&Ae(!1,!0,pe)}}else me&&Ce(!0),ge&&Ce(!1)}}},hillshade:function(y,l,d,v){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent"||y.style.disableElevatedTerrain)return;const S=y.context,T=y.terrain&&y.terrain.renderingToTexture,[P,I]=y.renderPass!=="translucent"||T?[{},v]:y.stencilConfigForOverlap(v);for(const L of I){const F=l.getTile(L);if(F.needsHillshadePrepare&&y.renderPass==="offscreen")Ka(y,F,d);else if(y.renderPass==="translucent"){const V=y.depthModeForSublayer(0,a.ae.ReadOnly),Z=d.paint.get("hillshade-emissive-strength"),Q=y.colorModeForDrapableLayerRenderPass(Z),J=T&&y.terrain?y.terrain.stencilModeForRTTOverlap(L):P[L.overscaledZ];wA(y,L,F,d,V,J,Q)}}S.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,l,d,v,S,T){if(y.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const P=y.transform.projection.name==="globe",I=d.paint.get("raster-elevation")!==0,L=I&&P;if(y.renderElevatedRasterBackface&&!L)return;const F=y.context,V=F.gl,Z=l.getSource(),Q=function(Ae,pe,_e,xe){const Re=pe.paint.get("raster-color"),Ge=Ae.type==="raster-array",Te=[],We=pe.paint.get("raster-resampling"),qe=pe.paint.get("raster-color-mix");let dt=pe.paint.get("raster-color-range");const mt=[qe[0],qe[1],qe[2],0],ft=qe[3];let Be=We==="nearest"?xe.NEAREST:xe.LINEAR;if(Ge&&(Te.push("RASTER_ARRAY"),Re||Te.push("RASTER_COLOR"),We==="linear"&&Te.push("RASTER_ARRAY_LINEAR"),Be=xe.NEAREST,!dt&&Ae.rasterLayers)){const Je=Ae.rasterLayers.find(({id:ct})=>ct===pe.sourceLayer);Je&&Je.fields&&Je.fields.range&&(dt=Je.fields.range)}if(dt=dt||[0,1],Re){Te.push("RASTER_COLOR"),_e.activeTexture.set(xe.TEXTURE2),pe.updateColorRamp(dt);let Je=pe.colorRampTexture;Je||(Je=pe.colorRampTexture=new a.T(_e,pe.colorRamp,xe.RGBA)),Je.bind(xe.LINEAR,xe.CLAMP_TO_EDGE)}return{mix:mt,range:dt,offset:ft,defines:Te,resampling:Be}}(Z,d,F,V);if(Z instanceof a.bm&&!v.length&&!P)return;const J=d.paint.get("raster-emissive-strength"),ie=y.colorModeForDrapableLayerRenderPass(J),oe=y.terrain&&y.terrain.renderingToTexture,ae=!y.options.moving,se=d.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;if(Z instanceof a.bm&&!v.length&&(Z.onNorthPole||Z.onSouthPole)){const Ae=I?y.stencilModeFor3D():a.ag.disabled;return void wf(!!Z.onNorthPole,null,y,l,d,J,Q,a.af.disabled,Ae)}if(!v.length)return;const[me,ge]=Z instanceof a.bm||oe?[{},v]:y.stencilConfigForOverlap(v),ye=ge[ge.length-1].overscaledZ;L&&Q.defines.push("PROJECTION_GLOBE_VIEW"),I&&Q.defines.push("RENDER_CUTOFF");const Ce=(Ae,pe,_e)=>{for(const xe of Ae){const Re=xe.toUnwrapped(),Ge=l.getTile(xe);if(oe&&(!Ge||!Ge.hasData()))continue;F.activeTexture.set(V.TEXTURE0);const Te=PA(Ge,Z,d,Q);if(!Te||!Te.texture)continue;const{texture:We,mix:qe,offset:dt,tileSize:mt,buffer:ft}=Te;let Be,Je;oe?(Be=a.ae.disabled,Je=xe.projMatrix):I?(Be=new a.ae(V.LEQUAL,a.ae.ReadWrite,y.depthRangeFor3D),Je=P?Float32Array.from(y.transform.expandedFarZProjMatrix):y.transform.calculateProjMatrix(Re,ae)):(Be=y.depthModeForSublayer(xe.overscaledZ-ye,d.paint.get("raster-opacity")===1?a.ae.ReadWrite:a.ae.ReadOnly,V.LESS),Je=y.transform.calculateProjMatrix(Re,ae));const ct=y.terrain&&oe?y.terrain.stencilModeForRTTOverlap(xe):me[xe.overscaledZ],Ot=T?0:d.paint.get("raster-fade-duration");Ge.registerFadeDuration(Ot);const kt=l.findLoadedParent(xe,0),Nt=dp(Ge,kt,l,y.transform,Ot);let Dt,vt;y.terrain&&y.terrain.prepareDrawTile(),F.activeTexture.set(V.TEXTURE0),We.bind(se,V.CLAMP_TO_EDGE),F.activeTexture.set(V.TEXTURE1),kt?(kt.texture&&kt.texture.bind(se,V.CLAMP_TO_EDGE),Dt=Math.pow(2,kt.tileID.overscaledZ-Ge.tileID.overscaledZ),vt=[Ge.tileID.canonical.x*Dt%1,Ge.tileID.canonical.y*Dt%1]):We.bind(se,V.CLAMP_TO_EDGE),We.useMipmap&&F.extTextureFilterAnisotropic&&y.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const at=y.transform;let $t;const vn=I?Xn(at):[0,0,0,0];let mn,On,Nn,lr,pn,tr=0;if(L&&Z instanceof a.bm&&Z.coordinates.length>3)mn=Float32Array.from(a.bf(a.bg(new a.aO(0,0,0)))),On=Float32Array.from(at.globeMatrix),Nn=Float32Array.from(a.bb(at)),lr=[a.aj(at.center.lng),a.ak(at.center.lat)],$t=Z.elevatedGlobePerspectiveTransform,pn=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if(L){const gn=a.bc(xe.canonical);tr=a.bd(gn.getCenter().lat),mn=Float32Array.from(a.bf(a.bg(xe.canonical))),On=Float32Array.from(at.globeMatrix),Nn=Float32Array.from(a.bb(at)),lr=[a.aj(at.center.lng),a.ak(at.center.lat)],$t=[0,0],pn=Float32Array.from(a.be(xe.canonical,gn,tr,at.worldSize/at._pixelsPerMercatorPixel))}else $t=Z instanceof a.bm?Z.perspectiveTransform:[0,0],mn=new Float32Array(16),On=new Float32Array(9),Nn=new Float32Array(16),lr=[0,0],pn=new Float32Array(9);const br=gf(Je,mn,On,Nn,pn,vt||[0,0],a.a1(y.transform.zoom),lr,vn,Dt||1,Nt,d,$t,I?d.paint.get("raster-elevation"):0,2,qe,dt,Q.range,mt,ft,J),or=y.isTileAffectedByFog(xe),Dn=y.getOrCreateProgram("raster",{defines:Q.defines,overrideFog:or});if(y.uploadCommonUniforms(F,Dn,Re),Z instanceof a.bm){const gn=Z.elevatedGlobeVertexBuffer,Er=Z.elevatedGlobeIndexBuffer;if(oe||!P)Z.boundsBuffer&&Z.boundsSegments&&Dn.draw(y,V.TRIANGLES,Be,a.ag.disabled,ie,a.af.disabled,br,d.id,Z.boundsBuffer,y.quadTriangleIndexBuffer,Z.boundsSegments);else if(gn&&Er){const Pr=at.zoom<=a.b1?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(at.center.lng);Pr&&Dn.draw(y,V.TRIANGLES,Be,a.ag.disabled,ie,pe,br,d.id,gn,Er,Pr)}}else if(L){Be=new a.ae(V.LEQUAL,a.ae.ReadOnly,y.depthRangeFor3D);const gn=y.globeSharedBuffers;if(gn){const[Er,Pr,ur]=gn.getGridBuffers(tr,!1);Dn.draw(y,V.TRIANGLES,Be,_e||ct,y.colorModeForRenderPass(),pe,br,d.id,Er,Pr,ur)}}else{const{tileBoundsBuffer:gn,tileBoundsIndexBuffer:Er,tileBoundsSegments:Pr}=y.getTileBoundsBuffers(Ge);Dn.draw(y,V.TRIANGLES,Be,ct,ie,a.af.disabled,br,d.id,gn,Er,Pr)}}if(!(Z instanceof a.bm)&&L)for(const xe of Ae){const Re=xe.canonical.y===(1<<xe.canonical.z)-1;xe.canonical.y===0&&wf(!0,xe,y,l,d,J,Q,pe,_e||a.ag.disabled),Re&&wf(!1,xe,y,l,d,J,Q,pe===a.af.frontCW?a.af.backCW:a.af.frontCW,_e||a.ag.disabled)}};L?Ce(ge,y.renderElevatedRasterBackface?a.af.backCW:a.af.frontCW,y.stencilModeFor3D()):Ce(ge,a.af.disabled,void 0),y.resetStencilClippingMasks()},"raster-particle":function(y,l,d,v,S,T){y.renderPass==="offscreen"&&function(P,I,L,F){if(!F.length)return;const V=P.context,Z=V.gl,Q=I.getSource();if(!(Q instanceof _c))return;const J=Math.ceil(Math.sqrt(L.paint.get("raster-particle-count")));let ie=L.particlePositionRGBAImage;if(!ie||ie.width!==J){const ge=function(ye){const Ce=ye*ye,Ae=new Uint8Array(4*Ce),pe=function(xe){return xe|=0,xe=Math.imul(2747636419^xe,2654435769),xe=Math.imul(xe^xe>>>16,2654435769),((xe=Math.imul(xe^xe>>>16,2654435769))>>>0)/4294967296},_e=1/1.3;for(let xe=0;xe<Ce;xe++){const Re=_e*(pe(2*xe+0)+pl),Ge=_e*(pe(2*xe+1)+pl),Te=255*Re%1,We=255*Ge%1,qe=Te,dt=Ge-We/255,mt=We;Ae[4*xe+0]=255*(Re-Te/255),Ae[4*xe+1]=255*qe,Ae[4*xe+2]=255*dt,Ae[4*xe+3]=255*mt}return Ae}(J);ie=L.particlePositionRGBAImage=new a.i({width:J,height:J},ge)}let oe=L.particleFramebuffer;oe?oe.width!==J&&(oe.destroy(),oe=L.particleFramebuffer=V.createFramebuffer(J,J,!0,null)):oe=L.particleFramebuffer=V.createFramebuffer(J,J,!0,null);const ae=[];for(const ge of F){const ye=I.getTile(ge);if(!(ye instanceof a.c3))continue;const Ce=on(ye,Q,L);if(!Ce)continue;const Ae=[ye.tileSize,ye.tileSize];let pe=L.tileFramebuffer;pe||(pe=L.tileFramebuffer=V.createFramebuffer(Ae[0],Ae[1],!0,null));let _e=ye.rasterParticleState;_e||(_e=ye.rasterParticleState=new Oi(V,ge,Ae,ie));const xe=_e.update(L.lastInvalidatedAt);_e.particleTextureDimension!==J&&_e.updateParticleTexture(ge,ie);const Re=_e.targetColorTexture;_e.targetColorTexture=_e.backgroundColorTexture,_e.backgroundColorTexture=Re;const Ge=_e.particleTexture0;_e.particleTexture0=_e.particleTexture1,_e.particleTexture1=Ge,ae.push([ge,Ce,_e,xe])}if(ae.length===0)return;const se=a.e.now(),me=L.previousDrawTimestamp?.001*(se-L.previousDrawTimestamp):.0167;if(L.previousDrawTimestamp=se,L.hasColorMap()){V.activeTexture.set(Z.TEXTURE0+2);let ge=L.colorRampTexture;ge||(ge=L.colorRampTexture=new a.T(V,L.colorRamp,Z.RGBA)),ge.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}V.bindFramebuffer.set(L.tileFramebuffer.framebuffer),function(ge,ye,Ce){const Ae=ge.context,pe=Ae.gl,_e=ye.tileFramebuffer;Ae.activeTexture.set(pe.TEXTURE0);const xe={u_texture:0,u_opacity:1.05*(Ge=ye.paint.get("raster-particle-fade-opacity-factor"))/(Ge+.05)},Re=ge.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Ge;for(const Te of Ce){const[,,We,qe]=Te;_e.colorAttachment.set(We.targetColorTexture.texture),Ae.viewport.set([0,0,_e.width,_e.height]),Ae.clear({color:a.C.transparent}),qe&&(We.backgroundColorTexture.bind(pe.NEAREST,pe.CLAMP_TO_EDGE),Re.draw(ge,pe.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.alphaBlended,a.af.disabled,xe,ye.id,ge.viewportBuffer,ge.quadTriangleIndexBuffer,ge.viewportSegments))}}(P,L,ae),function(ge,ye,Ce,Ae){const pe=ge.context,_e=pe.gl,xe=Ce.tileFramebuffer,Re=ge.transform.projection.name==="globe",Ge=Ce.paint.get("raster-particle-max-speed");for(const Te of Ae){const[We,qe,dt]=Te;pe.activeTexture.set(_e.TEXTURE0+0),qe.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),xe.colorAttachment.set(dt.targetColorTexture.texture);const mt=ge.getOrCreateProgram("rasterParticleDraw",{defines:qe.defines,overrideFog:!1});pe.activeTexture.set(_e.TEXTURE0+1);const ft=qe.scalarData?[]:[0,1,2,3].map(ct=>a.bZ[ct](We));ft.push(We);const Be=We.canonical.x,Je=We.canonical.y;for(const ct of ft){const Ot=ye.getTile(Re?ct.wrapped():ct);if(!Ot)continue;const kt=Ot.rasterParticleState;if(!kt)continue;const Nt=ct.canonical.x+(1<<ct.canonical.z)*(ct.wrap-We.wrap),Dt=ct.canonical.y;kt.particleTexture0.bind(_e.NEAREST,_e.CLAMP_TO_EDGE);const vt=jy(1,kt.particleTexture0.size[0],[Nt-Be,Dt-Je],0,qe.texture.size,2,Ge,qe.textureOffset,qe.scale,qe.offset);mt.draw(ge,_e.POINTS,a.ae.disabled,a.ag.disabled,a.a.alphaBlended,a.af.disabled,vt,Ce.id,kt.particleIndexBuffer,void 0,kt.particleSegment)}}}(P,I,L,ae),V.bindFramebuffer.set(L.particleFramebuffer.framebuffer),function(ge,ye,Ce,Ae){const pe=ge.context,_e=pe.gl,xe=ye.paint.get("raster-particle-max-speed"),Re=Ae*ye.paint.get("raster-particle-speed-factor")*.15,Ge=function(We){return Math.pow(We,6)}(.01+1*ye.paint.get("raster-particle-reset-rate-factor")),Te=ye.particleFramebuffer;pe.viewport.set([0,0,Te.width,Te.height]);for(const We of Ce){const[,qe,dt]=We;pe.activeTexture.set(_e.TEXTURE0+0),qe.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),pe.activeTexture.set(_e.TEXTURE0+1);const mt=dt.particleTexture0;mt.bind(_e.NEAREST,_e.CLAMP_TO_EDGE);const ft=TA(1,mt.size[0],0,qe.texture.size,xe,Re,Ge,qe.textureOffset,qe.scale,qe.offset);Te.colorAttachment.set(dt.particleTexture1.texture),pe.clear({color:a.C.transparent}),ge.getOrCreateProgram("rasterParticleUpdate",{defines:qe.defines}).draw(ge,_e.TRIANGLES,a.ae.disabled,a.ag.disabled,a.a.unblended,a.af.disabled,ft,ye.id,ge.viewportBuffer,ge.quadTriangleIndexBuffer,ge.viewportSegments)}}(P,L,ae,me)}(y,l,d,v),y.renderPass==="translucent"&&(function(P,I,L,F,V){const Z=P.context,Q=Z.gl,J=!P.options.moving,ie=P.transform.projection.name==="globe";if(!F.length)return;const[oe,ae]=P.stencilConfigForOverlap(F),se=[];ie&&se.push("PROJECTION_GLOBE_VIEW");const me=P.stencilModeFor3D();for(const ge of ae){const ye=ge.toUnwrapped(),Ce=I.getTile(ge);if(!Ce.rasterParticleState)continue;const Ae=Ce.rasterParticleState,pe=100;Ce.registerFadeDuration(pe);const _e=I.findLoadedParent(ge,0),xe=dp(Ce,_e,I,P.transform,pe);let Re,Ge;P.terrain&&P.terrain.prepareDrawTile(),Z.activeTexture.set(Q.TEXTURE0),Ae.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Z.activeTexture.set(Q.TEXTURE1),_e&&_e.rasterParticleState?(_e.rasterParticleState.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Re=Math.pow(2,_e.tileID.overscaledZ-Ce.tileID.overscaledZ),Ge=[Ce.tileID.canonical.x*Re%1,Ce.tileID.canonical.y*Re%1]):Ae.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Te=ie?Float32Array.from(P.transform.expandedFarZProjMatrix):P.transform.calculateProjMatrix(ye,J),We=P.transform,qe=s1(We),dt=a.bc(ge.canonical),mt=a.bd(dt.getCenter().lat);let ft,Be,Je,ct,Ot;ie?(ft=Float32Array.from(a.bf(a.bg(ge.canonical))),Be=Float32Array.from(We.globeMatrix),Je=Float32Array.from(a.bb(We)),ct=[a.aj(We.center.lng),a.ak(We.center.lat)],Ot=Float32Array.from(a.be(ge.canonical,dt,mt,We.worldSize/We._pixelsPerMercatorPixel))):(ft=new Float32Array(16),Be=new Float32Array(9),Je=new Float32Array(16),ct=[0,0],Ot=new Float32Array(9));const kt=By(Te,ft,Be,Je,Ot,Ge||[0,0],a.a1(P.transform.zoom),ct,qe,Re||1,xe,250),Nt=P.isTileAffectedByFog(ge),Dt=P.getOrCreateProgram("rasterParticle",{defines:se,overrideFog:Nt});if(P.uploadCommonUniforms(Z,Dt,ye),ie){const vt=new a.ae(Q.LEQUAL,a.ae.ReadWrite,P.depthRangeFor3D),at=0,$t=P.globeSharedBuffers;if($t){const[vn,mn,On]=$t.getGridBuffers(mt,at!==0);Dt.draw(P,Q.TRIANGLES,vt,me,a.a.alphaBlended,a.af.backCCW,kt,L.id,vn,mn,On)}}else{const vt=P.depthModeForSublayer(0,a.ae.ReadOnly),at=oe[ge.overscaledZ],{tileBoundsBuffer:$t,tileBoundsIndexBuffer:vn,tileBoundsSegments:mn}=P.getTileBoundsBuffers(Ce);Dt.draw(P,Q.TRIANGLES,vt,at,a.a.alphaBlended,a.af.disabled,kt,L.id,$t,vn,mn)}}P.resetStencilClippingMasks()}(y,l,d,v),y.style.map.triggerRepaint())},background:function(y,l,d,v){const S=d.paint.get("background-color"),T=d.paint.get("background-opacity"),P=d.paint.get("background-emissive-strength");if(T===0)return;const I=y.context,L=I.gl,F=y.transform,V=F.tileSize,Z=d.paint.get("background-pattern");let Q;if(Z!==void 0&&(Z===null||(Q=y.imageManager.getPattern(Z.toString(),d.scope,y.style.getLut(d.scope)),!Q)))return;const J=!Z&&S.a===1&&T===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==J)return;const ie=a.ag.disabled,oe=y.depthModeForSublayer(0,J==="opaque"?a.ae.ReadWrite:a.ae.ReadOnly),ae=y.colorModeForDrapableLayerRenderPass(P),se=Z?"backgroundPattern":"background";let me,ge=v;ge||(me=y.getBackgroundTiles(),ge=Object.values(me).map(ye=>ye.tileID)),Z&&(I.activeTexture.set(L.TEXTURE0),y.imageManager.bind(y.context,d.scope));for(const ye of ge){const Ce=y.isTileAffectedByFog(ye),Ae=y.getOrCreateProgram(se,{overrideFog:Ce}),pe=ye.toUnwrapped(),_e=v?ye.projMatrix:y.transform.calculateProjMatrix(pe);y.prepareDrawTile();const xe=l?l.getTile(ye):me?me[ye.key]:new a.by(ye,V,F.zoom,y),Re=Z?t1(_e,P,T,y,0,d.scope,Q,{tileID:ye,tileSize:V}):_f(_e,P,T,S.toRenderColor(d.lut));y.uploadCommonUniforms(I,Ae,pe);const{tileBoundsBuffer:Ge,tileBoundsIndexBuffer:Te,tileBoundsSegments:We}=y.getTileBoundsBuffers(xe);Ae.draw(y,L.TRIANGLES,oe,ie,ae,a.af.disabled,Re,d.id,Ge,Te,We)}},sky:function(y,l,d){const v=y._atmosphere?a.a1(y.transform.zoom):1,S=d.paint.get("sky-opacity")*v;if(S===0)return;const T=y.context,P=d.paint.get("sky-type"),I=new a.ae(T.gl.LEQUAL,a.ae.ReadOnly,[0,1]),L=y.frameCounter/1e3%1;P==="atmosphere"?y.renderPass==="offscreen"?d.needsSkyboxCapture(y)&&(function(F,V,Z,Q){const J=F.context,ie=J.gl;let oe=V.skyboxFbo;if(!oe){oe=V.skyboxFbo=J.createFramebuffer(32,32,!0,null),V.skyboxGeometry=new Cc(J),V.skyboxTexture=J.gl.createTexture(),ie.bindTexture(ie.TEXTURE_CUBE_MAP,V.skyboxTexture),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MAG_FILTER,ie.LINEAR);for(let ge=0;ge<6;++ge)ie.texImage2D(ie.TEXTURE_CUBE_MAP_POSITIVE_X+ge,0,ie.RGBA,32,32,0,ie.RGBA,ie.UNSIGNED_BYTE,null)}J.bindFramebuffer.set(oe.framebuffer),J.viewport.set([0,0,32,32]);const ae=V.getCenter(F,!0),se=F.getOrCreateProgram("skyboxCapture"),me=new Float64Array(16);a.ad.identity(me),a.ad.rotateY(me,me,.5*-Math.PI),ts(F,V,se,me,ae,0),a.ad.identity(me),a.ad.rotateY(me,me,.5*Math.PI),ts(F,V,se,me,ae,1),a.ad.identity(me),a.ad.rotateX(me,me,.5*-Math.PI),ts(F,V,se,me,ae,2),a.ad.identity(me),a.ad.rotateX(me,me,.5*Math.PI),ts(F,V,se,me,ae,3),a.ad.identity(me),ts(F,V,se,me,ae,4),a.ad.identity(me),a.ad.rotateY(me,me,Math.PI),ts(F,V,se,me,ae,5),J.viewport.set([0,0,F.width,F.height])}(y,d),d.markSkyboxValid(y)):y.renderPass==="sky"&&function(F,V,Z,Q,J){const ie=F.context,oe=ie.gl,ae=F.transform,se=F.getOrCreateProgram("skybox");ie.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_CUBE_MAP,V.skyboxTexture);const me=((ge,ye,Ce,Ae,pe)=>({u_matrix:ge,u_sun_direction:ye,u_cubemap:0,u_opacity:Ae,u_temporal_offset:pe}))(ae.skyboxMatrix,V.getCenter(F,!1),0,Q,J);F.uploadCommonUniforms(ie,se),se.draw(F,oe.TRIANGLES,Z,a.ag.disabled,F.colorModeForRenderPass(),a.af.backCW,me,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(y,d,I,S,L):P==="gradient"&&y.renderPass==="sky"&&function(F,V,Z,Q,J){const ie=F.context,oe=ie.gl,ae=F.transform,se=F.getOrCreateProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new Cc(ie)),ie.activeTexture.set(oe.TEXTURE0);let me=V.colorRampTexture;me||(me=V.colorRampTexture=new a.T(ie,V.colorRamp,oe.RGBA)),me.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const ge=((ye,Ce,Ae,pe,_e)=>({u_matrix:ye,u_color_ramp:0,u_center_direction:Ce,u_radius:a.ab(Ae),u_opacity:pe,u_temporal_offset:_e}))(ae.skyboxMatrix,V.getCenter(F,!1),V.paint.get("sky-gradient-radius"),Q,J);F.uploadCommonUniforms(ie,se),se.draw(F,oe.TRIANGLES,Z,a.ag.disabled,F.colorModeForRenderPass(),a.af.backCW,ge,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(y,d,I,S,L)},debug:function(y,l,d,v,S,T){for(let P=0;P<d.length;P++)if(S){const F=new a.C(v.r*.8,v.g*.8,v.b*.8,1);Bt(y,l,d[P],v,-1,-1,T),Bt(y,l,d[P],v,-1,1,T),Bt(y,l,d[P],v,1,1,T),Bt(y,l,d[P],v,1,-1,T),Bt(y,l,d[P],F,0,0,T)}else Bt(y,l,d[P],v,0,0,T)},custom:function(y,l,d,v){const S=y.context,T=d.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&d.isDraped(l)){if(y.renderPass==="offscreen"){const P=T.prerender;if(P){if(y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const I=y.transform.pointMerc;P.call(T,S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),a.a1(y.transform.zoom),[I.x,I.y],y.transform.pixelsPerMeterRatio)}else P.call(T,S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const I=T.renderToTile;if(I){const L=v[0].canonical,F=new a.Y(L.x+v[0].wrap*(1<<L.z),L.y,L.z);S.setDepthMode(a.ae.disabled),S.setStencilMode(a.ag.disabled),S.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),I.call(T,S.gl,F),S.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),S.setStencilMode(a.ag.disabled);const P=T.renderingMode==="3d"?new a.ae(y.context.gl.LEQUAL,a.ae.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,a.ae.ReadOnly);if(S.setDepthMode(P),y.transform.projection.name==="globe"){const I=y.transform.pointMerc;T.render(S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),a.a1(y.transform.zoom),[I.x,I.y],y.transform.pixelsPerMeterRatio)}else T.render(S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState(),S.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(y,l,d,v){if(y.renderPass==="opaque")return;const S=d.paint.get("model-opacity");if(S===0)return;const T=d.paint.get("model-cast-shadows");if(y.renderPass==="shadow"&&(!T||y.terrain&&S<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof a.Z))return;const P=y.shadowRenderer,I=d.paint.get("model-receive-shadows");P&&(P.useNormalOffset=!0,I||(P.enabled=!1));const L=()=>{P&&(P.useNormalOffset=!0,I||(P.enabled=!0))},F=l.getSource();if(y.renderPass==="light-beam"&&F.type!=="batched-model")return;if(F.type==="vector"||F.type==="geojson")return function(se,me,ge,ye,Ce){const Ae=se.transform;if(Ae.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${Ae.projection.name} projection is not yet implemented`);const pe=Ae.getFreeCameraOptions().position;if(!se.modelManager)return;const _e=se.modelManager;ge.modelManager=_e;const xe=se.shadowRenderer;if(!ge._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Re=ge._unevaluatedLayout._values["model-id"],Ge={...ge.layout.get("model-id").parameters},Te=se.style.order.indexOf(ge.fqid);for(const We of ye){const qe=me.getTile(We).getBucket(ge);if(!qe||qe.projection.name!==Ae.projection.name)continue;const dt=qe.getModelUris();dt&&!qe.modelsRequested&&(_e.addModelsFromBucket(dt,Ce),qe.modelsRequested=!0);const mt=fi(We,Ae);Ge.zoom=mt;const ft=Re.possiblyEvaluate(Ge);if(l1(se,qe,We),yo.shadowUniformsInitialized=!1,yo.useSingleShadowCascade=!!xe&&xe.getMaxCascadeForTile(We.toUnwrapped())===0,se.renderPass==="shadow"&&xe){if(se.currentShadowCascade===1&&qe.isInsideFirstShadowMapFrustum)continue;const ct=Ae.calculatePosMatrix(We.toUnwrapped(),Ae.worldSize);if(yo.tileMatrix.set(ct),yo.shadowTileMatrix=Float32Array.from(xe.calculateShadowPassMatrixFromMatrix(ct)),yo.aabb.min.fill(0),yo.aabb.max[0]=yo.aabb.max[1]=a.a3,yo.aabb.max[2]=0,Si(qe,yo,se,ge.scope))continue}const Be=1<<We.canonical.z,Je=[((pe.x-We.wrap)*Be-We.canonical.x)*a.a3,(pe.y*Be-We.canonical.y)*a.a3,pe.z*Be*a.a3];se.conflationActive&&Object.keys(qe.instancesPerModel).length>0&&se.style.isLayerClipped(ge,me.getSource())&&qe.updateReplacement(We,se.replacementSource,Te)&&(qe.uploaded=!1,qe.upload(se.context));for(let ct in qe.instancesPerModel){const Ot=qe.instancesPerModel[ct];Ot.features.length>0&&(ct=ft.evaluate(Ot.features[0].feature,{}));const kt=_e.getModel(ct,Ce);if(kt&&kt.uploaded)for(const Nt of kt.nodes)aa(se,ge,Nt,Ot,Je,We,yo)}}}(y,l,d,v,F.type==="vector"?d.scope:""),void L();if(!F.loaded())return;if(F.type==="batched-model")return function(se,me,ge,ye){ge.resetLayerRenderingStats(se);const Ce=se.context,Ae=se.transform,pe=se.style.fog,_e=se.shadowRenderer;if(Ae.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${Ae.projection.name} projection is not yet implemented`);const xe=se.transform.getFreeCameraOptions().position,Re=a._.scale([],[xe.x,xe.y,xe.z],se.transform.worldSize);a._.negate(Re,Re);const Ge=a.ad.identity([]),Te=a.cg(Ae.center.lat,Ae.zoom),We=a.ad.fromScaling([],[1,1,1/Te]);a.ad.translate(Ge,Ge,Re);const qe=ge.paint.get("model-opacity"),dt=new a.ae(Ce.gl.LEQUAL,a.ae.ReadWrite,se.depthRangeFor3D),mt=new a.ae(Ce.gl.LEQUAL,a.ae.ReadOnly,se.depthRangeFor3D),ft=new a.b6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Be=se.renderPass==="shadow",Je=Be&&_e?_e.getCurrentCascadeFrustum():Ae.getFrustum(Ae.scaleZoom(Ae.worldSize)),ct=ge.paint.get("model-front-cutoff"),Ot=ct[2]<1,kt=Ps(se,ge.paint.get("model-cutoff-fade-range")),Nt=ge.getLayerRenderingStats();(function(Dt,vt,at,$t){const vn=Dt.terrain?Dt.terrain.exaggeration():0,mn=Dt.transform.zoom;for(const On of $t){const Nn=vt.getTile(On).getBucket(at);Nn&&(Dt.conflationActive&&Nn.updateReplacement(On,Dt.replacementSource),Nn.evaluateScale(Dt,at),Dt.terrain&&vn>0&&Nn.elevationUpdate(Dt.terrain,vn,On,at.source),Nn.needsReEvaluation(Dt,mn,at)&&Nn.evaluate(at))}})(se,me,ge,ye),function(){let Dt,vt,at;Ot?(Dt=ye.length-1,vt=-1,at=-1):(Dt=0,vt=ye.length,at=1);for(let $t=Dt;$t!==vt;$t+=at){const vn=ye[$t],mn=me.getTile(vn).getBucket(ge);if(!mn||!mn.uploaded)continue;let On=!1;_e&&(On=_e.getMaxCascadeForTile(vn.toUnwrapped())===0);const Nn=Ae.calculatePosMatrix(vn.toUnwrapped(),Ae.worldSize),lr=mn.modelTraits,pn=[];for(const tr of mn.getNodesInfo()){if(tr.hiddenByReplacement||!tr.node.meshes)continue;const br=tr.node;let or=0;se.terrain&&br.elevation&&(or=br.elevation*se.terrain.exaggeration());const Dn=tr.evaluatedScale;if(Dn[0]<=1&&Dn[1]<=1&&Dn[2]<=1&&(()=>{const Ve=tr.aabb;return ft.min=[...Ve.min],ft.max=[...Ve.max],ft.min[2]+=or,ft.max[2]+=or,a._.transformMat4(ft.min,ft.min,Nn),a._.transformMat4(ft.max,ft.max,Nn),ft})().intersects(Je)===0)continue;const gn=[...Nn],Er=br.anchor?br.anchor[0]:0,Pr=br.anchor?br.anchor[1]:0;a.ad.translate(gn,gn,[Er*(Dn[0]-1),Pr*(Dn[1]-1),or]),a._.exactEquals(Dn,a.cj)||a.ad.scale(gn,gn,Dn);const ur=a.ad.multiply([],gn,br.matrix),pt=a.ad.multiply([],Ae.expandedFarZProjMatrix,ur),zt=a.ad.multiply([],Ae.expandedFarZProjMatrix,gn),Nr=a.aA.transformMat4([],[Er,Pr,or,1],pt)[2];br.hidden=!1;let nr=qe;Be||(Ot&&(nr*=Ta(gn,Ae,tr.aabb,ct)),nr*=Zy(kt,Nr)),nr!==0?pn.push({nodeInfo:tr,depth:Nr,opacity:nr,wvpForNode:pt,wvpForTile:zt,nodeModelMatrix:ur,tileModelMatrix:gn}):br.hidden=!0}Be||pn.sort((tr,br)=>!Ot||tr.opacity===1&&br.opacity===1?tr.depth<br.depth?-1:1:tr.opacity===1?-1:br.opacity===1?1:tr.depth>br.depth?-1:1);for(const tr of pn){const br=tr.nodeInfo,or=br.node;let Dn=a.ad.multiply([],We,tr.tileModelMatrix);a.ad.multiply(Dn,Ge,Dn);const gn=a.ad.invert([],Dn);a.ad.transpose(gn,gn),a.ad.scale(gn,gn,Os),Dn=a.ad.multiply(Dn,Dn,or.matrix);const Er=se.renderPass==="light-beam",Pr=lr&a.cl.HasMapboxMeshFeatures,ur=Pr?0:br.evaluatedRMEA[0][2];for(let pt=0;pt<or.meshes.length;++pt){const zt=or.meshes[pt],Nr=pt===or.lightMeshIndex;let nr=tr.wvpForNode;if(Nr){if(!Er&&!se.terrain&&se.shadowRenderer){se.currentLayer<se.firstLightBeamLayer&&(se.firstLightBeamLayer=se.currentLayer);continue}nr=tr.wvpForTile}else if(Er)continue;const Ve={defines:[]},Uo=[];if(Tf(Ve.defines,Uo,zt,se,ge.lut),Pr||Ve.defines.push("DIFFUSE_SHADED"),On&&Ve.defines.push("SHADOWS_SINGLE_CASCADE"),Nt&&(Be?Nt.numRenderedVerticesInShadowPass+=zt.vertexArray.length:Nt.numRenderedVerticesInTransparentPass+=zt.vertexArray.length),Be){go(zt,tr.nodeModelMatrix,se,ge);continue}let zi=null;if(pe){const wl=Pc(tr.nodeModelMatrix,se.transform);if(zi=new Float32Array(wl),Ae.projection.name!=="globe"){const Sl=zt.aabb.min,ks=zt.aabb.max,[rs,Ds]=pe.getOpacityForBounds(wl,Sl[0],Sl[1],ks[0],ks[1]);Ve.overrideFog=rs>=Rr||Ds>=Rr}}const ao=zt.material;let Ti;ao.occlusionTexture&&ao.occlusionTexture.offsetScale&&(Ti=ao.occlusionTexture.offsetScale,Ve.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!Be&&_e&&(_e.useNormalOffset=!!zt.normalBuffer);const _o=se.getOrCreateProgram("model",Ve);!Be&&_e&&_e.setupShadowsFromMatrix(tr.tileModelMatrix,_o,_e.useNormalOffset),se.uploadCommonUniforms(Ce,_o,null,zi);const Pa=ao.pbrMetallicRoughness;Pa.metallicFactor=.9,Pa.roughnessFactor=.5;const Vo=vf(new Float32Array(nr),new Float32Array(Dn),new Float32Array(gn),new Float32Array(or.matrix),se,tr.opacity,Pa.baseColorFactor.toRenderColor(null),ao.emissiveFactor,Pa.metallicFactor,Pa.roughnessFactor,ao,ur,ge,[0,0,0],Ti);!Nr&&(br.hasTranslucentParts||tr.opacity<1)&&_o.draw(se,Ce.gl.TRIANGLES,dt,a.ag.disabled,a.a.disabled,a.af.backCCW,Vo,ge.id,zt.vertexBuffer,zt.indexBuffer,zt.segments,ge.paint,se.transform.zoom,void 0,Uo),_o.draw(se,Ce.gl.TRIANGLES,Nr?mt:dt,a.ag.disabled,Nr||tr.opacity<1||br.hasTranslucentParts?a.a.alphaBlended:a.a.unblended,a.af.backCCW,Vo,ge.id,zt.vertexBuffer,zt.indexBuffer,zt.segments,ge.paint,se.transform.zoom,void 0,Uo)}}}}()}(y,l,d,v),void L();const V=F.getModels(),Z=[],Q=y.transform.getFreeCameraOptions().position,J=a._.scale([],[Q.x,Q.y,Q.z],y.transform.worldSize);a._.negate(J,J);const ie=[],oe=[];let ae=0;for(const se of V){const me=d.paint.get("model-rotation").constantOr(null),ge=d.paint.get("model-scale").constantOr(null),ye=d.paint.get("model-translation").constantOr(null);se.computeModelMatrix(y,me,ge,ye,!0,!0,!1);const Ce=a.ad.identity([]),Ae=a.cg(se.position.lat,y.transform.zoom),pe=a.ad.fromScaling([],[1,1,1/Ae]);a.ad.translate(Ce,Ce,J),Z.push({zScaleMatrix:pe,negCameraPosMatrix:Ce});for(const _e of se.nodes)Yi(y.transform,_e,se.matrix,y.transform.expandedFarZProjMatrix,ae,ie,oe);ae++}if(ie.sort((se,me)=>me.depth-se.depth),y.renderPass!=="shadow"){if(S===1)for(const se of oe)ou(se,y,d,Z[se.modelIndex],a.ag.disabled,y.colorModeForRenderPass());else{for(const se of oe)ou(se,y,d,Z[se.modelIndex],a.ag.disabled,a.a.disabled);for(const se of oe)ou(se,y,d,Z[se.modelIndex],y.stencilModeFor3D(),y.colorModeForRenderPass());y.resetStencilClippingMasks()}for(const se of ie)ou(se,y,d,Z[se.modelIndex],a.ag.disabled,y.colorModeForRenderPass());L()}else{for(const se of oe)go(se.mesh,se.nodeModelMatrix,y,d);for(const se of ie)go(se.mesh,se.nodeModelMatrix,y,d);L()}}},u1={model:function(y,l,d){const v=l.getSource();if(!v.loaded())return;if(v.type==="vector"||v.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,v.type==="vector"?y.scope:""));if(v.type==="batched-model")return;const S=v.getModels();for(const T of S)T.upload(d.context)},raster:function(y,l,d){const v=l.getSource();if(!(v instanceof _c&&v.loaded()))return;const S=y.sourceLayer||v.rasterLayerIds&&v.rasterLayerIds[0];if(!S)return;const T=y.paint.get("raster-array-band")||v.getInitialBand(S);if(T==null)return;const P=l.getIds().map(I=>l.getTileByID(I));for(const I of P)I.updateNeeded(S,T)&&v.prepareTile(I,S,T)},"raster-particle":function(y,l,d){const v=l.getSource();if(!(v instanceof _c&&v.loaded()))return;const S=y.sourceLayer||v.rasterLayerIds&&v.rasterLayerIds[0];if(!S)return;const T=y.paint.get("raster-particle-array-band")||v.getInitialBand(S);if(T==null)return;const P=l.getIds().map(I=>l.getTileByID(I));for(const I of P)I.updateNeeded(S,T)&&v.prepareTile(I,S,T)}};class c1{constructor(l,d,v,S){this.context=new Wi(l,d),this.occlusionBuffers=new IA(this.context),this.transform=v,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=a.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const T=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const P of T)this._debugParams.enabledLayers[P]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const P of T)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],P);this.symbolParams=new ro(S),this.setup(),this.numSublayers=a.bv.maxUnderzooming+a.bv.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.co,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new cp(this),this._wireframeDebugCache=new Af,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[]}updateTerrain(l,d){const v=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ky(this,l));const S=this._terrain;this.transform.elevation=v?S:null,S.update(l,this.transform,d),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(l){const d=l.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,S]=d.getFovAdjustedRange(this.transform._fov);if(v>S)return void(this.transform.fogCullDistSq=null);const T=v+.78*(S-v);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(l){l&&!this._terrain&&(this._terrain=new ky(this,this.style)),this._forceTerrainMode=l}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(l,d){if(this.width=l*a.e.devicePixelRatio,this.height=d*a.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._mergedLayers[v].resize()}setup(){const l=this.context,d=new a.bt;d.emplaceBack(0,0),d.emplaceBack(a.a3,0),d.emplaceBack(0,a.a3),d.emplaceBack(a.a3,a.a3),this.tileExtentBuffer=l.createVertexBuffer(d,a.br.members),this.tileExtentSegments=a.b.simpleSegment(0,0,4,2);const v=new a.bt;v.emplaceBack(0,0),v.emplaceBack(a.a3,0),v.emplaceBack(0,a.a3),v.emplaceBack(a.a3,a.a3),this.debugBuffer=l.createVertexBuffer(v,a.br.members),this.debugSegments=a.b.simpleSegment(0,0,4,5);const S=new a.bt;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(S,a.br.members),this.viewportSegments=a.b.simpleSegment(0,0,4,2);const T=new a.cp;T.emplaceBack(0,0,0,0),T.emplaceBack(a.a3,0,a.a3,0),T.emplaceBack(0,a.a3,0,a.a3),T.emplaceBack(a.a3,a.a3,a.a3,a.a3),this.mercatorBoundsBuffer=l.createVertexBuffer(T,a.cq.members),this.mercatorBoundsSegments=a.b.simpleSegment(0,0,4,2);const P=new a.bu;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(P);const I=new a.cr;for(const F of[0,1,3,2,0])I.emplaceBack(F);this.debugIndexBuffer=l.createIndexBuffer(I),this.emptyTexture=new a.T(l,new a.i({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=a.ad.create();const L=this.context.gl;this.stencilClearMode=new a.ag({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,l.TRIANGLES,a.ae.disabled,this.stencilClearMode,a.a.disabled,a.af.disabled,fp(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,d,v){if(!d||this.currentStencilSource===d.id||!l.isTileClipped()||!v||v.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const L of v)if(this._tileClippingMaskIDs[L.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=d.id;const S=this.context,T=S.gl;this.nextStencilID+v.length>256&&this.clearStencil(),S.setColorMode(a.a.disabled),S.setDepthMode(a.ae.disabled);const P=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of v){const L=d.getTile(I),F=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:Z,tileBoundsSegments:Q}=this.getTileBoundsBuffers(L);P.draw(this,T.TRIANGLES,a.ae.disabled,new a.ag({func:T.ALWAYS,mask:0},F,255,T.KEEP,T.KEEP,T.REPLACE),a.a.disabled,a.af.disabled,fp(I.projMatrix),"$clipping",V,Z,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new a.ag({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const d=this.context.gl;return new a.ag({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,v=l.sort((P,I)=>I.overscaledZ-P.overscaledZ),S=v[v.length-1].overscaledZ,T=v[0].overscaledZ-S+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const P={};for(let I=0;I<T;I++)P[I+S]=new a.ag({func:d.GEQUAL,mask:255},I+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=T,[P,v]}return[{[S]:a.ag.disabled},v]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new a.a([l.CONSTANT_COLOR,l.ONE,l.CONSTANT_COLOR,l.ONE],new a.C(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.a.unblended:a.a.alphaBlended}colorModeForDrapableLayerRenderPass(l){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new a.a([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new a.C(0,0,0,l===void 0?0:l),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(l,d,v,S=!1){if(this.depthOcclusion)return new a.ae(this.context.gl.GREATER,a.ae.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return a.ae.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new a.ae(v||this.context.gl.LEQUAL,d,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((l,d)=>l+d/this._fpsHistory.length,0))}render(l,d){const v=a.e.now();this._dt=v-this._timeStamp,this._timeStamp=v,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=l.map.repaint,this.style=l,this.options=d;const S=this.style._mergedLayers,T=this.style.order.filter(_e=>{const xe=S[_e];return!(xe.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[xe.type]}),P=T.map(_e=>S[_e]),I=this.style._mergedSourceCaches;this.imageManager=l.imageManager,this.modelManager=l.modelManager,this.symbolFadeChange=l.placement.symbolFadeChange(a.e.now()),this.imageManager.beginFrame();let L=0,F=!1;for(const _e in I){const xe=I[_e];xe.used&&(xe.prepare(this.context),xe.getSource().usedInConflation&&++L)}let V=!1;for(const _e of P)_e.isHidden(this.transform.zoom)||(_e.type==="clip"&&(V=!0),this.prepareLayer(_e));const Z={},Q={},J={},ie={},oe={};for(const _e in I){const xe=I[_e];Z[_e]=xe.getVisibleCoordinates(),Q[_e]=Z[_e].slice().reverse(),J[_e]=xe.getVisibleCoordinates(!0).reverse(),ie[_e]=xe.getShadowCasterCoordinates(),oe[_e]=xe.sortCoordinatesByDistance(Z[_e])}const ae=_e=>{const xe=this.style.getLayerSourceCache(_e);return xe&&xe.used?xe.getSource():null};if(L||V){const _e=[],xe=[];let Re=0;for(const Ge of P)this.isSourceForClippingOrConflation(Ge,ae(Ge))&&(_e.push(Ge),xe.push(Re)),Re++;if(_e&&(V||_e.length>1)){const Ge=[];for(let Te=0;Te<_e.length;Te++){const We=_e[Te],qe=xe[Te],dt=this.style.getLayerSourceCache(We);if(!dt||!dt.used||!dt.getSource().usedInConflation&&We.type!=="clip")continue;let mt=1/0,ft=a.cu.None;if(We.type==="clip"){mt=qe;for(const Be of We.layout.get("clip-layer-types"))ft|=Be==="model"?a.cu.Model:Be==="symbol"?a.cu.Symbol:a.cu.FillExtrusion}Ge.push({layer:We.fqid,cache:dt,order:mt,clipMask:ft})}this.replacementSource.setSources(Ge),F=!0}}F||this.replacementSource.clear(),this.conflationActive=F,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let _e=0;_e<P.length;_e++){const xe=P[_e],Re=xe.cutoffRange();if(this.longestCutoffRange=Math.max(Re,this.longestCutoffRange),Re>0){const Ge=ae(xe);Ge&&(this.minCutoffZoom=Math.max(Ge.minzoom,this.minCutoffZoom)),xe.minzoom&&(this.minCutoffZoom=Math.max(xe.minzoom,this.minCutoffZoom))}xe.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=_e),this._lastOcclusionLayer=_e)}const se=this.style&&this.style.fog;se?(this._fogVisible=se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(J),this.opaquePassCutoff=0);const me=this._shadowRenderer;if(me){me.updateShadowParameters(this.transform,this.style.directionalLight);for(const _e in I)for(const xe of Z[_e]){let Re={min:0,max:0};this.terrain&&(Re=this.terrain.getMinMaxForTile(xe)||Re),me.addShadowReceiver(xe.toUnwrapped(),Re.min,Re.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.cs(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new qy(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!a.ct(this.context.gl))return;this.renderPass="offscreen";for(const _e of P){const xe=l.getLayerSourceCache(_e);if(!_e.hasOffscreenPass()||_e.isHidden(this.transform.zoom))continue;const Re=xe?Q[xe.id]:void 0;(_e.type==="custom"||_e.type==="raster"||_e.type==="raster-particle"||_e.isSky()||Re&&Re.length)&&this.renderLayer(this,xe,_e,Re)}this.depthRangeFor3D=[0,1-(P.length+2)*this.numSublayers*this.depthEpsilon];const ge=this.terrain;ge&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&ge.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ie)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ye=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ce=(()=>{if(d.showOverdrawInspector)return a.C.black;const _e=this.style.fog;if(_e&&this.transform.projection.supportsFog){const xe=this.style.getLut(_e.scope);if(!ye){const Re=_e.properties.get("color").toRenderColor(xe).toArray01();return new a.C(...Re)}if(ye){const Re=_e.properties.get("space-color").toRenderColor(xe).toArray01();return new a.C(...Re)}}return a.C.transparent})();if(this.context.clear({color:Ce,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ye&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const _e=P[this.currentLayer],xe=l.getLayerSourceCache(_e);if(_e.isSky())continue;const Re=xe?(_e.is3D()?oe:Q)[xe.id]:void 0;this._renderTileClippingMasks(_e,xe,Re),this.renderLayer(this,xe,_e,Re)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ye&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.a1(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const _e=P[this.currentLayer],xe=l.getLayerSourceCache(_e);_e.isSky()&&this.renderLayer(this,xe,_e,xe?Q[xe.id]:void 0)}function Ae(_e,xe){let Re;return xe&&(Re=(_e.type==="symbol"?J:_e.is3D()?oe:Q)[xe.id]),Re}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<T.length;){const _e=P[this.currentLayer];if(_e.type==="raster"){const xe=l.getLayerSourceCache(_e);this.renderLayer(this,xe,_e,Ae(_e,xe))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let pe=0;for(me&&(pe=me.getShadowCastingLayerCount());this.currentLayer<T.length;){const _e=P[this.currentLayer],xe=l.getLayerSourceCache(_e);if(_e.isSky())++this.currentLayer;else if(ge&&this.style.isLayerDraped(_e)){if(_e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=ge.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(_e.is3D()||this.terrain||this._renderTileClippingMasks(_e,xe,xe?Z[xe.id]:void 0),this.renderLayer(this,xe,_e,Ae(_e,xe)),!ge&&me&&pe>0&&_e.hasShadowPass()&&--pe==0&&(me.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Re=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Re;this.currentLayer++){const Ge=P[this.currentLayer];if(!Ge.hasLightBeamPass())continue;const Te=l.getLayerSourceCache(Ge);this.renderLayer(this,Te,Ge,Te?Q[Te.id]:void 0)}this.currentLayer=Re,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Re=this.currentLayer;this.depthOcclusion=!0;for(const Ge of this.layersWithOcclusionOpacity){this.currentLayer=Ge;const Te=P[this.currentLayer],We=l.getLayerSourceCache(Te),qe=We?Q[We.id]:void 0;Te.is3D()||this.terrain||this._renderTileClippingMasks(Te,We,We?Z[We.id]:void 0),this.renderLayer(this,We,Te,qe)}this.depthOcclusion=!1,this.currentLayer=Re,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let _e=null;P.forEach(xe=>{const Re=l.getLayerSourceCache(xe);Re&&!xe.isHidden(this.transform.zoom)&&Re.getVisibleCoordinates().length&&(!_e||_e.getSource().maxzoom<Re.getSource().maxzoom)&&(_e=Re)}),_e&&this.options.showTileBoundaries&&Ea.debug(this,_e,_e.getVisibleCoordinates(),a.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Ea.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(_e){const xe=_e.transform.padding;Yn(_e,_e.transform.height-(xe.top||0),3,Ep),Yn(_e,xe.bottom||0,3,Wy),Kn(_e,xe.left||0,3,es),Kn(_e,_e.transform.width-(xe.right||0),3,Hy);const Re=_e.transform.centerPoint;(function(Ge,Te,We,qe){mo(Ge,Te-1,We-10,2,20,qe),mo(Ge,Te-10,We-1,20,2,qe)})(_e,Re.x,_e.transform.height-Re.y,Ec)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),F||(this.conflationActive=!1)}prepareLayer(l){this.gpuTimingStart(l);const{unsupportedLayers:d}=this.transform.projection,v=!d||!d.includes(l.type);if(u1[l.type]&&(v||this.terrain&&l.type==="custom")){const S=this.style.getLayerSourceCache(l);u1[l.type](l,S,this)}this.gpuTimingEnd()}renderLayer(l,d,v,S){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="sky"||v.type==="custom"||v.type==="model"||v.type==="raster"||v.type==="raster-particle"||S&&S.length)&&(this.id=v.id,this.gpuTimingStart(v),l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes(v.type)&&(!l.terrain||v.type!=="custom")||v.type==="clip"||Ea[v.type](l,d,v,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,v=this.context.gl;let S=this.gpuTimers[l.id];S||(S=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:v.createQuery()}),S.calls++,v.beginQuery(d.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,d=this.context.gl,v=d.createQuery();this.deferredRenderGpuTimeQueries.push(v),d.beginQuery(l.TIME_ELAPSED_EXT,v)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const d={};for(const v in l){const S=l[v],T=this.context.extTimerQuery,P=T.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;T.deleteQueryEXT(S.query),d[v]=P}return d}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery,v=this.context.gl;let S=0;for(const T of l)S+=d.getQueryParameter(T,v.QUERY_RESULT)/1e6,d.deleteQueryEXT(T);return S}translatePosMatrix(l,d,v,S,T){if(!v[0]&&!v[1])return l;const P=T?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(P){const F=Math.sin(P),V=Math.cos(P);v=[v[0]*V-v[1]*F,v[0]*F+v[1]*V]}const I=[T?v[0]:a.bB(d,v[0],this.transform.zoom),T?v[1]:a.bB(d,v[1],this.transform.zoom),0],L=new Float32Array(16);return a.ad.translate(L,l,I),L}saveTileTexture(l){const d=l.size[0],v=this._tileTextures[d];v?v.push(l):this._tileTextures[d]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(l,d,v){const S=v===void 0?this.terrain&&this.terrain.renderingToTexture:v,T=[];return this.style&&this.style.enable3dLights()&&(l==="globeRaster"||l==="terrainRaster"?(T.push("LIGHTING_3D_MODE"),T.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||T.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||T.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?T.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):T.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(T.push("TERRAIN"),this.linearFloatFilteringSupported()&&T.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&T.push("GLOBE"),!this._fogVisible||S||d!==void 0&&!d||T.push("FOG","FOG_DITHERING"),S&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}getOrCreateProgram(l,d){this.cache=this.cache||{};const v=d&&d.defines||[],S=d&&d.config,T=this.currentGlobalDefines(l,d&&d.overrideFog,d&&d.overrideRtt).concat(v),P=pf.cacheKey(Hx[l],l,T,S);return this.cache[P]||(this.cache[P]=new pf(this.context,l,Hx[l],S,EA[l],T)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(l,d){if(this.style.enable3dLights()){const v=this.style.directionalLight,S=this.style.ambientLight;if(v&&S){const T=((P,I,L)=>{const F=P.properties.get("direction"),V=P.properties.get("color").toRenderColor(L.getLut(P.scope)).toArray01(),Z=P.properties.get("intensity"),Q=I.properties.get("color").toRenderColor(L.getLut(I.scope)).toArray01(),J=I.properties.get("intensity"),ie=[F.x,F.y,F.z],oe=a.bA(Q,J),ae=a.bA(V,Z);return{u_lighting_ambient_color:oe,u_lighting_directional_dir:ie,u_lighting_directional_color:ae,u_ground_radiance:Is(ie,ae,oe)}})(v,S,this.style);d.setLightsUniformValues(l,T)}}}uploadCommonUniforms(l,d,v,S,T){if(this.uploadCommonLightUniforms(l,d),this.terrain&&this.terrain.renderingToTexture)return;const P=this.style.fog;if(P){const I=P.getOpacity(this.transform.pitch),L=((F,V,Z,Q,J,ie,oe,ae,se,me,ge,ye)=>{const Ce=F.transform,Ae=V.properties.get("color").toRenderColor(F.style.getLut(V.scope)).toArray01();Ae[3]=Q;const pe=F.frameCounter/1e3%1,[_e,xe]=V.properties.get("vertical-range");return{u_fog_matrix:Z?Ce.calculateFogTileMatrix(Z):ye||F.identityMat,u_fog_range:V.getFovAdjustedRange(Ce._fov),u_fog_color:Ae,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(_e,xe),xe],u_fog_temporal_offset:pe,u_frustum_tl:J,u_frustum_tr:ie,u_frustum_br:oe,u_frustum_bl:ae,u_globe_pos:se,u_globe_radius:me,u_viewport:ge,u_globe_transition:a.a1(Ce.zoom),u_is_globe:+(Ce.projection.name==="globe")}})(this,P,v,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.e.devicePixelRatio,this.transform.height*a.e.devicePixelRatio],S);d.setFogUniformValues(l,L)}T&&d.setCutoffUniformValues(l,T.uniformValues)}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,d=l.createTexture();return l.bindTexture(l.TEXTURE_2D,d),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const l=this._backgroundTiles,d=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const S of v)d[S.key]=l[S.key]||new a.by(S,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(l,d){return!(!l.is3D()||l.minzoom&&l.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||l.sourceLayer!=="building")&&l.type!=="clip"&&(!d||d.type!=="batched-model"))}isTileAffectedByFog(l){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[l.key];return d||(this._cachedTileFogOpacities[l.key]=d=this.style.fog.getOpacityForTile(l)),d[0]>=Rr||d[1]>=Rr}}class oo{constructor(l,d,v,S){this.screenBounds=l,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(l,d){let v,S;if(l instanceof a.P||typeof l[0]=="number"){const T=a.P.convert(l);v=[T],S=d.isPointAboveHorizon(T)}else{const T=a.P.convert(l[0]),P=a.P.convert(l[1]);v=[T,P],S=a.cv(T,P).every(I=>d.isPointAboveHorizon(I))}return new oo(v,d.getCameraPoint(),S,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return a.cv(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const d=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],S=a.cv(d,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<v.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?S[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(S[3]=this.cameraPoint)),a.cw(S,l)}bufferedCameraGeometryGlobe(l){const d=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],S=a.cv(d,v,l),T=this.cameraPoint.clone();switch(3*((T.y>d.y)+(T.y>v.y))+((T.x>d.x)+(T.x>v.x))){case 0:S[0]=T,S[4]=T.clone();break;case 1:S.splice(1,0,T);break;case 2:S[1]=T;break;case 3:S.splice(4,0,T);break;case 5:S.splice(2,0,T);break;case 6:S[3]=T;break;case 7:S.splice(3,0,T);break;case 8:S[2]=T}return S}containsTile(l,d,v,S=0){const T=l.queryPadding/d._pixelsPerMercatorPixel+1,P=v?this._bufferedCameraMercator(T,d):this._bufferedScreenMercator(T,d);let I=l.tileID.wrap+(P.unwrapped?S:0);const L=P.polygon.map(ae=>a.cx(l.tileTransform,ae,I));if(!a.cy(L,0,0,a.a3,a.a3))return;I=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const F=this.screenGeometryMercator.polygon.map(ae=>a.cz(l.tileTransform,ae,I)),V=F.map(ae=>new a.P(ae[0],ae[1])),Z=d.getFreeCameraOptions().position||new a.Y(0,0,0),Q=a.cz(l.tileTransform,Z,I),J=F.map(ae=>{const se=a._.sub(ae,ae,Q);return a._.normalize(se,se),new a.aT(Q,se)}),ie=a.bB(l,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:J,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(oe=a.cA(L),oe.min.x=a.at(oe.min.x,0,a.a3),oe.min.y=a.at(oe.min.y,0,a.a3),oe.max.x=a.at(oe.max.x,0,a.a3),oe.max.y=a.at(oe.max.y,0,a.a3),oe),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:ie};var oe}_bufferedScreenMercator(l,d){const v=Yy(l);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),d):{polygon:this.bufferedScreenGeometry(l).map(T=>d.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[v]=S,S}}_bufferedCameraMercator(l,d){const v=Yy(l);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),d):{polygon:this.bufferedCameraGeometry(l).map(T=>d.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[v]=S,S}}_projectAndResample(l,d){const v=function(T,P){const I=a.ad.multiply([],P.pixelMatrix,P.globeMatrix),L=[0,-a.cD,0,1],F=[0,a.cD,0,1],V=[0,0,0,1];a.aA.transformMat4(L,L,I),a.aA.transformMat4(F,F,I),a.aA.transformMat4(V,V,I);const Z=new a.P(L[0]/L[3],L[1]/L[3]),Q=new a.P(F[0]/F[3],F[1]/F[3]),J=a.cB(T,Z)&&L[3]<V[3],ie=a.cB(T,Q)&&F[3]<V[3];if(!J&&!ie)return null;const oe=function(pe,_e,xe){for(let Re=1;Re<pe.length;Re++){const Ge=ml(_e.pointCoordinate3D(pe[Re-1]).x),Te=ml(_e.pointCoordinate3D(pe[Re]).x);if(xe<0){if(Ge<Te)return{idx:Re,t:-Ge/(Te-1-Ge)}}else if(Te<Ge)return{idx:Re,t:(1-Ge)/(Te+1-Ge)}}return null}(T,P,J?-1:1);if(!oe)return null;const{idx:ae,t:se}=oe;let me=ae>1?Xy(T.slice(0,ae),P):[],ge=ae<T.length?Xy(T.slice(ae),P):[];me=me.map(pe=>new a.P(ml(pe.x),pe.y)),ge=ge.map(pe=>new a.P(ml(pe.x),pe.y));const ye=[...me];ye.length===0&&ye.push(ge[ge.length-1]);const Ce=a.a2(ye[ye.length-1].y,(ge.length===0?me[0]:ge[0]).y,se);let Ae;return Ae=J?[new a.P(0,Ce),new a.P(0,0),new a.P(1,0),new a.P(1,Ce)]:[new a.P(1,Ce),new a.P(1,1),new a.P(0,1),new a.P(0,Ce)],ye.push(...Ae),ge.length===0?ye.push(me[0]):ye.push(...ge),{polygon:ye.map(pe=>new a.Y(pe.x,pe.y)),unwrapped:!1}}(l,d);if(v)return v;const S=function(T,P){let I=!1,L=-1/0,F=0;for(let Z=0;Z<T.length-1;Z++)T[Z].x>L&&(L=T[Z].x,F=Z);for(let Z=0;Z<T.length-1;Z++){const Q=(F+Z)%(T.length-1),J=T[Q],ie=T[Q+1];Math.abs(J.x-ie.x)>.5&&(J.x<ie.x?(J.x+=1,Q===0&&(T[T.length-1].x+=1)):(ie.x+=1,Q+1===T.length-1&&(T[0].x+=1)),I=!0)}const V=a.aj(P.center.lng);return I&&V<Math.abs(V-1)&&T.forEach(Z=>{Z.x-=1}),{polygon:T,unwrapped:I}}(Xy(l,d).map(T=>new a.P(ml(T.x),T.y)),d);return{polygon:S.polygon.map(T=>new a.Y(T.x,T.y)),unwrapped:S.unwrapped}}}function Xy(y,l){return a.cC(y,d=>{const v=l.pointCoordinate3D(d);d.x=v.x,d.y=v.y},1/256)}function ml(y){return y<0?1+y%1:y%1}function Yy(y){return 100*y|0}function OA(y,l){const d=a.ad.identity([]);return a.ad.scale(d,d,[.5*y.width,.5*-y.height,1]),a.ad.translate(d,d,[1,-1,0]),a.ad.multiply(d,d,y.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(d)}function RA(y,l,d,v,S,T,P,I=!1){const L=y.tilesIn(v,P,I);L.sort(Mc);const F=[];for(const Z of L)F.push({wrappedTileID:Z.tile.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(l,d,y._state,Z,S,T,OA(y.transform,Z.tile.tileID),I)});const V=function(Z){const Q={},J={};for(const ie of Z){const oe=ie.queryResults,ae=ie.wrappedTileID,se=J[ae]=J[ae]||{};for(const me in oe){const ge=oe[me],ye=se[me]=se[me]||{},Ce=Q[me]=Q[me]||[];for(const Ae of ge)ye[Ae.featureIndex]||(ye[Ae.featureIndex]=!0,Ce.push(Ae))}}return Q}(F);for(const Z in V)V[Z].forEach(Q=>{const J=Q.feature,ie=J.layer;ie&&ie.type!=="background"&&ie.type!=="sky"&&ie.type!=="slot"&&(J.source=ie.source,ie["source-layer"]&&(J.sourceLayer=ie["source-layer"]),J.state=J.id!==void 0?y.getFeatureState(ie["source-layer"],J.id):{})});return V}function Cf(y,l){const d=y.getRenderableIds().map(T=>y.getTileByID(T)),v=[],S={};for(let T=0;T<d.length;T++){const P=d[T],I=P.tileID.canonical.key;S[I]||(S[I]=!0,P.querySourceFeatures(v,l))}return v}function Mc(y,l){const d=y.tileID,v=l.tileID;return d.overscaledZ-v.overscaledZ||d.canonical.y-v.canonical.y||d.wrap-v.wrap||d.canonical.x-v.canonical.x}class kA{constructor(l){this.style=l,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const l=!1,d=!1;for(const v in this.style._mergedLayers){const S=this.style._mergedLayers[v];if(S.type==="fill-extrusion")this.layers.push({layer:S,visible:l,visibilityChanged:d});else if(S.type==="model"){const T=this.style.getLayerSource(S);T&&T.type==="batched-model"&&this.layers.push({layer:S,visible:l,visibilityChanged:d})}}}onNewFrame(l){this.layersGotHidden=!1;for(const d of this.layers){const v=d.layer;let S=!1;v.type==="fill-extrusion"?S=!v.isHidden(l)&&v.paint.get("fill-extrusion-opacity")>0:v.type==="model"&&(S=!v.isHidden(l)&&v.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!S&&d.visible,d.visible=S}}updateZOffset(l,d){this.currentBuildingBuckets=[];for(const S of this.layers){const T=S.layer,P=this.style.getLayerSourceCache(T);let I=1;T.type==="fill-extrusion"&&(I=S.visible?T.paint.get("fill-extrusion-vertical-scale"):0);let L=P?P.getTile(d):null;if(!L&&P&&d.canonical.z>P.getSource().minzoom){let F=d.scaledTo(Math.min(P.getSource().maxzoom,d.overscaledZ-1));for(;F.overscaledZ>=P.getSource().minzoom&&(L=P.getTile(F),!L&&F.overscaledZ!==0);)F=F.scaledTo(F.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:L?L.getBucket(T):null,tileID:L?L.tileID:d,verticalScale:I})}l.hasAnyZOffset=!1;let v=!1;for(let S=0;S<l.symbolInstances.length;S++){const T=l.symbolInstances.get(S),P=T.zOffset,I=this._getHeightAtTileOffset(d,T.tileAnchorX,T.tileAnchorY);T.zOffset=I!==Number.NEGATIVE_INFINITY?I:P,v||P===T.zOffset||(v=!0),l.hasAnyZOffset||T.zOffset===0||(l.hasAnyZOffset=!0)}v&&(l.zOffsetBuffersNeedUpload=!0,l.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(l,d,v,S){let T=d,P=v;if(l.canonical.z!==S.canonical.z){const I=S.canonical,L=1/(1<<l.canonical.z-I.z);T=(d+l.canonical.x*a.a3)*L-I.x*a.a3|0,P=(v+l.canonical.y*a.a3)*L-I.y*a.a3|0}return{tileX:T,tileY:P}}_getHeightAtTileOffset(l,d,v){let S,T;for(let P=0;P<this.layers.length;++P){if(this.layers[P].layer.type!=="fill-extrusion")continue;const{bucket:I,tileID:L,verticalScale:F}=this.currentBuildingBuckets[P];if(!I)continue;const{tileX:V,tileY:Z}=this._mapCoordToOverlappingTile(l,d,v,L),Q=I.getHeightAtTileCoord(V,Z);Q&&Q.height!==void 0&&(Q.hidden?S=Q.height:T=Math.max(Q.height*F,T||0))}if(T!==void 0)return T;for(let P=0;P<this.layers.length;++P){const I=this.layers[P];if(I.layer.type!=="model"||!I.visible)continue;const{bucket:L,tileID:F}=this.currentBuildingBuckets[P];if(!L)continue;const{tileX:V,tileY:Z}=this._mapCoordToOverlappingTile(l,d,v,F),Q=L.getHeightAtTileCoord(V,Z);if(Q&&!Q.hidden)return Q.height===void 0&&S!==void 0?Math.min(Q.maxHeight,S)*Q.verticalScale:Q.height?Q.height*Q.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Ic(y,l){const d={};for(const v in y)v!=="ref"&&(d[v]=y[v]);return a.cE.forEach(v=>{v in l&&(d[v]=l[v])}),d}function Ky(y){y=y.slice();const l=Object.create(null);for(let d=0;d<y.length;d++)l[y[d].id]=y[d];for(let d=0;d<y.length;d++)"ref"in y[d]&&(y[d]=Ic(y[d],l[y[d].ref]));return y}const Gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Rs(y,l,d){d.push({command:Gn.addSource,args:[y,l[y]]})}function h1(y,l,d){l.push({command:Gn.removeSource,args:[y]}),d[y]=!0}function DA(y,l,d,v){h1(y,d,v),Rs(y,l,d)}function LA(y,l,d){let v;for(v in y[d])if(y[d].hasOwnProperty(v)&&v!=="data"&&!b(y[d][v],l[d][v]))return!1;for(v in l[d])if(l[d].hasOwnProperty(v)&&v!=="data"&&!b(y[d][v],l[d][v]))return!1;return!0}function Pf(y,l,d,v,S,T){let P;for(P in l=l||{},y=y||{})y.hasOwnProperty(P)&&(b(y[P],l[P])||d.push({command:T,args:[v,P,l[P],S]}));for(P in l)l.hasOwnProperty(P)&&!y.hasOwnProperty(P)&&(b(y[P],l[P])||d.push({command:T,args:[v,P,l[P],S]}))}function Ap(y){return y.id}function Oc(y,l){return y[l.id]=l,y}class f1{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=a.at(l,0,1);let d=1,v=this._distances[d];const S=l*this.paddedLength+this.padding;for(;v<S&&d<this._distances.length;)v=this._distances[++d];const T=d-1,P=this._distances[T],I=v-P,L=I>0?(S-P)/I:0;return this.points[T].mult(1-L).add(this.points[d].mult(L))}}class Qy{constructor(l,d,v){const S=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(l/v),this.yCellCount=Math.ceil(d/v);for(let P=0;P<this.xCellCount*this.yCellCount;P++)S.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,v,S,T){this._forEachCell(d,v,S,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(T)}insertCircle(l,d,v,S){this._forEachCell(d-S,v-S,d+S,v+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(v),this.circles.push(S)}_insertBoxCell(l,d,v,S,T,P){this.boxCells[T].push(P)}_insertCircleCell(l,d,v,S,T,P){this.circleCells[T].push(P)}_query(l,d,v,S,T,P){if(v<0||l>this.width||S<0||d>this.height)return!T&&[];const I=[];if(l<=0&&d<=0&&this.width<=v&&this.height<=S){if(T)return!0;for(let L=0;L<this.boxKeys.length;L++)I.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const F=this.circles[3*L],V=this.circles[3*L+1],Z=this.circles[3*L+2];I.push({key:this.circleKeys[L],x1:F-Z,y1:V-Z,x2:F+Z,y2:V+Z})}return P?I.filter(P):I}return this._forEachCell(l,d,v,S,this._queryCell,I,{hitTest:T,seenUids:{box:{},circle:{}}},P),T?I.length>0:I}_queryCircle(l,d,v,S,T){const P=l-v,I=l+v,L=d-v,F=d+v;if(I<0||P>this.width||F<0||L>this.height)return!S&&[];const V=[];return this._forEachCell(P,L,I,F,this._queryCellCircle,V,{hitTest:S,circle:{x:l,y:d,radius:v},seenUids:{box:{},circle:{}}},T),S?V.length>0:V}query(l,d,v,S,T){return this._query(l,d,v,S,!1,T)}hitTest(l,d,v,S,T){return this._query(l,d,v,S,!0,T)}hitTestCircle(l,d,v,S){return this._queryCircle(l,d,v,!0,S)}_queryCell(l,d,v,S,T,P,I,L){const F=I.seenUids,V=this.boxCells[T];if(V!==null){const Q=this.bboxes;for(const J of V)if(!F.box[J]){F.box[J]=!0;const ie=4*J;if(l<=Q[ie+2]&&d<=Q[ie+3]&&v>=Q[ie+0]&&S>=Q[ie+1]&&(!L||L(this.boxKeys[J]))){if(I.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[J],x1:Q[ie],y1:Q[ie+1],x2:Q[ie+2],y2:Q[ie+3]})}}}const Z=this.circleCells[T];if(Z!==null){const Q=this.circles;for(const J of Z)if(!F.circle[J]){F.circle[J]=!0;const ie=3*J;if(this._circleAndRectCollide(Q[ie],Q[ie+1],Q[ie+2],l,d,v,S)&&(!L||L(this.circleKeys[J]))){if(I.hitTest)return P.push(!0),!0;{const oe=Q[ie],ae=Q[ie+1],se=Q[ie+2];P.push({key:this.circleKeys[J],x1:oe-se,y1:ae-se,x2:oe+se,y2:ae+se})}}}}}_queryCellCircle(l,d,v,S,T,P,I,L){const F=I.circle,V=I.seenUids,Z=this.boxCells[T];if(Z!==null){const J=this.bboxes;for(const ie of Z)if(!V.box[ie]){V.box[ie]=!0;const oe=4*ie;if(this._circleAndRectCollide(F.x,F.y,F.radius,J[oe+0],J[oe+1],J[oe+2],J[oe+3])&&(!L||L(this.boxKeys[ie])))return P.push(!0),!0}}const Q=this.circleCells[T];if(Q!==null){const J=this.circles;for(const ie of Q)if(!V.circle[ie]){V.circle[ie]=!0;const oe=3*ie;if(this._circlesCollide(J[oe],J[oe+1],J[oe+2],F.x,F.y,F.radius)&&(!L||L(this.circleKeys[ie])))return P.push(!0),!0}}}_forEachCell(l,d,v,S,T,P,I,L){const F=this._convertToXCellCoord(l),V=this._convertToYCellCoord(d),Z=this._convertToXCellCoord(v),Q=this._convertToYCellCoord(S);for(let J=F;J<=Z;J++)for(let ie=V;ie<=Q;ie++)if(T.call(this,l,d,v,S,this.xCellCount*ie+J,P,I,L))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,v,S,T,P){const I=S-l,L=T-d,F=v+P;return F*F>I*I+L*L}_circleAndRectCollide(l,d,v,S,T,P,I){const L=(P-S)/2,F=Math.abs(l-(S+L));if(F>L+v)return!1;const V=(I-T)/2,Z=Math.abs(d-(T+V));if(Z>V+v)return!1;if(F<=L||Z<=V)return!0;const Q=F-L,J=Z-V;return Q*Q+J*J<=v*v}}const Aa=100;class d1{constructor(l,d,v=new Qy(l.width+200,l.height+200,25),S=new Qy(l.width+200,l.height+200,25)){this.transform=l,this.grid=v,this.ignoredGrid=S,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Aa,this.screenBottomBoundary=l.height+Aa,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=d}placeCollisionBox(l,d,v,S,T,P,I,L){let F=v.projectedAnchorX,V=v.projectedAnchorY,Z=v.projectedAnchorZ;const Q=v.elevation,J=v.tileID,ie=l.getProjection();if(Q&&J){const[Ae,pe,_e]=ie.upVector(J.canonical,v.tileAnchorX,v.tileAnchorY),xe=ie.upVectorScale(J.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;F+=Ae*Q*xe,V+=pe*Q*xe,Z+=_e*Q*xe}const oe=this.projectAndGetPerspectiveRatio(I,F,V,Z,v.tileID,ie.name==="globe"||!!Q||this.transform.pitch>0,ie),ae=P*oe.perspectiveRatio,se=(v.x1*d+S.x-v.padding)*ae+oe.point.x,me=(v.y1*d+S.y-v.padding)*ae+oe.point.y,ge=(v.x2*d+S.x+v.padding)*ae+oe.point.x,ye=(v.y2*d+S.y+v.padding)*ae+oe.point.y,Ce=oe.perspectiveRatio<=.55||oe.occluded;return!this.isInsideGrid(se,me,ge,ye)||!T&&this.grid.hitTest(se,me,ge,ye,L)||Ce?{box:[],offscreen:!1,occluded:oe.occluded}:{box:[se,me,ge,ye],offscreen:this.isOffscreen(se,me,ge,ye),occluded:!1}}placeCollisionCircles(l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe){const ae=[],se=this.transform.elevation,me=l.getProjection(),ge=se?se.getAtTileOffsetFunc(oe,this.transform.center.lat,this.transform.worldSize,me):null,ye=new a.P(v.tileAnchorX,v.tileAnchorY);let{x:Ce,y:Ae,z:pe}=me.projectTilePoint(ye.x,ye.y,oe.canonical);if(ge){const[ft,Be,Je]=ge(ye);Ce+=ft,Ae+=Be,pe+=Je}const _e=me.name==="globe",xe=this.projectAndGetPerspectiveRatio(I,Ce,Ae,pe,oe,_e||!!se||this.transform.pitch>0,me),{perspectiveRatio:Re}=xe,Ge=(Z?P/Re:P*Re)/a.bN,Te=oa(Ce,Ae,pe,L),We=xe.signedDistanceFromCamera>0?lp(Ge,T,v.lineOffsetX*Ge,v.lineOffsetY*Ge,!1,Te,ye,v,S,L,{},se&&!Z?ge:null,Z&&!!se,me,oe,Z):null;let qe=!1,dt=!1,mt=!0;if(We&&!xe.occluded){const ft=.5*J*Re+ie,Be=new a.P(-100,-100),Je=new a.P(this.screenRightBoundary,this.screenBottomBoundary),ct=new f1,{first:Ot,last:kt}=We,Nt=Ot.path.length;let Dt=[];for(let $t=Nt-1;$t>=1;$t--)Dt.push(Ot.path[$t]);for(let $t=1;$t<kt.path.length;$t++)Dt.push(kt.path[$t]);const vt=2.5*ft;F&&(Dt=Dt.map(([$t,vn,mn],On)=>(ge&&!_e&&(mn=ge(On<Nt-1?Ot.tilePath[Nt-1-On]:kt.tilePath[On-Nt+2])[2]),oa($t,vn,mn,F))),Dt.some($t=>$t[3]<=0)&&(Dt=[]));let at=[];if(Dt.length>0){let $t=1/0,vn=-1/0,mn=1/0,On=-1/0;for(const Nn of Dt)$t=Math.min($t,Nn[0]),mn=Math.min(mn,Nn[1]),vn=Math.max(vn,Nn[0]),On=Math.max(On,Nn[1]);vn>=Be.x&&$t<=Je.x&&On>=Be.y&&mn<=Je.y&&(at=[Dt.map(Nn=>new a.P(Nn[0],Nn[1]))],($t<Be.x||vn>Je.x||mn<Be.y||On>Je.y)&&(at=a.cF(at,Be.x,Be.y,Je.x,Je.y)))}for(const $t of at){ct.reset($t,.25*ft);let vn=0;vn=ct.length<=.5*ft?1:Math.ceil(ct.paddedLength/vt)+1;for(let mn=0;mn<vn;mn++){const On=mn/Math.max(vn-1,1),Nn=ct.lerp(On),lr=Nn.x+Aa,pn=Nn.y+Aa;ae.push(lr,pn,ft,0);const tr=lr-ft,br=pn-ft,or=lr+ft,Dn=pn+ft;if(mt=mt&&this.isOffscreen(tr,br,or,Dn),dt=dt||this.isInsideGrid(tr,br,or,Dn),!d&&this.grid.hitTestCircle(lr,pn,ft,Q)&&(qe=!0,!V))return{circles:[],offscreen:!1,collisionDetected:qe,occluded:!1}}}}return{circles:!V&&qe||!dt?[]:ae,offscreen:mt,collisionDetected:qe,occluded:xe.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let v=1/0,S=1/0,T=-1/0,P=-1/0;for(const V of l){const Z=new a.P(V.x+Aa,V.y+Aa);v=Math.min(v,Z.x),S=Math.min(S,Z.y),T=Math.max(T,Z.x),P=Math.max(P,Z.y),d.push(Z)}const I=this.grid.query(v,S,T,P).concat(this.ignoredGrid.query(v,S,T,P)),L={},F={};for(const V of I){const Z=V.key;if(L[Z.bucketInstanceId]===void 0&&(L[Z.bucketInstanceId]={}),L[Z.bucketInstanceId][Z.featureIndex])continue;const Q=[new a.P(V.x1,V.y1),new a.P(V.x2,V.y1),new a.P(V.x2,V.y2),new a.P(V.x1,V.y2)];a.cG(d,Q)&&(L[Z.bucketInstanceId][Z.featureIndex]=!0,F[Z.bucketInstanceId]===void 0&&(F[Z.bucketInstanceId]=[]),F[Z.bucketInstanceId].push(Z.featureIndex))}return F}insertCollisionBox(l,d,v,S,T){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:S,collisionGroupID:T},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,v,S,T){const P=d?this.ignoredGrid:this.grid,I={bucketInstanceId:v,featureIndex:S,collisionGroupID:T};for(let L=0;L<l.length;L+=4)P.insertCircle(I,l[L],l[L+1],l[L+2])}projectAndGetPerspectiveRatio(l,d,v,S,T,P,I){const L=[d,v,S,1];let F=!1;S||this.transform.pitch>0?(a.aA.transformMat4(L,L,l),this.fogState&&T&&I.name!=="globe"&&(F=function(Q,J,ie,oe,ae,se){const me=se.calculateFogTileMatrix(ae),ge=[J,ie,oe];return a._.transformMat4(ge,ge,me),hi(Q,a._.length(ge),se.pitch,se._fov)}(this.fogState,d,v,S,T.toUnwrapped(),this.transform)>.9)):Qa(L,L,l);const V=L[3];return{point:new a.P((L[0]/V+1)/2*this.transform.width+Aa,(-L[1]/V+1)/2*this.transform.height+Aa),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/V*.5,1.5),signedDistanceFromCamera:V,occluded:P&&L[2]>V||F}}isOffscreen(l,d,v,S){return v<Aa||l>=this.screenRightBoundary||S<Aa||d>this.screenBottomBoundary}isInsideGrid(l,d,v,S){return v>=0&&l<this.gridRightBoundary&&S>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=a.ad.identity([]);return a.ad.translate(l,l,[-100,-100,0]),l}}class gl{constructor(l,d,v,S){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):S&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class yl{constructor(l,d,v,S,T,P=!1){this.text=new gl(l?l.text:null,d,v,T),this.icon=new gl(l?l.icon:null,d,S,T),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Cp{constructor(l,d,v,S=!1){this.text=l,this.icon=d,this.skipFade=v,this.clipped=S}}class p1{constructor(){this.invProjMatrix=a.ad.create(),this.viewportMatrix=a.ad.create(),this.circles=[]}}class Mf{constructor(l,d,v,S,T){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=v,this.bucketIndex=S,this.tileID=T}}class If{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:v=>v.collisionGroupID===d}}return this.collisionGroups[l]}}function Jy(y,l,d,v,S){const{horizontalAlign:T,verticalAlign:P}=a.bQ(y),I=-(T-.5)*l,L=-(P-.5)*d,F=a.bP(y,v);return new a.P(I+F[0]*S,L+F[1]*S)}function Of(y,l,d,v,S){const T=new a.P(y,l);return d&&T._rotate(v?S:-S),T}class sa{constructor(l,d,v,S,T,P){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new d1(this.transform,T),this.buildingIndex=P,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new If(v),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,v,S){const T=v.getBucket(d),P=v.latestFeatureIndex;if(!T||!P||d.fqid!==T.layerIds[0])return;const I=T.layers[0].layout,L=v.collisionBoxArray,F=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),V=v.tileSize/a.a3,Z=v.tileID.toUnwrapped();this.transform.setProjection(T.projection);const Q=(J=v.tileID,ie=T.getProjection(),oe=this.transform,ie.name===this.projection?oe.calculateProjMatrix(J.toUnwrapped()):bp(oe,ie,J));var J,ie,oe;const ae=I.get("text-pitch-alignment")==="map",se=I.get("text-rotation-alignment")==="map";d.compileFilter();const me=d.dynamicFilter(),ge=d.dynamicFilterNeedsFeature(),ye=this.transform.calculatePixelsToTileUnitsMatrix(v),Ce=Jl(Q,v.tileID.canonical,ae,se,this.transform,T.getProjection(),ye);let Ae=null;if(ae){const xe=mc(Q,v.tileID.canonical,ae,se,this.transform,T.getProjection(),ye);Ae=a.ad.multiply([],this.transform.labelPlaneMatrix,xe)}let pe=null;me&&v.latestFeatureIndex&&(pe={unwrappedTileID:Z,dynamicFilter:me,dynamicFilterNeedsFeature:ge,featureIndex:v.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Mf(T.bucketInstanceId,P,T.sourceLayerIndex,T.index,v.tileID);const _e={bucket:T,layout:I,posMatrix:Q,textLabelPlaneMatrix:Ce,labelToScreenMatrix:Ae,clippingData:pe,scale:F,textPixelRatio:V,holdingForFade:v.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:a.aD(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.aD(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(S)for(const xe of T.sortKeyRanges){const{sortKey:Re,symbolInstanceStart:Ge,symbolInstanceEnd:Te}=xe;l.push({sortKey:Re,symbolInstanceStart:Ge,symbolInstanceEnd:Te,parameters:_e})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:_e})}attemptAnchorPlacement(l,d,v,S,T,P,I,L,F,V,Z,Q,J,ie,oe,ae,se,me){const{textOffset0:ge,textOffset1:ye,crossTileID:Ce}=Q,Ae=[ge,ye],pe=Jy(l,v,S,Ae,T),_e=this.collisionIndex.placeCollisionBox(ie,T,d,Of(pe.x,pe.y,P,I,this.transform.angle),Z,L,F,V.predicate);if(ae){const xe=ie.getSymbolInstanceIconSize(me,this.transform.zoom,Q.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ie,xe,ae,Of(pe.x,pe.y,P,I,this.transform.angle),Z,L,F,V.predicate).box.length===0)return}if(_e.box.length>0){let xe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ce]&&this.prevPlacement.placements[Ce]&&this.prevPlacement.placements[Ce].text&&(xe=this.prevPlacement.variableOffsets[Ce].anchor),this.variableOffsets[Ce]={textOffset:Ae,width:v,height:S,anchor:l,textScale:T,prevAnchor:xe},this.markUsedJustification(ie,l,Q,oe),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,oe,Q),this.placedOrientations[Ce]=oe),{shift:pe,placedGlyphBoxes:_e}}}placeLayerBucketPart(l,d,v,S){const{bucket:T,layout:P,posMatrix:I,textLabelPlaneMatrix:L,labelToScreenMatrix:F,clippingData:V,textPixelRatio:Z,holdingForFade:Q,collisionBoxArray:J,partiallyEvaluatedTextSize:ie,partiallyEvaluatedIconSize:oe,collisionGroup:ae}=l.parameters,se=P.get("text-optional"),me=P.get("icon-optional"),ge=P.get("text-allow-overlap"),ye=P.get("icon-allow-overlap"),Ce=P.get("text-rotation-alignment")==="map",Ae=P.get("text-pitch-alignment")==="map",pe=P.get("symbol-z-order")==="viewport-y",_e=P.get("symbol-z-elevate");this.transform.setProjection(T.projection);let xe=ge&&(ye||!T.hasIconData()||me),Re=ye&&(ge||!T.hasTextData()||se);!T.collisionArrays&&J&&T.deserializeCollisionBoxes(J),v&&S&&T.updateCollisionDebugBuffers(this.transform.zoom,J);const Ge=(Te,We,qe)=>{const{crossTileID:dt,numVerticalGlyphVertices:mt}=Te;if(V){const or={zoom:this.transform.zoom,pitch:this.transform.pitch};let Dn=null;if(V.dynamicFilterNeedsFeature){const gn=this.retainedQueryData[T.bucketInstanceId];Dn=V.featureIndex.loadFeature({featureIndex:Te.featureIndex,bucketIndex:gn.bucketIndex,sourceLayerIndex:gn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,V.dynamicFilter)(or,Dn,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new a.P(Te.tileAnchorX,Te.tileAnchorY),this.transform.calculateDistanceTileData(V.unwrappedTileID)))return this.placements[dt]=new Cp(!1,!1,!1,!0),void d.add(dt)}if(d.has(dt))return;if(Q)return void(this.placements[dt]=new Cp(!1,!1,!1));let ft=!1,Be=!1,Je=!0,ct=!1,Ot=!1,kt=null,Nt={box:null,offscreen:null,occluded:null},Dt={box:null,offscreen:null,occluded:null},vt=null,at=null,$t=null,vn=0,mn=0,On=0;qe.textFeatureIndex?vn=qe.textFeatureIndex:Te.useRuntimeCollisionCircles&&(vn=Te.featureIndex),qe.verticalTextFeatureIndex&&(mn=qe.verticalTextFeatureIndex);const Nn=or=>{or.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const Dn=this.transform.elevation;or.elevation=Te.zOffset+(Dn?Dn.getAtTileOffset(or.tileID,or.tileAnchorX,or.tileAnchorY):0)},lr=qe.textBox;if(lr){Nn(lr);const or=gn=>{let Er=a.aE.horizontal;if(T.allowVerticalPlacement&&!gn&&this.prevPlacement){const Pr=this.prevPlacement.placedOrientations[dt];Pr&&(this.placedOrientations[dt]=Pr,Er=Pr,this.markUsedOrientation(T,Er,Te))}return Er},Dn=(gn,Er)=>{if(T.allowVerticalPlacement&&mt>0&&qe.verticalTextBox){for(const Pr of T.writingModes)if(Pr===a.aE.vertical?(Nt=Er(),Dt=Nt):Nt=gn(),Nt&&Nt.box&&Nt.box.length)break}else Nt=gn()};if(P.get("text-variable-anchor")){let gn=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[dt]){const ur=this.prevPlacement.variableOffsets[dt];gn.indexOf(ur.anchor)>0&&(gn=gn.filter(pt=>pt!==ur.anchor),gn.unshift(ur.anchor))}const Er=(ur,pt,zt)=>{const Nr=T.getSymbolInstanceTextSize(ie,Te,this.transform.zoom,We),nr=(ur.x2-ur.x1)*Nr+2*ur.padding,Ve=(ur.y2-ur.y1)*Nr+2*ur.padding,Uo=Te.hasIconTextFit&&!ye?pt:null;Uo&&Nn(Uo);let zi={box:[],offscreen:!1,occluded:!1};const ao=ge?2*gn.length:gn.length;for(let Ti=0;Ti<ao;++Ti){const _o=this.attemptAnchorPlacement(gn[Ti%gn.length],ur,nr,Ve,Nr,Ce,Ae,Z,I,ae,Ti>=gn.length,Te,We,T,zt,Uo,ie,oe);if(_o&&(zi=_o.placedGlyphBoxes,zi&&zi.box&&zi.box.length)){ft=!0,kt=_o.shift;break}}return zi};Dn(()=>Er(lr,qe.iconBox,a.aE.horizontal),()=>{const ur=qe.verticalTextBox;return ur&&Nn(ur),T.allowVerticalPlacement&&!(Nt&&Nt.box&&Nt.box.length)&&mt>0&&ur?Er(ur,qe.verticalIconBox,a.aE.vertical):{box:null,offscreen:null,occluded:null}}),Nt&&(ft=Nt.box,Je=Nt.offscreen,ct=Nt.occluded);const Pr=or(!(!Nt||!Nt.box));if(!ft&&this.prevPlacement){const ur=this.prevPlacement.variableOffsets[dt];ur&&(this.variableOffsets[dt]=ur,this.markUsedJustification(T,ur.anchor,Te,Pr))}}else{const gn=(Er,Pr)=>{const ur=T.getSymbolInstanceTextSize(ie,Te,this.transform.zoom,We),pt=this.collisionIndex.placeCollisionBox(T,ur,Er,new a.P(0,0),ge,Z,I,ae.predicate);return pt&&pt.box&&pt.box.length&&(this.markUsedOrientation(T,Pr,Te),this.placedOrientations[dt]=Pr),pt};Dn(()=>gn(lr,a.aE.horizontal),()=>{const Er=qe.verticalTextBox;return T.allowVerticalPlacement&&mt>0&&Er?(Nn(Er),gn(Er,a.aE.vertical)):{box:null,offscreen:null,occluded:null}}),or(!!(Nt&&Nt.box&&Nt.box.length))}}if(vt=Nt,ft=vt&&vt.box&&vt.box.length>0,Je=vt&&vt.offscreen,ct=vt&&vt.occluded,Te.useRuntimeCollisionCircles){const or=T.text.placedSymbolArray.get(Te.centerJustifiedTextSymbolIndex>=0?Te.centerJustifiedTextSymbolIndex:Te.verticalPlacedTextSymbolIndex),Dn=a.aF(T.textSizeData,ie,or),gn=P.get("text-padding");at=this.collisionIndex.placeCollisionCircles(T,ge,or,T.lineVertexArray,T.glyphOffsetArray,Dn,I,L,F,v,Ae,ae.predicate,Te.collisionCircleDiameter*Dn/a.bN,gn,this.retainedQueryData[T.bucketInstanceId].tileID),ft=ge||at.circles.length>0&&!at.collisionDetected,Je=Je&&at.offscreen,ct=at.occluded}if(qe.iconFeatureIndex&&(On=qe.iconFeatureIndex),qe.iconBox){const or=Dn=>{Nn(Dn);const gn=Te.hasIconTextFit&&kt?Of(kt.x,kt.y,Ce,Ae,this.transform.angle):new a.P(0,0),Er=T.getSymbolInstanceIconSize(oe,this.transform.zoom,Te.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,Er,Dn,gn,ye,Z,I,ae.predicate)};Dt&&Dt.box&&Dt.box.length&&qe.verticalIconBox?($t=or(qe.verticalIconBox),Be=$t.box.length>0):($t=or(qe.iconBox),Be=$t.box.length>0),Je=Je&&$t.offscreen,Ot=$t.occluded}const pn=se||Te.numHorizontalGlyphVertices===0&&mt===0,tr=me||Te.numIconVertices===0;if(pn||tr?tr?pn||(Be=Be&&ft):ft=Be&&ft:Be=ft=Be&&ft,ft&&vt&&vt.box&&this.collisionIndex.insertCollisionBox(vt.box,P.get("text-ignore-placement"),T.bucketInstanceId,Dt&&Dt.box&&mn?mn:vn,ae.ID),Be&&$t&&this.collisionIndex.insertCollisionBox($t.box,P.get("icon-ignore-placement"),T.bucketInstanceId,On,ae.ID),at&&(ft&&this.collisionIndex.insertCollisionCircles(at.circles,P.get("text-ignore-placement"),T.bucketInstanceId,vn,ae.ID),v)){const or=T.bucketInstanceId;let Dn=this.collisionCircleArrays[or];Dn===void 0&&(Dn=this.collisionCircleArrays[or]=new p1);for(let gn=0;gn<at.circles.length;gn+=4)Dn.circles.push(at.circles[gn+0]),Dn.circles.push(at.circles[gn+1]),Dn.circles.push(at.circles[gn+2]),Dn.circles.push(at.collisionDetected?1:0)}const br=T.projection.name!=="globe";xe=xe&&(br||!ct),Re=Re&&(br||!Ot),this.placements[dt]=new Cp(ft||xe,Be||Re,Je||T.justReloaded),d.add(dt)};if(_e&&this.buildingIndex&&(this.buildingIndex.updateZOffset(T,this.retainedQueryData[T.bucketInstanceId].tileID),T.updateZOffset()),pe){const Te=T.getSortedSymbolIndexes(this.transform.angle);for(let We=Te.length-1;We>=0;--We){const qe=Te[We];Ge(T.symbolInstances.get(qe),qe,T.collisionArrays[qe])}T.hasAnyZOffset&&a.w(`${T.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(T.hasAnyZOffset){const Te=T.getSortedIndexesByZOffset();for(let We=0;We<Te.length;++We){const qe=Te[We];Ge(T.symbolInstances.get(qe),qe,T.collisionArrays[qe])}}else for(let Te=l.symbolInstanceStart;Te<l.symbolInstanceEnd;Te++)Ge(T.symbolInstances.get(Te),Te,T.collisionArrays[Te]);if(v&&T.bucketInstanceId in this.collisionCircleArrays){const Te=this.collisionCircleArrays[T.bucketInstanceId];a.ad.invert(Te.invProjMatrix,I),Te.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(l,d,v,S){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:L,crossTileID:F}=v,V=a.cJ(d),Z=S===a.aE.vertical?L:V==="left"?T:V==="center"?P:V==="right"?I:-1;T>=0&&(l.text.placedSymbolArray.get(T).crossTileID=Z>=0&&T!==Z?0:F),P>=0&&(l.text.placedSymbolArray.get(P).crossTileID=Z>=0&&P!==Z?0:F),I>=0&&(l.text.placedSymbolArray.get(I).crossTileID=Z>=0&&I!==Z?0:F),L>=0&&(l.text.placedSymbolArray.get(L).crossTileID=Z>=0&&L!==Z?0:F)}markUsedOrientation(l,d,v){const S=d===a.aE.horizontal||d===a.aE.horizontalOnly?d:0,T=d===a.aE.vertical?d:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:F}=v,V=l.text.placedSymbolArray;P>=0&&(V.get(P).placedOrientation=S),I>=0&&(V.get(I).placedOrientation=S),L>=0&&(V.get(L).placedOrientation=S),F>=0&&(V.get(F).placedOrientation=T)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let v=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const S=d?d.symbolFadeChange(l):1,T=d?d.opacities:{},P=d?d.variableOffsets:{},I=d?d.placedOrientations:{};for(const L in this.placements){const F=this.placements[L],V=T[L];V?(this.opacities[L]=new yl(V,S,F.text,F.icon,null,F.clipped),v=v||F.text!==V.text.placed||F.icon!==V.icon.placed):(this.opacities[L]=new yl(null,S,F.text,F.icon,F.skipFade,F.clipped),v=v||F.text||F.icon)}for(const L in T){const F=T[L];if(!this.opacities[L]){const V=new yl(F,S,!1,!1);V.isHidden()||(this.opacities[L]=V,v=v||F.text.placed||F.icon.placed)}}for(const L in P)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=P[L]);for(const L in I)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=I[L]);v?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d,v,S){const T=new Set;for(const P of d){const I=P.getBucket(l);I&&P.latestFeatureIndex&&l.fqid===I.layerIds[0]&&(this.updateBucketOpacities(I,T,P.collisionBoxArray,v,S,P.tileID),I.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(I,P.tileID),I.updateZOffset()))}}updateBucketOpacities(l,d,v,S,T,P){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const I=l.layers[0].layout,L=!!l.layers[0].dynamicFilter(),F=new yl(null,0,!1,!1,!0),V=I.get("text-allow-overlap"),Z=I.get("icon-allow-overlap"),Q=I.get("text-variable-anchor"),J=I.get("text-rotation-alignment")==="map",ie=I.get("text-pitch-alignment")==="map",oe=new yl(null,0,V&&(Z||!l.hasIconData()||I.get("icon-optional")),Z&&(V||!l.hasTextData()||I.get("text-optional")),!0);!l.collisionArrays&&v&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(v);const ae=(me,ge,ye)=>{for(let Ce=0;Ce<ge/4;Ce++)me.opacityVertexArray.emplaceBack(ye)};let se=0;T&&l.updateReplacement(P,T);for(let me=0;me<l.symbolInstances.length;me++){const ge=l.symbolInstances.get(me),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:Ce,crossTileID:Ae,numIconVertices:pe,tileAnchorX:_e,tileAnchorY:xe}=ge,Re=d.has(Ae);let Ge=this.opacities[Ae];Re?Ge=F:Ge||(Ge=oe,this.opacities[Ae]=Ge),d.add(Ae);const Te=ye>0||Ce>0,We=pe>0,qe=this.placedOrientations[Ae],dt=qe===a.aE.vertical,mt=qe===a.aE.horizontal||qe===a.aE.horizontalOnly;!Te&&!We||Ge.isHidden()||se++;let ft=!1;if((Te||We)&&T)for(const Be of l.activeReplacements){if(Be.order<S||Be.order===1/0||!(Be.clipMask&a.cu.Symbol)||Be.min.x>_e||_e>Be.max.x||Be.min.y>xe||xe>Be.max.y)continue;const Je=a.cH(_e,xe,P.canonical,Be.footprintTileId.canonical);if(ft=a.cI(Je,Be),ft)break}if(Te){const Be=ft?_l:ns(Ge.text);ae(l.text,ye,dt?_l:Be),ae(l.text,Ce,mt?_l:Be);const Je=Ge.text.isHidden(),{leftJustifiedTextSymbolIndex:ct,centerJustifiedTextSymbolIndex:Ot,rightJustifiedTextSymbolIndex:kt,verticalPlacedTextSymbolIndex:Nt}=ge,Dt=l.text.placedSymbolArray,vt=Je||dt?1:0;ct>=0&&(Dt.get(ct).hidden=vt),Ot>=0&&(Dt.get(Ot).hidden=vt),kt>=0&&(Dt.get(kt).hidden=vt),Nt>=0&&(Dt.get(Nt).hidden=Je||mt?1:0);const at=this.variableOffsets[Ae];at&&this.markUsedJustification(l,at.anchor,ge,qe);const $t=this.placedOrientations[Ae];$t&&(this.markUsedJustification(l,"left",ge,$t),this.markUsedOrientation(l,$t,ge))}if(We){const Be=ft?_l:ns(Ge.icon),{placedIconSymbolIndex:Je,verticalPlacedIconSymbolIndex:ct}=ge,Ot=l.icon.placedSymbolArray,kt=Ge.icon.isHidden()?1:0;Je>=0&&(ae(l.icon,pe,dt?_l:Be),Ot.get(Je).hidden=kt),ct>=0&&(ae(l.icon,ge.numVerticalIconVertices,mt?_l:Be),Ot.get(ct).hidden=kt)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const Be=l.collisionArrays[me];if(Be){let Je=new a.P(0,0),ct=!0;if(Be.textBox||Be.verticalTextBox){if(Q){const kt=this.variableOffsets[Ae];kt?(Je=Jy(kt.anchor,kt.width,kt.height,kt.textOffset,kt.textScale),J&&Je._rotate(ie?this.transform.angle:-this.transform.angle)):ct=!1}L&&(ct=!Ge.clipped),Be.textBox&&Rf(l.textCollisionBox.collisionVertexArray,Ge.text.placed,!ct||dt,Je.x,Je.y),Be.verticalTextBox&&Rf(l.textCollisionBox.collisionVertexArray,Ge.text.placed,!ct||mt,Je.x,Je.y)}const Ot=ct&&!!(!mt&&Be.verticalIconBox);Be.iconBox&&Rf(l.iconCollisionBox.collisionVertexArray,Ge.icon.placed,Ot,ge.hasIconTextFit?Je.x:0,ge.hasIconTextFit?Je.y:0),Be.verticalIconBox&&Rf(l.iconCollisionBox.collisionVertexArray,Ge.icon.placed,!Ot,ge.hasIconTextFit?Je.x:0,ge.hasIconTextFit?Je.y:0)}}}if(l.fullyClipped=se===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=me.invProjMatrix,l.placementViewportMatrix=me.viewportMatrix,l.collisionCircleArray=me.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const v=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*v>l}setStale(){this.stale=!0}}function Rf(y,l,d,v,S){y.emplaceBack(l?1:0,d?1:0,v||0,S||0),y.emplaceBack(l?1:0,d?1:0,v||0,S||0),y.emplaceBack(l?1:0,d?1:0,v||0,S||0),y.emplaceBack(l?1:0,d?1:0,v||0,S||0)}const e_=Math.pow(2,25),Mt=Math.pow(2,24),m1=Math.pow(2,17),t_=Math.pow(2,16),n_=Math.pow(2,9),g1=Math.pow(2,8),Pp=Math.pow(2,1);function ns(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const l=y.placed?1:0,d=Math.floor(127*y.opacity);return d*e_+l*Mt+d*m1+l*t_+d*n_+l*g1+d*Pp+l}const _l=0;class su{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,d,v,S,T){const P=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(P,S,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((I,L)=>I.sortKey-L.sortKey));this._currentPartIndex<P.length;){const I=P[this._currentPartIndex];if(d.placeLayerBucketPart(I,this._seenCrossTileIDs,v,I.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class Mp{constructor(l,d,v,S,T,P,I,L,F){this.placement=new sa(l,T,P,I,L,F),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(l,d,v,S){const T=a.e.now(),P=()=>{const I=a.e.now()-T;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=d[l[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=L)&&(!I.maxzoom||I.maxzoom>L)){const F=I,V=F.layout.get("symbol-z-elevate"),Z=this._inProgressLayer=this._inProgressLayer||new su(F),Q=a.al(I.source,I.scope);if(Z.continuePlacement(V?S[Q]:v[Q],this.placement,this._showCollisionBoxes,I,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const vl=512/a.a3/2;class zA{constructor(l,d,v){this.tileID=l,this.bucketInstanceId=v,this.index=new a.cK(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=l.canonical.x*a.a3,T=l.canonical.y*a.a3;for(let P=0;P<d.length;P++){const{key:I,crossTileID:L,tileAnchorX:F,tileAnchorY:V}=d.get(P),Z=Math.floor((S+F)*vl),Q=Math.floor((T+V)*vl);this.index.add(Z,Q),this.keys.push(I),this.crossTileIDs.push(L)}this.index.finish()}findMatches(l,d,v){const S=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),T=vl/Math.pow(2,d.canonical.z-this.tileID.canonical.z),P=d.canonical.x*a.a3,I=d.canonical.y*a.a3;for(let L=0;L<l.length;L++){const F=l.get(L);if(F.crossTileID)continue;const{key:V,tileAnchorX:Z,tileAnchorY:Q}=F,J=Math.floor((P+Z)*T),ie=Math.floor((I+Q)*T),oe=this.index.range(J-S,ie-S,J+S,ie+S);for(const ae of oe){const se=this.crossTileIDs[ae];if(this.keys[ae]===V&&!v.has(se)){v.add(se),F.crossTileID=se;break}}}}}class FA{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class r_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(d!==0)for(const v in this.indexes){const S=this.indexes[v],T={};for(const P in S){const I=S[P];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+d),T[I.tileID.key]=I}this.indexes[v]=T}this.lng=l}addBucket(l,d,v){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let T=0;T<d.symbolInstances.length;T++)d.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const S=this.usedCrossTileIDs[l.overscaledZ];for(const T in this.indexes){const P=this.indexes[T];if(Number(T)>l.overscaledZ)for(const I in P){const L=P[I];L.tileID.isChildOf(l)&&L.findMatches(d.symbolInstances,l,S)}else{const I=P[l.scaledTo(Number(T)).key];I&&I.findMatches(d.symbolInstances,l,S)}}for(let T=0;T<d.symbolInstances.length;T++){const P=d.symbolInstances.get(T);P.crossTileID||(P.crossTileID=v.generate(),S.add(P.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new zA(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const v of d.crossTileIDs)this.usedCrossTileIDs[l].delete(v)}removeStaleBuckets(l){let d=!1;for(const v in this.indexes){const S=this.indexes[v];for(const T in S)l[S[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,S[T]),delete S[T],d=!0)}return d}}class NA{constructor(){this.layerIndexes={},this.crossTileIDs=new FA,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,v,S){let T=this.layerIndexes[l.fqid];T===void 0&&(T=this.layerIndexes[l.fqid]=new r_);let P=!1;const I={};S.name!=="globe"&&T.handleWrapJump(v);for(const L of d){const F=L.getBucket(l);F&&l.fqid===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(L.tileID,F,this.crossTileIDs)&&(P=!0),I[F.bucketInstanceId]=!0)}return T.removeStaleBuckets(I)&&(P=!0),P}pruneUnusedLayers(l){const d={};l.forEach(v=>{d[v]=!0});for(const v in this.layerIndexes)d[v]||delete this.layerIndexes[v]}}const y1=new a.N({data:new a.O(a.L.colorTheme.data)}),xl=(y,l)=>yn(y,l&&l.filter(d=>d.identifier!=="source.canvas")),i_=a.ah(Gn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),BA=a.ah(Gn,["setCenter","setZoom","setBearing","setPitch"]),_1={version:8,layers:[],sources:{}},v1={duration:300,delay:0};class Ca extends a.E{constructor(l,d={}){super(),this.map=l,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=a.W({},v1),this._buildingIndex=new kA(this),this.crossTileSymbolIndex=new NA,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new Ne,this.dispatcher=d.dispatcher?d.dispatcher:new a.bw(a.bx(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new na,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new a.cM(l._requestManager,d.localFontFamily?a.cN.all:d.localIdeographFontFamily?a.cN.ideographs:a.cN.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Za(l._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,colorTheme:null},this._styleColorThemeForScope={},this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",a.cO());const v=this;this._rtlTextPluginCallback=Ca.registerForPluginStateChange(S=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(T,P)=>{if(a.cP(T),P&&P.every(I=>I))for(const I in v._sourceCaches){const L=v._sourceCaches[I],F=L.getSource().type;F!=="vector"&&F!=="geojson"||L.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const T=this.getOwnSource(S.sourceId);if(T&&T.vectorLayerIds)for(const P in this._layers){const I=this._layers[P];I.source===T.id&&this._validateLayer(I)}})}load(l){return l?(typeof l=="string"?this.loadURL(l):this.loadJSON(l),this):this}_getGlobalId(l){if(!l)return null;if(typeof l=="string"){if(a.cQ(l))return l;const d=a.cR(l);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${a.cS(JSON.stringify(l))}`}_diffStyle(l,d,v){this.globalId=this._getGlobalId(l);const S=(T,P)=>{try{P(null,this.setState(T,v))}catch(I){P(I,!1)}};if(typeof l=="string"){const T=this.map._requestManager.normalizeStyleURL(l),P=this.map._requestManager.transformRequest(T,a.R.Style);a.g(P,(I,L)=>{I?this.fire(new a.d(I)):L&&S(L,d)})}else typeof l=="object"&&S(l,d)}loadURL(l,d={}){this.fire(new a.f("dataloading",{dataType:"style"}));const v=typeof d.validate=="boolean"?d.validate:!a.cQ(l);this.globalId=this._getGlobalId(l),l=this.map._requestManager.normalizeStyleURL(l,d.accessToken),this.resolvedImports.add(l);const S=this.importsCache.get(l);if(S)return this._load(S,v);const T=this.map._requestManager.transformRequest(l,a.R.Style);this._request=a.g(T,(P,I)=>{if(this._request=null,P)this.fire(new a.d(P));else if(I)return this.importsCache.set(l,I),this._load(I,v)})}loadJSON(l,d={}){this.fire(new a.f("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(l),this._request=a.e.frame(()=>{this._request=null,this._load(l,d.validate!==!1)})}loadEmpty(){this.fire(new a.f("dataloading",{dataType:"style"})),this._load(_1,!1)}_loadImports(l,d,v){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const T of l){const P=this._createFragmentStyle(T),I=new Promise(V=>{P.once("style.import.load",V),P.once("error",V)}).then(()=>this.mergeAll());if(S.push(I),this.resolvedImports.has(T.url)){P.loadEmpty();continue}const L=T.data||this.importsCache.get(T.url);L?(P.loadJSON(L,{validate:d}),this._isInternalStyle(L)&&(P.globalId=null)):T.url?P.loadURL(T.url,{validate:d}):P.loadEmpty();const F={style:P,id:T.id,config:T.config};if(v){const V=this.fragments.findIndex(({id:Z})=>Z===v);this.fragments=this.fragments.slice(0,V).concat(F).concat(this.fragments.slice(V))}else this.fragments.push(F)}return Promise.allSettled(S)}getImportGlobalIds(l=this,d=new Set){for(const v of l.fragments)v.style.globalId&&d.add(v.style.globalId),this.getImportGlobalIds(v.style,d);return[...d.values()]}_createFragmentStyle(l){const d=this.scope?a.al(l.id,this.scope):l.id;let v;const S=this._initialConfig&&this._initialConfig[d];(l.config||S)&&(v=a.W({},l.config,S));const T=new Ca(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:v,configOptions:this.options,configDependentLayers:this._configDependentLayers});return T.setEventedParent(this.map,{style:T}),T}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.isRootStyle()}_isInternalStyle(l){return this.isRootStyle()&&(l.fragment||!!l.schema&&l.fragment!==!1)}_load(l,d){const v=l.schema;if(this._isInternalStyle(l)){const P=a.W({},_1,{imports:[{id:"basemap",data:l,url:""}]});return void this._load(P,d)}if(this.updateConfig(this._config,v),d&&xl(this,Pe(l)))return;this._loaded=!0,this.stylesheet=a.cT(l);const S=()=>{for(const F in l.sources)this.addSource(F,l.sources[F],{validate:!1,isInitialLoad:!0});l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(l.glyphs,this.scope);const P=Ky(this.stylesheet.layers);if(this._order=P.map(F=>F.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const F=this.stylesheet.lights[0];this.light=new Vt(F.properties,F.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Vt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const F of P){const V=a.cY(F,this.scope,this._styleColorTheme.lut,this.options);V.isConfigDependent&&this._configDependentLayers.add(V.fqid),V.setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V,this._serializedLayers[V.id]=V.serialize();const Z=this.getOwnLayerSourceCache(V),Q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Z&&V.canCastShadows()&&Q&&(Z.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const I=this.stylesheet.terrain;I&&(this.checkCanvasFingerprintNoise(),this.terrainSetForDrapingOnly()||this._createTerrain(I,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.f("data",{dataType:"style"}));const L=this.isRootStyle();l.imports?this._loadImports(l.imports,d).then(()=>{this._reloadImports(),this.fire(new a.f(L?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.f(L?"style.load":"style.import.load")))},T=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=T,T){const P=this._evaluateColorThemeData(T);this._loadColorTheme(P).then(()=>{S()}).catch(I=>{a.w(`Couldn't load color theme from the stylesheet: ${I}`),S()})}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let l,d,v,S,T,P,I,L;const F={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(V=>{if(V.stylesheet){if(V.light!=null&&(l=V.light),V.stylesheet.lights)for(const Z of V.stylesheet.lights)Z.type==="ambient"&&V.ambientLight!=null&&(d=V.ambientLight),Z.type==="directional"&&V.directionalLight!=null&&(v=V.directionalLight);S=this._prioritizeTerrain(S,V.terrain,V.stylesheet.terrain),V.stylesheet.fog&&V.fog!=null&&(T=V.fog),V.stylesheet.camera!=null&&(L=V.stylesheet.camera),V.stylesheet.projection!=null&&(P=V.stylesheet.projection),V.stylesheet.transition!=null&&(I=V.stylesheet.transition),F[V.scope]=V._styleColorTheme}}),this.light=l,this.ambientLight=d,this.directionalLight=v,this.fog=T,this._styleColorThemeForScope=F,S===null?delete this.terrain:this.terrain=S,this.camera=L||{"camera-projection":"perspective"},this.projection=P||{name:"mercator"},this.transition=a.W({},v1,I),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(l){const d=v=>{for(const S of v.fragments)d(S.style);l(v)};d(this)}_prioritizeTerrain(l,d,v){const S=l&&l.drapeRenderMode===0;return v===null?d&&d.drapeRenderMode===0?d:S?l:null:d!=null&&(!l||S||d&&d.drapeRenderMode===1)?d:l}mergeTerrain(){let l;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{l=this._prioritizeTerrain(l,d.terrain,d.stylesheet.terrain)}),l===null?delete this.terrain:this.terrain=l}mergeProjection(){let l;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(l=d.stylesheet.projection)}),this.projection=l||{name:"mercator"}}mergeSources(){const l={},d={},v={};this.forEachFragmentStyle(S=>{for(const T in S._sourceCaches){const P=a.al(T,S.scope);l[P]=S._sourceCaches[T]}for(const T in S._otherSourceCaches){const P=a.al(T,S.scope);d[P]=S._otherSourceCaches[T]}for(const T in S._symbolSourceCaches){const P=a.al(T,S.scope);v[P]=S._symbolSourceCaches[T]}}),this._mergedSourceCaches=l,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=v}mergeLayers(){const l={},d=[],v={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(P=>{for(const I of P._order){const L=P._layers[I];if(L.type==="slot"){const F=a.cU(I);if(l[F])continue;l[F]=[]}L.slot&&l[L.slot]?l[L.slot].push(L):d.push(L)}}),this._mergedOrder=[],this._clipLayerIndices=[];let S=0;const T=(P=[])=>{for(const I of P)if(I.type==="slot"){const L=a.cU(I.id);l[L]&&T(l[L]),this._mergedSlots.push(L)}else{const L=a.al(I.id,I.scope);this._mergedOrder.push(L),v[L]=I,I.is3D()&&(this._has3DLayers=!0),I.type==="circle"&&(this._hasCircleLayers=!0),I.type==="symbol"&&(this._hasSymbolLayers=!0),I.type==="clip"&&this._clipLayerIndices.push(S),S++}};T(d),this._mergedLayers=v,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(l){return this.stylesheet.camera=a.W({},this.stylesheet.camera,l),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(l){return l.data?function(d,v,S){const T=a.W({},v);for(const I of Object.keys(a.L.colorTheme))T[I]===void 0&&(T[I]=a.L.colorTheme[I].default);const P=new a.U(y1,d,new Map(S));return P.setTransitionOrValue(T,S),P.untransitioned().possiblyEvaluate(new a.X(0))}(this.scope,l,this.options).get("data"):null}_loadColorTheme(l){return this._styleColorTheme.lutLoading=!0,new Promise((d,v)=>{const S="data:image/png;base64,";if(l.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void d();l.startsWith(S)||(l=S+l);const T="mapbox-reserved-lut",P=new Image;P.src=l,P.onerror=()=>{this._styleColorTheme.lutLoading=!1,v(new Error("Failed to load image data"))},P.onload=()=>{this._styleColorTheme.lutLoading=!1;const{width:I,height:L,data:F}=a.e.getImageData(P);if(L>32)return void v(new Error("The height of the image must be less than or equal to 32 pixels."));if(I!==L*L)return void v(new Error("The width of the image must be equal to the height squared."));this.getImage(T)&&this.removeImage(T),this.addImage(T,{data:new a.i({width:I,height:L},F),pixelRatio:1,sdf:!1,version:0});const V=this.imageManager.getImage(T,this.scope);V?(this._styleColorTheme.lut={image:V.data,data:l},d()):v(new Error("Missing LUT image."))}})}getLut(l){const d=this._styleColorThemeForScope[l];return d?d.lut:null}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(l){this._spriteRequest=function(d,v,S){let T,P,I;const L=a.e.devicePixelRatio>1?"@2x":"";let F=a.g(v.transformRequest(v.normalizeSpriteURL(d,L,".json"),a.R.SpriteJSON),(Q,J)=>{F=null,I||(I=Q,T=J,Z())}),V=a.h(v.transformRequest(v.normalizeSpriteURL(d,L,".png"),a.R.SpriteImage),(Q,J)=>{V=null,I||(I=Q,P=J,Z())});function Z(){if(I)S(I);else if(T&&P){const Q=a.e.getImageData(P),J={};for(const ie in T){const{width:oe,height:ae,x:se,y:me,sdf:ge,pixelRatio:ye,stretchX:Ce,stretchY:Ae,content:pe}=T[ie],_e=new a.i({width:oe,height:ae});a.i.copy(Q,_e,{x:se,y:me},{x:0,y:0},{width:oe,height:ae},null),J[ie]={data:_e,pixelRatio:ye,sdf:ge,stretchX:Ce,stretchY:Ae,content:pe}}S(null,J)}}return{cancel(){F&&(F.cancel(),F=null),V&&(V.cancel(),V=null)}}}(l,this.map._requestManager,(d,v)=>{if(this._spriteRequest=null,d)this.fire(new a.d(d));else if(v)for(const S in v)this.imageManager.addImage(S,this.scope,v[S]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.f("data",{dataType:"style"}))})}_validateLayer(l){const d=this.getOwnSource(l.source);if(!d)return;const v=l.sourceLayer;v&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(v)===-1)&&this.fire(new a.d(new Error(`Source layer "${v}" does not exist on source "${d.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:l}of this.fragments)if(!l.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((l,d)=>{const v=this.fragments[d];return v&&v.style&&(l.data=v.style.serialize()),l})}_serializeSources(){const l={};for(const d in this._sourceCaches){const v=this._sourceCaches[d].getSource();l[v.id]||(l[v.id]=v.serialize())}return l}_serializeLayers(l){const d=[];for(const v of l){const S=this._layers[v];S&&S.type!=="custom"&&d.push(S.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(l){return!!this.terrain&&l.isDraped(this.getLayerSourceCache(l))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(l){const d=this.getOwnLayer(l);if(d)return d;this.fire(new a.d(new Error(`The layer '${l}' does not exist in the map's style.`)))}_checkSource(l){const d=this.getOwnSource(l);if(d)return d;this.fire(new a.d(new Error(`The source '${l}' does not exist in the map's style.`)))}update(l){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l);const d=this.calculateLightsBrightness();l.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d));const v=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const P=this._changes.getLayerUpdatesByScope();for(const I in P){const{updatedIds:L,removedIds:F}=P[I];(L||F)&&(this._updateWorkerLayers(I,L,F),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(l),this.light&&this.light.updateTransitions(l),this.ambientLight&&this.ambientLight.updateTransitions(l),this.directionalLight&&this.directionalLight.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._changes.reset()}const T={};for(const P in this._mergedSourceCaches){const I=this._mergedSourceCaches[P];T[P]=I.used,I.used=!1,I.tileCoverLift=0}for(const P of this._mergedOrder){const I=this._mergedLayers[P];if(I.recalculate(l,this._availableImages),!I.isHidden(l.zoom)){const L=this.getLayerSourceCache(I);L&&(L.used=!0,L.tileCoverLift=Math.max(L.tileCoverLift,I.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let L=I.minzoom||0;L<(I.maxzoom||25.5);L++){const F=this.map.painter;if(F){const V=I.getProgramIds();if(!V)continue;for(const Z of V){const Q=I.getDefaultProgramParams(Z,l.zoom,this._styleColorTheme.lut);Q&&(F.style=this,this.fog&&(F._fogVisible=!0,Q.overrideFog=!0,F.getOrCreateProgram(Z,Q)),F._fogVisible=!1,Q.overrideFog=!1,F.getOrCreateProgram(Z,Q),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(Q.overrideRtt=!0,F.getOrCreateProgram(Z,Q)))}}}}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();for(const P in T){const I=this._mergedSourceCaches[P];T[P]!==I.used&&I.getSource().fire(new a.f("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),v&&this.fire(new a.f("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=this._changes.getUpdatedImages();if(l.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changes.resetUpdatedImages()}}_updateWorkerLayers(l,d,v){const S=this.getFragmentStyle(l);S&&this.dispatcher.broadcast("updateLayers",{layers:d?S._serializeLayers(d):[],scope:l,removedIds:v||[],options:S.options})}setState(l,d){if(this._checkLoaded(),xl(this,Pe(l)))return!1;(l=a.cT(l)).layers=Ky(l.layers);const v=function(P,I){if(!P)return[{command:Gn.setStyle,args:[I]}];let L=[];try{if(!b(P.version,I.version))return[{command:Gn.setStyle,args:[I]}];if(b(P.center,I.center)||L.push({command:Gn.setCenter,args:[I.center]}),b(P.zoom,I.zoom)||L.push({command:Gn.setZoom,args:[I.zoom]}),b(P.bearing,I.bearing)||L.push({command:Gn.setBearing,args:[I.bearing]}),b(P.pitch,I.pitch)||L.push({command:Gn.setPitch,args:[I.pitch]}),b(P.sprite,I.sprite)||L.push({command:Gn.setSprite,args:[I.sprite]}),b(P.glyphs,I.glyphs)||L.push({command:Gn.setGlyphs,args:[I.glyphs]}),b(P.imports,I.imports)||function(J=[],ie=[],oe){ie=ie||[];const ae=(J=J||[]).map(Ap),se=ie.map(Ap),me=J.reduce(Oc,{}),ge=ie.reduce(Oc,{}),ye=ae.slice();let Ce,Ae,pe,_e;for(Ce=0,Ae=0;Ce<ae.length;Ce++)pe=ae[Ce],ge.hasOwnProperty(pe)?Ae++:(oe.push({command:Gn.removeImport,args:[pe]}),ye.splice(ye.indexOf(pe,Ae),1));for(Ce=0,Ae=0;Ce<se.length;Ce++)pe=se[se.length-1-Ce],ye[ye.length-1-Ce]!==pe&&(me.hasOwnProperty(pe)?(oe.push({command:Gn.removeImport,args:[pe]}),ye.splice(ye.lastIndexOf(pe,ye.length-Ae),1)):Ae++,_e=ye[ye.length-Ce],oe.push({command:Gn.addImport,args:[ge[pe],_e]}),ye.splice(ye.length-Ce,0,pe));for(const xe of ie){const Re=me[xe.id];Re&&!b(Re,xe)&&oe.push({command:Gn.updateImport,args:[xe.id,xe]})}}(P.imports,I.imports,L),b(P.transition,I.transition)||L.push({command:Gn.setTransition,args:[I.transition]}),b(P.light,I.light)||L.push({command:Gn.setLight,args:[I.light]}),b(P.fog,I.fog)||L.push({command:Gn.setFog,args:[I.fog]}),b(P.projection,I.projection)||L.push({command:Gn.setProjection,args:[I.projection]}),b(P.lights,I.lights)||L.push({command:Gn.setLights,args:[I.lights]}),b(P.camera,I.camera)||L.push({command:Gn.setCamera,args:[I.camera]}),!b(P["color-theme"],I["color-theme"]))return[{command:Gn.setStyle,args:[I]}];const F={},V=[];(function(J,ie,oe,ae){let se;for(se in ie=ie||{},J=J||{})J.hasOwnProperty(se)&&(ie.hasOwnProperty(se)||h1(se,oe,ae));for(se in ie){if(!ie.hasOwnProperty(se))continue;const me=ie[se];J.hasOwnProperty(se)?b(J[se],me)||(J[se].type==="geojson"&&me.type==="geojson"&&LA(J,ie,se)?oe.push({command:Gn.setGeoJSONSourceData,args:[se,me.data]}):DA(se,ie,oe,ae)):Rs(se,ie,oe)}})(P.sources,I.sources,V,F);const Z=[];P.layers&&P.layers.forEach(J=>{J.source&&F[J.source]?L.push({command:Gn.removeLayer,args:[J.id]}):Z.push(J)});let Q=P.terrain;Q&&F[Q.source]&&(L.push({command:Gn.setTerrain,args:[void 0]}),Q=void 0),L=L.concat(V),b(Q,I.terrain)||L.push({command:Gn.setTerrain,args:[I.terrain]}),function(J,ie,oe){ie=ie||[];const ae=(J=J||[]).map(Ap),se=ie.map(Ap),me=J.reduce(Oc,{}),ge=ie.reduce(Oc,{}),ye=ae.slice(),Ce=Object.create(null);let Ae,pe,_e,xe,Re,Ge,Te;for(Ae=0,pe=0;Ae<ae.length;Ae++)_e=ae[Ae],ge.hasOwnProperty(_e)?pe++:(oe.push({command:Gn.removeLayer,args:[_e]}),ye.splice(ye.indexOf(_e,pe),1));for(Ae=0,pe=0;Ae<se.length;Ae++)_e=se[se.length-1-Ae],ye[ye.length-1-Ae]!==_e&&(me.hasOwnProperty(_e)?(oe.push({command:Gn.removeLayer,args:[_e]}),ye.splice(ye.lastIndexOf(_e,ye.length-pe),1)):pe++,Ge=ye[ye.length-Ae],oe.push({command:Gn.addLayer,args:[ge[_e],Ge]}),ye.splice(ye.length-Ae,0,_e),Ce[_e]=!0);for(Ae=0;Ae<se.length;Ae++)if(_e=se[Ae],xe=me[_e],Re=ge[_e],!Ce[_e]&&!b(xe,Re))if(b(xe.source,Re.source)&&b(xe["source-layer"],Re["source-layer"])&&b(xe.type,Re.type)){for(Te in Pf(xe.layout,Re.layout,oe,_e,null,Gn.setLayoutProperty),Pf(xe.paint,Re.paint,oe,_e,null,Gn.setPaintProperty),b(xe.slot,Re.slot)||oe.push({command:Gn.setSlot,args:[_e,Re.slot]}),b(xe.filter,Re.filter)||oe.push({command:Gn.setFilter,args:[_e,Re.filter]}),b(xe.minzoom,Re.minzoom)&&b(xe.maxzoom,Re.maxzoom)||oe.push({command:Gn.setLayerZoomRange,args:[_e,Re.minzoom,Re.maxzoom]}),xe)xe.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&Te!=="slot"&&(Te.indexOf("paint.")===0?Pf(xe[Te],Re[Te],oe,_e,Te.slice(6),Gn.setPaintProperty):b(xe[Te],Re[Te])||oe.push({command:Gn.setLayerProperty,args:[_e,Te,Re[Te]]}));for(Te in Re)Re.hasOwnProperty(Te)&&!xe.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&Te!=="slot"&&(Te.indexOf("paint.")===0?Pf(xe[Te],Re[Te],oe,_e,Te.slice(6),Gn.setPaintProperty):b(xe[Te],Re[Te])||oe.push({command:Gn.setLayerProperty,args:[_e,Te,Re[Te]]}))}else oe.push({command:Gn.removeLayer,args:[_e]}),Ge=ye[ye.lastIndexOf(_e)+1],oe.push({command:Gn.addLayer,args:[Re,Ge]})}(Z,I.layers,L)}catch(F){console.warn("Unable to compute style diff:",F),L=[{command:Gn.setStyle,args:[I]}]}return L}(this.serialize(),l).filter(P=>!(P.command in BA));if(v.length===0)return!1;const S=v.filter(P=>!(P.command in i_));if(S.length>0)throw new Error(`Unimplemented: ${S.map(P=>P.command).join(", ")}.`);const T=[];return v.forEach(P=>{T.push(this[P.command].apply(this,P.args))}),d&&Promise.all(T).then(d),this.stylesheet=l,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(l,d){return this.getImage(l)?this.fire(new a.d(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,this.scope,d),this._afterImageUpdated(l),this)}updateImage(l,d){this.imageManager.updateImage(l,this.scope,d)}getImage(l){return this.imageManager.getImage(l,this.scope)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l,this.scope),this._afterImageUpdated(l),this):this.fire(new a.d(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(l),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.f("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(l,d,v={}){return this._checkLoaded(),this._validate(Cn,`models.${l}`,d,null,v)||(this.modelManager.addModel(l,d,this.scope),this._changes.setDirty()),this}hasModel(l){return this.modelManager.hasModel(l,this.scope)}removeModel(l){return this.hasModel(l)?(this.modelManager.removeModel(l,this.scope),this):this.fire(new a.d(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(l,d,v={}){if(this._checkLoaded(),this.getOwnSource(l)!==void 0)throw new Error(`There is already a source with ID "${l}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(Me,`sources.${l}`,d,null,v))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const S=pp(l,d,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const T=P=>{const I=(P?"symbol:":"other:")+S.id,L=a.al(I,this.scope),F=this._sourceCaches[I]=new a.bv(L,S,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=F,F.onAdd(this.map)};T(!1),d.type!=="vector"&&d.type!=="geojson"||T(!0),S.onAdd&&S.onAdd(this.map),v.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(l){this._checkLoaded();const d=this.getOwnSource(l);if(!d)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===l)return this.fire(new a.d(new Error(`Source "${l}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===l)return this.fire(new a.d(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const v=this.getOwnSourceCaches(l);for(const S of v){const T=a.cU(S.id);delete this._sourceCaches[T],this._changes.discardSourceCacheUpdate(S.id),S.fire(new a.f("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(l,d){this._checkLoaded(),this.getOwnSource(l).setData(d),this._changes.setDirty()}getOwnSource(l){const d=this.getOwnSourceCache(l);return d&&d.getSource()}getOwnSources(){const l=[];for(const d in this._otherSourceCaches){const v=this.getOwnSourceCache(d);v&&l.push(v.getSource())}return l}areTilesLoaded(){const l=this._mergedSourceCaches;for(const d in l){const v=l[d]._tiles;for(const S in v){const T=v[S];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}setLights(l){if(this._checkLoaded(),!l)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const S of l){if(this._validate(Qe,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const T=this.ambientLight;T.set(S),T.updateTransitions(d)}else this.ambientLight=new of(S,Sn,this.scope,this.options);break;case"directional":if(this.directionalLight){const T=this.directionalLight;T.set(S),T.updateTransitions(d)}else this.directionalLight=new of(S,fy,this.scope,this.options)}}const v=new a.X(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(v),this.directionalLight&&this.directionalLight.recalculate(v),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const l=this.directionalLight,d=this.ambientLight;if(!l||!d)return;const v=Z=>.2126*(Z[0]<=.03928?Z[0]/12.92:Math.pow((Z[0]+.055)/1.055,2.4))+.7152*(Z[1]<=.03928?Z[1]/12.92:Math.pow((Z[1]+.055)/1.055,2.4))+.0722*(Z[2]<=.03928?Z[2]/12.92:Math.pow((Z[2]+.055)/1.055,2.4)),S=l.properties.get("color").toRenderColor(null).toArray01(),T=l.properties.get("intensity"),P=l.properties.get("direction"),I=1-a.ac(P.x,P.y,P.z)[2]/90,L=v(S)*T*I,F=d.properties.get("color").toRenderColor(null).toArray01(),V=d.properties.get("intensity");return(L+v(F)*V)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const l=[];return this.directionalLight&&l.push(this.directionalLight.get()),this.ambientLight&&l.push(this.ambientLight.get()),l}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(l){if(!l)return this;if(a.cV(l)){const d=a.cW(l),v=this.fragments.find(({id:T})=>T===d);if(!v)throw new Error(`Style import not found: ${l}`);const S=a.cU(l);return v.style.getFragmentStyle(S)}{const d=this.fragments.find(({id:v})=>v===l);if(!d)throw new Error(`Style import not found: ${l}`);return d.style}}getConfigProperty(l,d){const v=this.getFragmentStyle(l);if(!v)return null;const S=a.al(d,v.scope),T=v.options.get(S),P=T?T.value||T.default:null;return P?P.serialize():null}setConfigProperty(l,d,v){const S=this.getFragmentStyle(l);if(!S)return;const T=S.stylesheet.schema;if(!T||!T[d])return;const P=a.y(v);if(P.result!=="success")return void xl(this,P.value);const I=P.value.expression,L=a.al(d,S.scope),F=S.options.get(L);if(!F)return;let V;const{minValue:Z,maxValue:Q,stepValue:J,type:ie,values:oe}=T[d],ae=a.y(T[d].default);ae.result==="success"&&(V=ae.value.expression),V?(this.options.set(L,{...F,value:I,default:V,minValue:Z,maxValue:Q,stepValue:J,type:ie,values:oe}),this.updateConfigDependencies()):this.fire(new a.d(new Error(`No schema defined for the config option "${d}" in the "${l}" fragment.`)))}getConfig(l){const d=this.getFragmentStyle(l);if(!d)return null;const v=d.stylesheet.schema;if(!v)return null;const S={};for(const T in v){const P=a.al(T,d.scope),I=d.options.get(P),L=I?I.value||I.default:null;S[T]=L?L.serialize():null}return S}setConfig(l,d){const v=this.getFragmentStyle(l);v&&(v.updateConfig(d,v.stylesheet.schema),this.updateConfigDependencies())}getSchema(l){const d=this.getFragmentStyle(l);return d?d.stylesheet.schema:null}setSchema(l,d){const v=this.getFragmentStyle(l);v&&(v.stylesheet.schema=d,v.updateConfig(v._config,d),this.updateConfigDependencies())}updateConfig(l,d){if(this._config=l,l||d)if(d)for(const v in d){let S,T;const P=a.y(d[v].default);if(P.result==="success"&&(S=P.value.expression),l&&l[v]!==void 0){const Q=a.y(l[v]);Q.result==="success"&&(T=Q.value.expression)}const{minValue:I,maxValue:L,stepValue:F,type:V,values:Z}=d[v];if(S){const Q=a.al(v,this.scope);this.options.set(Q,{default:S,value:T,minValue:I,maxValue:L,stepValue:F,type:V,values:Z})}else this.fire(new a.d(new Error(`No schema defined for config option "${v}".`)))}else this.fire(new a.d(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const l of this._configDependentLayers){const d=this.getLayer(l);d&&(d.possiblyEvaluateVisibility(),this._updateLayer(d))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const d=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut||l._styleColorTheme.lut&&d!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(l,d,v={}){this._checkLoaded();const S=l.id;if(this._layers[S])return void this.fire(new a.d(new Error(`Layer with id "${S}" already exists on this map`)));let T;if(l.type==="custom"){if(xl(this,a.cX(l)))return;T=a.cY(l,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof l.source=="object"&&(this.addSource(S,l.source),l=a.cT(l),l=a.W(l,{source:S})),this._validate(Pt,`layers.${S}`,l,{arrayIndex:-1},v))return;T=a.cY(l,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(T),T.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[T.id]=T.serialize()}T.isConfigDependent&&this._configDependentLayers.add(T.fqid);let P=this._order.length;if(d){const V=this._order.indexOf(d);if(V===-1)return void this.fire(new a.d(new Error(`Layer with id "${d}" does not exist on this map.`)));T.slot===this._layers[d].slot?P=V:a.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,S),this._layerOrderChanged=!0,this._layers[S]=T;const I=this.getOwnLayerSourceCache(T),L=!!this.directionalLight&&this.directionalLight.shadowsEnabled();I&&T.canCastShadows()&&L&&(I.castsShadows=!0);const F=this._changes.getRemovedLayer(T);if(F&&T.source&&I&&T.type!=="custom"){this._changes.discardLayerRemoval(T);const V=a.al(T.source,T.scope);F.type!==T.type?this._changes.updateSourceCache(V,"clear"):(this._changes.updateSourceCache(V,"reload"),I.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),T.scope=this.scope,this.mergeLayers()}moveLayer(l,d){this._checkLoaded();const v=this._checkLayer(l);if(!v||l===d)return;const S=this._order.indexOf(l);this._order.splice(S,1);let T=this._order.length;if(d){const P=this._order.indexOf(d);if(P===-1)return void this.fire(new a.d(new Error(`Layer with id "${d}" does not exist on this map.`)));v.slot===this._layers[d].slot?T=P:a.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(T,0,l),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(l){this._checkLoaded();const d=this._checkLayer(l);if(!d)return;d.setEventedParent(null);const v=this._order.indexOf(l);this._order.splice(v,1),delete this._layers[l],delete this._serializedLayers[l],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const S=this.getOwnLayerSourceCache(d);if(S&&S.castsShadows){let T=!1;for(const P in this._layers)if(this._layers[P].source===d.source&&this._layers[P].canCastShadows()){T=!0;break}S.castsShadows=T}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(l){return this._layers[l]}hasLayer(l){return l in this._mergedLayers}hasLayerType(l){for(const d in this._layers)if(this._layers[d].type===l)return!0;return!1}setLayerZoomRange(l,d,v){this._checkLoaded();const S=this._checkLayer(l);S&&(S.minzoom===d&&S.maxzoom===v||(d!=null&&(S.minzoom=d),v!=null&&(S.maxzoom=v),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(l,d){this._checkLoaded();const v=this._checkLayer(l);v&&v.slot!==d&&(v.slot=d,this._updateLayer(v))}setFilter(l,d,v={}){this._checkLoaded();const S=this._checkLayer(l);if(S&&!b(S.filter,d))return d==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(St,`layers.${S.id}.filter`,d,{layerType:S.type},v)||(S.filter=a.cT(d),this._updateLayer(S)))}getFilter(l){const d=this._checkLayer(l);if(d)return a.cT(d.filter)}setLayoutProperty(l,d,v,S={}){this._checkLoaded();const T=this._checkLayer(l);if(T&&!b(T.getLayoutProperty(d),v)){if(v!=null&&(!S||S.validate!==!1)&&xl(T,ln.call(Pe,{key:`layers.${l}.layout.${d}`,layerType:T.type,objectKey:d,value:v,styleSpec:a.L,style:{glyphs:!0,sprite:!0}})))return;T.setLayoutProperty(d,v),T.isConfigDependent&&this._configDependentLayers.add(T.fqid),this._updateLayer(T)}}getLayoutProperty(l,d){const v=this._checkLayer(l);if(v)return v.getLayoutProperty(d)}setPaintProperty(l,d,v,S={}){this._checkLoaded();const T=this._checkLayer(l);if(!T||b(T.getPaintProperty(d),v)||v!=null&&(!S||S.validate!==!1)&&xl(T,Xt.call(Pe,{key:`layers.${l}.paint.${d}`,layerType:T.type,objectKey:d,value:v,styleSpec:a.L})))return;const P=T.setPaintProperty(d,v);T.isConfigDependent&&this._configDependentLayers.add(T.fqid),P&&this._updateLayer(T),this._changes.updatePaintProperties(T)}getPaintProperty(l,d){const v=this._checkLayer(l);if(v)return v.getPaintProperty(d)}setFeatureState(l,d){this._checkLoaded();const v=l.source,S=l.sourceLayer,T=this._checkSource(v);if(!T)return;const P=T.type;if(P==="geojson"&&S)return void this.fire(new a.d(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!S)return void this.fire(new a.d(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new a.d(new Error("The feature id parameter must be provided.")));const I=this.getOwnSourceCaches(v);for(const L of I)L.setFeatureState(S,l.id,d)}removeFeatureState(l,d){this._checkLoaded();const v=l.source,S=this._checkSource(v);if(!S)return;const T=S.type,P=T==="vector"?l.sourceLayer:void 0;if(T==="vector"&&!P)return void this.fire(new a.d(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new a.d(new Error("A feature id is required to remove its specific state property.")));const I=this.getOwnSourceCaches(v);for(const L of I)L.removeFeatureState(P,l.id,d)}getFeatureState(l){this._checkLoaded();const d=l.source,v=l.sourceLayer,S=this._checkSource(d);if(S){if(S.type!=="vector"||v)return l.id===void 0&&this.fire(new a.d(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(v,l.id);this.fire(new a.d(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(l){return this.stylesheet.transition=a.W({},this.stylesheet.transition,l),this.transition=this.stylesheet.transition,this}getTransition(){return a.W({},this.stylesheet.transition)}serialize(){this._checkLoaded();const l=this.getTerrain(),d=l&&this.terrain&&this.terrain.scope===this.scope?l:this.stylesheet.terrain;return a.cZ({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},v=>v!==void 0)}_updateLayer(l){this._changes.updateLayer(l);const d=this.getLayerSourceCache(l),v=a.al(l.source,l.scope),S=this._changes.getUpdatedSourceCaches();l.source&&!S[v]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(v,"reload"),d.pause()),l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const d=I=>this._mergedLayers[I].type==="fill-extrusion"||this._mergedLayers[I].type==="model",v=this.order,S={},T=[];for(let I=v.length-1;I>=0;I--){const L=v[I];if(d(L)){S[L]=I;for(const F of l){const V=F[L];if(V)for(const Z of V)T.push(Z)}}}T.sort((I,L)=>L.intersectionZ-I.intersectionZ);const P=[];for(let I=v.length-1;I>=0;I--){const L=v[I];if(d(L))for(let F=T.length-1;F>=0;F--){const V=T[F].feature;if(V.layer&&S[V.layer.id]<I)break;P.push(V),T.pop()}else for(const F of l){const V=F[L];if(V)for(const Z of V)P.push(Z.feature)}}return P}queryRenderedFeatures(l,d,v){d&&d.filter&&this._validate(St,"queryRenderedFeatures.filter",d.filter,null,d),d.scope=this.scope,d.availableImages=this._availableImages,d.serializedLayers=this._serializedLayers;const S={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new a.d(new Error("parameters.layers must be an Array."))),[];for(const F of d.layers){const V=this._mergedLayers[F];if(!V)return this.fire(new a.d(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];S[V.source]=!0}}const T=[],P=d.serializedLayers||{},I=d&&d.layers?d.layers.some(F=>{const V=this.getLayer(F);return V&&V.is3D()}):this.has3DLayers(),L=oo.createFromScreenPoints(l,v);for(const F in this._mergedSourceCaches){const V=this._mergedSourceCaches[F].getSource();if(!V||V.scope!==d.scope)continue;const Z=this._mergedSourceCaches[F].getSource().id;d.layers&&!S[Z]||T.push(RA(this._mergedSourceCaches[F],this._mergedLayers,P,L,d,v,I,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(F,V,Z,Q,J,ie,oe){const ae={},se=ie.queryRenderedSymbols(Q),me=[];for(const ge of Object.keys(se).map(Number))me.push(oe[ge]);me.sort(Mc);for(const ge of me){const ye=ge.featureIndex.lookupSymbolFeatures(se[ge.bucketInstanceId],V,ge.bucketIndex,ge.sourceLayerIndex,J.filter,J.layers,J.availableImages,F);for(const Ce in ye){const Ae=ae[Ce]=ae[Ce]||[],pe=ye[Ce];pe.sort((_e,xe)=>{const Re=ge.featureSortOrder;if(Re){const Ge=Re.indexOf(_e.featureIndex);return Re.indexOf(xe.featureIndex)-Ge}return xe.featureIndex-_e.featureIndex});for(const _e of pe)Ae.push(_e)}}for(const ge in ae)ae[ge].forEach(ye=>{const Ce=ye.feature,Ae=Z(F[ge]);if(!Ae)return;const pe=Ae.getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=pe});return ae}(this._mergedLayers,P,this.getLayerSourceCache.bind(this),L.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(l,d){d&&d.filter&&this._validate(St,"querySourceFeatures.filter",d.filter,null,d);const v=this.getOwnSourceCaches(l);let S=[];for(const T of v)S=S.concat(Cf(T,d));return S}addSourceType(l,d,v){return Ca.getSourceType(l)?v(new Error(`A source type called "${l}" already exists.`)):(Ca.setSourceType(l,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:d.workerSourceURL},v):v(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(l,d,v={}){this._checkLoaded();const S=this.light.getLight();let T=!1;for(const I in l)if(!b(l[I],S[I])){T=!0;break}if(!T)return;const P=this._getTransitionParameters();this.light.setLight(l,d,v),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(l,d=1){if(this._checkLoaded(),!l)return this.terrainSetForDrapingOnly()&&d!==0||delete this.terrain,l===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let v=l;const S=l.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof v.source=="object"){const I="terrain-dem-src";this.addSource(I,v.source),v=a.cT(v),v=a.W(v,{source:I})}const T=a.W({},v),P={};if(this.terrain&&S){T.source=this.terrain.get().source;const I=this.terrain?this.getFragmentStyle(this.terrain.scope):null;I&&(P.style=I.serialize())}if(this._validate(ze,"terrain",T,P))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&d!==this.terrain.drapeRenderMode){if(!v)return;this._createTerrain(v,d),this.fire(new a.f("data",{dataType:"style"}))}else{const T=this.terrain,P=T.get();for(const I of Object.keys(a.L.terrain))!v.hasOwnProperty(I)&&a.L.terrain[I].default&&(v[I]=a.L.terrain[I].default);for(const I in l)if(!b(l[I],P[I])){T.set(l,this.options),this.stylesheet.terrain=l;const L=this._getTransitionParameters({duration:0});T.updateTransitions(L),this.fire(new a.f("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const d=this.fog=new Ux(l,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!b(d.get(),l)){d.set(l,this.options),this.stylesheet.fog=d.get();const v=this._getTransitionParameters({duration:0});d.updateTransitions(v)}}else this._createFog(l);this._markersNeedUpdate=!0}setColorTheme(l){this._checkLoaded();const d=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()};if(this._styleColorTheme.colorTheme=l,!l)return this._styleColorTheme.lut=null,void d();const v=this._evaluateColorThemeData(l);this._loadColorTheme(v).then(()=>{d()}).catch(S=>{a.w(`Couldn't set color theme: ${S}`)})}_getTransitionParameters(l){return{now:a.e.now(),transition:a.W(this.transition,l)}}updateDrapeFirstLayers(){if(!this.terrain)return;const l=[],d=[];for(const v in this._mergedLayers)this.isLayerDraped(this._mergedLayers[v])?l.push(v):d.push(v);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...d)}_createTerrain(l,d){const v=this.terrain=new sr(l,d,this.scope,this.options);d===1&&(this.stylesheet.terrain=l),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});v.updateTransitions(S)}_force3DLayerUpdate(){for(const l in this._layers){const d=this._layers[l];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const d=this._layers[l];d.type==="symbol"&&this._updateLayer(d)}}_validate(l,d,v,S,T={}){if(T&&T.validate===!1)return!1;const P=a.W({},this.serialize());return xl(this,l.call(Pe,a.W({key:d,style:P,value:v,styleSpec:a.L},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.c_.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._mergedLayers)this._mergedLayers[l].setEventedParent(null);for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles(),this._mergedSourceCaches[l].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(l){const d=this.getSourceCaches(l);for(const v of d)v.clearTiles()}clearSources(){for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles()}reloadSource(l){const d=this.getSourceCaches(l);for(const v of d)v.resume(),v.reload()}reloadSources(){for(const l of this.getSources())l.reload&&l.reload()}updateSources(l){let d;this.directionalLight&&(d=hf(this.directionalLight));for(const v in this._mergedSourceCaches)this._mergedSourceCaches[v].update(l,void 0,void 0,d)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const d=this._sourceCaches[l];d.resume(),d.reload()}}_updatePlacement(l,d,v,S,T,P,I=!1){let L=!1,F=!1;const V={},Z={};for(const J of this._mergedOrder){const ie=this._mergedLayers[J];if(ie.type!=="symbol")continue;const oe=a.al(ie.source,ie.scope);let ae=V[oe];if(!ae){const me=this.getLayerSourceCache(ie);if(!me)continue;const ge=me.getRenderableIds(!0).map(ye=>me.getTileByID(ye));Z[oe]=ge.slice(),ae=V[oe]=ge.sort((ye,Ce)=>Ce.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(Ce.tileID)?-1:1))}const se=this.crossTileSymbolIndex.addLayer(ie,ae,d.center.lng,d.projection);L=L||se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),I=I||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new a.f("neworder")),(I||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.e.now(),d.zoom))&&(this.pauseablePlacement=new Mp(d,this._mergedOrder,I,v,S,T,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,V,Z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.e.now()),F=!0),L&&this.pauseablePlacement.placement.setStale()),F||L){this._buildingIndex.onNewFrame(d.zoom);for(let J=0;J<this._mergedOrder.length;J++){const ie=this._mergedLayers[this._mergedOrder[J]];if(ie.type!=="symbol")continue;const oe=this.isLayerClipped(ie)&&this._clipLayerIndices.some(ae=>J<ae);this.placement.updateLayerOpacities(ie,V[a.al(ie.source,ie.scope)],J,oe?P:null)}}let Q=!1;for(const J of this._mergedOrder){const ie=this._mergedLayers[J];if(ie.type!=="symbol")continue;const oe=V[a.al(ie.source,ie.scope)];for(const ae of oe){const se=ae.getBucket(ie);se&&ae.latestFeatureIndex&&ie.fqid===se.layerIds[0]&&(Q=se.updateOcclusionOpacities(l.context,l.symbolParams,l._dt)||Q)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.e.now())||Q,occlusionQueryBasedOpacityChanged:Q}}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}addImport(l,d){this._checkLoaded();const v=this.stylesheet.imports=this.stylesheet.imports||[];if(v.findIndex(({id:T})=>T===l.id)!==-1)return void this.fire(new a.d(new Error(`Import with id '${l.id}' already exists in the map's style.`)));if(!d)return v.push(l),this._loadImports([l],!0);const S=v.findIndex(({id:T})=>T===d);return S===-1&&this.fire(new a.d(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=v.slice(0,S).concat(l).concat(v.slice(S)),this._loadImports([l],!0,d)}updateImport(l,d){this._checkLoaded();const v=this.stylesheet.imports||[],S=this.getImportIndex(l);return S===-1?this:typeof d=="string"?(this.setImportUrl(l,d),this):(d.url&&d.url!==v[S].url&&this.setImportUrl(l,d.url),b(d.config,v[S].config)||this.setImportConfig(l,d.config),b(d.data,v[S].data)||this.setImportData(l,d.data),this)}moveImport(l,d){this._checkLoaded();let v=this.stylesheet.imports||[];const S=this.getImportIndex(l);if(S===-1)return this;const T=this.getImportIndex(d);if(T===-1)return this;const P=v[S],I=this.fragments[S];return v=v.filter(({id:L})=>L!==l),this.fragments=this.fragments.filter(({id:L})=>L!==l),this.stylesheet.imports=v.slice(0,T).concat(P).concat(v.slice(T)),this.fragments=this.fragments.slice(0,T).concat(I).concat(this.fragments.slice(T)),this.mergeLayers(),this}setImportUrl(l,d){this._checkLoaded();const v=this.stylesheet.imports||[],S=this.getImportIndex(l);if(S===-1)return this;v[S].url=d;const T=this.fragments[S];return T.style=this._createFragmentStyle(v[S]),T.style.on("style.import.load",()=>this.mergeAll()),T.style.loadURL(d),this}setImportData(l,d){this._checkLoaded();const v=this.getImportIndex(l),S=this.stylesheet.imports||[];return v===-1?this:d?(this.fragments[v].style.setState(d),this._reloadImports(),this):(delete S[v].data,this.setImportUrl(l,S[v].url))}setImportConfig(l,d){this._checkLoaded();const v=this.getImportIndex(l),S=this.stylesheet.imports||[];if(v===-1)return this;d?S[v].config=d:delete S[v].config;const T=this.fragments[v],P=T.style.stylesheet&&T.style.stylesheet.schema;return T.config=d,T.style.updateConfig(d,P),this.updateConfigDependencies(),this}removeImport(l){this._checkLoaded();const d=this.stylesheet.imports||[],v=this.getImportIndex(l);v!==-1&&(d.splice(v,1),this.fragments[v].style._remove(),this.fragments.splice(v,1),this._reloadImports())}getImportIndex(l){const d=(this.stylesheet.imports||[]).findIndex(v=>v.id===l);return d===-1&&this.fire(new a.d(new Error(`Import '${l}' does not exist in the map's style and cannot be updated.`))),d}getLayer(l){return this._mergedLayers[l]}getSources(){const l=[];for(const d in this._mergedOtherSourceCaches){const v=this._mergedOtherSourceCaches[d];v&&l.push(v.getSource())}return l}getSource(l,d){const v=this.getSourceCache(l,d);return v&&v.getSource()}getLayerSource(l){const d=this.getLayerSourceCache(l);return d&&d.getSource()}getSourceCache(l,d){const v=a.al(l,d);return this._mergedOtherSourceCaches[v]}getLayerSourceCache(l){const d=a.al(l.source,l.scope);return l.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(l){if(l==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[l]&&d.push(this._mergedOtherSourceCaches[l]),this._mergedSymbolSourceCaches[l]&&d.push(this._mergedSymbolSourceCaches[l]),d}updateSourceCaches(){const l=this._changes.getUpdatedSourceCaches();for(const d in l){const v=l[d];v==="reload"?this.reloadSource(d):v==="clear"&&this.clearSource(d)}}updateLayers(l){const d=this._changes.getUpdatedPaintProperties();for(const v of d){const S=this.getLayer(v);S&&S.updateTransitions(l)}}getImages(l,d,v){this.imageManager.getImages(d.icons,d.scope,v),this._updateTilesForChangedImages();const S=T=>{T&&T.setDependencies(d.tileID.key,d.type,d.icons)};S(this._otherSourceCaches[d.source]),S(this._symbolSourceCaches[d.source])}getGlyphs(l,d,v){this.glyphManager.getGlyphs(d.stacks,d.scope,v)}getResource(l,d,v){return a.c$(d,v)}getOwnSourceCache(l){return this._otherSourceCaches[l]}getOwnLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}getOwnSourceCaches(l){const d=[];return this._otherSourceCaches[l]&&d.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&d.push(this._symbolSourceCaches[l]),d}_isSourceCacheLoaded(l){const d=this.getOwnSourceCaches(l);return d.length===0?(this.fire(new a.d(new Error(`There is no source with ID '${l}'`))),!1):d.every(v=>v.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(l,d){if(this._clipLayerIndices.length===0&&l.type!=="fill-extrusion")return!1;const v=l.type==="fill-extrusion"&&l.sourceLayer==="building";let S=0;if(l.is3D()){if(v||d&&d.type==="batched-model")return!0;l.type==="model"&&(S=a.cu.Model)}else l.type==="symbol"&&(S=a.cu.Symbol);for(const T of this._clipLayerIndices){const P=this._mergedLayers[this._mergedOrder[T]];if(!P)continue;const I=[];for(const L of P.layout.get("clip-layer-types"))I.push(L==="model"?a.cu.Model:L==="symbol"?a.cu.Symbol:a.cu.FillExtrusion);for(const L of I)if(S&L)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(l=>{l.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function o_(y,l){let d=!1,v=null;const S=()=>{v=null,d&&(y(),v=setTimeout(S,l),d=!1)};return()=>(d=!0,v||S(),v)}Ca.getSourceType=function(y){return Di[y]},Ca.setSourceType=function(y,l){Di[y]=l},Ca.registerForPluginStateChange=a.cL;class jA{constructor(l){this._hashName=l&&encodeURIComponent(l),a.bp(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=o_(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const d=kf(l);if(this._hashName){const v=this._hashName;let S=!1;const T=location.hash.slice(1).split("&").map(P=>{const I=P.split("=")[0];return I===v?(S=!0,`${I}=${d}`):P}).filter(P=>P);return S||T.push(`${v}=${d}`),`#${T.join("&")}`}return`#${d}`}_getCurrentHash(){const l=location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(d=v)}),(d&&d[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(v=>isNaN(v))){const v=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(d[3]||0):l.getBearing();return l.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:v,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function kf(y,l){const d=y.getCenter(),v=Math.round(100*y.getZoom())/100,S=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,S),P=Math.round(d.lng*T)/T,I=Math.round(d.lat*T)/T,L=y.getBearing(),F=y.getPitch();let V=l?`/${P}/${I}/${v}`:`${v}/${I}/${P}`;return(L||F)&&(V+="/"+Math.round(10*L)/10),F&&(V+=`/${Math.round(F)}`),V}const Ip={linearity:.3,easing:a.d0(0,0,.3,1)},x1=a.W({deceleration:2500,maxSpeed:1400},Ip),a_=a.W({deceleration:20,maxSpeed:1400},Ip),Op=a.W({deceleration:1e3,maxSpeed:360},Ip),s_=a.W({deceleration:1e3,maxSpeed:90},Ip);class lu{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.e.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=a.e.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)d.zoom+=T.zoomDelta||0,d.bearing+=T.bearingDelta||0,d.pitch+=T.pitchDelta||0,T.panDelta&&d.pan._add(T.panDelta),T.around&&(d.around=T.around),T.pinchAround&&(d.pinchAround=T.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(d.pan.mag()){const T=Df(d.pan.mag(),v,a.W({},x1,l||{}));S.offset=d.pan.mult(T.amount/d.pan.mag()),S.center=this._map.transform.center,Rc(S,T)}if(d.zoom){const T=Df(d.zoom,v,a_);S.zoom=this._map.transform.zoom+T.amount,Rc(S,T)}if(d.bearing){const T=Df(d.bearing,v,Op);S.bearing=this._map.transform.bearing+a.at(T.amount,-179,179),Rc(S,T)}if(d.pitch){const T=Df(d.pitch,v,s_);S.pitch=this._map.transform.pitch+T.amount,Rc(S,T)}if(S.zoom||S.bearing){const T=d.pinchAround===void 0?d.around:d.pinchAround;S.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Rc(y,l){(!y.duration||y.duration<l.duration)&&(y.duration=l.duration,y.easing=l.easing)}function Df(y,l,d){const{maxSpeed:v,linearity:S,deceleration:T}=d,P=a.at(y*S/(l/1e3),-v,v),I=Math.abs(P)/(T*S);return{easing:d.easing,duration:1e3*I,amount:P*(I/2)}}class Li extends a.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,v,S={}){const T=ee(d.getCanvasContainer(),v),P=d.unproject(T);super(l,a.W({point:T,lngLat:P,originalEvent:v},S)),this._defaultPrevented=!1,this.target=d}}class bl extends a.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,v){const S=l==="touchend"?v.changedTouches:v.touches,T=ue(d.getCanvasContainer(),S),P=T.map(L=>d.unproject(L)),I=T.reduce((L,F,V,Z)=>L.add(F.div(Z.length)),new a.P(0,0));super(l,{points:T,point:I,lngLats:P,lngLat:d.unproject(I),originalEvent:v}),this._defaultPrevented=!1}}class Rp extends a.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,v){super(l,{originalEvent:v}),this._defaultPrevented=!1}}class l_{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new Rp(l.type,this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new Li(l.type,this._map,l))}mouseup(l){this._map.fire(new Li(l.type,this._map,l))}preclick(l){const d=a.W({},l);d.type="preclick",this._map.fire(new Li(d.type,this._map,d))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(l),this._map.fire(new Li(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new Li(l.type,this._map,l))}mouseover(l){this._map.fire(new Li(l.type,this._map,l))}mouseout(l){this._map.fire(new Li(l.type,this._map,l))}touchstart(l){return this._firePreventable(new bl(l.type,this._map,l))}touchmove(l){this._map.fire(new bl(l.type,this._map,l))}touchend(l){this._map.fire(new bl(l.type,this._map,l))}touchcancel(l){this._map.fire(new bl(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Lf{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new Li(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Li("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new Li(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kp{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&l.button===0&&(G(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const v=d,S=this._startPos,T=this._lastPos;if(!S||!T||T.equals(v)||!this._box&&v.dist(S)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=k("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const P=Math.min(S.x,v.x),I=Math.max(S.x,v.x),L=Math.min(S.y,v.y),F=Math.max(S.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${L}px)`,this._box.style.width=I-P+"px",this._box.style.height=F-L+"px")})}mouseupWindow(l,d){if(!this._active)return;const v=this._startPos,S=d;if(v&&l.button===0){if(this.reset(),K(),v.x!==S.x||v.y!==S.y)return this._map.fire(new a.f("boxzoomend",{originalEvent:l})),{cameraAnimation:T=>T.fitScreenCoordinates(v,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),H(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new a.f(l,{originalEvent:d}))}}function zf(y,l){const d={};for(let v=0;v<y.length;v++)d[y[v].identifier]=l[v];return d}class b1{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,d,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),v.length===this.numTouches&&(this.centroid=function(S){const T=new a.P(0,0);for(const P of S)T._add(P);return T.div(S.length)}(d),this.touches=zf(v,d)))}touchmove(l,d,v){if(this.aborted||!this.centroid)return;const S=zf(v,d);for(const T in this.touches){const P=S[T];(!P||P.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(l,d,v){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Ff{constructor(l){this.singleTap=new b1(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,d,v){this.singleTap.touchstart(l,d,v)}touchmove(l,d,v){this.singleTap.touchmove(l,d,v)}touchend(l,d,v){const S=this.singleTap.touchend(l,d,v);if(S){const T=l.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(S)<30;if(T&&P||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class Dp{constructor(){this._zoomIn=new Ff({numTouches:1,numTaps:2}),this._zoomOut=new Ff({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,v){this._zoomIn.touchstart(l,d,v),this._zoomOut.touchstart(l,d,v)}touchmove(l,d,v){this._zoomIn.touchmove(l,d,v),this._zoomOut.touchmove(l,d,v)}touchend(l,d,v){const S=this._zoomIn.touchend(l,d,v),T=this._zoomOut.touchend(l,d,v);return S?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(S)},{originalEvent:l})}):T?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(T)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Nf={0:1,2:2};class Lp{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,d){return!1}_move(l,d){return{}}mousedown(l,d){if(this._lastPoint)return;const v=ve(l);this._correctButton(l,v)&&(this._lastPoint=d,this._eventButton=v)}mousemoveWindow(l,d){const v=this._lastPoint;if(v){if(l.preventDefault(),this._eventButton!=null&&function(S,T){const P=Nf[T];return S.buttons===void 0||(S.buttons&P)!==P}(l,this._eventButton))this.reset();else if(this._moved||!(d.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(v,d)}}mouseupWindow(l){this._lastPoint&&ve(l)===this._eventButton&&(this._moved&&K(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class w1 extends Lp{mousedown(l,d){super.mousedown(l,d),this._lastPoint&&(this._active=!0)}_correctButton(l,d){return d===0&&!l.ctrlKey}_move(l,d){return{around:d,panDelta:d.sub(l)}}}class u_ extends Lp{_correctButton(l,d){return d===0&&l.ctrlKey||d===2}_move(l,d){const v=.8*(d.x-l.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(l){l.preventDefault()}}class uu extends Lp{_correctButton(l,d){return d===0&&l.ctrlKey||d===2}_move(l,d){const v=-.5*(d.y-l.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(l){l.preventDefault()}}class S1{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),a.bp(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(l,d,v){return this._calculateTransform(l,d,v)}touchmove(l,d,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(v.length===1&&!a.d1())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,d,v)}}touchend(l,d,v){this._calculateTransform(l,d,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,v){v.length>0&&(this._active=!0);const S=zf(v,d),T=new a.P(0,0),P=new a.P(0,0);let I=0;for(const F in S){const V=S[F],Z=this._touches[F];Z&&(T._add(V),P._add(V.sub(Z)),I++,S[F]=V)}if(this._touches=S,I<this._minTouches||!P.mag())return;const L=P.div(I);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(I),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=k("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class c_{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,d,v){return{}}touchstart(l,d,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,v){const S=this._firstTwoTouches;if(!S)return;l.preventDefault();const[T,P]=S,I=zp(v,d,T),L=zp(v,d,P);if(!I||!L)return;const F=this._aroundCenter?null:I.add(L).div(2);return this._move([I,L],F,l)}touchend(l,d,v){if(!this._firstTwoTouches)return;const[S,T]=this._firstTwoTouches,P=zp(v,d,S),I=zp(v,d,T);P&&I||(this._active&&K(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function zp(y,l,d){for(let v=0;v<y.length;v++)if(y[v].identifier===d)return l[v]}function T1(y,l){return Math.log(y/l)/Math.LN2}class h_ extends c_{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const v=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(T1(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:T1(this._distance,v),pinchAround:d}}}function Fp(y,l){return 180*y.angleWith(l)/Math.PI}class f_ extends c_{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d){const v=this._vector;if(this._vector=l[0].sub(l[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Fp(this._vector,v),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const S=Fp(l,v);return Math.abs(S)<d}}function Bf(y){return Math.abs(y.y)>Math.abs(y.x)}class E1 extends c_{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,Bf(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,v){const S=this._lastPoints;if(!S)return;const T=l[0].sub(S[0]),P=l[1].sub(S[1]);return this._map._cooperativeGestures&&!a.d1()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(T,P,v.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(T.y+P.y)/2*-.5})}gestureBeginsVertically(l,d,v){if(this._valid!==void 0)return this._valid;const S=l.mag()>=2,T=d.mag()>=2;if(!S&&!T)return;if(!S||!T)return this._firstMove==null&&(this._firstMove=v),v-this._firstMove<100&&void 0;const P=l.y>0==d.y>0;return Bf(l)&&Bf(d)&&P}}const A1={panStep:100,bearingStep:15,pitchStep:10};class $A{constructor(){const l=A1;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,v=0,S=0,T=0,P=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?v=-1:(l.preventDefault(),T=-1);break;case 39:l.shiftKey?v=1:(l.preventDefault(),T=1);break;case 38:l.shiftKey?S=1:(l.preventDefault(),P=-1);break;case 40:l.shiftKey?S=-1:(l.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(v=0,S=0),{cameraAnimation:I=>{const L=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:jf,zoom:d?Math.round(L)+d*(l.shiftKey?2:1):L,bearing:I.getBearing()+v*this._bearingStep,pitch:I.getPitch()+S*this._pitchStep,offset:[-T*this._panStep,-P*this._panStep],center:I.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function jf(y){return y*(2-y)}const kc=4.000244140625,C1=1/450;class $o{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=C1,a.bp(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||a.d1()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const v=a.e.now(),S=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,d!==0&&d%kc==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(S*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=ee(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>kc?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&V!==0&&(V=1/V);const Z=d(),Q=Math.pow(2,Z),J=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(J*V))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const v=typeof this._targetZoom=="number"?this._targetZoom:d(),S=this._startZoom,T=this._easing;let P,I=!1;if(this._type==="wheel"&&S&&T){const F=Math.min((a.e.now()-this._lastWheelEventTime)/200,1),V=T(F);P=a.a2(S,v,V),F<1?this._frameId||(this._frameId=!0):I=!0}else P=v,I=!0;this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let L=P-d();return L*this._lastDelta<0&&(L=0),{noInertia:!0,needsRenderFrame:!I,zoomDelta:L,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=a.d2;if(this._prevEase){const v=this._prevEase,S=(a.e.now()-v.start)/v.duration,T=v.easing(S+.01)-v.easing(S),P=.27/Math.sqrt(T*T+1e-4)*.01,I=Math.sqrt(.0729-P*P);d=a.d0(P,I,.25,1)}return this._prevEase={start:a.e.now(),duration:l,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=k("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class d_{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Np{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,d){return l.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(l.shiftKey?-1:1),around:v.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bp{constructor(){this._tap=new Ff({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,d,v){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=d[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(l,d,v))}touchmove(l,d,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const S=d[0],T=S.y-this._swipePoint.y;return this._swipePoint=S,l.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(l,d,v)}touchend(l,d,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(l,d,v)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class p_{constructor(l,d,v){this._el=l,this._mousePan=d,this._touchPan=v}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class m_{constructor(l,d,v){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jp{constructor(l,d,v,S){this._el=l,this._touchZoom=d,this._touchRotate=v,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Dc=y=>y.zoom||y.drag||y.pitch||y.rotate;class g_ extends a.f{}class $p{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,d){const v=a._.sub([],d,l);this.radius=a._.length(v[2]<0?a._.div([],v,this.constants):[v[0],v[1],0])}projectRay(l){a._.div(l,l,this.constants),a._.normalize(l,l),a._.mul(l,l,this.constants);const d=a._.scale([],l,this.radius);if(d[2]>0){const v=a._.scale([],[0,0,1],a._.dot(d,[0,0,1])),S=a._.scale([],a._.normalize([],[d[0],d[1],0]),this.radius),T=a._.add([],d,a._.scale([],a._.sub([],a._.add([],S,v),d),2));d[0]=T[0],d[1]=T[1]}return d}}function $f(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class P1{constructor(l,d){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new lu(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $p,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),a.bp(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,T,P]of this._listeners){const I=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(T,I,P)}}destroy(){for(const[l,d,v]of this._listeners){const S=l===document?this.handleWindowEvent:this.handleEvent;l.removeEventListener(d,S,v)}}_addDefaultHandlers(l){const d=this._map,v=d.getCanvasContainer();this._add("mapEvent",new l_(d,l));const S=d.boxZoom=new kp(d,l);this._add("boxZoom",S);const T=new Dp,P=new Np;d.doubleClickZoom=new d_(P,T),this._add("tapZoom",T),this._add("clickZoom",P);const I=new Bp;this._add("tapDragZoom",I);const L=d.touchPitch=new E1(d);this._add("touchPitch",L);const F=new u_(l),V=new uu(l);d.dragRotate=new m_(l,F,V),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const Z=new w1(l),Q=new S1(d,l);d.dragPan=new p_(v,Z,Q),this._add("mousePan",Z),this._add("touchPan",Q,["touchZoom","touchRotate"]);const J=new f_,ie=new h_;d.touchZoomRotate=new jp(v,ie,J,I),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Lf(d));const oe=d.scrollZoom=new $o(d,this);this._add("scrollZoom",oe,["mousePan"]);const ae=d.keyboard=new $A;this._add("keyboard",ae);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[se]&&d[se].enable(l[se])}_add(l,d,v){this._handlers.push({handlerName:l,handler:d,allowed:v}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Dc(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,d,v){for(const S in l)if(S!==v&&(!d||d.indexOf(S)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const d=[];for(const v of l)this._el.contains(v.target)&&d.push(v);return d}handleEvent(l,d){this._updatingCamera=!0;const v=l.type==="renderFrame",S=v?void 0:l,T={needsRenderFrame:!1},P={},I={},L=l.touches?this._getMapTouches(l.touches):void 0,F=L?ue(this._el,L):v?void 0:ee(this._el,l);for(const{handlerName:Q,handler:J,allowed:ie}of this._handlers){if(!J.isEnabled())continue;let oe;this._blockedByActive(I,ie,Q)?J.reset():J[d||l.type]&&(oe=J[d||l.type](l,F,L),this.mergeHandlerResult(T,P,oe,Q,S),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||J.isActive())&&(I[Q]=J)}const V={};for(const Q in this._previousActiveHandlers)I[Q]||(V[Q]=S);this._previousActiveHandlers=I,(Object.keys(V).length||$f(T))&&(this._changes.push([T,P,V]),this._triggerRenderFrame()),(Object.keys(I).length||$f(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=T;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(l,d,v,S,T){if(!v)return;a.W(l,v);const P={handlerName:S,originalEvent:v.originalEvent||T};v.zoomDelta!==void 0&&(d.zoom=P),v.panDelta!==void 0&&(d.drag=P),v.pitchDelta!==void 0&&(d.pitch=P),v.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const l={},d={},v={};for(const[S,T,P]of this._changes)S.panDelta&&(l.panDelta=(l.panDelta||new a.P(0,0))._add(S.panDelta)),S.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(l.around=S.around),S.aroundCoord!==void 0&&(l.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(l.pinchAround=S.pinchAround),S.noInertia&&(l.noInertia=S.noInertia),a.W(d,T),a.W(v,P);this._updateMapTransform(l,d,v),this._changes=[]}_updateMapTransform(l,d,v){const S=this._map,T=S.transform,P=me=>[me.x,me.y,me.z];if((me=>{const ge=this._eventsInProgress.drag;return ge&&!this._handlersById[ge.handlerName].isActive()})()&&!$f(l)){const me=T.zoom;T.cameraElevationReference="sea",this._originalZoom!=null&&T._orthographicProjectionAtLowPitch&&T.projection.name!=="globe"&&T.pitch===0?(T.cameraElevationReference="ground",T.zoom=this._originalZoom):(T.recenterOnTerrain(),T.cameraElevationReference="ground"),me!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&S._stop(!0),!$f(l))return void this._fireEvents(d,v,!0);let{panDelta:I,zoomDelta:L,bearingDelta:F,pitchDelta:V,around:Z,aroundCoord:Q,pinchAround:J}=l;T._isCameraConstrained&&(L>0&&(L=0),T._isCameraConstrained=!1),J!==void 0&&(Z=J),(L||(me=>d[me]&&!this._eventsInProgress[me])("drag"))&&Z&&(this._dragOrigin=P(T.pointCoordinate3D(Z)),this._originalZoom=T.zoom,this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",S._stop(!0),Z=Z||S.transform.centerPoint,F&&(T.bearing+=F),V&&(T.pitch+=V),T._updateCameraState();const ie=[0,0,0];if(I)if(T.projection.name==="mercator"){const me=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(Z).dir),ge=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(Z.sub(I)).dir);ie[0]=ge[0]-me[0],ie[1]=ge[1]-me[1]}else{const me=T.pointCoordinate(Z);if(T.projection.name==="globe"){I=I.rotate(-T.angle);const ge=T._pixelsPerMercatorPixel/T.worldSize;ie[0]=-I.x*a.d3(a.ay(me.y))*ge,ie[1]=-I.y*a.d3(T.center.lat)*ge}else{const ge=T.pointCoordinate(Z.sub(I));me&&ge&&(ie[0]=ge.x-me.x,ie[1]=ge.y-me.y)}}const oe=T.zoom,ae=[0,0,0];if(L){const me=P(Q||T.pointCoordinate3D(Z)),ge={dir:a._.normalize([],a._.sub([],me,T._camera.position))};if(ge.dir[2]<0){const ye=T.zoomDeltaToMovement(me,L);a._.scale(ae,ge.dir,ye)}}const se=a._.add(ie,ie,ae);T._translateCameraConstrained(se),L&&Math.abs(T.zoom-oe)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,v,!0)}_fireEvents(l,d,v){const S=Dc(this._eventsInProgress),T=Dc(l),P={};for(const V in l){const{originalEvent:Z}=l[V];this._eventsInProgress[V]||(P[`${V}start`]=Z),this._eventsInProgress[V]=l[V]}!S&&T&&this._fireEvent("movestart",T.originalEvent);for(const V in P)this._fireEvent(V,P[V]);T&&this._fireEvent("move",T.originalEvent);for(const V in l){const{originalEvent:Z}=l[V];this._fireEvent(V,Z)}const I={};let L;for(const V in this._eventsInProgress){const{handlerName:Z,originalEvent:Q}=this._eventsInProgress[V];this._handlersById[Z].isActive()||(delete this._eventsInProgress[V],L=d[Z]||Q,I[`${V}end`]=L)}for(const V in I)this._fireEvent(V,I[V]);const F=Dc(this._eventsInProgress);if(v&&(S||T)&&!F){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;V?(Z(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:L})):(this._map.fire(new a.f("moveend",{originalEvent:L})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new a.f(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new g_("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const cu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class UA extends a.E{constructor(l,d){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,a.bp(["_renderFrameCallback"],this)}getCenter(){return new a.aI(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,v){return l=a.P.convert(l).mult(-1),this.panTo(this.transform.center,a.W({offset:l},d),v)}panTo(l,d,v){return this.easeTo(a.W({center:l},d),v)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,v){return this.easeTo(a.W({zoom:l},d),v)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,v){return this.easeTo(a.W({bearing:l},d),v)}resetNorth(l,d){return this.rotateTo(0,a.W({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(a.W({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=a.ai.convert(l);const v=d&&d.bearing||0,S=d&&d.pitch||0,T=l.getNorthWest(),P=l.getSouthEast();return this._cameraForBounds(this.transform,T,P,v,S,d)}_extendPadding(l){const d={top:0,right:0,bottom:0,left:0};return l==null?a.W({},d,this.transform.padding):typeof l=="number"?{top:l,bottom:l,right:l,left:l}:a.W({},d,l)}_extendCameraOptions(l){return(l=a.W({offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=this._extendPadding(l.padding),l}_minimumAABBFrustumDistance(l,d){const v=d.max[0]-d.min[0],S=d.max[1]-d.min[1];return v/S>l.aspect?v/(2*Math.tan(.5*l.fovX)*l.aspect):S/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,d,v,S,T,P){const I=l.clone(),L=this._extendCameraOptions(P);I.bearing=S,I.pitch=T;const F=a.aI.convert(d),V=a.aI.convert(v),Z=.5*(F.lat+V.lat),Q=.5*(F.lng+V.lng),J=a.d4(Z,Q),ie=a._.normalize([],J),oe=a._.normalize([],a._.cross([],ie,[0,1,0])),ae=a._.cross([],oe,ie),se=[oe[0],oe[1],oe[2],0,ae[0],ae[1],ae[2],0,ie[0],ie[1],ie[2],0,0,0,0,1],me=[J,a.d4(F.lat,F.lng),a.d4(V.lat,F.lng),a.d4(V.lat,V.lng),a.d4(F.lat,V.lng),a.d4(Z,F.lng),a.d4(Z,V.lng),a.d4(F.lat,Q),a.d4(V.lat,Q)];let ge=a.b6.fromPoints(me.map(ct=>[a._.dot(oe,ct),a._.dot(ae,ct),a._.dot(ie,ct)]));const ye=a._.transformMat4([],ge.center,se);a._.squaredLength(ye)===0&&a._.set(ye,0,0,1),a._.normalize(ye,ye),a._.scale(ye,ye,a.cD),I.center=a.d5(ye);const Ce=I.getWorldToCameraMatrix(),Ae=a.ad.invert(new Float64Array(16),Ce);ge=a.b6.applyTransform(ge,a.ad.multiply([],Ce,se));const pe=this._extendAABB(ge,I,L,S);if(!pe)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ge=pe,a._.transformMat4(ye,ye,Ce);const _e=.5*(ge.max[2]-ge.min[2]),xe=this._minimumAABBFrustumDistance(I,ge),Re=a._.scale([],[0,0,1],_e),Ge=a._.add(Re,ye,Re),Te=xe+(I.pitch===0?0:a._.distance(ye,Ge)),We=I.globeCenterInViewSpace,qe=a._.sub([],ye,[We[0],We[1],We[2]]);a._.normalize(qe,qe),a._.scale(qe,qe,Te);const dt=a._.add([],ye,qe);a._.transformMat4(dt,dt,Ae);const mt=a.d7/a.cD,ft=a._.length(dt),Be=a.ax(Math.max(ft*mt-a.d7,Number.EPSILON),0),Je=Math.min(I.zoomFromMercatorZAdjusted(Be),L.maxZoom);return Je>.5*(a.b1+a.aU)?(I.setProjection({name:"mercator"}),I.zoom=Je,this._cameraForBounds(I,d,v,S,T,P)):{center:I.center,zoom:Je,bearing:S,pitch:T}}_extendAABB(l,d,v,S){const T=.5*((v.padding.left||0)+(v.padding.right||0)),P=.5*((v.padding.top||0)+(v.padding.bottom||0)),I=P,L=T,F=T,V=P,Z=d.width-(L+F),Q=d.height-(I+V),J=a._.sub([],l.max,l.min),ie=Math.min(Z/J[0],Q/J[1]),oe=Math.min(d.scaleZoom(d.scale*ie),v.maxZoom);if(isNaN(oe))return null;const ae=d.scale/d.zoomScale(oe),se=new a.b6([l.min[0]-L*ae,l.min[1]-V*ae,l.min[2]],[l.max[0]+F*ae,l.max[1]+I*ae,l.max[2]]),me=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new a.P(v.offset.x,v.offset.y):a.P.convert(v.offset)).rotate(-a.ab(S));return se.center[0]-=me.x*ae,se.center[1]+=me.y*ae,se}queryTerrainElevation(l,d){const v=this.transform.elevation;return v?(d=a.W({},{exaggerated:!0},d),v.getAtPoint(a.Y.fromLngLat(l),null,d.exaggerated)):null}_cameraForBounds(l,d,v,S,T,P){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,d,v,S,T,P);const I=l.clone(),L=this._extendCameraOptions(P);I.bearing=S,I.pitch=T;const F=a.aI.convert(d),V=a.aI.convert(v),Z=new a.aI(F.lng,V.lat),Q=new a.aI(V.lng,F.lat),J=I.project(F),ie=I.project(V),oe=this.queryTerrainElevation(F),ae=this.queryTerrainElevation(V),se=this.queryTerrainElevation(Z),me=this.queryTerrainElevation(Q),ge=[[J.x,J.y,Math.min(oe||0,ae||0,se||0,me||0)],[ie.x,ie.y,Math.max(oe||0,ae||0,se||0,me||0)]];let ye=a.b6.fromPoints(ge);const Ce=I.getWorldToCameraMatrix(),Ae=a.ad.invert(new Float64Array(16),Ce);ye=a.b6.applyTransform(ye,Ce);const pe=this._extendAABB(ye,I,L,S);if(!pe)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ye=pe;const _e=.5*a._.sub([],ye.max,ye.min)[2],xe=this._minimumAABBFrustumDistance(I,ye),Re=[0,0,1,0];a.aA.transformMat4(Re,Re,Ce),a.aA.normalize(Re,Re);const Ge=a._.scale([],Re,xe+_e),Te=a._.add([],ye.center,Ge);a._.transformMat4(ye.center,ye.center,Ae),a._.transformMat4(Te,Te,Ae);const We=[ye.center[0],ye.center[1],Te[2]*I.pixelsPerMeter];a._.scale(We,We,1/I.worldSize);const qe=a.d6(We[0]),dt=a.ay(We[1]),mt=Math.min(I._zoomFromMercatorZ(We[2]),L.maxZoom),ft=new a.aI(qe,dt);return I.mercatorFromTransition&&mt<.5*(a.b1+a.aU)?(I.setProjection({name:"globe"}),I.zoom=mt,this._cameraForBounds(I,d,v,S,T,P)):{center:ft,zoom:mt,bearing:S,pitch:T}}fitBounds(l,d,v){const S=this.cameraForBounds(l,d);return this._fitInternal(S,d,v)}fitScreenCoordinates(l,d,v,S,T){const P=a.P.convert(l),I=a.P.convert(d),L=new a.P(Math.min(P.x,I.x),Math.min(P.y,I.y)),F=new a.P(Math.max(P.x,I.x),Math.max(P.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,I))return this;const V=this.transform.pointLocation3D(L),Z=this.transform.pointLocation3D(F),Q=this.transform.pointLocation3D(new a.P(L.x,F.y)),J=this.transform.pointLocation3D(new a.P(F.x,L.y)),ie=[Math.min(V.lng,Z.lng,Q.lng,J.lng),Math.min(V.lat,Z.lat,Q.lat,J.lat)],oe=[Math.max(V.lng,Z.lng,Q.lng,J.lng),Math.max(V.lat,Z.lat,Q.lat,J.lat)],ae=S&&S.pitch?S.pitch:this.getPitch(),se=this._cameraForBounds(this.transform,ie,oe,v,ae,S);return this._fitInternal(se,S,T)}_fitInternal(l,d,v){return l?(d=a.W(l,d)).linear?this.easeTo(d,v):this.flyTo(d,v):this}jumpTo(l,d){this.stop();const v=l.preloadOnly?this.transform.clone():this.transform;let S=!1,T=!1,P=!1;return"zoom"in l&&v.zoom!==+l.zoom&&(S=!0,v.zoom=+l.zoom),l.center!==void 0&&(v.center=a.aI.convert(l.center)),"bearing"in l&&v.bearing!==+l.bearing&&(T=!0,v.bearing=+l.bearing),"pitch"in l&&v.pitch!==+l.pitch&&(P=!0,v.pitch=+l.pitch),l.padding==null||v.isPaddingEqual(l.padding)||(v.padding=l.padding),l.preloadOnly?(this._preloadTiles(v),this):(this.fire(new a.f("movestart",d)).fire(new a.f("move",d)),S&&this.fire(new a.f("zoomstart",d)).fire(new a.f("zoom",d)).fire(new a.f("zoomend",d)),T&&this.fire(new a.f("rotatestart",d)).fire(new a.f("rotate",d)).fire(new a.f("rotateend",d)),P&&this.fire(new a.f("pitchstart",d)).fire(new a.f("pitch",d)).fire(new a.f("pitchend",d)),this.fire(new a.f("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(cu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,d){const v=this.transform;if(!v.projection.supportsFreeCamera)return a.w(cu),this;this.stop();const S=v.zoom,T=v.pitch,P=v.bearing;v.setFreeCameraOptions(l);const I=S!==v.zoom,L=T!==v.pitch,F=P!==v.bearing;return this.fire(new a.f("movestart",d)).fire(new a.f("move",d)),I&&this.fire(new a.f("zoomstart",d)).fire(new a.f("zoom",d)).fire(new a.f("zoomend",d)),F&&this.fire(new a.f("rotatestart",d)).fire(new a.f("rotate",d)).fire(new a.f("rotateend",d)),L&&this.fire(new a.f("pitchstart",d)).fire(new a.f("pitch",d)).fire(new a.f("pitchend",d)),this.fire(new a.f("moveend",d)),this}easeTo(l,d){this._stop(!1,l.easeId),((l=a.W({offset:[0,0],duration:500,easing:a.d2},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);const v=this.transform,S=this.getZoom(),T=this.getBearing(),P=this.getPitch(),I=this.getPadding(),L="zoom"in l?+l.zoom:S,F="bearing"in l?this._normalizeBearing(l.bearing,T):T,V="pitch"in l?+l.pitch:P,Z=this._extendPadding(l.padding),Q=a.P.convert(l.offset);let J,ie,oe;if(v.projection.name==="globe"){const xe=a.Y.fromLngLat(v.center),Re=Q.rotate(-v.angle);xe.x+=Re.x/v.worldSize,xe.y+=Re.y/v.worldSize;const Ge=xe.toLngLat(),Te=a.aI.convert(l.center||Ge);this._normalizeCenter(Te),J=v.centerPoint.add(Re),ie=new a.P(xe.x,xe.y).mult(v.worldSize),oe=new a.P(a.aj(Te.lng),a.ak(Te.lat)).mult(v.worldSize).sub(ie)}else{J=v.centerPoint.add(Q);const xe=v.pointLocation(J),Re=a.aI.convert(l.center||xe);this._normalizeCenter(Re),ie=v.project(xe),oe=v.project(Re).sub(ie)}const ae=v.zoomScale(L-S);let se,me;l.around&&(se=a.aI.convert(l.around),me=v.locationPoint(se));const ge=this._zooming||L!==S,ye=this._rotating||T!==F,Ce=this._pitching||V!==P,Ae=!v.isPaddingEqual(Z),pe=xe=>Re=>{if(ge&&(xe.zoom=a.a2(S,L,Re)),ye&&(xe.bearing=a.a2(T,F,Re)),Ce&&(xe.pitch=a.a2(P,V,Re)),Ae&&(xe.interpolatePadding(I,Z,Re),J=xe.centerPoint.add(Q)),se)xe.setLocationAtPoint(se,me);else{const Ge=xe.zoomScale(xe.zoom-S),Te=L>S?Math.min(2,ae):Math.max(.5,ae),We=Math.pow(Te,1-Re),qe=xe.unproject(ie.add(oe.mult(Re*We)).mult(Ge));xe.setLocationAtPoint(xe.renderWorldCopies?qe.wrap():qe,J)}return l.preloadOnly||this._fireMoveEvents(d),xe};if(l.preloadOnly){const xe=this._emulate(pe,l.duration,v);return this._preloadTiles(xe),this}const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ge,this._rotating=ye,this._pitching=Ce,this._padding=Ae,this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,_e),this._ease(pe(v),xe=>{v.cameraElevationReference==="sea"&&v.recenterOnTerrain(),this._afterEase(d,xe)},l),this}_prepareEase(l,d,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||v.moving||this.fire(new a.f("movestart",l)),this._zooming&&!v.zooming&&this.fire(new a.f("zoomstart",l)),this._rotating&&!v.rotating&&this.fire(new a.f("rotatestart",l)),this._pitching&&!v.pitching&&this.fire(new a.f("pitchstart",l))}_fireMoveEvents(l){this.fire(new a.f("move",l)),this._zooming&&this.fire(new a.f("zoom",l)),this._rotating&&this.fire(new a.f("rotate",l)),this._pitching&&this.fire(new a.f("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,S=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new a.f("zoomend",l)),S&&this.fire(new a.f("rotateend",l)),T&&this.fire(new a.f("pitchend",l)),this.fire(new a.f("moveend",l))}flyTo(l,d){if(this._prefersReducedMotion(l)){const Je=a.ah(l,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(Je,d)}this.stop(),l=a.W({offset:[0,0],speed:1.2,curve:1.42,easing:a.d2},l);const v=this.transform,S=this.getZoom(),T=this.getBearing(),P=this.getPitch(),I=this.getPadding(),L="zoom"in l?a.at(+l.zoom,v.minZoom,v.maxZoom):S,F="bearing"in l?this._normalizeBearing(l.bearing,T):T,V="pitch"in l?+l.pitch:P,Z=this._extendPadding(l.padding),Q=v.zoomScale(L-S),J=a.P.convert(l.offset);let ie=v.centerPoint.add(J);const oe=v.pointLocation(ie),ae=a.aI.convert(l.center||oe);this._normalizeCenter(ae);const se=v.project(oe),me=v.project(ae).sub(se);let ge=l.curve;const ye=Math.max(v.width,v.height),Ce=ye/Q,Ae=me.mag();if("minZoom"in l){const Je=a.at(Math.min(l.minZoom,S,L),v.minZoom,v.maxZoom),ct=ye/v.zoomScale(Je-S);ge=Math.sqrt(ct/Ae*2)}const pe=ge*ge;function _e(Je){const ct=(Ce*Ce-ye*ye+(Je?-1:1)*pe*pe*Ae*Ae)/(2*(Je?Ce:ye)*pe*Ae);return Math.log(Math.sqrt(ct*ct+1)-ct)}function xe(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function Re(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Ge=_e(0);let Te=function(Je){return Re(Ge)/Re(Ge+ge*Je)},We=function(Je){return ye*((Re(Ge)*(xe(ct=Ge+ge*Je)/Re(ct))-xe(Ge))/pe)/Ae;var ct},qe=(_e(1)-Ge)/ge;if(Math.abs(Ae)<1e-6||!isFinite(qe)){if(Math.abs(ye-Ce)<1e-6)return this.easeTo(l,d);const Je=Ce<ye?-1:1;qe=Math.abs(Math.log(Ce/ye))/ge,We=function(){return 0},Te=function(ct){return Math.exp(Je*ge*ct)}}l.duration="duration"in l?+l.duration:1e3*qe/("screenSpeed"in l?+l.screenSpeed/ge:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const dt=T!==F,mt=V!==P,ft=!v.isPaddingEqual(Z),Be=Je=>ct=>{const Ot=ct*qe,kt=1/Te(Ot);Je.zoom=ct===1?L:S+Je.scaleZoom(kt),dt&&(Je.bearing=a.a2(T,F,ct)),mt&&(Je.pitch=a.a2(P,V,ct)),ft&&(Je.interpolatePadding(I,Z,ct),ie=Je.centerPoint.add(J));const Nt=ct===1?ae:Je.unproject(se.add(me.mult(We(Ot))).mult(kt));return Je.setLocationAtPoint(Je.renderWorldCopies?Nt.wrap():Nt,ie),Je._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(d),Je};if(l.preloadOnly){const Je=this._emulate(Be,l.duration,v);return this._preloadTiles(Je),this}return this._zooming=!0,this._rotating=dt,this._pitching=mt,this._padding=ft,this._prepareEase(d,!1),this._ease(Be(v),()=>this._afterEase(d),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(l){}_cancelRenderFrame(l){}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,d)}if(!l){const v=this.handlers;v&&v.stop(!1)}return this}_ease(l,d,v){v.animate===!1||v.duration===0?(l(1),d()):(this._easeStart=a.e.now(),this._easeOptions=v,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((a.e.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,d){l=a.au(l,-180,180);const v=Math.abs(l-d);return Math.abs(l-360-d)<v&&(l-=360),Math.abs(l+360-d)<v&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const v=l.lng-d.center.lng;l.lng+=v>180?-360:v<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&a.e.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,d,v){const S=Math.ceil(15*d/1e3),T=[],P=l(v.clone());for(let I=0;I<=S;I++){const L=P(I/S);T.push(L.clone())}return T}_preloadTiles(l,d){}}class M1{constructor(l={}){this.options=l,a.bp(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const d=this.options&&this.options.compact;return this._map=l,this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=k("button","mapboxgl-ctrl-attrib-button",this._container),k("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,d){const v=this._map._getUIString(`AttributionControl.${d}`);l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.d8.ACCESS_TOKEN}];if(l){const v=d.reduce((S,T,P)=>(T.value&&(S+=`${T.key}=${T.value}${P<d.length-1?"&":""}`),S),"?");l.href=`${a.d8.FEEDBACK_URL}/${v}#${kf(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const d=this._map.style._mergedSourceCaches;for(const S in d){const T=d[S];if(T.used){const P=T.getSource();P.attribution&&l.indexOf(P.attribution)<0&&l.push(P.attribution)}}l.sort((S,T)=>S.length-T.length),l=l.filter((S,T)=>{for(let P=T+1;P<l.length;P++)if(l[P].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const v=l.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,l.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class I1{constructor(){a.bp(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=k("div","mapboxgl-ctrl");const d=k("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(const d in l){const v=l[d].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class O1{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,v=d?this._queue.concat(d):this._queue;for(const S of v)if(S.id===l)return void(S.cancelled=!0)}run(l=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const v of d)if(!v.cancelled&&(v.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function R1(y,l,d){if(y=new a.aI(y.lng,y.lat),l){const v=new a.aI(y.lng-360,y.lat),S=new a.aI(y.lng+360,y.lat),T=360*Math.ceil(Math.abs(y.lng-d.center.lng)/360),P=d.locationPoint(y).distSqr(l),I=l.x<0||l.y<0||l.x>d.width||l.y>d.height;d.locationPoint(v).distSqr(l)<P&&(I||Math.abs(v.lng-d.center.lng)<T)?y=v:d.locationPoint(S).distSqr(l)<P&&(I||Math.abs(S.lng-d.center.lng)<T)&&(y=S)}for(;Math.abs(y.lng-d.center.lng)>180;){const v=d.locationPoint(y);if(v.x>=0&&v.y>=0&&v.x<=d.width&&v.y<=d.height)break;y.lng>d.center.lng?y.lng-=360:y.lng+=360}return y}const y_={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Uf extends a.E{constructor(l,d){if(super(),(l instanceof HTMLElement||d)&&(l=a.W({element:l},d)),a.bp(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=a.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=k("div");const T=41,P=27,I=N("svg",{display:"block",height:T*this._scale+"px",width:P*this._scale+"px",viewBox:`0 0 ${P} ${T}`},this._element),L=N("radialGradient",{id:"shadowGradient"},N("defs",{},I));N("stop",{offset:"10%","stop-opacity":.4},L),N("stop",{offset:"100%","stop-opacity":.05},L),N("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),N("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),N("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),N("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=a.P.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const v=this._element.classList;for(const T in y_)v.remove(`mapboxgl-marker-anchor-${T}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`);const S=l&&l.className?l.className.trim().split(/\s+/):[];v.add(...S),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=a.aI.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const d=l.code,v=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(l){const d=l.originalEvent.target,v=this._element;this._popup&&(d===v||v.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,d=this._pos;if(!l||!d)return!1;const v=l.unproject(d),S=l.getFreeCameraOptions();if(!S.position)return!1;const T=S.position.toLngLat();return T.distanceTo(v)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const d=this._pos;if(!d||d.x<0||d.x>l.transform.width||d.y<0||d.y>l.transform.height)return void this._clearFadeTimer();const v=l.unproject(d);let S;l._showingGlobe()&&a.d9(l.transform,this._lngLat)?S=0:(S=1-l._queryFogOpacity(v),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${y_[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const l=this._pos,d=this._map,v=this.getPitchAlignment();if(!d||!l||v!=="map")return"";if(!d._showingGlobe()){const L=d.getPitch();return L?`rotateX(${L}deg)`:""}const S=a.b0(a.da(d.transform,this._lngLat)),T=l.sub(a.db(d.transform)),P=Math.abs(T.x)+Math.abs(T.y);if(P===0)return"";const I=S/P;return`rotateX(${-T.y*I}deg) rotateY(${T.x*I}deg)`}_calculateZTransform(){const l=this._pos,d=this._map;if(!d||!l)return"";let v=0;const S=this.getRotationAlignment();if(S==="map")if(d._showingGlobe()){const T=d.project(new a.aI(this._lngLat.lng,this._lngLat.lat+.001)),P=d.project(new a.aI(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);v=a.b0(Math.atan2(P.y,P.x))-90}else v=-d.getBearing();else if(S==="horizon"){const T=a.$(4,6,d.getZoom()),P=a.db(d.transform);P.y+=T*d.transform.height;const I=l.sub(P),L=a.b0(Math.atan2(I.y,I.x));v=(L>90?L-270:L+90)*(1-T)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(l){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=R1(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),l===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=a.P.convert(l),this._update(),this}addClassName(l){return this._element.classList.add(l),this}removeClassName(l){return this._element.classList.remove(l),this}toggleClassName(l){return this._element.classList.toggle(l)}_onMove(l){const d=this._map;if(!d)return;const v=this._pointerdownPos,S=this._positionDelta;if(v&&S){if(!this._isDragging){const T=this._clickTolerance||d._clickTolerance;if(l.point.dist(v)<T)return;this._isDragging=!0}this._pos=l.point.sub(S),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.f("dragstart"))),this.fire(new a.f("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.f("dragend")),this._state="inactive"}_addDragHandler(l){const d=this._map,v=this._pos;d&&v&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(v),this._pointerdownPos=l.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const d=this._map;return d&&(l?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const __={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},k1=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function hu(y=new a.P(0,0),l="bottom"){if(typeof y=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(l){case"top":return new a.P(0,y);case"top-left":return new a.P(d,d);case"top-right":return new a.P(-d,d);case"bottom":return new a.P(0,-y);case"bottom-left":return new a.P(d,-d);case"bottom-right":return new a.P(-d,-d);case"left":return new a.P(y,0);case"right":return new a.P(-y,0)}return new a.P(0,0)}return y instanceof a.P||Array.isArray(y)?a.P.convert(y):a.P.convert(y[l]||[0,0])}class D1{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const d=a.b9((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,d,v){this._start=this.getValue(d),this._end=l,this._startTime=d,this._endTime=d+v}}const L1={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class z1{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const v_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},fu={showCompass:!0,showZoom:!0,visualizePitch:!1};class F1{constructor(l,d,v=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new u_({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,v&&(this.mousePitch=new uu({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),a.bp(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(l,d){this.mouseRotate.mousedown(l,d),this.mousePitch&&this.mousePitch.mousedown(l,d),G()}move(l,d){const v=this.map,S=this.mouseRotate.mousemoveWindow(l,d),T=S&&S.bearingDelta;if(T&&v.setBearing(v.getBearing()+T),this.mousePitch){const P=this.mousePitch.mousemoveWindow(l,d),I=P&&P.pitchDelta;I&&v.setPitch(v.getPitch()+I)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){H(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(a.W({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),ee(this.element,l)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,ee(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ue(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=ue(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const du={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},N1={maxWidth:100,unit:"metric"},Up={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:a.dt,supported:C,setRTLTextPlugin:a.dv,getRTLTextPluginStatus:a.dw,Map:class extends UA{constructor(y){a.dc.mark(a.dd.create);const l=y;if((y=a.W({},v_,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&a.de(window)&&(y.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ja(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),y),this._repaint=!!y.repaint,this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new O1,this._domRenderTaskQueue=new O1,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.df(),this._locale=a.W({},L1,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._tessellationStep=y.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new D1(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._lastDirtyFrameId=0,this._requestManager=new a.dg(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,this._contextCreateOptions=y.contextCreateOptions?{...y.contextCreateOptions}:{},typeof y.container=="string"){const d=document.getElementById(y.container);if(!d)throw new Error(`Container '${y.container.toString()}' not found.`);this._container=d}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),a.bp(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new z1),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new P1(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,(y.style||!y.testMode)&&this.setStyle(y.style||a.d8.DEFAULT_STYLE,{config:y.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),y.hash&&(this._hash=new jA(typeof y.hash=="string"&&y.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){l.center==null&&l.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch});const d=y.bounds;d&&(this.resize(),this.fitBounds(d,a.W({},y.fitBoundsOptions,{duration:0})))}this.resize(),y.attributionControl&&this.addControl(new M1({customAttribution:y.customAttribution})),this._logoControl=new I1,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new a.f(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new a.f(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(y,l){if(l===void 0&&(l=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new a.d(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=y.onAdd(this);this._controls.push(y);const v=this._controlPositions[l];return l.indexOf("bottom")!==-1?v.insertBefore(d,v.firstChild):v.appendChild(d),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new a.d(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(y);return l>-1&&this._controls.splice(l,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new a.f("movestart",y)).fire(new a.f("move",y)),this.fire(new a.f("resize",y)),l&&this.fire(new a.f("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(a.ai.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new a.f("zoomstart")).fire(new a.f("zoom")).fire(new a.f("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new a.f("zoomstart")).fire(new a.f("zoom")).fire(new a.f("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new a.f("pitchstart")).fire(new a.f("pitch")).fire(new a.f("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new a.f("pitchstart")).fire(new a.f("pitch")).fire(new a.f("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(l=>l==="auto"?navigator.language:l):y}setLanguage(y){const l=this._parseLanguage(y);if(!this.style||l===this._language)return this;this._language=l,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,l=y.projection.name;let d;l==="globe"&&y.zoom>=a.aU?(y.setMercatorFromTransition(),d=!0):l==="mercator"&&y.zoom<a.aU&&(y.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,l){return this._updateProjection(y||l||{name:"mercator"})}_updateProjection(y){let l;return l=y.name==="globe"&&this.transform.zoom>=a.aU?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),l&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(y){return this.transform.locationPoint3D(a.aI.convert(y))}unproject(y){return this.transform.pointLocation3D(a.P.convert(y))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,l,d){if(y==="mouseenter"||y==="mouseover"){let v=!1;const S=P=>{const I=l.filter(F=>this.getLayer(F)),L=I.length?this.queryRenderedFeatures(P.point,{layers:I}):[];L.length?v||(v=!0,d.call(this,new Li(y,this,P.originalEvent,{features:L}))):v=!1},T=()=>{v=!1};return{layers:new Set(l),listener:d,delegates:{mousemove:S,mouseout:T}}}if(y==="mouseleave"||y==="mouseout"){let v=!1;const S=P=>{const I=l.filter(L=>this.getLayer(L));(I.length?this.queryRenderedFeatures(P.point,{layers:I}):[]).length?v=!0:v&&(v=!1,d.call(this,new Li(y,this,P.originalEvent)))},T=P=>{v&&(v=!1,d.call(this,new Li(y,this,P.originalEvent)))};return{layers:new Set(l),listener:d,delegates:{mousemove:S,mouseout:T}}}{const v=S=>{const T=l.filter(I=>this.getLayer(I)),P=T.length?this.queryRenderedFeatures(S.point,{layers:T}):[];P.length&&(S.features=P,d.call(this,S),delete S.features)};return{layers:new Set(l),listener:d,delegates:{[y]:v}}}}on(y,l,d){if(typeof l=="function"||d===void 0)return super.on(y,l);if(Array.isArray(l)||(l=[l]),l){for(const S of l)if(!this._isValidId(S))return this}const v=this._createDelegatedListener(y,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(v);for(const S in v.delegates)this.on(S,v.delegates[S]);return this}once(y,l,d){if(typeof l=="function"||d===void 0)return super.once(y,l);if(Array.isArray(l)||(l=[l]),l){for(const S of l)if(!this._isValidId(S))return this}const v=this._createDelegatedListener(y,l,d);for(const S in v.delegates)this.once(S,v.delegates[S]);return this}off(y,l,d){if(typeof l=="function"||d===void 0)return super.off(y,l);const v=new Set(Array.isArray(l)?l:[l]);for(const P of v)if(!this._isValidId(P))return this;const S=(P,I)=>{if(P.size!==I.size)return!1;for(const L of P)if(!I.has(L))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[y]:void 0;return T&&(P=>{for(let I=0;I<P.length;I++){const L=P[I];if(L.listener===d&&S(L.layers,v)){for(const F in L.delegates)this.off(F,L.delegates[F]);return P.splice(I,1),this}}})(T),this}queryRenderedFeatures(y,l){if(!this.style)return[];if(l!==void 0||y===void 0||y instanceof a.P||Array.isArray(y)||(l=y,y=void 0),y=y||[[0,0],[this.transform.width,this.transform.height]],(l=l||{}).layers&&Array.isArray(l.layers)){for(const d of l.layers)if(!this._isValidId(d))return[]}return this.style.queryRenderedFeatures(y,l,this.transform)}querySourceFeatures(y,l){return this._isValidId(y)?this.style.querySourceFeatures(y,l):[]}isPointOnSurface(y){const{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&a.w(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(y))}setStyle(y,l){return l=a.W({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l),this.style&&y&&l.diff!==!1&&l.localFontFamily===this._localFontFamily&&l.localIdeographFontFamily===this._localIdeographFontFamily&&!l.config?(this.style._diffStyle(y,(d,v)=>{d?(a.w(`Unable to perform style diff: ${String(d.message||d.error||d)}. Rebuilding the style from scratch.`),this._updateStyle(y,l)):v&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(y,l))}_getUIString(y){const l=this._locale[y];if(l==null)throw new Error(`Missing UI string '${y}'`);return l}_updateStyle(y,l){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y){const d=a.W({},l);l&&l.config&&(d.initialConfig=l.config,delete d.config),this.style=new Ca(this,d).load(y),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ca(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(y){return y==null?(this.fire(new a.d(new Error("IDs can't be empty."))),!1):!a.cV(y)||(this.fire(new a.d(new Error(`IDs can't contain special symbols: "${y}".`))),!1)}addSource(y,l){return this._isValidId(y)?(this._lazyInitEmptyStyle(),this.style.addSource(y,l),this._update(!0)):this}isSourceLoaded(y){return!!this._isValidId(y)&&!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(y,l,d){this._lazyInitEmptyStyle(),this.style.addSourceType(y,l,d)}removeSource(y){return this._isValidId(y)?(this.style.removeSource(y),this._updateTerrain(),this._update(!0)):this}getSource(y){return this._isValidId(y)?this.style.getOwnSource(y):null}addImage(y,l,{pixelRatio:d=1,sdf:v=!1,stretchX:S,stretchY:T,content:P}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap){const{width:I,height:L,data:F}=a.e.getImageData(l);this.style.addImage(y,{data:new a.i({width:I,height:L},F),pixelRatio:d,stretchX:S,stretchY:T,content:P,sdf:v,version:0})}else if(l.width===void 0||l.height===void 0)this.fire(new a.d(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:L}=l,F=l;this.style.addImage(y,{data:new a.i({width:I,height:L},new Uint8Array(F.data)),pixelRatio:d,stretchX:S,stretchY:T,content:P,sdf:v,version:0,userImage:F}),F.onAdd&&F.onAdd(this,y)}}updateImage(y,l){this._lazyInitEmptyStyle();const d=this.style.getImage(y);if(!d)return void this.fire(new a.d(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap?a.e.getImageData(l):l,{width:S,height:T,data:P}=v;if(S===void 0||T===void 0)return void this.fire(new a.d(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==d.data.width||T!==d.data.height)return void this.fire(new a.d(new Error(`The width and height of the updated image (${S}, ${T})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`)));const I=!(l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap);d.data.replace(P,I),this.style.updateImage(y,d)}hasImage(y){return y?!!this.style&&!!this.style.getImage(y):(this.fire(new a.d(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,l){a.h(this._requestManager.transformRequest(y,a.R.Image),(d,v)=>{l(d,v instanceof HTMLImageElement?a.e.getImageData(v):v)})}listImages(){return this.style.listImages()}addModel(y,l){this._lazyInitEmptyStyle(),this.style.addModel(y,l)}hasModel(y){return y?this.style.hasModel(y):(this.fire(new a.d(new Error("Missing required model id"))),!1)}removeModel(y){this.style.removeModel(y)}listModels(){return this.style.listModels()}addLayer(y,l){return this._isValidId(y.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(y,l),this._update(!0)):this}getSlot(y){const l=this.getLayer(y);return l&&l.slot||null}setSlot(y,l){return this.style.setSlot(y,l),this.style.mergeLayers(),this._update(!0)}addImport(y,l){return this.style.addImport(y,l),this}updateImport(y,l){return typeof l!="string"&&l.id!==y?(this.removeImport(y),this.addImport(l)):(this.style.updateImport(y,l),this._update(!0))}removeImport(y){return this.style.removeImport(y),this}moveImport(y,l){return this.style.moveImport(y,l),this._update(!0)}moveLayer(y,l){return this._isValidId(y)?(this.style.moveLayer(y,l),this._update(!0)):this}removeLayer(y){return this._isValidId(y)?(this.style.removeLayer(y),this._update(!0)):this}getLayer(y){return this._isValidId(y)?this.style.getOwnLayer(y):null}getSlots(){return this.style.getSlots()}setLayerZoomRange(y,l,d){return this._isValidId(y)?(this.style.setLayerZoomRange(y,l,d),this._update(!0)):this}setFilter(y,l,d={}){return this._isValidId(y)?(this.style.setFilter(y,l,d),this._update(!0)):this}getFilter(y){return this._isValidId(y)?this.style.getFilter(y):null}setPaintProperty(y,l,d,v={}){return this._isValidId(y)?(this.style.setPaintProperty(y,l,d,v),this._update(!0)):this}getPaintProperty(y,l){return this._isValidId(y)?this.style.getPaintProperty(y,l):null}setLayoutProperty(y,l,d,v={}){return this._isValidId(y)?(this.style.setLayoutProperty(y,l,d,v),this._update(!0)):this}getLayoutProperty(y,l){return this._isValidId(y)?this.style.getLayoutProperty(y,l):null}getSchema(y){return this.style.getSchema(y)}setSchema(y,l){return this.style.setSchema(y,l),this._update(!0)}getConfig(y){return this.style.getConfig(y)}setConfig(y,l){return this.style.setConfig(y,l),this._update(!0)}getConfigProperty(y,l){return this.style.getConfigProperty(y,l)}setConfigProperty(y,l,d){return this.style.setConfigProperty(y,l,d),this._update(!0)}setLights(y){if(this._lazyInitEmptyStyle(),y&&y.length===1&&y[0].type==="flat"){const l=y[0];l.properties?this.style.setFlatLight(l.properties,l.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(y),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const y=this.style.getLights()||[];return y.length===0&&y.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),y}setLight(y,l={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:y}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(y){return this._lazyInitEmptyStyle(),this.style.setColorTheme(y),this._update(!0)}setCamera(y){return this.style.setCamera(y),this._triggerCameraUpdate(y)}_triggerCameraUpdate(y){return this._update(this.transform.setOrthographicProjectionAtLowPitch(y["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.aI.convert(y),this.transform):0}setFeatureState(y,l){return this._isValidId(y.source)?(this.style.setFeatureState(y,l),this._update()):this}removeFeatureState(y,l){return this._isValidId(y.source)?(this.style.removeFeatureState(y,l),this._update()):this}getFeatureState(y){return this._isValidId(y.source)?this.style.getFeatureState(y):null}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let d,v,S,T=this._container;for(;T&&(!v||!S);){const P=window.getComputedStyle(T).transform;P&&P!=="none"&&(d=P.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(v=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(S=d[3])),T=T.parentElement}this._containerWidth=v?Math.abs(y/v):y,this._containerHeight=S?Math.abs(l/S):l}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=k("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=k("div","mapboxgl-canvas-container",y);this._canvas=k("canvas","mapboxgl-canvas",l),this._interactive&&(l.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=k("div","mapboxgl-control-container",y),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{v[S]=k("div",`mapboxgl-ctrl-${S}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,l){const d=a.e.devicePixelRatio||1;this._canvas.width=d*Math.ceil(y),this._canvas.height=d*Math.ceil(l),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${l}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const l=this._markers.indexOf(y);l!==-1&&this._markers.splice(l,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const l=this._popups.indexOf(y);l!==-1&&this._popups.splice(l,1)}_setupPainter(){const y=a.W({},C.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl2",y);l?(a.dh(l,!0),this.painter=new c1(l,this._contextCreateOptions,this.transform,this._tp),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.di.testSupport(l)):this.fire(new a.d(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.f("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new a.f("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty&&!this._occlusionOpacityChanged&&this._occlusionCriteriaSatisfied()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let l;this.fire(new a.f("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,v=a.e.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(l=S.createQuery(),S.beginQuery(d.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,V=this.transform.pitch,Z=a.e.now(),Q=new a.X(F,{now:Z,fadeDuration:T,pitch:V,transition:this.style.transition});this.style.update(Q)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(v),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(v);const I=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,this.painter.replacementSource);if(I&&(this._placementDirty=I.needsRerender,this._occlusionOpacityChanged=I.occlusionQueryBasedOpacityChanged),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.f("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.dc.mark(a.dd.load),this.fire(new a.f("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const F=a.e.now()-v;S.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const V=S.getQueryParameter(l,S.QUERY_RESULT)/1e6;S.deleteQuery(l),this.fire(new a.f("gpu-timing-frame",{cpuTime:F,gpuTime:V}))},50)}if(this.listens("gpu-timing-layer")){const F=this.painter.collectGpuTimers();setTimeout(()=>{const V=this.painter.queryGpuTimers(F);this.fire(new a.f("gpu-timing-layer",{layerTimes:V}))},50)}if(this.listens("gpu-timing-deferred-render")){const F=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const V=this.painter.queryGpuTimeDeferredRender(F);this.fire(new a.f("gpu-timing-deferred-render",{gpuTime:V}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||this._occlusionOpacityChanged||P;if((this._sourcesDirty||this._styleDirty||P||this._occlusionOpacityChanged)&&(this._lastDirtyFrameId=this._frameId),L||this._repaint||!this._occlusionCriteriaSatisfied())this.triggerRepaint();else{const F=!this.isMoving()&&this.loaded();if(F&&(P=this._updateAverageElevation(v,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),F&&(this.fire(new a.f("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const V=this._calculateSpeedIndex();this.fire(new a.f("speedindexcompleted",{speedIndex:V})),this.speedIndexTiming=!1}}this._loaded&&!this._fullyLoaded&&!L&&this._occlusionCriteriaSatisfied()&&(this._fullyLoaded=!0,a.dc.mark(a.dd.fullLoad),this._performanceMetricsCollection&&a.dj(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const l of this._markers)y&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!y||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(y,l=!1){const d=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const v=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(v||(l||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const S=this.transform.averageElevation;let T=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=y;const P=Math.abs(S-T);if(P>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(T),d(T);this._averageElevation.easeTo(T,y,300)}else if(P>1e-4)return this._averageElevation.jumpTo(T),d(T)}return!!this._averageElevation.isEasing(y)&&d(this._averageElevation.getValue(y))}_authenticate(){a.dk(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===a.dl||y.status===401)){const l=this.painter.context.gl;a.dh(l,!1),this._logoControl instanceof I1&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.d(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.dm(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&a.dn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const d=this.painter.context.gl,v=d.createFramebuffer();function S(T){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,T,0);const P=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,P),P}return d.bindFramebuffer(d.FRAMEBUFFER,v),this._canvasPixelComparison(S(y),l.canvasCopies.map(S),l.timeStamps)}_canvasPixelComparison(y,l,d){let v=d[1]-d[0];const S=y.length/4;for(let T=0;T<l.length;T++){const P=l[T];let I=0;for(let L=0;L<P.length;L+=4)P[L]===y[L]&&P[L+1]===y[L+1]&&P[L+2]===y[L+2]&&P[L+3]===y[L+3]&&(I+=1);v+=(d[T+2]-d[T+1])*(1-I/S)}return v}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.dp(this.painter.context.gl),a.dq.remove(),a.dr.remove(),this._removed=!0,this.fire(new a.f("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=a.e.frame(l=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(l)}))}_preloadTiles(y){const l=this.style?this.style.getSourceCaches():[];return a.ds(l,(d,v)=>d._preloadTiles(y,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(y){this._showParseStatus!==y&&(this._showParseStatus=y,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(y){this._showLayers2DWireframe!==y&&(this._showLayers2DWireframe=y,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(y){this._showLayers3DWireframe!==y&&(this._showLayers3DWireframe=y,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,this._tp.refreshUI(),y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,this._tp.refreshUI(),y&&this._update())}_setCacheLimits(y,l){a.du(y,l)}_occlusionCriteriaSatisfied(){const y=this.style&&(this.style.has3DLayers()||this.style.terrain&&!this.style.disableElevatedTerrain);return!(this.style&&this.style.hasSymbolLayers()&&y&&this.painter)||this._frameId-this._lastDirtyFrameId>5+2*this.painter.symbolParams.occlusionQueryFrameWindow}get version(){return a.dt}},NavigationControl:class{constructor(y){this.options=a.W({},fu,y),this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(a.bp(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),k("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),k("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bp(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:l}):d.resetNorth({},{originalEvent:l}))}),this._compassIcon=k("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const l=y.getZoom(),d=l===y.getMaxZoom(),v=l===y.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new F1(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,l){const d=k("button",y,this._container);return d.type="button",d.addEventListener("click",l),d}_setButtonTitle(y,l){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${l}`);y.setAttribute("aria-label",d),y.firstElementChild&&y.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends a.E{constructor(y){super();const l=navigator.geolocation;this.options=a.W({geolocation:l},du,y),a.bp(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=o_(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const l=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,y(d)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>l(d.state!=="denied")).catch(()=>l()):l()}_isOutOfMapMaxBounds(y){const l=this._map.getMaxBounds(),d=y.coords;return!!l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new a.f("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.f("geolocate",y)),this._finish()}}_updateCamera(y){const l=new a.aI(y.coords.longitude,y.coords.latitude),d=y.coords.accuracy,v=this._map.getBearing(),S=a.W({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(d),S,{geolocateSource:!0})}_updateMarker(y){if(y){const l=new a.aI(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,l=a.ax(1,y._center.lat)*y.worldSize,d=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.f("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=k("button","mapboxgl-ctrl-geolocate",this._container),k("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k("div","mapboxgl-user-location"),this._dotElement.appendChild(k("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(k("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Uf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=k("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Uf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.f("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.f("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.f("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.f("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(l=>{l==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:M1,ScaleControl:class{constructor(y){this.options=a.W({},N1,y),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bp(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,l=this._map,d=l._containerHeight/2,v=l._containerWidth/2-y/2,S=l.unproject([v,d]),T=l.unproject([v+y,d]),P=S.distanceTo(T);if(this.options.unit==="imperial"){const I=3.2808*P;I>5280?this._setScale(y,I/5280,"mile"):this._setScale(y,I,"foot")}else this.options.unit==="nautical"?this._setScale(y,P/1852,"nautical-mile"):P>=1e3?this._setScale(y,P/1e3,"kilometer"):this._setScale(y,P,"meter")}_setScale(y,l,d){this._map._requestDomTask(()=>{const v=function(T){const P=Math.pow(10,`${Math.floor(T)}`.length-1);let I=T/P;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(L){const F=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*F)/F}(I),P*I}(l),S=v/l;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(v):`${v}&nbsp;${Up[d]}`,this._container.style.width=y*S+"px"})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:a.w("Full screen control 'container' must be a DOM element.")),a.bp(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=k("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=k("button","mapboxgl-ctrl-fullscreen",this._controlContainer);k("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(y){super(),this.options=a.W(Object.create(__),y),a.bp(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new a.f("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new a.f("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=a.aI.convert(y),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const l=document.createDocumentFragment(),d=document.createElement("body");let v;for(d.innerHTML=y;v=d.firstChild,v;)l.appendChild(v);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=k("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(y),this.options.closeButton){const d=this._closeButton=k("button","mapboxgl-popup-close-button",l);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let l;return this._classList.delete(y)?l=!1:(this._classList.add(y),l=!0),this._updateClassList(),l}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const l=this._map,d=this._container,v=this._pos;if(!l||!d||!v)return"bottom";const S=d.offsetWidth,T=d.offsetHeight,P=v.x<S/2,I=v.x>l.transform.width-S/2;if(v.y+y<T)return P?"top-left":I?"top-right":"top";if(v.y>l.transform.height-T){if(P)return"bottom-left";if(I)return"bottom-right"}return P?"left":I?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),y.className=l.join(" ")}_update(y){const l=this._map,d=this._content;if(!l||!this._lngLat&&!this._trackPointer||!d)return;let v=this._container;if(v||(v=this._container=k("div","mapboxgl-popup",l.getContainer()),this._tip=k("div","mapboxgl-popup-tip",v),v.appendChild(d)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=R1(this._lngLat,this._pos,l.transform)),!this._trackPointer||y){const S=this._pos=this._trackPointer&&y?y:l.project(this._lngLat),T=hu(this.options.offset),P=this._anchor=this._getAnchor(T.y),I=hu(this.options.offset,P),L=S.add(I).round();l._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${y_[P]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&l._showingGlobe()){const S=a.d9(l.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(k1);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:Uf,Style:Ca,LngLat:a.aI,LngLatBounds:a.ai,Point:a.P,MercatorCoordinate:a.Y,FreeCameraOptions:Ty,Evented:a.E,config:a.d8,prewarm:a.dx,clearPrewarmedResources:a.dy,get accessToken(){return a.d8.ACCESS_TOKEN},set accessToken(y){a.d8.ACCESS_TOKEN=y},get baseApiUrl(){return a.d8.API_URL},set baseApiUrl(y){a.d8.API_URL=y},get workerCount(){return a.dz.workerCount},set workerCount(y){a.dz.workerCount=y},get maxParallelImageRequests(){return a.d8.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){a.d8.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){a.dA(y)},get workerUrl(){return a.dB.workerUrl},set workerUrl(y){a.dB.workerUrl=y},get workerClass(){return a.dB.workerClass},set workerClass(y){a.dB.workerClass=y},get workerParams(){return a.dB.workerParams},set workerParams(y){a.dB.workerParams=y},get dracoUrl(){return a.dC()},set dracoUrl(y){a.dD(y)},get meshoptUrl(){return a.dE()},set meshoptUrl(y){a.dF(y)},setNow:a.e.setNow,restoreNow:a.e.restoreNow}});var _=h;return _})})(xG);var _re=xG.exports;const Cd=Vr(_re);function wG(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=wG(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function Cr(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=wG(e))&&(o&&(o+=" "),o+=t);return o}const pk="-";function vre(e){const t=bre(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:o}=e;function u(p){const _=p.split(pk);return _[0]===""&&_.length!==1&&_.shift(),SG(_,t)||xre(p)}function h(p,_){const a=n[p]||[];return _&&o[p]?[...a,...o[p]]:a}return{getClassGroupId:u,getConflictingClassGroupIds:h}}function SG(e,t){var p;if(e.length===0)return t.classGroupId;const n=e[0],o=t.nextPart.get(n),u=o?SG(e.slice(1),o):void 0;if(u)return u;if(t.validators.length===0)return;const h=e.join(pk);return(p=t.validators.find(({validator:_})=>_(h)))==null?void 0:p.classGroupId}const _4=/^\[(.+)\]$/;function xre(e){if(_4.test(e)){const t=_4.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}}function bre(e){const{theme:t,prefix:n}=e,o={nextPart:new Map,validators:[]};return Sre(Object.entries(e.classGroups),n).forEach(([h,p])=>{uO(p,o,h,t)}),o}function uO(e,t,n,o){e.forEach(u=>{if(typeof u=="string"){const h=u===""?t:v4(t,u);h.classGroupId=n;return}if(typeof u=="function"){if(wre(u)){uO(u(o),t,n,o);return}t.validators.push({validator:u,classGroupId:n});return}Object.entries(u).forEach(([h,p])=>{uO(p,v4(t,h),n,o)})})}function v4(e,t){let n=e;return t.split(pk).forEach(o=>{n.nextPart.has(o)||n.nextPart.set(o,{nextPart:new Map,validators:[]}),n=n.nextPart.get(o)}),n}function wre(e){return e.isThemeGetter}function Sre(e,t){return t?e.map(([n,o])=>{const u=o.map(h=>typeof h=="string"?t+h:typeof h=="object"?Object.fromEntries(Object.entries(h).map(([p,_])=>[t+p,_])):h);return[n,u]}):e}function Tre(e){if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,o=new Map;function u(h,p){n.set(h,p),t++,t>e&&(t=0,o=n,n=new Map)}return{get(h){let p=n.get(h);if(p!==void 0)return p;if((p=o.get(h))!==void 0)return u(h,p),p},set(h,p){n.has(h)?n.set(h,p):u(h,p)}}}const TG="!";function Ere(e){const{separator:t,experimentalParseClassName:n}=e,o=t.length===1,u=t[0],h=t.length;function p(_){const a=[];let b=0,C=0,A;for(let U=0;U<_.length;U++){let j=_[U];if(b===0){if(j===u&&(o||_.slice(U,U+h)===t)){a.push(_.slice(C,U)),C=U+h;continue}if(j==="/"){A=U;continue}}j==="["?b++:j==="]"&&b--}const O=a.length===0?_:_.substring(C),k=O.startsWith(TG),N=k?O.substring(1):O,z=A&&A>C?A-C:void 0;return{modifiers:a,hasImportantModifier:k,baseClassName:N,maybePostfixModifierPosition:z}}return n?function(a){return n({className:a,parseClassName:p})}:p}function Are(e){if(e.length<=1)return e;const t=[];let n=[];return e.forEach(o=>{o[0]==="["?(t.push(...n.sort(),o),n=[]):n.push(o)}),t.push(...n.sort()),t}function Cre(e){return{cache:Tre(e.cacheSize),parseClassName:Ere(e),...vre(e)}}const Pre=/\s+/;function Mre(e,t){const{parseClassName:n,getClassGroupId:o,getConflictingClassGroupIds:u}=t,h=new Set;return e.trim().split(Pre).map(p=>{const{modifiers:_,hasImportantModifier:a,baseClassName:b,maybePostfixModifierPosition:C}=n(p);let A=!!C,O=o(A?b.substring(0,C):b);if(!O){if(!A)return{isTailwindClass:!1,originalClassName:p};if(O=o(b),!O)return{isTailwindClass:!1,originalClassName:p};A=!1}const k=Are(_).join(":");return{isTailwindClass:!0,modifierId:a?k+TG:k,classGroupId:O,originalClassName:p,hasPostfixModifier:A}}).reverse().filter(p=>{if(!p.isTailwindClass)return!0;const{modifierId:_,classGroupId:a,hasPostfixModifier:b}=p,C=_+a;return h.has(C)?!1:(h.add(C),u(a,b).forEach(A=>h.add(_+A)),!0)}).reverse().map(p=>p.originalClassName).join(" ")}function Ire(){let e=0,t,n,o="";for(;e<arguments.length;)(t=arguments[e++])&&(n=EG(t))&&(o&&(o+=" "),o+=n);return o}function EG(e){if(typeof e=="string")return e;let t,n="";for(let o=0;o<e.length;o++)e[o]&&(t=EG(e[o]))&&(n&&(n+=" "),n+=t);return n}function Ore(e,...t){let n,o,u,h=p;function p(a){const b=t.reduce((C,A)=>A(C),e());return n=Cre(b),o=n.cache.get,u=n.cache.set,h=_,_(a)}function _(a){const b=o(a);if(b)return b;const C=Mre(a,n);return u(a,C),C}return function(){return h(Ire.apply(null,arguments))}}function ai(e){const t=n=>n[e]||[];return t.isThemeGetter=!0,t}const AG=/^\[(?:([a-z-]+):)?(.+)\]$/i,Rre=/^\d+\/\d+$/,kre=new Set(["px","full","screen"]),Dre=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lre=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,zre=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Fre=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Nre=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function Tu(e){return _d(e)||kre.has(e)||Rre.test(e)}function lh(e){return Vg(e,"length",Hre)}function _d(e){return!!e&&!Number.isNaN(Number(e))}function sw(e){return Vg(e,"number",_d)}function pv(e){return!!e&&Number.isInteger(Number(e))}function Bre(e){return e.endsWith("%")&&_d(e.slice(0,-1))}function ar(e){return AG.test(e)}function uh(e){return Dre.test(e)}const jre=new Set(["length","size","percentage"]);function $re(e){return Vg(e,jre,CG)}function Ure(e){return Vg(e,"position",CG)}const Vre=new Set(["image","url"]);function Gre(e){return Vg(e,Vre,Zre)}function Wre(e){return Vg(e,"",qre)}function mv(){return!0}function Vg(e,t,n){const o=AG.exec(e);return o?o[1]?typeof t=="string"?o[1]===t:t.has(o[1]):n(o[2]):!1}function Hre(e){return Lre.test(e)&&!zre.test(e)}function CG(){return!1}function qre(e){return Fre.test(e)}function Zre(e){return Nre.test(e)}function Xre(){const e=ai("colors"),t=ai("spacing"),n=ai("blur"),o=ai("brightness"),u=ai("borderColor"),h=ai("borderRadius"),p=ai("borderSpacing"),_=ai("borderWidth"),a=ai("contrast"),b=ai("grayscale"),C=ai("hueRotate"),A=ai("invert"),O=ai("gap"),k=ai("gradientColorStops"),N=ai("gradientColorStopPositions"),z=ai("inset"),U=ai("margin"),j=ai("opacity"),G=ai("padding"),H=ai("saturate"),Y=ai("scale"),K=ai("sepia"),ee=ai("skew"),ue=ai("space"),ve=ai("translate"),Fe=()=>["auto","contain","none"],Ne=()=>["auto","hidden","clip","visible","scroll"],Oe=()=>["auto",ar,t],Le=()=>[ar,t],Ue=()=>["",Tu,lh],et=()=>["auto",_d,ar],rt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],st=()=>["solid","dashed","dotted","double","none"],Ke=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ze=()=>["start","end","center","between","around","evenly","stretch"],Xe=()=>["","0",ar],de=()=>["auto","avoid","all","avoid-page","page","left","right","column"],lt=()=>[_d,sw],gt=()=>[_d,ar];return{cacheSize:500,separator:":",theme:{colors:[mv],spacing:[Tu,lh],blur:["none","",uh,ar],brightness:lt(),borderColor:[e],borderRadius:["none","","full",uh,ar],borderSpacing:Le(),borderWidth:Ue(),contrast:lt(),grayscale:Xe(),hueRotate:gt(),invert:Xe(),gap:Le(),gradientColorStops:[e],gradientColorStopPositions:[Bre,lh],inset:Oe(),margin:Oe(),opacity:lt(),padding:Le(),saturate:lt(),scale:lt(),sepia:Xe(),skew:gt(),space:Le(),translate:Le()},classGroups:{aspect:[{aspect:["auto","square","video",ar]}],container:["container"],columns:[{columns:[uh]}],"break-after":[{"break-after":de()}],"break-before":[{"break-before":de()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...rt(),ar]}],overflow:[{overflow:Ne()}],"overflow-x":[{"overflow-x":Ne()}],"overflow-y":[{"overflow-y":Ne()}],overscroll:[{overscroll:Fe()}],"overscroll-x":[{"overscroll-x":Fe()}],"overscroll-y":[{"overscroll-y":Fe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[z]}],"inset-x":[{"inset-x":[z]}],"inset-y":[{"inset-y":[z]}],start:[{start:[z]}],end:[{end:[z]}],top:[{top:[z]}],right:[{right:[z]}],bottom:[{bottom:[z]}],left:[{left:[z]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",pv,ar]}],basis:[{basis:Oe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ar]}],grow:[{grow:Xe()}],shrink:[{shrink:Xe()}],order:[{order:["first","last","none",pv,ar]}],"grid-cols":[{"grid-cols":[mv]}],"col-start-end":[{col:["auto",{span:["full",pv,ar]},ar]}],"col-start":[{"col-start":et()}],"col-end":[{"col-end":et()}],"grid-rows":[{"grid-rows":[mv]}],"row-start-end":[{row:["auto",{span:[pv,ar]},ar]}],"row-start":[{"row-start":et()}],"row-end":[{"row-end":et()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ar]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ar]}],gap:[{gap:[O]}],"gap-x":[{"gap-x":[O]}],"gap-y":[{"gap-y":[O]}],"justify-content":[{justify:["normal",...Ze()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ze(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ze(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[G]}],px:[{px:[G]}],py:[{py:[G]}],ps:[{ps:[G]}],pe:[{pe:[G]}],pt:[{pt:[G]}],pr:[{pr:[G]}],pb:[{pb:[G]}],pl:[{pl:[G]}],m:[{m:[U]}],mx:[{mx:[U]}],my:[{my:[U]}],ms:[{ms:[U]}],me:[{me:[U]}],mt:[{mt:[U]}],mr:[{mr:[U]}],mb:[{mb:[U]}],ml:[{ml:[U]}],"space-x":[{"space-x":[ue]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ue]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ar,t]}],"min-w":[{"min-w":[ar,t,"min","max","fit"]}],"max-w":[{"max-w":[ar,t,"none","full","min","max","fit","prose",{screen:[uh]},uh]}],h:[{h:[ar,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ar,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ar,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ar,t,"auto","min","max","fit"]}],"font-size":[{text:["base",uh,lh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",sw]}],"font-family":[{font:[mv]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ar]}],"line-clamp":[{"line-clamp":["none",_d,sw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Tu,ar]}],"list-image":[{"list-image":["none",ar]}],"list-style-type":[{list:["none","disc","decimal",ar]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[j]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[j]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...st(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Tu,lh]}],"underline-offset":[{"underline-offset":["auto",Tu,ar]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Le()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ar]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ar]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[j]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...rt(),Ure]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",$re]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Gre]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[k]}],"gradient-via":[{via:[k]}],"gradient-to":[{to:[k]}],rounded:[{rounded:[h]}],"rounded-s":[{"rounded-s":[h]}],"rounded-e":[{"rounded-e":[h]}],"rounded-t":[{"rounded-t":[h]}],"rounded-r":[{"rounded-r":[h]}],"rounded-b":[{"rounded-b":[h]}],"rounded-l":[{"rounded-l":[h]}],"rounded-ss":[{"rounded-ss":[h]}],"rounded-se":[{"rounded-se":[h]}],"rounded-ee":[{"rounded-ee":[h]}],"rounded-es":[{"rounded-es":[h]}],"rounded-tl":[{"rounded-tl":[h]}],"rounded-tr":[{"rounded-tr":[h]}],"rounded-br":[{"rounded-br":[h]}],"rounded-bl":[{"rounded-bl":[h]}],"border-w":[{border:[_]}],"border-w-x":[{"border-x":[_]}],"border-w-y":[{"border-y":[_]}],"border-w-s":[{"border-s":[_]}],"border-w-e":[{"border-e":[_]}],"border-w-t":[{"border-t":[_]}],"border-w-r":[{"border-r":[_]}],"border-w-b":[{"border-b":[_]}],"border-w-l":[{"border-l":[_]}],"border-opacity":[{"border-opacity":[j]}],"border-style":[{border:[...st(),"hidden"]}],"divide-x":[{"divide-x":[_]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[_]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[j]}],"divide-style":[{divide:st()}],"border-color":[{border:[u]}],"border-color-x":[{"border-x":[u]}],"border-color-y":[{"border-y":[u]}],"border-color-t":[{"border-t":[u]}],"border-color-r":[{"border-r":[u]}],"border-color-b":[{"border-b":[u]}],"border-color-l":[{"border-l":[u]}],"divide-color":[{divide:[u]}],"outline-style":[{outline:["",...st()]}],"outline-offset":[{"outline-offset":[Tu,ar]}],"outline-w":[{outline:[Tu,lh]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[j]}],"ring-offset-w":[{"ring-offset":[Tu,lh]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",uh,Wre]}],"shadow-color":[{shadow:[mv]}],opacity:[{opacity:[j]}],"mix-blend":[{"mix-blend":[...Ke(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Ke()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[o]}],contrast:[{contrast:[a]}],"drop-shadow":[{"drop-shadow":["","none",uh,ar]}],grayscale:[{grayscale:[b]}],"hue-rotate":[{"hue-rotate":[C]}],invert:[{invert:[A]}],saturate:[{saturate:[H]}],sepia:[{sepia:[K]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[a]}],"backdrop-grayscale":[{"backdrop-grayscale":[b]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[C]}],"backdrop-invert":[{"backdrop-invert":[A]}],"backdrop-opacity":[{"backdrop-opacity":[j]}],"backdrop-saturate":[{"backdrop-saturate":[H]}],"backdrop-sepia":[{"backdrop-sepia":[K]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[p]}],"border-spacing-x":[{"border-spacing-x":[p]}],"border-spacing-y":[{"border-spacing-y":[p]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ar]}],duration:[{duration:gt()}],ease:[{ease:["linear","in","out","in-out",ar]}],delay:[{delay:gt()}],animate:[{animate:["none","spin","ping","pulse","bounce",ar]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Y]}],"scale-x":[{"scale-x":[Y]}],"scale-y":[{"scale-y":[Y]}],rotate:[{rotate:[pv,ar]}],"translate-x":[{"translate-x":[ve]}],"translate-y":[{"translate-y":[ve]}],"skew-x":[{"skew-x":[ee]}],"skew-y":[{"skew-y":[ee]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ar]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ar]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Le()}],"scroll-mx":[{"scroll-mx":Le()}],"scroll-my":[{"scroll-my":Le()}],"scroll-ms":[{"scroll-ms":Le()}],"scroll-me":[{"scroll-me":Le()}],"scroll-mt":[{"scroll-mt":Le()}],"scroll-mr":[{"scroll-mr":Le()}],"scroll-mb":[{"scroll-mb":Le()}],"scroll-ml":[{"scroll-ml":Le()}],"scroll-p":[{"scroll-p":Le()}],"scroll-px":[{"scroll-px":Le()}],"scroll-py":[{"scroll-py":Le()}],"scroll-ps":[{"scroll-ps":Le()}],"scroll-pe":[{"scroll-pe":Le()}],"scroll-pt":[{"scroll-pt":Le()}],"scroll-pr":[{"scroll-pr":Le()}],"scroll-pb":[{"scroll-pb":Le()}],"scroll-pl":[{"scroll-pl":Le()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ar]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Tu,lh,sw]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const Yre=Ore(Xre);/*! js-cookie v3.0.5 | MIT */function lw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}var Kre={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function cO(e,t){function n(u,h,p){if(!(typeof document>"u")){p=lw({},t,p),typeof p.expires=="number"&&(p.expires=new Date(Date.now()+p.expires*864e5)),p.expires&&(p.expires=p.expires.toUTCString()),u=encodeURIComponent(u).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var _="";for(var a in p)p[a]&&(_+="; "+a,p[a]!==!0&&(_+="="+p[a].split(";")[0]));return document.cookie=u+"="+e.write(h,u)+_}}function o(u){if(!(typeof document>"u"||arguments.length&&!u)){for(var h=document.cookie?document.cookie.split("; "):[],p={},_=0;_<h.length;_++){var a=h[_].split("="),b=a.slice(1).join("=");try{var C=decodeURIComponent(a[0]);if(p[C]=e.read(b,C),u===C)break}catch{}}return u?p[u]:p}}return Object.create({set:n,get:o,remove:function(u,h){n(u,"",lw({},h,{expires:-1}))},withAttributes:function(u){return cO(this.converter,lw({},this.attributes,u))},withConverter:function(u){return cO(lw({},this.converter,u),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}cO(Kre,{path:"/"});class Qre extends Error{}Qre.prototype.name="InvalidTokenError";function wn(...e){return Yre(Cr(e))}function mk(e){const t=new Map,n=function(o){return(t.has(o)||t.set(o,e.call(this,o)))&&t.get(o)};return n.cache=t,n}const x4=(e,t,n)=>Math.min(Math.max(e,t),n),b4=(e,t,n,o,u)=>(e-t)*(u-o)/(n-t)+o;Cd.accessToken="pk.eyJ1IjoiYmhhdmppdGNoYXVoYW4iLCJhIjoiY2x5MG95ejEzMGhuMDJtb2tvb3RpZHMyMiJ9.fJafGFJkITooEewonltjGw";const w4=.2,Jre=5,uw=300;function PG({regions:e,latencies:t,location:n}){const o=W.useRef(null),u=W.useRef(null),h=W.useRef([]),[p,_]=W.useState(!1),[a,b]=W.useState(!1),[C,A]=W.useState(!1),[O,k]=W.useState(!1),[N,z]=W.useState(0),[U,j]=W.useState(90),G=W.useMemo(()=>new Cd.GeolocateControl({fitBoundsOptions:{maxZoom:1.7}}),[]);return G.on("geolocate",H=>{const{coords:Y}=H;z(Y.longitude),j(Y.latitude),_(!0)}),W.useEffect(()=>{u.current||(u.current=new Cd.Map({container:o.current,style:"mapbox://styles/bhavjitchauhan/cly0qsii4005201oecij7b5na",center:[N,U],zoom:w4,minZoom:1,maxZoom:Jre}),u.current.addControl(G,"bottom-left"),u.current.on("load",()=>{b(!0)}))}),W.useEffect(()=>{G.trigger()},[G,a]),W.useEffect(()=>{C||e.length&&(h.current=eie(e,u.current),A(!0))},[C,e]),W.useEffect(()=>{O||p&&e.length&&(S4(e,{longitude:N,latitude:U},u.current),k(!0))},[O,p,e,N,U]),W.useEffect(()=>{a&&(n.latitude&&n.longitude?(u.current.flyTo({center:[n.longitude,n.latitude],zoom:w4}),z(n.longitude),j(n.latitude)):G.trigger(),tie(h.current,e))},[a,n,G]),W.useEffect(()=>{if(a&&C&&O){h.current.forEach((H,Y)=>{var ue;const ee=e[Y].selected?"#9747ff":"#eee";(ue=H.getElement().querySelectorAll('svg path[fill="'+H._color+'"]')[0])==null||ue.setAttribute("fill",ee),H._color=ee});for(const H of e)u.current.setLayoutProperty(H.code,"visibility",H.selected?"visible":"none")}},[e]),W.useEffect(()=>{rie(e,u.current),S4(e,{longitude:N,latitude:U},u.current)},[N,U]),W.useEffect(()=>{if(a&&!(!C&&!O))for(const H of t){if(H.latency===1/0)continue;const Y=`hsl(${b4(x4(H.latency,0,uw),0,uw,120,0)}, 100%, 75%)`,K=b4(x4(H.latency,0,uw),0,uw,3,.5);if(C){const ee=h.current.find(ue=>ue.region===H.region);if(ee){const ue=e.find(ve=>ve.code===H.region).name;ee.setPopup(new Cd.Popup().setHTML(`${ue} <span class="text-gray-500">(${H.latency.toFixed(2)}ms)</span>`))}}O&&(u.current.setPaintProperty(H.region,"line-color",Y),u.current.setPaintProperty(H.region,"line-width",K),u.current.setPaintProperty(H.region,"line-dasharray",[]))}},[t,a,C,O]),re.jsx("div",{ref:o,className:"h-full map-container"})}PG.propTypes={regions:En.array.isRequired,latencies:En.array.isRequired,location:En.object};function eie(e,t){return e.map(n=>{const{name:o,selected:u,longitude:h,latitude:p}=n,_=new Cd.Marker({color:u?"#9747ff":"#eee"}).setLngLat([h,p]).setPopup(new Cd.Popup().setHTML(o)).addTo(t);return _.region=n.code,_})}function tie(e,t){e.forEach(n=>{const o=t.find(u=>u.code===n.region).name;n.setPopup(new Cd.Popup().setHTML(o))})}function nie(e,t){return e.map(n=>{let o=t.longitude;return Math.abs(t.longitude-n.longitude)>180&&(o+=360),{type:"Feature",geometry:{type:"LineString",coordinates:[[o,t.latitude],[n.longitude,n.latitude]]},properties:{region:n.code,selected:n.selected}}})}function S4(e,t,n){for(const o of nie(e,t))n.addSource(o.properties.region,{type:"geojson",data:o}),n.addLayer({id:o.properties.region,source:o.properties.region,type:"line",paint:{"line-color":"#888","line-width":1,"line-dasharray":[4,4]},layout:{visibility:o.properties.selected?"visible":"none"}})}function rie(e,t){for(const n of e)try{t.removeLayer(n.code),t.removeSource(n.code)}catch{}}function iie(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function gk(...e){return t=>e.forEach(n=>iie(n,t))}function Fr(...e){return W.useCallback(gk(...e),e)}var Wu=W.forwardRef((e,t)=>{const{children:n,...o}=e,u=W.Children.toArray(n),h=u.find(aie);if(h){const p=h.props.children,_=u.map(a=>a===h?W.Children.count(p)>1?W.Children.only(null):W.isValidElement(p)?p.props.children:null:a);return re.jsx(hO,{...o,ref:t,children:W.isValidElement(p)?W.cloneElement(p,void 0,_):null})}return re.jsx(hO,{...o,ref:t,children:n})});Wu.displayName="Slot";var hO=W.forwardRef((e,t)=>{const{children:n,...o}=e;if(W.isValidElement(n)){const u=lie(n);return W.cloneElement(n,{...sie(o,n.props),ref:t?gk(t,u):u})}return W.Children.count(n)>1?W.Children.only(null):null});hO.displayName="SlotClone";var oie=({children:e})=>re.jsx(re.Fragment,{children:e});function aie(e){return W.isValidElement(e)&&e.type===oie}function sie(e,t){const n={...t};for(const o in t){const u=e[o],h=t[o];/^on[A-Z]/.test(o)?u&&h?n[o]=(..._)=>{h(..._),u(..._)}:u&&(n[o]=u):o==="style"?n[o]={...u,...h}:o==="className"&&(n[o]=[u,h].filter(Boolean).join(" "))}return{...e,...n}}function lie(e){var o,u;let t=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(u=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:u.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}const T4=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,E4=Cr,uie=(e,t)=>n=>{var o;if((t==null?void 0:t.variants)==null)return E4(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:u,defaultVariants:h}=t,p=Object.keys(u).map(b=>{const C=n==null?void 0:n[b],A=h==null?void 0:h[b];if(C===null)return null;const O=T4(C)||T4(A);return u[b][O]}),_=n&&Object.entries(n).reduce((b,C)=>{let[A,O]=C;return O===void 0||(b[A]=O),b},{}),a=t==null||(o=t.compoundVariants)===null||o===void 0?void 0:o.reduce((b,C)=>{let{class:A,className:O,...k}=C;return Object.entries(k).every(N=>{let[z,U]=N;return Array.isArray(U)?U.includes({...h,..._}[z]):{...h,..._}[z]===U})?[...b,A,O]:b},[]);return E4(e,p,a,n==null?void 0:n.class,n==null?void 0:n.className)},cie=uie("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10 rounded-full"}},defaultVariants:{variant:"default",size:"default"}}),dg=W.forwardRef(({className:e,variant:t,size:n,asChild:o=!1,...u},h)=>{const p=o?Wu:"button";return re.jsx(p,{className:wn(cie({variant:t,size:n,className:e})),ref:h,...u})});dg.displayName="Button";const oE=W.forwardRef(({className:e,...t},n)=>re.jsx("div",{ref:n,className:wn("rounded-lg border bg-card text-card-foreground shadow-sm pl-3 pr-3",e),...t}));oE.displayName="Card";const aE=W.forwardRef(({className:e,...t},n)=>re.jsx("div",{ref:n,className:wn("flex flex-col space-y-1 p-6",e),...t}));aE.displayName="CardHeader";const qv=W.forwardRef(({className:e,...t},n)=>re.jsx("h3",{ref:n,className:wn("text-lg font-semibold leading-none text-customPurple tracking-tight pb-2",e),...t}));qv.displayName="CardTitle";const yk=W.forwardRef(({className:e,...t},n)=>re.jsx("p",{ref:n,className:wn("text-sm font-normal text-customMauve",e),...t}));yk.displayName="CardDescription";const sE=W.forwardRef(({className:e,...t},n)=>re.jsx("div",{ref:n,className:wn("p-6 pt-0 -mt-3",e),...t}));sE.displayName="CardContent";const hie=W.forwardRef(({className:e,...t},n)=>re.jsx("div",{ref:n,className:wn("flex items-center p-6 pt-0",e),...t}));hie.displayName="CardFooter";const MS=W.forwardRef(({className:e,type:t,...n},o)=>re.jsx("input",{type:t,className:wn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:o,...n}));MS.displayName="Input";function fie(e,t){const n=W.createContext(t);function o(h){const{children:p,..._}=h,a=W.useMemo(()=>_,Object.values(_));return re.jsx(n.Provider,{value:a,children:p})}function u(h){const p=W.useContext(n);if(p)return p;if(t!==void 0)return t;throw new Error(`\`${h}\` must be used within \`${e}\``)}return o.displayName=e+"Provider",[o,u]}function tc(e,t=[]){let n=[];function o(h,p){const _=W.createContext(p),a=n.length;n=[...n,p];function b(A){const{scope:O,children:k,...N}=A,z=(O==null?void 0:O[e][a])||_,U=W.useMemo(()=>N,Object.values(N));return re.jsx(z.Provider,{value:U,children:k})}function C(A,O){const k=(O==null?void 0:O[e][a])||_,N=W.useContext(k);if(N)return N;if(p!==void 0)return p;throw new Error(`\`${A}\` must be used within \`${h}\``)}return b.displayName=h+"Provider",[b,C]}const u=()=>{const h=n.map(p=>W.createContext(p));return function(_){const a=(_==null?void 0:_[e])||h;return W.useMemo(()=>({[`__scope${e}`]:{..._,[e]:a}}),[_,a])}};return u.scopeName=e,[o,die(u,...t)]}function die(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const o=e.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(h){const p=o.reduce((_,{useScope:a,scopeName:b})=>{const A=a(h)[`__scope${b}`];return{..._,...A}},{});return W.useMemo(()=>({[`__scope${t.scopeName}`]:p}),[p])}};return n.scopeName=t.scopeName,n}function hn(e,t,{checkForDefaultPrevented:n=!0}={}){return function(u){if(e==null||e(u),n===!1||!u.defaultPrevented)return t==null?void 0:t(u)}}function Ss(e){const t=W.useRef(e);return W.useEffect(()=>{t.current=e}),W.useMemo(()=>(...n)=>{var o;return(o=t.current)==null?void 0:o.call(t,...n)},[])}function pg({prop:e,defaultProp:t,onChange:n=()=>{}}){const[o,u]=pie({defaultProp:t,onChange:n}),h=e!==void 0,p=h?e:o,_=Ss(n),a=W.useCallback(b=>{if(h){const A=typeof b=="function"?b(e):b;A!==e&&_(A)}else u(b)},[h,e,u,_]);return[p,a]}function pie({defaultProp:e,onChange:t}){const n=W.useState(e),[o]=n,u=W.useRef(o),h=Ss(t);return W.useEffect(()=>{u.current!==o&&(h(o),u.current=o)},[o,u,h]),n}function MG(e){const t=W.useRef({value:e,previous:e});return W.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Xo=globalThis!=null&&globalThis.document?W.useLayoutEffect:()=>{};function IG(e){const[t,n]=W.useState(void 0);return Xo(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const o=new ResizeObserver(u=>{if(!Array.isArray(u)||!u.length)return;const h=u[0];let p,_;if("borderBoxSize"in h){const a=h.borderBoxSize,b=Array.isArray(a)?a[0]:a;p=b.inlineSize,_=b.blockSize}else p=e.offsetWidth,_=e.offsetHeight;n({width:p,height:_})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}else n(void 0)},[e]),t}function mie(e,t){return W.useReducer((n,o)=>t[n][o]??n,e)}var al=e=>{const{present:t,children:n}=e,o=gie(t),u=typeof n=="function"?n({present:o.isPresent}):W.Children.only(n),h=Fr(o.ref,yie(u));return typeof n=="function"||o.isPresent?W.cloneElement(u,{ref:h}):null};al.displayName="Presence";function gie(e){const[t,n]=W.useState(),o=W.useRef({}),u=W.useRef(e),h=W.useRef("none"),p=e?"mounted":"unmounted",[_,a]=mie(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const b=cw(o.current);h.current=_==="mounted"?b:"none"},[_]),Xo(()=>{const b=o.current,C=u.current;if(C!==e){const O=h.current,k=cw(b);e?a("MOUNT"):k==="none"||(b==null?void 0:b.display)==="none"?a("UNMOUNT"):a(C&&O!==k?"ANIMATION_OUT":"UNMOUNT"),u.current=e}},[e,a]),Xo(()=>{if(t){const b=A=>{const k=cw(o.current).includes(A.animationName);A.target===t&&k&&ec.flushSync(()=>a("ANIMATION_END"))},C=A=>{A.target===t&&(h.current=cw(o.current))};return t.addEventListener("animationstart",C),t.addEventListener("animationcancel",b),t.addEventListener("animationend",b),()=>{t.removeEventListener("animationstart",C),t.removeEventListener("animationcancel",b),t.removeEventListener("animationend",b)}}else a("ANIMATION_END")},[t,a]),{isPresent:["mounted","unmountSuspended"].includes(_),ref:W.useCallback(b=>{b&&(o.current=getComputedStyle(b)),n(b)},[])}}function cw(e){return(e==null?void 0:e.animationName)||"none"}function yie(e){var o,u;let t=(o=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(u=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:u.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var _ie=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],fr=_ie.reduce((e,t)=>{const n=W.forwardRef((o,u)=>{const{asChild:h,...p}=o,_=h?Wu:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),re.jsx(_,{...p,ref:u})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function OG(e,t){e&&ec.flushSync(()=>e.dispatchEvent(t))}var _k="Checkbox",[vie,gje]=tc(_k),[xie,bie]=vie(_k),RG=W.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:o,checked:u,defaultChecked:h,required:p,disabled:_,value:a="on",onCheckedChange:b,...C}=e,[A,O]=W.useState(null),k=Fr(t,H=>O(H)),N=W.useRef(!1),z=A?!!A.closest("form"):!0,[U=!1,j]=pg({prop:u,defaultProp:h,onChange:b}),G=W.useRef(U);return W.useEffect(()=>{const H=A==null?void 0:A.form;if(H){const Y=()=>j(G.current);return H.addEventListener("reset",Y),()=>H.removeEventListener("reset",Y)}},[A,j]),re.jsxs(xie,{scope:n,state:U,disabled:_,children:[re.jsx(fr.button,{type:"button",role:"checkbox","aria-checked":Pd(U)?"mixed":U,"aria-required":p,"data-state":LG(U),"data-disabled":_?"":void 0,disabled:_,value:a,...C,ref:k,onKeyDown:hn(e.onKeyDown,H=>{H.key==="Enter"&&H.preventDefault()}),onClick:hn(e.onClick,H=>{j(Y=>Pd(Y)?!0:!Y),z&&(N.current=H.isPropagationStopped(),N.current||H.stopPropagation())})}),z&&re.jsx(wie,{control:A,bubbles:!N.current,name:o,value:a,checked:U,required:p,disabled:_,style:{transform:"translateX(-100%)"}})]})});RG.displayName=_k;var kG="CheckboxIndicator",DG=W.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:o,...u}=e,h=bie(kG,n);return re.jsx(al,{present:o||Pd(h.state)||h.state===!0,children:re.jsx(fr.span,{"data-state":LG(h.state),"data-disabled":h.disabled?"":void 0,...u,ref:t,style:{pointerEvents:"none",...e.style}})})});DG.displayName=kG;var wie=e=>{const{control:t,checked:n,bubbles:o=!0,...u}=e,h=W.useRef(null),p=MG(n),_=IG(t);return W.useEffect(()=>{const a=h.current,b=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(b,"checked").set;if(p!==n&&A){const O=new Event("click",{bubbles:o});a.indeterminate=Pd(n),A.call(a,Pd(n)?!1:n),a.dispatchEvent(O)}},[p,n,o]),re.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:Pd(n)?!1:n,...u,tabIndex:-1,ref:h,style:{...e.style,..._,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Pd(e){return e==="indeterminate"}function LG(e){return Pd(e)?"indeterminate":e?"checked":"unchecked"}var zG=RG,Sie=DG;/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tie=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),FG=(...e)=>e.filter((t,n,o)=>!!t&&o.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Eie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aie=W.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:u="",children:h,iconNode:p,..._},a)=>W.createElement("svg",{ref:a,...Eie,width:t,height:t,stroke:e,strokeWidth:o?Number(n)*24/Number(t):n,className:FG("lucide",u),..._},[...p.map(([b,C])=>W.createElement(b,C)),...Array.isArray(h)?h:[h]]));/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=(e,t)=>{const n=W.forwardRef(({className:o,...u},h)=>W.createElement(Aie,{ref:h,iconNode:t,className:FG(`lucide-${Tie(e)}`,o),...u}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cie=qa("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pie=qa("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mie=qa("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iie=qa("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oie=qa("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=qa("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NG=qa("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rie=qa("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kie=qa("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Die=qa("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lie=qa("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zie=qa("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fie=qa("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),uE=W.forwardRef(({className:e,...t},n)=>re.jsx(zG,{ref:n,className:wn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:re.jsx(Sie,{className:wn("flex items-center justify-center text-current"),children:re.jsx(lE,{className:"w-4 h-4"})})}));uE.displayName=zG.displayName;var A4=1,Nie=.9,Bie=.8,jie=.17,nM=.1,rM=.999,$ie=.9999,Uie=.99,Vie=/[\\\/_+.#"@\[\(\{&]/,Gie=/[\\\/_+.#"@\[\(\{&]/g,Wie=/[\s-]/,BG=/[\s-]/g;function fO(e,t,n,o,u,h,p){if(h===t.length)return u===e.length?A4:Uie;var _=`${u},${h}`;if(p[_]!==void 0)return p[_];for(var a=o.charAt(h),b=n.indexOf(a,u),C=0,A,O,k,N;b>=0;)A=fO(e,t,n,o,b+1,h+1,p),A>C&&(b===u?A*=A4:Vie.test(e.charAt(b-1))?(A*=Bie,k=e.slice(u,b-1).match(Gie),k&&u>0&&(A*=Math.pow(rM,k.length))):Wie.test(e.charAt(b-1))?(A*=Nie,N=e.slice(u,b-1).match(BG),N&&u>0&&(A*=Math.pow(rM,N.length))):(A*=jie,u>0&&(A*=Math.pow(rM,b-u))),e.charAt(b)!==t.charAt(h)&&(A*=$ie)),(A<nM&&n.charAt(b-1)===o.charAt(h+1)||o.charAt(h+1)===o.charAt(h)&&n.charAt(b-1)!==o.charAt(h))&&(O=fO(e,t,n,o,b+1,h+2,p),O*nM>A&&(A=O*nM)),A>C&&(C=A),b=n.indexOf(a,b+1);return p[_]=C,C}function C4(e){return e.toLowerCase().replace(BG," ")}function Hie(e,t){return fO(e,t,C4(e),C4(t),0,0,{})}function Yo(){return Yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Yo.apply(null,arguments)}function Ym(e,t,{checkForDefaultPrevented:n=!0}={}){return function(u){if(e==null||e(u),n===!1||!u.defaultPrevented)return t==null?void 0:t(u)}}function qie(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function jG(...e){return t=>e.forEach(n=>qie(n,t))}function _x(...e){return W.useCallback(jG(...e),e)}function Zie(e,t=[]){let n=[];function o(h,p){const _=W.createContext(p),a=n.length;n=[...n,p];function b(A){const{scope:O,children:k,...N}=A,z=(O==null?void 0:O[e][a])||_,U=W.useMemo(()=>N,Object.values(N));return W.createElement(z.Provider,{value:U},k)}function C(A,O){const k=(O==null?void 0:O[e][a])||_,N=W.useContext(k);if(N)return N;if(p!==void 0)return p;throw new Error(`\`${A}\` must be used within \`${h}\``)}return b.displayName=h+"Provider",[b,C]}const u=()=>{const h=n.map(p=>W.createContext(p));return function(_){const a=(_==null?void 0:_[e])||h;return W.useMemo(()=>({[`__scope${e}`]:{..._,[e]:a}}),[_,a])}};return u.scopeName=e,[o,Xie(u,...t)]}function Xie(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const o=e.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(h){const p=o.reduce((_,{useScope:a,scopeName:b})=>{const A=a(h)[`__scope${b}`];return{..._,...A}},{});return W.useMemo(()=>({[`__scope${t.scopeName}`]:p}),[p])}};return n.scopeName=t.scopeName,n}const dO=globalThis!=null&&globalThis.document?W.useLayoutEffect:()=>{},Yie=bR.useId||(()=>{});let Kie=0;function iM(e){const[t,n]=W.useState(Yie());return dO(()=>{e||n(o=>o??String(Kie++))},[e]),e||(t?`radix-${t}`:"")}function zd(e){const t=W.useRef(e);return W.useEffect(()=>{t.current=e}),W.useMemo(()=>(...n)=>{var o;return(o=t.current)===null||o===void 0?void 0:o.call(t,...n)},[])}function Qie({prop:e,defaultProp:t,onChange:n=()=>{}}){const[o,u]=Jie({defaultProp:t,onChange:n}),h=e!==void 0,p=h?e:o,_=zd(n),a=W.useCallback(b=>{if(h){const A=typeof b=="function"?b(e):b;A!==e&&_(A)}else u(b)},[h,e,u,_]);return[p,a]}function Jie({defaultProp:e,onChange:t}){const n=W.useState(e),[o]=n,u=W.useRef(o),h=zd(t);return W.useEffect(()=>{u.current!==o&&(h(o),u.current=o)},[o,u,h]),n}const vk=W.forwardRef((e,t)=>{const{children:n,...o}=e,u=W.Children.toArray(n),h=u.find(toe);if(h){const p=h.props.children,_=u.map(a=>a===h?W.Children.count(p)>1?W.Children.only(null):W.isValidElement(p)?p.props.children:null:a);return W.createElement(pO,Yo({},o,{ref:t}),W.isValidElement(p)?W.cloneElement(p,void 0,_):null)}return W.createElement(pO,Yo({},o,{ref:t}),n)});vk.displayName="Slot";const pO=W.forwardRef((e,t)=>{const{children:n,...o}=e;return W.isValidElement(n)?W.cloneElement(n,{...noe(o,n.props),ref:jG(t,n.ref)}):W.Children.count(n)>1?W.Children.only(null):null});pO.displayName="SlotClone";const eoe=({children:e})=>W.createElement(W.Fragment,null,e);function toe(e){return W.isValidElement(e)&&e.type===eoe}function noe(e,t){const n={...t};for(const o in t){const u=e[o],h=t[o];/^on[A-Z]/.test(o)?n[o]=(..._)=>{h==null||h(..._),u==null||u(..._)}:o==="style"?n[o]={...u,...h}:o==="className"&&(n[o]=[u,h].filter(Boolean).join(" "))}return{...e,...n}}const roe=["a","button","div","h2","h3","img","li","nav","ol","p","span","svg","ul"],cE=roe.reduce((e,t)=>{const n=W.forwardRef((o,u)=>{const{asChild:h,...p}=o,_=h?vk:t;return W.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),W.createElement(_,Yo({},p,{ref:u}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function ioe(e,t){e&&ec.flushSync(()=>e.dispatchEvent(t))}function ooe(e){const t=zd(e);W.useEffect(()=>{const n=o=>{o.key==="Escape"&&t(o)};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t])}const mO="dismissableLayer.update",aoe="dismissableLayer.pointerDownOutside",soe="dismissableLayer.focusOutside";let P4;const loe=W.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),uoe=W.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:_,...a}=e,b=W.useContext(loe),[C,A]=W.useState(null),[,O]=W.useState({}),k=_x(t,ee=>A(ee)),N=Array.from(b.layers),[z]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),U=N.indexOf(z),j=C?N.indexOf(C):-1,G=b.layersWithOutsidePointerEventsDisabled.size>0,H=j>=U,Y=coe(ee=>{const ue=ee.target,ve=[...b.branches].some(Fe=>Fe.contains(ue));!H||ve||(u==null||u(ee),p==null||p(ee),ee.defaultPrevented||_==null||_())}),K=hoe(ee=>{const ue=ee.target;[...b.branches].some(Fe=>Fe.contains(ue))||(h==null||h(ee),p==null||p(ee),ee.defaultPrevented||_==null||_())});return ooe(ee=>{j===b.layers.size-1&&(o==null||o(ee),!ee.defaultPrevented&&_&&(ee.preventDefault(),_()))}),W.useEffect(()=>{if(C)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&(P4=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(C)),b.layers.add(C),M4(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(document.body.style.pointerEvents=P4)}},[C,n,b]),W.useEffect(()=>()=>{C&&(b.layers.delete(C),b.layersWithOutsidePointerEventsDisabled.delete(C),M4())},[C,b]),W.useEffect(()=>{const ee=()=>O({});return document.addEventListener(mO,ee),()=>document.removeEventListener(mO,ee)},[]),W.createElement(cE.div,Yo({},a,{ref:k,style:{pointerEvents:G?H?"auto":"none":void 0,...e.style},onFocusCapture:Ym(e.onFocusCapture,K.onFocusCapture),onBlurCapture:Ym(e.onBlurCapture,K.onBlurCapture),onPointerDownCapture:Ym(e.onPointerDownCapture,Y.onPointerDownCapture)}))});function coe(e){const t=zd(e),n=W.useRef(!1),o=W.useRef(()=>{});return W.useEffect(()=>{const u=p=>{if(p.target&&!n.current){let b=function(){$G(aoe,t,a,{discrete:!0})};var _=b;const a={originalEvent:p};p.pointerType==="touch"?(document.removeEventListener("click",o.current),o.current=b,document.addEventListener("click",o.current,{once:!0})):b()}n.current=!1},h=window.setTimeout(()=>{document.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(h),document.removeEventListener("pointerdown",u),document.removeEventListener("click",o.current)}},[t]),{onPointerDownCapture:()=>n.current=!0}}function hoe(e){const t=zd(e),n=W.useRef(!1);return W.useEffect(()=>{const o=u=>{u.target&&!n.current&&$G(soe,t,{originalEvent:u},{discrete:!1})};return document.addEventListener("focusin",o),()=>document.removeEventListener("focusin",o)},[t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function M4(){const e=new CustomEvent(mO);document.dispatchEvent(e)}function $G(e,t,n,{discrete:o}){const u=n.originalEvent.target,h=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&u.addEventListener(e,t,{once:!0}),o?ioe(u,h):u.dispatchEvent(h)}const oM="focusScope.autoFocusOnMount",aM="focusScope.autoFocusOnUnmount",I4={bubbles:!1,cancelable:!0},foe=W.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:u,onUnmountAutoFocus:h,...p}=e,[_,a]=W.useState(null),b=zd(u),C=zd(h),A=W.useRef(null),O=_x(t,z=>a(z)),k=W.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;W.useEffect(()=>{if(o){let j=function(H){if(k.paused||!_)return;const Y=H.target;_.contains(Y)?A.current=Y:ud(A.current,{select:!0})},G=function(H){k.paused||!_||_.contains(H.relatedTarget)||ud(A.current,{select:!0})};var z=j,U=G;return document.addEventListener("focusin",j),document.addEventListener("focusout",G),()=>{document.removeEventListener("focusin",j),document.removeEventListener("focusout",G)}}},[o,_,k.paused]),W.useEffect(()=>{if(_){R4.add(k);const z=document.activeElement;if(!_.contains(z)){const j=new CustomEvent(oM,I4);_.addEventListener(oM,b),_.dispatchEvent(j),j.defaultPrevented||(doe(_oe(UG(_)),{select:!0}),document.activeElement===z&&ud(_))}return()=>{_.removeEventListener(oM,b),setTimeout(()=>{const j=new CustomEvent(aM,I4);_.addEventListener(aM,C),_.dispatchEvent(j),j.defaultPrevented||ud(z??document.body,{select:!0}),_.removeEventListener(aM,C),R4.remove(k)},0)}}},[_,b,C,k]);const N=W.useCallback(z=>{if(!n&&!o||k.paused)return;const U=z.key==="Tab"&&!z.altKey&&!z.ctrlKey&&!z.metaKey,j=document.activeElement;if(U&&j){const G=z.currentTarget,[H,Y]=poe(G);H&&Y?!z.shiftKey&&j===Y?(z.preventDefault(),n&&ud(H,{select:!0})):z.shiftKey&&j===H&&(z.preventDefault(),n&&ud(Y,{select:!0})):j===G&&z.preventDefault()}},[n,o,k.paused]);return W.createElement(cE.div,Yo({tabIndex:-1},p,{ref:O,onKeyDown:N}))});function doe(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(ud(o,{select:t}),document.activeElement!==n)return}function poe(e){const t=UG(e),n=O4(t,e),o=O4(t.reverse(),e);return[n,o]}function UG(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const u=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||u?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function O4(e,t){for(const n of e)if(!moe(n,{upTo:t}))return n}function moe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function goe(e){return e instanceof HTMLInputElement&&"select"in e}function ud(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&goe(e)&&t&&e.select()}}const R4=yoe();function yoe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=k4(e,t),e.unshift(t)},remove(t){var n;e=k4(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function k4(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function _oe(e){return e.filter(t=>t.tagName!=="A")}const voe=W.forwardRef((e,t)=>{var n;const{container:o=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...u}=e;return o?oG.createPortal(W.createElement(cE.div,Yo({},u,{ref:t})),o):null});function xoe(e,t){return W.useReducer((n,o)=>{const u=t[n][o];return u??n},e)}const hE=e=>{const{present:t,children:n}=e,o=boe(t),u=typeof n=="function"?n({present:o.isPresent}):W.Children.only(n),h=_x(o.ref,u.ref);return typeof n=="function"||o.isPresent?W.cloneElement(u,{ref:h}):null};hE.displayName="Presence";function boe(e){const[t,n]=W.useState(),o=W.useRef({}),u=W.useRef(e),h=W.useRef("none"),p=e?"mounted":"unmounted",[_,a]=xoe(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const b=hw(o.current);h.current=_==="mounted"?b:"none"},[_]),dO(()=>{const b=o.current,C=u.current;if(C!==e){const O=h.current,k=hw(b);e?a("MOUNT"):k==="none"||(b==null?void 0:b.display)==="none"?a("UNMOUNT"):a(C&&O!==k?"ANIMATION_OUT":"UNMOUNT"),u.current=e}},[e,a]),dO(()=>{if(t){const b=A=>{const k=hw(o.current).includes(A.animationName);A.target===t&&k&&ec.flushSync(()=>a("ANIMATION_END"))},C=A=>{A.target===t&&(h.current=hw(o.current))};return t.addEventListener("animationstart",C),t.addEventListener("animationcancel",b),t.addEventListener("animationend",b),()=>{t.removeEventListener("animationstart",C),t.removeEventListener("animationcancel",b),t.removeEventListener("animationend",b)}}else a("ANIMATION_END")},[t,a]),{isPresent:["mounted","unmountSuspended"].includes(_),ref:W.useCallback(b=>{b&&(o.current=getComputedStyle(b)),n(b)},[])}}function hw(e){return(e==null?void 0:e.animationName)||"none"}let sM=0;function woe(){W.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=n[0])!==null&&e!==void 0?e:D4()),document.body.insertAdjacentElement("beforeend",(t=n[1])!==null&&t!==void 0?t:D4()),sM++,()=>{sM===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(o=>o.remove()),sM--}},[])}function D4(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var No=function(){return No=Object.assign||function(t){for(var n,o=1,u=arguments.length;o<u;o++){n=arguments[o];for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&(t[h]=n[h])}return t},No.apply(this,arguments)};function xk(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(e);u<o.length;u++)t.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(e,o[u])&&(n[o[u]]=e[o[u]]);return n}function VG(e,t,n){if(n||arguments.length===2)for(var o=0,u=t.length,h;o<u;o++)(h||!(o in t))&&(h||(h=Array.prototype.slice.call(t,0,o)),h[o]=t[o]);return e.concat(h||Array.prototype.slice.call(t))}var Zv="right-scroll-bar-position",Xv="width-before-scroll-bar",Soe="with-scroll-bars-hidden",Toe="--removed-body-scroll-bar-size";function lM(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Eoe(e,t){var n=W.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(o){var u=n.value;u!==o&&(n.value=o,n.callback(o,u))}}}})[0];return n.callback=t,n.facade}var Aoe=typeof window<"u"?W.useLayoutEffect:W.useEffect,L4=new WeakMap;function GG(e,t){var n=Eoe(null,function(o){return e.forEach(function(u){return lM(u,o)})});return Aoe(function(){var o=L4.get(n);if(o){var u=new Set(o),h=new Set(e),p=n.current;u.forEach(function(_){h.has(_)||lM(_,null)}),h.forEach(function(_){u.has(_)||lM(_,p)})}L4.set(n,e)},[e]),n}function Coe(e){return e}function Poe(e,t){t===void 0&&(t=Coe);var n=[],o=!1,u={read:function(){if(o)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(h){var p=t(h,o);return n.push(p),function(){n=n.filter(function(_){return _!==p})}},assignSyncMedium:function(h){for(o=!0;n.length;){var p=n;n=[],p.forEach(h)}n={push:function(_){return h(_)},filter:function(){return n}}},assignMedium:function(h){o=!0;var p=[];if(n.length){var _=n;n=[],_.forEach(h),p=n}var a=function(){var C=p;p=[],C.forEach(h)},b=function(){return Promise.resolve().then(a)};b(),n={push:function(C){p.push(C),b()},filter:function(C){return p=p.filter(C),n}}}};return u}function WG(e){e===void 0&&(e={});var t=Poe(null);return t.options=No({async:!0,ssr:!1},e),t}var HG=function(e){var t=e.sideCar,n=xk(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var o=t.read();if(!o)throw new Error("Sidecar medium not found");return W.createElement(o,No({},n))};HG.isSideCarExport=!0;function qG(e,t){return e.useMedium(t),HG}var ZG=WG(),uM=function(){},fE=W.forwardRef(function(e,t){var n=W.useRef(null),o=W.useState({onScrollCapture:uM,onWheelCapture:uM,onTouchMoveCapture:uM}),u=o[0],h=o[1],p=e.forwardProps,_=e.children,a=e.className,b=e.removeScrollBar,C=e.enabled,A=e.shards,O=e.sideCar,k=e.noIsolation,N=e.inert,z=e.allowPinchZoom,U=e.as,j=U===void 0?"div":U,G=xk(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),H=O,Y=GG([n,t]),K=No(No({},G),u);return W.createElement(W.Fragment,null,C&&W.createElement(H,{sideCar:ZG,removeScrollBar:b,shards:A,noIsolation:k,inert:N,setCallbacks:h,allowPinchZoom:!!z,lockRef:n}),p?W.cloneElement(W.Children.only(_),No(No({},K),{ref:Y})):W.createElement(j,No({},K,{className:a,ref:Y}),_))});fE.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};fE.classNames={fullWidth:Xv,zeroRight:Zv};var Moe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Ioe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Moe();return t&&e.setAttribute("nonce",t),e}function Ooe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Roe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var koe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Ioe())&&(Ooe(t,n),Roe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Doe=function(){var e=koe();return function(t,n){W.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},bk=function(){var e=Doe(),t=function(n){var o=n.styles,u=n.dynamic;return e(o,u),null};return t},Loe={left:0,top:0,right:0,gap:0},cM=function(e){return parseInt(e||"",10)||0},zoe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],o=t[e==="padding"?"paddingTop":"marginTop"],u=t[e==="padding"?"paddingRight":"marginRight"];return[cM(n),cM(o),cM(u)]},Foe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Loe;var t=zoe(e),n=document.documentElement.clientWidth,o=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,o-n+t[2]-t[0])}},Noe=bk(),Km="data-scroll-locked",Boe=function(e,t,n,o){var u=e.left,h=e.top,p=e.right,_=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Soe,` {
   overflow: hidden `).concat(o,`;
   padding-right: `).concat(_,"px ").concat(o,`;
  }
  body[`).concat(Km,`] {
    overflow: hidden `).concat(o,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(o,";"),n==="margin"&&`
    padding-left: `.concat(u,`px;
    padding-top: `).concat(h,`px;
    padding-right: `).concat(p,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(_,"px ").concat(o,`;
    `),n==="padding"&&"padding-right: ".concat(_,"px ").concat(o,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Zv,` {
    right: `).concat(_,"px ").concat(o,`;
  }
  
  .`).concat(Xv,` {
    margin-right: `).concat(_,"px ").concat(o,`;
  }
  
  .`).concat(Zv," .").concat(Zv,` {
    right: 0 `).concat(o,`;
  }
  
  .`).concat(Xv," .").concat(Xv,` {
    margin-right: 0 `).concat(o,`;
  }
  
  body[`).concat(Km,`] {
    `).concat(Toe,": ").concat(_,`px;
  }
`)},z4=function(){var e=parseInt(document.body.getAttribute(Km)||"0",10);return isFinite(e)?e:0},joe=function(){W.useEffect(function(){return document.body.setAttribute(Km,(z4()+1).toString()),function(){var e=z4()-1;e<=0?document.body.removeAttribute(Km):document.body.setAttribute(Km,e.toString())}},[])},XG=function(e){var t=e.noRelative,n=e.noImportant,o=e.gapMode,u=o===void 0?"margin":o;joe();var h=W.useMemo(function(){return Foe(u)},[u]);return W.createElement(Noe,{styles:Boe(h,!t,u,n?"":"!important")})},gO=!1;if(typeof window<"u")try{var fw=Object.defineProperty({},"passive",{get:function(){return gO=!0,!0}});window.addEventListener("test",fw,fw),window.removeEventListener("test",fw,fw)}catch{gO=!1}var _m=gO?{passive:!1}:!1,$oe=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},Uoe=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},F4=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=YG(e,n);if(o){var u=KG(e,n),h=u[1],p=u[2];if(h>p)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Voe=function(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;return[t,n,o]},Goe=function(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;return[t,n,o]},YG=function(e,t){return e==="v"?$oe(t):Uoe(t)},KG=function(e,t){return e==="v"?Voe(t):Goe(t)},Woe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Hoe=function(e,t,n,o,u){var h=Woe(e,window.getComputedStyle(t).direction),p=h*o,_=n.target,a=t.contains(_),b=!1,C=p>0,A=0,O=0;do{var k=KG(e,_),N=k[0],z=k[1],U=k[2],j=z-U-h*N;(N||j)&&YG(e,_)&&(A+=j,O+=N),_=_.parentNode}while(!a&&_!==document.body||a&&(t.contains(_)||t===_));return(C&&(A===0||!u)||!C&&(O===0||!u))&&(b=!0),b},dw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},N4=function(e){return[e.deltaX,e.deltaY]},B4=function(e){return e&&"current"in e?e.current:e},qoe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Zoe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Xoe=0,vm=[];function Yoe(e){var t=W.useRef([]),n=W.useRef([0,0]),o=W.useRef(),u=W.useState(Xoe++)[0],h=W.useState(function(){return bk()})[0],p=W.useRef(e);W.useEffect(function(){p.current=e},[e]),W.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(u));var z=VG([e.lockRef.current],(e.shards||[]).map(B4),!0).filter(Boolean);return z.forEach(function(U){return U.classList.add("allow-interactivity-".concat(u))}),function(){document.body.classList.remove("block-interactivity-".concat(u)),z.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(u))})}}},[e.inert,e.lockRef.current,e.shards]);var _=W.useCallback(function(z,U){if("touches"in z&&z.touches.length===2)return!p.current.allowPinchZoom;var j=dw(z),G=n.current,H="deltaX"in z?z.deltaX:G[0]-j[0],Y="deltaY"in z?z.deltaY:G[1]-j[1],K,ee=z.target,ue=Math.abs(H)>Math.abs(Y)?"h":"v";if("touches"in z&&ue==="h"&&ee.type==="range")return!1;var ve=F4(ue,ee);if(!ve)return!0;if(ve?K=ue:(K=ue==="v"?"h":"v",ve=F4(ue,ee)),!ve)return!1;if(!o.current&&"changedTouches"in z&&(H||Y)&&(o.current=K),!K)return!0;var Fe=o.current||K;return Hoe(Fe,U,z,Fe==="h"?H:Y,!0)},[]),a=W.useCallback(function(z){var U=z;if(!(!vm.length||vm[vm.length-1]!==h)){var j="deltaY"in U?N4(U):dw(U),G=t.current.filter(function(K){return K.name===U.type&&K.target===U.target&&qoe(K.delta,j)})[0];if(G&&G.should){U.preventDefault();return}if(!G){var H=(p.current.shards||[]).map(B4).filter(Boolean).filter(function(K){return K.contains(U.target)}),Y=H.length>0?_(U,H[0]):!p.current.noIsolation;Y&&U.preventDefault()}}},[]),b=W.useCallback(function(z,U,j,G){var H={name:z,delta:U,target:j,should:G};t.current.push(H),setTimeout(function(){t.current=t.current.filter(function(Y){return Y!==H})},1)},[]),C=W.useCallback(function(z){n.current=dw(z),o.current=void 0},[]),A=W.useCallback(function(z){b(z.type,N4(z),z.target,_(z,e.lockRef.current))},[]),O=W.useCallback(function(z){b(z.type,dw(z),z.target,_(z,e.lockRef.current))},[]);W.useEffect(function(){return vm.push(h),e.setCallbacks({onScrollCapture:A,onWheelCapture:A,onTouchMoveCapture:O}),document.addEventListener("wheel",a,_m),document.addEventListener("touchmove",a,_m),document.addEventListener("touchstart",C,_m),function(){vm=vm.filter(function(z){return z!==h}),document.removeEventListener("wheel",a,_m),document.removeEventListener("touchmove",a,_m),document.removeEventListener("touchstart",C,_m)}},[]);var k=e.removeScrollBar,N=e.inert;return W.createElement(W.Fragment,null,N?W.createElement(h,{styles:Zoe(u)}):null,k?W.createElement(XG,{gapMode:"margin"}):null)}const Koe=qG(ZG,Yoe);var QG=W.forwardRef(function(e,t){return W.createElement(fE,No({},e,{ref:t,sideCar:Koe}))});QG.classNames=fE.classNames;var Qoe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},xm=new WeakMap,pw=new WeakMap,mw={},hM=0,JG=function(e){return e&&(e.host||JG(e.parentNode))},Joe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var o=JG(n);return o&&e.contains(o)?o:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},eae=function(e,t,n,o){var u=Joe(t,Array.isArray(e)?e:[e]);mw[n]||(mw[n]=new WeakMap);var h=mw[n],p=[],_=new Set,a=new Set(u),b=function(A){!A||_.has(A)||(_.add(A),b(A.parentNode))};u.forEach(b);var C=function(A){!A||a.has(A)||Array.prototype.forEach.call(A.children,function(O){if(_.has(O))C(O);else try{var k=O.getAttribute(o),N=k!==null&&k!=="false",z=(xm.get(O)||0)+1,U=(h.get(O)||0)+1;xm.set(O,z),h.set(O,U),p.push(O),z===1&&N&&pw.set(O,!0),U===1&&O.setAttribute(n,"true"),N||O.setAttribute(o,"true")}catch(j){console.error("aria-hidden: cannot operate on ",O,j)}})};return C(t),_.clear(),hM++,function(){p.forEach(function(A){var O=xm.get(A)-1,k=h.get(A)-1;xm.set(A,O),h.set(A,k),O||(pw.has(A)||A.removeAttribute(o),pw.delete(A)),k||A.removeAttribute(n)}),hM--,hM||(xm=new WeakMap,xm=new WeakMap,pw=new WeakMap,mw={})}},vx=function(e,t,n){n===void 0&&(n="data-aria-hidden");var o=Array.from(Array.isArray(e)?e:[e]),u=Qoe(e);return u?(o.push.apply(o,Array.from(u.querySelectorAll("[aria-live]"))),eae(o,u,n,"aria-hidden")):function(){return null}};const e7="Dialog",[t7,yje]=Zie(e7),[tae,Xd]=t7(e7),nae=e=>{const{__scopeDialog:t,children:n,open:o,defaultOpen:u,onOpenChange:h,modal:p=!0}=e,_=W.useRef(null),a=W.useRef(null),[b=!1,C]=Qie({prop:o,defaultProp:u,onChange:h});return W.createElement(tae,{scope:t,triggerRef:_,contentRef:a,contentId:iM(),titleId:iM(),descriptionId:iM(),open:b,onOpenChange:C,onOpenToggle:W.useCallback(()=>C(A=>!A),[C]),modal:p},n)},n7="DialogPortal",[rae,r7]=t7(n7,{forceMount:void 0}),iae=e=>{const{__scopeDialog:t,forceMount:n,children:o,container:u}=e,h=Xd(n7,t);return W.createElement(rae,{scope:t,forceMount:n},W.Children.map(o,p=>W.createElement(hE,{present:n||h.open},W.createElement(voe,{asChild:!0,container:u},p))))},yO="DialogOverlay",oae=W.forwardRef((e,t)=>{const n=r7(yO,e.__scopeDialog),{forceMount:o=n.forceMount,...u}=e,h=Xd(yO,e.__scopeDialog);return h.modal?W.createElement(hE,{present:o||h.open},W.createElement(aae,Yo({},u,{ref:t}))):null}),aae=W.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,u=Xd(yO,n);return W.createElement(QG,{as:vk,allowPinchZoom:!0,shards:[u.contentRef]},W.createElement(cE.div,Yo({"data-state":o7(u.open)},o,{ref:t,style:{pointerEvents:"auto",...o.style}})))}),T0="DialogContent",sae=W.forwardRef((e,t)=>{const n=r7(T0,e.__scopeDialog),{forceMount:o=n.forceMount,...u}=e,h=Xd(T0,e.__scopeDialog);return W.createElement(hE,{present:o||h.open},h.modal?W.createElement(lae,Yo({},u,{ref:t})):W.createElement(uae,Yo({},u,{ref:t})))}),lae=W.forwardRef((e,t)=>{const n=Xd(T0,e.__scopeDialog),o=W.useRef(null),u=_x(t,n.contentRef,o);return W.useEffect(()=>{const h=o.current;if(h)return vx(h)},[]),W.createElement(i7,Yo({},e,{ref:u,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ym(e.onCloseAutoFocus,h=>{var p;h.preventDefault(),(p=n.triggerRef.current)===null||p===void 0||p.focus()}),onPointerDownOutside:Ym(e.onPointerDownOutside,h=>{const p=h.detail.originalEvent,_=p.button===0&&p.ctrlKey===!0;(p.button===2||_)&&h.preventDefault()}),onFocusOutside:Ym(e.onFocusOutside,h=>h.preventDefault())}))}),uae=W.forwardRef((e,t)=>{const n=Xd(T0,e.__scopeDialog),o=W.useRef(!1);return W.createElement(i7,Yo({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h;if((h=e.onCloseAutoFocus)===null||h===void 0||h.call(e,u),!u.defaultPrevented){var p;o.current||(p=n.triggerRef.current)===null||p===void 0||p.focus(),u.preventDefault()}o.current=!1},onInteractOutside:u=>{var h,p;(h=e.onInteractOutside)===null||h===void 0||h.call(e,u),u.defaultPrevented||(o.current=!0);const _=u.target;((p=n.triggerRef.current)===null||p===void 0?void 0:p.contains(_))&&u.preventDefault()}}))}),i7=W.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:o,onOpenAutoFocus:u,onCloseAutoFocus:h,...p}=e,_=Xd(T0,n),a=W.useRef(null),b=_x(t,a);return woe(),W.createElement(W.Fragment,null,W.createElement(foe,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:u,onUnmountAutoFocus:h},W.createElement(uoe,Yo({role:"dialog",id:_.contentId,"aria-describedby":_.descriptionId,"aria-labelledby":_.titleId,"data-state":o7(_.open)},p,{ref:b,onDismiss:()=>_.onOpenChange(!1)}))),!1)});function o7(e){return e?"open":"closed"}const cae=nae,hae=iae,fae=oae,dae=sae;var pae='[cmdk-list-sizer=""]',gv='[cmdk-group=""]',fM='[cmdk-group-items=""]',mae='[cmdk-group-heading=""]',wk='[cmdk-item=""]',j4=`${wk}:not([aria-disabled="true"])`,_O="cmdk-item-select",Cu="data-value",gae=(e,t)=>Hie(e,t),a7=W.createContext(void 0),xx=()=>W.useContext(a7),s7=W.createContext(void 0),Sk=()=>W.useContext(s7),l7=W.createContext(void 0),u7=W.forwardRef((e,t)=>{let n=W.useRef(null),o=Cm(()=>{var de,lt,gt;return{search:"",value:(gt=(lt=e.value)!=null?lt:(de=e.defaultValue)==null?void 0:de.toLowerCase())!=null?gt:"",filtered:{count:0,items:new Map,groups:new Set}}}),u=Cm(()=>new Set),h=Cm(()=>new Map),p=Cm(()=>new Map),_=Cm(()=>new Set),a=c7(e),{label:b,children:C,value:A,onValueChange:O,filter:k,shouldFilter:N,vimBindings:z=!0,...U}=e,j=W.useId(),G=W.useId(),H=W.useId(),Y=Cae();Gg(()=>{if(A!==void 0){let de=A.trim().toLowerCase();o.current.value=de,Y(6,Oe),K.emit()}},[A]);let K=W.useMemo(()=>({subscribe:de=>(_.current.add(de),()=>_.current.delete(de)),snapshot:()=>o.current,setState:(de,lt,gt)=>{var Se,qt,an;if(!Object.is(o.current[de],lt)){if(o.current[de]=lt,de==="search")Ne(),ve(),Y(1,Fe);else if(de==="value")if(((Se=a.current)==null?void 0:Se.value)!==void 0){let dn=lt??"";(an=(qt=a.current).onValueChange)==null||an.call(qt,dn);return}else gt||Y(5,Oe);K.emit()}},emit:()=>{_.current.forEach(de=>de())}}),[]),ee=W.useMemo(()=>({value:(de,lt)=>{lt!==p.current.get(de)&&(p.current.set(de,lt),o.current.filtered.items.set(de,ue(lt)),Y(2,()=>{ve(),K.emit()}))},item:(de,lt)=>(u.current.add(de),lt&&(h.current.has(lt)?h.current.get(lt).add(de):h.current.set(lt,new Set([de]))),Y(3,()=>{Ne(),ve(),o.current.value||Fe(),K.emit()}),()=>{p.current.delete(de),u.current.delete(de),o.current.filtered.items.delete(de);let gt=Le();Y(4,()=>{Ne(),(gt==null?void 0:gt.getAttribute("id"))===de&&Fe(),K.emit()})}),group:de=>(h.current.has(de)||h.current.set(de,new Set),()=>{p.current.delete(de),h.current.delete(de)}),filter:()=>a.current.shouldFilter,label:b||e["aria-label"],commandRef:n,listId:j,inputId:H,labelId:G}),[]);function ue(de){var lt,gt;let Se=(gt=(lt=a.current)==null?void 0:lt.filter)!=null?gt:gae;return de?Se(de,o.current.search):0}function ve(){if(!n.current||!o.current.search||a.current.shouldFilter===!1)return;let de=o.current.filtered.items,lt=[];o.current.filtered.groups.forEach(Se=>{let qt=h.current.get(Se),an=0;qt.forEach(dn=>{let Wt=de.get(dn);an=Math.max(Wt,an)}),lt.push([Se,an])});let gt=n.current.querySelector(pae);Ue().sort((Se,qt)=>{var an,dn;let Wt=Se.getAttribute(Cu),An=qt.getAttribute(Cu);return((an=de.get(An))!=null?an:0)-((dn=de.get(Wt))!=null?dn:0)}).forEach(Se=>{let qt=Se.closest(fM);qt?qt.appendChild(Se.parentElement===qt?Se:Se.closest(`${fM} > *`)):gt.appendChild(Se.parentElement===gt?Se:Se.closest(`${fM} > *`))}),lt.sort((Se,qt)=>qt[1]-Se[1]).forEach(Se=>{let qt=n.current.querySelector(`${gv}[${Cu}="${Se[0]}"]`);qt==null||qt.parentElement.appendChild(qt)})}function Fe(){let de=Ue().find(gt=>!gt.ariaDisabled),lt=de==null?void 0:de.getAttribute(Cu);K.setState("value",lt||void 0)}function Ne(){if(!o.current.search||a.current.shouldFilter===!1){o.current.filtered.count=u.current.size;return}o.current.filtered.groups=new Set;let de=0;for(let lt of u.current){let gt=p.current.get(lt),Se=ue(gt);o.current.filtered.items.set(lt,Se),Se>0&&de++}for(let[lt,gt]of h.current)for(let Se of gt)if(o.current.filtered.items.get(Se)>0){o.current.filtered.groups.add(lt);break}o.current.filtered.count=de}function Oe(){var de,lt,gt;let Se=Le();Se&&(((de=Se.parentElement)==null?void 0:de.firstChild)===Se&&((gt=(lt=Se.closest(gv))==null?void 0:lt.querySelector(mae))==null||gt.scrollIntoView({block:"nearest"})),Se.scrollIntoView({block:"nearest"}))}function Le(){var de;return(de=n.current)==null?void 0:de.querySelector(`${wk}[aria-selected="true"]`)}function Ue(){return Array.from(n.current.querySelectorAll(j4))}function et(de){let lt=Ue()[de];lt&&K.setState("value",lt.getAttribute(Cu))}function rt(de){var lt;let gt=Le(),Se=Ue(),qt=Se.findIndex(dn=>dn===gt),an=Se[qt+de];(lt=a.current)!=null&&lt.loop&&(an=qt+de<0?Se[Se.length-1]:qt+de===Se.length?Se[0]:Se[qt+de]),an&&K.setState("value",an.getAttribute(Cu))}function st(de){let lt=Le(),gt=lt==null?void 0:lt.closest(gv),Se;for(;gt&&!Se;)gt=de>0?Eae(gt,gv):Aae(gt,gv),Se=gt==null?void 0:gt.querySelector(j4);Se?K.setState("value",Se.getAttribute(Cu)):rt(de)}let Ke=()=>et(Ue().length-1),Ze=de=>{de.preventDefault(),de.metaKey?Ke():de.altKey?st(1):rt(1)},Xe=de=>{de.preventDefault(),de.metaKey?et(0):de.altKey?st(-1):rt(-1)};return W.createElement("div",{ref:bx([n,t]),...U,"cmdk-root":"",onKeyDown:de=>{var lt;if((lt=U.onKeyDown)==null||lt.call(U,de),!de.defaultPrevented)switch(de.key){case"n":case"j":{z&&de.ctrlKey&&Ze(de);break}case"ArrowDown":{Ze(de);break}case"p":case"k":{z&&de.ctrlKey&&Xe(de);break}case"ArrowUp":{Xe(de);break}case"Home":{de.preventDefault(),et(0);break}case"End":{de.preventDefault(),Ke();break}case"Enter":if(!de.nativeEvent.isComposing){de.preventDefault();let gt=Le();if(gt){let Se=new Event(_O);gt.dispatchEvent(Se)}}}}},W.createElement("label",{"cmdk-label":"",htmlFor:ee.inputId,id:ee.labelId,style:Pae},b),W.createElement(s7.Provider,{value:K},W.createElement(a7.Provider,{value:ee},C)))}),yae=W.forwardRef((e,t)=>{var n,o;let u=W.useId(),h=W.useRef(null),p=W.useContext(l7),_=xx(),a=c7(e),b=(o=(n=a.current)==null?void 0:n.forceMount)!=null?o:p==null?void 0:p.forceMount;Gg(()=>_.item(u,p==null?void 0:p.id),[]);let C=h7(u,h,[e.value,e.children,h]),A=Sk(),O=Fd(K=>K.value&&K.value===C.current),k=Fd(K=>b||_.filter()===!1?!0:K.search?K.filtered.items.get(u)>0:!0);W.useEffect(()=>{let K=h.current;if(!(!K||e.disabled))return K.addEventListener(_O,N),()=>K.removeEventListener(_O,N)},[k,e.onSelect,e.disabled]);function N(){var K,ee;z(),(ee=(K=a.current).onSelect)==null||ee.call(K,C.current)}function z(){A.setState("value",C.current,!0)}if(!k)return null;let{disabled:U,value:j,onSelect:G,forceMount:H,...Y}=e;return W.createElement("div",{ref:bx([h,t]),...Y,id:u,"cmdk-item":"",role:"option","aria-disabled":U||void 0,"aria-selected":O||void 0,"data-disabled":U||void 0,"data-selected":O||void 0,onPointerMove:U?void 0:z,onClick:U?void 0:N},e.children)}),_ae=W.forwardRef((e,t)=>{let{heading:n,children:o,forceMount:u,...h}=e,p=W.useId(),_=W.useRef(null),a=W.useRef(null),b=W.useId(),C=xx(),A=Fd(N=>u||C.filter()===!1?!0:N.search?N.filtered.groups.has(p):!0);Gg(()=>C.group(p),[]),h7(p,_,[e.value,e.heading,a]);let O=W.useMemo(()=>({id:p,forceMount:u}),[u]),k=W.createElement(l7.Provider,{value:O},o);return W.createElement("div",{ref:bx([_,t]),...h,"cmdk-group":"",role:"presentation",hidden:A?void 0:!0},n&&W.createElement("div",{ref:a,"cmdk-group-heading":"","aria-hidden":!0,id:b},n),W.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?b:void 0},k))}),vae=W.forwardRef((e,t)=>{let{alwaysRender:n,...o}=e,u=W.useRef(null),h=Fd(p=>!p.search);return!n&&!h?null:W.createElement("div",{ref:bx([u,t]),...o,"cmdk-separator":"",role:"separator"})}),xae=W.forwardRef((e,t)=>{let{onValueChange:n,...o}=e,u=e.value!=null,h=Sk(),p=Fd(C=>C.search),_=Fd(C=>C.value),a=xx(),b=W.useMemo(()=>{var C;let A=(C=a.commandRef.current)==null?void 0:C.querySelector(`${wk}[${Cu}="${_}"]`);return A==null?void 0:A.getAttribute("id")},[_,a.commandRef]);return W.useEffect(()=>{e.value!=null&&h.setState("search",e.value)},[e.value]),W.createElement("input",{ref:t,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":a.listId,"aria-labelledby":a.labelId,"aria-activedescendant":b,id:a.inputId,type:"text",value:u?e.value:p,onChange:C=>{u||h.setState("search",C.target.value),n==null||n(C.target.value)}})}),bae=W.forwardRef((e,t)=>{let{children:n,...o}=e,u=W.useRef(null),h=W.useRef(null),p=xx();return W.useEffect(()=>{if(h.current&&u.current){let _=h.current,a=u.current,b,C=new ResizeObserver(()=>{b=requestAnimationFrame(()=>{let A=_.offsetHeight;a.style.setProperty("--cmdk-list-height",A.toFixed(1)+"px")})});return C.observe(_),()=>{cancelAnimationFrame(b),C.unobserve(_)}}},[]),W.createElement("div",{ref:bx([u,t]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:p.listId,"aria-labelledby":p.inputId},W.createElement("div",{ref:h,"cmdk-list-sizer":""},n))}),wae=W.forwardRef((e,t)=>{let{open:n,onOpenChange:o,overlayClassName:u,contentClassName:h,container:p,..._}=e;return W.createElement(cae,{open:n,onOpenChange:o},W.createElement(hae,{container:p},W.createElement(fae,{"cmdk-overlay":"",className:u}),W.createElement(dae,{"aria-label":e.label,"cmdk-dialog":"",className:h},W.createElement(u7,{ref:t,..._}))))}),Sae=W.forwardRef((e,t)=>{let n=W.useRef(!0),o=Fd(u=>u.filtered.count===0);return W.useEffect(()=>{n.current=!1},[]),n.current||!o?null:W.createElement("div",{ref:t,...e,"cmdk-empty":"",role:"presentation"})}),Tae=W.forwardRef((e,t)=>{let{progress:n,children:o,...u}=e;return W.createElement("div",{ref:t,...u,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},W.createElement("div",{"aria-hidden":!0},o))}),xa=Object.assign(u7,{List:bae,Item:yae,Input:xae,Group:_ae,Separator:vae,Dialog:wae,Empty:Sae,Loading:Tae});function Eae(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Aae(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function c7(e){let t=W.useRef(e);return Gg(()=>{t.current=e}),t}var Gg=typeof window>"u"?W.useEffect:W.useLayoutEffect;function Cm(e){let t=W.useRef();return t.current===void 0&&(t.current=e()),t}function bx(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function Fd(e){let t=Sk(),n=()=>e(t.snapshot());return W.useSyncExternalStore(t.subscribe,n,n)}function h7(e,t,n){let o=W.useRef(),u=xx();return Gg(()=>{var h;let p=(()=>{var _;for(let a of n){if(typeof a=="string")return a.trim().toLowerCase();if(typeof a=="object"&&"current"in a)return a.current?(_=a.current.textContent)==null?void 0:_.trim().toLowerCase():o.current}})();u.value(e,p),(h=t.current)==null||h.setAttribute(Cu,p),o.current=p}),o}var Cae=()=>{let[e,t]=W.useState(),n=Cm(()=>new Map);return Gg(()=>{n.current.forEach(o=>o()),n.current=new Map},[e]),(o,u)=>{n.current.set(o,u),t({})}},Pae={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},Mae=bR.useId||(()=>{}),Iae=0;function Dh(e){const[t,n]=W.useState(Mae());return Xo(()=>{n(o=>o??String(Iae++))},[e]),t?`radix-${t}`:""}function Oae(e,t=globalThis==null?void 0:globalThis.document){const n=Ss(e);W.useEffect(()=>{const o=u=>{u.key==="Escape"&&n(u)};return t.addEventListener("keydown",o,{capture:!0}),()=>t.removeEventListener("keydown",o,{capture:!0})},[n,t])}var Rae="DismissableLayer",vO="dismissableLayer.update",kae="dismissableLayer.pointerDownOutside",Dae="dismissableLayer.focusOutside",$4,f7=W.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),wx=W.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:_,...a}=e,b=W.useContext(f7),[C,A]=W.useState(null),O=(C==null?void 0:C.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,k]=W.useState({}),N=Fr(t,ue=>A(ue)),z=Array.from(b.layers),[U]=[...b.layersWithOutsidePointerEventsDisabled].slice(-1),j=z.indexOf(U),G=C?z.indexOf(C):-1,H=b.layersWithOutsidePointerEventsDisabled.size>0,Y=G>=j,K=Fae(ue=>{const ve=ue.target,Fe=[...b.branches].some(Ne=>Ne.contains(ve));!Y||Fe||(u==null||u(ue),p==null||p(ue),ue.defaultPrevented||_==null||_())},O),ee=Nae(ue=>{const ve=ue.target;[...b.branches].some(Ne=>Ne.contains(ve))||(h==null||h(ue),p==null||p(ue),ue.defaultPrevented||_==null||_())},O);return Oae(ue=>{G===b.layers.size-1&&(o==null||o(ue),!ue.defaultPrevented&&_&&(ue.preventDefault(),_()))},O),W.useEffect(()=>{if(C)return n&&(b.layersWithOutsidePointerEventsDisabled.size===0&&($4=O.body.style.pointerEvents,O.body.style.pointerEvents="none"),b.layersWithOutsidePointerEventsDisabled.add(C)),b.layers.add(C),U4(),()=>{n&&b.layersWithOutsidePointerEventsDisabled.size===1&&(O.body.style.pointerEvents=$4)}},[C,O,n,b]),W.useEffect(()=>()=>{C&&(b.layers.delete(C),b.layersWithOutsidePointerEventsDisabled.delete(C),U4())},[C,b]),W.useEffect(()=>{const ue=()=>k({});return document.addEventListener(vO,ue),()=>document.removeEventListener(vO,ue)},[]),re.jsx(fr.div,{...a,ref:N,style:{pointerEvents:H?Y?"auto":"none":void 0,...e.style},onFocusCapture:hn(e.onFocusCapture,ee.onFocusCapture),onBlurCapture:hn(e.onBlurCapture,ee.onBlurCapture),onPointerDownCapture:hn(e.onPointerDownCapture,K.onPointerDownCapture)})});wx.displayName=Rae;var Lae="DismissableLayerBranch",zae=W.forwardRef((e,t)=>{const n=W.useContext(f7),o=W.useRef(null),u=Fr(t,o);return W.useEffect(()=>{const h=o.current;if(h)return n.branches.add(h),()=>{n.branches.delete(h)}},[n.branches]),re.jsx(fr.div,{...e,ref:u})});zae.displayName=Lae;function Fae(e,t=globalThis==null?void 0:globalThis.document){const n=Ss(e),o=W.useRef(!1),u=W.useRef(()=>{});return W.useEffect(()=>{const h=_=>{if(_.target&&!o.current){let a=function(){d7(kae,n,b,{discrete:!0})};const b={originalEvent:_};_.pointerType==="touch"?(t.removeEventListener("click",u.current),u.current=a,t.addEventListener("click",u.current,{once:!0})):a()}else t.removeEventListener("click",u.current);o.current=!1},p=window.setTimeout(()=>{t.addEventListener("pointerdown",h)},0);return()=>{window.clearTimeout(p),t.removeEventListener("pointerdown",h),t.removeEventListener("click",u.current)}},[t,n]),{onPointerDownCapture:()=>o.current=!0}}function Nae(e,t=globalThis==null?void 0:globalThis.document){const n=Ss(e),o=W.useRef(!1);return W.useEffect(()=>{const u=h=>{h.target&&!o.current&&d7(Dae,n,{originalEvent:h},{discrete:!1})};return t.addEventListener("focusin",u),()=>t.removeEventListener("focusin",u)},[t,n]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function U4(){const e=new CustomEvent(vO);document.dispatchEvent(e)}function d7(e,t,n,{discrete:o}){const u=n.originalEvent.target,h=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&u.addEventListener(e,t,{once:!0}),o?OG(u,h):u.dispatchEvent(h)}var dM="focusScope.autoFocusOnMount",pM="focusScope.autoFocusOnUnmount",V4={bubbles:!1,cancelable:!0},Bae="FocusScope",Sx=W.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:u,onUnmountAutoFocus:h,...p}=e,[_,a]=W.useState(null),b=Ss(u),C=Ss(h),A=W.useRef(null),O=Fr(t,z=>a(z)),k=W.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;W.useEffect(()=>{if(o){let z=function(H){if(k.paused||!_)return;const Y=H.target;_.contains(Y)?A.current=Y:hh(A.current,{select:!0})},U=function(H){if(k.paused||!_)return;const Y=H.relatedTarget;Y!==null&&(_.contains(Y)||hh(A.current,{select:!0}))},j=function(H){if(document.activeElement===document.body)for(const K of H)K.removedNodes.length>0&&hh(_)};document.addEventListener("focusin",z),document.addEventListener("focusout",U);const G=new MutationObserver(j);return _&&G.observe(_,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",z),document.removeEventListener("focusout",U),G.disconnect()}}},[o,_,k.paused]),W.useEffect(()=>{if(_){W4.add(k);const z=document.activeElement;if(!_.contains(z)){const j=new CustomEvent(dM,V4);_.addEventListener(dM,b),_.dispatchEvent(j),j.defaultPrevented||(jae(Wae(p7(_)),{select:!0}),document.activeElement===z&&hh(_))}return()=>{_.removeEventListener(dM,b),setTimeout(()=>{const j=new CustomEvent(pM,V4);_.addEventListener(pM,C),_.dispatchEvent(j),j.defaultPrevented||hh(z??document.body,{select:!0}),_.removeEventListener(pM,C),W4.remove(k)},0)}}},[_,b,C,k]);const N=W.useCallback(z=>{if(!n&&!o||k.paused)return;const U=z.key==="Tab"&&!z.altKey&&!z.ctrlKey&&!z.metaKey,j=document.activeElement;if(U&&j){const G=z.currentTarget,[H,Y]=$ae(G);H&&Y?!z.shiftKey&&j===Y?(z.preventDefault(),n&&hh(H,{select:!0})):z.shiftKey&&j===H&&(z.preventDefault(),n&&hh(Y,{select:!0})):j===G&&z.preventDefault()}},[n,o,k.paused]);return re.jsx(fr.div,{tabIndex:-1,...p,ref:O,onKeyDown:N})});Sx.displayName=Bae;function jae(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(hh(o,{select:t}),document.activeElement!==n)return}function $ae(e){const t=p7(e),n=G4(t,e),o=G4(t.reverse(),e);return[n,o]}function p7(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const u=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||u?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function G4(e,t){for(const n of e)if(!Uae(n,{upTo:t}))return n}function Uae(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Vae(e){return e instanceof HTMLInputElement&&"select"in e}function hh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Vae(e)&&t&&e.select()}}var W4=Gae();function Gae(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=H4(e,t),e.unshift(t)},remove(t){var n;e=H4(e,t),(n=e[0])==null||n.resume()}}}function H4(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function Wae(e){return e.filter(t=>t.tagName!=="A")}var Hae="Portal",Tx=W.forwardRef((e,t)=>{var _;const{container:n,...o}=e,[u,h]=W.useState(!1);Xo(()=>h(!0),[]);const p=n||u&&((_=globalThis==null?void 0:globalThis.document)==null?void 0:_.body);return p?oG.createPortal(re.jsx(fr.div,{...o,ref:t}),p):null});Tx.displayName=Hae;var mM=0;function dE(){W.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??q4()),document.body.insertAdjacentElement("beforeend",e[1]??q4()),mM++,()=>{mM===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),mM--}},[])}function q4(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var m7=WG(),gM=function(){},pE=W.forwardRef(function(e,t){var n=W.useRef(null),o=W.useState({onScrollCapture:gM,onWheelCapture:gM,onTouchMoveCapture:gM}),u=o[0],h=o[1],p=e.forwardProps,_=e.children,a=e.className,b=e.removeScrollBar,C=e.enabled,A=e.shards,O=e.sideCar,k=e.noIsolation,N=e.inert,z=e.allowPinchZoom,U=e.as,j=U===void 0?"div":U,G=e.gapMode,H=xk(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Y=O,K=GG([n,t]),ee=No(No({},H),u);return W.createElement(W.Fragment,null,C&&W.createElement(Y,{sideCar:m7,removeScrollBar:b,shards:A,noIsolation:k,inert:N,setCallbacks:h,allowPinchZoom:!!z,lockRef:n,gapMode:G}),p?W.cloneElement(W.Children.only(_),No(No({},ee),{ref:K})):W.createElement(j,No({},ee,{className:a,ref:K}),_))});pE.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};pE.classNames={fullWidth:Xv,zeroRight:Zv};var xO=!1;if(typeof window<"u")try{var gw=Object.defineProperty({},"passive",{get:function(){return xO=!0,!0}});window.addEventListener("test",gw,gw),window.removeEventListener("test",gw,gw)}catch{xO=!1}var bm=xO?{passive:!1}:!1,qae=function(e){return e.tagName==="TEXTAREA"},g7=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!qae(e)&&n[t]==="visible")},Zae=function(e){return g7(e,"overflowY")},Xae=function(e){return g7(e,"overflowX")},Z4=function(e,t){var n=t.ownerDocument,o=t;do{typeof ShadowRoot<"u"&&o instanceof ShadowRoot&&(o=o.host);var u=y7(e,o);if(u){var h=_7(e,o),p=h[1],_=h[2];if(p>_)return!0}o=o.parentNode}while(o&&o!==n.body);return!1},Yae=function(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;return[t,n,o]},Kae=function(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;return[t,n,o]},y7=function(e,t){return e==="v"?Zae(t):Xae(t)},_7=function(e,t){return e==="v"?Yae(t):Kae(t)},Qae=function(e,t){return e==="h"&&t==="rtl"?-1:1},Jae=function(e,t,n,o,u){var h=Qae(e,window.getComputedStyle(t).direction),p=h*o,_=n.target,a=t.contains(_),b=!1,C=p>0,A=0,O=0;do{var k=_7(e,_),N=k[0],z=k[1],U=k[2],j=z-U-h*N;(N||j)&&y7(e,_)&&(A+=j,O+=N),_ instanceof ShadowRoot?_=_.host:_=_.parentNode}while(!a&&_!==document.body||a&&(t.contains(_)||t===_));return(C&&(Math.abs(A)<1||!u)||!C&&(Math.abs(O)<1||!u))&&(b=!0),b},yw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},X4=function(e){return[e.deltaX,e.deltaY]},Y4=function(e){return e&&"current"in e?e.current:e},ese=function(e,t){return e[0]===t[0]&&e[1]===t[1]},tse=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},nse=0,wm=[];function rse(e){var t=W.useRef([]),n=W.useRef([0,0]),o=W.useRef(),u=W.useState(nse++)[0],h=W.useState(bk)[0],p=W.useRef(e);W.useEffect(function(){p.current=e},[e]),W.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(u));var z=VG([e.lockRef.current],(e.shards||[]).map(Y4),!0).filter(Boolean);return z.forEach(function(U){return U.classList.add("allow-interactivity-".concat(u))}),function(){document.body.classList.remove("block-interactivity-".concat(u)),z.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(u))})}}},[e.inert,e.lockRef.current,e.shards]);var _=W.useCallback(function(z,U){if("touches"in z&&z.touches.length===2)return!p.current.allowPinchZoom;var j=yw(z),G=n.current,H="deltaX"in z?z.deltaX:G[0]-j[0],Y="deltaY"in z?z.deltaY:G[1]-j[1],K,ee=z.target,ue=Math.abs(H)>Math.abs(Y)?"h":"v";if("touches"in z&&ue==="h"&&ee.type==="range")return!1;var ve=Z4(ue,ee);if(!ve)return!0;if(ve?K=ue:(K=ue==="v"?"h":"v",ve=Z4(ue,ee)),!ve)return!1;if(!o.current&&"changedTouches"in z&&(H||Y)&&(o.current=K),!K)return!0;var Fe=o.current||K;return Jae(Fe,U,z,Fe==="h"?H:Y,!0)},[]),a=W.useCallback(function(z){var U=z;if(!(!wm.length||wm[wm.length-1]!==h)){var j="deltaY"in U?X4(U):yw(U),G=t.current.filter(function(K){return K.name===U.type&&(K.target===U.target||U.target===K.shadowParent)&&ese(K.delta,j)})[0];if(G&&G.should){U.cancelable&&U.preventDefault();return}if(!G){var H=(p.current.shards||[]).map(Y4).filter(Boolean).filter(function(K){return K.contains(U.target)}),Y=H.length>0?_(U,H[0]):!p.current.noIsolation;Y&&U.cancelable&&U.preventDefault()}}},[]),b=W.useCallback(function(z,U,j,G){var H={name:z,delta:U,target:j,should:G,shadowParent:ise(j)};t.current.push(H),setTimeout(function(){t.current=t.current.filter(function(Y){return Y!==H})},1)},[]),C=W.useCallback(function(z){n.current=yw(z),o.current=void 0},[]),A=W.useCallback(function(z){b(z.type,X4(z),z.target,_(z,e.lockRef.current))},[]),O=W.useCallback(function(z){b(z.type,yw(z),z.target,_(z,e.lockRef.current))},[]);W.useEffect(function(){return wm.push(h),e.setCallbacks({onScrollCapture:A,onWheelCapture:A,onTouchMoveCapture:O}),document.addEventListener("wheel",a,bm),document.addEventListener("touchmove",a,bm),document.addEventListener("touchstart",C,bm),function(){wm=wm.filter(function(z){return z!==h}),document.removeEventListener("wheel",a,bm),document.removeEventListener("touchmove",a,bm),document.removeEventListener("touchstart",C,bm)}},[]);var k=e.removeScrollBar,N=e.inert;return W.createElement(W.Fragment,null,N?W.createElement(h,{styles:tse(u)}):null,k?W.createElement(XG,{gapMode:e.gapMode}):null)}function ise(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ose=qG(m7,rse);var Ex=W.forwardRef(function(e,t){return W.createElement(pE,No({},e,{ref:t,sideCar:ose}))});Ex.classNames=pE.classNames;var v7="Dialog",[x7,_je]=tc(v7),[vje,sl]=x7(v7),b7="DialogTrigger",ase=W.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,u=sl(b7,n),h=Fr(t,u.triggerRef);return re.jsx(fr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":u.open,"aria-controls":u.contentId,"data-state":Ak(u.open),...o,ref:h,onClick:hn(e.onClick,u.onOpenToggle)})});ase.displayName=b7;var Tk="DialogPortal",[sse,w7]=x7(Tk,{forceMount:void 0}),S7=e=>{const{__scopeDialog:t,forceMount:n,children:o,container:u}=e,h=sl(Tk,t);return re.jsx(sse,{scope:t,forceMount:n,children:W.Children.map(o,p=>re.jsx(al,{present:n||h.open,children:re.jsx(Tx,{asChild:!0,container:u,children:p})}))})};S7.displayName=Tk;var IS="DialogOverlay",T7=W.forwardRef((e,t)=>{const n=w7(IS,e.__scopeDialog),{forceMount:o=n.forceMount,...u}=e,h=sl(IS,e.__scopeDialog);return h.modal?re.jsx(al,{present:o||h.open,children:re.jsx(lse,{...u,ref:t})}):null});T7.displayName=IS;var lse=W.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,u=sl(IS,n);return re.jsx(Ex,{as:Wu,allowPinchZoom:!0,shards:[u.contentRef],children:re.jsx(fr.div,{"data-state":Ak(u.open),...o,ref:t,style:{pointerEvents:"auto",...o.style}})})}),Nd="DialogContent",E7=W.forwardRef((e,t)=>{const n=w7(Nd,e.__scopeDialog),{forceMount:o=n.forceMount,...u}=e,h=sl(Nd,e.__scopeDialog);return re.jsx(al,{present:o||h.open,children:h.modal?re.jsx(use,{...u,ref:t}):re.jsx(cse,{...u,ref:t})})});E7.displayName=Nd;var use=W.forwardRef((e,t)=>{const n=sl(Nd,e.__scopeDialog),o=W.useRef(null),u=Fr(t,n.contentRef,o);return W.useEffect(()=>{const h=o.current;if(h)return vx(h)},[]),re.jsx(A7,{...e,ref:u,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:hn(e.onCloseAutoFocus,h=>{var p;h.preventDefault(),(p=n.triggerRef.current)==null||p.focus()}),onPointerDownOutside:hn(e.onPointerDownOutside,h=>{const p=h.detail.originalEvent,_=p.button===0&&p.ctrlKey===!0;(p.button===2||_)&&h.preventDefault()}),onFocusOutside:hn(e.onFocusOutside,h=>h.preventDefault())})}),cse=W.forwardRef((e,t)=>{const n=sl(Nd,e.__scopeDialog),o=W.useRef(!1),u=W.useRef(!1);return re.jsx(A7,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:h=>{var p,_;(p=e.onCloseAutoFocus)==null||p.call(e,h),h.defaultPrevented||(o.current||(_=n.triggerRef.current)==null||_.focus(),h.preventDefault()),o.current=!1,u.current=!1},onInteractOutside:h=>{var a,b;(a=e.onInteractOutside)==null||a.call(e,h),h.defaultPrevented||(o.current=!0,h.detail.originalEvent.type==="pointerdown"&&(u.current=!0));const p=h.target;((b=n.triggerRef.current)==null?void 0:b.contains(p))&&h.preventDefault(),h.detail.originalEvent.type==="focusin"&&u.current&&h.preventDefault()}})}),A7=W.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:o,onOpenAutoFocus:u,onCloseAutoFocus:h,...p}=e,_=sl(Nd,n),a=W.useRef(null),b=Fr(t,a);return dE(),re.jsxs(re.Fragment,{children:[re.jsx(Sx,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:u,onUnmountAutoFocus:h,children:re.jsx(wx,{role:"dialog",id:_.contentId,"aria-describedby":_.descriptionId,"aria-labelledby":_.titleId,"data-state":Ak(_.open),...p,ref:b,onDismiss:()=>_.onOpenChange(!1)})}),re.jsxs(re.Fragment,{children:[re.jsx(hse,{titleId:_.titleId}),re.jsx(dse,{contentRef:a,descriptionId:_.descriptionId})]})]})}),Ek="DialogTitle",C7=W.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,u=sl(Ek,n);return re.jsx(fr.h2,{id:u.titleId,...o,ref:t})});C7.displayName=Ek;var P7="DialogDescription",M7=W.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,u=sl(P7,n);return re.jsx(fr.p,{id:u.descriptionId,...o,ref:t})});M7.displayName=P7;var I7="DialogClose",O7=W.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,u=sl(I7,n);return re.jsx(fr.button,{type:"button",...o,ref:t,onClick:hn(e.onClick,()=>u.onOpenChange(!1))})});O7.displayName=I7;function Ak(e){return e?"open":"closed"}var R7="DialogTitleWarning",[xje,k7]=fie(R7,{contentName:Nd,titleName:Ek,docsSlug:"dialog"}),hse=({titleId:e})=>{const t=k7(R7),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return W.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},fse="DialogDescriptionWarning",dse=({contentRef:e,descriptionId:t})=>{const o=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${k7(fse).contentName}}.`;return W.useEffect(()=>{var h;const u=(h=e.current)==null?void 0:h.getAttribute("aria-describedby");t&&u&&(document.getElementById(t)||console.warn(o))},[o,e,t]),null},pse=S7,D7=T7,L7=E7,z7=C7,F7=M7,mse=O7;const gse=pse,N7=W.forwardRef(({className:e,...t},n)=>re.jsx(D7,{ref:n,className:wn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));N7.displayName=D7.displayName;const yse=W.forwardRef(({className:e,children:t,...n},o)=>re.jsxs(gse,{children:[re.jsx(N7,{}),re.jsxs(L7,{ref:o,className:wn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,re.jsxs(mse,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[re.jsx(Fie,{className:"w-4 h-4"}),re.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));yse.displayName=L7.displayName;const _se=W.forwardRef(({className:e,...t},n)=>re.jsx(z7,{ref:n,className:wn("text-lg font-semibold leading-none tracking-tight",e),...t}));_se.displayName=z7.displayName;const vse=W.forwardRef(({className:e,...t},n)=>re.jsx(F7,{ref:n,className:wn("text-sm text-muted-foreground",e),...t}));vse.displayName=F7.displayName;const B7=W.forwardRef(({className:e,...t},n)=>re.jsx(xa,{ref:n,className:wn("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));B7.displayName=xa.displayName;const j7=W.forwardRef(({className:e,...t},n)=>re.jsxs("div",{className:"flex items-center px-3 border-b","cmdk-input-wrapper":"",children:[re.jsx(zie,{className:"w-4 h-4 mr-2 opacity-50 shrink-0"}),re.jsx(xa.Input,{ref:n,className:wn("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));j7.displayName=xa.Input.displayName;const $7=W.forwardRef(({className:e,...t},n)=>re.jsx(xa.List,{ref:n,className:wn("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));$7.displayName=xa.List.displayName;const U7=W.forwardRef((e,t)=>re.jsx(xa.Empty,{ref:t,className:"py-6 text-sm text-center",...e}));U7.displayName=xa.Empty.displayName;const V7=W.forwardRef(({className:e,...t},n)=>re.jsx(xa.Group,{ref:n,className:wn("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));V7.displayName=xa.Group.displayName;const xse=W.forwardRef(({className:e,...t},n)=>re.jsx(xa.Separator,{ref:n,className:wn("-mx-1 h-px bg-border",e),...t}));xse.displayName=xa.Separator.displayName;const G7=W.forwardRef(({className:e,...t},n)=>re.jsx(xa.Item,{ref:n,className:wn("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t}));G7.displayName=xa.Item.displayName;const bse=["top","right","bottom","left"],Fl=Math.min,za=Math.max,OS=Math.round,_w=Math.floor,Bh=e=>({x:e,y:e}),wse={left:"right",right:"left",bottom:"top",top:"bottom"},Sse={start:"end",end:"start"};function bO(e,t,n){return za(e,Fl(t,n))}function Hu(e,t){return typeof e=="function"?e(t):e}function qu(e){return e.split("-")[0]}function Wg(e){return e.split("-")[1]}function Ck(e){return e==="x"?"y":"x"}function Pk(e){return e==="y"?"height":"width"}function jh(e){return["top","bottom"].includes(qu(e))?"y":"x"}function Mk(e){return Ck(jh(e))}function Tse(e,t,n){n===void 0&&(n=!1);const o=Wg(e),u=Mk(e),h=Pk(u);let p=u==="x"?o===(n?"end":"start")?"right":"left":o==="start"?"bottom":"top";return t.reference[h]>t.floating[h]&&(p=RS(p)),[p,RS(p)]}function Ese(e){const t=RS(e);return[wO(e),t,wO(t)]}function wO(e){return e.replace(/start|end/g,t=>Sse[t])}function Ase(e,t,n){const o=["left","right"],u=["right","left"],h=["top","bottom"],p=["bottom","top"];switch(e){case"top":case"bottom":return n?t?u:o:t?o:u;case"left":case"right":return t?h:p;default:return[]}}function Cse(e,t,n,o){const u=Wg(e);let h=Ase(qu(e),n==="start",o);return u&&(h=h.map(p=>p+"-"+u),t&&(h=h.concat(h.map(wO)))),h}function RS(e){return e.replace(/left|right|bottom|top/g,t=>wse[t])}function Pse(e){return{top:0,right:0,bottom:0,left:0,...e}}function W7(e){return typeof e!="number"?Pse(e):{top:e,right:e,bottom:e,left:e}}function kS(e){const{x:t,y:n,width:o,height:u}=e;return{width:o,height:u,top:n,left:t,right:t+o,bottom:n+u,x:t,y:n}}function K4(e,t,n){let{reference:o,floating:u}=e;const h=jh(t),p=Mk(t),_=Pk(p),a=qu(t),b=h==="y",C=o.x+o.width/2-u.width/2,A=o.y+o.height/2-u.height/2,O=o[_]/2-u[_]/2;let k;switch(a){case"top":k={x:C,y:o.y-u.height};break;case"bottom":k={x:C,y:o.y+o.height};break;case"right":k={x:o.x+o.width,y:A};break;case"left":k={x:o.x-u.width,y:A};break;default:k={x:o.x,y:o.y}}switch(Wg(t)){case"start":k[p]-=O*(n&&b?-1:1);break;case"end":k[p]+=O*(n&&b?-1:1);break}return k}const Mse=async(e,t,n)=>{const{placement:o="bottom",strategy:u="absolute",middleware:h=[],platform:p}=n,_=h.filter(Boolean),a=await(p.isRTL==null?void 0:p.isRTL(t));let b=await p.getElementRects({reference:e,floating:t,strategy:u}),{x:C,y:A}=K4(b,o,a),O=o,k={},N=0;for(let z=0;z<_.length;z++){const{name:U,fn:j}=_[z],{x:G,y:H,data:Y,reset:K}=await j({x:C,y:A,initialPlacement:o,placement:O,strategy:u,middlewareData:k,rects:b,platform:p,elements:{reference:e,floating:t}});C=G??C,A=H??A,k={...k,[U]:{...k[U],...Y}},K&&N<=50&&(N++,typeof K=="object"&&(K.placement&&(O=K.placement),K.rects&&(b=K.rects===!0?await p.getElementRects({reference:e,floating:t,strategy:u}):K.rects),{x:C,y:A}=K4(b,O,a)),z=-1)}return{x:C,y:A,placement:O,strategy:u,middlewareData:k}};async function E0(e,t){var n;t===void 0&&(t={});const{x:o,y:u,platform:h,rects:p,elements:_,strategy:a}=e,{boundary:b="clippingAncestors",rootBoundary:C="viewport",elementContext:A="floating",altBoundary:O=!1,padding:k=0}=Hu(t,e),N=W7(k),U=_[O?A==="floating"?"reference":"floating":A],j=kS(await h.getClippingRect({element:(n=await(h.isElement==null?void 0:h.isElement(U)))==null||n?U:U.contextElement||await(h.getDocumentElement==null?void 0:h.getDocumentElement(_.floating)),boundary:b,rootBoundary:C,strategy:a})),G=A==="floating"?{x:o,y:u,width:p.floating.width,height:p.floating.height}:p.reference,H=await(h.getOffsetParent==null?void 0:h.getOffsetParent(_.floating)),Y=await(h.isElement==null?void 0:h.isElement(H))?await(h.getScale==null?void 0:h.getScale(H))||{x:1,y:1}:{x:1,y:1},K=kS(h.convertOffsetParentRelativeRectToViewportRelativeRect?await h.convertOffsetParentRelativeRectToViewportRelativeRect({elements:_,rect:G,offsetParent:H,strategy:a}):G);return{top:(j.top-K.top+N.top)/Y.y,bottom:(K.bottom-j.bottom+N.bottom)/Y.y,left:(j.left-K.left+N.left)/Y.x,right:(K.right-j.right+N.right)/Y.x}}const Ise=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:o,placement:u,rects:h,platform:p,elements:_,middlewareData:a}=t,{element:b,padding:C=0}=Hu(e,t)||{};if(b==null)return{};const A=W7(C),O={x:n,y:o},k=Mk(u),N=Pk(k),z=await p.getDimensions(b),U=k==="y",j=U?"top":"left",G=U?"bottom":"right",H=U?"clientHeight":"clientWidth",Y=h.reference[N]+h.reference[k]-O[k]-h.floating[N],K=O[k]-h.reference[k],ee=await(p.getOffsetParent==null?void 0:p.getOffsetParent(b));let ue=ee?ee[H]:0;(!ue||!await(p.isElement==null?void 0:p.isElement(ee)))&&(ue=_.floating[H]||h.floating[N]);const ve=Y/2-K/2,Fe=ue/2-z[N]/2-1,Ne=Fl(A[j],Fe),Oe=Fl(A[G],Fe),Le=Ne,Ue=ue-z[N]-Oe,et=ue/2-z[N]/2+ve,rt=bO(Le,et,Ue),st=!a.arrow&&Wg(u)!=null&&et!==rt&&h.reference[N]/2-(et<Le?Ne:Oe)-z[N]/2<0,Ke=st?et<Le?et-Le:et-Ue:0;return{[k]:O[k]+Ke,data:{[k]:rt,centerOffset:et-rt-Ke,...st&&{alignmentOffset:Ke}},reset:st}}}),Ose=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,o;const{placement:u,middlewareData:h,rects:p,initialPlacement:_,platform:a,elements:b}=t,{mainAxis:C=!0,crossAxis:A=!0,fallbackPlacements:O,fallbackStrategy:k="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:z=!0,...U}=Hu(e,t);if((n=h.arrow)!=null&&n.alignmentOffset)return{};const j=qu(u),G=jh(_),H=qu(_)===_,Y=await(a.isRTL==null?void 0:a.isRTL(b.floating)),K=O||(H||!z?[RS(_)]:Ese(_)),ee=N!=="none";!O&&ee&&K.push(...Cse(_,z,N,Y));const ue=[_,...K],ve=await E0(t,U),Fe=[];let Ne=((o=h.flip)==null?void 0:o.overflows)||[];if(C&&Fe.push(ve[j]),A){const et=Tse(u,p,Y);Fe.push(ve[et[0]],ve[et[1]])}if(Ne=[...Ne,{placement:u,overflows:Fe}],!Fe.every(et=>et<=0)){var Oe,Le;const et=(((Oe=h.flip)==null?void 0:Oe.index)||0)+1,rt=ue[et];if(rt)return{data:{index:et,overflows:Ne},reset:{placement:rt}};let st=(Le=Ne.filter(Ke=>Ke.overflows[0]<=0).sort((Ke,Ze)=>Ke.overflows[1]-Ze.overflows[1])[0])==null?void 0:Le.placement;if(!st)switch(k){case"bestFit":{var Ue;const Ke=(Ue=Ne.filter(Ze=>{if(ee){const Xe=jh(Ze.placement);return Xe===G||Xe==="y"}return!0}).map(Ze=>[Ze.placement,Ze.overflows.filter(Xe=>Xe>0).reduce((Xe,de)=>Xe+de,0)]).sort((Ze,Xe)=>Ze[1]-Xe[1])[0])==null?void 0:Ue[0];Ke&&(st=Ke);break}case"initialPlacement":st=_;break}if(u!==st)return{reset:{placement:st}}}return{}}}};function Q4(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function J4(e){return bse.some(t=>e[t]>=0)}const Rse=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:o="referenceHidden",...u}=Hu(e,t);switch(o){case"referenceHidden":{const h=await E0(t,{...u,elementContext:"reference"}),p=Q4(h,n.reference);return{data:{referenceHiddenOffsets:p,referenceHidden:J4(p)}}}case"escaped":{const h=await E0(t,{...u,altBoundary:!0}),p=Q4(h,n.floating);return{data:{escapedOffsets:p,escaped:J4(p)}}}default:return{}}}}};async function kse(e,t){const{placement:n,platform:o,elements:u}=e,h=await(o.isRTL==null?void 0:o.isRTL(u.floating)),p=qu(n),_=Wg(n),a=jh(n)==="y",b=["left","top"].includes(p)?-1:1,C=h&&a?-1:1,A=Hu(t,e);let{mainAxis:O,crossAxis:k,alignmentAxis:N}=typeof A=="number"?{mainAxis:A,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...A};return _&&typeof N=="number"&&(k=_==="end"?N*-1:N),a?{x:k*C,y:O*b}:{x:O*b,y:k*C}}const Dse=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,o;const{x:u,y:h,placement:p,middlewareData:_}=t,a=await kse(t,e);return p===((n=_.offset)==null?void 0:n.placement)&&(o=_.arrow)!=null&&o.alignmentOffset?{}:{x:u+a.x,y:h+a.y,data:{...a,placement:p}}}}},Lse=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:o,placement:u}=t,{mainAxis:h=!0,crossAxis:p=!1,limiter:_={fn:U=>{let{x:j,y:G}=U;return{x:j,y:G}}},...a}=Hu(e,t),b={x:n,y:o},C=await E0(t,a),A=jh(qu(u)),O=Ck(A);let k=b[O],N=b[A];if(h){const U=O==="y"?"top":"left",j=O==="y"?"bottom":"right",G=k+C[U],H=k-C[j];k=bO(G,k,H)}if(p){const U=A==="y"?"top":"left",j=A==="y"?"bottom":"right",G=N+C[U],H=N-C[j];N=bO(G,N,H)}const z=_.fn({...t,[O]:k,[A]:N});return{...z,data:{x:z.x-n,y:z.y-o}}}}},zse=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:o,placement:u,rects:h,middlewareData:p}=t,{offset:_=0,mainAxis:a=!0,crossAxis:b=!0}=Hu(e,t),C={x:n,y:o},A=jh(u),O=Ck(A);let k=C[O],N=C[A];const z=Hu(_,t),U=typeof z=="number"?{mainAxis:z,crossAxis:0}:{mainAxis:0,crossAxis:0,...z};if(a){const H=O==="y"?"height":"width",Y=h.reference[O]-h.floating[H]+U.mainAxis,K=h.reference[O]+h.reference[H]-U.mainAxis;k<Y?k=Y:k>K&&(k=K)}if(b){var j,G;const H=O==="y"?"width":"height",Y=["top","left"].includes(qu(u)),K=h.reference[A]-h.floating[H]+(Y&&((j=p.offset)==null?void 0:j[A])||0)+(Y?0:U.crossAxis),ee=h.reference[A]+h.reference[H]+(Y?0:((G=p.offset)==null?void 0:G[A])||0)-(Y?U.crossAxis:0);N<K?N=K:N>ee&&(N=ee)}return{[O]:k,[A]:N}}}},Fse=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:o,platform:u,elements:h}=t,{apply:p=()=>{},..._}=Hu(e,t),a=await E0(t,_),b=qu(n),C=Wg(n),A=jh(n)==="y",{width:O,height:k}=o.floating;let N,z;b==="top"||b==="bottom"?(N=b,z=C===(await(u.isRTL==null?void 0:u.isRTL(h.floating))?"start":"end")?"left":"right"):(z=b,N=C==="end"?"top":"bottom");const U=k-a.top-a.bottom,j=O-a.left-a.right,G=Fl(k-a[N],U),H=Fl(O-a[z],j),Y=!t.middlewareData.shift;let K=G,ee=H;if(A?ee=C||Y?Fl(H,j):j:K=C||Y?Fl(G,U):U,Y&&!C){const ve=za(a.left,0),Fe=za(a.right,0),Ne=za(a.top,0),Oe=za(a.bottom,0);A?ee=O-2*(ve!==0||Fe!==0?ve+Fe:za(a.left,a.right)):K=k-2*(Ne!==0||Oe!==0?Ne+Oe:za(a.top,a.bottom))}await p({...t,availableWidth:ee,availableHeight:K});const ue=await u.getDimensions(h.floating);return O!==ue.width||k!==ue.height?{reset:{rects:!0}}:{}}}};function Hg(e){return H7(e)?(e.nodeName||"").toLowerCase():"#document"}function $a(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function nc(e){var t;return(t=(H7(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function H7(e){return e instanceof Node||e instanceof $a(e).Node}function Gl(e){return e instanceof Element||e instanceof $a(e).Element}function Wl(e){return e instanceof HTMLElement||e instanceof $a(e).HTMLElement}function ej(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof $a(e).ShadowRoot}function Ax(e){const{overflow:t,overflowX:n,overflowY:o,display:u}=ol(e);return/auto|scroll|overlay|hidden|clip/.test(t+o+n)&&!["inline","contents"].includes(u)}function Nse(e){return["table","td","th"].includes(Hg(e))}function mE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Ik(e){const t=Ok(),n=ol(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(o=>(n.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(n.contain||"").includes(o))}function Bse(e){let t=$h(e);for(;Wl(t)&&!mg(t);){if(mE(t))return null;if(Ik(t))return t;t=$h(t)}return null}function Ok(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function mg(e){return["html","body","#document"].includes(Hg(e))}function ol(e){return $a(e).getComputedStyle(e)}function gE(e){return Gl(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function $h(e){if(Hg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||ej(e)&&e.host||nc(e);return ej(t)?t.host:t}function q7(e){const t=$h(e);return mg(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wl(t)&&Ax(t)?t:q7(t)}function A0(e,t,n){var o;t===void 0&&(t=[]),n===void 0&&(n=!0);const u=q7(e),h=u===((o=e.ownerDocument)==null?void 0:o.body),p=$a(u);return h?t.concat(p,p.visualViewport||[],Ax(u)?u:[],p.frameElement&&n?A0(p.frameElement):[]):t.concat(u,A0(u,[],n))}function Z7(e){const t=ol(e);let n=parseFloat(t.width)||0,o=parseFloat(t.height)||0;const u=Wl(e),h=u?e.offsetWidth:n,p=u?e.offsetHeight:o,_=OS(n)!==h||OS(o)!==p;return _&&(n=h,o=p),{width:n,height:o,$:_}}function Rk(e){return Gl(e)?e:e.contextElement}function Qm(e){const t=Rk(e);if(!Wl(t))return Bh(1);const n=t.getBoundingClientRect(),{width:o,height:u,$:h}=Z7(t);let p=(h?OS(n.width):n.width)/o,_=(h?OS(n.height):n.height)/u;return(!p||!Number.isFinite(p))&&(p=1),(!_||!Number.isFinite(_))&&(_=1),{x:p,y:_}}const jse=Bh(0);function X7(e){const t=$a(e);return!Ok()||!t.visualViewport?jse:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function $se(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==$a(e)?!1:t}function Bd(e,t,n,o){t===void 0&&(t=!1),n===void 0&&(n=!1);const u=e.getBoundingClientRect(),h=Rk(e);let p=Bh(1);t&&(o?Gl(o)&&(p=Qm(o)):p=Qm(e));const _=$se(h,n,o)?X7(h):Bh(0);let a=(u.left+_.x)/p.x,b=(u.top+_.y)/p.y,C=u.width/p.x,A=u.height/p.y;if(h){const O=$a(h),k=o&&Gl(o)?$a(o):o;let N=O,z=N.frameElement;for(;z&&o&&k!==N;){const U=Qm(z),j=z.getBoundingClientRect(),G=ol(z),H=j.left+(z.clientLeft+parseFloat(G.paddingLeft))*U.x,Y=j.top+(z.clientTop+parseFloat(G.paddingTop))*U.y;a*=U.x,b*=U.y,C*=U.x,A*=U.y,a+=H,b+=Y,N=$a(z),z=N.frameElement}}return kS({width:C,height:A,x:a,y:b})}function Use(e){let{elements:t,rect:n,offsetParent:o,strategy:u}=e;const h=u==="fixed",p=nc(o),_=t?mE(t.floating):!1;if(o===p||_&&h)return n;let a={scrollLeft:0,scrollTop:0},b=Bh(1);const C=Bh(0),A=Wl(o);if((A||!A&&!h)&&((Hg(o)!=="body"||Ax(p))&&(a=gE(o)),Wl(o))){const O=Bd(o);b=Qm(o),C.x=O.x+o.clientLeft,C.y=O.y+o.clientTop}return{width:n.width*b.x,height:n.height*b.y,x:n.x*b.x-a.scrollLeft*b.x+C.x,y:n.y*b.y-a.scrollTop*b.y+C.y}}function Vse(e){return Array.from(e.getClientRects())}function Y7(e){return Bd(nc(e)).left+gE(e).scrollLeft}function Gse(e){const t=nc(e),n=gE(e),o=e.ownerDocument.body,u=za(t.scrollWidth,t.clientWidth,o.scrollWidth,o.clientWidth),h=za(t.scrollHeight,t.clientHeight,o.scrollHeight,o.clientHeight);let p=-n.scrollLeft+Y7(e);const _=-n.scrollTop;return ol(o).direction==="rtl"&&(p+=za(t.clientWidth,o.clientWidth)-u),{width:u,height:h,x:p,y:_}}function Wse(e,t){const n=$a(e),o=nc(e),u=n.visualViewport;let h=o.clientWidth,p=o.clientHeight,_=0,a=0;if(u){h=u.width,p=u.height;const b=Ok();(!b||b&&t==="fixed")&&(_=u.offsetLeft,a=u.offsetTop)}return{width:h,height:p,x:_,y:a}}function Hse(e,t){const n=Bd(e,!0,t==="fixed"),o=n.top+e.clientTop,u=n.left+e.clientLeft,h=Wl(e)?Qm(e):Bh(1),p=e.clientWidth*h.x,_=e.clientHeight*h.y,a=u*h.x,b=o*h.y;return{width:p,height:_,x:a,y:b}}function tj(e,t,n){let o;if(t==="viewport")o=Wse(e,n);else if(t==="document")o=Gse(nc(e));else if(Gl(t))o=Hse(t,n);else{const u=X7(e);o={...t,x:t.x-u.x,y:t.y-u.y}}return kS(o)}function K7(e,t){const n=$h(e);return n===t||!Gl(n)||mg(n)?!1:ol(n).position==="fixed"||K7(n,t)}function qse(e,t){const n=t.get(e);if(n)return n;let o=A0(e,[],!1).filter(_=>Gl(_)&&Hg(_)!=="body"),u=null;const h=ol(e).position==="fixed";let p=h?$h(e):e;for(;Gl(p)&&!mg(p);){const _=ol(p),a=Ik(p);!a&&_.position==="fixed"&&(u=null),(h?!a&&!u:!a&&_.position==="static"&&!!u&&["absolute","fixed"].includes(u.position)||Ax(p)&&!a&&K7(e,p))?o=o.filter(C=>C!==p):u=_,p=$h(p)}return t.set(e,o),o}function Zse(e){let{element:t,boundary:n,rootBoundary:o,strategy:u}=e;const p=[...n==="clippingAncestors"?mE(t)?[]:qse(t,this._c):[].concat(n),o],_=p[0],a=p.reduce((b,C)=>{const A=tj(t,C,u);return b.top=za(A.top,b.top),b.right=Fl(A.right,b.right),b.bottom=Fl(A.bottom,b.bottom),b.left=za(A.left,b.left),b},tj(t,_,u));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function Xse(e){const{width:t,height:n}=Z7(e);return{width:t,height:n}}function Yse(e,t,n){const o=Wl(t),u=nc(t),h=n==="fixed",p=Bd(e,!0,h,t);let _={scrollLeft:0,scrollTop:0};const a=Bh(0);if(o||!o&&!h)if((Hg(t)!=="body"||Ax(u))&&(_=gE(t)),o){const A=Bd(t,!0,h,t);a.x=A.x+t.clientLeft,a.y=A.y+t.clientTop}else u&&(a.x=Y7(u));const b=p.left+_.scrollLeft-a.x,C=p.top+_.scrollTop-a.y;return{x:b,y:C,width:p.width,height:p.height}}function yM(e){return ol(e).position==="static"}function nj(e,t){return!Wl(e)||ol(e).position==="fixed"?null:t?t(e):e.offsetParent}function Q7(e,t){const n=$a(e);if(mE(e))return n;if(!Wl(e)){let u=$h(e);for(;u&&!mg(u);){if(Gl(u)&&!yM(u))return u;u=$h(u)}return n}let o=nj(e,t);for(;o&&Nse(o)&&yM(o);)o=nj(o,t);return o&&mg(o)&&yM(o)&&!Ik(o)?n:o||Bse(e)||n}const Kse=async function(e){const t=this.getOffsetParent||Q7,n=this.getDimensions,o=await n(e.floating);return{reference:Yse(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}};function Qse(e){return ol(e).direction==="rtl"}const Jse={convertOffsetParentRelativeRectToViewportRelativeRect:Use,getDocumentElement:nc,getClippingRect:Zse,getOffsetParent:Q7,getElementRects:Kse,getClientRects:Vse,getDimensions:Xse,getScale:Qm,isElement:Gl,isRTL:Qse};function ele(e,t){let n=null,o;const u=nc(e);function h(){var _;clearTimeout(o),(_=n)==null||_.disconnect(),n=null}function p(_,a){_===void 0&&(_=!1),a===void 0&&(a=1),h();const{left:b,top:C,width:A,height:O}=e.getBoundingClientRect();if(_||t(),!A||!O)return;const k=_w(C),N=_w(u.clientWidth-(b+A)),z=_w(u.clientHeight-(C+O)),U=_w(b),G={rootMargin:-k+"px "+-N+"px "+-z+"px "+-U+"px",threshold:za(0,Fl(1,a))||1};let H=!0;function Y(K){const ee=K[0].intersectionRatio;if(ee!==a){if(!H)return p();ee?p(!1,ee):o=setTimeout(()=>{p(!1,1e-7)},1e3)}H=!1}try{n=new IntersectionObserver(Y,{...G,root:u.ownerDocument})}catch{n=new IntersectionObserver(Y,G)}n.observe(e)}return p(!0),h}function tle(e,t,n,o){o===void 0&&(o={});const{ancestorScroll:u=!0,ancestorResize:h=!0,elementResize:p=typeof ResizeObserver=="function",layoutShift:_=typeof IntersectionObserver=="function",animationFrame:a=!1}=o,b=Rk(e),C=u||h?[...b?A0(b):[],...A0(t)]:[];C.forEach(j=>{u&&j.addEventListener("scroll",n,{passive:!0}),h&&j.addEventListener("resize",n)});const A=b&&_?ele(b,n):null;let O=-1,k=null;p&&(k=new ResizeObserver(j=>{let[G]=j;G&&G.target===b&&k&&(k.unobserve(t),cancelAnimationFrame(O),O=requestAnimationFrame(()=>{var H;(H=k)==null||H.observe(t)})),n()}),b&&!a&&k.observe(b),k.observe(t));let N,z=a?Bd(e):null;a&&U();function U(){const j=Bd(e);z&&(j.x!==z.x||j.y!==z.y||j.width!==z.width||j.height!==z.height)&&n(),z=j,N=requestAnimationFrame(U)}return n(),()=>{var j;C.forEach(G=>{u&&G.removeEventListener("scroll",n),h&&G.removeEventListener("resize",n)}),A==null||A(),(j=k)==null||j.disconnect(),k=null,a&&cancelAnimationFrame(N)}}const nle=Dse,rle=Lse,ile=Ose,ole=Fse,ale=Rse,rj=Ise,sle=zse,lle=(e,t,n)=>{const o=new Map,u={platform:Jse,...n},h={...u.platform,_c:o};return Mse(e,t,{...u,platform:h})};var eS=typeof document<"u"?W.useLayoutEffect:W.useEffect;function DS(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,o,u;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(o=n;o--!==0;)if(!DS(e[o],t[o]))return!1;return!0}if(u=Object.keys(e),n=u.length,n!==Object.keys(t).length)return!1;for(o=n;o--!==0;)if(!{}.hasOwnProperty.call(t,u[o]))return!1;for(o=n;o--!==0;){const h=u[o];if(!(h==="_owner"&&e.$$typeof)&&!DS(e[h],t[h]))return!1}return!0}return e!==e&&t!==t}function J7(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ij(e,t){const n=J7(e);return Math.round(t*n)/n}function oj(e){const t=W.useRef(e);return eS(()=>{t.current=e}),t}function ule(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:o=[],platform:u,elements:{reference:h,floating:p}={},transform:_=!0,whileElementsMounted:a,open:b}=e,[C,A]=W.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[O,k]=W.useState(o);DS(O,o)||k(o);const[N,z]=W.useState(null),[U,j]=W.useState(null),G=W.useCallback(Ke=>{Ke!==ee.current&&(ee.current=Ke,z(Ke))},[]),H=W.useCallback(Ke=>{Ke!==ue.current&&(ue.current=Ke,j(Ke))},[]),Y=h||N,K=p||U,ee=W.useRef(null),ue=W.useRef(null),ve=W.useRef(C),Fe=a!=null,Ne=oj(a),Oe=oj(u),Le=W.useCallback(()=>{if(!ee.current||!ue.current)return;const Ke={placement:t,strategy:n,middleware:O};Oe.current&&(Ke.platform=Oe.current),lle(ee.current,ue.current,Ke).then(Ze=>{const Xe={...Ze,isPositioned:!0};Ue.current&&!DS(ve.current,Xe)&&(ve.current=Xe,ec.flushSync(()=>{A(Xe)}))})},[O,t,n,Oe]);eS(()=>{b===!1&&ve.current.isPositioned&&(ve.current.isPositioned=!1,A(Ke=>({...Ke,isPositioned:!1})))},[b]);const Ue=W.useRef(!1);eS(()=>(Ue.current=!0,()=>{Ue.current=!1}),[]),eS(()=>{if(Y&&(ee.current=Y),K&&(ue.current=K),Y&&K){if(Ne.current)return Ne.current(Y,K,Le);Le()}},[Y,K,Le,Ne,Fe]);const et=W.useMemo(()=>({reference:ee,floating:ue,setReference:G,setFloating:H}),[G,H]),rt=W.useMemo(()=>({reference:Y,floating:K}),[Y,K]),st=W.useMemo(()=>{const Ke={position:n,left:0,top:0};if(!rt.floating)return Ke;const Ze=ij(rt.floating,C.x),Xe=ij(rt.floating,C.y);return _?{...Ke,transform:"translate("+Ze+"px, "+Xe+"px)",...J7(rt.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:Ze,top:Xe}},[n,_,rt.floating,C.x,C.y]);return W.useMemo(()=>({...C,update:Le,refs:et,elements:rt,floatingStyles:st}),[C,Le,et,rt,st])}const cle=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:o,padding:u}=typeof e=="function"?e(n):e;return o&&t(o)?o.current!=null?rj({element:o.current,padding:u}).fn(n):{}:o?rj({element:o,padding:u}).fn(n):{}}}},hle=(e,t)=>({...nle(e),options:[e,t]}),fle=(e,t)=>({...rle(e),options:[e,t]}),dle=(e,t)=>({...sle(e),options:[e,t]}),ple=(e,t)=>({...ile(e),options:[e,t]}),mle=(e,t)=>({...ole(e),options:[e,t]}),gle=(e,t)=>({...ale(e),options:[e,t]}),yle=(e,t)=>({...cle(e),options:[e,t]});var _le="Arrow",eW=W.forwardRef((e,t)=>{const{children:n,width:o=10,height:u=5,...h}=e;return re.jsx(fr.svg,{...h,ref:t,width:o,height:u,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:re.jsx("polygon",{points:"0,0 30,0 15,10"})})});eW.displayName=_le;var vle=eW,kk="Popper",[tW,qg]=tc(kk),[xle,nW]=tW(kk),rW=e=>{const{__scopePopper:t,children:n}=e,[o,u]=W.useState(null);return re.jsx(xle,{scope:t,anchor:o,onAnchorChange:u,children:n})};rW.displayName=kk;var iW="PopperAnchor",oW=W.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:o,...u}=e,h=nW(iW,n),p=W.useRef(null),_=Fr(t,p);return W.useEffect(()=>{h.onAnchorChange((o==null?void 0:o.current)||p.current)}),o?null:re.jsx(fr.div,{...u,ref:_})});oW.displayName=iW;var Dk="PopperContent",[ble,wle]=tW(Dk),aW=W.forwardRef((e,t)=>{var Wt,An,ht,Zt,jt,At;const{__scopePopper:n,side:o="bottom",sideOffset:u=0,align:h="center",alignOffset:p=0,arrowPadding:_=0,avoidCollisions:a=!0,collisionBoundary:b=[],collisionPadding:C=0,sticky:A="partial",hideWhenDetached:O=!1,updatePositionStrategy:k="optimized",onPlaced:N,...z}=e,U=nW(Dk,n),[j,G]=W.useState(null),H=Fr(t,er=>G(er)),[Y,K]=W.useState(null),ee=IG(Y),ue=(ee==null?void 0:ee.width)??0,ve=(ee==null?void 0:ee.height)??0,Fe=o+(h!=="center"?"-"+h:""),Ne=typeof C=="number"?C:{top:0,right:0,bottom:0,left:0,...C},Oe=Array.isArray(b)?b:[b],Le=Oe.length>0,Ue={padding:Ne,boundary:Oe.filter(Tle),altBoundary:Le},{refs:et,floatingStyles:rt,placement:st,isPositioned:Ke,middlewareData:Ze}=ule({strategy:"fixed",placement:Fe,whileElementsMounted:(...er)=>tle(...er,{animationFrame:k==="always"}),elements:{reference:U.anchor},middleware:[hle({mainAxis:u+ve,alignmentAxis:p}),a&&fle({mainAxis:!0,crossAxis:!1,limiter:A==="partial"?dle():void 0,...Ue}),a&&ple({...Ue}),mle({...Ue,apply:({elements:er,rects:Rn,availableWidth:_r,availableHeight:dr})=>{const{width:vr,height:Zr}=Rn.reference,Ii=er.floating.style;Ii.setProperty("--radix-popper-available-width",`${_r}px`),Ii.setProperty("--radix-popper-available-height",`${dr}px`),Ii.setProperty("--radix-popper-anchor-width",`${vr}px`),Ii.setProperty("--radix-popper-anchor-height",`${Zr}px`)}}),Y&&yle({element:Y,padding:_}),Ele({arrowWidth:ue,arrowHeight:ve}),O&&gle({strategy:"referenceHidden",...Ue})]}),[Xe,de]=uW(st),lt=Ss(N);Xo(()=>{Ke&&(lt==null||lt())},[Ke,lt]);const gt=(Wt=Ze.arrow)==null?void 0:Wt.x,Se=(An=Ze.arrow)==null?void 0:An.y,qt=((ht=Ze.arrow)==null?void 0:ht.centerOffset)!==0,[an,dn]=W.useState();return Xo(()=>{j&&dn(window.getComputedStyle(j).zIndex)},[j]),re.jsx("div",{ref:et.setFloating,"data-radix-popper-content-wrapper":"",style:{...rt,transform:Ke?rt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:an,"--radix-popper-transform-origin":[(Zt=Ze.transformOrigin)==null?void 0:Zt.x,(jt=Ze.transformOrigin)==null?void 0:jt.y].join(" "),...((At=Ze.hide)==null?void 0:At.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:re.jsx(ble,{scope:n,placedSide:Xe,onArrowChange:K,arrowX:gt,arrowY:Se,shouldHideArrow:qt,children:re.jsx(fr.div,{"data-side":Xe,"data-align":de,...z,ref:H,style:{...z.style,animation:Ke?void 0:"none"}})})})});aW.displayName=Dk;var sW="PopperArrow",Sle={top:"bottom",right:"left",bottom:"top",left:"right"},lW=W.forwardRef(function(t,n){const{__scopePopper:o,...u}=t,h=wle(sW,o),p=Sle[h.placedSide];return re.jsx("span",{ref:h.onArrowChange,style:{position:"absolute",left:h.arrowX,top:h.arrowY,[p]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[h.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[h.placedSide],visibility:h.shouldHideArrow?"hidden":void 0},children:re.jsx(vle,{...u,ref:n,style:{...u.style,display:"block"}})})});lW.displayName=sW;function Tle(e){return e!==null}var Ele=e=>({name:"transformOrigin",options:e,fn(t){var U,j,G;const{placement:n,rects:o,middlewareData:u}=t,p=((U=u.arrow)==null?void 0:U.centerOffset)!==0,_=p?0:e.arrowWidth,a=p?0:e.arrowHeight,[b,C]=uW(n),A={start:"0%",center:"50%",end:"100%"}[C],O=(((j=u.arrow)==null?void 0:j.x)??0)+_/2,k=(((G=u.arrow)==null?void 0:G.y)??0)+a/2;let N="",z="";return b==="bottom"?(N=p?A:`${O}px`,z=`${-a}px`):b==="top"?(N=p?A:`${O}px`,z=`${o.floating.height+a}px`):b==="right"?(N=`${-a}px`,z=p?A:`${k}px`):b==="left"&&(N=`${o.floating.width+a}px`,z=p?A:`${k}px`),{data:{x:N,y:z}}}});function uW(e){const[t,n="center"]=e.split("-");return[t,n]}var Lk=rW,yE=oW,zk=aW,Fk=lW,Nk="Popover",[cW,bje]=tc(Nk,[qg]),Cx=qg(),[Ale,Hh]=cW(Nk),hW=e=>{const{__scopePopover:t,children:n,open:o,defaultOpen:u,onOpenChange:h,modal:p=!1}=e,_=Cx(t),a=W.useRef(null),[b,C]=W.useState(!1),[A=!1,O]=pg({prop:o,defaultProp:u,onChange:h});return re.jsx(Lk,{..._,children:re.jsx(Ale,{scope:t,contentId:Dh(),triggerRef:a,open:A,onOpenChange:O,onOpenToggle:W.useCallback(()=>O(k=>!k),[O]),hasCustomAnchor:b,onCustomAnchorAdd:W.useCallback(()=>C(!0),[]),onCustomAnchorRemove:W.useCallback(()=>C(!1),[]),modal:p,children:n})})};hW.displayName=Nk;var fW="PopoverAnchor",Cle=W.forwardRef((e,t)=>{const{__scopePopover:n,...o}=e,u=Hh(fW,n),h=Cx(n),{onCustomAnchorAdd:p,onCustomAnchorRemove:_}=u;return W.useEffect(()=>(p(),()=>_()),[p,_]),re.jsx(yE,{...h,...o,ref:t})});Cle.displayName=fW;var dW="PopoverTrigger",pW=W.forwardRef((e,t)=>{const{__scopePopover:n,...o}=e,u=Hh(dW,n),h=Cx(n),p=Fr(t,u.triggerRef),_=re.jsx(fr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":u.open,"aria-controls":u.contentId,"data-state":vW(u.open),...o,ref:p,onClick:hn(e.onClick,u.onOpenToggle)});return u.hasCustomAnchor?_:re.jsx(yE,{asChild:!0,...h,children:_})});pW.displayName=dW;var Bk="PopoverPortal",[Ple,Mle]=cW(Bk,{forceMount:void 0}),mW=e=>{const{__scopePopover:t,forceMount:n,children:o,container:u}=e,h=Hh(Bk,t);return re.jsx(Ple,{scope:t,forceMount:n,children:re.jsx(al,{present:n||h.open,children:re.jsx(Tx,{asChild:!0,container:u,children:o})})})};mW.displayName=Bk;var gg="PopoverContent",gW=W.forwardRef((e,t)=>{const n=Mle(gg,e.__scopePopover),{forceMount:o=n.forceMount,...u}=e,h=Hh(gg,e.__scopePopover);return re.jsx(al,{present:o||h.open,children:h.modal?re.jsx(Ile,{...u,ref:t}):re.jsx(Ole,{...u,ref:t})})});gW.displayName=gg;var Ile=W.forwardRef((e,t)=>{const n=Hh(gg,e.__scopePopover),o=W.useRef(null),u=Fr(t,o),h=W.useRef(!1);return W.useEffect(()=>{const p=o.current;if(p)return vx(p)},[]),re.jsx(Ex,{as:Wu,allowPinchZoom:!0,children:re.jsx(yW,{...e,ref:u,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:hn(e.onCloseAutoFocus,p=>{var _;p.preventDefault(),h.current||(_=n.triggerRef.current)==null||_.focus()}),onPointerDownOutside:hn(e.onPointerDownOutside,p=>{const _=p.detail.originalEvent,a=_.button===0&&_.ctrlKey===!0,b=_.button===2||a;h.current=b},{checkForDefaultPrevented:!1}),onFocusOutside:hn(e.onFocusOutside,p=>p.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ole=W.forwardRef((e,t)=>{const n=Hh(gg,e.__scopePopover),o=W.useRef(!1),u=W.useRef(!1);return re.jsx(yW,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:h=>{var p,_;(p=e.onCloseAutoFocus)==null||p.call(e,h),h.defaultPrevented||(o.current||(_=n.triggerRef.current)==null||_.focus(),h.preventDefault()),o.current=!1,u.current=!1},onInteractOutside:h=>{var a,b;(a=e.onInteractOutside)==null||a.call(e,h),h.defaultPrevented||(o.current=!0,h.detail.originalEvent.type==="pointerdown"&&(u.current=!0));const p=h.target;((b=n.triggerRef.current)==null?void 0:b.contains(p))&&h.preventDefault(),h.detail.originalEvent.type==="focusin"&&u.current&&h.preventDefault()}})}),yW=W.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:o,onOpenAutoFocus:u,onCloseAutoFocus:h,disableOutsidePointerEvents:p,onEscapeKeyDown:_,onPointerDownOutside:a,onFocusOutside:b,onInteractOutside:C,...A}=e,O=Hh(gg,n),k=Cx(n);return dE(),re.jsx(Sx,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:u,onUnmountAutoFocus:h,children:re.jsx(wx,{asChild:!0,disableOutsidePointerEvents:p,onInteractOutside:C,onEscapeKeyDown:_,onPointerDownOutside:a,onFocusOutside:b,onDismiss:()=>O.onOpenChange(!1),children:re.jsx(zk,{"data-state":vW(O.open),role:"dialog",id:O.contentId,...k,...A,ref:t,style:{...A.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),_W="PopoverClose",Rle=W.forwardRef((e,t)=>{const{__scopePopover:n,...o}=e,u=Hh(_W,n);return re.jsx(fr.button,{type:"button",...o,ref:t,onClick:hn(e.onClick,()=>u.onOpenChange(!1))})});Rle.displayName=_W;var kle="PopoverArrow",Dle=W.forwardRef((e,t)=>{const{__scopePopover:n,...o}=e,u=Cx(n);return re.jsx(Fk,{...u,...o,ref:t})});Dle.displayName=kle;function vW(e){return e?"open":"closed"}var Lle=hW,zle=pW,Fle=mW,xW=gW;const Nle=Lle,Ble=zle,bW=W.forwardRef(({className:e,align:t="center",sideOffset:n=4,...o},u)=>re.jsx(Fle,{children:re.jsx(xW,{ref:u,align:t,sideOffset:n,className:wn("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...o})}));bW.displayName=xW.displayName;function wW({regions:e,setRegion:t,disabled:n,hidden:o}){var b;const[u,h]=W.useState(!1),[p,_]=W.useState("");W.useEffect(()=>{var C;t(((C=e.find(A=>A.value===p))==null?void 0:C.code)??null)},[e,t,p]),e=e.map(C=>({value:(C.name+" "+C.code+" "+C.area).toLowerCase(),label:C.name,code:C.code,area:C.area}));const a=Object.entries(Object.groupBy(e,C=>C.area));return re.jsxs(Nle,{open:u,onOpenChange:h,children:[re.jsx(Ble,{asChild:!0,children:re.jsxs(dg,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-[200px] justify-between"+(o?" hidden":""),disabled:n,children:[p?(b=e.find(C=>C.value===p))==null?void 0:b.label:"Select region...",re.jsx(Die,{className:"w-4 h-4 ml-2 opacity-50 shrink-0"})]})}),re.jsx(bW,{className:"w-[200px] p-2",children:re.jsxs(B7,{children:[re.jsx(j7,{placeholder:"Search region..."}),re.jsxs($7,{children:[re.jsx(U7,{children:"No region found."}),a.map(([C,A])=>re.jsx(V7,{heading:C.toUpperCase(),children:A.map(O=>re.jsxs(G7,{value:O.value,onSelect:k=>{_(k===p?"":k),h(!1)},children:[re.jsx(lE,{className:wn("mr-2 h-4 w-4",p===O.value?"opacity-100":"opacity-0")}),O.label]},O.value))},C))]})]})})]})}wW.propTypes={regions:En.array.isRequired,setRegion:En.func.isRequired,disabled:En.bool,hidden:En.bool};async function jle(e){return(await(await fetch(`https://dns.google/resolve?name=${e}`)).json()).Answer[0].data}async function $le(e){return{latitude:Math.random()*180-90,longitude:Math.random()*360-180}}mk(jle);mk($le);const Ule="pk.eyJ1IjoiYmhhdmppdGNoYXVoYW4iLCJhIjoiY2x5MG95ejEzMGhuMDJtb2tvb3RpZHMyMiJ9.fJafGFJkITooEewonltjGw",Ur=Object.freeze({User:"user",Region:"region",Host:"host",Website:"website"});function SW({regions:e,setLocation:t}){const[n,o]=W.useState(Ur.User),[u,h]=W.useState(null),[p,_]=W.useState(""),[a,b]=W.useState(null),[C,A]=W.useState(null),[O,k]=W.useState(""),N=W.useRef(n!==Ur.User?n:Ur.Region);W.useEffect(()=>{(async()=>{switch(n){case Ur.User:t({type:Ur.User});break;case Ur.Region:const U=e.find(j=>j.code===u);t({...U,type:Ur.Region}),A(U?U.name:null);break;case Ur.Host:break;case Ur.Website:{p&&(t({type:Ur.Website,url:p}),k(p));break}}})()},[n,u,p]),W.useEffect(()=>{n===Ur.User&&navigator.geolocation.getCurrentPosition(async U=>{var H;const{latitude:j,longitude:G}=U.coords;try{const ee=((H=(await(await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${G},${j}.json?access_token=${Ule}`)).json()).features[0])==null?void 0:H.place_name)||"Unknown location";b(ee)}catch(Y){console.error("Error getting location:",Y),b("Unable to retrieve location")}},U=>{console.error("Error getting location:",U),b("Unable to retrieve location")})},[n]);function z(){const U=n===Ur.Region?Ur.Website:Ur.Region;o(U),N.current=U}return re.jsxs(oE,{children:[re.jsxs(aE,{children:[re.jsx(yk,{children:"Location"}),n===Ur.User&&re.jsx(qv,{children:a||"Fetching..."}),n===Ur.Region&&C&&re.jsx(qv,{children:C}),n===Ur.Website&&O&&re.jsx(qv,{children:O}),re.jsx("div",{class:"border-b-2 pt-0 border-dotted border-gray-300"})]}),re.jsx(sE,{children:re.jsxs("div",{className:"flex gap-2 align-middle",children:[re.jsx(wW,{regions:e,setRegion:h,disabled:n!==Ur.Region,hidden:n!==Ur.Region}),n!==Ur.Region&&re.jsx(MS,{disabled:!0,placeholder:n===Ur.User?"Regions":"AWS Region",className:"w-fit"}),re.jsx(dg,{onClick:z,variant:"outline",size:"icon",className:"aspect-square",disabled:n===Ur.User,children:re.jsx(Mie,{className:"w-4 h-4"})}),re.jsx(MS,{placeholder:n===Ur.Website?"Website URL":"AWS regions",className:"w-fit",disabled:n!==Ur.Website,onBlur:U=>_(U.target.value),onKeyPress:U=>U.key==="Enter"&&_(U.target.value)}),re.jsxs("div",{className:"flex items-center gap-2 pl-4",children:[re.jsx(uE,{id:"user-location-checkbox",checked:n===Ur.User,onClick:()=>o(n===Ur.User?N.current:Ur.User)}),re.jsx("label",{htmlFor:"user-location-checkbox",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Use my location"})]})]})})]})}SW.propTypes={regions:En.array.isRequired,setLocation:En.func.isRequired};function aj(e,[t,n]){return Math.min(n,Math.max(t,e))}function _E(e){const t=e+"CollectionProvider",[n,o]=tc(t),[u,h]=n(t,{collectionRef:{current:null},itemMap:new Map}),p=k=>{const{scope:N,children:z}=k,U=Ye.useRef(null),j=Ye.useRef(new Map).current;return re.jsx(u,{scope:N,itemMap:j,collectionRef:U,children:z})};p.displayName=t;const _=e+"CollectionSlot",a=Ye.forwardRef((k,N)=>{const{scope:z,children:U}=k,j=h(_,z),G=Fr(N,j.collectionRef);return re.jsx(Wu,{ref:G,children:U})});a.displayName=_;const b=e+"CollectionItemSlot",C="data-radix-collection-item",A=Ye.forwardRef((k,N)=>{const{scope:z,children:U,...j}=k,G=Ye.useRef(null),H=Fr(N,G),Y=h(b,z);return Ye.useEffect(()=>(Y.itemMap.set(G,{ref:G,...j}),()=>void Y.itemMap.delete(G))),re.jsx(Wu,{[C]:"",ref:H,children:U})});A.displayName=b;function O(k){const N=h(e+"CollectionConsumer",k);return Ye.useCallback(()=>{const U=N.collectionRef.current;if(!U)return[];const j=Array.from(U.querySelectorAll(`[${C}]`));return Array.from(N.itemMap.values()).sort((Y,K)=>j.indexOf(Y.ref.current)-j.indexOf(K.ref.current))},[N.collectionRef,N.itemMap])}return[{Provider:p,Slot:a,ItemSlot:A},O,o]}var Vle=W.createContext(void 0);function vE(e){const t=W.useContext(Vle);return e||t||"ltr"}var Gle="VisuallyHidden",TW=W.forwardRef((e,t)=>re.jsx(fr.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));TW.displayName=Gle;var Wle=[" ","Enter","ArrowUp","ArrowDown"],Hle=[" ","Enter"],Px="Select",[xE,bE,qle]=_E(Px),[Zg,wje]=tc(Px,[qle,qg]),wE=qg(),[Zle,qh]=Zg(Px),[Xle,Yle]=Zg(Px),EW=e=>{const{__scopeSelect:t,children:n,open:o,defaultOpen:u,onOpenChange:h,value:p,defaultValue:_,onValueChange:a,dir:b,name:C,autoComplete:A,disabled:O,required:k}=e,N=wE(t),[z,U]=W.useState(null),[j,G]=W.useState(null),[H,Y]=W.useState(!1),K=vE(b),[ee=!1,ue]=pg({prop:o,defaultProp:u,onChange:h}),[ve,Fe]=pg({prop:p,defaultProp:_,onChange:a}),Ne=W.useRef(null),Oe=z?!!z.closest("form"):!0,[Le,Ue]=W.useState(new Set),et=Array.from(Le).map(rt=>rt.props.value).join(";");return re.jsx(Lk,{...N,children:re.jsxs(Zle,{required:k,scope:t,trigger:z,onTriggerChange:U,valueNode:j,onValueNodeChange:G,valueNodeHasChildren:H,onValueNodeHasChildrenChange:Y,contentId:Dh(),value:ve,onValueChange:Fe,open:ee,onOpenChange:ue,dir:K,triggerPointerDownPosRef:Ne,disabled:O,children:[re.jsx(xE.Provider,{scope:t,children:re.jsx(Xle,{scope:e.__scopeSelect,onNativeOptionAdd:W.useCallback(rt=>{Ue(st=>new Set(st).add(rt))},[]),onNativeOptionRemove:W.useCallback(rt=>{Ue(st=>{const Ke=new Set(st);return Ke.delete(rt),Ke})},[]),children:n})}),Oe?re.jsxs(YW,{"aria-hidden":!0,required:k,tabIndex:-1,name:C,autoComplete:A,value:ve,onChange:rt=>Fe(rt.target.value),disabled:O,children:[ve===void 0?re.jsx("option",{value:""}):null,Array.from(Le)]},et):null]})})};EW.displayName=Px;var AW="SelectTrigger",CW=W.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:o=!1,...u}=e,h=wE(n),p=qh(AW,n),_=p.disabled||o,a=Fr(t,p.onTriggerChange),b=bE(n),[C,A,O]=KW(N=>{const z=b().filter(G=>!G.disabled),U=z.find(G=>G.value===p.value),j=QW(z,N,U);j!==void 0&&p.onValueChange(j.value)}),k=()=>{_||(p.onOpenChange(!0),O())};return re.jsx(yE,{asChild:!0,...h,children:re.jsx(fr.button,{type:"button",role:"combobox","aria-controls":p.contentId,"aria-expanded":p.open,"aria-required":p.required,"aria-autocomplete":"none",dir:p.dir,"data-state":p.open?"open":"closed",disabled:_,"data-disabled":_?"":void 0,"data-placeholder":XW(p.value)?"":void 0,...u,ref:a,onClick:hn(u.onClick,N=>{N.currentTarget.focus()}),onPointerDown:hn(u.onPointerDown,N=>{const z=N.target;z.hasPointerCapture(N.pointerId)&&z.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&(k(),p.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)},N.preventDefault())}),onKeyDown:hn(u.onKeyDown,N=>{const z=C.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&A(N.key),!(z&&N.key===" ")&&Wle.includes(N.key)&&(k(),N.preventDefault())})})})});CW.displayName=AW;var PW="SelectValue",MW=W.forwardRef((e,t)=>{const{__scopeSelect:n,className:o,style:u,children:h,placeholder:p="",..._}=e,a=qh(PW,n),{onValueNodeHasChildrenChange:b}=a,C=h!==void 0,A=Fr(t,a.onValueNodeChange);return Xo(()=>{b(C)},[b,C]),re.jsx(fr.span,{..._,ref:A,style:{pointerEvents:"none"},children:XW(a.value)?re.jsx(re.Fragment,{children:p}):h})});MW.displayName=PW;var Kle="SelectIcon",IW=W.forwardRef((e,t)=>{const{__scopeSelect:n,children:o,...u}=e;return re.jsx(fr.span,{"aria-hidden":!0,...u,ref:t,children:o||""})});IW.displayName=Kle;var Qle="SelectPortal",OW=e=>re.jsx(Tx,{asChild:!0,...e});OW.displayName=Qle;var jd="SelectContent",RW=W.forwardRef((e,t)=>{const n=qh(jd,e.__scopeSelect),[o,u]=W.useState();if(Xo(()=>{u(new DocumentFragment)},[]),!n.open){const h=o;return h?ec.createPortal(re.jsx(kW,{scope:e.__scopeSelect,children:re.jsx(xE.Slot,{scope:e.__scopeSelect,children:re.jsx("div",{children:e.children})})}),h):null}return re.jsx(DW,{...e,ref:t})});RW.displayName=jd;var Pu=10,[kW,Zh]=Zg(jd),Jle="SelectContentImpl",DW=W.forwardRef((e,t)=>{const{__scopeSelect:n,position:o="item-aligned",onCloseAutoFocus:u,onEscapeKeyDown:h,onPointerDownOutside:p,side:_,sideOffset:a,align:b,alignOffset:C,arrowPadding:A,collisionBoundary:O,collisionPadding:k,sticky:N,hideWhenDetached:z,avoidCollisions:U,...j}=e,G=qh(jd,n),[H,Y]=W.useState(null),[K,ee]=W.useState(null),ue=Fr(t,Wt=>Y(Wt)),[ve,Fe]=W.useState(null),[Ne,Oe]=W.useState(null),Le=bE(n),[Ue,et]=W.useState(!1),rt=W.useRef(!1);W.useEffect(()=>{if(H)return vx(H)},[H]),dE();const st=W.useCallback(Wt=>{const[An,...ht]=Le().map(At=>At.ref.current),[Zt]=ht.slice(-1),jt=document.activeElement;for(const At of Wt)if(At===jt||(At==null||At.scrollIntoView({block:"nearest"}),At===An&&K&&(K.scrollTop=0),At===Zt&&K&&(K.scrollTop=K.scrollHeight),At==null||At.focus(),document.activeElement!==jt))return},[Le,K]),Ke=W.useCallback(()=>st([ve,H]),[st,ve,H]);W.useEffect(()=>{Ue&&Ke()},[Ue,Ke]);const{onOpenChange:Ze,triggerPointerDownPosRef:Xe}=G;W.useEffect(()=>{if(H){let Wt={x:0,y:0};const An=Zt=>{var jt,At;Wt={x:Math.abs(Math.round(Zt.pageX)-(((jt=Xe.current)==null?void 0:jt.x)??0)),y:Math.abs(Math.round(Zt.pageY)-(((At=Xe.current)==null?void 0:At.y)??0))}},ht=Zt=>{Wt.x<=10&&Wt.y<=10?Zt.preventDefault():H.contains(Zt.target)||Ze(!1),document.removeEventListener("pointermove",An),Xe.current=null};return Xe.current!==null&&(document.addEventListener("pointermove",An),document.addEventListener("pointerup",ht,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",An),document.removeEventListener("pointerup",ht,{capture:!0})}}},[H,Ze,Xe]),W.useEffect(()=>{const Wt=()=>Ze(!1);return window.addEventListener("blur",Wt),window.addEventListener("resize",Wt),()=>{window.removeEventListener("blur",Wt),window.removeEventListener("resize",Wt)}},[Ze]);const[de,lt]=KW(Wt=>{const An=Le().filter(jt=>!jt.disabled),ht=An.find(jt=>jt.ref.current===document.activeElement),Zt=QW(An,Wt,ht);Zt&&setTimeout(()=>Zt.ref.current.focus())}),gt=W.useCallback((Wt,An,ht)=>{const Zt=!rt.current&&!ht;(G.value!==void 0&&G.value===An||Zt)&&(Fe(Wt),Zt&&(rt.current=!0))},[G.value]),Se=W.useCallback(()=>H==null?void 0:H.focus(),[H]),qt=W.useCallback((Wt,An,ht)=>{const Zt=!rt.current&&!ht;(G.value!==void 0&&G.value===An||Zt)&&Oe(Wt)},[G.value]),an=o==="popper"?SO:LW,dn=an===SO?{side:_,sideOffset:a,align:b,alignOffset:C,arrowPadding:A,collisionBoundary:O,collisionPadding:k,sticky:N,hideWhenDetached:z,avoidCollisions:U}:{};return re.jsx(kW,{scope:n,content:H,viewport:K,onViewportChange:ee,itemRefCallback:gt,selectedItem:ve,onItemLeave:Se,itemTextRefCallback:qt,focusSelectedItem:Ke,selectedItemText:Ne,position:o,isPositioned:Ue,searchRef:de,children:re.jsx(Ex,{as:Wu,allowPinchZoom:!0,children:re.jsx(Sx,{asChild:!0,trapped:G.open,onMountAutoFocus:Wt=>{Wt.preventDefault()},onUnmountAutoFocus:hn(u,Wt=>{var An;(An=G.trigger)==null||An.focus({preventScroll:!0}),Wt.preventDefault()}),children:re.jsx(wx,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:h,onPointerDownOutside:p,onFocusOutside:Wt=>Wt.preventDefault(),onDismiss:()=>G.onOpenChange(!1),children:re.jsx(an,{role:"listbox",id:G.contentId,"data-state":G.open?"open":"closed",dir:G.dir,onContextMenu:Wt=>Wt.preventDefault(),...j,...dn,onPlaced:()=>et(!0),ref:ue,style:{display:"flex",flexDirection:"column",outline:"none",...j.style},onKeyDown:hn(j.onKeyDown,Wt=>{const An=Wt.ctrlKey||Wt.altKey||Wt.metaKey;if(Wt.key==="Tab"&&Wt.preventDefault(),!An&&Wt.key.length===1&&lt(Wt.key),["ArrowUp","ArrowDown","Home","End"].includes(Wt.key)){let Zt=Le().filter(jt=>!jt.disabled).map(jt=>jt.ref.current);if(["ArrowUp","End"].includes(Wt.key)&&(Zt=Zt.slice().reverse()),["ArrowUp","ArrowDown"].includes(Wt.key)){const jt=Wt.target,At=Zt.indexOf(jt);Zt=Zt.slice(At+1)}setTimeout(()=>st(Zt)),Wt.preventDefault()}})})})})})})});DW.displayName=Jle;var eue="SelectItemAlignedPosition",LW=W.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:o,...u}=e,h=qh(jd,n),p=Zh(jd,n),[_,a]=W.useState(null),[b,C]=W.useState(null),A=Fr(t,ue=>C(ue)),O=bE(n),k=W.useRef(!1),N=W.useRef(!0),{viewport:z,selectedItem:U,selectedItemText:j,focusSelectedItem:G}=p,H=W.useCallback(()=>{if(h.trigger&&h.valueNode&&_&&b&&z&&U&&j){const ue=h.trigger.getBoundingClientRect(),ve=b.getBoundingClientRect(),Fe=h.valueNode.getBoundingClientRect(),Ne=j.getBoundingClientRect();if(h.dir!=="rtl"){const jt=Ne.left-ve.left,At=Fe.left-jt,er=ue.left-At,Rn=ue.width+er,_r=Math.max(Rn,ve.width),dr=window.innerWidth-Pu,vr=aj(At,[Pu,dr-_r]);_.style.minWidth=Rn+"px",_.style.left=vr+"px"}else{const jt=ve.right-Ne.right,At=window.innerWidth-Fe.right-jt,er=window.innerWidth-ue.right-At,Rn=ue.width+er,_r=Math.max(Rn,ve.width),dr=window.innerWidth-Pu,vr=aj(At,[Pu,dr-_r]);_.style.minWidth=Rn+"px",_.style.right=vr+"px"}const Oe=O(),Le=window.innerHeight-Pu*2,Ue=z.scrollHeight,et=window.getComputedStyle(b),rt=parseInt(et.borderTopWidth,10),st=parseInt(et.paddingTop,10),Ke=parseInt(et.borderBottomWidth,10),Ze=parseInt(et.paddingBottom,10),Xe=rt+st+Ue+Ze+Ke,de=Math.min(U.offsetHeight*5,Xe),lt=window.getComputedStyle(z),gt=parseInt(lt.paddingTop,10),Se=parseInt(lt.paddingBottom,10),qt=ue.top+ue.height/2-Pu,an=Le-qt,dn=U.offsetHeight/2,Wt=U.offsetTop+dn,An=rt+st+Wt,ht=Xe-An;if(An<=qt){const jt=U===Oe[Oe.length-1].ref.current;_.style.bottom="0px";const At=b.clientHeight-z.offsetTop-z.offsetHeight,er=Math.max(an,dn+(jt?Se:0)+At+Ke),Rn=An+er;_.style.height=Rn+"px"}else{const jt=U===Oe[0].ref.current;_.style.top="0px";const er=Math.max(qt,rt+z.offsetTop+(jt?gt:0)+dn)+ht;_.style.height=er+"px",z.scrollTop=An-qt+z.offsetTop}_.style.margin=`${Pu}px 0`,_.style.minHeight=de+"px",_.style.maxHeight=Le+"px",o==null||o(),requestAnimationFrame(()=>k.current=!0)}},[O,h.trigger,h.valueNode,_,b,z,U,j,h.dir,o]);Xo(()=>H(),[H]);const[Y,K]=W.useState();Xo(()=>{b&&K(window.getComputedStyle(b).zIndex)},[b]);const ee=W.useCallback(ue=>{ue&&N.current===!0&&(H(),G==null||G(),N.current=!1)},[H,G]);return re.jsx(nue,{scope:n,contentWrapper:_,shouldExpandOnScrollRef:k,onScrollButtonChange:ee,children:re.jsx("div",{ref:a,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:Y},children:re.jsx(fr.div,{...u,ref:A,style:{boxSizing:"border-box",maxHeight:"100%",...u.style}})})})});LW.displayName=eue;var tue="SelectPopperPosition",SO=W.forwardRef((e,t)=>{const{__scopeSelect:n,align:o="start",collisionPadding:u=Pu,...h}=e,p=wE(n);return re.jsx(zk,{...p,...h,ref:t,align:o,collisionPadding:u,style:{boxSizing:"border-box",...h.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});SO.displayName=tue;var[nue,jk]=Zg(jd,{}),TO="SelectViewport",zW=W.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:o,...u}=e,h=Zh(TO,n),p=jk(TO,n),_=Fr(t,h.onViewportChange),a=W.useRef(0);return re.jsxs(re.Fragment,{children:[re.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),re.jsx(xE.Slot,{scope:n,children:re.jsx(fr.div,{"data-radix-select-viewport":"",role:"presentation",...u,ref:_,style:{position:"relative",flex:1,overflow:"auto",...u.style},onScroll:hn(u.onScroll,b=>{const C=b.currentTarget,{contentWrapper:A,shouldExpandOnScrollRef:O}=p;if(O!=null&&O.current&&A){const k=Math.abs(a.current-C.scrollTop);if(k>0){const N=window.innerHeight-Pu*2,z=parseFloat(A.style.minHeight),U=parseFloat(A.style.height),j=Math.max(z,U);if(j<N){const G=j+k,H=Math.min(N,G),Y=G-H;A.style.height=H+"px",A.style.bottom==="0px"&&(C.scrollTop=Y>0?Y:0,A.style.justifyContent="flex-end")}}}a.current=C.scrollTop})})})]})});zW.displayName=TO;var FW="SelectGroup",[rue,iue]=Zg(FW),oue=W.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e,u=Dh();return re.jsx(rue,{scope:n,id:u,children:re.jsx(fr.div,{role:"group","aria-labelledby":u,...o,ref:t})})});oue.displayName=FW;var NW="SelectLabel",BW=W.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e,u=iue(NW,n);return re.jsx(fr.div,{id:u.id,...o,ref:t})});BW.displayName=NW;var LS="SelectItem",[aue,jW]=Zg(LS),$W=W.forwardRef((e,t)=>{const{__scopeSelect:n,value:o,disabled:u=!1,textValue:h,...p}=e,_=qh(LS,n),a=Zh(LS,n),b=_.value===o,[C,A]=W.useState(h??""),[O,k]=W.useState(!1),N=Fr(t,j=>{var G;return(G=a.itemRefCallback)==null?void 0:G.call(a,j,o,u)}),z=Dh(),U=()=>{u||(_.onValueChange(o),_.onOpenChange(!1))};if(o==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return re.jsx(aue,{scope:n,value:o,disabled:u,textId:z,isSelected:b,onItemTextChange:W.useCallback(j=>{A(G=>G||((j==null?void 0:j.textContent)??"").trim())},[]),children:re.jsx(xE.ItemSlot,{scope:n,value:o,disabled:u,textValue:C,children:re.jsx(fr.div,{role:"option","aria-labelledby":z,"data-highlighted":O?"":void 0,"aria-selected":b&&O,"data-state":b?"checked":"unchecked","aria-disabled":u||void 0,"data-disabled":u?"":void 0,tabIndex:u?void 0:-1,...p,ref:N,onFocus:hn(p.onFocus,()=>k(!0)),onBlur:hn(p.onBlur,()=>k(!1)),onPointerUp:hn(p.onPointerUp,U),onPointerMove:hn(p.onPointerMove,j=>{var G;u?(G=a.onItemLeave)==null||G.call(a):j.currentTarget.focus({preventScroll:!0})}),onPointerLeave:hn(p.onPointerLeave,j=>{var G;j.currentTarget===document.activeElement&&((G=a.onItemLeave)==null||G.call(a))}),onKeyDown:hn(p.onKeyDown,j=>{var H;((H=a.searchRef)==null?void 0:H.current)!==""&&j.key===" "||(Hle.includes(j.key)&&U(),j.key===" "&&j.preventDefault())})})})})});$W.displayName=LS;var Lv="SelectItemText",UW=W.forwardRef((e,t)=>{const{__scopeSelect:n,className:o,style:u,...h}=e,p=qh(Lv,n),_=Zh(Lv,n),a=jW(Lv,n),b=Yle(Lv,n),[C,A]=W.useState(null),O=Fr(t,j=>A(j),a.onItemTextChange,j=>{var G;return(G=_.itemTextRefCallback)==null?void 0:G.call(_,j,a.value,a.disabled)}),k=C==null?void 0:C.textContent,N=W.useMemo(()=>re.jsx("option",{value:a.value,disabled:a.disabled,children:k},a.value),[a.disabled,a.value,k]),{onNativeOptionAdd:z,onNativeOptionRemove:U}=b;return Xo(()=>(z(N),()=>U(N)),[z,U,N]),re.jsxs(re.Fragment,{children:[re.jsx(fr.span,{id:a.textId,...h,ref:O}),a.isSelected&&p.valueNode&&!p.valueNodeHasChildren?ec.createPortal(h.children,p.valueNode):null]})});UW.displayName=Lv;var VW="SelectItemIndicator",GW=W.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e;return jW(VW,n).isSelected?re.jsx(fr.span,{"aria-hidden":!0,...o,ref:t}):null});GW.displayName=VW;var EO="SelectScrollUpButton",WW=W.forwardRef((e,t)=>{const n=Zh(EO,e.__scopeSelect),o=jk(EO,e.__scopeSelect),[u,h]=W.useState(!1),p=Fr(t,o.onScrollButtonChange);return Xo(()=>{if(n.viewport&&n.isPositioned){let _=function(){const b=a.scrollTop>0;h(b)};const a=n.viewport;return _(),a.addEventListener("scroll",_),()=>a.removeEventListener("scroll",_)}},[n.viewport,n.isPositioned]),u?re.jsx(qW,{...e,ref:p,onAutoScroll:()=>{const{viewport:_,selectedItem:a}=n;_&&a&&(_.scrollTop=_.scrollTop-a.offsetHeight)}}):null});WW.displayName=EO;var AO="SelectScrollDownButton",HW=W.forwardRef((e,t)=>{const n=Zh(AO,e.__scopeSelect),o=jk(AO,e.__scopeSelect),[u,h]=W.useState(!1),p=Fr(t,o.onScrollButtonChange);return Xo(()=>{if(n.viewport&&n.isPositioned){let _=function(){const b=a.scrollHeight-a.clientHeight,C=Math.ceil(a.scrollTop)<b;h(C)};const a=n.viewport;return _(),a.addEventListener("scroll",_),()=>a.removeEventListener("scroll",_)}},[n.viewport,n.isPositioned]),u?re.jsx(qW,{...e,ref:p,onAutoScroll:()=>{const{viewport:_,selectedItem:a}=n;_&&a&&(_.scrollTop=_.scrollTop+a.offsetHeight)}}):null});HW.displayName=AO;var qW=W.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:o,...u}=e,h=Zh("SelectScrollButton",n),p=W.useRef(null),_=bE(n),a=W.useCallback(()=>{p.current!==null&&(window.clearInterval(p.current),p.current=null)},[]);return W.useEffect(()=>()=>a(),[a]),Xo(()=>{var C;const b=_().find(A=>A.ref.current===document.activeElement);(C=b==null?void 0:b.ref.current)==null||C.scrollIntoView({block:"nearest"})},[_]),re.jsx(fr.div,{"aria-hidden":!0,...u,ref:t,style:{flexShrink:0,...u.style},onPointerDown:hn(u.onPointerDown,()=>{p.current===null&&(p.current=window.setInterval(o,50))}),onPointerMove:hn(u.onPointerMove,()=>{var b;(b=h.onItemLeave)==null||b.call(h),p.current===null&&(p.current=window.setInterval(o,50))}),onPointerLeave:hn(u.onPointerLeave,()=>{a()})})}),sue="SelectSeparator",ZW=W.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e;return re.jsx(fr.div,{"aria-hidden":!0,...o,ref:t})});ZW.displayName=sue;var CO="SelectArrow",lue=W.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e,u=wE(n),h=qh(CO,n),p=Zh(CO,n);return h.open&&p.position==="popper"?re.jsx(Fk,{...u,...o,ref:t}):null});lue.displayName=CO;function XW(e){return e===""||e===void 0}var YW=W.forwardRef((e,t)=>{const{value:n,...o}=e,u=W.useRef(null),h=Fr(t,u),p=MG(n);return W.useEffect(()=>{const _=u.current,a=window.HTMLSelectElement.prototype,C=Object.getOwnPropertyDescriptor(a,"value").set;if(p!==n&&C){const A=new Event("change",{bubbles:!0});C.call(_,n),_.dispatchEvent(A)}},[p,n]),re.jsx(TW,{asChild:!0,children:re.jsx("select",{...o,ref:h,defaultValue:n})})});YW.displayName="BubbleSelect";function KW(e){const t=Ss(e),n=W.useRef(""),o=W.useRef(0),u=W.useCallback(p=>{const _=n.current+p;t(_),function a(b){n.current=b,window.clearTimeout(o.current),b!==""&&(o.current=window.setTimeout(()=>a(""),1e3))}(_)},[t]),h=W.useCallback(()=>{n.current="",window.clearTimeout(o.current)},[]);return W.useEffect(()=>()=>window.clearTimeout(o.current),[]),[n,u,h]}function QW(e,t,n){const u=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,h=n?e.indexOf(n):-1;let p=uue(e,Math.max(h,0));u.length===1&&(p=p.filter(b=>b!==n));const a=p.find(b=>b.textValue.toLowerCase().startsWith(u.toLowerCase()));return a!==n?a:void 0}function uue(e,t){return e.map((n,o)=>e[(t+o)%e.length])}var cue=EW,JW=CW,hue=MW,fue=IW,due=OW,eH=RW,pue=zW,tH=BW,nH=$W,mue=UW,gue=GW,rH=WW,iH=HW,oH=ZW;const yue=cue,_ue=hue,aH=W.forwardRef(({className:e,children:t,...n},o)=>re.jsxs(JW,{ref:o,className:wn("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,re.jsx(fue,{asChild:!0,children:re.jsx(NG,{className:"w-4 h-4 opacity-50"})})]}));aH.displayName=JW.displayName;const sH=W.forwardRef(({className:e,...t},n)=>re.jsx(rH,{ref:n,className:wn("flex cursor-default items-center justify-center py-1",e),...t,children:re.jsx(kie,{className:"w-4 h-4"})}));sH.displayName=rH.displayName;const lH=W.forwardRef(({className:e,...t},n)=>re.jsx(iH,{ref:n,className:wn("flex cursor-default items-center justify-center py-1",e),...t,children:re.jsx(NG,{className:"w-4 h-4"})}));lH.displayName=iH.displayName;const uH=W.forwardRef(({className:e,children:t,position:n="popper",...o},u)=>re.jsx(due,{children:re.jsxs(eH,{ref:u,className:wn("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...o,children:[re.jsx(sH,{}),re.jsx(pue,{className:wn("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),re.jsx(lH,{})]})}));uH.displayName=eH.displayName;const vue=W.forwardRef(({className:e,...t},n)=>re.jsx(tH,{ref:n,className:wn("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));vue.displayName=tH.displayName;const cH=W.forwardRef(({className:e,children:t,...n},o)=>re.jsxs(nH,{ref:o,className:wn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[re.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:re.jsx(gue,{children:re.jsx(lE,{className:"w-4 h-4"})})}),re.jsx(mue,{children:t})]}));cH.displayName=nH.displayName;const xue=W.forwardRef(({className:e,...t},n)=>re.jsx(oH,{ref:n,className:wn("-mx-1 my-1 h-px bg-muted",e),...t}));xue.displayName=oH.displayName;const bue="data:image/svg+xml,%3csvg%20width='12'%20height='8'%20viewBox='0%200%2012%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='0.969299'%20y='5.55426'%20width='2.96927'%20height='2.02039'%20fill='%23FB0D0E'/%3e%3crect%20x='4.92828'%20y='2.52371'%20width='2.96927'%20height='5.05097'%20fill='%23ACA4B3'/%3e%3cpath%20d='M8.88733%200.503296H11.8566V7.57466H8.88733V0.503296Z'%20fill='%23ACA4B3'/%3e%3c/svg%3e",wue="data:image/svg+xml,%3csvg%20width='12'%20height='8'%20viewBox='0%200%2012%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='0.938477'%20y='5.92908'%20width='2.96927'%20height='2.02039'%20fill='%23FEA500'/%3e%3crect%20x='4.89752'%20y='2.8985'%20width='2.96927'%20height='5.05097'%20fill='%23FEA500'/%3e%3cpath%20d='M8.85657%200.878082H11.8258V7.94944H8.85657V0.878082Z'%20fill='%23ACA4B3'/%3e%3c/svg%3e",Sue="data:image/svg+xml,%3csvg%20width='12'%20height='8'%20viewBox='0%200%2012%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='0.938477'%20y='5.30383'%20width='2.96927'%20height='2.02039'%20fill='%2302B725'/%3e%3crect%20x='4.89752'%20y='2.27325'%20width='2.96927'%20height='5.05097'%20fill='%2302B725'/%3e%3cpath%20d='M8.85657%200.252869H11.8258V7.32423H8.85657V0.252869Z'%20fill='%2302B725'/%3e%3c/svg%3e";function hH({regions:e,setRegions:t,latencies:n}){const[o,u]=W.useState(null),h=[...new Set(e.map(a=>a.area))];W.useEffect(()=>{o||u(h[0])},[e]);const p=a=>{const b=n.find(C=>C.region===a);return b?b.latency:null},_=a=>{if(a===null)return null;const b={green:80,orange:150};return a<=b.green?Sue:a<=b.orange?wue:bue};return re.jsxs(oE,{children:[re.jsx(aE,{children:re.jsxs("div",{className:"flex justify-between h-4/5 pt-3",children:[re.jsxs("div",{children:[re.jsx(qv,{children:"Regions"}),re.jsx(yk,{children:"Select AWS regions to get view latency across regions."})]}),re.jsxs(yue,{value:o,onValueChange:u,children:[re.jsx(aH,{className:"w-[190px]",children:re.jsx(_ue,{placeholder:"Select a region area"})}),re.jsx(uH,{children:h.map(a=>re.jsx(cH,{value:a,children:a},a))})]})]})}),re.jsx(sE,{className:"grid grid-cols-2 pl-3",children:e.filter(a=>a.area===o).map(a=>{const b=p(a.code),C=_(b);return re.jsxs("div",{className:"flex flex-col items-start gap-2 pl-4",children:[re.jsxs("div",{className:"flex items-center gap-2 text-customPurple",children:[re.jsx(uE,{id:a.code,checked:e.find(({code:A})=>A===a.code).selected,onClick:()=>t(A=>A.map(O=>O.code===a.code?{...O,selected:!O.selected}:O))}),re.jsxs("label",{htmlFor:a.code,children:[a.name," (",a.code,")"]})]}),b!==null&&re.jsxs("div",{className:"flex items-center text-sm gap-3 -mt-2 mb-2 text-customMauve ",children:[re.jsx("img",{src:C,alt:"Ping Indicator",className:"mt-0.5 w-4 h-3 md:w-4 md:h-3 lg:w-4 lg:h-3 object-cover"}),re.jsxs("span",{children:["Ping: ",b.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ms"]})]})]},a.code)})})]})}hH.propTypes={regions:En.array.isRequired,setRegions:En.func.isRequired,latencies:En.array.isRequired};const Tue=[{accessorKey:"regionName",header:"Region"},{accessorKey:"latency",header:({column:e})=>re.jsxs(dg,{variant:"ghost",className:"float-right text-customPurple",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:["Latency",re.jsx(Iie,{className:"w-4 h-4 ml-2 -mr-4"})]}),cell:({row:e})=>{const t=e.getValue("latency");if(t===1/0)return re.jsx("div",{className:"font-medium text-customPurple text-right",children:"-"});const n=t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+" ms";return re.jsx("div",{className:"font-medium text-right text-gray-700",children:n})}}];/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function wh(e,t){return typeof e=="function"?e(t):e}function Va(e,t){return n=>{t.setState(o=>({...o,[e]:wh(n,o[e])}))}}function SE(e){return e instanceof Function}function Eue(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function Aue(e,t){const n=[],o=u=>{u.forEach(h=>{n.push(h);const p=t(h);p!=null&&p.length&&o(p)})};return o(e),n}function $n(e,t,n){let o=[],u;return h=>{let p;n.key&&n.debug&&(p=Date.now());const _=e(h);if(!(_.length!==o.length||_.some((C,A)=>o[A]!==C)))return u;o=_;let b;if(n.key&&n.debug&&(b=Date.now()),u=t(..._),n==null||n.onChange==null||n.onChange(u),n.key&&n.debug&&n!=null&&n.debug()){const C=Math.round((Date.now()-p)*100)/100,A=Math.round((Date.now()-b)*100)/100,O=A/16,k=(N,z)=>{for(N=String(N);N.length<z;)N=" "+N;return N};console.info(`%c ${k(A,5)} /${k(C,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*O,120))}deg 100% 31%);`,n==null?void 0:n.key)}return u}}function Un(e,t,n,o){return{debug:()=>{var u;return(u=e==null?void 0:e.debugAll)!=null?u:e[t]},key:!1,onChange:o}}function Cue(e,t,n,o){const u=()=>{var p;return(p=h.getValue())!=null?p:e.options.renderFallbackValue},h={id:`${t.id}_${n.id}`,row:t,column:n,getValue:()=>t.getValue(o),renderValue:u,getContext:$n(()=>[e,n,t,h],(p,_,a,b)=>({table:p,column:_,row:a,cell:b,getValue:b.getValue,renderValue:b.renderValue}),Un(e.options,"debugCells"))};return e._features.forEach(p=>{p.createCell==null||p.createCell(h,n,t,e)},{}),h}function Pue(e,t,n,o){var u,h;const _={...e._getDefaultColumnDef(),...t},a=_.accessorKey;let b=(u=(h=_.id)!=null?h:a?a.replace(".","_"):void 0)!=null?u:typeof _.header=="string"?_.header:void 0,C;if(_.accessorFn?C=_.accessorFn:a&&(a.includes(".")?C=O=>{let k=O;for(const z of a.split(".")){var N;k=(N=k)==null?void 0:N[z]}return k}:C=O=>O[_.accessorKey]),!b)throw new Error;let A={id:`${String(b)}`,accessorFn:C,parent:o,depth:n,columnDef:_,columns:[],getFlatColumns:$n(()=>[!0],()=>{var O;return[A,...(O=A.columns)==null?void 0:O.flatMap(k=>k.getFlatColumns())]},Un(e.options,"debugColumns")),getLeafColumns:$n(()=>[e._getOrderColumnsFn()],O=>{var k;if((k=A.columns)!=null&&k.length){let N=A.columns.flatMap(z=>z.getLeafColumns());return O(N)}return[A]},Un(e.options,"debugColumns"))};for(const O of e._features)O.createColumn==null||O.createColumn(A,e);return A}const ko="debugHeaders";function sj(e,t,n){var o;let h={id:(o=n.id)!=null?o:t.id,column:t,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const p=[],_=a=>{a.subHeaders&&a.subHeaders.length&&a.subHeaders.map(_),p.push(a)};return _(h),p},getContext:()=>({table:e,header:h,column:t})};return e._features.forEach(p=>{p.createHeader==null||p.createHeader(h,e)}),h}const Mue={createTable:e=>{e.getHeaderGroups=$n(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,o,u)=>{var h,p;const _=(h=o==null?void 0:o.map(A=>n.find(O=>O.id===A)).filter(Boolean))!=null?h:[],a=(p=u==null?void 0:u.map(A=>n.find(O=>O.id===A)).filter(Boolean))!=null?p:[],b=n.filter(A=>!(o!=null&&o.includes(A.id))&&!(u!=null&&u.includes(A.id)));return vw(t,[..._,...b,...a],e)},Un(e.options,ko)),e.getCenterHeaderGroups=$n(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,o,u)=>(n=n.filter(h=>!(o!=null&&o.includes(h.id))&&!(u!=null&&u.includes(h.id))),vw(t,n,e,"center")),Un(e.options,ko)),e.getLeftHeaderGroups=$n(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,n,o)=>{var u;const h=(u=o==null?void 0:o.map(p=>n.find(_=>_.id===p)).filter(Boolean))!=null?u:[];return vw(t,h,e,"left")},Un(e.options,ko)),e.getRightHeaderGroups=$n(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,n,o)=>{var u;const h=(u=o==null?void 0:o.map(p=>n.find(_=>_.id===p)).filter(Boolean))!=null?u:[];return vw(t,h,e,"right")},Un(e.options,ko)),e.getFooterGroups=$n(()=>[e.getHeaderGroups()],t=>[...t].reverse(),Un(e.options,ko)),e.getLeftFooterGroups=$n(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),Un(e.options,ko)),e.getCenterFooterGroups=$n(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),Un(e.options,ko)),e.getRightFooterGroups=$n(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),Un(e.options,ko)),e.getFlatHeaders=$n(()=>[e.getHeaderGroups()],t=>t.map(n=>n.headers).flat(),Un(e.options,ko)),e.getLeftFlatHeaders=$n(()=>[e.getLeftHeaderGroups()],t=>t.map(n=>n.headers).flat(),Un(e.options,ko)),e.getCenterFlatHeaders=$n(()=>[e.getCenterHeaderGroups()],t=>t.map(n=>n.headers).flat(),Un(e.options,ko)),e.getRightFlatHeaders=$n(()=>[e.getRightHeaderGroups()],t=>t.map(n=>n.headers).flat(),Un(e.options,ko)),e.getCenterLeafHeaders=$n(()=>[e.getCenterFlatHeaders()],t=>t.filter(n=>{var o;return!((o=n.subHeaders)!=null&&o.length)}),Un(e.options,ko)),e.getLeftLeafHeaders=$n(()=>[e.getLeftFlatHeaders()],t=>t.filter(n=>{var o;return!((o=n.subHeaders)!=null&&o.length)}),Un(e.options,ko)),e.getRightLeafHeaders=$n(()=>[e.getRightFlatHeaders()],t=>t.filter(n=>{var o;return!((o=n.subHeaders)!=null&&o.length)}),Un(e.options,ko)),e.getLeafHeaders=$n(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,n,o)=>{var u,h,p,_,a,b;return[...(u=(h=t[0])==null?void 0:h.headers)!=null?u:[],...(p=(_=n[0])==null?void 0:_.headers)!=null?p:[],...(a=(b=o[0])==null?void 0:b.headers)!=null?a:[]].map(C=>C.getLeafHeaders()).flat()},Un(e.options,ko))}};function vw(e,t,n,o){var u,h;let p=0;const _=function(O,k){k===void 0&&(k=1),p=Math.max(p,k),O.filter(N=>N.getIsVisible()).forEach(N=>{var z;(z=N.columns)!=null&&z.length&&_(N.columns,k+1)},0)};_(e);let a=[];const b=(O,k)=>{const N={depth:k,id:[o,`${k}`].filter(Boolean).join("_"),headers:[]},z=[];O.forEach(U=>{const j=[...z].reverse()[0],G=U.column.depth===N.depth;let H,Y=!1;if(G&&U.column.parent?H=U.column.parent:(H=U.column,Y=!0),j&&(j==null?void 0:j.column)===H)j.subHeaders.push(U);else{const K=sj(n,H,{id:[o,k,H.id,U==null?void 0:U.id].filter(Boolean).join("_"),isPlaceholder:Y,placeholderId:Y?`${z.filter(ee=>ee.column===H).length}`:void 0,depth:k,index:z.length});K.subHeaders.push(U),z.push(K)}N.headers.push(U),U.headerGroup=N}),a.push(N),k>0&&b(z,k-1)},C=t.map((O,k)=>sj(n,O,{depth:p,index:k}));b(C,p-1),a.reverse();const A=O=>O.filter(N=>N.column.getIsVisible()).map(N=>{let z=0,U=0,j=[0];N.subHeaders&&N.subHeaders.length?(j=[],A(N.subHeaders).forEach(H=>{let{colSpan:Y,rowSpan:K}=H;z+=Y,j.push(K)})):z=1;const G=Math.min(...j);return U=U+G,N.colSpan=z,N.rowSpan=U,{colSpan:z,rowSpan:U}});return A((u=(h=a[0])==null?void 0:h.headers)!=null?u:[]),a}const Iue=(e,t,n,o,u,h,p)=>{let _={id:t,index:o,original:n,depth:u,parentId:p,_valuesCache:{},_uniqueValuesCache:{},getValue:a=>{if(_._valuesCache.hasOwnProperty(a))return _._valuesCache[a];const b=e.getColumn(a);if(b!=null&&b.accessorFn)return _._valuesCache[a]=b.accessorFn(_.original,o),_._valuesCache[a]},getUniqueValues:a=>{if(_._uniqueValuesCache.hasOwnProperty(a))return _._uniqueValuesCache[a];const b=e.getColumn(a);if(b!=null&&b.accessorFn)return b.columnDef.getUniqueValues?(_._uniqueValuesCache[a]=b.columnDef.getUniqueValues(_.original,o),_._uniqueValuesCache[a]):(_._uniqueValuesCache[a]=[_.getValue(a)],_._uniqueValuesCache[a])},renderValue:a=>{var b;return(b=_.getValue(a))!=null?b:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>Aue(_.subRows,a=>a.subRows),getParentRow:()=>_.parentId?e.getRow(_.parentId,!0):void 0,getParentRows:()=>{let a=[],b=_;for(;;){const C=b.getParentRow();if(!C)break;a.push(C),b=C}return a.reverse()},getAllCells:$n(()=>[e.getAllLeafColumns()],a=>a.map(b=>Cue(e,_,b,b.id)),Un(e.options,"debugRows")),_getAllCellsByColumnId:$n(()=>[_.getAllCells()],a=>a.reduce((b,C)=>(b[C.column.id]=C,b),{}),Un(e.options,"debugRows"))};for(let a=0;a<e._features.length;a++){const b=e._features[a];b==null||b.createRow==null||b.createRow(_,e)}return _},Oue={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},fH=(e,t,n)=>{var o;const u=n.toLowerCase();return!!(!((o=e.getValue(t))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(u))};fH.autoRemove=e=>nl(e);const dH=(e,t,n)=>{var o;return!!(!((o=e.getValue(t))==null||(o=o.toString())==null)&&o.includes(n))};dH.autoRemove=e=>nl(e);const pH=(e,t,n)=>{var o;return((o=e.getValue(t))==null||(o=o.toString())==null?void 0:o.toLowerCase())===(n==null?void 0:n.toLowerCase())};pH.autoRemove=e=>nl(e);const mH=(e,t,n)=>{var o;return(o=e.getValue(t))==null?void 0:o.includes(n)};mH.autoRemove=e=>nl(e)||!(e!=null&&e.length);const gH=(e,t,n)=>!n.some(o=>{var u;return!((u=e.getValue(t))!=null&&u.includes(o))});gH.autoRemove=e=>nl(e)||!(e!=null&&e.length);const yH=(e,t,n)=>n.some(o=>{var u;return(u=e.getValue(t))==null?void 0:u.includes(o)});yH.autoRemove=e=>nl(e)||!(e!=null&&e.length);const _H=(e,t,n)=>e.getValue(t)===n;_H.autoRemove=e=>nl(e);const vH=(e,t,n)=>e.getValue(t)==n;vH.autoRemove=e=>nl(e);const $k=(e,t,n)=>{let[o,u]=n;const h=e.getValue(t);return h>=o&&h<=u};$k.resolveFilterValue=e=>{let[t,n]=e,o=typeof t!="number"?parseFloat(t):t,u=typeof n!="number"?parseFloat(n):n,h=t===null||Number.isNaN(o)?-1/0:o,p=n===null||Number.isNaN(u)?1/0:u;if(h>p){const _=h;h=p,p=_}return[h,p]};$k.autoRemove=e=>nl(e)||nl(e[0])&&nl(e[1]);const Mu={includesString:fH,includesStringSensitive:dH,equalsString:pH,arrIncludes:mH,arrIncludesAll:gH,arrIncludesSome:yH,equals:_H,weakEquals:vH,inNumberRange:$k};function nl(e){return e==null||e===""}const Rue={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Va("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const n=t.getCoreRowModel().flatRows[0],o=n==null?void 0:n.getValue(e.id);return typeof o=="string"?Mu.includesString:typeof o=="number"?Mu.inNumberRange:typeof o=="boolean"||o!==null&&typeof o=="object"?Mu.equals:Array.isArray(o)?Mu.arrIncludes:Mu.weakEquals},e.getFilterFn=()=>{var n,o;return SE(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(n=(o=t.options.filterFns)==null?void 0:o[e.columnDef.filterFn])!=null?n:Mu[e.columnDef.filterFn]},e.getCanFilter=()=>{var n,o,u;return((n=e.columnDef.enableColumnFilter)!=null?n:!0)&&((o=t.options.enableColumnFilters)!=null?o:!0)&&((u=t.options.enableFilters)!=null?u:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var n;return(n=t.getState().columnFilters)==null||(n=n.find(o=>o.id===e.id))==null?void 0:n.value},e.getFilterIndex=()=>{var n,o;return(n=(o=t.getState().columnFilters)==null?void 0:o.findIndex(u=>u.id===e.id))!=null?n:-1},e.setFilterValue=n=>{t.setColumnFilters(o=>{const u=e.getFilterFn(),h=o==null?void 0:o.find(C=>C.id===e.id),p=wh(n,h?h.value:void 0);if(lj(u,p,e)){var _;return(_=o==null?void 0:o.filter(C=>C.id!==e.id))!=null?_:[]}const a={id:e.id,value:p};if(h){var b;return(b=o==null?void 0:o.map(C=>C.id===e.id?a:C))!=null?b:[]}return o!=null&&o.length?[...o,a]:[a]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const n=e.getAllLeafColumns(),o=u=>{var h;return(h=wh(t,u))==null?void 0:h.filter(p=>{const _=n.find(a=>a.id===p.id);if(_){const a=_.getFilterFn();if(lj(a,p.value,_))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(o)},e.resetColumnFilters=t=>{var n,o;e.setColumnFilters(t?[]:(n=(o=e.initialState)==null?void 0:o.columnFilters)!=null?n:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function lj(e,t,n){return(e&&e.autoRemove?e.autoRemove(t,n):!1)||typeof t>"u"||typeof t=="string"&&!t}const kue=(e,t,n)=>n.reduce((o,u)=>{const h=u.getValue(e);return o+(typeof h=="number"?h:0)},0),Due=(e,t,n)=>{let o;return n.forEach(u=>{const h=u.getValue(e);h!=null&&(o>h||o===void 0&&h>=h)&&(o=h)}),o},Lue=(e,t,n)=>{let o;return n.forEach(u=>{const h=u.getValue(e);h!=null&&(o<h||o===void 0&&h>=h)&&(o=h)}),o},zue=(e,t,n)=>{let o,u;return n.forEach(h=>{const p=h.getValue(e);p!=null&&(o===void 0?p>=p&&(o=u=p):(o>p&&(o=p),u<p&&(u=p)))}),[o,u]},Fue=(e,t)=>{let n=0,o=0;if(t.forEach(u=>{let h=u.getValue(e);h!=null&&(h=+h)>=h&&(++n,o+=h)}),n)return o/n},Nue=(e,t)=>{if(!t.length)return;const n=t.map(h=>h.getValue(e));if(!Eue(n))return;if(n.length===1)return n[0];const o=Math.floor(n.length/2),u=n.sort((h,p)=>h-p);return n.length%2!==0?u[o]:(u[o-1]+u[o])/2},Bue=(e,t)=>Array.from(new Set(t.map(n=>n.getValue(e))).values()),jue=(e,t)=>new Set(t.map(n=>n.getValue(e))).size,$ue=(e,t)=>t.length,_M={sum:kue,min:Due,max:Lue,extent:zue,mean:Fue,median:Nue,unique:Bue,uniqueCount:jue,count:$ue},Uue={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,n;return(t=(n=e.getValue())==null||n.toString==null?void 0:n.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Va("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(n=>n!=null&&n.includes(e.id)?n.filter(o=>o!==e.id):[...n??[],e.id])},e.getCanGroup=()=>{var n,o;return((n=e.columnDef.enableGrouping)!=null?n:!0)&&((o=t.options.enableGrouping)!=null?o:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var n;return(n=t.getState().grouping)==null?void 0:n.includes(e.id)},e.getGroupedIndex=()=>{var n;return(n=t.getState().grouping)==null?void 0:n.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const n=e.getCanGroup();return()=>{n&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const n=t.getCoreRowModel().flatRows[0],o=n==null?void 0:n.getValue(e.id);if(typeof o=="number")return _M.sum;if(Object.prototype.toString.call(o)==="[object Date]")return _M.extent},e.getAggregationFn=()=>{var n,o;if(!e)throw new Error;return SE(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(n=(o=t.options.aggregationFns)==null?void 0:o[e.columnDef.aggregationFn])!=null?n:_M[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var n,o;e.setGrouping(t?[]:(n=(o=e.initialState)==null?void 0:o.grouping)!=null?n:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=n=>{if(e._groupingValuesCache.hasOwnProperty(n))return e._groupingValuesCache[n];const o=t.getColumn(n);return o!=null&&o.columnDef.getGroupingValue?(e._groupingValuesCache[n]=o.columnDef.getGroupingValue(e.original),e._groupingValuesCache[n]):e.getValue(n)},e._groupingValuesCache={}},createCell:(e,t,n,o)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===n.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var u;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((u=n.subRows)!=null&&u.length)}}};function Vue(e,t,n){if(!(t!=null&&t.length)||!n)return e;const o=e.filter(h=>!t.includes(h.id));return n==="remove"?o:[...t.map(h=>e.find(p=>p.id===h)).filter(Boolean),...o]}const Gue={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Va("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=$n(n=>[Yv(t,n)],n=>n.findIndex(o=>o.id===e.id),Un(t.options,"debugColumns")),e.getIsFirstColumn=n=>{var o;return((o=Yv(t,n)[0])==null?void 0:o.id)===e.id},e.getIsLastColumn=n=>{var o;const u=Yv(t,n);return((o=u[u.length-1])==null?void 0:o.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var n;e.setColumnOrder(t?[]:(n=e.initialState.columnOrder)!=null?n:[])},e._getOrderColumnsFn=$n(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,n,o)=>u=>{let h=[];if(!(t!=null&&t.length))h=u;else{const p=[...t],_=[...u];for(;_.length&&p.length;){const a=p.shift(),b=_.findIndex(C=>C.id===a);b>-1&&h.push(_.splice(b,1)[0])}h=[...h,..._]}return Vue(h,n,o)},Un(e.options,"debugTable"))}},vM=()=>({left:[],right:[]}),Wue={getInitialState:e=>({columnPinning:vM(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Va("columnPinning",e)}),createColumn:(e,t)=>{e.pin=n=>{const o=e.getLeafColumns().map(u=>u.id).filter(Boolean);t.setColumnPinning(u=>{var h,p;if(n==="right"){var _,a;return{left:((_=u==null?void 0:u.left)!=null?_:[]).filter(A=>!(o!=null&&o.includes(A))),right:[...((a=u==null?void 0:u.right)!=null?a:[]).filter(A=>!(o!=null&&o.includes(A))),...o]}}if(n==="left"){var b,C;return{left:[...((b=u==null?void 0:u.left)!=null?b:[]).filter(A=>!(o!=null&&o.includes(A))),...o],right:((C=u==null?void 0:u.right)!=null?C:[]).filter(A=>!(o!=null&&o.includes(A)))}}return{left:((h=u==null?void 0:u.left)!=null?h:[]).filter(A=>!(o!=null&&o.includes(A))),right:((p=u==null?void 0:u.right)!=null?p:[]).filter(A=>!(o!=null&&o.includes(A)))}})},e.getCanPin=()=>e.getLeafColumns().some(o=>{var u,h,p;return((u=o.columnDef.enablePinning)!=null?u:!0)&&((h=(p=t.options.enableColumnPinning)!=null?p:t.options.enablePinning)!=null?h:!0)}),e.getIsPinned=()=>{const n=e.getLeafColumns().map(_=>_.id),{left:o,right:u}=t.getState().columnPinning,h=n.some(_=>o==null?void 0:o.includes(_)),p=n.some(_=>u==null?void 0:u.includes(_));return h?"left":p?"right":!1},e.getPinnedIndex=()=>{var n,o;const u=e.getIsPinned();return u?(n=(o=t.getState().columnPinning)==null||(o=o[u])==null?void 0:o.indexOf(e.id))!=null?n:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=$n(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(n,o,u)=>{const h=[...o??[],...u??[]];return n.filter(p=>!h.includes(p.column.id))},Un(t.options,"debugRows")),e.getLeftVisibleCells=$n(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(n,o)=>(o??[]).map(h=>n.find(p=>p.column.id===h)).filter(Boolean).map(h=>({...h,position:"left"})),Un(t.options,"debugRows")),e.getRightVisibleCells=$n(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(n,o)=>(o??[]).map(h=>n.find(p=>p.column.id===h)).filter(Boolean).map(h=>({...h,position:"right"})),Un(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var n,o;return e.setColumnPinning(t?vM():(n=(o=e.initialState)==null?void 0:o.columnPinning)!=null?n:vM())},e.getIsSomeColumnsPinned=t=>{var n;const o=e.getState().columnPinning;if(!t){var u,h;return!!((u=o.left)!=null&&u.length||(h=o.right)!=null&&h.length)}return!!((n=o[t])!=null&&n.length)},e.getLeftLeafColumns=$n(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,n)=>(n??[]).map(o=>t.find(u=>u.id===o)).filter(Boolean),Un(e.options,"debugColumns")),e.getRightLeafColumns=$n(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,n)=>(n??[]).map(o=>t.find(u=>u.id===o)).filter(Boolean),Un(e.options,"debugColumns")),e.getCenterLeafColumns=$n(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,o)=>{const u=[...n??[],...o??[]];return t.filter(h=>!u.includes(h.id))},Un(e.options,"debugColumns"))}},xw={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},xM=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),Hue={getDefaultColumnDef:()=>xw,getInitialState:e=>({columnSizing:{},columnSizingInfo:xM(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Va("columnSizing",e),onColumnSizingInfoChange:Va("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var n,o,u;const h=t.getState().columnSizing[e.id];return Math.min(Math.max((n=e.columnDef.minSize)!=null?n:xw.minSize,(o=h??e.columnDef.size)!=null?o:xw.size),(u=e.columnDef.maxSize)!=null?u:xw.maxSize)},e.getStart=$n(n=>[n,Yv(t,n),t.getState().columnSizing],(n,o)=>o.slice(0,e.getIndex(n)).reduce((u,h)=>u+h.getSize(),0),Un(t.options,"debugColumns")),e.getAfter=$n(n=>[n,Yv(t,n),t.getState().columnSizing],(n,o)=>o.slice(e.getIndex(n)+1).reduce((u,h)=>u+h.getSize(),0),Un(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(n=>{let{[e.id]:o,...u}=n;return u})},e.getCanResize=()=>{var n,o;return((n=e.columnDef.enableResizing)!=null?n:!0)&&((o=t.options.enableColumnResizing)!=null?o:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let n=0;const o=u=>{if(u.subHeaders.length)u.subHeaders.forEach(o);else{var h;n+=(h=u.column.getSize())!=null?h:0}};return o(e),n},e.getStart=()=>{if(e.index>0){const n=e.headerGroup.headers[e.index-1];return n.getStart()+n.getSize()}return 0},e.getResizeHandler=n=>{const o=t.getColumn(e.column.id),u=o==null?void 0:o.getCanResize();return h=>{if(!o||!u||(h.persist==null||h.persist(),bM(h)&&h.touches&&h.touches.length>1))return;const p=e.getSize(),_=e?e.getLeafHeaders().map(j=>[j.column.id,j.column.getSize()]):[[o.id,o.getSize()]],a=bM(h)?Math.round(h.touches[0].clientX):h.clientX,b={},C=(j,G)=>{typeof G=="number"&&(t.setColumnSizingInfo(H=>{var Y,K;const ee=t.options.columnResizeDirection==="rtl"?-1:1,ue=(G-((Y=H==null?void 0:H.startOffset)!=null?Y:0))*ee,ve=Math.max(ue/((K=H==null?void 0:H.startSize)!=null?K:0),-.999999);return H.columnSizingStart.forEach(Fe=>{let[Ne,Oe]=Fe;b[Ne]=Math.round(Math.max(Oe+Oe*ve,0)*100)/100}),{...H,deltaOffset:ue,deltaPercentage:ve}}),(t.options.columnResizeMode==="onChange"||j==="end")&&t.setColumnSizing(H=>({...H,...b})))},A=j=>C("move",j),O=j=>{C("end",j),t.setColumnSizingInfo(G=>({...G,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},k=n||typeof document<"u"?document:null,N={moveHandler:j=>A(j.clientX),upHandler:j=>{k==null||k.removeEventListener("mousemove",N.moveHandler),k==null||k.removeEventListener("mouseup",N.upHandler),O(j.clientX)}},z={moveHandler:j=>(j.cancelable&&(j.preventDefault(),j.stopPropagation()),A(j.touches[0].clientX),!1),upHandler:j=>{var G;k==null||k.removeEventListener("touchmove",z.moveHandler),k==null||k.removeEventListener("touchend",z.upHandler),j.cancelable&&(j.preventDefault(),j.stopPropagation()),O((G=j.touches[0])==null?void 0:G.clientX)}},U=que()?{passive:!1}:!1;bM(h)?(k==null||k.addEventListener("touchmove",z.moveHandler,U),k==null||k.addEventListener("touchend",z.upHandler,U)):(k==null||k.addEventListener("mousemove",N.moveHandler,U),k==null||k.addEventListener("mouseup",N.upHandler,U)),t.setColumnSizingInfo(j=>({...j,startOffset:a,startSize:p,deltaOffset:0,deltaPercentage:0,columnSizingStart:_,isResizingColumn:o.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var n;e.setColumnSizing(t?{}:(n=e.initialState.columnSizing)!=null?n:{})},e.resetHeaderSizeInfo=t=>{var n;e.setColumnSizingInfo(t?xM():(n=e.initialState.columnSizingInfo)!=null?n:xM())},e.getTotalSize=()=>{var t,n;return(t=(n=e.getHeaderGroups()[0])==null?void 0:n.headers.reduce((o,u)=>o+u.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,n;return(t=(n=e.getLeftHeaderGroups()[0])==null?void 0:n.headers.reduce((o,u)=>o+u.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,n;return(t=(n=e.getCenterHeaderGroups()[0])==null?void 0:n.headers.reduce((o,u)=>o+u.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,n;return(t=(n=e.getRightHeaderGroups()[0])==null?void 0:n.headers.reduce((o,u)=>o+u.getSize(),0))!=null?t:0}}};let bw=null;function que(){if(typeof bw=="boolean")return bw;let e=!1;try{const t={get passive(){return e=!0,!1}},n=()=>{};window.addEventListener("test",n,t),window.removeEventListener("test",n)}catch{e=!1}return bw=e,bw}function bM(e){return e.type==="touchstart"}const Zue={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Va("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=n=>{e.getCanHide()&&t.setColumnVisibility(o=>({...o,[e.id]:n??!e.getIsVisible()}))},e.getIsVisible=()=>{var n,o;const u=e.columns;return(n=u.length?u.some(h=>h.getIsVisible()):(o=t.getState().columnVisibility)==null?void 0:o[e.id])!=null?n:!0},e.getCanHide=()=>{var n,o;return((n=e.columnDef.enableHiding)!=null?n:!0)&&((o=t.options.enableHiding)!=null?o:!0)},e.getToggleVisibilityHandler=()=>n=>{e.toggleVisibility==null||e.toggleVisibility(n.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=$n(()=>[e.getAllCells(),t.getState().columnVisibility],n=>n.filter(o=>o.column.getIsVisible()),Un(t.options,"debugRows")),e.getVisibleCells=$n(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(n,o,u)=>[...n,...o,...u],Un(t.options,"debugRows"))},createTable:e=>{const t=(n,o)=>$n(()=>[o(),o().filter(u=>u.getIsVisible()).map(u=>u.id).join("_")],u=>u.filter(h=>h.getIsVisible==null?void 0:h.getIsVisible()),Un(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=n=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(n),e.resetColumnVisibility=n=>{var o;e.setColumnVisibility(n?{}:(o=e.initialState.columnVisibility)!=null?o:{})},e.toggleAllColumnsVisible=n=>{var o;n=(o=n)!=null?o:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((u,h)=>({...u,[h.id]:n||!(h.getCanHide!=null&&h.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(n=>!(n.getIsVisible!=null&&n.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(n=>n.getIsVisible==null?void 0:n.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>n=>{var o;e.toggleAllColumnsVisible((o=n.target)==null?void 0:o.checked)}}};function Yv(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Xue={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Yue={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Va("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var n;const o=(n=e.getCoreRowModel().flatRows[0])==null||(n=n._getAllCellsByColumnId()[t.id])==null?void 0:n.getValue();return typeof o=="string"||typeof o=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var n,o,u,h;return((n=e.columnDef.enableGlobalFilter)!=null?n:!0)&&((o=t.options.enableGlobalFilter)!=null?o:!0)&&((u=t.options.enableFilters)!=null?u:!0)&&((h=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?h:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>Mu.includesString,e.getGlobalFilterFn=()=>{var t,n;const{globalFilterFn:o}=e.options;return SE(o)?o:o==="auto"?e.getGlobalAutoFilterFn():(t=(n=e.options.filterFns)==null?void 0:n[o])!=null?t:Mu[o]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},Kue={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Va("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,n=!1;e._autoResetExpanded=()=>{var o,u;if(!t){e._queue(()=>{t=!0});return}if((o=(u=e.options.autoResetAll)!=null?u:e.options.autoResetExpanded)!=null?o:!e.options.manualExpanding){if(n)return;n=!0,e._queue(()=>{e.resetExpanded(),n=!1})}},e.setExpanded=o=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(o),e.toggleAllRowsExpanded=o=>{o??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=o=>{var u,h;e.setExpanded(o?{}:(u=(h=e.initialState)==null?void 0:h.expanded)!=null?u:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(o=>o.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>o=>{o.persist==null||o.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const o=e.getState().expanded;return o===!0||Object.values(o).some(Boolean)},e.getIsAllRowsExpanded=()=>{const o=e.getState().expanded;return typeof o=="boolean"?o===!0:!(!Object.keys(o).length||e.getRowModel().flatRows.some(u=>!u.getIsExpanded()))},e.getExpandedDepth=()=>{let o=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(h=>{const p=h.split(".");o=Math.max(o,p.length)}),o},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=n=>{t.setExpanded(o=>{var u;const h=o===!0?!0:!!(o!=null&&o[e.id]);let p={};if(o===!0?Object.keys(t.getRowModel().rowsById).forEach(_=>{p[_]=!0}):p=o,n=(u=n)!=null?u:!h,!h&&n)return{...p,[e.id]:!0};if(h&&!n){const{[e.id]:_,...a}=p;return a}return o})},e.getIsExpanded=()=>{var n;const o=t.getState().expanded;return!!((n=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?n:o===!0||o!=null&&o[e.id])},e.getCanExpand=()=>{var n,o,u;return(n=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?n:((o=t.options.enableExpanding)!=null?o:!0)&&!!((u=e.subRows)!=null&&u.length)},e.getIsAllParentsExpanded=()=>{let n=!0,o=e;for(;n&&o.parentId;)o=t.getRow(o.parentId,!0),n=o.getIsExpanded();return n},e.getToggleExpandedHandler=()=>{const n=e.getCanExpand();return()=>{n&&e.toggleExpanded()}}}},PO=0,MO=10,wM=()=>({pageIndex:PO,pageSize:MO}),Que={getInitialState:e=>({...e,pagination:{...wM(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Va("pagination",e)}),createTable:e=>{let t=!1,n=!1;e._autoResetPageIndex=()=>{var o,u;if(!t){e._queue(()=>{t=!0});return}if((o=(u=e.options.autoResetAll)!=null?u:e.options.autoResetPageIndex)!=null?o:!e.options.manualPagination){if(n)return;n=!0,e._queue(()=>{e.resetPageIndex(),n=!1})}},e.setPagination=o=>{const u=h=>wh(o,h);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(u)},e.resetPagination=o=>{var u;e.setPagination(o?wM():(u=e.initialState.pagination)!=null?u:wM())},e.setPageIndex=o=>{e.setPagination(u=>{let h=wh(o,u.pageIndex);const p=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return h=Math.max(0,Math.min(h,p)),{...u,pageIndex:h}})},e.resetPageIndex=o=>{var u,h;e.setPageIndex(o?PO:(u=(h=e.initialState)==null||(h=h.pagination)==null?void 0:h.pageIndex)!=null?u:PO)},e.resetPageSize=o=>{var u,h;e.setPageSize(o?MO:(u=(h=e.initialState)==null||(h=h.pagination)==null?void 0:h.pageSize)!=null?u:MO)},e.setPageSize=o=>{e.setPagination(u=>{const h=Math.max(1,wh(o,u.pageSize)),p=u.pageSize*u.pageIndex,_=Math.floor(p/h);return{...u,pageIndex:_,pageSize:h}})},e.setPageCount=o=>e.setPagination(u=>{var h;let p=wh(o,(h=e.options.pageCount)!=null?h:-1);return typeof p=="number"&&(p=Math.max(-1,p)),{...u,pageCount:p}}),e.getPageOptions=$n(()=>[e.getPageCount()],o=>{let u=[];return o&&o>0&&(u=[...new Array(o)].fill(null).map((h,p)=>p)),u},Un(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:o}=e.getState().pagination,u=e.getPageCount();return u===-1?!0:u===0?!1:o<u-1},e.previousPage=()=>e.setPageIndex(o=>o-1),e.nextPage=()=>e.setPageIndex(o=>o+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var o;return(o=e.options.pageCount)!=null?o:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var o;return(o=e.options.rowCount)!=null?o:e.getPrePaginationRowModel().rows.length}}},SM=()=>({top:[],bottom:[]}),Jue={getInitialState:e=>({rowPinning:SM(),...e}),getDefaultOptions:e=>({onRowPinningChange:Va("rowPinning",e)}),createRow:(e,t)=>{e.pin=(n,o,u)=>{const h=o?e.getLeafRows().map(a=>{let{id:b}=a;return b}):[],p=u?e.getParentRows().map(a=>{let{id:b}=a;return b}):[],_=new Set([...p,e.id,...h]);t.setRowPinning(a=>{var b,C;if(n==="bottom"){var A,O;return{top:((A=a==null?void 0:a.top)!=null?A:[]).filter(z=>!(_!=null&&_.has(z))),bottom:[...((O=a==null?void 0:a.bottom)!=null?O:[]).filter(z=>!(_!=null&&_.has(z))),...Array.from(_)]}}if(n==="top"){var k,N;return{top:[...((k=a==null?void 0:a.top)!=null?k:[]).filter(z=>!(_!=null&&_.has(z))),...Array.from(_)],bottom:((N=a==null?void 0:a.bottom)!=null?N:[]).filter(z=>!(_!=null&&_.has(z)))}}return{top:((b=a==null?void 0:a.top)!=null?b:[]).filter(z=>!(_!=null&&_.has(z))),bottom:((C=a==null?void 0:a.bottom)!=null?C:[]).filter(z=>!(_!=null&&_.has(z)))}})},e.getCanPin=()=>{var n;const{enableRowPinning:o,enablePinning:u}=t.options;return typeof o=="function"?o(e):(n=o??u)!=null?n:!0},e.getIsPinned=()=>{const n=[e.id],{top:o,bottom:u}=t.getState().rowPinning,h=n.some(_=>o==null?void 0:o.includes(_)),p=n.some(_=>u==null?void 0:u.includes(_));return h?"top":p?"bottom":!1},e.getPinnedIndex=()=>{var n,o;const u=e.getIsPinned();if(!u)return-1;const h=(n=u==="top"?t.getTopRows():t.getBottomRows())==null?void 0:n.map(p=>{let{id:_}=p;return _});return(o=h==null?void 0:h.indexOf(e.id))!=null?o:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var n,o;return e.setRowPinning(t?SM():(n=(o=e.initialState)==null?void 0:o.rowPinning)!=null?n:SM())},e.getIsSomeRowsPinned=t=>{var n;const o=e.getState().rowPinning;if(!t){var u,h;return!!((u=o.top)!=null&&u.length||(h=o.bottom)!=null&&h.length)}return!!((n=o[t])!=null&&n.length)},e._getPinnedRows=(t,n,o)=>{var u;return((u=e.options.keepPinnedRows)==null||u?(n??[]).map(p=>{const _=e.getRow(p,!0);return _.getIsAllParentsExpanded()?_:null}):(n??[]).map(p=>t.find(_=>_.id===p))).filter(Boolean).map(p=>({...p,position:o}))},e.getTopRows=$n(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,n)=>e._getPinnedRows(t,n,"top"),Un(e.options,"debugRows")),e.getBottomRows=$n(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,n)=>e._getPinnedRows(t,n,"bottom"),Un(e.options,"debugRows")),e.getCenterRows=$n(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,n,o)=>{const u=new Set([...n??[],...o??[]]);return t.filter(h=>!u.has(h.id))},Un(e.options,"debugRows"))}},ece={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Va("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var n;return e.setRowSelection(t?{}:(n=e.initialState.rowSelection)!=null?n:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(n=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const o={...n},u=e.getPreGroupedRowModel().flatRows;return t?u.forEach(h=>{h.getCanSelect()&&(o[h.id]=!0)}):u.forEach(h=>{delete o[h.id]}),o})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(n=>{const o=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),u={...n};return e.getRowModel().rows.forEach(h=>{IO(u,h.id,o,!0,e)}),u}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=$n(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,n)=>Object.keys(t).length?TM(e,n):{rows:[],flatRows:[],rowsById:{}},Un(e.options,"debugTable")),e.getFilteredSelectedRowModel=$n(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,n)=>Object.keys(t).length?TM(e,n):{rows:[],flatRows:[],rowsById:{}},Un(e.options,"debugTable")),e.getGroupedSelectedRowModel=$n(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,n)=>Object.keys(t).length?TM(e,n):{rows:[],flatRows:[],rowsById:{}},Un(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:n}=e.getState();let o=!!(t.length&&Object.keys(n).length);return o&&t.some(u=>u.getCanSelect()&&!n[u.id])&&(o=!1),o},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(u=>u.getCanSelect()),{rowSelection:n}=e.getState();let o=!!t.length;return o&&t.some(u=>!n[u.id])&&(o=!1),o},e.getIsSomeRowsSelected=()=>{var t;const n=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return n>0&&n<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(n=>n.getCanSelect()).some(n=>n.getIsSelected()||n.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(n,o)=>{const u=e.getIsSelected();t.setRowSelection(h=>{var p;if(n=typeof n<"u"?n:!u,e.getCanSelect()&&u===n)return h;const _={...h};return IO(_,e.id,n,(p=o==null?void 0:o.selectChildren)!=null?p:!0,t),_})},e.getIsSelected=()=>{const{rowSelection:n}=t.getState();return Uk(e,n)},e.getIsSomeSelected=()=>{const{rowSelection:n}=t.getState();return OO(e,n)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:n}=t.getState();return OO(e,n)==="all"},e.getCanSelect=()=>{var n;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(n=t.options.enableRowSelection)!=null?n:!0},e.getCanSelectSubRows=()=>{var n;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(n=t.options.enableSubRowSelection)!=null?n:!0},e.getCanMultiSelect=()=>{var n;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(n=t.options.enableMultiRowSelection)!=null?n:!0},e.getToggleSelectedHandler=()=>{const n=e.getCanSelect();return o=>{var u;n&&e.toggleSelected((u=o.target)==null?void 0:u.checked)}}}},IO=(e,t,n,o,u)=>{var h;const p=u.getRow(t,!0);n?(p.getCanMultiSelect()||Object.keys(e).forEach(_=>delete e[_]),p.getCanSelect()&&(e[t]=!0)):delete e[t],o&&(h=p.subRows)!=null&&h.length&&p.getCanSelectSubRows()&&p.subRows.forEach(_=>IO(e,_.id,n,o,u))};function TM(e,t){const n=e.getState().rowSelection,o=[],u={},h=function(p,_){return p.map(a=>{var b;const C=Uk(a,n);if(C&&(o.push(a),u[a.id]=a),(b=a.subRows)!=null&&b.length&&(a={...a,subRows:h(a.subRows)}),C)return a}).filter(Boolean)};return{rows:h(t.rows),flatRows:o,rowsById:u}}function Uk(e,t){var n;return(n=t[e.id])!=null?n:!1}function OO(e,t,n){var o;if(!((o=e.subRows)!=null&&o.length))return!1;let u=!0,h=!1;return e.subRows.forEach(p=>{if(!(h&&!u)&&(p.getCanSelect()&&(Uk(p,t)?h=!0:u=!1),p.subRows&&p.subRows.length)){const _=OO(p,t);_==="all"?h=!0:(_==="some"&&(h=!0),u=!1)}}),u?"all":h?"some":!1}const RO=/([0-9]+)/gm,tce=(e,t,n)=>xH(Uh(e.getValue(n)).toLowerCase(),Uh(t.getValue(n)).toLowerCase()),nce=(e,t,n)=>xH(Uh(e.getValue(n)),Uh(t.getValue(n))),rce=(e,t,n)=>Vk(Uh(e.getValue(n)).toLowerCase(),Uh(t.getValue(n)).toLowerCase()),ice=(e,t,n)=>Vk(Uh(e.getValue(n)),Uh(t.getValue(n))),oce=(e,t,n)=>{const o=e.getValue(n),u=t.getValue(n);return o>u?1:o<u?-1:0},ace=(e,t,n)=>Vk(e.getValue(n),t.getValue(n));function Vk(e,t){return e===t?0:e>t?1:-1}function Uh(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function xH(e,t){const n=e.split(RO).filter(Boolean),o=t.split(RO).filter(Boolean);for(;n.length&&o.length;){const u=n.shift(),h=o.shift(),p=parseInt(u,10),_=parseInt(h,10),a=[p,_].sort();if(isNaN(a[0])){if(u>h)return 1;if(h>u)return-1;continue}if(isNaN(a[1]))return isNaN(p)?-1:1;if(p>_)return 1;if(_>p)return-1}return n.length-o.length}const yv={alphanumeric:tce,alphanumericCaseSensitive:nce,text:rce,textCaseSensitive:ice,datetime:oce,basic:ace},sce={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Va("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const n=t.getFilteredRowModel().flatRows.slice(10);let o=!1;for(const u of n){const h=u==null?void 0:u.getValue(e.id);if(Object.prototype.toString.call(h)==="[object Date]")return yv.datetime;if(typeof h=="string"&&(o=!0,h.split(RO).length>1))return yv.alphanumeric}return o?yv.text:yv.basic},e.getAutoSortDir=()=>{const n=t.getFilteredRowModel().flatRows[0];return typeof(n==null?void 0:n.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var n,o;if(!e)throw new Error;return SE(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(n=(o=t.options.sortingFns)==null?void 0:o[e.columnDef.sortingFn])!=null?n:yv[e.columnDef.sortingFn]},e.toggleSorting=(n,o)=>{const u=e.getNextSortingOrder(),h=typeof n<"u"&&n!==null;t.setSorting(p=>{const _=p==null?void 0:p.find(k=>k.id===e.id),a=p==null?void 0:p.findIndex(k=>k.id===e.id);let b=[],C,A=h?n:u==="desc";if(p!=null&&p.length&&e.getCanMultiSort()&&o?_?C="toggle":C="add":p!=null&&p.length&&a!==p.length-1?C="replace":_?C="toggle":C="replace",C==="toggle"&&(h||u||(C="remove")),C==="add"){var O;b=[...p,{id:e.id,desc:A}],b.splice(0,b.length-((O=t.options.maxMultiSortColCount)!=null?O:Number.MAX_SAFE_INTEGER))}else C==="toggle"?b=p.map(k=>k.id===e.id?{...k,desc:A}:k):C==="remove"?b=p.filter(k=>k.id!==e.id):b=[{id:e.id,desc:A}];return b})},e.getFirstSortDir=()=>{var n,o;return((n=(o=e.columnDef.sortDescFirst)!=null?o:t.options.sortDescFirst)!=null?n:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=n=>{var o,u;const h=e.getFirstSortDir(),p=e.getIsSorted();return p?p!==h&&((o=t.options.enableSortingRemoval)==null||o)&&(!(n&&(u=t.options.enableMultiRemove)!=null)||u)?!1:p==="desc"?"asc":"desc":h},e.getCanSort=()=>{var n,o;return((n=e.columnDef.enableSorting)!=null?n:!0)&&((o=t.options.enableSorting)!=null?o:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var n,o;return(n=(o=e.columnDef.enableMultiSort)!=null?o:t.options.enableMultiSort)!=null?n:!!e.accessorFn},e.getIsSorted=()=>{var n;const o=(n=t.getState().sorting)==null?void 0:n.find(u=>u.id===e.id);return o?o.desc?"desc":"asc":!1},e.getSortIndex=()=>{var n,o;return(n=(o=t.getState().sorting)==null?void 0:o.findIndex(u=>u.id===e.id))!=null?n:-1},e.clearSorting=()=>{t.setSorting(n=>n!=null&&n.length?n.filter(o=>o.id!==e.id):[])},e.getToggleSortingHandler=()=>{const n=e.getCanSort();return o=>{n&&(o.persist==null||o.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(o):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var n,o;e.setSorting(t?[]:(n=(o=e.initialState)==null?void 0:o.sorting)!=null?n:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},lce=[Mue,Zue,Gue,Wue,Oue,Rue,Xue,Yue,sce,Uue,Kue,Que,Jue,ece,Hue];function uce(e){var t,n;const o=[...lce,...(t=e._features)!=null?t:[]];let u={_features:o};const h=u._features.reduce((O,k)=>Object.assign(O,k.getDefaultOptions==null?void 0:k.getDefaultOptions(u)),{}),p=O=>u.options.mergeOptions?u.options.mergeOptions(h,O):{...h,...O};let a={...{},...(n=e.initialState)!=null?n:{}};u._features.forEach(O=>{var k;a=(k=O.getInitialState==null?void 0:O.getInitialState(a))!=null?k:a});const b=[];let C=!1;const A={_features:o,options:{...h,...e},initialState:a,_queue:O=>{b.push(O),C||(C=!0,Promise.resolve().then(()=>{for(;b.length;)b.shift()();C=!1}).catch(k=>setTimeout(()=>{throw k})))},reset:()=>{u.setState(u.initialState)},setOptions:O=>{const k=wh(O,u.options);u.options=p(k)},getState:()=>u.options.state,setState:O=>{u.options.onStateChange==null||u.options.onStateChange(O)},_getRowId:(O,k,N)=>{var z;return(z=u.options.getRowId==null?void 0:u.options.getRowId(O,k,N))!=null?z:`${N?[N.id,k].join("."):k}`},getCoreRowModel:()=>(u._getCoreRowModel||(u._getCoreRowModel=u.options.getCoreRowModel(u)),u._getCoreRowModel()),getRowModel:()=>u.getPaginationRowModel(),getRow:(O,k)=>{let N=(k?u.getPrePaginationRowModel():u.getRowModel()).rowsById[O];if(!N&&(N=u.getCoreRowModel().rowsById[O],!N))throw new Error;return N},_getDefaultColumnDef:$n(()=>[u.options.defaultColumn],O=>{var k;return O=(k=O)!=null?k:{},{header:N=>{const z=N.header.column.columnDef;return z.accessorKey?z.accessorKey:z.accessorFn?z.id:null},cell:N=>{var z,U;return(z=(U=N.renderValue())==null||U.toString==null?void 0:U.toString())!=null?z:null},...u._features.reduce((N,z)=>Object.assign(N,z.getDefaultColumnDef==null?void 0:z.getDefaultColumnDef()),{}),...O}},Un(e,"debugColumns")),_getColumnDefs:()=>u.options.columns,getAllColumns:$n(()=>[u._getColumnDefs()],O=>{const k=function(N,z,U){return U===void 0&&(U=0),N.map(j=>{const G=Pue(u,j,U,z),H=j;return G.columns=H.columns?k(H.columns,G,U+1):[],G})};return k(O)},Un(e,"debugColumns")),getAllFlatColumns:$n(()=>[u.getAllColumns()],O=>O.flatMap(k=>k.getFlatColumns()),Un(e,"debugColumns")),_getAllFlatColumnsById:$n(()=>[u.getAllFlatColumns()],O=>O.reduce((k,N)=>(k[N.id]=N,k),{}),Un(e,"debugColumns")),getAllLeafColumns:$n(()=>[u.getAllColumns(),u._getOrderColumnsFn()],(O,k)=>{let N=O.flatMap(z=>z.getLeafColumns());return k(N)},Un(e,"debugColumns")),getColumn:O=>u._getAllFlatColumnsById()[O]};Object.assign(u,A);for(let O=0;O<u._features.length;O++){const k=u._features[O];k==null||k.createTable==null||k.createTable(u)}return u}function cce(){return e=>$n(()=>[e.options.data],t=>{const n={rows:[],flatRows:[],rowsById:{}},o=function(u,h,p){h===void 0&&(h=0);const _=[];for(let b=0;b<u.length;b++){const C=Iue(e,e._getRowId(u[b],b,p),u[b],b,h,void 0,p==null?void 0:p.id);if(n.flatRows.push(C),n.rowsById[C.id]=C,_.push(C),e.options.getSubRows){var a;C.originalSubRows=e.options.getSubRows(u[b],b),(a=C.originalSubRows)!=null&&a.length&&(C.subRows=o(C.originalSubRows,h+1,C))}}return _};return n.rows=o(t),n},Un(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function hce(){return e=>$n(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,n)=>{if(!n.rows.length||!(t!=null&&t.length))return n;const o=e.getState().sorting,u=[],h=o.filter(a=>{var b;return(b=e.getColumn(a.id))==null?void 0:b.getCanSort()}),p={};h.forEach(a=>{const b=e.getColumn(a.id);b&&(p[a.id]={sortUndefined:b.columnDef.sortUndefined,invertSorting:b.columnDef.invertSorting,sortingFn:b.getSortingFn()})});const _=a=>{const b=a.map(C=>({...C}));return b.sort((C,A)=>{for(let k=0;k<h.length;k+=1){var O;const N=h[k],z=p[N.id],U=z.sortUndefined,j=(O=N==null?void 0:N.desc)!=null?O:!1;let G=0;if(U){const H=C.getValue(N.id),Y=A.getValue(N.id),K=H===void 0,ee=Y===void 0;if(K||ee){if(U==="first")return K?-1:1;if(U==="last")return K?1:-1;G=K&&ee?0:K?U:-U}}if(G===0&&(G=z.sortingFn(C,A,N.id)),G!==0)return j&&(G*=-1),z.invertSorting&&(G*=-1),G}return C.index-A.index}),b.forEach(C=>{var A;u.push(C),(A=C.subRows)!=null&&A.length&&(C.subRows=_(C.subRows))}),b};return{rows:_(n.rows),flatRows:u,rowsById:n.rowsById}},Un(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function uj(e,t){return e?fce(e)?W.createElement(e,t):e:null}function fce(e){return dce(e)||typeof e=="function"||pce(e)}function dce(e){return typeof e=="function"&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}function pce(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function mce(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[n]=W.useState(()=>({current:uce(t)})),[o,u]=W.useState(()=>n.current.initialState);return n.current.setOptions(h=>({...h,...e,state:{...o,...e.state},onStateChange:p=>{u(p),e.onStateChange==null||e.onStateChange(p)}})),n.current}const Gk=W.forwardRef(({className:e,...t},n)=>re.jsx("div",{className:"relative w-full overflow-auto",children:re.jsx("table",{ref:n,className:wn("w-full caption-bottom text-sm text-customText",e),...t})}));Gk.displayName="Table";const Wk=W.forwardRef(({className:e,...t},n)=>re.jsx("thead",{ref:n,className:wn("[&_tr]:border-b",e),...t}));Wk.displayName="TableHeader";const Hk=W.forwardRef(({className:e,...t},n)=>re.jsx("tbody",{ref:n,className:wn("[&_tr:last-child]:border-0",e),...t}));Hk.displayName="TableBody";const gce=W.forwardRef(({className:e,...t},n)=>re.jsx("tfoot",{ref:n,className:wn("border-t font-medium [&>tr]:last:border-b-0",e),...t}));gce.displayName="TableFooter";const Jm=W.forwardRef(({className:e,...t},n)=>re.jsx("tr",{ref:n,className:wn("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Jm.displayName="TableRow";const $m=W.forwardRef(({className:e,...t},n)=>re.jsx("th",{ref:n,className:wn("h-12 px-4 text-left align-middle bg-muted/90 font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));$m.displayName="TableHead";const vd=W.forwardRef(({className:e,...t},n)=>re.jsx("td",{ref:n,className:wn("p-4 align-middle [&:has([role=checkbox])]:pr-0 ",e),...t}));vd.displayName="TableCell";const yce=W.forwardRef(({className:e,...t},n)=>re.jsx("caption",{ref:n,className:wn("mt-4 text-sm text-muted-foreground",e),...t}));yce.displayName="TableCaption";function bH({columns:e,data:t}){var h;const[n,o]=W.useState([{id:"latency",desc:!1}]),u=mce({data:t,columns:e,getCoreRowModel:cce(),onSortingChange:o,getSortedRowModel:hce(),state:{sorting:n}});return re.jsx("div",{className:"overflow-auto border rounded-md bg-white h-1/5",children:re.jsxs(Gk,{children:[re.jsx(Wk,{children:u.getHeaderGroups().map(p=>re.jsx(Jm,{children:p.headers.map(_=>re.jsx($m,{children:_.isPlaceholder?null:uj(_.column.columnDef.header,_.getContext())},_.id))},p.id))}),re.jsx(Hk,{children:(h=u.getRowModel().rows)!=null&&h.length?u.getRowModel().rows.map(p=>re.jsx(Jm,{className:"text-customPurple","data-state":p.getIsSelected()&&"selected",children:p.getVisibleCells().map(_=>re.jsx(vd,{className:"text-gray-700",children:uj(_.column.columnDef.cell,_.getContext())},_.id))},p.id)):re.jsx(Jm,{children:re.jsx(vd,{colSpan:e.length,className:"h-24 text-center",children:"No data."})})})]})})}bH.propTypes={columns:En.array.isRequired,data:En.array.isRequired};function wH({regions:e,latencies:t}){const[n,o]=W.useState([]);return W.useEffect(()=>{e.length===0||t.length===0||o(t.filter(u=>{var h;return(h=e.find(p=>p.code===u.region))==null?void 0:h.selected}).map(u=>{var h;return{regionName:(h=e.find(p=>p.code===u.region))==null?void 0:h.name,latency:u.latency}}))},[e,t]),re.jsx(bH,{columns:Tue,data:n})}wH.propTypes={regions:En.array.isRequired,latencies:En.array.isRequired};const _ce=["Americas"];function vce(){const[e,t]=W.useState([]),[n,o]=W.useState([]),[u,h]=W.useState(!0),[p,_]=W.useState(null),[a,b]=W.useState(null);return W.useEffect(()=>{(async()=>{try{const C=await fetch("https://f2ggum2vms.us-west-2.awsapprunner.com/data/regions.json");if(!C.ok)throw new Error("Failed to fetch regions");const A=(await C.json()).map(O=>({...O,selected:_ce.includes(O.area)}));t(A)}catch(C){_(C)}finally{h(!1)}})()},[]),W.useEffect(()=>{n.length!==e.length&&o(e.map(C=>({region:C.code,latency:1/0})))},[e]),W.useEffect(()=>{(async()=>u||p||e.length===0||(a.type===Ur.User?await xce(e,o):a.type===Ur.Region&&a.code?await Sce(a.code,n,o):a.type===Ur.Website&&a.url&&await wce(a.url,o)))()},[a,e,u,p]),re.jsxs(re.Fragment,{children:[re.jsx(iE,{}),re.jsxs("div",{className:"flex flex-row gap-4 pl-7 pt-5 mt-16 h-dvh",children:[re.jsxs("div",{className:"flex flex-col grow",children:[re.jsx("h1",{className:"text-3xl text-sky-950 font-semibold pt-5",children:"Active Data Centers - Worldwide"}),re.jsx("h2",{className:"text-lg text-slate-500",children:"View live latency from location to AWS data centers worldwide"}),re.jsx("div",{className:"h-4/5 w-11/12",children:re.jsx(PG,{regions:e,latencies:n,location:a})})]}),re.jsxs("div",{className:"flex flex-col gap-3 basis-5/12 mr-6",children:[re.jsx(SW,{regions:e,setLocation:b}),re.jsx(hH,{regions:e,latencies:n,setRegions:t}),re.jsx(wH,{regions:e,latencies:n})]})]})]})}async function xce(e,t){await Promise.all(e.filter(n=>n.selected).map(async n=>{const o=await bce(n);t(u=>u.map(h=>h.region===n.code?{...h,latency:o}:h))}))}async function bce(e){const t=`https://dynamodb.${e.code}.amazonaws.com`,n=performance.now();return await fetch(t),performance.now()-n}async function wce(e,t){try{const n=encodeURIComponent(e),o=await fetch(`https://dlche4ubk8.execute-api.us-west-2.amazonaws.com/default/R2CMain-regionToClientHandlerD3108EC1-GwnbgtoBzMOs?origin=${n}`);if(!o.ok)throw new Error("Failed to fetch region client latencies");const u=await o.json();t(u.map(h=>({region:h.region,latency:parseFloat(h.latency)})))}catch(n){console.error("Error fetching region client latencies:",n)}}async function Sce(e,t,n){t=t.map(h=>({...h,latency:1/0})),n(t);const o=await Ece(e),u=[...t];t.forEach((h,p)=>{if(h.region===e)return;const _=o.find(a=>a.destination===h.region);_&&(u[p].latency=_.latency)}),n(u)}async function Tce(e){return(await(await fetch(`https://1nuu606qd3.execute-api.us-west-2.amazonaws.com/default/LambdaStack-us-west-2-regionFunction0D786950-A7tCAv9V8Mr0?origin=${e}`)).json()).details.map(o=>({origin:o.origin,destination:o.destination,latency:parseFloat(o.latency),timestamp:new Date(o.timestamp).getTime()})).sort((o,u)=>o.timestamp-u.timestamp)}const Ece=mk(Tce);var Ace="Separator",cj="horizontal",Cce=["horizontal","vertical"],SH=W.forwardRef((e,t)=>{const{decorative:n,orientation:o=cj,...u}=e,h=Pce(o)?o:cj,_=n?{role:"none"}:{"aria-orientation":h==="vertical"?h:void 0,role:"separator"};return re.jsx(fr.div,{"data-orientation":h,..._,...u,ref:t})});SH.displayName=Ace;function Pce(e){return Cce.includes(e)}var TH=SH;const EH=W.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...o},u)=>re.jsx(TH,{ref:u,decorative:n,orientation:t,className:wn("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...o}));EH.displayName=TH.displayName;var Mce=Array.isArray,ba=Mce,Ice=typeof pd=="object"&&pd&&pd.Object===Object&&pd,AH=Ice,Oce=AH,Rce=typeof self=="object"&&self&&self.Object===Object&&self,kce=Oce||Rce||Function("return this")(),ql=kce,Dce=ql,Lce=Dce.Symbol,Mx=Lce,hj=Mx,CH=Object.prototype,zce=CH.hasOwnProperty,Fce=CH.toString,_v=hj?hj.toStringTag:void 0;function Nce(e){var t=zce.call(e,_v),n=e[_v];try{e[_v]=void 0;var o=!0}catch{}var u=Fce.call(e);return o&&(t?e[_v]=n:delete e[_v]),u}var Bce=Nce,jce=Object.prototype,$ce=jce.toString;function Uce(e){return $ce.call(e)}var Vce=Uce,fj=Mx,Gce=Bce,Wce=Vce,Hce="[object Null]",qce="[object Undefined]",dj=fj?fj.toStringTag:void 0;function Zce(e){return e==null?e===void 0?qce:Hce:dj&&dj in Object(e)?Gce(e):Wce(e)}var rc=Zce;function Xce(e){return e!=null&&typeof e=="object"}var ic=Xce,Yce=rc,Kce=ic,Qce="[object Symbol]";function Jce(e){return typeof e=="symbol"||Kce(e)&&Yce(e)==Qce}var Xg=Jce,ehe=ba,the=Xg,nhe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rhe=/^\w*$/;function ihe(e,t){if(ehe(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||the(e)?!0:rhe.test(e)||!nhe.test(e)||t!=null&&e in Object(t)}var qk=ihe;function ohe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Xh=ohe;const Yg=Vr(Xh);var ahe=rc,she=Xh,lhe="[object AsyncFunction]",uhe="[object Function]",che="[object GeneratorFunction]",hhe="[object Proxy]";function fhe(e){if(!she(e))return!1;var t=ahe(e);return t==uhe||t==che||t==lhe||t==hhe}var Zk=fhe;const hr=Vr(Zk);var dhe=ql,phe=dhe["__core-js_shared__"],mhe=phe,EM=mhe,pj=function(){var e=/[^.]+$/.exec(EM&&EM.keys&&EM.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function ghe(e){return!!pj&&pj in e}var yhe=ghe,_he=Function.prototype,vhe=_he.toString;function xhe(e){if(e!=null){try{return vhe.call(e)}catch{}try{return e+""}catch{}}return""}var PH=xhe,bhe=Zk,whe=yhe,She=Xh,The=PH,Ehe=/[\\^$.*+?()[\]{}|]/g,Ahe=/^\[object .+?Constructor\]$/,Che=Function.prototype,Phe=Object.prototype,Mhe=Che.toString,Ihe=Phe.hasOwnProperty,Ohe=RegExp("^"+Mhe.call(Ihe).replace(Ehe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Rhe(e){if(!She(e)||whe(e))return!1;var t=bhe(e)?Ohe:Ahe;return t.test(The(e))}var khe=Rhe;function Dhe(e,t){return e==null?void 0:e[t]}var Lhe=Dhe,zhe=khe,Fhe=Lhe;function Nhe(e,t){var n=Fhe(e,t);return zhe(n)?n:void 0}var Yd=Nhe,Bhe=Yd,jhe=Bhe(Object,"create"),TE=jhe,mj=TE;function $he(){this.__data__=mj?mj(null):{},this.size=0}var Uhe=$he;function Vhe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Ghe=Vhe,Whe=TE,Hhe="__lodash_hash_undefined__",qhe=Object.prototype,Zhe=qhe.hasOwnProperty;function Xhe(e){var t=this.__data__;if(Whe){var n=t[e];return n===Hhe?void 0:n}return Zhe.call(t,e)?t[e]:void 0}var Yhe=Xhe,Khe=TE,Qhe=Object.prototype,Jhe=Qhe.hasOwnProperty;function efe(e){var t=this.__data__;return Khe?t[e]!==void 0:Jhe.call(t,e)}var tfe=efe,nfe=TE,rfe="__lodash_hash_undefined__";function ife(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nfe&&t===void 0?rfe:t,this}var ofe=ife,afe=Uhe,sfe=Ghe,lfe=Yhe,ufe=tfe,cfe=ofe;function Kg(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Kg.prototype.clear=afe;Kg.prototype.delete=sfe;Kg.prototype.get=lfe;Kg.prototype.has=ufe;Kg.prototype.set=cfe;var hfe=Kg;function ffe(){this.__data__=[],this.size=0}var dfe=ffe;function pfe(e,t){return e===t||e!==e&&t!==t}var Xk=pfe,mfe=Xk;function gfe(e,t){for(var n=e.length;n--;)if(mfe(e[n][0],t))return n;return-1}var EE=gfe,yfe=EE,_fe=Array.prototype,vfe=_fe.splice;function xfe(e){var t=this.__data__,n=yfe(t,e);if(n<0)return!1;var o=t.length-1;return n==o?t.pop():vfe.call(t,n,1),--this.size,!0}var bfe=xfe,wfe=EE;function Sfe(e){var t=this.__data__,n=wfe(t,e);return n<0?void 0:t[n][1]}var Tfe=Sfe,Efe=EE;function Afe(e){return Efe(this.__data__,e)>-1}var Cfe=Afe,Pfe=EE;function Mfe(e,t){var n=this.__data__,o=Pfe(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}var Ife=Mfe,Ofe=dfe,Rfe=bfe,kfe=Tfe,Dfe=Cfe,Lfe=Ife;function Qg(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Qg.prototype.clear=Ofe;Qg.prototype.delete=Rfe;Qg.prototype.get=kfe;Qg.prototype.has=Dfe;Qg.prototype.set=Lfe;var AE=Qg,zfe=Yd,Ffe=ql,Nfe=zfe(Ffe,"Map"),Yk=Nfe,gj=hfe,Bfe=AE,jfe=Yk;function $fe(){this.size=0,this.__data__={hash:new gj,map:new(jfe||Bfe),string:new gj}}var Ufe=$fe;function Vfe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Gfe=Vfe,Wfe=Gfe;function Hfe(e,t){var n=e.__data__;return Wfe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var CE=Hfe,qfe=CE;function Zfe(e){var t=qfe(this,e).delete(e);return this.size-=t?1:0,t}var Xfe=Zfe,Yfe=CE;function Kfe(e){return Yfe(this,e).get(e)}var Qfe=Kfe,Jfe=CE;function ede(e){return Jfe(this,e).has(e)}var tde=ede,nde=CE;function rde(e,t){var n=nde(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}var ide=rde,ode=Ufe,ade=Xfe,sde=Qfe,lde=tde,ude=ide;function Jg(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Jg.prototype.clear=ode;Jg.prototype.delete=ade;Jg.prototype.get=sde;Jg.prototype.has=lde;Jg.prototype.set=ude;var Kk=Jg,MH=Kk,cde="Expected a function";function Qk(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(cde);var n=function(){var o=arguments,u=t?t.apply(this,o):o[0],h=n.cache;if(h.has(u))return h.get(u);var p=e.apply(this,o);return n.cache=h.set(u,p)||h,p};return n.cache=new(Qk.Cache||MH),n}Qk.Cache=MH;var IH=Qk;const hde=Vr(IH);var fde=IH,dde=500;function pde(e){var t=fde(e,function(o){return n.size===dde&&n.clear(),o}),n=t.cache;return t}var mde=pde,gde=mde,yde=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_de=/\\(\\)?/g,vde=gde(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(yde,function(n,o,u,h){t.push(u?h.replace(_de,"$1"):o||n)}),t}),xde=vde;function bde(e,t){for(var n=-1,o=e==null?0:e.length,u=Array(o);++n<o;)u[n]=t(e[n],n,e);return u}var Jk=bde,yj=Mx,wde=Jk,Sde=ba,Tde=Xg,Ede=1/0,_j=yj?yj.prototype:void 0,vj=_j?_j.toString:void 0;function OH(e){if(typeof e=="string")return e;if(Sde(e))return wde(e,OH)+"";if(Tde(e))return vj?vj.call(e):"";var t=e+"";return t=="0"&&1/e==-Ede?"-0":t}var Ade=OH,Cde=Ade;function Pde(e){return e==null?"":Cde(e)}var RH=Pde,Mde=ba,Ide=qk,Ode=xde,Rde=RH;function kde(e,t){return Mde(e)?e:Ide(e,t)?[e]:Ode(Rde(e))}var kH=kde,Dde=Xg,Lde=1/0;function zde(e){if(typeof e=="string"||Dde(e))return e;var t=e+"";return t=="0"&&1/e==-Lde?"-0":t}var PE=zde,Fde=kH,Nde=PE;function Bde(e,t){t=Fde(t,e);for(var n=0,o=t.length;e!=null&&n<o;)e=e[Nde(t[n++])];return n&&n==o?e:void 0}var eD=Bde,jde=eD;function $de(e,t,n){var o=e==null?void 0:jde(e,t);return o===void 0?n:o}var DH=$de;const vs=Vr(DH);function Ude(e){return e==null}var Vde=Ude;const Tr=Vr(Vde);var Gde=rc,Wde=ba,Hde=ic,qde="[object String]";function Zde(e){return typeof e=="string"||!Wde(e)&&Hde(e)&&Gde(e)==qde}var Xde=Zde;const Ix=Vr(Xde);var LH={exports:{}},Hr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tD=Symbol.for("react.element"),nD=Symbol.for("react.portal"),ME=Symbol.for("react.fragment"),IE=Symbol.for("react.strict_mode"),OE=Symbol.for("react.profiler"),RE=Symbol.for("react.provider"),kE=Symbol.for("react.context"),Yde=Symbol.for("react.server_context"),DE=Symbol.for("react.forward_ref"),LE=Symbol.for("react.suspense"),zE=Symbol.for("react.suspense_list"),FE=Symbol.for("react.memo"),NE=Symbol.for("react.lazy"),Kde=Symbol.for("react.offscreen"),zH;zH=Symbol.for("react.module.reference");function Es(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case tD:switch(e=e.type,e){case ME:case OE:case IE:case LE:case zE:return e;default:switch(e=e&&e.$$typeof,e){case Yde:case kE:case DE:case NE:case FE:case RE:return e;default:return t}}case nD:return t}}}Hr.ContextConsumer=kE;Hr.ContextProvider=RE;Hr.Element=tD;Hr.ForwardRef=DE;Hr.Fragment=ME;Hr.Lazy=NE;Hr.Memo=FE;Hr.Portal=nD;Hr.Profiler=OE;Hr.StrictMode=IE;Hr.Suspense=LE;Hr.SuspenseList=zE;Hr.isAsyncMode=function(){return!1};Hr.isConcurrentMode=function(){return!1};Hr.isContextConsumer=function(e){return Es(e)===kE};Hr.isContextProvider=function(e){return Es(e)===RE};Hr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===tD};Hr.isForwardRef=function(e){return Es(e)===DE};Hr.isFragment=function(e){return Es(e)===ME};Hr.isLazy=function(e){return Es(e)===NE};Hr.isMemo=function(e){return Es(e)===FE};Hr.isPortal=function(e){return Es(e)===nD};Hr.isProfiler=function(e){return Es(e)===OE};Hr.isStrictMode=function(e){return Es(e)===IE};Hr.isSuspense=function(e){return Es(e)===LE};Hr.isSuspenseList=function(e){return Es(e)===zE};Hr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===ME||e===OE||e===IE||e===LE||e===zE||e===Kde||typeof e=="object"&&e!==null&&(e.$$typeof===NE||e.$$typeof===FE||e.$$typeof===RE||e.$$typeof===kE||e.$$typeof===DE||e.$$typeof===zH||e.getModuleId!==void 0)};Hr.typeOf=Es;LH.exports=Hr;var FH=LH.exports,Qde=rc,Jde=ic,epe="[object Number]";function tpe(e){return typeof e=="number"||Jde(e)&&Qde(e)==epe}var NH=tpe;const npe=Vr(NH);var rpe=NH;function ipe(e){return rpe(e)&&e!=+e}var ope=ipe;const ey=Vr(ope);var Js=function(t){return t===0?0:t>0?1:-1},xd=function(t){return Ix(t)&&t.indexOf("%")===t.length-1},Qt=function(t){return npe(t)&&!ey(t)},to=function(t){return Qt(t)||Ix(t)},ape=0,Ox=function(t){var n=++ape;return"".concat(t||"").concat(n)},$d=function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Qt(t)&&!Ix(t))return o;var h;if(xd(t)){var p=t.indexOf("%");h=n*parseFloat(t.slice(0,p))/100}else h=+t;return ey(h)&&(h=o),u&&h>n&&(h=n),h},_h=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},spe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,o={},u=0;u<n;u++)if(!o[t[u]])o[t[u]]=!0;else return!0;return!1},ps=function(t,n){return Qt(t)&&Qt(n)?function(o){return t+o*(n-t)}:function(){return n}};function zS(e,t,n){return!e||!e.length?null:e.find(function(o){return o&&(typeof t=="function"?t(o):vs(o,t))===n})}function eg(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var o in t)if({}.hasOwnProperty.call(t,o)&&!{}.hasOwnProperty.call(e,o))return!1;return!0}function kO(e){"@babel/helpers - typeof";return kO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kO(e)}var lpe=["viewBox","children"],upe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],xj=["points","pathLength"],AM={svg:lpe,polygon:xj,polyline:xj},rD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],FS=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(W.isValidElement(t)&&(o=t.props),!Yg(o))return null;var u={};return Object.keys(o).forEach(function(h){rD.includes(h)&&(u[h]=n||function(p){return o[h](o,p)})}),u},cpe=function(t,n,o){return function(u){return t(n,o,u),null}},NS=function(t,n,o){if(!Yg(t)||kO(t)!=="object")return null;var u=null;return Object.keys(t).forEach(function(h){var p=t[h];rD.includes(h)&&typeof p=="function"&&(u||(u={}),u[h]=cpe(p,n,o))}),u},hpe=["children"],fpe=["children"];function bj(e,t){if(e==null)return{};var n=dpe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function dpe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function DO(e){"@babel/helpers - typeof";return DO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DO(e)}var wj={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Fu=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Sj=null,CM=null,iD=function e(t){if(t===Sj&&Array.isArray(CM))return CM;var n=[];return W.Children.forEach(t,function(o){Tr(o)||(FH.isFragment(o)?n=n.concat(e(o.props.children)):n.push(o))}),CM=n,Sj=t,n};function rl(e,t){var n=[],o=[];return Array.isArray(t)?o=t.map(function(u){return Fu(u)}):o=[Fu(t)],iD(e).forEach(function(u){var h=vs(u,"type.displayName")||vs(u,"type.name");o.indexOf(h)!==-1&&n.push(u)}),n}function La(e,t){var n=rl(e,t);return n&&n[0]}var Tj=function(t){if(!t||!t.props)return!1;var n=t.props,o=n.width,u=n.height;return!(!Qt(o)||o<=0||!Qt(u)||u<=0)},ppe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],mpe=function(t){return t&&t.type&&Ix(t.type)&&ppe.indexOf(t.type)>=0},gpe=function(t){return t&&DO(t)==="object"&&"cx"in t&&"cy"in t&&"r"in t},ype=function(t,n,o,u){var h,p=(h=AM==null?void 0:AM[u])!==null&&h!==void 0?h:[];return!hr(t)&&(u&&p.includes(n)||upe.includes(n))||o&&rD.includes(n)},gr=function(t,n,o){if(!t||typeof t=="function"||typeof t=="boolean")return null;var u=t;if(W.isValidElement(t)&&(u=t.props),!Yg(u))return null;var h={};return Object.keys(u).forEach(function(p){var _;ype((_=u)===null||_===void 0?void 0:_[p],p,n,o)&&(h[p]=u[p])}),h},LO=function e(t,n){if(t===n)return!0;var o=W.Children.count(t);if(o!==W.Children.count(n))return!1;if(o===0)return!0;if(o===1)return Ej(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var u=0;u<o;u++){var h=t[u],p=n[u];if(Array.isArray(h)||Array.isArray(p)){if(!e(h,p))return!1}else if(!Ej(h,p))return!1}return!0},Ej=function(t,n){if(Tr(t)&&Tr(n))return!0;if(!Tr(t)&&!Tr(n)){var o=t.props||{},u=o.children,h=bj(o,hpe),p=n.props||{},_=p.children,a=bj(p,fpe);return u&&_?eg(h,a)&&LO(u,_):!u&&!_?eg(h,a):!1}return!1},Aj=function(t,n){var o=[],u={};return iD(t).forEach(function(h,p){if(mpe(h))o.push(h);else if(h){var _=Fu(h.type),a=n[_]||{},b=a.handler,C=a.once;if(b&&(!C||!u[_])){var A=b(h,_,p);o.push(A),u[_]=!0}}}),o},_pe=function(t){var n=t&&t.type;return n&&wj[n]?wj[n]:null},vpe=function(t,n){return iD(n).indexOf(t)},xpe=["children","width","height","viewBox","className","style","title","desc"];function zO(){return zO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},zO.apply(this,arguments)}function bpe(e,t){if(e==null)return{};var n=wpe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function wpe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function FO(e){var t=e.children,n=e.width,o=e.height,u=e.viewBox,h=e.className,p=e.style,_=e.title,a=e.desc,b=bpe(e,xpe),C=u||{width:n,height:o,x:0,y:0},A=Cr("recharts-surface",h);return Ye.createElement("svg",zO({},gr(b,!0,"svg"),{className:A,width:n,height:o,style:p,viewBox:"".concat(C.x," ").concat(C.y," ").concat(C.width," ").concat(C.height)}),Ye.createElement("title",null,_),Ye.createElement("desc",null,a),t)}var Spe=["children","className"];function NO(){return NO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},NO.apply(this,arguments)}function Tpe(e,t){if(e==null)return{};var n=Epe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function Epe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}var xi=Ye.forwardRef(function(e,t){var n=e.children,o=e.className,u=Tpe(e,Spe),h=Cr("recharts-layer",o);return Ye.createElement("g",NO({className:h},gr(u,!0),{ref:t}),n)}),Nu=function(t,n){for(var o=arguments.length,u=new Array(o>2?o-2:0),h=2;h<o;h++)u[h-2]=arguments[h]};function Ape(e,t,n){var o=-1,u=e.length;t<0&&(t=-t>u?0:u+t),n=n>u?u:n,n<0&&(n+=u),u=t>n?0:n-t>>>0,t>>>=0;for(var h=Array(u);++o<u;)h[o]=e[o+t];return h}var Cpe=Ape,Ppe=Cpe;function Mpe(e,t,n){var o=e.length;return n=n===void 0?o:n,!t&&n>=o?e:Ppe(e,t,n)}var Ipe=Mpe,Ope="\\ud800-\\udfff",Rpe="\\u0300-\\u036f",kpe="\\ufe20-\\ufe2f",Dpe="\\u20d0-\\u20ff",Lpe=Rpe+kpe+Dpe,zpe="\\ufe0e\\ufe0f",Fpe="\\u200d",Npe=RegExp("["+Fpe+Ope+Lpe+zpe+"]");function Bpe(e){return Npe.test(e)}var BH=Bpe;function jpe(e){return e.split("")}var $pe=jpe,jH="\\ud800-\\udfff",Upe="\\u0300-\\u036f",Vpe="\\ufe20-\\ufe2f",Gpe="\\u20d0-\\u20ff",Wpe=Upe+Vpe+Gpe,Hpe="\\ufe0e\\ufe0f",qpe="["+jH+"]",BO="["+Wpe+"]",jO="\\ud83c[\\udffb-\\udfff]",Zpe="(?:"+BO+"|"+jO+")",$H="[^"+jH+"]",UH="(?:\\ud83c[\\udde6-\\uddff]){2}",VH="[\\ud800-\\udbff][\\udc00-\\udfff]",Xpe="\\u200d",GH=Zpe+"?",WH="["+Hpe+"]?",Ype="(?:"+Xpe+"(?:"+[$H,UH,VH].join("|")+")"+WH+GH+")*",Kpe=WH+GH+Ype,Qpe="(?:"+[$H+BO+"?",BO,UH,VH,qpe].join("|")+")",Jpe=RegExp(jO+"(?="+jO+")|"+Qpe+Kpe,"g");function eme(e){return e.match(Jpe)||[]}var tme=eme,nme=$pe,rme=BH,ime=tme;function ome(e){return rme(e)?ime(e):nme(e)}var ame=ome,sme=Ipe,lme=BH,ume=ame,cme=RH;function hme(e){return function(t){t=cme(t);var n=lme(t)?ume(t):void 0,o=n?n[0]:t.charAt(0),u=n?sme(n,1).join(""):t.slice(1);return o[e]()+u}}var fme=hme,dme=fme,pme=dme("toUpperCase"),mme=pme;const BE=Vr(mme);function ni(e){return function(){return e}}const HH=Math.cos,BS=Math.sin,ll=Math.sqrt,jS=Math.PI,jE=2*jS,$O=Math.PI,UO=2*$O,cd=1e-6,gme=UO-cd;function qH(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function yme(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return qH;const n=10**t;return function(o){this._+=o[0];for(let u=1,h=o.length;u<h;++u)this._+=Math.round(arguments[u]*n)/n+o[u]}}class _me{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?qH:yme(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,o,u){this._append`Q${+t},${+n},${this._x1=+o},${this._y1=+u}`}bezierCurveTo(t,n,o,u,h,p){this._append`C${+t},${+n},${+o},${+u},${this._x1=+h},${this._y1=+p}`}arcTo(t,n,o,u,h){if(t=+t,n=+n,o=+o,u=+u,h=+h,h<0)throw new Error(`negative radius: ${h}`);let p=this._x1,_=this._y1,a=o-t,b=u-n,C=p-t,A=_-n,O=C*C+A*A;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(O>cd)if(!(Math.abs(A*a-b*C)>cd)||!h)this._append`L${this._x1=t},${this._y1=n}`;else{let k=o-p,N=u-_,z=a*a+b*b,U=k*k+N*N,j=Math.sqrt(z),G=Math.sqrt(O),H=h*Math.tan(($O-Math.acos((z+O-U)/(2*j*G)))/2),Y=H/G,K=H/j;Math.abs(Y-1)>cd&&this._append`L${t+Y*C},${n+Y*A}`,this._append`A${h},${h},0,0,${+(A*k>C*N)},${this._x1=t+K*a},${this._y1=n+K*b}`}}arc(t,n,o,u,h,p){if(t=+t,n=+n,o=+o,p=!!p,o<0)throw new Error(`negative radius: ${o}`);let _=o*Math.cos(u),a=o*Math.sin(u),b=t+_,C=n+a,A=1^p,O=p?u-h:h-u;this._x1===null?this._append`M${b},${C}`:(Math.abs(this._x1-b)>cd||Math.abs(this._y1-C)>cd)&&this._append`L${b},${C}`,o&&(O<0&&(O=O%UO+UO),O>gme?this._append`A${o},${o},0,1,${A},${t-_},${n-a}A${o},${o},0,1,${A},${this._x1=b},${this._y1=C}`:O>cd&&this._append`A${o},${o},0,${+(O>=$O)},${A},${this._x1=t+o*Math.cos(h)},${this._y1=n+o*Math.sin(h)}`)}rect(t,n,o,u){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${o=+o}v${+u}h${-o}Z`}toString(){return this._}}function oD(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const o=Math.floor(n);if(!(o>=0))throw new RangeError(`invalid digits: ${n}`);t=o}return e},()=>new _me(t)}function aD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ZH(e){this._context=e}ZH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $E(e){return new ZH(e)}function XH(e){return e[0]}function YH(e){return e[1]}function KH(e,t){var n=ni(!0),o=null,u=$E,h=null,p=oD(_);e=typeof e=="function"?e:e===void 0?XH:ni(e),t=typeof t=="function"?t:t===void 0?YH:ni(t);function _(a){var b,C=(a=aD(a)).length,A,O=!1,k;for(o==null&&(h=u(k=p())),b=0;b<=C;++b)!(b<C&&n(A=a[b],b,a))===O&&((O=!O)?h.lineStart():h.lineEnd()),O&&h.point(+e(A,b,a),+t(A,b,a));if(k)return h=null,k+""||null}return _.x=function(a){return arguments.length?(e=typeof a=="function"?a:ni(+a),_):e},_.y=function(a){return arguments.length?(t=typeof a=="function"?a:ni(+a),_):t},_.defined=function(a){return arguments.length?(n=typeof a=="function"?a:ni(!!a),_):n},_.curve=function(a){return arguments.length?(u=a,o!=null&&(h=u(o)),_):u},_.context=function(a){return arguments.length?(a==null?o=h=null:h=u(o=a),_):o},_}function ww(e,t,n){var o=null,u=ni(!0),h=null,p=$E,_=null,a=oD(b);e=typeof e=="function"?e:e===void 0?XH:ni(+e),t=typeof t=="function"?t:ni(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?YH:ni(+n);function b(A){var O,k,N,z=(A=aD(A)).length,U,j=!1,G,H=new Array(z),Y=new Array(z);for(h==null&&(_=p(G=a())),O=0;O<=z;++O){if(!(O<z&&u(U=A[O],O,A))===j)if(j=!j)k=O,_.areaStart(),_.lineStart();else{for(_.lineEnd(),_.lineStart(),N=O-1;N>=k;--N)_.point(H[N],Y[N]);_.lineEnd(),_.areaEnd()}j&&(H[O]=+e(U,O,A),Y[O]=+t(U,O,A),_.point(o?+o(U,O,A):H[O],n?+n(U,O,A):Y[O]))}if(G)return _=null,G+""||null}function C(){return KH().defined(u).curve(p).context(h)}return b.x=function(A){return arguments.length?(e=typeof A=="function"?A:ni(+A),o=null,b):e},b.x0=function(A){return arguments.length?(e=typeof A=="function"?A:ni(+A),b):e},b.x1=function(A){return arguments.length?(o=A==null?null:typeof A=="function"?A:ni(+A),b):o},b.y=function(A){return arguments.length?(t=typeof A=="function"?A:ni(+A),n=null,b):t},b.y0=function(A){return arguments.length?(t=typeof A=="function"?A:ni(+A),b):t},b.y1=function(A){return arguments.length?(n=A==null?null:typeof A=="function"?A:ni(+A),b):n},b.lineX0=b.lineY0=function(){return C().x(e).y(t)},b.lineY1=function(){return C().x(e).y(n)},b.lineX1=function(){return C().x(o).y(t)},b.defined=function(A){return arguments.length?(u=typeof A=="function"?A:ni(!!A),b):u},b.curve=function(A){return arguments.length?(p=A,h!=null&&(_=p(h)),b):p},b.context=function(A){return arguments.length?(A==null?h=_=null:_=p(h=A),b):h},b}class QH{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function vme(e){return new QH(e,!0)}function xme(e){return new QH(e,!1)}const sD={draw(e,t){const n=ll(t/jS);e.moveTo(n,0),e.arc(0,0,n,0,jE)}},bme={draw(e,t){const n=ll(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},JH=ll(1/3),wme=JH*2,Sme={draw(e,t){const n=ll(t/wme),o=n*JH;e.moveTo(0,-n),e.lineTo(o,0),e.lineTo(0,n),e.lineTo(-o,0),e.closePath()}},Tme={draw(e,t){const n=ll(t),o=-n/2;e.rect(o,o,n,n)}},Eme=.8908130915292852,e9=BS(jS/10)/BS(7*jS/10),Ame=BS(jE/10)*e9,Cme=-HH(jE/10)*e9,Pme={draw(e,t){const n=ll(t*Eme),o=Ame*n,u=Cme*n;e.moveTo(0,-n),e.lineTo(o,u);for(let h=1;h<5;++h){const p=jE*h/5,_=HH(p),a=BS(p);e.lineTo(a*n,-_*n),e.lineTo(_*o-a*u,a*o+_*u)}e.closePath()}},PM=ll(3),Mme={draw(e,t){const n=-ll(t/(PM*3));e.moveTo(0,n*2),e.lineTo(-PM*n,-n),e.lineTo(PM*n,-n),e.closePath()}},us=-.5,cs=ll(3)/2,VO=1/ll(12),Ime=(VO/2+1)*3,Ome={draw(e,t){const n=ll(t/Ime),o=n/2,u=n*VO,h=o,p=n*VO+n,_=-h,a=p;e.moveTo(o,u),e.lineTo(h,p),e.lineTo(_,a),e.lineTo(us*o-cs*u,cs*o+us*u),e.lineTo(us*h-cs*p,cs*h+us*p),e.lineTo(us*_-cs*a,cs*_+us*a),e.lineTo(us*o+cs*u,us*u-cs*o),e.lineTo(us*h+cs*p,us*p-cs*h),e.lineTo(us*_+cs*a,us*a-cs*_),e.closePath()}};function Rme(e,t){let n=null,o=oD(u);e=typeof e=="function"?e:ni(e||sD),t=typeof t=="function"?t:ni(t===void 0?64:+t);function u(){let h;if(n||(n=h=o()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),h)return n=null,h+""||null}return u.type=function(h){return arguments.length?(e=typeof h=="function"?h:ni(h),u):e},u.size=function(h){return arguments.length?(t=typeof h=="function"?h:ni(+h),u):t},u.context=function(h){return arguments.length?(n=h??null,u):n},u}function $S(){}function US(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function t9(e){this._context=e}t9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:US(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:US(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kme(e){return new t9(e)}function n9(e){this._context=e}n9.prototype={areaStart:$S,areaEnd:$S,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:US(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Dme(e){return new n9(e)}function r9(e){this._context=e}r9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,o):this._context.moveTo(n,o);break;case 3:this._point=4;default:US(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Lme(e){return new r9(e)}function i9(e){this._context=e}i9.prototype={areaStart:$S,areaEnd:$S,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function zme(e){return new i9(e)}function Cj(e){return e<0?-1:1}function Pj(e,t,n){var o=e._x1-e._x0,u=t-e._x1,h=(e._y1-e._y0)/(o||u<0&&-0),p=(n-e._y1)/(u||o<0&&-0),_=(h*u+p*o)/(o+u);return(Cj(h)+Cj(p))*Math.min(Math.abs(h),Math.abs(p),.5*Math.abs(_))||0}function Mj(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function MM(e,t,n){var o=e._x0,u=e._y0,h=e._x1,p=e._y1,_=(h-o)/3;e._context.bezierCurveTo(o+_,u+_*t,h-_,p-_*n,h,p)}function VS(e){this._context=e}VS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:MM(this,this._t0,Mj(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,MM(this,Mj(this,n=Pj(this,e,t)),n);break;default:MM(this,this._t0,n=Pj(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function o9(e){this._context=new a9(e)}(o9.prototype=Object.create(VS.prototype)).point=function(e,t){VS.prototype.point.call(this,t,e)};function a9(e){this._context=e}a9.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,o,u,h){this._context.bezierCurveTo(t,e,o,n,h,u)}};function Fme(e){return new VS(e)}function Nme(e){return new o9(e)}function s9(e){this._context=e}s9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var o=Ij(e),u=Ij(t),h=0,p=1;p<n;++h,++p)this._context.bezierCurveTo(o[0][h],u[0][h],o[1][h],u[1][h],e[p],t[p]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Ij(e){var t,n=e.length-1,o,u=new Array(n),h=new Array(n),p=new Array(n);for(u[0]=0,h[0]=2,p[0]=e[0]+2*e[1],t=1;t<n-1;++t)u[t]=1,h[t]=4,p[t]=4*e[t]+2*e[t+1];for(u[n-1]=2,h[n-1]=7,p[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)o=u[t]/h[t-1],h[t]-=o,p[t]-=o*p[t-1];for(u[n-1]=p[n-1]/h[n-1],t=n-2;t>=0;--t)u[t]=(p[t]-u[t+1])/h[t];for(h[n-1]=(e[n]+u[n-1])/2,t=0;t<n-1;++t)h[t]=2*e[t+1]-u[t+1];return[u,h]}function Bme(e){return new s9(e)}function UE(e,t){this._context=e,this._t=t}UE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function jme(e){return new UE(e,.5)}function $me(e){return new UE(e,0)}function Ume(e){return new UE(e,1)}function yg(e,t){if((p=e.length)>1)for(var n=1,o,u,h=e[t[0]],p,_=h.length;n<p;++n)for(u=h,h=e[t[n]],o=0;o<_;++o)h[o][1]+=h[o][0]=isNaN(u[o][1])?u[o][0]:u[o][1]}function GO(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Vme(e,t){return e[t]}function Gme(e){const t=[];return t.key=e,t}function Wme(){var e=ni([]),t=GO,n=yg,o=Vme;function u(h){var p=Array.from(e.apply(this,arguments),Gme),_,a=p.length,b=-1,C;for(const A of h)for(_=0,++b;_<a;++_)(p[_][b]=[0,+o(A,p[_].key,b,h)]).data=A;for(_=0,C=aD(t(p));_<a;++_)p[C[_]].index=_;return n(p,C),p}return u.keys=function(h){return arguments.length?(e=typeof h=="function"?h:ni(Array.from(h)),u):e},u.value=function(h){return arguments.length?(o=typeof h=="function"?h:ni(+h),u):o},u.order=function(h){return arguments.length?(t=h==null?GO:typeof h=="function"?h:ni(Array.from(h)),u):t},u.offset=function(h){return arguments.length?(n=h??yg,u):n},u}function Hme(e,t){if((o=e.length)>0){for(var n,o,u=0,h=e[0].length,p;u<h;++u){for(p=n=0;n<o;++n)p+=e[n][u][1]||0;if(p)for(n=0;n<o;++n)e[n][u][1]/=p}yg(e,t)}}function qme(e,t){if((u=e.length)>0){for(var n=0,o=e[t[0]],u,h=o.length;n<h;++n){for(var p=0,_=0;p<u;++p)_+=e[p][n][1]||0;o[n][1]+=o[n][0]=-_/2}yg(e,t)}}function Zme(e,t){if(!(!((p=e.length)>0)||!((h=(u=e[t[0]]).length)>0))){for(var n=0,o=1,u,h,p;o<h;++o){for(var _=0,a=0,b=0;_<p;++_){for(var C=e[t[_]],A=C[o][1]||0,O=C[o-1][1]||0,k=(A-O)/2,N=0;N<_;++N){var z=e[t[N]],U=z[o][1]||0,j=z[o-1][1]||0;k+=U-j}a+=A,b+=k*A}u[o-1][1]+=u[o-1][0]=n,a&&(n-=b/a)}u[o-1][1]+=u[o-1][0]=n,yg(e,t)}}function C0(e){"@babel/helpers - typeof";return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C0(e)}var Xme=["type","size","sizeType"];function WO(){return WO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},WO.apply(this,arguments)}function Oj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Rj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Oj(Object(n),!0).forEach(function(o){Yme(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oj(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Yme(e,t,n){return t=Kme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kme(e){var t=Qme(e,"string");return C0(t)=="symbol"?t:t+""}function Qme(e,t){if(C0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(C0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jme(e,t){if(e==null)return{};var n=ege(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function ege(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}var l9={symbolCircle:sD,symbolCross:bme,symbolDiamond:Sme,symbolSquare:Tme,symbolStar:Pme,symbolTriangle:Mme,symbolWye:Ome},tge=Math.PI/180,nge=function(t){var n="symbol".concat(BE(t));return l9[n]||sD},rge=function(t,n,o){if(n==="area")return t;switch(o){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var u=18*tge;return 1.25*t*t*(Math.tan(u)-Math.tan(u*2)*Math.pow(Math.tan(u),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},ige=function(t,n){l9["symbol".concat(BE(t))]=n},lD=function(t){var n=t.type,o=n===void 0?"circle":n,u=t.size,h=u===void 0?64:u,p=t.sizeType,_=p===void 0?"area":p,a=Jme(t,Xme),b=Rj(Rj({},a),{},{type:o,size:h,sizeType:_}),C=function(){var U=nge(o),j=Rme().type(U).size(rge(h,_,o));return j()},A=b.className,O=b.cx,k=b.cy,N=gr(b,!0);return O===+O&&k===+k&&h===+h?Ye.createElement("path",WO({},N,{className:Cr("recharts-symbols",A),transform:"translate(".concat(O,", ").concat(k,")"),d:C()})):null};lD.registerSymbol=ige;function _g(e){"@babel/helpers - typeof";return _g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_g(e)}function HO(){return HO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},HO.apply(this,arguments)}function kj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function oge(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kj(Object(n),!0).forEach(function(o){P0(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kj(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function age(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sge(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c9(o.key),o)}}function lge(e,t,n){return t&&sge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uge(e,t,n){return t=GS(t),cge(e,u9()?Reflect.construct(t,n||[],GS(e).constructor):t.apply(e,n))}function cge(e,t){if(t&&(_g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hge(e)}function hge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(u9=function(){return!!e})()}function GS(e){return GS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},GS(e)}function fge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},qO(e,t)}function P0(e,t,n){return t=c9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c9(e){var t=dge(e,"string");return _g(t)=="symbol"?t:t+""}function dge(e,t){if(_g(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(_g(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hs=32,uD=function(e){function t(){return age(this,t),uge(this,t,arguments)}return fge(t,e),lge(t,[{key:"renderIcon",value:function(o){var u=this.props.inactiveColor,h=hs/2,p=hs/6,_=hs/3,a=o.inactive?u:o.color;if(o.type==="plainline")return Ye.createElement("line",{strokeWidth:4,fill:"none",stroke:a,strokeDasharray:o.payload.strokeDasharray,x1:0,y1:h,x2:hs,y2:h,className:"recharts-legend-icon"});if(o.type==="line")return Ye.createElement("path",{strokeWidth:4,fill:"none",stroke:a,d:"M0,".concat(h,"h").concat(_,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(2*_,",").concat(h,`
            H`).concat(hs,"M").concat(2*_,",").concat(h,`
            A`).concat(p,",").concat(p,",0,1,1,").concat(_,",").concat(h),className:"recharts-legend-icon"});if(o.type==="rect")return Ye.createElement("path",{stroke:"none",fill:a,d:"M0,".concat(hs/8,"h").concat(hs,"v").concat(hs*3/4,"h").concat(-hs,"z"),className:"recharts-legend-icon"});if(Ye.isValidElement(o.legendIcon)){var b=oge({},o);return delete b.legendIcon,Ye.cloneElement(o.legendIcon,b)}return Ye.createElement(lD,{fill:a,cx:h,cy:h,size:hs,sizeType:"diameter",type:o.type})}},{key:"renderItems",value:function(){var o=this,u=this.props,h=u.payload,p=u.iconSize,_=u.layout,a=u.formatter,b=u.inactiveColor,C={x:0,y:0,width:hs,height:hs},A={display:_==="horizontal"?"inline-block":"block",marginRight:10},O={display:"inline-block",verticalAlign:"middle",marginRight:4};return h.map(function(k,N){var z=k.formatter||a,U=Cr(P0(P0({"recharts-legend-item":!0},"legend-item-".concat(N),!0),"inactive",k.inactive));if(k.type==="none")return null;var j=hr(k.value)?null:k.value;Nu(!hr(k.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var G=k.inactive?b:k.color;return Ye.createElement("li",HO({className:U,style:A,key:"legend-item-".concat(N)},NS(o.props,k,N)),Ye.createElement(FO,{width:p,height:p,viewBox:C,style:O},o.renderIcon(k)),Ye.createElement("span",{className:"recharts-legend-item-text",style:{color:G}},z?z(j,k,N):j))})}},{key:"render",value:function(){var o=this.props,u=o.payload,h=o.layout,p=o.align;if(!u||!u.length)return null;var _={padding:0,margin:0,textAlign:h==="horizontal"?p:"left"};return Ye.createElement("ul",{className:"recharts-default-legend",style:_},this.renderItems())}}])}(W.PureComponent);P0(uD,"displayName","Legend");P0(uD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var pge=AE;function mge(){this.__data__=new pge,this.size=0}var gge=mge;function yge(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var _ge=yge;function vge(e){return this.__data__.get(e)}var xge=vge;function bge(e){return this.__data__.has(e)}var wge=bge,Sge=AE,Tge=Yk,Ege=Kk,Age=200;function Cge(e,t){var n=this.__data__;if(n instanceof Sge){var o=n.__data__;if(!Tge||o.length<Age-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ege(o)}return n.set(e,t),this.size=n.size,this}var Pge=Cge,Mge=AE,Ige=gge,Oge=_ge,Rge=xge,kge=wge,Dge=Pge;function ty(e){var t=this.__data__=new Mge(e);this.size=t.size}ty.prototype.clear=Ige;ty.prototype.delete=Oge;ty.prototype.get=Rge;ty.prototype.has=kge;ty.prototype.set=Dge;var h9=ty,Lge="__lodash_hash_undefined__";function zge(e){return this.__data__.set(e,Lge),this}var Fge=zge;function Nge(e){return this.__data__.has(e)}var Bge=Nge,jge=Kk,$ge=Fge,Uge=Bge;function WS(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new jge;++t<n;)this.add(e[t])}WS.prototype.add=WS.prototype.push=$ge;WS.prototype.has=Uge;var f9=WS;function Vge(e,t){for(var n=-1,o=e==null?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}var d9=Vge;function Gge(e,t){return e.has(t)}var p9=Gge,Wge=f9,Hge=d9,qge=p9,Zge=1,Xge=2;function Yge(e,t,n,o,u,h){var p=n&Zge,_=e.length,a=t.length;if(_!=a&&!(p&&a>_))return!1;var b=h.get(e),C=h.get(t);if(b&&C)return b==t&&C==e;var A=-1,O=!0,k=n&Xge?new Wge:void 0;for(h.set(e,t),h.set(t,e);++A<_;){var N=e[A],z=t[A];if(o)var U=p?o(z,N,A,t,e,h):o(N,z,A,e,t,h);if(U!==void 0){if(U)continue;O=!1;break}if(k){if(!Hge(t,function(j,G){if(!qge(k,G)&&(N===j||u(N,j,n,o,h)))return k.push(G)})){O=!1;break}}else if(!(N===z||u(N,z,n,o,h))){O=!1;break}}return h.delete(e),h.delete(t),O}var m9=Yge,Kge=ql,Qge=Kge.Uint8Array,Jge=Qge;function eye(e){var t=-1,n=Array(e.size);return e.forEach(function(o,u){n[++t]=[u,o]}),n}var tye=eye;function nye(e){var t=-1,n=Array(e.size);return e.forEach(function(o){n[++t]=o}),n}var cD=nye,Dj=Mx,Lj=Jge,rye=Xk,iye=m9,oye=tye,aye=cD,sye=1,lye=2,uye="[object Boolean]",cye="[object Date]",hye="[object Error]",fye="[object Map]",dye="[object Number]",pye="[object RegExp]",mye="[object Set]",gye="[object String]",yye="[object Symbol]",_ye="[object ArrayBuffer]",vye="[object DataView]",zj=Dj?Dj.prototype:void 0,IM=zj?zj.valueOf:void 0;function xye(e,t,n,o,u,h,p){switch(n){case vye:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _ye:return!(e.byteLength!=t.byteLength||!h(new Lj(e),new Lj(t)));case uye:case cye:case dye:return rye(+e,+t);case hye:return e.name==t.name&&e.message==t.message;case pye:case gye:return e==t+"";case fye:var _=oye;case mye:var a=o&sye;if(_||(_=aye),e.size!=t.size&&!a)return!1;var b=p.get(e);if(b)return b==t;o|=lye,p.set(e,t);var C=iye(_(e),_(t),o,u,h,p);return p.delete(e),C;case yye:if(IM)return IM.call(e)==IM.call(t)}return!1}var bye=xye;function wye(e,t){for(var n=-1,o=t.length,u=e.length;++n<o;)e[u+n]=t[n];return e}var g9=wye,Sye=g9,Tye=ba;function Eye(e,t,n){var o=t(e);return Tye(e)?o:Sye(o,n(e))}var Aye=Eye;function Cye(e,t){for(var n=-1,o=e==null?0:e.length,u=0,h=[];++n<o;){var p=e[n];t(p,n,e)&&(h[u++]=p)}return h}var Pye=Cye;function Mye(){return[]}var Iye=Mye,Oye=Pye,Rye=Iye,kye=Object.prototype,Dye=kye.propertyIsEnumerable,Fj=Object.getOwnPropertySymbols,Lye=Fj?function(e){return e==null?[]:(e=Object(e),Oye(Fj(e),function(t){return Dye.call(e,t)}))}:Rye,zye=Lye;function Fye(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}var Nye=Fye,Bye=rc,jye=ic,$ye="[object Arguments]";function Uye(e){return jye(e)&&Bye(e)==$ye}var Vye=Uye,Nj=Vye,Gye=ic,y9=Object.prototype,Wye=y9.hasOwnProperty,Hye=y9.propertyIsEnumerable,qye=Nj(function(){return arguments}())?Nj:function(e){return Gye(e)&&Wye.call(e,"callee")&&!Hye.call(e,"callee")},hD=qye,HS={exports:{}};function Zye(){return!1}var Xye=Zye;HS.exports;(function(e,t){var n=ql,o=Xye,u=t&&!t.nodeType&&t,h=u&&!0&&e&&!e.nodeType&&e,p=h&&h.exports===u,_=p?n.Buffer:void 0,a=_?_.isBuffer:void 0,b=a||o;e.exports=b})(HS,HS.exports);var _9=HS.exports,Yye=9007199254740991,Kye=/^(?:0|[1-9]\d*)$/;function Qye(e,t){var n=typeof e;return t=t??Yye,!!t&&(n=="number"||n!="symbol"&&Kye.test(e))&&e>-1&&e%1==0&&e<t}var fD=Qye,Jye=9007199254740991;function e_e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Jye}var dD=e_e,t_e=rc,n_e=dD,r_e=ic,i_e="[object Arguments]",o_e="[object Array]",a_e="[object Boolean]",s_e="[object Date]",l_e="[object Error]",u_e="[object Function]",c_e="[object Map]",h_e="[object Number]",f_e="[object Object]",d_e="[object RegExp]",p_e="[object Set]",m_e="[object String]",g_e="[object WeakMap]",y_e="[object ArrayBuffer]",__e="[object DataView]",v_e="[object Float32Array]",x_e="[object Float64Array]",b_e="[object Int8Array]",w_e="[object Int16Array]",S_e="[object Int32Array]",T_e="[object Uint8Array]",E_e="[object Uint8ClampedArray]",A_e="[object Uint16Array]",C_e="[object Uint32Array]",li={};li[v_e]=li[x_e]=li[b_e]=li[w_e]=li[S_e]=li[T_e]=li[E_e]=li[A_e]=li[C_e]=!0;li[i_e]=li[o_e]=li[y_e]=li[a_e]=li[__e]=li[s_e]=li[l_e]=li[u_e]=li[c_e]=li[h_e]=li[f_e]=li[d_e]=li[p_e]=li[m_e]=li[g_e]=!1;function P_e(e){return r_e(e)&&n_e(e.length)&&!!li[t_e(e)]}var M_e=P_e;function I_e(e){return function(t){return e(t)}}var v9=I_e,qS={exports:{}};qS.exports;(function(e,t){var n=AH,o=t&&!t.nodeType&&t,u=o&&!0&&e&&!e.nodeType&&e,h=u&&u.exports===o,p=h&&n.process,_=function(){try{var a=u&&u.require&&u.require("util").types;return a||p&&p.binding&&p.binding("util")}catch{}}();e.exports=_})(qS,qS.exports);var O_e=qS.exports,R_e=M_e,k_e=v9,Bj=O_e,jj=Bj&&Bj.isTypedArray,D_e=jj?k_e(jj):R_e,x9=D_e,L_e=Nye,z_e=hD,F_e=ba,N_e=_9,B_e=fD,j_e=x9,$_e=Object.prototype,U_e=$_e.hasOwnProperty;function V_e(e,t){var n=F_e(e),o=!n&&z_e(e),u=!n&&!o&&N_e(e),h=!n&&!o&&!u&&j_e(e),p=n||o||u||h,_=p?L_e(e.length,String):[],a=_.length;for(var b in e)(t||U_e.call(e,b))&&!(p&&(b=="length"||u&&(b=="offset"||b=="parent")||h&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||B_e(b,a)))&&_.push(b);return _}var G_e=V_e,W_e=Object.prototype;function H_e(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||W_e;return e===n}var q_e=H_e;function Z_e(e,t){return function(n){return e(t(n))}}var b9=Z_e,X_e=b9,Y_e=X_e(Object.keys,Object),K_e=Y_e,Q_e=q_e,J_e=K_e,eve=Object.prototype,tve=eve.hasOwnProperty;function nve(e){if(!Q_e(e))return J_e(e);var t=[];for(var n in Object(e))tve.call(e,n)&&n!="constructor"&&t.push(n);return t}var rve=nve,ive=Zk,ove=dD;function ave(e){return e!=null&&ove(e.length)&&!ive(e)}var Rx=ave,sve=G_e,lve=rve,uve=Rx;function cve(e){return uve(e)?sve(e):lve(e)}var VE=cve,hve=Aye,fve=zye,dve=VE;function pve(e){return hve(e,dve,fve)}var mve=pve,$j=mve,gve=1,yve=Object.prototype,_ve=yve.hasOwnProperty;function vve(e,t,n,o,u,h){var p=n&gve,_=$j(e),a=_.length,b=$j(t),C=b.length;if(a!=C&&!p)return!1;for(var A=a;A--;){var O=_[A];if(!(p?O in t:_ve.call(t,O)))return!1}var k=h.get(e),N=h.get(t);if(k&&N)return k==t&&N==e;var z=!0;h.set(e,t),h.set(t,e);for(var U=p;++A<a;){O=_[A];var j=e[O],G=t[O];if(o)var H=p?o(G,j,O,t,e,h):o(j,G,O,e,t,h);if(!(H===void 0?j===G||u(j,G,n,o,h):H)){z=!1;break}U||(U=O=="constructor")}if(z&&!U){var Y=e.constructor,K=t.constructor;Y!=K&&"constructor"in e&&"constructor"in t&&!(typeof Y=="function"&&Y instanceof Y&&typeof K=="function"&&K instanceof K)&&(z=!1)}return h.delete(e),h.delete(t),z}var xve=vve,bve=Yd,wve=ql,Sve=bve(wve,"DataView"),Tve=Sve,Eve=Yd,Ave=ql,Cve=Eve(Ave,"Promise"),Pve=Cve,Mve=Yd,Ive=ql,Ove=Mve(Ive,"Set"),w9=Ove,Rve=Yd,kve=ql,Dve=Rve(kve,"WeakMap"),Lve=Dve,ZO=Tve,XO=Yk,YO=Pve,KO=w9,QO=Lve,S9=rc,ny=PH,Uj="[object Map]",zve="[object Object]",Vj="[object Promise]",Gj="[object Set]",Wj="[object WeakMap]",Hj="[object DataView]",Fve=ny(ZO),Nve=ny(XO),Bve=ny(YO),jve=ny(KO),$ve=ny(QO),hd=S9;(ZO&&hd(new ZO(new ArrayBuffer(1)))!=Hj||XO&&hd(new XO)!=Uj||YO&&hd(YO.resolve())!=Vj||KO&&hd(new KO)!=Gj||QO&&hd(new QO)!=Wj)&&(hd=function(e){var t=S9(e),n=t==zve?e.constructor:void 0,o=n?ny(n):"";if(o)switch(o){case Fve:return Hj;case Nve:return Uj;case Bve:return Vj;case jve:return Gj;case $ve:return Wj}return t});var Uve=hd,OM=h9,Vve=m9,Gve=bye,Wve=xve,qj=Uve,Zj=ba,Xj=_9,Hve=x9,qve=1,Yj="[object Arguments]",Kj="[object Array]",Sw="[object Object]",Zve=Object.prototype,Qj=Zve.hasOwnProperty;function Xve(e,t,n,o,u,h){var p=Zj(e),_=Zj(t),a=p?Kj:qj(e),b=_?Kj:qj(t);a=a==Yj?Sw:a,b=b==Yj?Sw:b;var C=a==Sw,A=b==Sw,O=a==b;if(O&&Xj(e)){if(!Xj(t))return!1;p=!0,C=!1}if(O&&!C)return h||(h=new OM),p||Hve(e)?Vve(e,t,n,o,u,h):Gve(e,t,a,n,o,u,h);if(!(n&qve)){var k=C&&Qj.call(e,"__wrapped__"),N=A&&Qj.call(t,"__wrapped__");if(k||N){var z=k?e.value():e,U=N?t.value():t;return h||(h=new OM),u(z,U,n,o,h)}}return O?(h||(h=new OM),Wve(e,t,n,o,u,h)):!1}var Yve=Xve,Kve=Yve,Jj=ic;function T9(e,t,n,o,u){return e===t?!0:e==null||t==null||!Jj(e)&&!Jj(t)?e!==e&&t!==t:Kve(e,t,n,o,T9,u)}var pD=T9,Qve=h9,Jve=pD,e0e=1,t0e=2;function n0e(e,t,n,o){var u=n.length,h=u,p=!o;if(e==null)return!h;for(e=Object(e);u--;){var _=n[u];if(p&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++u<h;){_=n[u];var a=_[0],b=e[a],C=_[1];if(p&&_[2]){if(b===void 0&&!(a in e))return!1}else{var A=new Qve;if(o)var O=o(b,C,a,e,t,A);if(!(O===void 0?Jve(C,b,e0e|t0e,o,A):O))return!1}}return!0}var r0e=n0e,i0e=Xh;function o0e(e){return e===e&&!i0e(e)}var E9=o0e,a0e=E9,s0e=VE;function l0e(e){for(var t=s0e(e),n=t.length;n--;){var o=t[n],u=e[o];t[n]=[o,u,a0e(u)]}return t}var u0e=l0e;function c0e(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var A9=c0e,h0e=r0e,f0e=u0e,d0e=A9;function p0e(e){var t=f0e(e);return t.length==1&&t[0][2]?d0e(t[0][0],t[0][1]):function(n){return n===e||h0e(n,e,t)}}var m0e=p0e;function g0e(e,t){return e!=null&&t in Object(e)}var y0e=g0e,_0e=kH,v0e=hD,x0e=ba,b0e=fD,w0e=dD,S0e=PE;function T0e(e,t,n){t=_0e(t,e);for(var o=-1,u=t.length,h=!1;++o<u;){var p=S0e(t[o]);if(!(h=e!=null&&n(e,p)))break;e=e[p]}return h||++o!=u?h:(u=e==null?0:e.length,!!u&&w0e(u)&&b0e(p,u)&&(x0e(e)||v0e(e)))}var E0e=T0e,A0e=y0e,C0e=E0e;function P0e(e,t){return e!=null&&C0e(e,t,A0e)}var M0e=P0e,I0e=pD,O0e=DH,R0e=M0e,k0e=qk,D0e=E9,L0e=A9,z0e=PE,F0e=1,N0e=2;function B0e(e,t){return k0e(e)&&D0e(t)?L0e(z0e(e),t):function(n){var o=O0e(n,e);return o===void 0&&o===t?R0e(n,e):I0e(t,o,F0e|N0e)}}var j0e=B0e;function $0e(e){return e}var ry=$0e;function U0e(e){return function(t){return t==null?void 0:t[e]}}var V0e=U0e,G0e=eD;function W0e(e){return function(t){return G0e(t,e)}}var H0e=W0e,q0e=V0e,Z0e=H0e,X0e=qk,Y0e=PE;function K0e(e){return X0e(e)?q0e(Y0e(e)):Z0e(e)}var Q0e=K0e,J0e=m0e,exe=j0e,txe=ry,nxe=ba,rxe=Q0e;function ixe(e){return typeof e=="function"?e:e==null?txe:typeof e=="object"?nxe(e)?exe(e[0],e[1]):J0e(e):rxe(e)}var Yh=ixe;function oxe(e,t,n,o){for(var u=e.length,h=n+(o?1:-1);o?h--:++h<u;)if(t(e[h],h,e))return h;return-1}var C9=oxe;function axe(e){return e!==e}var sxe=axe;function lxe(e,t,n){for(var o=n-1,u=e.length;++o<u;)if(e[o]===t)return o;return-1}var uxe=lxe,cxe=C9,hxe=sxe,fxe=uxe;function dxe(e,t,n){return t===t?fxe(e,t,n):cxe(e,hxe,n)}var pxe=dxe,mxe=pxe;function gxe(e,t){var n=e==null?0:e.length;return!!n&&mxe(e,t,0)>-1}var yxe=gxe;function _xe(e,t,n){for(var o=-1,u=e==null?0:e.length;++o<u;)if(n(t,e[o]))return!0;return!1}var vxe=_xe;function xxe(){}var bxe=xxe,RM=w9,wxe=bxe,Sxe=cD,Txe=1/0,Exe=RM&&1/Sxe(new RM([,-0]))[1]==Txe?function(e){return new RM(e)}:wxe,Axe=Exe,Cxe=f9,Pxe=yxe,Mxe=vxe,Ixe=p9,Oxe=Axe,Rxe=cD,kxe=200;function Dxe(e,t,n){var o=-1,u=Pxe,h=e.length,p=!0,_=[],a=_;if(n)p=!1,u=Mxe;else if(h>=kxe){var b=t?null:Oxe(e);if(b)return Rxe(b);p=!1,u=Ixe,a=new Cxe}else a=t?[]:_;e:for(;++o<h;){var C=e[o],A=t?t(C):C;if(C=n||C!==0?C:0,p&&A===A){for(var O=a.length;O--;)if(a[O]===A)continue e;t&&a.push(A),_.push(C)}else u(a,A,n)||(a!==_&&a.push(A),_.push(C))}return _}var Lxe=Dxe,zxe=Yh,Fxe=Lxe;function Nxe(e,t){return e&&e.length?Fxe(e,zxe(t)):[]}var Bxe=Nxe;const e5=Vr(Bxe);function P9(e,t,n){return t===!0?e5(e,n):hr(t)?e5(e,t):e}function vg(e){"@babel/helpers - typeof";return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}var jxe=["ref"];function t5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Eu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?t5(Object(n),!0).forEach(function(o){GE(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t5(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function $xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n5(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,I9(o.key),o)}}function Uxe(e,t,n){return t&&n5(e.prototype,t),n&&n5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vxe(e,t,n){return t=ZS(t),Gxe(e,M9()?Reflect.construct(t,n||[],ZS(e).constructor):t.apply(e,n))}function Gxe(e,t){if(t&&(vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wxe(e)}function Wxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(M9=function(){return!!e})()}function ZS(e){return ZS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ZS(e)}function Hxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},JO(e,t)}function GE(e,t,n){return t=I9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I9(e){var t=qxe(e,"string");return vg(t)=="symbol"?t:t+""}function qxe(e,t){if(vg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(vg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zxe(e,t){if(e==null)return{};var n=Xxe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function Xxe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function Yxe(e){return e.value}function Kxe(e,t){if(Ye.isValidElement(e))return Ye.cloneElement(e,t);if(typeof e=="function")return Ye.createElement(e,t);t.ref;var n=Zxe(t,jxe);return Ye.createElement(uD,n)}var r5=1,tg=function(e){function t(){var n;$xe(this,t);for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];return n=Vxe(this,t,[].concat(u)),GE(n,"lastBoundingBox",{width:-1,height:-1}),n}return Hxe(t,e),Uxe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();return o.height=this.wrapperNode.offsetHeight,o.width=this.wrapperNode.offsetWidth,o}return null}},{key:"updateBBox",value:function(){var o=this.props.onBBoxUpdate,u=this.getBBox();u?(Math.abs(u.width-this.lastBoundingBox.width)>r5||Math.abs(u.height-this.lastBoundingBox.height)>r5)&&(this.lastBoundingBox.width=u.width,this.lastBoundingBox.height=u.height,o&&o(u)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,o&&o(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Eu({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(o){var u=this.props,h=u.layout,p=u.align,_=u.verticalAlign,a=u.margin,b=u.chartWidth,C=u.chartHeight,A,O;if(!o||(o.left===void 0||o.left===null)&&(o.right===void 0||o.right===null))if(p==="center"&&h==="vertical"){var k=this.getBBoxSnapshot();A={left:((b||0)-k.width)/2}}else A=p==="right"?{right:a&&a.right||0}:{left:a&&a.left||0};if(!o||(o.top===void 0||o.top===null)&&(o.bottom===void 0||o.bottom===null))if(_==="middle"){var N=this.getBBoxSnapshot();O={top:((C||0)-N.height)/2}}else O=_==="bottom"?{bottom:a&&a.bottom||0}:{top:a&&a.top||0};return Eu(Eu({},A),O)}},{key:"render",value:function(){var o=this,u=this.props,h=u.content,p=u.width,_=u.height,a=u.wrapperStyle,b=u.payloadUniqBy,C=u.payload,A=Eu(Eu({position:"absolute",width:p||"auto",height:_||"auto"},this.getDefaultPosition(a)),a);return Ye.createElement("div",{className:"recharts-legend-wrapper",style:A,ref:function(k){o.wrapperNode=k}},Kxe(h,Eu(Eu({},this.props),{},{payload:P9(C,b,Yxe)})))}}],[{key:"getWithHeight",value:function(o,u){var h=Eu(Eu({},this.defaultProps),o.props),p=h.layout;return p==="vertical"&&Qt(o.props.height)?{height:o.props.height}:p==="horizontal"?{width:o.props.width||u}:null}}])}(W.PureComponent);GE(tg,"displayName","Legend");GE(tg,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var i5=Mx,Qxe=hD,Jxe=ba,o5=i5?i5.isConcatSpreadable:void 0;function e1e(e){return Jxe(e)||Qxe(e)||!!(o5&&e&&e[o5])}var t1e=e1e,n1e=g9,r1e=t1e;function O9(e,t,n,o,u){var h=-1,p=e.length;for(n||(n=r1e),u||(u=[]);++h<p;){var _=e[h];t>0&&n(_)?t>1?O9(_,t-1,n,o,u):n1e(u,_):o||(u[u.length]=_)}return u}var R9=O9;function i1e(e){return function(t,n,o){for(var u=-1,h=Object(t),p=o(t),_=p.length;_--;){var a=p[e?_:++u];if(n(h[a],a,h)===!1)break}return t}}var o1e=i1e,a1e=o1e,s1e=a1e(),l1e=s1e,u1e=l1e,c1e=VE;function h1e(e,t){return e&&u1e(e,t,c1e)}var k9=h1e,f1e=Rx;function d1e(e,t){return function(n,o){if(n==null)return n;if(!f1e(n))return e(n,o);for(var u=n.length,h=t?u:-1,p=Object(n);(t?h--:++h<u)&&o(p[h],h,p)!==!1;);return n}}var p1e=d1e,m1e=k9,g1e=p1e,y1e=g1e(m1e),mD=y1e,_1e=mD,v1e=Rx;function x1e(e,t){var n=-1,o=v1e(e)?Array(e.length):[];return _1e(e,function(u,h,p){o[++n]=t(u,h,p)}),o}var D9=x1e;function b1e(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var w1e=b1e,a5=Xg;function S1e(e,t){if(e!==t){var n=e!==void 0,o=e===null,u=e===e,h=a5(e),p=t!==void 0,_=t===null,a=t===t,b=a5(t);if(!_&&!b&&!h&&e>t||h&&p&&a&&!_&&!b||o&&p&&a||!n&&a||!u)return 1;if(!o&&!h&&!b&&e<t||b&&n&&u&&!o&&!h||_&&n&&u||!p&&u||!a)return-1}return 0}var T1e=S1e,E1e=T1e;function A1e(e,t,n){for(var o=-1,u=e.criteria,h=t.criteria,p=u.length,_=n.length;++o<p;){var a=E1e(u[o],h[o]);if(a){if(o>=_)return a;var b=n[o];return a*(b=="desc"?-1:1)}}return e.index-t.index}var C1e=A1e,kM=Jk,P1e=eD,M1e=Yh,I1e=D9,O1e=w1e,R1e=v9,k1e=C1e,D1e=ry,L1e=ba;function z1e(e,t,n){t.length?t=kM(t,function(h){return L1e(h)?function(p){return P1e(p,h.length===1?h[0]:h)}:h}):t=[D1e];var o=-1;t=kM(t,R1e(M1e));var u=I1e(e,function(h,p,_){var a=kM(t,function(b){return b(h)});return{criteria:a,index:++o,value:h}});return O1e(u,function(h,p){return k1e(h,p,n)})}var F1e=z1e;function N1e(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var B1e=N1e,j1e=B1e,s5=Math.max;function $1e(e,t,n){return t=s5(t===void 0?e.length-1:t,0),function(){for(var o=arguments,u=-1,h=s5(o.length-t,0),p=Array(h);++u<h;)p[u]=o[t+u];u=-1;for(var _=Array(t+1);++u<t;)_[u]=o[u];return _[t]=n(p),j1e(e,this,_)}}var U1e=$1e;function V1e(e){return function(){return e}}var G1e=V1e,W1e=Yd,H1e=function(){try{var e=W1e(Object,"defineProperty");return e({},"",{}),e}catch{}}(),L9=H1e,q1e=G1e,l5=L9,Z1e=ry,X1e=l5?function(e,t){return l5(e,"toString",{configurable:!0,enumerable:!1,value:q1e(t),writable:!0})}:Z1e,Y1e=X1e,K1e=800,Q1e=16,J1e=Date.now;function ebe(e){var t=0,n=0;return function(){var o=J1e(),u=Q1e-(o-n);if(n=o,u>0){if(++t>=K1e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var tbe=ebe,nbe=Y1e,rbe=tbe,ibe=rbe(nbe),obe=ibe,abe=ry,sbe=U1e,lbe=obe;function ube(e,t){return lbe(sbe(e,t,abe),e+"")}var cbe=ube,hbe=Xk,fbe=Rx,dbe=fD,pbe=Xh;function mbe(e,t,n){if(!pbe(n))return!1;var o=typeof t;return(o=="number"?fbe(n)&&dbe(t,n.length):o=="string"&&t in n)?hbe(n[t],e):!1}var WE=mbe,gbe=R9,ybe=F1e,_be=cbe,u5=WE,vbe=_be(function(e,t){if(e==null)return[];var n=t.length;return n>1&&u5(e,t[0],t[1])?t=[]:n>2&&u5(t[0],t[1],t[2])&&(t=[t[0]]),ybe(e,gbe(t,1),[])}),xbe=vbe;const gD=Vr(xbe);function M0(e){"@babel/helpers - typeof";return M0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M0(e)}function e3(){return e3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e3.apply(this,arguments)}function bbe(e,t){return Ebe(e)||Tbe(e,t)||Sbe(e,t)||wbe()}function wbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sbe(e,t){if(e){if(typeof e=="string")return c5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c5(e,t)}}function c5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Tbe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function Ebe(e){if(Array.isArray(e))return e}function h5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function DM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h5(Object(n),!0).forEach(function(o){Abe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h5(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Abe(e,t,n){return t=Cbe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cbe(e){var t=Pbe(e,"string");return M0(t)=="symbol"?t:t+""}function Pbe(e,t){if(M0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(M0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mbe(e){return Array.isArray(e)&&to(e[0])&&to(e[1])?e.join(" ~ "):e}var Ibe=function(t){var n=t.separator,o=n===void 0?" : ":n,u=t.contentStyle,h=u===void 0?{}:u,p=t.itemStyle,_=p===void 0?{}:p,a=t.labelStyle,b=a===void 0?{}:a,C=t.payload,A=t.formatter,O=t.itemSorter,k=t.wrapperClassName,N=t.labelClassName,z=t.label,U=t.labelFormatter,j=t.accessibilityLayer,G=j===void 0?!1:j,H=function(){if(C&&C.length){var Le={padding:0,margin:0},Ue=(O?gD(C,O):C).map(function(et,rt){if(et.type==="none")return null;var st=DM({display:"block",paddingTop:4,paddingBottom:4,color:et.color||"#000"},_),Ke=et.formatter||A||Mbe,Ze=et.value,Xe=et.name,de=Ze,lt=Xe;if(Ke&&de!=null&&lt!=null){var gt=Ke(Ze,Xe,et,rt,C);if(Array.isArray(gt)){var Se=bbe(gt,2);de=Se[0],lt=Se[1]}else de=gt}return Ye.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(rt),style:st},to(lt)?Ye.createElement("span",{className:"recharts-tooltip-item-name"},lt):null,to(lt)?Ye.createElement("span",{className:"recharts-tooltip-item-separator"},o):null,Ye.createElement("span",{className:"recharts-tooltip-item-value"},de),Ye.createElement("span",{className:"recharts-tooltip-item-unit"},et.unit||""))});return Ye.createElement("ul",{className:"recharts-tooltip-item-list",style:Le},Ue)}return null},Y=DM({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},h),K=DM({margin:0},b),ee=!Tr(z),ue=ee?z:"",ve=Cr("recharts-default-tooltip",k),Fe=Cr("recharts-tooltip-label",N);ee&&U&&C!==void 0&&C!==null&&(ue=U(z,C));var Ne=G?{role:"status","aria-live":"assertive"}:{};return Ye.createElement("div",e3({className:ve,style:Y},Ne),Ye.createElement("p",{className:Fe,style:K},Ye.isValidElement(ue)?ue:"".concat(ue)),H())};function I0(e){"@babel/helpers - typeof";return I0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I0(e)}function Tw(e,t,n){return t=Obe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Obe(e){var t=Rbe(e,"string");return I0(t)=="symbol"?t:t+""}function Rbe(e,t){if(I0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(I0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vv="recharts-tooltip-wrapper",kbe={visibility:"hidden"};function Dbe(e){var t=e.coordinate,n=e.translateX,o=e.translateY;return Cr(vv,Tw(Tw(Tw(Tw({},"".concat(vv,"-right"),Qt(n)&&t&&Qt(t.x)&&n>=t.x),"".concat(vv,"-left"),Qt(n)&&t&&Qt(t.x)&&n<t.x),"".concat(vv,"-bottom"),Qt(o)&&t&&Qt(t.y)&&o>=t.y),"".concat(vv,"-top"),Qt(o)&&t&&Qt(t.y)&&o<t.y))}function f5(e){var t=e.allowEscapeViewBox,n=e.coordinate,o=e.key,u=e.offsetTopLeft,h=e.position,p=e.reverseDirection,_=e.tooltipDimension,a=e.viewBox,b=e.viewBoxDimension;if(h&&Qt(h[o]))return h[o];var C=n[o]-_-u,A=n[o]+u;if(t[o])return p[o]?C:A;if(p[o]){var O=C,k=a[o];return O<k?Math.max(A,a[o]):Math.max(C,a[o])}var N=A+_,z=a[o]+b;return N>z?Math.max(C,a[o]):Math.max(A,a[o])}function Lbe(e){var t=e.translateX,n=e.translateY,o=e.useTranslate3d;return{transform:o?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function zbe(e){var t=e.allowEscapeViewBox,n=e.coordinate,o=e.offsetTopLeft,u=e.position,h=e.reverseDirection,p=e.tooltipBox,_=e.useTranslate3d,a=e.viewBox,b,C,A;return p.height>0&&p.width>0&&n?(C=f5({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:o,position:u,reverseDirection:h,tooltipDimension:p.width,viewBox:a,viewBoxDimension:a.width}),A=f5({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:o,position:u,reverseDirection:h,tooltipDimension:p.height,viewBox:a,viewBoxDimension:a.height}),b=Lbe({translateX:C,translateY:A,useTranslate3d:_})):b=kbe,{cssProperties:b,cssClasses:Dbe({translateX:C,translateY:A,coordinate:n})}}function xg(e){"@babel/helpers - typeof";return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(e)}function d5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function p5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?d5(Object(n),!0).forEach(function(o){n3(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d5(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Fbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nbe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,F9(o.key),o)}}function Bbe(e,t,n){return t&&Nbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jbe(e,t,n){return t=XS(t),$be(e,z9()?Reflect.construct(t,n||[],XS(e).constructor):t.apply(e,n))}function $be(e,t){if(t&&(xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ube(e)}function Ube(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(z9=function(){return!!e})()}function XS(e){return XS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XS(e)}function Vbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t3(e,t)}function t3(e,t){return t3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},t3(e,t)}function n3(e,t,n){return t=F9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F9(e){var t=Gbe(e,"string");return xg(t)=="symbol"?t:t+""}function Gbe(e,t){if(xg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(xg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m5=1,Wbe=function(e){function t(){var n;Fbe(this,t);for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];return n=jbe(this,t,[].concat(u)),n3(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),n3(n,"handleKeyDown",function(p){if(p.key==="Escape"){var _,a,b,C;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(_=(a=n.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&_!==void 0?_:0,y:(b=(C=n.props.coordinate)===null||C===void 0?void 0:C.y)!==null&&b!==void 0?b:0}})}}),n}return Vbe(t,e),Bbe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var o=this.wrapperNode.getBoundingClientRect();(Math.abs(o.width-this.state.lastBoundingBox.width)>m5||Math.abs(o.height-this.state.lastBoundingBox.height)>m5)&&this.setState({lastBoundingBox:{width:o.width,height:o.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var o,u;this.props.active&&this.updateBBox(),this.state.dismissed&&(((o=this.props.coordinate)===null||o===void 0?void 0:o.x)!==this.state.dismissedAtCoordinate.x||((u=this.props.coordinate)===null||u===void 0?void 0:u.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var o=this,u=this.props,h=u.active,p=u.allowEscapeViewBox,_=u.animationDuration,a=u.animationEasing,b=u.children,C=u.coordinate,A=u.hasPayload,O=u.isAnimationActive,k=u.offset,N=u.position,z=u.reverseDirection,U=u.useTranslate3d,j=u.viewBox,G=u.wrapperStyle,H=zbe({allowEscapeViewBox:p,coordinate:C,offsetTopLeft:k,position:N,reverseDirection:z,tooltipBox:this.state.lastBoundingBox,useTranslate3d:U,viewBox:j}),Y=H.cssClasses,K=H.cssProperties,ee=p5(p5({transition:O&&h?"transform ".concat(_,"ms ").concat(a):void 0},K),{},{pointerEvents:"none",visibility:!this.state.dismissed&&h&&A?"visible":"hidden",position:"absolute",top:0,left:0},G);return Ye.createElement("div",{tabIndex:-1,className:Y,style:ee,ref:function(ve){o.wrapperNode=ve}},b)}}])}(W.PureComponent),Hbe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Bu={isSsr:Hbe(),get:function(t){return Bu[t]},set:function(t,n){if(typeof t=="string")Bu[t]=n;else{var o=Object.keys(t);o&&o.length&&o.forEach(function(u){Bu[u]=t[u]})}}};function bg(e){"@babel/helpers - typeof";return bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bg(e)}function g5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function y5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?g5(Object(n),!0).forEach(function(o){yD(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g5(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function qbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zbe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,B9(o.key),o)}}function Xbe(e,t,n){return t&&Zbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ybe(e,t,n){return t=YS(t),Kbe(e,N9()?Reflect.construct(t,n||[],YS(e).constructor):t.apply(e,n))}function Kbe(e,t){if(t&&(bg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qbe(e)}function Qbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(N9=function(){return!!e})()}function YS(e){return YS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},YS(e)}function Jbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r3(e,t)}function r3(e,t){return r3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},r3(e,t)}function yD(e,t,n){return t=B9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B9(e){var t=ewe(e,"string");return bg(t)=="symbol"?t:t+""}function ewe(e,t){if(bg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(bg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function twe(e){return e.dataKey}function nwe(e,t){return Ye.isValidElement(e)?Ye.cloneElement(e,t):typeof e=="function"?Ye.createElement(e,t):Ye.createElement(Ibe,t)}var Dl=function(e){function t(){return qbe(this,t),Ybe(this,t,arguments)}return Jbe(t,e),Xbe(t,[{key:"render",value:function(){var o=this,u=this.props,h=u.active,p=u.allowEscapeViewBox,_=u.animationDuration,a=u.animationEasing,b=u.content,C=u.coordinate,A=u.filterNull,O=u.isAnimationActive,k=u.offset,N=u.payload,z=u.payloadUniqBy,U=u.position,j=u.reverseDirection,G=u.useTranslate3d,H=u.viewBox,Y=u.wrapperStyle,K=N??[];A&&K.length&&(K=P9(N.filter(function(ue){return ue.value!=null&&(ue.hide!==!0||o.props.includeHidden)}),z,twe));var ee=K.length>0;return Ye.createElement(Wbe,{allowEscapeViewBox:p,animationDuration:_,animationEasing:a,isAnimationActive:O,active:h,coordinate:C,hasPayload:ee,offset:k,position:U,reverseDirection:j,useTranslate3d:G,viewBox:H,wrapperStyle:Y},nwe(b,y5(y5({},this.props),{},{payload:K})))}}])}(W.PureComponent);yD(Dl,"displayName","Tooltip");yD(Dl,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Bu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var rwe=ql,iwe=function(){return rwe.Date.now()},owe=iwe,awe=/\s/;function swe(e){for(var t=e.length;t--&&awe.test(e.charAt(t)););return t}var lwe=swe,uwe=lwe,cwe=/^\s+/;function hwe(e){return e&&e.slice(0,uwe(e)+1).replace(cwe,"")}var fwe=hwe,dwe=fwe,_5=Xh,pwe=Xg,v5=NaN,mwe=/^[-+]0x[0-9a-f]+$/i,gwe=/^0b[01]+$/i,ywe=/^0o[0-7]+$/i,_we=parseInt;function vwe(e){if(typeof e=="number")return e;if(pwe(e))return v5;if(_5(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=_5(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=dwe(e);var n=gwe.test(e);return n||ywe.test(e)?_we(e.slice(2),n?2:8):mwe.test(e)?v5:+e}var j9=vwe,xwe=Xh,LM=owe,x5=j9,bwe="Expected a function",wwe=Math.max,Swe=Math.min;function Twe(e,t,n){var o,u,h,p,_,a,b=0,C=!1,A=!1,O=!0;if(typeof e!="function")throw new TypeError(bwe);t=x5(t)||0,xwe(n)&&(C=!!n.leading,A="maxWait"in n,h=A?wwe(x5(n.maxWait)||0,t):h,O="trailing"in n?!!n.trailing:O);function k(ee){var ue=o,ve=u;return o=u=void 0,b=ee,p=e.apply(ve,ue),p}function N(ee){return b=ee,_=setTimeout(j,t),C?k(ee):p}function z(ee){var ue=ee-a,ve=ee-b,Fe=t-ue;return A?Swe(Fe,h-ve):Fe}function U(ee){var ue=ee-a,ve=ee-b;return a===void 0||ue>=t||ue<0||A&&ve>=h}function j(){var ee=LM();if(U(ee))return G(ee);_=setTimeout(j,z(ee))}function G(ee){return _=void 0,O&&o?k(ee):(o=u=void 0,p)}function H(){_!==void 0&&clearTimeout(_),b=0,o=a=u=_=void 0}function Y(){return _===void 0?p:G(LM())}function K(){var ee=LM(),ue=U(ee);if(o=arguments,u=this,a=ee,ue){if(_===void 0)return N(a);if(A)return clearTimeout(_),_=setTimeout(j,t),k(a)}return _===void 0&&(_=setTimeout(j,t)),p}return K.cancel=H,K.flush=Y,K}var Ewe=Twe,Awe=Ewe,Cwe=Xh,Pwe="Expected a function";function Mwe(e,t,n){var o=!0,u=!0;if(typeof e!="function")throw new TypeError(Pwe);return Cwe(n)&&(o="leading"in n?!!n.leading:o,u="trailing"in n?!!n.trailing:u),Awe(e,t,{leading:o,maxWait:t,trailing:u})}var Iwe=Mwe;const $9=Vr(Iwe);function O0(e){"@babel/helpers - typeof";return O0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O0(e)}function b5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Ew(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?b5(Object(n),!0).forEach(function(o){Owe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b5(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Owe(e,t,n){return t=Rwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rwe(e){var t=kwe(e,"string");return O0(t)=="symbol"?t:t+""}function kwe(e,t){if(O0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(O0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dwe(e,t){return Nwe(e)||Fwe(e,t)||zwe(e,t)||Lwe()}function Lwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(e,t){if(e){if(typeof e=="string")return w5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w5(e,t)}}function w5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Fwe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function Nwe(e){if(Array.isArray(e))return e}var Bwe=W.forwardRef(function(e,t){var n=e.aspect,o=e.initialDimension,u=o===void 0?{width:-1,height:-1}:o,h=e.width,p=h===void 0?"100%":h,_=e.height,a=_===void 0?"100%":_,b=e.minWidth,C=b===void 0?0:b,A=e.minHeight,O=e.maxHeight,k=e.children,N=e.debounce,z=N===void 0?0:N,U=e.id,j=e.className,G=e.onResize,H=e.style,Y=H===void 0?{}:H,K=W.useRef(null),ee=W.useRef();ee.current=G,W.useImperativeHandle(t,function(){return Object.defineProperty(K.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),K.current},configurable:!0})});var ue=W.useState({containerWidth:u.width,containerHeight:u.height}),ve=Dwe(ue,2),Fe=ve[0],Ne=ve[1],Oe=W.useCallback(function(Ue,et){Ne(function(rt){var st=Math.round(Ue),Ke=Math.round(et);return rt.containerWidth===st&&rt.containerHeight===Ke?rt:{containerWidth:st,containerHeight:Ke}})},[]);W.useEffect(function(){var Ue=function(Xe){var de,lt=Xe[0].contentRect,gt=lt.width,Se=lt.height;Oe(gt,Se),(de=ee.current)===null||de===void 0||de.call(ee,gt,Se)};z>0&&(Ue=$9(Ue,z,{trailing:!0,leading:!1}));var et=new ResizeObserver(Ue),rt=K.current.getBoundingClientRect(),st=rt.width,Ke=rt.height;return Oe(st,Ke),et.observe(K.current),function(){et.disconnect()}},[Oe,z]);var Le=W.useMemo(function(){var Ue=Fe.containerWidth,et=Fe.containerHeight;if(Ue<0||et<0)return null;Nu(xd(p)||xd(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,p,a),Nu(!n||n>0,"The aspect(%s) must be greater than zero.",n);var rt=xd(p)?Ue:p,st=xd(a)?et:a;n&&n>0&&(rt?st=rt/n:st&&(rt=st*n),O&&st>O&&(st=O)),Nu(rt>0||st>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,rt,st,p,a,C,A,n);var Ke=!Array.isArray(k)&&Fu(k.type).endsWith("Chart");return Ye.Children.map(k,function(Ze){return FH.isElement(Ze)?W.cloneElement(Ze,Ew({width:rt,height:st},Ke?{style:Ew({height:"100%",width:"100%",maxHeight:st,maxWidth:rt},Ze.props.style)}:{})):Ze})},[n,k,a,O,A,C,Fe,p]);return Ye.createElement("div",{id:U?"".concat(U):void 0,className:Cr("recharts-responsive-container",j),style:Ew(Ew({},Y),{},{width:p,height:a,minWidth:C,minHeight:A,maxHeight:O}),ref:K},Le)}),U9=function(t){return null};U9.displayName="Cell";function R0(e){"@babel/helpers - typeof";return R0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R0(e)}function S5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function i3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S5(Object(n),!0).forEach(function(o){jwe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S5(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function jwe(e,t,n){return t=$we(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $we(e){var t=Uwe(e,"string");return R0(t)=="symbol"?t:t+""}function Uwe(e,t){if(R0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(R0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sm={widthCache:{},cacheCount:0},Vwe=2e3,Gwe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},T5="recharts_measurement_span";function Wwe(e){var t=i3({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Kv=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Bu.isSsr)return{width:0,height:0};var o=Wwe(n),u=JSON.stringify({text:t,copyStyle:o});if(Sm.widthCache[u])return Sm.widthCache[u];try{var h=document.getElementById(T5);h||(h=document.createElement("span"),h.setAttribute("id",T5),h.setAttribute("aria-hidden","true"),document.body.appendChild(h));var p=i3(i3({},Gwe),o);Object.assign(h.style,p),h.textContent="".concat(t);var _=h.getBoundingClientRect(),a={width:_.width,height:_.height};return Sm.widthCache[u]=a,++Sm.cacheCount>Vwe&&(Sm.cacheCount=0,Sm.widthCache={}),a}catch{return{width:0,height:0}}},Hwe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function k0(e){"@babel/helpers - typeof";return k0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k0(e)}function KS(e,t){return Ywe(e)||Xwe(e,t)||Zwe(e,t)||qwe()}function qwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zwe(e,t){if(e){if(typeof e=="string")return E5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E5(e,t)}}function E5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Xwe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;a=!1}else for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function Ywe(e){if(Array.isArray(e))return e}function Kwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A5(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Jwe(o.key),o)}}function Qwe(e,t,n){return t&&A5(e.prototype,t),n&&A5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jwe(e){var t=eSe(e,"string");return k0(t)=="symbol"?t:t+""}function eSe(e,t){if(k0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(k0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var C5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,P5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,tSe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,nSe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,V9={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},rSe=Object.keys(V9),Um="NaN";function iSe(e,t){return e*V9[t]}var Aw=function(){function e(t,n){Kwe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!tSe.test(n)&&(this.num=NaN,this.unit=""),rSe.includes(n)&&(this.num=iSe(t,n),this.unit="px")}return Qwe(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var o,u=(o=nSe.exec(n))!==null&&o!==void 0?o:[],h=KS(u,3),p=h[1],_=h[2];return new e(parseFloat(p),_??"")}}])}();function G9(e){if(e.includes(Um))return Um;for(var t=e;t.includes("*")||t.includes("/");){var n,o=(n=C5.exec(t))!==null&&n!==void 0?n:[],u=KS(o,4),h=u[1],p=u[2],_=u[3],a=Aw.parse(h??""),b=Aw.parse(_??""),C=p==="*"?a.multiply(b):a.divide(b);if(C.isNaN())return Um;t=t.replace(C5,C.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var A,O=(A=P5.exec(t))!==null&&A!==void 0?A:[],k=KS(O,4),N=k[1],z=k[2],U=k[3],j=Aw.parse(N??""),G=Aw.parse(U??""),H=z==="+"?j.add(G):j.subtract(G);if(H.isNaN())return Um;t=t.replace(P5,H.toString())}return t}var M5=/\(([^()]*)\)/;function oSe(e){for(var t=e;t.includes("(");){var n=M5.exec(t),o=KS(n,2),u=o[1];t=t.replace(M5,G9(u))}return t}function aSe(e){var t=e.replace(/\s+/g,"");return t=oSe(t),t=G9(t),t}function sSe(e){try{return aSe(e)}catch{return Um}}function zM(e){var t=sSe(e.slice(5,-1));return t===Um?"":t}var lSe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],uSe=["dx","dy","angle","className","breakAll"];function o3(){return o3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o3.apply(this,arguments)}function I5(e,t){if(e==null)return{};var n=cSe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function cSe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function O5(e,t){return pSe(e)||dSe(e,t)||fSe(e,t)||hSe()}function hSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fSe(e,t){if(e){if(typeof e=="string")return R5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R5(e,t)}}function R5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function dSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;a=!1}else for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function pSe(e){if(Array.isArray(e))return e}var W9=/[ \f\n\r\t\v\u2028\u2029]+/,H9=function(t){var n=t.children,o=t.breakAll,u=t.style;try{var h=[];Tr(n)||(o?h=n.toString().split(""):h=n.toString().split(W9));var p=h.map(function(a){return{word:a,width:Kv(a,u).width}}),_=o?0:Kv("",u).width;return{wordsWithComputedWidth:p,spaceWidth:_}}catch{return null}},mSe=function(t,n,o,u,h){var p=t.maxLines,_=t.children,a=t.style,b=t.breakAll,C=Qt(p),A=_,O=function(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return rt.reduce(function(st,Ke){var Ze=Ke.word,Xe=Ke.width,de=st[st.length-1];if(de&&(u==null||h||de.width+Xe+o<Number(u)))de.words.push(Ze),de.width+=Xe+o;else{var lt={words:[Ze],width:Xe};st.push(lt)}return st},[])},k=O(n),N=function(rt){return rt.reduce(function(st,Ke){return st.width>Ke.width?st:Ke})};if(!C)return k;for(var z="",U=function(rt){var st=A.slice(0,rt),Ke=H9({breakAll:b,style:a,children:st+z}).wordsWithComputedWidth,Ze=O(Ke),Xe=Ze.length>p||N(Ze).width>Number(u);return[Xe,Ze]},j=0,G=A.length-1,H=0,Y;j<=G&&H<=A.length-1;){var K=Math.floor((j+G)/2),ee=K-1,ue=U(ee),ve=O5(ue,2),Fe=ve[0],Ne=ve[1],Oe=U(K),Le=O5(Oe,1),Ue=Le[0];if(!Fe&&!Ue&&(j=K+1),Fe&&Ue&&(G=K-1),!Fe&&Ue){Y=Ne;break}H++}return Y||k},k5=function(t){var n=Tr(t)?[]:t.toString().split(W9);return[{words:n}]},gSe=function(t){var n=t.width,o=t.scaleToFit,u=t.children,h=t.style,p=t.breakAll,_=t.maxLines;if((n||o)&&!Bu.isSsr){var a,b,C=H9({breakAll:p,children:u,style:h});if(C){var A=C.wordsWithComputedWidth,O=C.spaceWidth;a=A,b=O}else return k5(u);return mSe({breakAll:p,children:u,maxLines:_,style:h},a,b,n,o)}return k5(u)},D5="#808080",QS=function(t){var n=t.x,o=n===void 0?0:n,u=t.y,h=u===void 0?0:u,p=t.lineHeight,_=p===void 0?"1em":p,a=t.capHeight,b=a===void 0?"0.71em":a,C=t.scaleToFit,A=C===void 0?!1:C,O=t.textAnchor,k=O===void 0?"start":O,N=t.verticalAnchor,z=N===void 0?"end":N,U=t.fill,j=U===void 0?D5:U,G=I5(t,lSe),H=W.useMemo(function(){return gSe({breakAll:G.breakAll,children:G.children,maxLines:G.maxLines,scaleToFit:A,style:G.style,width:G.width})},[G.breakAll,G.children,G.maxLines,A,G.style,G.width]),Y=G.dx,K=G.dy,ee=G.angle,ue=G.className,ve=G.breakAll,Fe=I5(G,uSe);if(!to(o)||!to(h))return null;var Ne=o+(Qt(Y)?Y:0),Oe=h+(Qt(K)?K:0),Le;switch(z){case"start":Le=zM("calc(".concat(b,")"));break;case"middle":Le=zM("calc(".concat((H.length-1)/2," * -").concat(_," + (").concat(b," / 2))"));break;default:Le=zM("calc(".concat(H.length-1," * -").concat(_,")"));break}var Ue=[];if(A){var et=H[0].width,rt=G.width;Ue.push("scale(".concat((Qt(rt)?rt/et:1)/et,")"))}return ee&&Ue.push("rotate(".concat(ee,", ").concat(Ne,", ").concat(Oe,")")),Ue.length&&(Fe.transform=Ue.join(" ")),Ye.createElement("text",o3({},gr(Fe,!0),{x:Ne,y:Oe,className:Cr("recharts-text",ue),textAnchor:k,fill:j.includes("url")?D5:j}),H.map(function(st,Ke){var Ze=st.words.join(ve?"":" ");return Ye.createElement("tspan",{x:Ne,dy:Ke===0?Le:_,key:Ze},Ze)}))};function Lh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ySe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _D(e){let t,n,o;e.length!==2?(t=Lh,n=(_,a)=>Lh(e(_),a),o=(_,a)=>e(_)-a):(t=e===Lh||e===ySe?e:_Se,n=e,o=e);function u(_,a,b=0,C=_.length){if(b<C){if(t(a,a)!==0)return C;do{const A=b+C>>>1;n(_[A],a)<0?b=A+1:C=A}while(b<C)}return b}function h(_,a,b=0,C=_.length){if(b<C){if(t(a,a)!==0)return C;do{const A=b+C>>>1;n(_[A],a)<=0?b=A+1:C=A}while(b<C)}return b}function p(_,a,b=0,C=_.length){const A=u(_,a,b,C-1);return A>b&&o(_[A-1],a)>-o(_[A],a)?A-1:A}return{left:u,center:p,right:h}}function _Se(){return 0}function q9(e){return e===null?NaN:+e}function*vSe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const xSe=_D(Lh),kx=xSe.right;_D(q9).center;class L5 extends Map{constructor(t,n=SSe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[o,u]of t)this.set(o,u)}get(t){return super.get(z5(this,t))}has(t){return super.has(z5(this,t))}set(t,n){return super.set(bSe(this,t),n)}delete(t){return super.delete(wSe(this,t))}}function z5({_intern:e,_key:t},n){const o=t(n);return e.has(o)?e.get(o):n}function bSe({_intern:e,_key:t},n){const o=t(n);return e.has(o)?e.get(o):(e.set(o,n),n)}function wSe({_intern:e,_key:t},n){const o=t(n);return e.has(o)&&(n=e.get(o),e.delete(o)),n}function SSe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function TSe(e=Lh){if(e===Lh)return Z9;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const o=e(t,n);return o||o===0?o:(e(n,n)===0)-(e(t,t)===0)}}function Z9(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const ESe=Math.sqrt(50),ASe=Math.sqrt(10),CSe=Math.sqrt(2);function JS(e,t,n){const o=(t-e)/Math.max(0,n),u=Math.floor(Math.log10(o)),h=o/Math.pow(10,u),p=h>=ESe?10:h>=ASe?5:h>=CSe?2:1;let _,a,b;return u<0?(b=Math.pow(10,-u)/p,_=Math.round(e*b),a=Math.round(t*b),_/b<e&&++_,a/b>t&&--a,b=-b):(b=Math.pow(10,u)*p,_=Math.round(e/b),a=Math.round(t/b),_*b<e&&++_,a*b>t&&--a),a<_&&.5<=n&&n<2?JS(e,t,n*2):[_,a,b]}function a3(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const o=t<e,[u,h,p]=o?JS(t,e,n):JS(e,t,n);if(!(h>=u))return[];const _=h-u+1,a=new Array(_);if(o)if(p<0)for(let b=0;b<_;++b)a[b]=(h-b)/-p;else for(let b=0;b<_;++b)a[b]=(h-b)*p;else if(p<0)for(let b=0;b<_;++b)a[b]=(u+b)/-p;else for(let b=0;b<_;++b)a[b]=(u+b)*p;return a}function s3(e,t,n){return t=+t,e=+e,n=+n,JS(e,t,n)[2]}function l3(e,t,n){t=+t,e=+e,n=+n;const o=t<e,u=o?s3(t,e,n):s3(e,t,n);return(o?-1:1)*(u<0?1/-u:u)}function F5(e,t){let n;for(const o of e)o!=null&&(n<o||n===void 0&&o>=o)&&(n=o);return n}function N5(e,t){let n;for(const o of e)o!=null&&(n>o||n===void 0&&o>=o)&&(n=o);return n}function X9(e,t,n=0,o=1/0,u){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),o=Math.floor(Math.min(e.length-1,o)),!(n<=t&&t<=o))return e;for(u=u===void 0?Z9:TSe(u);o>n;){if(o-n>600){const a=o-n+1,b=t-n+1,C=Math.log(a),A=.5*Math.exp(2*C/3),O=.5*Math.sqrt(C*A*(a-A)/a)*(b-a/2<0?-1:1),k=Math.max(n,Math.floor(t-b*A/a+O)),N=Math.min(o,Math.floor(t+(a-b)*A/a+O));X9(e,t,k,N,u)}const h=e[t];let p=n,_=o;for(xv(e,n,t),u(e[o],h)>0&&xv(e,n,o);p<_;){for(xv(e,p,_),++p,--_;u(e[p],h)<0;)++p;for(;u(e[_],h)>0;)--_}u(e[n],h)===0?xv(e,n,_):(++_,xv(e,_,o)),_<=t&&(n=_+1),t<=_&&(o=_-1)}return e}function xv(e,t,n){const o=e[t];e[t]=e[n],e[n]=o}function PSe(e,t,n){if(e=Float64Array.from(vSe(e)),!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return N5(e);if(t>=1)return F5(e);var o,u=(o-1)*t,h=Math.floor(u),p=F5(X9(e,h).subarray(0,h+1)),_=N5(e.subarray(h+1));return p+(_-p)*(u-h)}}function MSe(e,t,n=q9){if(!(!(o=e.length)||isNaN(t=+t))){if(t<=0||o<2)return+n(e[0],0,e);if(t>=1)return+n(e[o-1],o-1,e);var o,u=(o-1)*t,h=Math.floor(u),p=+n(e[h],h,e),_=+n(e[h+1],h+1,e);return p+(_-p)*(u-h)}}function ISe(e,t,n){e=+e,t=+t,n=(u=arguments.length)<2?(t=e,e=0,1):u<3?1:+n;for(var o=-1,u=Math.max(0,Math.ceil((t-e)/n))|0,h=new Array(u);++o<u;)h[o]=e+o*n;return h}function As(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function oc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const u3=Symbol("implicit");function vD(){var e=new L5,t=[],n=[],o=u3;function u(h){let p=e.get(h);if(p===void 0){if(o!==u3)return o;e.set(h,p=t.push(h)-1)}return n[p%n.length]}return u.domain=function(h){if(!arguments.length)return t.slice();t=[],e=new L5;for(const p of h)e.has(p)||e.set(p,t.push(p)-1);return u},u.range=function(h){return arguments.length?(n=Array.from(h),u):n.slice()},u.unknown=function(h){return arguments.length?(o=h,u):o},u.copy=function(){return vD(t,n).unknown(o)},As.apply(u,arguments),u}function D0(){var e=vD().unknown(void 0),t=e.domain,n=e.range,o=0,u=1,h,p,_=!1,a=0,b=0,C=.5;delete e.unknown;function A(){var O=t().length,k=u<o,N=k?u:o,z=k?o:u;h=(z-N)/Math.max(1,O-a+b*2),_&&(h=Math.floor(h)),N+=(z-N-h*(O-a))*C,p=h*(1-a),_&&(N=Math.round(N),p=Math.round(p));var U=ISe(O).map(function(j){return N+h*j});return n(k?U.reverse():U)}return e.domain=function(O){return arguments.length?(t(O),A()):t()},e.range=function(O){return arguments.length?([o,u]=O,o=+o,u=+u,A()):[o,u]},e.rangeRound=function(O){return[o,u]=O,o=+o,u=+u,_=!0,A()},e.bandwidth=function(){return p},e.step=function(){return h},e.round=function(O){return arguments.length?(_=!!O,A()):_},e.padding=function(O){return arguments.length?(a=Math.min(1,b=+O),A()):a},e.paddingInner=function(O){return arguments.length?(a=Math.min(1,O),A()):a},e.paddingOuter=function(O){return arguments.length?(b=+O,A()):b},e.align=function(O){return arguments.length?(C=Math.max(0,Math.min(1,O)),A()):C},e.copy=function(){return D0(t(),[o,u]).round(_).paddingInner(a).paddingOuter(b).align(C)},As.apply(A(),arguments)}function Y9(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Y9(t())},e}function Qv(){return Y9(D0.apply(null,arguments).paddingInner(1))}function xD(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function K9(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Dx(){}var L0=.7,eT=1/L0,ng="\\s*([+-]?\\d+)\\s*",z0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ul="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",OSe=/^#([0-9a-f]{3,8})$/,RSe=new RegExp(`^rgb\\(${ng},${ng},${ng}\\)$`),kSe=new RegExp(`^rgb\\(${Ul},${Ul},${Ul}\\)$`),DSe=new RegExp(`^rgba\\(${ng},${ng},${ng},${z0}\\)$`),LSe=new RegExp(`^rgba\\(${Ul},${Ul},${Ul},${z0}\\)$`),zSe=new RegExp(`^hsl\\(${z0},${Ul},${Ul}\\)$`),FSe=new RegExp(`^hsla\\(${z0},${Ul},${Ul},${z0}\\)$`),B5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xD(Dx,F0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:j5,formatHex:j5,formatHex8:NSe,formatHsl:BSe,formatRgb:$5,toString:$5});function j5(){return this.rgb().formatHex()}function NSe(){return this.rgb().formatHex8()}function BSe(){return Q9(this).formatHsl()}function $5(){return this.rgb().formatRgb()}function F0(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=OSe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?U5(t):n===3?new ma(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Cw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Cw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=RSe.exec(e))?new ma(t[1],t[2],t[3],1):(t=kSe.exec(e))?new ma(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=DSe.exec(e))?Cw(t[1],t[2],t[3],t[4]):(t=LSe.exec(e))?Cw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=zSe.exec(e))?W5(t[1],t[2]/100,t[3]/100,1):(t=FSe.exec(e))?W5(t[1],t[2]/100,t[3]/100,t[4]):B5.hasOwnProperty(e)?U5(B5[e]):e==="transparent"?new ma(NaN,NaN,NaN,0):null}function U5(e){return new ma(e>>16&255,e>>8&255,e&255,1)}function Cw(e,t,n,o){return o<=0&&(e=t=n=NaN),new ma(e,t,n,o)}function jSe(e){return e instanceof Dx||(e=F0(e)),e?(e=e.rgb(),new ma(e.r,e.g,e.b,e.opacity)):new ma}function c3(e,t,n,o){return arguments.length===1?jSe(e):new ma(e,t,n,o??1)}function ma(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}xD(ma,c3,K9(Dx,{brighter(e){return e=e==null?eT:Math.pow(eT,e),new ma(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?L0:Math.pow(L0,e),new ma(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ma(Md(this.r),Md(this.g),Md(this.b),tT(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:V5,formatHex:V5,formatHex8:$Se,formatRgb:G5,toString:G5}));function V5(){return`#${bd(this.r)}${bd(this.g)}${bd(this.b)}`}function $Se(){return`#${bd(this.r)}${bd(this.g)}${bd(this.b)}${bd((isNaN(this.opacity)?1:this.opacity)*255)}`}function G5(){const e=tT(this.opacity);return`${e===1?"rgb(":"rgba("}${Md(this.r)}, ${Md(this.g)}, ${Md(this.b)}${e===1?")":`, ${e})`}`}function tT(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Md(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function bd(e){return e=Md(e),(e<16?"0":"")+e.toString(16)}function W5(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Qs(e,t,n,o)}function Q9(e){if(e instanceof Qs)return new Qs(e.h,e.s,e.l,e.opacity);if(e instanceof Dx||(e=F0(e)),!e)return new Qs;if(e instanceof Qs)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,u=Math.min(t,n,o),h=Math.max(t,n,o),p=NaN,_=h-u,a=(h+u)/2;return _?(t===h?p=(n-o)/_+(n<o)*6:n===h?p=(o-t)/_+2:p=(t-n)/_+4,_/=a<.5?h+u:2-h-u,p*=60):_=a>0&&a<1?0:p,new Qs(p,_,a,e.opacity)}function USe(e,t,n,o){return arguments.length===1?Q9(e):new Qs(e,t,n,o??1)}function Qs(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}xD(Qs,USe,K9(Dx,{brighter(e){return e=e==null?eT:Math.pow(eT,e),new Qs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?L0:Math.pow(L0,e),new Qs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,u=2*n-o;return new ma(FM(e>=240?e-240:e+120,u,o),FM(e,u,o),FM(e<120?e+240:e-120,u,o),this.opacity)},clamp(){return new Qs(H5(this.h),Pw(this.s),Pw(this.l),tT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=tT(this.opacity);return`${e===1?"hsl(":"hsla("}${H5(this.h)}, ${Pw(this.s)*100}%, ${Pw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function H5(e){return e=(e||0)%360,e<0?e+360:e}function Pw(e){return Math.max(0,Math.min(1,e||0))}function FM(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const bD=e=>()=>e;function VSe(e,t){return function(n){return e+n*t}}function GSe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function WSe(e){return(e=+e)==1?J9:function(t,n){return n-t?GSe(t,n,e):bD(isNaN(t)?n:t)}}function J9(e,t){var n=t-e;return n?VSe(e,n):bD(isNaN(e)?t:e)}const q5=function e(t){var n=WSe(t);function o(u,h){var p=n((u=c3(u)).r,(h=c3(h)).r),_=n(u.g,h.g),a=n(u.b,h.b),b=J9(u.opacity,h.opacity);return function(C){return u.r=p(C),u.g=_(C),u.b=a(C),u.opacity=b(C),u+""}}return o.gamma=e,o}(1);function HSe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),u;return function(h){for(u=0;u<n;++u)o[u]=e[u]*(1-h)+t[u]*h;return o}}function qSe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ZSe(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,u=new Array(o),h=new Array(n),p;for(p=0;p<o;++p)u[p]=iy(e[p],t[p]);for(;p<n;++p)h[p]=t[p];return function(_){for(p=0;p<o;++p)h[p]=u[p](_);return h}}function XSe(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function nT(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function YSe(e,t){var n={},o={},u;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(u in t)u in e?n[u]=iy(e[u],t[u]):o[u]=t[u];return function(h){for(u in n)o[u]=n[u](h);return o}}var h3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,NM=new RegExp(h3.source,"g");function KSe(e){return function(){return e}}function QSe(e){return function(t){return e(t)+""}}function JSe(e,t){var n=h3.lastIndex=NM.lastIndex=0,o,u,h,p=-1,_=[],a=[];for(e=e+"",t=t+"";(o=h3.exec(e))&&(u=NM.exec(t));)(h=u.index)>n&&(h=t.slice(n,h),_[p]?_[p]+=h:_[++p]=h),(o=o[0])===(u=u[0])?_[p]?_[p]+=u:_[++p]=u:(_[++p]=null,a.push({i:p,x:nT(o,u)})),n=NM.lastIndex;return n<t.length&&(h=t.slice(n),_[p]?_[p]+=h:_[++p]=h),_.length<2?a[0]?QSe(a[0].x):KSe(t):(t=a.length,function(b){for(var C=0,A;C<t;++C)_[(A=a[C]).i]=A.x(b);return _.join("")})}function iy(e,t){var n=typeof t,o;return t==null||n==="boolean"?bD(t):(n==="number"?nT:n==="string"?(o=F0(t))?(t=o,q5):JSe:t instanceof F0?q5:t instanceof Date?XSe:qSe(t)?HSe:Array.isArray(t)?ZSe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?YSe:nT)(e,t)}function wD(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function eTe(e,t){t===void 0&&(t=e,e=iy);for(var n=0,o=t.length-1,u=t[0],h=new Array(o<0?0:o);n<o;)h[n]=e(u,u=t[++n]);return function(p){var _=Math.max(0,Math.min(o-1,Math.floor(p*=o)));return h[_](p-_)}}function tTe(e){return function(){return e}}function rT(e){return+e}var Z5=[0,1];function qo(e){return e}function f3(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:tTe(isNaN(t)?NaN:.5)}function nTe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(o){return Math.max(e,Math.min(t,o))}}function rTe(e,t,n){var o=e[0],u=e[1],h=t[0],p=t[1];return u<o?(o=f3(u,o),h=n(p,h)):(o=f3(o,u),h=n(h,p)),function(_){return h(o(_))}}function iTe(e,t,n){var o=Math.min(e.length,t.length)-1,u=new Array(o),h=new Array(o),p=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++p<o;)u[p]=f3(e[p],e[p+1]),h[p]=n(t[p],t[p+1]);return function(_){var a=kx(e,_,1,o)-1;return h[a](u[a](_))}}function Lx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function HE(){var e=Z5,t=Z5,n=iy,o,u,h,p=qo,_,a,b;function C(){var O=Math.min(e.length,t.length);return p!==qo&&(p=nTe(e[0],e[O-1])),_=O>2?iTe:rTe,a=b=null,A}function A(O){return O==null||isNaN(O=+O)?h:(a||(a=_(e.map(o),t,n)))(o(p(O)))}return A.invert=function(O){return p(u((b||(b=_(t,e.map(o),nT)))(O)))},A.domain=function(O){return arguments.length?(e=Array.from(O,rT),C()):e.slice()},A.range=function(O){return arguments.length?(t=Array.from(O),C()):t.slice()},A.rangeRound=function(O){return t=Array.from(O),n=wD,C()},A.clamp=function(O){return arguments.length?(p=O?!0:qo,C()):p!==qo},A.interpolate=function(O){return arguments.length?(n=O,C()):n},A.unknown=function(O){return arguments.length?(h=O,A):h},function(O,k){return o=O,u=k,C()}}function SD(){return HE()(qo,qo)}function oTe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function iT(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,o=e.slice(0,n);return[o.length>1?o[0]+o.slice(2):o,+e.slice(n+1)]}function wg(e){return e=iT(Math.abs(e)),e?e[1]:NaN}function aTe(e,t){return function(n,o){for(var u=n.length,h=[],p=0,_=e[0],a=0;u>0&&_>0&&(a+_+1>o&&(_=Math.max(1,o-a)),h.push(n.substring(u-=_,u+_)),!((a+=_+1)>o));)_=e[p=(p+1)%e.length];return h.reverse().join(t)}}function sTe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var lTe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function N0(e){if(!(t=lTe.exec(e)))throw new Error("invalid format: "+e);var t;return new TD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}N0.prototype=TD.prototype;function TD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}TD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uTe(e){e:for(var t=e.length,n=1,o=-1,u;n<t;++n)switch(e[n]){case".":o=u=n;break;case"0":o===0&&(o=n),u=n;break;default:if(!+e[n])break e;o>0&&(o=0);break}return o>0?e.slice(0,o)+e.slice(u+1):e}var eq;function cTe(e,t){var n=iT(e,t);if(!n)return e+"";var o=n[0],u=n[1],h=u-(eq=Math.max(-8,Math.min(8,Math.floor(u/3)))*3)+1,p=o.length;return h===p?o:h>p?o+new Array(h-p+1).join("0"):h>0?o.slice(0,h)+"."+o.slice(h):"0."+new Array(1-h).join("0")+iT(e,Math.max(0,t+h-1))[0]}function X5(e,t){var n=iT(e,t);if(!n)return e+"";var o=n[0],u=n[1];return u<0?"0."+new Array(-u).join("0")+o:o.length>u+1?o.slice(0,u+1)+"."+o.slice(u+1):o+new Array(u-o.length+2).join("0")}const Y5={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:oTe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>X5(e*100,t),r:X5,s:cTe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function K5(e){return e}var Q5=Array.prototype.map,J5=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function hTe(e){var t=e.grouping===void 0||e.thousands===void 0?K5:aTe(Q5.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",o=e.currency===void 0?"":e.currency[1]+"",u=e.decimal===void 0?".":e.decimal+"",h=e.numerals===void 0?K5:sTe(Q5.call(e.numerals,String)),p=e.percent===void 0?"%":e.percent+"",_=e.minus===void 0?"":e.minus+"",a=e.nan===void 0?"NaN":e.nan+"";function b(A){A=N0(A);var O=A.fill,k=A.align,N=A.sign,z=A.symbol,U=A.zero,j=A.width,G=A.comma,H=A.precision,Y=A.trim,K=A.type;K==="n"?(G=!0,K="g"):Y5[K]||(H===void 0&&(H=12),Y=!0,K="g"),(U||O==="0"&&k==="=")&&(U=!0,O="0",k="=");var ee=z==="$"?n:z==="#"&&/[boxX]/.test(K)?"0"+K.toLowerCase():"",ue=z==="$"?o:/[%p]/.test(K)?p:"",ve=Y5[K],Fe=/[defgprs%]/.test(K);H=H===void 0?6:/[gprs]/.test(K)?Math.max(1,Math.min(21,H)):Math.max(0,Math.min(20,H));function Ne(Oe){var Le=ee,Ue=ue,et,rt,st;if(K==="c")Ue=ve(Oe)+Ue,Oe="";else{Oe=+Oe;var Ke=Oe<0||1/Oe<0;if(Oe=isNaN(Oe)?a:ve(Math.abs(Oe),H),Y&&(Oe=uTe(Oe)),Ke&&+Oe==0&&N!=="+"&&(Ke=!1),Le=(Ke?N==="("?N:_:N==="-"||N==="("?"":N)+Le,Ue=(K==="s"?J5[8+eq/3]:"")+Ue+(Ke&&N==="("?")":""),Fe){for(et=-1,rt=Oe.length;++et<rt;)if(st=Oe.charCodeAt(et),48>st||st>57){Ue=(st===46?u+Oe.slice(et+1):Oe.slice(et))+Ue,Oe=Oe.slice(0,et);break}}}G&&!U&&(Oe=t(Oe,1/0));var Ze=Le.length+Oe.length+Ue.length,Xe=Ze<j?new Array(j-Ze+1).join(O):"";switch(G&&U&&(Oe=t(Xe+Oe,Xe.length?j-Ue.length:1/0),Xe=""),k){case"<":Oe=Le+Oe+Ue+Xe;break;case"=":Oe=Le+Xe+Oe+Ue;break;case"^":Oe=Xe.slice(0,Ze=Xe.length>>1)+Le+Oe+Ue+Xe.slice(Ze);break;default:Oe=Xe+Le+Oe+Ue;break}return h(Oe)}return Ne.toString=function(){return A+""},Ne}function C(A,O){var k=b((A=N0(A),A.type="f",A)),N=Math.max(-8,Math.min(8,Math.floor(wg(O)/3)))*3,z=Math.pow(10,-N),U=J5[8+N/3];return function(j){return k(z*j)+U}}return{format:b,formatPrefix:C}}var Mw,ED,tq;fTe({thousands:",",grouping:[3],currency:["$",""]});function fTe(e){return Mw=hTe(e),ED=Mw.format,tq=Mw.formatPrefix,Mw}function dTe(e){return Math.max(0,-wg(Math.abs(e)))}function pTe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wg(t)/3)))*3-wg(Math.abs(e)))}function mTe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,wg(t)-wg(e))+1}function nq(e,t,n,o){var u=l3(e,t,n),h;switch(o=N0(o??",f"),o.type){case"s":{var p=Math.max(Math.abs(e),Math.abs(t));return o.precision==null&&!isNaN(h=pTe(u,p))&&(o.precision=h),tq(o,p)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(h=mTe(u,Math.max(Math.abs(e),Math.abs(t))))&&(o.precision=h-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(h=dTe(u))&&(o.precision=h-(o.type==="%")*2);break}}return ED(o)}function Kh(e){var t=e.domain;return e.ticks=function(n){var o=t();return a3(o[0],o[o.length-1],n??10)},e.tickFormat=function(n,o){var u=t();return nq(u[0],u[u.length-1],n??10,o)},e.nice=function(n){n==null&&(n=10);var o=t(),u=0,h=o.length-1,p=o[u],_=o[h],a,b,C=10;for(_<p&&(b=p,p=_,_=b,b=u,u=h,h=b);C-- >0;){if(b=s3(p,_,n),b===a)return o[u]=p,o[h]=_,t(o);if(b>0)p=Math.floor(p/b)*b,_=Math.ceil(_/b)*b;else if(b<0)p=Math.ceil(p*b)/b,_=Math.floor(_*b)/b;else break;a=b}return e},e}function oT(){var e=SD();return e.copy=function(){return Lx(e,oT())},As.apply(e,arguments),Kh(e)}function rq(e){var t;function n(o){return o==null||isNaN(o=+o)?t:o}return n.invert=n,n.domain=n.range=function(o){return arguments.length?(e=Array.from(o,rT),n):e.slice()},n.unknown=function(o){return arguments.length?(t=o,n):t},n.copy=function(){return rq(e).unknown(t)},e=arguments.length?Array.from(e,rT):[0,1],Kh(n)}function iq(e,t){e=e.slice();var n=0,o=e.length-1,u=e[n],h=e[o],p;return h<u&&(p=n,n=o,o=p,p=u,u=h,h=p),e[n]=t.floor(u),e[o]=t.ceil(h),e}function e$(e){return Math.log(e)}function t$(e){return Math.exp(e)}function gTe(e){return-Math.log(-e)}function yTe(e){return-Math.exp(-e)}function _Te(e){return isFinite(e)?+("1e"+e):e<0?0:e}function vTe(e){return e===10?_Te:e===Math.E?Math.exp:t=>Math.pow(e,t)}function xTe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function n$(e){return(t,n)=>-e(-t,n)}function AD(e){const t=e(e$,t$),n=t.domain;let o=10,u,h;function p(){return u=xTe(o),h=vTe(o),n()[0]<0?(u=n$(u),h=n$(h),e(gTe,yTe)):e(e$,t$),t}return t.base=function(_){return arguments.length?(o=+_,p()):o},t.domain=function(_){return arguments.length?(n(_),p()):n()},t.ticks=_=>{const a=n();let b=a[0],C=a[a.length-1];const A=C<b;A&&([b,C]=[C,b]);let O=u(b),k=u(C),N,z;const U=_==null?10:+_;let j=[];if(!(o%1)&&k-O<U){if(O=Math.floor(O),k=Math.ceil(k),b>0){for(;O<=k;++O)for(N=1;N<o;++N)if(z=O<0?N/h(-O):N*h(O),!(z<b)){if(z>C)break;j.push(z)}}else for(;O<=k;++O)for(N=o-1;N>=1;--N)if(z=O>0?N/h(-O):N*h(O),!(z<b)){if(z>C)break;j.push(z)}j.length*2<U&&(j=a3(b,C,U))}else j=a3(O,k,Math.min(k-O,U)).map(h);return A?j.reverse():j},t.tickFormat=(_,a)=>{if(_==null&&(_=10),a==null&&(a=o===10?"s":","),typeof a!="function"&&(!(o%1)&&(a=N0(a)).precision==null&&(a.trim=!0),a=ED(a)),_===1/0)return a;const b=Math.max(1,o*_/t.ticks().length);return C=>{let A=C/h(Math.round(u(C)));return A*o<o-.5&&(A*=o),A<=b?a(C):""}},t.nice=()=>n(iq(n(),{floor:_=>h(Math.floor(u(_))),ceil:_=>h(Math.ceil(u(_)))})),t}function oq(){const e=AD(HE()).domain([1,10]);return e.copy=()=>Lx(e,oq()).base(e.base()),As.apply(e,arguments),e}function r$(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function i$(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function CD(e){var t=1,n=e(r$(t),i$(t));return n.constant=function(o){return arguments.length?e(r$(t=+o),i$(t)):t},Kh(n)}function aq(){var e=CD(HE());return e.copy=function(){return Lx(e,aq()).constant(e.constant())},As.apply(e,arguments)}function o$(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function bTe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function wTe(e){return e<0?-e*e:e*e}function PD(e){var t=e(qo,qo),n=1;function o(){return n===1?e(qo,qo):n===.5?e(bTe,wTe):e(o$(n),o$(1/n))}return t.exponent=function(u){return arguments.length?(n=+u,o()):n},Kh(t)}function MD(){var e=PD(HE());return e.copy=function(){return Lx(e,MD()).exponent(e.exponent())},As.apply(e,arguments),e}function STe(){return MD.apply(null,arguments).exponent(.5)}function a$(e){return Math.sign(e)*e*e}function TTe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function sq(){var e=SD(),t=[0,1],n=!1,o;function u(h){var p=TTe(e(h));return isNaN(p)?o:n?Math.round(p):p}return u.invert=function(h){return e.invert(a$(h))},u.domain=function(h){return arguments.length?(e.domain(h),u):e.domain()},u.range=function(h){return arguments.length?(e.range((t=Array.from(h,rT)).map(a$)),u):t.slice()},u.rangeRound=function(h){return u.range(h).round(!0)},u.round=function(h){return arguments.length?(n=!!h,u):n},u.clamp=function(h){return arguments.length?(e.clamp(h),u):e.clamp()},u.unknown=function(h){return arguments.length?(o=h,u):o},u.copy=function(){return sq(e.domain(),t).round(n).clamp(e.clamp()).unknown(o)},As.apply(u,arguments),Kh(u)}function lq(){var e=[],t=[],n=[],o;function u(){var p=0,_=Math.max(1,t.length);for(n=new Array(_-1);++p<_;)n[p-1]=MSe(e,p/_);return h}function h(p){return p==null||isNaN(p=+p)?o:t[kx(n,p)]}return h.invertExtent=function(p){var _=t.indexOf(p);return _<0?[NaN,NaN]:[_>0?n[_-1]:e[0],_<n.length?n[_]:e[e.length-1]]},h.domain=function(p){if(!arguments.length)return e.slice();e=[];for(let _ of p)_!=null&&!isNaN(_=+_)&&e.push(_);return e.sort(Lh),u()},h.range=function(p){return arguments.length?(t=Array.from(p),u()):t.slice()},h.unknown=function(p){return arguments.length?(o=p,h):o},h.quantiles=function(){return n.slice()},h.copy=function(){return lq().domain(e).range(t).unknown(o)},As.apply(h,arguments)}function uq(){var e=0,t=1,n=1,o=[.5],u=[0,1],h;function p(a){return a!=null&&a<=a?u[kx(o,a,0,n)]:h}function _(){var a=-1;for(o=new Array(n);++a<n;)o[a]=((a+1)*t-(a-n)*e)/(n+1);return p}return p.domain=function(a){return arguments.length?([e,t]=a,e=+e,t=+t,_()):[e,t]},p.range=function(a){return arguments.length?(n=(u=Array.from(a)).length-1,_()):u.slice()},p.invertExtent=function(a){var b=u.indexOf(a);return b<0?[NaN,NaN]:b<1?[e,o[0]]:b>=n?[o[n-1],t]:[o[b-1],o[b]]},p.unknown=function(a){return arguments.length&&(h=a),p},p.thresholds=function(){return o.slice()},p.copy=function(){return uq().domain([e,t]).range(u).unknown(h)},As.apply(Kh(p),arguments)}function cq(){var e=[.5],t=[0,1],n,o=1;function u(h){return h!=null&&h<=h?t[kx(e,h,0,o)]:n}return u.domain=function(h){return arguments.length?(e=Array.from(h),o=Math.min(e.length,t.length-1),u):e.slice()},u.range=function(h){return arguments.length?(t=Array.from(h),o=Math.min(e.length,t.length-1),u):t.slice()},u.invertExtent=function(h){var p=t.indexOf(h);return[e[p-1],e[p]]},u.unknown=function(h){return arguments.length?(n=h,u):n},u.copy=function(){return cq().domain(e).range(t).unknown(n)},As.apply(u,arguments)}const BM=new Date,jM=new Date;function no(e,t,n,o){function u(h){return e(h=arguments.length===0?new Date:new Date(+h)),h}return u.floor=h=>(e(h=new Date(+h)),h),u.ceil=h=>(e(h=new Date(h-1)),t(h,1),e(h),h),u.round=h=>{const p=u(h),_=u.ceil(h);return h-p<_-h?p:_},u.offset=(h,p)=>(t(h=new Date(+h),p==null?1:Math.floor(p)),h),u.range=(h,p,_)=>{const a=[];if(h=u.ceil(h),_=_==null?1:Math.floor(_),!(h<p)||!(_>0))return a;let b;do a.push(b=new Date(+h)),t(h,_),e(h);while(b<h&&h<p);return a},u.filter=h=>no(p=>{if(p>=p)for(;e(p),!h(p);)p.setTime(p-1)},(p,_)=>{if(p>=p)if(_<0)for(;++_<=0;)for(;t(p,-1),!h(p););else for(;--_>=0;)for(;t(p,1),!h(p););}),n&&(u.count=(h,p)=>(BM.setTime(+h),jM.setTime(+p),e(BM),e(jM),Math.floor(n(BM,jM))),u.every=h=>(h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?u.filter(o?p=>o(p)%h===0:p=>u.count(0,p)%h===0):u)),u}const aT=no(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);aT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?no(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):aT);aT.range;const ku=1e3,ys=ku*60,Du=ys*60,Zu=Du*24,ID=Zu*7,s$=Zu*30,$M=Zu*365,wd=no(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ku)},(e,t)=>(t-e)/ku,e=>e.getUTCSeconds());wd.range;const OD=no(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ku)},(e,t)=>{e.setTime(+e+t*ys)},(e,t)=>(t-e)/ys,e=>e.getMinutes());OD.range;const RD=no(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ys)},(e,t)=>(t-e)/ys,e=>e.getUTCMinutes());RD.range;const kD=no(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ku-e.getMinutes()*ys)},(e,t)=>{e.setTime(+e+t*Du)},(e,t)=>(t-e)/Du,e=>e.getHours());kD.range;const DD=no(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Du)},(e,t)=>(t-e)/Du,e=>e.getUTCHours());DD.range;const zx=no(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ys)/Zu,e=>e.getDate()-1);zx.range;const qE=no(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Zu,e=>e.getUTCDate()-1);qE.range;const hq=no(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Zu,e=>Math.floor(e/Zu));hq.range;function Kd(e){return no(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*ys)/ID)}const ZE=Kd(0),sT=Kd(1),ETe=Kd(2),ATe=Kd(3),Sg=Kd(4),CTe=Kd(5),PTe=Kd(6);ZE.range;sT.range;ETe.range;ATe.range;Sg.range;CTe.range;PTe.range;function Qd(e){return no(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/ID)}const XE=Qd(0),lT=Qd(1),MTe=Qd(2),ITe=Qd(3),Tg=Qd(4),OTe=Qd(5),RTe=Qd(6);XE.range;lT.range;MTe.range;ITe.range;Tg.range;OTe.range;RTe.range;const LD=no(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());LD.range;const zD=no(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());zD.range;const Xu=no(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Xu.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:no(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Xu.range;const Yu=no(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Yu.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:no(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Yu.range;function fq(e,t,n,o,u,h){const p=[[wd,1,ku],[wd,5,5*ku],[wd,15,15*ku],[wd,30,30*ku],[h,1,ys],[h,5,5*ys],[h,15,15*ys],[h,30,30*ys],[u,1,Du],[u,3,3*Du],[u,6,6*Du],[u,12,12*Du],[o,1,Zu],[o,2,2*Zu],[n,1,ID],[t,1,s$],[t,3,3*s$],[e,1,$M]];function _(b,C,A){const O=C<b;O&&([b,C]=[C,b]);const k=A&&typeof A.range=="function"?A:a(b,C,A),N=k?k.range(b,+C+1):[];return O?N.reverse():N}function a(b,C,A){const O=Math.abs(C-b)/A,k=_D(([,,U])=>U).right(p,O);if(k===p.length)return e.every(l3(b/$M,C/$M,A));if(k===0)return aT.every(Math.max(l3(b,C,A),1));const[N,z]=p[O/p[k-1][2]<p[k][2]/O?k-1:k];return N.every(z)}return[_,a]}const[kTe,DTe]=fq(Yu,zD,XE,hq,DD,RD),[LTe,zTe]=fq(Xu,LD,ZE,zx,kD,OD);function UM(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function VM(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function bv(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function FTe(e){var t=e.dateTime,n=e.date,o=e.time,u=e.periods,h=e.days,p=e.shortDays,_=e.months,a=e.shortMonths,b=wv(u),C=Sv(u),A=wv(h),O=Sv(h),k=wv(p),N=Sv(p),z=wv(_),U=Sv(_),j=wv(a),G=Sv(a),H={a:Ke,A:Ze,b:Xe,B:de,c:null,d:d$,e:d$,f:aEe,g:gEe,G:_Ee,H:rEe,I:iEe,j:oEe,L:dq,m:sEe,M:lEe,p:lt,q:gt,Q:g$,s:y$,S:uEe,u:cEe,U:hEe,V:fEe,w:dEe,W:pEe,x:null,X:null,y:mEe,Y:yEe,Z:vEe,"%":m$},Y={a:Se,A:qt,b:an,B:dn,c:null,d:p$,e:p$,f:SEe,g:kEe,G:LEe,H:xEe,I:bEe,j:wEe,L:mq,m:TEe,M:EEe,p:Wt,q:An,Q:g$,s:y$,S:AEe,u:CEe,U:PEe,V:MEe,w:IEe,W:OEe,x:null,X:null,y:REe,Y:DEe,Z:zEe,"%":m$},K={a:Ne,A:Oe,b:Le,B:Ue,c:et,d:h$,e:h$,f:JTe,g:c$,G:u$,H:f$,I:f$,j:XTe,L:QTe,m:ZTe,M:YTe,p:Fe,q:qTe,Q:tEe,s:nEe,S:KTe,u:UTe,U:VTe,V:GTe,w:$Te,W:WTe,x:rt,X:st,y:c$,Y:u$,Z:HTe,"%":eEe};H.x=ee(n,H),H.X=ee(o,H),H.c=ee(t,H),Y.x=ee(n,Y),Y.X=ee(o,Y),Y.c=ee(t,Y);function ee(ht,Zt){return function(jt){var At=[],er=-1,Rn=0,_r=ht.length,dr,vr,Zr;for(jt instanceof Date||(jt=new Date(+jt));++er<_r;)ht.charCodeAt(er)===37&&(At.push(ht.slice(Rn,er)),(vr=l$[dr=ht.charAt(++er)])!=null?dr=ht.charAt(++er):vr=dr==="e"?" ":"0",(Zr=Zt[dr])&&(dr=Zr(jt,vr)),At.push(dr),Rn=er+1);return At.push(ht.slice(Rn,er)),At.join("")}}function ue(ht,Zt){return function(jt){var At=bv(1900,void 0,1),er=ve(At,ht,jt+="",0),Rn,_r;if(er!=jt.length)return null;if("Q"in At)return new Date(At.Q);if("s"in At)return new Date(At.s*1e3+("L"in At?At.L:0));if(Zt&&!("Z"in At)&&(At.Z=0),"p"in At&&(At.H=At.H%12+At.p*12),At.m===void 0&&(At.m="q"in At?At.q:0),"V"in At){if(At.V<1||At.V>53)return null;"w"in At||(At.w=1),"Z"in At?(Rn=VM(bv(At.y,0,1)),_r=Rn.getUTCDay(),Rn=_r>4||_r===0?lT.ceil(Rn):lT(Rn),Rn=qE.offset(Rn,(At.V-1)*7),At.y=Rn.getUTCFullYear(),At.m=Rn.getUTCMonth(),At.d=Rn.getUTCDate()+(At.w+6)%7):(Rn=UM(bv(At.y,0,1)),_r=Rn.getDay(),Rn=_r>4||_r===0?sT.ceil(Rn):sT(Rn),Rn=zx.offset(Rn,(At.V-1)*7),At.y=Rn.getFullYear(),At.m=Rn.getMonth(),At.d=Rn.getDate()+(At.w+6)%7)}else("W"in At||"U"in At)&&("w"in At||(At.w="u"in At?At.u%7:"W"in At?1:0),_r="Z"in At?VM(bv(At.y,0,1)).getUTCDay():UM(bv(At.y,0,1)).getDay(),At.m=0,At.d="W"in At?(At.w+6)%7+At.W*7-(_r+5)%7:At.w+At.U*7-(_r+6)%7);return"Z"in At?(At.H+=At.Z/100|0,At.M+=At.Z%100,VM(At)):UM(At)}}function ve(ht,Zt,jt,At){for(var er=0,Rn=Zt.length,_r=jt.length,dr,vr;er<Rn;){if(At>=_r)return-1;if(dr=Zt.charCodeAt(er++),dr===37){if(dr=Zt.charAt(er++),vr=K[dr in l$?Zt.charAt(er++):dr],!vr||(At=vr(ht,jt,At))<0)return-1}else if(dr!=jt.charCodeAt(At++))return-1}return At}function Fe(ht,Zt,jt){var At=b.exec(Zt.slice(jt));return At?(ht.p=C.get(At[0].toLowerCase()),jt+At[0].length):-1}function Ne(ht,Zt,jt){var At=k.exec(Zt.slice(jt));return At?(ht.w=N.get(At[0].toLowerCase()),jt+At[0].length):-1}function Oe(ht,Zt,jt){var At=A.exec(Zt.slice(jt));return At?(ht.w=O.get(At[0].toLowerCase()),jt+At[0].length):-1}function Le(ht,Zt,jt){var At=j.exec(Zt.slice(jt));return At?(ht.m=G.get(At[0].toLowerCase()),jt+At[0].length):-1}function Ue(ht,Zt,jt){var At=z.exec(Zt.slice(jt));return At?(ht.m=U.get(At[0].toLowerCase()),jt+At[0].length):-1}function et(ht,Zt,jt){return ve(ht,t,Zt,jt)}function rt(ht,Zt,jt){return ve(ht,n,Zt,jt)}function st(ht,Zt,jt){return ve(ht,o,Zt,jt)}function Ke(ht){return p[ht.getDay()]}function Ze(ht){return h[ht.getDay()]}function Xe(ht){return a[ht.getMonth()]}function de(ht){return _[ht.getMonth()]}function lt(ht){return u[+(ht.getHours()>=12)]}function gt(ht){return 1+~~(ht.getMonth()/3)}function Se(ht){return p[ht.getUTCDay()]}function qt(ht){return h[ht.getUTCDay()]}function an(ht){return a[ht.getUTCMonth()]}function dn(ht){return _[ht.getUTCMonth()]}function Wt(ht){return u[+(ht.getUTCHours()>=12)]}function An(ht){return 1+~~(ht.getUTCMonth()/3)}return{format:function(ht){var Zt=ee(ht+="",H);return Zt.toString=function(){return ht},Zt},parse:function(ht){var Zt=ue(ht+="",!1);return Zt.toString=function(){return ht},Zt},utcFormat:function(ht){var Zt=ee(ht+="",Y);return Zt.toString=function(){return ht},Zt},utcParse:function(ht){var Zt=ue(ht+="",!0);return Zt.toString=function(){return ht},Zt}}}var l$={"-":"",_:" ",0:"0"},fo=/^\s*\d+/,NTe=/^%/,BTe=/[\\^$*+?|[\]().{}]/g;function Ir(e,t,n){var o=e<0?"-":"",u=(o?-e:e)+"",h=u.length;return o+(h<n?new Array(n-h+1).join(t)+u:u)}function jTe(e){return e.replace(BTe,"\\$&")}function wv(e){return new RegExp("^(?:"+e.map(jTe).join("|")+")","i")}function Sv(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function $Te(e,t,n){var o=fo.exec(t.slice(n,n+1));return o?(e.w=+o[0],n+o[0].length):-1}function UTe(e,t,n){var o=fo.exec(t.slice(n,n+1));return o?(e.u=+o[0],n+o[0].length):-1}function VTe(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.U=+o[0],n+o[0].length):-1}function GTe(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.V=+o[0],n+o[0].length):-1}function WTe(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.W=+o[0],n+o[0].length):-1}function u$(e,t,n){var o=fo.exec(t.slice(n,n+4));return o?(e.y=+o[0],n+o[0].length):-1}function c$(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.y=+o[0]+(+o[0]>68?1900:2e3),n+o[0].length):-1}function HTe(e,t,n){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return o?(e.Z=o[1]?0:-(o[2]+(o[3]||"00")),n+o[0].length):-1}function qTe(e,t,n){var o=fo.exec(t.slice(n,n+1));return o?(e.q=o[0]*3-3,n+o[0].length):-1}function ZTe(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.m=o[0]-1,n+o[0].length):-1}function h$(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.d=+o[0],n+o[0].length):-1}function XTe(e,t,n){var o=fo.exec(t.slice(n,n+3));return o?(e.m=0,e.d=+o[0],n+o[0].length):-1}function f$(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.H=+o[0],n+o[0].length):-1}function YTe(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.M=+o[0],n+o[0].length):-1}function KTe(e,t,n){var o=fo.exec(t.slice(n,n+2));return o?(e.S=+o[0],n+o[0].length):-1}function QTe(e,t,n){var o=fo.exec(t.slice(n,n+3));return o?(e.L=+o[0],n+o[0].length):-1}function JTe(e,t,n){var o=fo.exec(t.slice(n,n+6));return o?(e.L=Math.floor(o[0]/1e3),n+o[0].length):-1}function eEe(e,t,n){var o=NTe.exec(t.slice(n,n+1));return o?n+o[0].length:-1}function tEe(e,t,n){var o=fo.exec(t.slice(n));return o?(e.Q=+o[0],n+o[0].length):-1}function nEe(e,t,n){var o=fo.exec(t.slice(n));return o?(e.s=+o[0],n+o[0].length):-1}function d$(e,t){return Ir(e.getDate(),t,2)}function rEe(e,t){return Ir(e.getHours(),t,2)}function iEe(e,t){return Ir(e.getHours()%12||12,t,2)}function oEe(e,t){return Ir(1+zx.count(Xu(e),e),t,3)}function dq(e,t){return Ir(e.getMilliseconds(),t,3)}function aEe(e,t){return dq(e,t)+"000"}function sEe(e,t){return Ir(e.getMonth()+1,t,2)}function lEe(e,t){return Ir(e.getMinutes(),t,2)}function uEe(e,t){return Ir(e.getSeconds(),t,2)}function cEe(e){var t=e.getDay();return t===0?7:t}function hEe(e,t){return Ir(ZE.count(Xu(e)-1,e),t,2)}function pq(e){var t=e.getDay();return t>=4||t===0?Sg(e):Sg.ceil(e)}function fEe(e,t){return e=pq(e),Ir(Sg.count(Xu(e),e)+(Xu(e).getDay()===4),t,2)}function dEe(e){return e.getDay()}function pEe(e,t){return Ir(sT.count(Xu(e)-1,e),t,2)}function mEe(e,t){return Ir(e.getFullYear()%100,t,2)}function gEe(e,t){return e=pq(e),Ir(e.getFullYear()%100,t,2)}function yEe(e,t){return Ir(e.getFullYear()%1e4,t,4)}function _Ee(e,t){var n=e.getDay();return e=n>=4||n===0?Sg(e):Sg.ceil(e),Ir(e.getFullYear()%1e4,t,4)}function vEe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ir(t/60|0,"0",2)+Ir(t%60,"0",2)}function p$(e,t){return Ir(e.getUTCDate(),t,2)}function xEe(e,t){return Ir(e.getUTCHours(),t,2)}function bEe(e,t){return Ir(e.getUTCHours()%12||12,t,2)}function wEe(e,t){return Ir(1+qE.count(Yu(e),e),t,3)}function mq(e,t){return Ir(e.getUTCMilliseconds(),t,3)}function SEe(e,t){return mq(e,t)+"000"}function TEe(e,t){return Ir(e.getUTCMonth()+1,t,2)}function EEe(e,t){return Ir(e.getUTCMinutes(),t,2)}function AEe(e,t){return Ir(e.getUTCSeconds(),t,2)}function CEe(e){var t=e.getUTCDay();return t===0?7:t}function PEe(e,t){return Ir(XE.count(Yu(e)-1,e),t,2)}function gq(e){var t=e.getUTCDay();return t>=4||t===0?Tg(e):Tg.ceil(e)}function MEe(e,t){return e=gq(e),Ir(Tg.count(Yu(e),e)+(Yu(e).getUTCDay()===4),t,2)}function IEe(e){return e.getUTCDay()}function OEe(e,t){return Ir(lT.count(Yu(e)-1,e),t,2)}function REe(e,t){return Ir(e.getUTCFullYear()%100,t,2)}function kEe(e,t){return e=gq(e),Ir(e.getUTCFullYear()%100,t,2)}function DEe(e,t){return Ir(e.getUTCFullYear()%1e4,t,4)}function LEe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Tg(e):Tg.ceil(e),Ir(e.getUTCFullYear()%1e4,t,4)}function zEe(){return"+0000"}function m$(){return"%"}function g$(e){return+e}function y$(e){return Math.floor(+e/1e3)}var Tm,yq,_q;FEe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function FEe(e){return Tm=FTe(e),yq=Tm.format,Tm.parse,_q=Tm.utcFormat,Tm.utcParse,Tm}function NEe(e){return new Date(e)}function BEe(e){return e instanceof Date?+e:+new Date(+e)}function FD(e,t,n,o,u,h,p,_,a,b){var C=SD(),A=C.invert,O=C.domain,k=b(".%L"),N=b(":%S"),z=b("%I:%M"),U=b("%I %p"),j=b("%a %d"),G=b("%b %d"),H=b("%B"),Y=b("%Y");function K(ee){return(a(ee)<ee?k:_(ee)<ee?N:p(ee)<ee?z:h(ee)<ee?U:o(ee)<ee?u(ee)<ee?j:G:n(ee)<ee?H:Y)(ee)}return C.invert=function(ee){return new Date(A(ee))},C.domain=function(ee){return arguments.length?O(Array.from(ee,BEe)):O().map(NEe)},C.ticks=function(ee){var ue=O();return e(ue[0],ue[ue.length-1],ee??10)},C.tickFormat=function(ee,ue){return ue==null?K:b(ue)},C.nice=function(ee){var ue=O();return(!ee||typeof ee.range!="function")&&(ee=t(ue[0],ue[ue.length-1],ee??10)),ee?O(iq(ue,ee)):C},C.copy=function(){return Lx(C,FD(e,t,n,o,u,h,p,_,a,b))},C}function jEe(){return As.apply(FD(LTe,zTe,Xu,LD,ZE,zx,kD,OD,wd,yq).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function $Ee(){return As.apply(FD(kTe,DTe,Yu,zD,XE,qE,DD,RD,wd,_q).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function YE(){var e=0,t=1,n,o,u,h,p=qo,_=!1,a;function b(A){return A==null||isNaN(A=+A)?a:p(u===0?.5:(A=(h(A)-n)*u,_?Math.max(0,Math.min(1,A)):A))}b.domain=function(A){return arguments.length?([e,t]=A,n=h(e=+e),o=h(t=+t),u=n===o?0:1/(o-n),b):[e,t]},b.clamp=function(A){return arguments.length?(_=!!A,b):_},b.interpolator=function(A){return arguments.length?(p=A,b):p};function C(A){return function(O){var k,N;return arguments.length?([k,N]=O,p=A(k,N),b):[p(0),p(1)]}}return b.range=C(iy),b.rangeRound=C(wD),b.unknown=function(A){return arguments.length?(a=A,b):a},function(A){return h=A,n=A(e),o=A(t),u=n===o?0:1/(o-n),b}}function Qh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function vq(){var e=Kh(YE()(qo));return e.copy=function(){return Qh(e,vq())},oc.apply(e,arguments)}function xq(){var e=AD(YE()).domain([1,10]);return e.copy=function(){return Qh(e,xq()).base(e.base())},oc.apply(e,arguments)}function bq(){var e=CD(YE());return e.copy=function(){return Qh(e,bq()).constant(e.constant())},oc.apply(e,arguments)}function ND(){var e=PD(YE());return e.copy=function(){return Qh(e,ND()).exponent(e.exponent())},oc.apply(e,arguments)}function UEe(){return ND.apply(null,arguments).exponent(.5)}function wq(){var e=[],t=qo;function n(o){if(o!=null&&!isNaN(o=+o))return t((kx(e,o,1)-1)/(e.length-1))}return n.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let u of o)u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(Lh),n},n.interpolator=function(o){return arguments.length?(t=o,n):t},n.range=function(){return e.map((o,u)=>t(u/(e.length-1)))},n.quantiles=function(o){return Array.from({length:o+1},(u,h)=>PSe(e,h/o))},n.copy=function(){return wq(t).domain(e)},oc.apply(n,arguments)}function KE(){var e=0,t=.5,n=1,o=1,u,h,p,_,a,b=qo,C,A=!1,O;function k(z){return isNaN(z=+z)?O:(z=.5+((z=+C(z))-h)*(o*z<o*h?_:a),b(A?Math.max(0,Math.min(1,z)):z))}k.domain=function(z){return arguments.length?([e,t,n]=z,u=C(e=+e),h=C(t=+t),p=C(n=+n),_=u===h?0:.5/(h-u),a=h===p?0:.5/(p-h),o=h<u?-1:1,k):[e,t,n]},k.clamp=function(z){return arguments.length?(A=!!z,k):A},k.interpolator=function(z){return arguments.length?(b=z,k):b};function N(z){return function(U){var j,G,H;return arguments.length?([j,G,H]=U,b=eTe(z,[j,G,H]),k):[b(0),b(.5),b(1)]}}return k.range=N(iy),k.rangeRound=N(wD),k.unknown=function(z){return arguments.length?(O=z,k):O},function(z){return C=z,u=z(e),h=z(t),p=z(n),_=u===h?0:.5/(h-u),a=h===p?0:.5/(p-h),o=h<u?-1:1,k}}function Sq(){var e=Kh(KE()(qo));return e.copy=function(){return Qh(e,Sq())},oc.apply(e,arguments)}function Tq(){var e=AD(KE()).domain([.1,1,10]);return e.copy=function(){return Qh(e,Tq()).base(e.base())},oc.apply(e,arguments)}function Eq(){var e=CD(KE());return e.copy=function(){return Qh(e,Eq()).constant(e.constant())},oc.apply(e,arguments)}function BD(){var e=PD(KE());return e.copy=function(){return Qh(e,BD()).exponent(e.exponent())},oc.apply(e,arguments)}function VEe(){return BD.apply(null,arguments).exponent(.5)}const _$=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:D0,scaleDiverging:Sq,scaleDivergingLog:Tq,scaleDivergingPow:BD,scaleDivergingSqrt:VEe,scaleDivergingSymlog:Eq,scaleIdentity:rq,scaleImplicit:u3,scaleLinear:oT,scaleLog:oq,scaleOrdinal:vD,scalePoint:Qv,scalePow:MD,scaleQuantile:lq,scaleQuantize:uq,scaleRadial:sq,scaleSequential:vq,scaleSequentialLog:xq,scaleSequentialPow:ND,scaleSequentialQuantile:wq,scaleSequentialSqrt:UEe,scaleSequentialSymlog:bq,scaleSqrt:STe,scaleSymlog:aq,scaleThreshold:cq,scaleTime:jEe,scaleUtc:$Ee,tickFormat:nq},Symbol.toStringTag,{value:"Module"}));var GEe=Xg;function WEe(e,t,n){for(var o=-1,u=e.length;++o<u;){var h=e[o],p=t(h);if(p!=null&&(_===void 0?p===p&&!GEe(p):n(p,_)))var _=p,a=h}return a}var Aq=WEe;function HEe(e,t){return e>t}var qEe=HEe,ZEe=Aq,XEe=qEe,YEe=ry;function KEe(e){return e&&e.length?ZEe(e,YEe,XEe):void 0}var QEe=KEe;const Sh=Vr(QEe);function JEe(e,t){return e<t}var eAe=JEe,tAe=Aq,nAe=eAe,rAe=ry;function iAe(e){return e&&e.length?tAe(e,rAe,nAe):void 0}var oAe=iAe;const QE=Vr(oAe);var aAe=Jk,sAe=Yh,lAe=D9,uAe=ba;function cAe(e,t){var n=uAe(e)?aAe:lAe;return n(e,sAe(t))}var hAe=cAe,fAe=R9,dAe=hAe;function pAe(e,t){return fAe(dAe(e,t),1)}var mAe=pAe;const gAe=Vr(mAe);var yAe=pD;function _Ae(e,t){return yAe(e,t)}var vAe=_Ae;const B0=Vr(vAe);var oy=1e9,xAe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},$D,mi=!0,Ts="[DecimalError] ",Id=Ts+"Invalid argument: ",jD=Ts+"Exponent out of range: ",ay=Math.floor,fd=Math.pow,bAe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Fa,uo=1e7,ui=7,Cq=9007199254740991,uT=ay(Cq/ui),fn={};fn.absoluteValue=fn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};fn.comparedTo=fn.cmp=function(e){var t,n,o,u,h=this;if(e=new h.constructor(e),h.s!==e.s)return h.s||-e.s;if(h.e!==e.e)return h.e>e.e^h.s<0?1:-1;for(o=h.d.length,u=e.d.length,t=0,n=o<u?o:u;t<n;++t)if(h.d[t]!==e.d[t])return h.d[t]>e.d[t]^h.s<0?1:-1;return o===u?0:o>u^h.s<0?1:-1};fn.decimalPlaces=fn.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*ui;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};fn.dividedBy=fn.div=function(e){return ju(this,new this.constructor(e))};fn.dividedToIntegerBy=fn.idiv=function(e){var t=this,n=t.constructor;return Yr(ju(t,new n(e),0,1),n.precision)};fn.equals=fn.eq=function(e){return!this.cmp(e)};fn.exponent=function(){return Gi(this)};fn.greaterThan=fn.gt=function(e){return this.cmp(e)>0};fn.greaterThanOrEqualTo=fn.gte=function(e){return this.cmp(e)>=0};fn.isInteger=fn.isint=function(){return this.e>this.d.length-2};fn.isNegative=fn.isneg=function(){return this.s<0};fn.isPositive=fn.ispos=function(){return this.s>0};fn.isZero=function(){return this.s===0};fn.lessThan=fn.lt=function(e){return this.cmp(e)<0};fn.lessThanOrEqualTo=fn.lte=function(e){return this.cmp(e)<1};fn.logarithm=fn.log=function(e){var t,n=this,o=n.constructor,u=o.precision,h=u+5;if(e===void 0)e=new o(10);else if(e=new o(e),e.s<1||e.eq(Fa))throw Error(Ts+"NaN");if(n.s<1)throw Error(Ts+(n.s?"NaN":"-Infinity"));return n.eq(Fa)?new o(0):(mi=!1,t=ju(j0(n,h),j0(e,h),h),mi=!0,Yr(t,u))};fn.minus=fn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Iq(t,e):Pq(t,(e.s=-e.s,e))};fn.modulo=fn.mod=function(e){var t,n=this,o=n.constructor,u=o.precision;if(e=new o(e),!e.s)throw Error(Ts+"NaN");return n.s?(mi=!1,t=ju(n,e,0,1).times(e),mi=!0,n.minus(t)):Yr(new o(n),u)};fn.naturalExponential=fn.exp=function(){return Mq(this)};fn.naturalLogarithm=fn.ln=function(){return j0(this)};fn.negated=fn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};fn.plus=fn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Pq(t,e):Iq(t,(e.s=-e.s,e))};fn.precision=fn.sd=function(e){var t,n,o,u=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Id+e);if(t=Gi(u)+1,o=u.d.length-1,n=o*ui+1,o=u.d[o],o){for(;o%10==0;o/=10)n--;for(o=u.d[0];o>=10;o/=10)n++}return e&&t>n?t:n};fn.squareRoot=fn.sqrt=function(){var e,t,n,o,u,h,p,_=this,a=_.constructor;if(_.s<1){if(!_.s)return new a(0);throw Error(Ts+"NaN")}for(e=Gi(_),mi=!1,u=Math.sqrt(+_),u==0||u==1/0?(t=Nl(_.d),(t.length+e)%2==0&&(t+="0"),u=Math.sqrt(t),e=ay((e+1)/2)-(e<0||e%2),u==1/0?t="5e"+e:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),o=new a(t)):o=new a(u.toString()),n=a.precision,u=p=n+3;;)if(h=o,o=h.plus(ju(_,h,p+2)).times(.5),Nl(h.d).slice(0,p)===(t=Nl(o.d)).slice(0,p)){if(t=t.slice(p-3,p+1),u==p&&t=="4999"){if(Yr(h,n+1,0),h.times(h).eq(_)){o=h;break}}else if(t!="9999")break;p+=4}return mi=!0,Yr(o,n)};fn.times=fn.mul=function(e){var t,n,o,u,h,p,_,a,b,C=this,A=C.constructor,O=C.d,k=(e=new A(e)).d;if(!C.s||!e.s)return new A(0);for(e.s*=C.s,n=C.e+e.e,a=O.length,b=k.length,a<b&&(h=O,O=k,k=h,p=a,a=b,b=p),h=[],p=a+b,o=p;o--;)h.push(0);for(o=b;--o>=0;){for(t=0,u=a+o;u>o;)_=h[u]+k[o]*O[u-o-1]+t,h[u--]=_%uo|0,t=_/uo|0;h[u]=(h[u]+t)%uo|0}for(;!h[--p];)h.pop();return t?++n:h.shift(),e.d=h,e.e=n,mi?Yr(e,A.precision):e};fn.toDecimalPlaces=fn.todp=function(e,t){var n=this,o=n.constructor;return n=new o(n),e===void 0?n:(Hl(e,0,oy),t===void 0?t=o.rounding:Hl(t,0,8),Yr(n,e+Gi(n)+1,t))};fn.toExponential=function(e,t){var n,o=this,u=o.constructor;return e===void 0?n=Ud(o,!0):(Hl(e,0,oy),t===void 0?t=u.rounding:Hl(t,0,8),o=Yr(new u(o),e+1,t),n=Ud(o,!0,e+1)),n};fn.toFixed=function(e,t){var n,o,u=this,h=u.constructor;return e===void 0?Ud(u):(Hl(e,0,oy),t===void 0?t=h.rounding:Hl(t,0,8),o=Yr(new h(u),e+Gi(u)+1,t),n=Ud(o.abs(),!1,e+Gi(o)+1),u.isneg()&&!u.isZero()?"-"+n:n)};fn.toInteger=fn.toint=function(){var e=this,t=e.constructor;return Yr(new t(e),Gi(e)+1,t.rounding)};fn.toNumber=function(){return+this};fn.toPower=fn.pow=function(e){var t,n,o,u,h,p,_=this,a=_.constructor,b=12,C=+(e=new a(e));if(!e.s)return new a(Fa);if(_=new a(_),!_.s){if(e.s<1)throw Error(Ts+"Infinity");return _}if(_.eq(Fa))return _;if(o=a.precision,e.eq(Fa))return Yr(_,o);if(t=e.e,n=e.d.length-1,p=t>=n,h=_.s,p){if((n=C<0?-C:C)<=Cq){for(u=new a(Fa),t=Math.ceil(o/ui+4),mi=!1;n%2&&(u=u.times(_),x$(u.d,t)),n=ay(n/2),n!==0;)_=_.times(_),x$(_.d,t);return mi=!0,e.s<0?new a(Fa).div(u):Yr(u,o)}}else if(h<0)throw Error(Ts+"NaN");return h=h<0&&e.d[Math.max(t,n)]&1?-1:1,_.s=1,mi=!1,u=e.times(j0(_,o+b)),mi=!0,u=Mq(u),u.s=h,u};fn.toPrecision=function(e,t){var n,o,u=this,h=u.constructor;return e===void 0?(n=Gi(u),o=Ud(u,n<=h.toExpNeg||n>=h.toExpPos)):(Hl(e,1,oy),t===void 0?t=h.rounding:Hl(t,0,8),u=Yr(new h(u),e,t),n=Gi(u),o=Ud(u,e<=n||n<=h.toExpNeg,e)),o};fn.toSignificantDigits=fn.tosd=function(e,t){var n=this,o=n.constructor;return e===void 0?(e=o.precision,t=o.rounding):(Hl(e,1,oy),t===void 0?t=o.rounding:Hl(t,0,8)),Yr(new o(n),e,t)};fn.toString=fn.valueOf=fn.val=fn.toJSON=fn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Gi(e),n=e.constructor;return Ud(e,t<=n.toExpNeg||t>=n.toExpPos)};function Pq(e,t){var n,o,u,h,p,_,a,b,C=e.constructor,A=C.precision;if(!e.s||!t.s)return t.s||(t=new C(e)),mi?Yr(t,A):t;if(a=e.d,b=t.d,p=e.e,u=t.e,a=a.slice(),h=p-u,h){for(h<0?(o=a,h=-h,_=b.length):(o=b,u=p,_=a.length),p=Math.ceil(A/ui),_=p>_?p+1:_+1,h>_&&(h=_,o.length=1),o.reverse();h--;)o.push(0);o.reverse()}for(_=a.length,h=b.length,_-h<0&&(h=_,o=b,b=a,a=o),n=0;h;)n=(a[--h]=a[h]+b[h]+n)/uo|0,a[h]%=uo;for(n&&(a.unshift(n),++u),_=a.length;a[--_]==0;)a.pop();return t.d=a,t.e=u,mi?Yr(t,A):t}function Hl(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Id+e)}function Nl(e){var t,n,o,u=e.length-1,h="",p=e[0];if(u>0){for(h+=p,t=1;t<u;t++)o=e[t]+"",n=ui-o.length,n&&(h+=mh(n)),h+=o;p=e[t],o=p+"",n=ui-o.length,n&&(h+=mh(n))}else if(p===0)return"0";for(;p%10===0;)p/=10;return h+p}var ju=function(){function e(o,u){var h,p=0,_=o.length;for(o=o.slice();_--;)h=o[_]*u+p,o[_]=h%uo|0,p=h/uo|0;return p&&o.unshift(p),o}function t(o,u,h,p){var _,a;if(h!=p)a=h>p?1:-1;else for(_=a=0;_<h;_++)if(o[_]!=u[_]){a=o[_]>u[_]?1:-1;break}return a}function n(o,u,h){for(var p=0;h--;)o[h]-=p,p=o[h]<u[h]?1:0,o[h]=p*uo+o[h]-u[h];for(;!o[0]&&o.length>1;)o.shift()}return function(o,u,h,p){var _,a,b,C,A,O,k,N,z,U,j,G,H,Y,K,ee,ue,ve,Fe=o.constructor,Ne=o.s==u.s?1:-1,Oe=o.d,Le=u.d;if(!o.s)return new Fe(o);if(!u.s)throw Error(Ts+"Division by zero");for(a=o.e-u.e,ue=Le.length,K=Oe.length,k=new Fe(Ne),N=k.d=[],b=0;Le[b]==(Oe[b]||0);)++b;if(Le[b]>(Oe[b]||0)&&--a,h==null?G=h=Fe.precision:p?G=h+(Gi(o)-Gi(u))+1:G=h,G<0)return new Fe(0);if(G=G/ui+2|0,b=0,ue==1)for(C=0,Le=Le[0],G++;(b<K||C)&&G--;b++)H=C*uo+(Oe[b]||0),N[b]=H/Le|0,C=H%Le|0;else{for(C=uo/(Le[0]+1)|0,C>1&&(Le=e(Le,C),Oe=e(Oe,C),ue=Le.length,K=Oe.length),Y=ue,z=Oe.slice(0,ue),U=z.length;U<ue;)z[U++]=0;ve=Le.slice(),ve.unshift(0),ee=Le[0],Le[1]>=uo/2&&++ee;do C=0,_=t(Le,z,ue,U),_<0?(j=z[0],ue!=U&&(j=j*uo+(z[1]||0)),C=j/ee|0,C>1?(C>=uo&&(C=uo-1),A=e(Le,C),O=A.length,U=z.length,_=t(A,z,O,U),_==1&&(C--,n(A,ue<O?ve:Le,O))):(C==0&&(_=C=1),A=Le.slice()),O=A.length,O<U&&A.unshift(0),n(z,A,U),_==-1&&(U=z.length,_=t(Le,z,ue,U),_<1&&(C++,n(z,ue<U?ve:Le,U))),U=z.length):_===0&&(C++,z=[0]),N[b++]=C,_&&z[0]?z[U++]=Oe[Y]||0:(z=[Oe[Y]],U=1);while((Y++<K||z[0]!==void 0)&&G--)}return N[0]||N.shift(),k.e=a,Yr(k,p?h+Gi(k)+1:h)}}();function Mq(e,t){var n,o,u,h,p,_,a=0,b=0,C=e.constructor,A=C.precision;if(Gi(e)>16)throw Error(jD+Gi(e));if(!e.s)return new C(Fa);for(t==null?(mi=!1,_=A):_=t,p=new C(.03125);e.abs().gte(.1);)e=e.times(p),b+=5;for(o=Math.log(fd(2,b))/Math.LN10*2+5|0,_+=o,n=u=h=new C(Fa),C.precision=_;;){if(u=Yr(u.times(e),_),n=n.times(++a),p=h.plus(ju(u,n,_)),Nl(p.d).slice(0,_)===Nl(h.d).slice(0,_)){for(;b--;)h=Yr(h.times(h),_);return C.precision=A,t==null?(mi=!0,Yr(h,A)):h}h=p}}function Gi(e){for(var t=e.e*ui,n=e.d[0];n>=10;n/=10)t++;return t}function GM(e,t,n){if(t>e.LN10.sd())throw mi=!0,n&&(e.precision=n),Error(Ts+"LN10 precision limit exceeded");return Yr(new e(e.LN10),t)}function mh(e){for(var t="";e--;)t+="0";return t}function j0(e,t){var n,o,u,h,p,_,a,b,C,A=1,O=10,k=e,N=k.d,z=k.constructor,U=z.precision;if(k.s<1)throw Error(Ts+(k.s?"NaN":"-Infinity"));if(k.eq(Fa))return new z(0);if(t==null?(mi=!1,b=U):b=t,k.eq(10))return t==null&&(mi=!0),GM(z,b);if(b+=O,z.precision=b,n=Nl(N),o=n.charAt(0),h=Gi(k),Math.abs(h)<15e14){for(;o<7&&o!=1||o==1&&n.charAt(1)>3;)k=k.times(e),n=Nl(k.d),o=n.charAt(0),A++;h=Gi(k),o>1?(k=new z("0."+n),h++):k=new z(o+"."+n.slice(1))}else return a=GM(z,b+2,U).times(h+""),k=j0(new z(o+"."+n.slice(1)),b-O).plus(a),z.precision=U,t==null?(mi=!0,Yr(k,U)):k;for(_=p=k=ju(k.minus(Fa),k.plus(Fa),b),C=Yr(k.times(k),b),u=3;;){if(p=Yr(p.times(C),b),a=_.plus(ju(p,new z(u),b)),Nl(a.d).slice(0,b)===Nl(_.d).slice(0,b))return _=_.times(2),h!==0&&(_=_.plus(GM(z,b+2,U).times(h+""))),_=ju(_,new z(A),b),z.precision=U,t==null?(mi=!0,Yr(_,U)):_;_=a,u+=2}}function v$(e,t){var n,o,u;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(n<0&&(n=o),n+=+t.slice(o+1),t=t.substring(0,o)):n<0&&(n=t.length),o=0;t.charCodeAt(o)===48;)++o;for(u=t.length;t.charCodeAt(u-1)===48;)--u;if(t=t.slice(o,u),t){if(u-=o,n=n-o-1,e.e=ay(n/ui),e.d=[],o=(n+1)%ui,n<0&&(o+=ui),o<u){for(o&&e.d.push(+t.slice(0,o)),u-=ui;o<u;)e.d.push(+t.slice(o,o+=ui));t=t.slice(o),o=ui-t.length}else o-=u;for(;o--;)t+="0";if(e.d.push(+t),mi&&(e.e>uT||e.e<-uT))throw Error(jD+n)}else e.s=0,e.e=0,e.d=[0];return e}function Yr(e,t,n){var o,u,h,p,_,a,b,C,A=e.d;for(p=1,h=A[0];h>=10;h/=10)p++;if(o=t-p,o<0)o+=ui,u=t,b=A[C=0];else{if(C=Math.ceil((o+1)/ui),h=A.length,C>=h)return e;for(b=h=A[C],p=1;h>=10;h/=10)p++;o%=ui,u=o-ui+p}if(n!==void 0&&(h=fd(10,p-u-1),_=b/h%10|0,a=t<0||A[C+1]!==void 0||b%h,a=n<4?(_||a)&&(n==0||n==(e.s<0?3:2)):_>5||_==5&&(n==4||a||n==6&&(o>0?u>0?b/fd(10,p-u):0:A[C-1])%10&1||n==(e.s<0?8:7))),t<1||!A[0])return a?(h=Gi(e),A.length=1,t=t-h-1,A[0]=fd(10,(ui-t%ui)%ui),e.e=ay(-t/ui)||0):(A.length=1,A[0]=e.e=e.s=0),e;if(o==0?(A.length=C,h=1,C--):(A.length=C+1,h=fd(10,ui-o),A[C]=u>0?(b/fd(10,p-u)%fd(10,u)|0)*h:0),a)for(;;)if(C==0){(A[0]+=h)==uo&&(A[0]=1,++e.e);break}else{if(A[C]+=h,A[C]!=uo)break;A[C--]=0,h=1}for(o=A.length;A[--o]===0;)A.pop();if(mi&&(e.e>uT||e.e<-uT))throw Error(jD+Gi(e));return e}function Iq(e,t){var n,o,u,h,p,_,a,b,C,A,O=e.constructor,k=O.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new O(e),mi?Yr(t,k):t;if(a=e.d,A=t.d,o=t.e,b=e.e,a=a.slice(),p=b-o,p){for(C=p<0,C?(n=a,p=-p,_=A.length):(n=A,o=b,_=a.length),u=Math.max(Math.ceil(k/ui),_)+2,p>u&&(p=u,n.length=1),n.reverse(),u=p;u--;)n.push(0);n.reverse()}else{for(u=a.length,_=A.length,C=u<_,C&&(_=u),u=0;u<_;u++)if(a[u]!=A[u]){C=a[u]<A[u];break}p=0}for(C&&(n=a,a=A,A=n,t.s=-t.s),_=a.length,u=A.length-_;u>0;--u)a[_++]=0;for(u=A.length;u>p;){if(a[--u]<A[u]){for(h=u;h&&a[--h]===0;)a[h]=uo-1;--a[h],a[u]+=uo}a[u]-=A[u]}for(;a[--_]===0;)a.pop();for(;a[0]===0;a.shift())--o;return a[0]?(t.d=a,t.e=o,mi?Yr(t,k):t):new O(0)}function Ud(e,t,n){var o,u=Gi(e),h=Nl(e.d),p=h.length;return t?(n&&(o=n-p)>0?h=h.charAt(0)+"."+h.slice(1)+mh(o):p>1&&(h=h.charAt(0)+"."+h.slice(1)),h=h+(u<0?"e":"e+")+u):u<0?(h="0."+mh(-u-1)+h,n&&(o=n-p)>0&&(h+=mh(o))):u>=p?(h+=mh(u+1-p),n&&(o=n-u-1)>0&&(h=h+"."+mh(o))):((o=u+1)<p&&(h=h.slice(0,o)+"."+h.slice(o)),n&&(o=n-p)>0&&(u+1===p&&(h+="."),h+=mh(o))),e.s<0?"-"+h:h}function x$(e,t){if(e.length>t)return e.length=t,!0}function Oq(e){var t,n,o;function u(h){var p=this;if(!(p instanceof u))return new u(h);if(p.constructor=u,h instanceof u){p.s=h.s,p.e=h.e,p.d=(h=h.d)?h.slice():h;return}if(typeof h=="number"){if(h*0!==0)throw Error(Id+h);if(h>0)p.s=1;else if(h<0)h=-h,p.s=-1;else{p.s=0,p.e=0,p.d=[0];return}if(h===~~h&&h<1e7){p.e=0,p.d=[h];return}return v$(p,h.toString())}else if(typeof h!="string")throw Error(Id+h);if(h.charCodeAt(0)===45?(h=h.slice(1),p.s=-1):p.s=1,bAe.test(h))v$(p,h);else throw Error(Id+h)}if(u.prototype=fn,u.ROUND_UP=0,u.ROUND_DOWN=1,u.ROUND_CEIL=2,u.ROUND_FLOOR=3,u.ROUND_HALF_UP=4,u.ROUND_HALF_DOWN=5,u.ROUND_HALF_EVEN=6,u.ROUND_HALF_CEIL=7,u.ROUND_HALF_FLOOR=8,u.clone=Oq,u.config=u.set=wAe,e===void 0&&(e={}),e)for(o=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<o.length;)e.hasOwnProperty(n=o[t++])||(e[n]=this[n]);return u.config(e),u}function wAe(e){if(!e||typeof e!="object")throw Error(Ts+"Object expected");var t,n,o,u=["precision",1,oy,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<u.length;t+=3)if((o=e[n=u[t]])!==void 0)if(ay(o)===o&&o>=u[t+1]&&o<=u[t+2])this[n]=o;else throw Error(Id+n+": "+o);if((o=e[n="LN10"])!==void 0)if(o==Math.LN10)this[n]=new this(o);else throw Error(Id+n+": "+o);return this}var $D=Oq(xAe);Fa=new $D(1);const qr=$D;function SAe(e){return CAe(e)||AAe(e)||EAe(e)||TAe()}function TAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EAe(e,t){if(e){if(typeof e=="string")return d3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d3(e,t)}}function AAe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function CAe(e){if(Array.isArray(e))return d3(e)}function d3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var PAe=function(t){return t},Rq={"@@functional/placeholder":!0},kq=function(t){return t===Rq},b$=function(t){return function n(){return arguments.length===0||arguments.length===1&&kq(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},MAe=function e(t,n){return t===1?n:b$(function(){for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];var p=u.filter(function(_){return _!==Rq}).length;return p>=t?n.apply(void 0,u):e(t-p,b$(function(){for(var _=arguments.length,a=new Array(_),b=0;b<_;b++)a[b]=arguments[b];var C=u.map(function(A){return kq(A)?a.shift():A});return n.apply(void 0,SAe(C).concat(a))}))})},JE=function(t){return MAe(t.length,t)},p3=function(t,n){for(var o=[],u=t;u<n;++u)o[u-t]=u;return o},IAe=JE(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),OAe=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];if(!n.length)return PAe;var u=n.reverse(),h=u[0],p=u.slice(1);return function(){return p.reduce(function(_,a){return a(_)},h.apply(void 0,arguments))}},m3=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Dq=function(t){var n=null,o=null;return function(){for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];return n&&h.every(function(_,a){return _===n[a]})||(n=h,o=t.apply(void 0,h)),o}};function RAe(e){var t;return e===0?t=1:t=Math.floor(new qr(e).abs().log(10).toNumber())+1,t}function kAe(e,t,n){for(var o=new qr(e),u=0,h=[];o.lt(t)&&u<1e5;)h.push(o.toNumber()),o=o.add(n),u++;return h}var DAe=JE(function(e,t,n){var o=+e,u=+t;return o+n*(u-o)}),LAe=JE(function(e,t,n){var o=t-+e;return o=o||1/0,(n-e)/o}),zAe=JE(function(e,t,n){var o=t-+e;return o=o||1/0,Math.max(0,Math.min(1,(n-e)/o))});const eA={rangeStep:kAe,getDigitCount:RAe,interpolateNumber:DAe,uninterpolateNumber:LAe,uninterpolateTruncation:zAe};function g3(e){return BAe(e)||NAe(e)||Lq(e)||FAe()}function FAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NAe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function BAe(e){if(Array.isArray(e))return y3(e)}function $0(e,t){return UAe(e)||$Ae(e,t)||Lq(e,t)||jAe()}function jAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lq(e,t){if(e){if(typeof e=="string")return y3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y3(e,t)}}function y3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function $Ae(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],o=!0,u=!1,h=void 0;try{for(var p=e[Symbol.iterator](),_;!(o=(_=p.next()).done)&&(n.push(_.value),!(t&&n.length===t));o=!0);}catch(a){u=!0,h=a}finally{try{!o&&p.return!=null&&p.return()}finally{if(u)throw h}}return n}}function UAe(e){if(Array.isArray(e))return e}function zq(e){var t=$0(e,2),n=t[0],o=t[1],u=n,h=o;return n>o&&(u=o,h=n),[u,h]}function Fq(e,t,n){if(e.lte(0))return new qr(0);var o=eA.getDigitCount(e.toNumber()),u=new qr(10).pow(o),h=e.div(u),p=o!==1?.05:.1,_=new qr(Math.ceil(h.div(p).toNumber())).add(n).mul(p),a=_.mul(u);return t?a:new qr(Math.ceil(a))}function VAe(e,t,n){var o=1,u=new qr(e);if(!u.isint()&&n){var h=Math.abs(e);h<1?(o=new qr(10).pow(eA.getDigitCount(e)-1),u=new qr(Math.floor(u.div(o).toNumber())).mul(o)):h>1&&(u=new qr(Math.floor(e)))}else e===0?u=new qr(Math.floor((t-1)/2)):n||(u=new qr(Math.floor(e)));var p=Math.floor((t-1)/2),_=OAe(IAe(function(a){return u.add(new qr(a-p).mul(o)).toNumber()}),p3);return _(0,t)}function Nq(e,t,n,o){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new qr(0),tickMin:new qr(0),tickMax:new qr(0)};var h=Fq(new qr(t).sub(e).div(n-1),o,u),p;e<=0&&t>=0?p=new qr(0):(p=new qr(e).add(t).div(2),p=p.sub(new qr(p).mod(h)));var _=Math.ceil(p.sub(e).div(h).toNumber()),a=Math.ceil(new qr(t).sub(p).div(h).toNumber()),b=_+a+1;return b>n?Nq(e,t,n,o,u+1):(b<n&&(a=t>0?a+(n-b):a,_=t>0?_:_+(n-b)),{step:h,tickMin:p.sub(new qr(_).mul(h)),tickMax:p.add(new qr(a).mul(h))})}function GAe(e){var t=$0(e,2),n=t[0],o=t[1],u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=Math.max(u,2),_=zq([n,o]),a=$0(_,2),b=a[0],C=a[1];if(b===-1/0||C===1/0){var A=C===1/0?[b].concat(g3(p3(0,u-1).map(function(){return 1/0}))):[].concat(g3(p3(0,u-1).map(function(){return-1/0})),[C]);return n>o?m3(A):A}if(b===C)return VAe(b,u,h);var O=Nq(b,C,p,h),k=O.step,N=O.tickMin,z=O.tickMax,U=eA.rangeStep(N,z.add(new qr(.1).mul(k)),k);return n>o?m3(U):U}function WAe(e,t){var n=$0(e,2),o=n[0],u=n[1],h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,p=zq([o,u]),_=$0(p,2),a=_[0],b=_[1];if(a===-1/0||b===1/0)return[o,u];if(a===b)return[a];var C=Math.max(t,2),A=Fq(new qr(b).sub(a).div(C-1),h,0),O=[].concat(g3(eA.rangeStep(new qr(a),new qr(b).sub(new qr(.99).mul(A)),A)),[b]);return o>u?m3(O):O}var HAe=Dq(GAe),qAe=Dq(WAe),ZAe="Invariant failed";function Vd(e,t){throw new Error(ZAe)}var XAe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Eg(e){"@babel/helpers - typeof";return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eg(e)}function cT(){return cT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},cT.apply(this,arguments)}function YAe(e,t){return eCe(e)||JAe(e,t)||QAe(e,t)||KAe()}function KAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QAe(e,t){if(e){if(typeof e=="string")return w$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w$(e,t)}}function w$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function JAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function eCe(e){if(Array.isArray(e))return e}function tCe(e,t){if(e==null)return{};var n=nCe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function nCe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function rCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iCe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,$q(o.key),o)}}function oCe(e,t,n){return t&&iCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aCe(e,t,n){return t=hT(t),sCe(e,Bq()?Reflect.construct(t,n||[],hT(e).constructor):t.apply(e,n))}function sCe(e,t){if(t&&(Eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lCe(e)}function lCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bq=function(){return!!e})()}function hT(e){return hT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hT(e)}function uCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_3(e,t)}function _3(e,t){return _3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},_3(e,t)}function jq(e,t,n){return t=$q(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $q(e){var t=cCe(e,"string");return Eg(t)=="symbol"?t:t+""}function cCe(e,t){if(Eg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Eg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tA=function(e){function t(){return rCe(this,t),aCe(this,t,arguments)}return uCe(t,e),oCe(t,[{key:"render",value:function(){var o=this.props,u=o.offset,h=o.layout,p=o.width,_=o.dataKey,a=o.data,b=o.dataPointFormatter,C=o.xAxis,A=o.yAxis,O=tCe(o,XAe),k=gr(O,!1);this.props.direction==="x"&&C.type!=="number"&&Vd();var N=a.map(function(z){var U=b(z,_),j=U.x,G=U.y,H=U.value,Y=U.errorVal;if(!Y)return null;var K=[],ee,ue;if(Array.isArray(Y)){var ve=YAe(Y,2);ee=ve[0],ue=ve[1]}else ee=ue=Y;if(h==="vertical"){var Fe=C.scale,Ne=G+u,Oe=Ne+p,Le=Ne-p,Ue=Fe(H-ee),et=Fe(H+ue);K.push({x1:et,y1:Oe,x2:et,y2:Le}),K.push({x1:Ue,y1:Ne,x2:et,y2:Ne}),K.push({x1:Ue,y1:Oe,x2:Ue,y2:Le})}else if(h==="horizontal"){var rt=A.scale,st=j+u,Ke=st-p,Ze=st+p,Xe=rt(H-ee),de=rt(H+ue);K.push({x1:Ke,y1:de,x2:Ze,y2:de}),K.push({x1:st,y1:Xe,x2:st,y2:de}),K.push({x1:Ke,y1:Xe,x2:Ze,y2:Xe})}return Ye.createElement(xi,cT({className:"recharts-errorBar",key:"bar-".concat(K.map(function(lt){return"".concat(lt.x1,"-").concat(lt.x2,"-").concat(lt.y1,"-").concat(lt.y2)}))},k),K.map(function(lt){return Ye.createElement("line",cT({},lt,{key:"line-".concat(lt.x1,"-").concat(lt.x2,"-").concat(lt.y1,"-").concat(lt.y2)}))}))});return Ye.createElement(xi,{className:"recharts-errorBars"},N)}}])}(Ye.Component);jq(tA,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});jq(tA,"displayName","ErrorBar");function U0(e){"@babel/helpers - typeof";return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U0(e)}function S$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function ad(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S$(Object(n),!0).forEach(function(o){hCe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function hCe(e,t,n){return t=fCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fCe(e){var t=dCe(e,"string");return U0(t)=="symbol"?t:t+""}function dCe(e,t){if(U0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(U0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uq=function(t){var n=t.children,o=t.formattedGraphicalItems,u=t.legendWidth,h=t.legendContent,p=La(n,tg);if(!p)return null;var _=tg.defaultProps,a=_!==void 0?ad(ad({},_),p.props):{},b;return p.props&&p.props.payload?b=p.props&&p.props.payload:h==="children"?b=(o||[]).reduce(function(C,A){var O=A.item,k=A.props,N=k.sectors||k.data||[];return C.concat(N.map(function(z){return{type:p.props.iconType||O.props.legendType,value:z.name,color:z.fill,payload:z}}))},[]):b=(o||[]).map(function(C){var A=C.item,O=A.type.defaultProps,k=O!==void 0?ad(ad({},O),A.props):{},N=k.dataKey,z=k.name,U=k.legendType,j=k.hide;return{inactive:j,dataKey:N,type:a.iconType||U||"square",color:UD(A),value:z||N,payload:k}}),ad(ad(ad({},a),tg.getWithHeight(p,u)),{},{payload:b,item:p})};function V0(e){"@babel/helpers - typeof";return V0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V0(e)}function T$(e){return yCe(e)||gCe(e)||mCe(e)||pCe()}function pCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mCe(e,t){if(e){if(typeof e=="string")return v3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v3(e,t)}}function gCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yCe(e){if(Array.isArray(e))return v3(e)}function v3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function E$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Ai(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?E$(Object(n),!0).forEach(function(o){rg(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function rg(e,t,n){return t=_Ce(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Ce(e){var t=vCe(e,"string");return V0(t)=="symbol"?t:t+""}function vCe(e,t){if(V0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(V0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ga(e,t,n){return Tr(e)||Tr(t)?n:to(t)?vs(e,t,n):hr(t)?t(e):n}function Jv(e,t,n,o){var u=gAe(e,function(_){return Ga(_,t)});if(n==="number"){var h=u.filter(function(_){return Qt(_)||parseFloat(_)});return h.length?[QE(h),Sh(h)]:[1/0,-1/0]}var p=o?u.filter(function(_){return!Tr(_)}):u;return p.map(function(_){return to(_)||_ instanceof Date?_:""})}var xCe=function(t){var n,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0,p=-1,_=(n=o==null?void 0:o.length)!==null&&n!==void 0?n:0;if(_<=1)return 0;if(h&&h.axisType==="angleAxis"&&Math.abs(Math.abs(h.range[1]-h.range[0])-360)<=1e-6)for(var a=h.range,b=0;b<_;b++){var C=b>0?u[b-1].coordinate:u[_-1].coordinate,A=u[b].coordinate,O=b>=_-1?u[0].coordinate:u[b+1].coordinate,k=void 0;if(Js(A-C)!==Js(O-A)){var N=[];if(Js(O-A)===Js(a[1]-a[0])){k=O;var z=A+a[1]-a[0];N[0]=Math.min(z,(z+C)/2),N[1]=Math.max(z,(z+C)/2)}else{k=C;var U=O+a[1]-a[0];N[0]=Math.min(A,(U+A)/2),N[1]=Math.max(A,(U+A)/2)}var j=[Math.min(A,(k+A)/2),Math.max(A,(k+A)/2)];if(t>j[0]&&t<=j[1]||t>=N[0]&&t<=N[1]){p=u[b].index;break}}else{var G=Math.min(C,O),H=Math.max(C,O);if(t>(G+A)/2&&t<=(H+A)/2){p=u[b].index;break}}}else for(var Y=0;Y<_;Y++)if(Y===0&&t<=(o[Y].coordinate+o[Y+1].coordinate)/2||Y>0&&Y<_-1&&t>(o[Y].coordinate+o[Y-1].coordinate)/2&&t<=(o[Y].coordinate+o[Y+1].coordinate)/2||Y===_-1&&t>(o[Y].coordinate+o[Y-1].coordinate)/2){p=o[Y].index;break}return p},UD=function(t){var n,o=t,u=o.type.displayName,h=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Ai(Ai({},t.type.defaultProps),t.props):t.props,p=h.stroke,_=h.fill,a;switch(u){case"Line":a=p;break;case"Area":case"Radar":a=p&&p!=="none"?p:_;break;default:a=_;break}return a},bCe=function(t){var n=t.barSize,o=t.totalSize,u=t.stackGroups,h=u===void 0?{}:u;if(!h)return{};for(var p={},_=Object.keys(h),a=0,b=_.length;a<b;a++)for(var C=h[_[a]].stackGroups,A=Object.keys(C),O=0,k=A.length;O<k;O++){var N=C[A[O]],z=N.items,U=N.cateAxisId,j=z.filter(function(ue){return Fu(ue.type).indexOf("Bar")>=0});if(j&&j.length){var G=j[0].type.defaultProps,H=G!==void 0?Ai(Ai({},G),j[0].props):j[0].props,Y=H.barSize,K=H[U];p[K]||(p[K]=[]);var ee=Tr(Y)?n:Y;p[K].push({item:j[0],stackList:j.slice(1),barSize:Tr(ee)?void 0:$d(ee,o,0)})}}return p},wCe=function(t){var n=t.barGap,o=t.barCategoryGap,u=t.bandSize,h=t.sizeList,p=h===void 0?[]:h,_=t.maxBarSize,a=p.length;if(a<1)return null;var b=$d(n,u,0,!0),C,A=[];if(p[0].barSize===+p[0].barSize){var O=!1,k=u/a,N=p.reduce(function(Y,K){return Y+K.barSize||0},0);N+=(a-1)*b,N>=u&&(N-=(a-1)*b,b=0),N>=u&&k>0&&(O=!0,k*=.9,N=a*k);var z=(u-N)/2>>0,U={offset:z-b,size:0};C=p.reduce(function(Y,K){var ee={item:K.item,position:{offset:U.offset+U.size+b,size:O?k:K.barSize}},ue=[].concat(T$(Y),[ee]);return U=ue[ue.length-1].position,K.stackList&&K.stackList.length&&K.stackList.forEach(function(ve){ue.push({item:ve,position:U})}),ue},A)}else{var j=$d(o,u,0,!0);u-2*j-(a-1)*b<=0&&(b=0);var G=(u-2*j-(a-1)*b)/a;G>1&&(G>>=0);var H=_===+_?Math.min(G,_):G;C=p.reduce(function(Y,K,ee){var ue=[].concat(T$(Y),[{item:K.item,position:{offset:j+(G+b)*ee+(G-H)/2,size:H}}]);return K.stackList&&K.stackList.length&&K.stackList.forEach(function(ve){ue.push({item:ve,position:ue[ue.length-1].position})}),ue},A)}return C},SCe=function(t,n,o,u){var h=o.children,p=o.width,_=o.margin,a=p-(_.left||0)-(_.right||0),b=Uq({children:h,legendWidth:a});if(b){var C=u||{},A=C.width,O=C.height,k=b.align,N=b.verticalAlign,z=b.layout;if((z==="vertical"||z==="horizontal"&&N==="middle")&&k!=="center"&&Qt(t[k]))return Ai(Ai({},t),{},rg({},k,t[k]+(A||0)));if((z==="horizontal"||z==="vertical"&&k==="center")&&N!=="middle"&&Qt(t[N]))return Ai(Ai({},t),{},rg({},N,t[N]+(O||0)))}return t},TCe=function(t,n,o){return Tr(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||o==="x"?n==="xAxis":o==="y"?n==="yAxis":!0},Vq=function(t,n,o,u,h){var p=n.props.children,_=rl(p,tA).filter(function(b){return TCe(u,h,b.props.direction)});if(_&&_.length){var a=_.map(function(b){return b.props.dataKey});return t.reduce(function(b,C){var A=Ga(C,o);if(Tr(A))return b;var O=Array.isArray(A)?[QE(A),Sh(A)]:[A,A],k=a.reduce(function(N,z){var U=Ga(C,z,0),j=O[0]-Math.abs(Array.isArray(U)?U[0]:U),G=O[1]+Math.abs(Array.isArray(U)?U[1]:U);return[Math.min(j,N[0]),Math.max(G,N[1])]},[1/0,-1/0]);return[Math.min(k[0],b[0]),Math.max(k[1],b[1])]},[1/0,-1/0])}return null},ECe=function(t,n,o,u,h){var p=n.map(function(_){return Vq(t,_,o,h,u)}).filter(function(_){return!Tr(_)});return p&&p.length?p.reduce(function(_,a){return[Math.min(_[0],a[0]),Math.max(_[1],a[1])]},[1/0,-1/0]):null},Gq=function(t,n,o,u,h){var p=n.map(function(a){var b=a.props.dataKey;return o==="number"&&b&&Vq(t,a,b,u)||Jv(t,b,o,h)});if(o==="number")return p.reduce(function(a,b){return[Math.min(a[0],b[0]),Math.max(a[1],b[1])]},[1/0,-1/0]);var _={};return p.reduce(function(a,b){for(var C=0,A=b.length;C<A;C++)_[b[C]]||(_[b[C]]=!0,a.push(b[C]));return a},[])},Wq=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},Hq=function(t,n,o,u){if(u)return t.map(function(a){return a.coordinate});var h,p,_=t.map(function(a){return a.coordinate===n&&(h=!0),a.coordinate===o&&(p=!0),a.coordinate});return h||_.push(n),p||_.push(o),_},Lu=function(t,n,o){if(!t)return null;var u=t.scale,h=t.duplicateDomain,p=t.type,_=t.range,a=t.realScaleType==="scaleBand"?u.bandwidth()/2:2,b=(n||o)&&p==="category"&&u.bandwidth?u.bandwidth()/a:0;if(b=t.axisType==="angleAxis"&&(_==null?void 0:_.length)>=2?Js(_[0]-_[1])*2*b:b,n&&(t.ticks||t.niceTicks)){var C=(t.ticks||t.niceTicks).map(function(A){var O=h?h.indexOf(A):A;return{coordinate:u(O)+b,value:A,offset:b}});return C.filter(function(A){return!ey(A.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(A,O){return{coordinate:u(A)+b,value:A,index:O,offset:b}}):u.ticks&&!o?u.ticks(t.tickCount).map(function(A){return{coordinate:u(A)+b,value:A,offset:b}}):u.domain().map(function(A,O){return{coordinate:u(A)+b,value:h?h[A]:A,index:O,offset:b}})},WM=new WeakMap,Iw=function(t,n){if(typeof n!="function")return t;WM.has(t)||WM.set(t,new WeakMap);var o=WM.get(t);if(o.has(n))return o.get(n);var u=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return o.set(n,u),u},ACe=function(t,n,o){var u=t.scale,h=t.type,p=t.layout,_=t.axisType;if(u==="auto")return p==="radial"&&_==="radiusAxis"?{scale:D0(),realScaleType:"band"}:p==="radial"&&_==="angleAxis"?{scale:oT(),realScaleType:"linear"}:h==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!o)?{scale:Qv(),realScaleType:"point"}:h==="category"?{scale:D0(),realScaleType:"band"}:{scale:oT(),realScaleType:"linear"};if(Ix(u)){var a="scale".concat(BE(u));return{scale:(_$[a]||Qv)(),realScaleType:_$[a]?a:"point"}}return hr(u)?{scale:u}:{scale:Qv(),realScaleType:"point"}},A$=1e-4,CCe=function(t){var n=t.domain();if(!(!n||n.length<=2)){var o=n.length,u=t.range(),h=Math.min(u[0],u[1])-A$,p=Math.max(u[0],u[1])+A$,_=t(n[0]),a=t(n[o-1]);(_<h||_>p||a<h||a>p)&&t.domain([n[0],n[o-1]])}},PCe=function(t,n){if(!t)return null;for(var o=0,u=t.length;o<u;o++)if(t[o].item===n)return t[o].position;return null},MCe=function(t,n){if(!n||n.length!==2||!Qt(n[0])||!Qt(n[1]))return t;var o=Math.min(n[0],n[1]),u=Math.max(n[0],n[1]),h=[t[0],t[1]];return(!Qt(t[0])||t[0]<o)&&(h[0]=o),(!Qt(t[1])||t[1]>u)&&(h[1]=u),h[0]>u&&(h[0]=u),h[1]<o&&(h[1]=o),h},ICe=function(t){var n=t.length;if(!(n<=0))for(var o=0,u=t[0].length;o<u;++o)for(var h=0,p=0,_=0;_<n;++_){var a=ey(t[_][o][1])?t[_][o][0]:t[_][o][1];a>=0?(t[_][o][0]=h,t[_][o][1]=h+a,h=t[_][o][1]):(t[_][o][0]=p,t[_][o][1]=p+a,p=t[_][o][1])}},OCe=function(t){var n=t.length;if(!(n<=0))for(var o=0,u=t[0].length;o<u;++o)for(var h=0,p=0;p<n;++p){var _=ey(t[p][o][1])?t[p][o][0]:t[p][o][1];_>=0?(t[p][o][0]=h,t[p][o][1]=h+_,h=t[p][o][1]):(t[p][o][0]=0,t[p][o][1]=0)}},RCe={sign:ICe,expand:Hme,none:yg,silhouette:qme,wiggle:Zme,positive:OCe},kCe=function(t,n,o){var u=n.map(function(_){return _.props.dataKey}),h=RCe[o],p=Wme().keys(u).value(function(_,a){return+Ga(_,a,0)}).order(GO).offset(h);return p(t)},DCe=function(t,n,o,u,h,p){if(!t)return null;var _=p?n.reverse():n,a={},b=_.reduce(function(A,O){var k,N=(k=O.type)!==null&&k!==void 0&&k.defaultProps?Ai(Ai({},O.type.defaultProps),O.props):O.props,z=N.stackId,U=N.hide;if(U)return A;var j=N[o],G=A[j]||{hasStack:!1,stackGroups:{}};if(to(z)){var H=G.stackGroups[z]||{numericAxisId:o,cateAxisId:u,items:[]};H.items.push(O),G.hasStack=!0,G.stackGroups[z]=H}else G.stackGroups[Ox("_stackId_")]={numericAxisId:o,cateAxisId:u,items:[O]};return Ai(Ai({},A),{},rg({},j,G))},a),C={};return Object.keys(b).reduce(function(A,O){var k=b[O];if(k.hasStack){var N={};k.stackGroups=Object.keys(k.stackGroups).reduce(function(z,U){var j=k.stackGroups[U];return Ai(Ai({},z),{},rg({},U,{numericAxisId:o,cateAxisId:u,items:j.items,stackedData:kCe(t,j.items,h)}))},N)}return Ai(Ai({},A),{},rg({},O,k))},C)},LCe=function(t,n){var o=n.realScaleType,u=n.type,h=n.tickCount,p=n.originalDomain,_=n.allowDecimals,a=o||n.scale;if(a!=="auto"&&a!=="linear")return null;if(h&&u==="number"&&p&&(p[0]==="auto"||p[1]==="auto")){var b=t.domain();if(!b.length)return null;var C=HAe(b,h,_);return t.domain([QE(C),Sh(C)]),{niceTicks:C}}if(h&&u==="number"){var A=t.domain(),O=qAe(A,h,_);return{niceTicks:O}}return null};function C$(e){var t=e.axis,n=e.ticks,o=e.bandSize,u=e.entry,h=e.index,p=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Tr(u[t.dataKey])){var _=zS(n,"value",u[t.dataKey]);if(_)return _.coordinate+o/2}return n[h]?n[h].coordinate+o/2:null}var a=Ga(u,Tr(p)?t.dataKey:p);return Tr(a)?null:t.scale(a)}var P$=function(t){var n=t.axis,o=t.ticks,u=t.offset,h=t.bandSize,p=t.entry,_=t.index;if(n.type==="category")return o[_]?o[_].coordinate+u:null;var a=Ga(p,n.dataKey,n.domain[_]);return Tr(a)?null:n.scale(a)-h/2+u},zCe=function(t){var n=t.numericAxis,o=n.scale.domain();if(n.type==="number"){var u=Math.min(o[0],o[1]),h=Math.max(o[0],o[1]);return u<=0&&h>=0?0:h<0?h:u}return o[0]},FCe=function(t,n){var o,u=(o=t.type)!==null&&o!==void 0&&o.defaultProps?Ai(Ai({},t.type.defaultProps),t.props):t.props,h=u.stackId;if(to(h)){var p=n[h];if(p){var _=p.items.indexOf(t);return _>=0?p.stackedData[_]:null}}return null},NCe=function(t){return t.reduce(function(n,o){return[QE(o.concat([n[0]]).filter(Qt)),Sh(o.concat([n[1]]).filter(Qt))]},[1/0,-1/0])},qq=function(t,n,o){return Object.keys(t).reduce(function(u,h){var p=t[h],_=p.stackedData,a=_.reduce(function(b,C){var A=NCe(C.slice(n,o+1));return[Math.min(b[0],A[0]),Math.max(b[1],A[1])]},[1/0,-1/0]);return[Math.min(a[0],u[0]),Math.max(a[1],u[1])]},[1/0,-1/0]).map(function(u){return u===1/0||u===-1/0?0:u})},M$=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,I$=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,x3=function(t,n,o){if(hr(t))return t(n,o);if(!Array.isArray(t))return n;var u=[];if(Qt(t[0]))u[0]=o?t[0]:Math.min(t[0],n[0]);else if(M$.test(t[0])){var h=+M$.exec(t[0])[1];u[0]=n[0]-h}else hr(t[0])?u[0]=t[0](n[0]):u[0]=n[0];if(Qt(t[1]))u[1]=o?t[1]:Math.max(t[1],n[1]);else if(I$.test(t[1])){var p=+I$.exec(t[1])[1];u[1]=n[1]+p}else hr(t[1])?u[1]=t[1](n[1]):u[1]=n[1];return u},fT=function(t,n,o){if(t&&t.scale&&t.scale.bandwidth){var u=t.scale.bandwidth();if(!o||u>0)return u}if(t&&n&&n.length>=2){for(var h=gD(n,function(A){return A.coordinate}),p=1/0,_=1,a=h.length;_<a;_++){var b=h[_],C=h[_-1];p=Math.min((b.coordinate||0)-(C.coordinate||0),p)}return p===1/0?0:p}return o?void 0:0},O$=function(t,n,o){return!t||!t.length||B0(t,vs(o,"type.defaultProps.domain"))?n:t},Zq=function(t,n){var o=t.type.defaultProps?Ai(Ai({},t.type.defaultProps),t.props):t.props,u=o.dataKey,h=o.name,p=o.unit,_=o.formatter,a=o.tooltipType,b=o.chartType,C=o.hide;return Ai(Ai({},gr(t,!1)),{},{dataKey:u,unit:p,formatter:_,name:h||u,color:UD(t),value:Ga(n,u),type:a,payload:n,chartType:b,hide:C})};function G0(e){"@babel/helpers - typeof";return G0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G0(e)}function R$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function k$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R$(Object(n),!0).forEach(function(o){BCe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function BCe(e,t,n){return t=jCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jCe(e){var t=$Ce(e,"string");return G0(t)=="symbol"?t:t+""}function $Ce(e,t){if(G0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(G0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dT=Math.PI/180,UCe=function(t){return t*180/Math.PI},wo=function(t,n,o,u){return{x:t+Math.cos(-dT*u)*o,y:n+Math.sin(-dT*u)*o}},VCe=function(t,n){var o=t.x,u=t.y,h=n.x,p=n.y;return Math.sqrt(Math.pow(o-h,2)+Math.pow(u-p,2))},GCe=function(t,n){var o=t.x,u=t.y,h=n.cx,p=n.cy,_=VCe({x:o,y:u},{x:h,y:p});if(_<=0)return{radius:_};var a=(o-h)/_,b=Math.acos(a);return u>p&&(b=2*Math.PI-b),{radius:_,angle:UCe(b),angleInRadian:b}},WCe=function(t){var n=t.startAngle,o=t.endAngle,u=Math.floor(n/360),h=Math.floor(o/360),p=Math.min(u,h);return{startAngle:n-p*360,endAngle:o-p*360}},HCe=function(t,n){var o=n.startAngle,u=n.endAngle,h=Math.floor(o/360),p=Math.floor(u/360),_=Math.min(h,p);return t+_*360},D$=function(t,n){var o=t.x,u=t.y,h=GCe({x:o,y:u},n),p=h.radius,_=h.angle,a=n.innerRadius,b=n.outerRadius;if(p<a||p>b)return!1;if(p===0)return!0;var C=WCe(n),A=C.startAngle,O=C.endAngle,k=_,N;if(A<=O){for(;k>O;)k-=360;for(;k<A;)k+=360;N=k>=A&&k<=O}else{for(;k>A;)k-=360;for(;k<O;)k+=360;N=k>=O&&k<=A}return N?k$(k$({},n),{},{radius:p,angle:HCe(k,n)}):null};function W0(e){"@babel/helpers - typeof";return W0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W0(e)}var qCe=["offset"];function ZCe(e){return QCe(e)||KCe(e)||YCe(e)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YCe(e,t){if(e){if(typeof e=="string")return b3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b3(e,t)}}function KCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QCe(e){if(Array.isArray(e))return b3(e)}function b3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function JCe(e,t){if(e==null)return{};var n=ePe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function ePe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function L$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Qi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L$(Object(n),!0).forEach(function(o){tPe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function tPe(e,t,n){return t=nPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nPe(e){var t=rPe(e,"string");return W0(t)=="symbol"?t:t+""}function rPe(e,t){if(W0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(W0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},H0.apply(this,arguments)}var iPe=function(t){var n=t.value,o=t.formatter,u=Tr(t.children)?n:t.children;return hr(o)?o(u):u},oPe=function(t,n){var o=Js(n-t),u=Math.min(Math.abs(n-t),360);return o*u},aPe=function(t,n,o){var u=t.position,h=t.viewBox,p=t.offset,_=t.className,a=h,b=a.cx,C=a.cy,A=a.innerRadius,O=a.outerRadius,k=a.startAngle,N=a.endAngle,z=a.clockWise,U=(A+O)/2,j=oPe(k,N),G=j>=0?1:-1,H,Y;u==="insideStart"?(H=k+G*p,Y=z):u==="insideEnd"?(H=N-G*p,Y=!z):u==="end"&&(H=N+G*p,Y=z),Y=j<=0?Y:!Y;var K=wo(b,C,U,H),ee=wo(b,C,U,H+(Y?1:-1)*359),ue="M".concat(K.x,",").concat(K.y,`
    A`).concat(U,",").concat(U,",0,1,").concat(Y?0:1,`,
    `).concat(ee.x,",").concat(ee.y),ve=Tr(t.id)?Ox("recharts-radial-line-"):t.id;return Ye.createElement("text",H0({},o,{dominantBaseline:"central",className:Cr("recharts-radial-bar-label",_)}),Ye.createElement("defs",null,Ye.createElement("path",{id:ve,d:ue})),Ye.createElement("textPath",{xlinkHref:"#".concat(ve)},n))},sPe=function(t){var n=t.viewBox,o=t.offset,u=t.position,h=n,p=h.cx,_=h.cy,a=h.innerRadius,b=h.outerRadius,C=h.startAngle,A=h.endAngle,O=(C+A)/2;if(u==="outside"){var k=wo(p,_,b+o,O),N=k.x,z=k.y;return{x:N,y:z,textAnchor:N>=p?"start":"end",verticalAnchor:"middle"}}if(u==="center")return{x:p,y:_,textAnchor:"middle",verticalAnchor:"middle"};if(u==="centerTop")return{x:p,y:_,textAnchor:"middle",verticalAnchor:"start"};if(u==="centerBottom")return{x:p,y:_,textAnchor:"middle",verticalAnchor:"end"};var U=(a+b)/2,j=wo(p,_,U,O),G=j.x,H=j.y;return{x:G,y:H,textAnchor:"middle",verticalAnchor:"middle"}},lPe=function(t){var n=t.viewBox,o=t.parentViewBox,u=t.offset,h=t.position,p=n,_=p.x,a=p.y,b=p.width,C=p.height,A=C>=0?1:-1,O=A*u,k=A>0?"end":"start",N=A>0?"start":"end",z=b>=0?1:-1,U=z*u,j=z>0?"end":"start",G=z>0?"start":"end";if(h==="top"){var H={x:_+b/2,y:a-A*u,textAnchor:"middle",verticalAnchor:k};return Qi(Qi({},H),o?{height:Math.max(a-o.y,0),width:b}:{})}if(h==="bottom"){var Y={x:_+b/2,y:a+C+O,textAnchor:"middle",verticalAnchor:N};return Qi(Qi({},Y),o?{height:Math.max(o.y+o.height-(a+C),0),width:b}:{})}if(h==="left"){var K={x:_-U,y:a+C/2,textAnchor:j,verticalAnchor:"middle"};return Qi(Qi({},K),o?{width:Math.max(K.x-o.x,0),height:C}:{})}if(h==="right"){var ee={x:_+b+U,y:a+C/2,textAnchor:G,verticalAnchor:"middle"};return Qi(Qi({},ee),o?{width:Math.max(o.x+o.width-ee.x,0),height:C}:{})}var ue=o?{width:b,height:C}:{};return h==="insideLeft"?Qi({x:_+U,y:a+C/2,textAnchor:G,verticalAnchor:"middle"},ue):h==="insideRight"?Qi({x:_+b-U,y:a+C/2,textAnchor:j,verticalAnchor:"middle"},ue):h==="insideTop"?Qi({x:_+b/2,y:a+O,textAnchor:"middle",verticalAnchor:N},ue):h==="insideBottom"?Qi({x:_+b/2,y:a+C-O,textAnchor:"middle",verticalAnchor:k},ue):h==="insideTopLeft"?Qi({x:_+U,y:a+O,textAnchor:G,verticalAnchor:N},ue):h==="insideTopRight"?Qi({x:_+b-U,y:a+O,textAnchor:j,verticalAnchor:N},ue):h==="insideBottomLeft"?Qi({x:_+U,y:a+C-O,textAnchor:G,verticalAnchor:k},ue):h==="insideBottomRight"?Qi({x:_+b-U,y:a+C-O,textAnchor:j,verticalAnchor:k},ue):Yg(h)&&(Qt(h.x)||xd(h.x))&&(Qt(h.y)||xd(h.y))?Qi({x:_+$d(h.x,b),y:a+$d(h.y,C),textAnchor:"end",verticalAnchor:"end"},ue):Qi({x:_+b/2,y:a+C/2,textAnchor:"middle",verticalAnchor:"middle"},ue)},uPe=function(t){return"cx"in t&&Qt(t.cx)};function zo(e){var t=e.offset,n=t===void 0?5:t,o=JCe(e,qCe),u=Qi({offset:n},o),h=u.viewBox,p=u.position,_=u.value,a=u.children,b=u.content,C=u.className,A=C===void 0?"":C,O=u.textBreakAll;if(!h||Tr(_)&&Tr(a)&&!W.isValidElement(b)&&!hr(b))return null;if(W.isValidElement(b))return W.cloneElement(b,u);var k;if(hr(b)){if(k=W.createElement(b,u),W.isValidElement(k))return k}else k=iPe(u);var N=uPe(h),z=gr(u,!0);if(N&&(p==="insideStart"||p==="insideEnd"||p==="end"))return aPe(u,k,z);var U=N?sPe(u):lPe(u);return Ye.createElement(QS,H0({className:Cr("recharts-label",A)},z,U,{breakAll:O}),k)}zo.displayName="Label";var Xq=function(t){var n=t.cx,o=t.cy,u=t.angle,h=t.startAngle,p=t.endAngle,_=t.r,a=t.radius,b=t.innerRadius,C=t.outerRadius,A=t.x,O=t.y,k=t.top,N=t.left,z=t.width,U=t.height,j=t.clockWise,G=t.labelViewBox;if(G)return G;if(Qt(z)&&Qt(U)){if(Qt(A)&&Qt(O))return{x:A,y:O,width:z,height:U};if(Qt(k)&&Qt(N))return{x:k,y:N,width:z,height:U}}return Qt(A)&&Qt(O)?{x:A,y:O,width:0,height:0}:Qt(n)&&Qt(o)?{cx:n,cy:o,startAngle:h||u||0,endAngle:p||u||0,innerRadius:b||0,outerRadius:C||a||_||0,clockWise:j}:t.viewBox?t.viewBox:{}},cPe=function(t,n){return t?t===!0?Ye.createElement(zo,{key:"label-implicit",viewBox:n}):to(t)?Ye.createElement(zo,{key:"label-implicit",viewBox:n,value:t}):W.isValidElement(t)?t.type===zo?W.cloneElement(t,{key:"label-implicit",viewBox:n}):Ye.createElement(zo,{key:"label-implicit",content:t,viewBox:n}):hr(t)?Ye.createElement(zo,{key:"label-implicit",content:t,viewBox:n}):Yg(t)?Ye.createElement(zo,H0({viewBox:n},t,{key:"label-implicit"})):null:null},hPe=function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&o&&!t.label)return null;var u=t.children,h=Xq(t),p=rl(u,zo).map(function(a,b){return W.cloneElement(a,{viewBox:n||h,key:"label-".concat(b)})});if(!o)return p;var _=cPe(t.label,n||h);return[_].concat(ZCe(p))};zo.parseViewBox=Xq;zo.renderCallByParent=hPe;function fPe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var dPe=fPe;const pPe=Vr(dPe);function q0(e){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}var mPe=["valueAccessor"],gPe=["data","dataKey","clockWise","id","textBreakAll"];function yPe(e){return bPe(e)||xPe(e)||vPe(e)||_Pe()}function _Pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vPe(e,t){if(e){if(typeof e=="string")return w3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w3(e,t)}}function xPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bPe(e){if(Array.isArray(e))return w3(e)}function w3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function pT(){return pT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},pT.apply(this,arguments)}function z$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function F$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z$(Object(n),!0).forEach(function(o){wPe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function wPe(e,t,n){return t=SPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SPe(e){var t=TPe(e,"string");return q0(t)=="symbol"?t:t+""}function TPe(e,t){if(q0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(q0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N$(e,t){if(e==null)return{};var n=EPe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function EPe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}var APe=function(t){return Array.isArray(t.value)?pPe(t.value):t.value};function zh(e){var t=e.valueAccessor,n=t===void 0?APe:t,o=N$(e,mPe),u=o.data,h=o.dataKey,p=o.clockWise,_=o.id,a=o.textBreakAll,b=N$(o,gPe);return!u||!u.length?null:Ye.createElement(xi,{className:"recharts-label-list"},u.map(function(C,A){var O=Tr(h)?n(C,A):Ga(C&&C.payload,h),k=Tr(_)?{}:{id:"".concat(_,"-").concat(A)};return Ye.createElement(zo,pT({},gr(C,!0),b,k,{parentViewBox:C.parentViewBox,value:O,textBreakAll:a,viewBox:zo.parseViewBox(Tr(p)?C:F$(F$({},C),{},{clockWise:p})),key:"label-".concat(A),index:A}))}))}zh.displayName="LabelList";function CPe(e,t){return e?e===!0?Ye.createElement(zh,{key:"labelList-implicit",data:t}):Ye.isValidElement(e)||hr(e)?Ye.createElement(zh,{key:"labelList-implicit",data:t,content:e}):Yg(e)?Ye.createElement(zh,pT({data:t},e,{key:"labelList-implicit"})):null:null}function PPe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var o=e.children,u=rl(o,zh).map(function(p,_){return W.cloneElement(p,{data:t,key:"labelList-".concat(_)})});if(!n)return u;var h=CPe(e.label,t);return[h].concat(yPe(u))}zh.renderCallByParent=PPe;function Z0(e){"@babel/helpers - typeof";return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}function S3(){return S3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},S3.apply(this,arguments)}function B$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function j$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B$(Object(n),!0).forEach(function(o){MPe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function MPe(e,t,n){return t=IPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IPe(e){var t=OPe(e,"string");return Z0(t)=="symbol"?t:t+""}function OPe(e,t){if(Z0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Z0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RPe=function(t,n){var o=Js(n-t),u=Math.min(Math.abs(n-t),359.999);return o*u},Ow=function(t){var n=t.cx,o=t.cy,u=t.radius,h=t.angle,p=t.sign,_=t.isExternal,a=t.cornerRadius,b=t.cornerIsExternal,C=a*(_?1:-1)+u,A=Math.asin(a/C)/dT,O=b?h:h+p*A,k=wo(n,o,C,O),N=wo(n,o,u,O),z=b?h-p*A:h,U=wo(n,o,C*Math.cos(A*dT),z);return{center:k,circleTangency:N,lineTangency:U,theta:A}},Yq=function(t){var n=t.cx,o=t.cy,u=t.innerRadius,h=t.outerRadius,p=t.startAngle,_=t.endAngle,a=RPe(p,_),b=p+a,C=wo(n,o,h,p),A=wo(n,o,h,b),O="M ".concat(C.x,",").concat(C.y,`
    A `).concat(h,",").concat(h,`,0,
    `).concat(+(Math.abs(a)>180),",").concat(+(p>b),`,
    `).concat(A.x,",").concat(A.y,`
  `);if(u>0){var k=wo(n,o,u,p),N=wo(n,o,u,b);O+="L ".concat(N.x,",").concat(N.y,`
            A `).concat(u,",").concat(u,`,0,
            `).concat(+(Math.abs(a)>180),",").concat(+(p<=b),`,
            `).concat(k.x,",").concat(k.y," Z")}else O+="L ".concat(n,",").concat(o," Z");return O},kPe=function(t){var n=t.cx,o=t.cy,u=t.innerRadius,h=t.outerRadius,p=t.cornerRadius,_=t.forceCornerRadius,a=t.cornerIsExternal,b=t.startAngle,C=t.endAngle,A=Js(C-b),O=Ow({cx:n,cy:o,radius:h,angle:b,sign:A,cornerRadius:p,cornerIsExternal:a}),k=O.circleTangency,N=O.lineTangency,z=O.theta,U=Ow({cx:n,cy:o,radius:h,angle:C,sign:-A,cornerRadius:p,cornerIsExternal:a}),j=U.circleTangency,G=U.lineTangency,H=U.theta,Y=a?Math.abs(b-C):Math.abs(b-C)-z-H;if(Y<0)return _?"M ".concat(N.x,",").concat(N.y,`
        a`).concat(p,",").concat(p,",0,0,1,").concat(p*2,`,0
        a`).concat(p,",").concat(p,",0,0,1,").concat(-p*2,`,0
      `):Yq({cx:n,cy:o,innerRadius:u,outerRadius:h,startAngle:b,endAngle:C});var K="M ".concat(N.x,",").concat(N.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(k.x,",").concat(k.y,`
    A`).concat(h,",").concat(h,",0,").concat(+(Y>180),",").concat(+(A<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(G.x,",").concat(G.y,`
  `);if(u>0){var ee=Ow({cx:n,cy:o,radius:u,angle:b,sign:A,isExternal:!0,cornerRadius:p,cornerIsExternal:a}),ue=ee.circleTangency,ve=ee.lineTangency,Fe=ee.theta,Ne=Ow({cx:n,cy:o,radius:u,angle:C,sign:-A,isExternal:!0,cornerRadius:p,cornerIsExternal:a}),Oe=Ne.circleTangency,Le=Ne.lineTangency,Ue=Ne.theta,et=a?Math.abs(b-C):Math.abs(b-C)-Fe-Ue;if(et<0&&p===0)return"".concat(K,"L").concat(n,",").concat(o,"Z");K+="L".concat(Le.x,",").concat(Le.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(Oe.x,",").concat(Oe.y,`
      A`).concat(u,",").concat(u,",0,").concat(+(et>180),",").concat(+(A>0),",").concat(ue.x,",").concat(ue.y,`
      A`).concat(p,",").concat(p,",0,0,").concat(+(A<0),",").concat(ve.x,",").concat(ve.y,"Z")}else K+="L".concat(n,",").concat(o,"Z");return K},DPe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Kq=function(t){var n=j$(j$({},DPe),t),o=n.cx,u=n.cy,h=n.innerRadius,p=n.outerRadius,_=n.cornerRadius,a=n.forceCornerRadius,b=n.cornerIsExternal,C=n.startAngle,A=n.endAngle,O=n.className;if(p<h||C===A)return null;var k=Cr("recharts-sector",O),N=p-h,z=$d(_,N,0,!0),U;return z>0&&Math.abs(C-A)<360?U=kPe({cx:o,cy:u,innerRadius:h,outerRadius:p,cornerRadius:Math.min(z,N/2),forceCornerRadius:a,cornerIsExternal:b,startAngle:C,endAngle:A}):U=Yq({cx:o,cy:u,innerRadius:h,outerRadius:p,startAngle:C,endAngle:A}),Ye.createElement("path",S3({},gr(n,!0),{className:k,d:U,role:"img"}))};function X0(e){"@babel/helpers - typeof";return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(e)}function T3(){return T3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},T3.apply(this,arguments)}function $$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function U$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$$(Object(n),!0).forEach(function(o){LPe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$$(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function LPe(e,t,n){return t=zPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zPe(e){var t=FPe(e,"string");return X0(t)=="symbol"?t:t+""}function FPe(e,t){if(X0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(X0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V$={curveBasisClosed:Dme,curveBasisOpen:Lme,curveBasis:kme,curveBumpX:vme,curveBumpY:xme,curveLinearClosed:zme,curveLinear:$E,curveMonotoneX:Fme,curveMonotoneY:Nme,curveNatural:Bme,curveStep:jme,curveStepAfter:Ume,curveStepBefore:$me},Rw=function(t){return t.x===+t.x&&t.y===+t.y},Tv=function(t){return t.x},Ev=function(t){return t.y},NPe=function(t,n){if(hr(t))return t;var o="curve".concat(BE(t));return(o==="curveMonotone"||o==="curveBump")&&n?V$["".concat(o).concat(n==="vertical"?"Y":"X")]:V$[o]||$E},BPe=function(t){var n=t.type,o=n===void 0?"linear":n,u=t.points,h=u===void 0?[]:u,p=t.baseLine,_=t.layout,a=t.connectNulls,b=a===void 0?!1:a,C=NPe(o,_),A=b?h.filter(function(z){return Rw(z)}):h,O;if(Array.isArray(p)){var k=b?p.filter(function(z){return Rw(z)}):p,N=A.map(function(z,U){return U$(U$({},z),{},{base:k[U]})});return _==="vertical"?O=ww().y(Ev).x1(Tv).x0(function(z){return z.base.x}):O=ww().x(Tv).y1(Ev).y0(function(z){return z.base.y}),O.defined(Rw).curve(C),O(N)}return _==="vertical"&&Qt(p)?O=ww().y(Ev).x1(Tv).x0(p):Qt(p)?O=ww().x(Tv).y1(Ev).y0(p):O=KH().x(Tv).y(Ev),O.defined(Rw).curve(C),O(A)},e0=function(t){var n=t.className,o=t.points,u=t.path,h=t.pathRef;if((!o||!o.length)&&!u)return null;var p=o&&o.length?BPe(t):u;return Ye.createElement("path",T3({},gr(t,!1),FS(t),{className:Cr("recharts-curve",n),d:p,ref:h}))},jPe=Object.getOwnPropertyNames,$Pe=Object.getOwnPropertySymbols,UPe=Object.prototype.hasOwnProperty;function G$(e,t){return function(o,u,h){return e(o,u,h)&&t(o,u,h)}}function kw(e){return function(n,o,u){if(!n||!o||typeof n!="object"||typeof o!="object")return e(n,o,u);var h=u.cache,p=h.get(n),_=h.get(o);if(p&&_)return p===o&&_===n;h.set(n,o),h.set(o,n);var a=e(n,o,u);return h.delete(n),h.delete(o),a}}function W$(e){return jPe(e).concat($Pe(e))}var Qq=Object.hasOwn||function(e,t){return UPe.call(e,t)};function sy(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var Jq="_owner",H$=Object.getOwnPropertyDescriptor,q$=Object.keys;function VPe(e,t,n){var o=e.length;if(t.length!==o)return!1;for(;o-- >0;)if(!n.equals(e[o],t[o],o,o,e,t,n))return!1;return!0}function GPe(e,t){return sy(e.getTime(),t.getTime())}function Z$(e,t,n){if(e.size!==t.size)return!1;for(var o={},u=e.entries(),h=0,p,_;(p=u.next())&&!p.done;){for(var a=t.entries(),b=!1,C=0;(_=a.next())&&!_.done;){var A=p.value,O=A[0],k=A[1],N=_.value,z=N[0],U=N[1];!b&&!o[C]&&(b=n.equals(O,z,h,C,e,t,n)&&n.equals(k,U,O,z,e,t,n))&&(o[C]=!0),C++}if(!b)return!1;h++}return!0}function WPe(e,t,n){var o=q$(e),u=o.length;if(q$(t).length!==u)return!1;for(var h;u-- >0;)if(h=o[u],h===Jq&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Qq(t,h)||!n.equals(e[h],t[h],h,h,e,t,n))return!1;return!0}function Av(e,t,n){var o=W$(e),u=o.length;if(W$(t).length!==u)return!1;for(var h,p,_;u-- >0;)if(h=o[u],h===Jq&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Qq(t,h)||!n.equals(e[h],t[h],h,h,e,t,n)||(p=H$(e,h),_=H$(t,h),(p||_)&&(!p||!_||p.configurable!==_.configurable||p.enumerable!==_.enumerable||p.writable!==_.writable)))return!1;return!0}function HPe(e,t){return sy(e.valueOf(),t.valueOf())}function qPe(e,t){return e.source===t.source&&e.flags===t.flags}function X$(e,t,n){if(e.size!==t.size)return!1;for(var o={},u=e.values(),h,p;(h=u.next())&&!h.done;){for(var _=t.values(),a=!1,b=0;(p=_.next())&&!p.done;)!a&&!o[b]&&(a=n.equals(h.value,p.value,h.value,p.value,e,t,n))&&(o[b]=!0),b++;if(!a)return!1}return!0}function ZPe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}var XPe="[object Arguments]",YPe="[object Boolean]",KPe="[object Date]",QPe="[object Map]",JPe="[object Number]",eMe="[object Object]",tMe="[object RegExp]",nMe="[object Set]",rMe="[object String]",iMe=Array.isArray,Y$=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,K$=Object.assign,oMe=Object.prototype.toString.call.bind(Object.prototype.toString);function aMe(e){var t=e.areArraysEqual,n=e.areDatesEqual,o=e.areMapsEqual,u=e.areObjectsEqual,h=e.arePrimitiveWrappersEqual,p=e.areRegExpsEqual,_=e.areSetsEqual,a=e.areTypedArraysEqual;return function(C,A,O){if(C===A)return!0;if(C==null||A==null||typeof C!="object"||typeof A!="object")return C!==C&&A!==A;var k=C.constructor;if(k!==A.constructor)return!1;if(k===Object)return u(C,A,O);if(iMe(C))return t(C,A,O);if(Y$!=null&&Y$(C))return a(C,A,O);if(k===Date)return n(C,A,O);if(k===RegExp)return p(C,A,O);if(k===Map)return o(C,A,O);if(k===Set)return _(C,A,O);var N=oMe(C);return N===KPe?n(C,A,O):N===tMe?p(C,A,O):N===QPe?o(C,A,O):N===nMe?_(C,A,O):N===eMe?typeof C.then!="function"&&typeof A.then!="function"&&u(C,A,O):N===XPe?u(C,A,O):N===YPe||N===JPe||N===rMe?h(C,A,O):!1}}function sMe(e){var t=e.circular,n=e.createCustomConfig,o=e.strict,u={areArraysEqual:o?Av:VPe,areDatesEqual:GPe,areMapsEqual:o?G$(Z$,Av):Z$,areObjectsEqual:o?Av:WPe,arePrimitiveWrappersEqual:HPe,areRegExpsEqual:qPe,areSetsEqual:o?G$(X$,Av):X$,areTypedArraysEqual:o?Av:ZPe};if(n&&(u=K$({},u,n(u))),t){var h=kw(u.areArraysEqual),p=kw(u.areMapsEqual),_=kw(u.areObjectsEqual),a=kw(u.areSetsEqual);u=K$({},u,{areArraysEqual:h,areMapsEqual:p,areObjectsEqual:_,areSetsEqual:a})}return u}function lMe(e){return function(t,n,o,u,h,p,_){return e(t,n,_)}}function uMe(e){var t=e.circular,n=e.comparator,o=e.createState,u=e.equals,h=e.strict;if(o)return function(a,b){var C=o(),A=C.cache,O=A===void 0?t?new WeakMap:void 0:A,k=C.meta;return n(a,b,{cache:O,equals:u,meta:k,strict:h})};if(t)return function(a,b){return n(a,b,{cache:new WeakMap,equals:u,meta:void 0,strict:h})};var p={cache:void 0,equals:u,meta:void 0,strict:h};return function(a,b){return n(a,b,p)}}var cMe=Jh();Jh({strict:!0});Jh({circular:!0});Jh({circular:!0,strict:!0});Jh({createInternalComparator:function(){return sy}});Jh({strict:!0,createInternalComparator:function(){return sy}});Jh({circular:!0,createInternalComparator:function(){return sy}});Jh({circular:!0,createInternalComparator:function(){return sy},strict:!0});function Jh(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,o=e.createInternalComparator,u=e.createState,h=e.strict,p=h===void 0?!1:h,_=sMe(e),a=aMe(_),b=o?o(a):lMe(a);return uMe({circular:n,comparator:a,createState:u,equals:b,strict:p})}function hMe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Q$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,o=function u(h){n<0&&(n=h),h-n>t?(e(h),n=-1):hMe(u)};requestAnimationFrame(o)}function E3(e){"@babel/helpers - typeof";return E3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E3(e)}function fMe(e){return gMe(e)||mMe(e)||pMe(e)||dMe()}function dMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pMe(e,t){if(e){if(typeof e=="string")return J$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J$(e,t)}}function J$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function mMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gMe(e){if(Array.isArray(e))return e}function yMe(){var e={},t=function(){return null},n=!1,o=function u(h){if(!n){if(Array.isArray(h)){if(!h.length)return;var p=h,_=fMe(p),a=_[0],b=_.slice(1);if(typeof a=="number"){Q$(u.bind(null,b),a);return}u(a),Q$(u.bind(null,b));return}E3(h)==="object"&&(e=h,t(e)),typeof h=="function"&&h()}};return{stop:function(){n=!0},start:function(h){n=!1,o(h)},subscribe:function(h){return t=h,function(){t=function(){return null}}}}}function Y0(e){"@babel/helpers - typeof";return Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y0(e)}function e6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function t6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e6(Object(n),!0).forEach(function(o){eZ(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function eZ(e,t,n){return t=_Me(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Me(e){var t=vMe(e,"string");return Y0(t)==="symbol"?t:String(t)}function vMe(e,t){if(Y0(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Y0(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xMe=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(o,u){return o.filter(function(h){return u.includes(h)})})},bMe=function(t){return t},wMe=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},t0=function(t,n){return Object.keys(n).reduce(function(o,u){return t6(t6({},o),{},eZ({},u,t(u,n[u])))},{})},n6=function(t,n,o){return t.map(function(u){return"".concat(wMe(u)," ").concat(n,"ms ").concat(o)}).join(",")};function SMe(e,t){return AMe(e)||EMe(e,t)||tZ(e,t)||TMe()}function TMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function AMe(e){if(Array.isArray(e))return e}function CMe(e){return IMe(e)||MMe(e)||tZ(e)||PMe()}function PMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tZ(e,t){if(e){if(typeof e=="string")return A3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A3(e,t)}}function MMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IMe(e){if(Array.isArray(e))return A3(e)}function A3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var mT=1e-4,nZ=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},rZ=function(t,n){return t.map(function(o,u){return o*Math.pow(n,u)}).reduce(function(o,u){return o+u})},r6=function(t,n){return function(o){var u=nZ(t,n);return rZ(u,o)}},OMe=function(t,n){return function(o){var u=nZ(t,n),h=[].concat(CMe(u.map(function(p,_){return p*_}).slice(1)),[0]);return rZ(h,o)}},i6=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var u=n[0],h=n[1],p=n[2],_=n[3];if(n.length===1)switch(n[0]){case"linear":u=0,h=0,p=1,_=1;break;case"ease":u=.25,h=.1,p=.25,_=1;break;case"ease-in":u=.42,h=0,p=1,_=1;break;case"ease-out":u=.42,h=0,p=.58,_=1;break;case"ease-in-out":u=0,h=0,p=.58,_=1;break;default:{var a=n[0].split("(");if(a[0]==="cubic-bezier"&&a[1].split(")")[0].split(",").length===4){var b=a[1].split(")")[0].split(",").map(function(U){return parseFloat(U)}),C=SMe(b,4);u=C[0],h=C[1],p=C[2],_=C[3]}}}var A=r6(u,p),O=r6(h,_),k=OMe(u,p),N=function(j){return j>1?1:j<0?0:j},z=function(j){for(var G=j>1?1:j,H=G,Y=0;Y<8;++Y){var K=A(H)-G,ee=k(H);if(Math.abs(K-G)<mT||ee<mT)return O(H);H=N(H-K/ee)}return O(H)};return z.isStepper=!1,z},RMe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,o=n===void 0?100:n,u=t.damping,h=u===void 0?8:u,p=t.dt,_=p===void 0?17:p,a=function(C,A,O){var k=-(C-A)*o,N=O*h,z=O+(k-N)*_/1e3,U=O*_/1e3+C;return Math.abs(U-A)<mT&&Math.abs(z)<mT?[A,0]:[U,z]};return a.isStepper=!0,a.dt=_,a},kMe=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var u=n[0];if(typeof u=="string")switch(u){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return i6(u);case"spring":return RMe();default:if(u.split("(")[0]==="cubic-bezier")return i6(u)}return typeof u=="function"?u:null};function K0(e){"@babel/helpers - typeof";return K0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K0(e)}function o6(e){return zMe(e)||LMe(e)||iZ(e)||DMe()}function DMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zMe(e){if(Array.isArray(e))return P3(e)}function a6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function xo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?a6(Object(n),!0).forEach(function(o){C3(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function C3(e,t,n){return t=FMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FMe(e){var t=NMe(e,"string");return K0(t)==="symbol"?t:String(t)}function NMe(e,t){if(K0(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(K0(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BMe(e,t){return UMe(e)||$Me(e,t)||iZ(e,t)||jMe()}function jMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iZ(e,t){if(e){if(typeof e=="string")return P3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P3(e,t)}}function P3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function $Me(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function UMe(e){if(Array.isArray(e))return e}var gT=function(t,n,o){return t+(n-t)*o},M3=function(t){var n=t.from,o=t.to;return n!==o},VMe=function e(t,n,o){var u=t0(function(h,p){if(M3(p)){var _=t(p.from,p.to,p.velocity),a=BMe(_,2),b=a[0],C=a[1];return xo(xo({},p),{},{from:b,velocity:C})}return p},n);return o<1?t0(function(h,p){return M3(p)?xo(xo({},p),{},{velocity:gT(p.velocity,u[h].velocity,o),from:gT(p.from,u[h].from,o)}):p},n):e(t,u,o-1)};const GMe=function(e,t,n,o,u){var h=xMe(e,t),p=h.reduce(function(U,j){return xo(xo({},U),{},C3({},j,[e[j],t[j]]))},{}),_=h.reduce(function(U,j){return xo(xo({},U),{},C3({},j,{from:e[j],velocity:0,to:t[j]}))},{}),a=-1,b,C,A=function(){return null},O=function(){return t0(function(j,G){return G.from},_)},k=function(){return!Object.values(_).filter(M3).length},N=function(j){b||(b=j);var G=j-b,H=G/n.dt;_=VMe(n,_,H),u(xo(xo(xo({},e),t),O())),b=j,k()||(a=requestAnimationFrame(A))},z=function(j){C||(C=j);var G=(j-C)/o,H=t0(function(K,ee){return gT.apply(void 0,o6(ee).concat([n(G)]))},p);if(u(xo(xo(xo({},e),t),H)),G<1)a=requestAnimationFrame(A);else{var Y=t0(function(K,ee){return gT.apply(void 0,o6(ee).concat([n(1)]))},p);u(xo(xo(xo({},e),t),Y))}};return A=n.isStepper?N:z,function(){return requestAnimationFrame(A),function(){cancelAnimationFrame(a)}}};function Ag(e){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}var WMe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function HMe(e,t){if(e==null)return{};var n=qMe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function qMe(e,t){if(e==null)return{};var n={},o=Object.keys(e),u,h;for(h=0;h<o.length;h++)u=o[h],!(t.indexOf(u)>=0)&&(n[u]=e[u]);return n}function HM(e){return KMe(e)||YMe(e)||XMe(e)||ZMe()}function ZMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XMe(e,t){if(e){if(typeof e=="string")return I3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I3(e,t)}}function YMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KMe(e){if(Array.isArray(e))return I3(e)}function I3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function s6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function qs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?s6(Object(n),!0).forEach(function(o){zv(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function zv(e,t,n){return t=oZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JMe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,oZ(o.key),o)}}function eIe(e,t,n){return t&&JMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oZ(e){var t=tIe(e,"string");return Ag(t)==="symbol"?t:String(t)}function tIe(e,t){if(Ag(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Ag(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O3(e,t)}function O3(e,t){return O3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},O3(e,t)}function rIe(e){var t=iIe();return function(){var o=yT(e),u;if(t){var h=yT(this).constructor;u=Reflect.construct(o,arguments,h)}else u=o.apply(this,arguments);return R3(this,u)}}function R3(e,t){if(t&&(Ag(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k3(e)}function k3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yT(e){return yT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},yT(e)}var Ku=function(e){nIe(n,e);var t=rIe(n);function n(o,u){var h;QMe(this,n),h=t.call(this,o,u);var p=h.props,_=p.isActive,a=p.attributeName,b=p.from,C=p.to,A=p.steps,O=p.children,k=p.duration;if(h.handleStyleChange=h.handleStyleChange.bind(k3(h)),h.changeStyle=h.changeStyle.bind(k3(h)),!_||k<=0)return h.state={style:{}},typeof O=="function"&&(h.state={style:C}),R3(h);if(A&&A.length)h.state={style:A[0].style};else if(b){if(typeof O=="function")return h.state={style:b},R3(h);h.state={style:a?zv({},a,b):b}}else h.state={style:{}};return h}return eIe(n,[{key:"componentDidMount",value:function(){var u=this.props,h=u.isActive,p=u.canBegin;this.mounted=!0,!(!h||!p)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(u){var h=this.props,p=h.isActive,_=h.canBegin,a=h.attributeName,b=h.shouldReAnimate,C=h.to,A=h.from,O=this.state.style;if(_){if(!p){var k={style:a?zv({},a,C):C};this.state&&O&&(a&&O[a]!==C||!a&&O!==C)&&this.setState(k);return}if(!(cMe(u.to,C)&&u.canBegin&&u.isActive)){var N=!u.canBegin||!u.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var z=N||b?A:u.to;if(this.state&&O){var U={style:a?zv({},a,z):z};(a&&O[a]!==z||!a&&O!==z)&&this.setState(U)}this.runAnimation(qs(qs({},this.props),{},{from:z,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var u=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),u&&u()}},{key:"handleStyleChange",value:function(u){this.changeStyle(u)}},{key:"changeStyle",value:function(u){this.mounted&&this.setState({style:u})}},{key:"runJSAnimation",value:function(u){var h=this,p=u.from,_=u.to,a=u.duration,b=u.easing,C=u.begin,A=u.onAnimationEnd,O=u.onAnimationStart,k=GMe(p,_,kMe(b),a,this.changeStyle),N=function(){h.stopJSAnimation=k()};this.manager.start([O,C,N,a,A])}},{key:"runStepAnimation",value:function(u){var h=this,p=u.steps,_=u.begin,a=u.onAnimationStart,b=p[0],C=b.style,A=b.duration,O=A===void 0?0:A,k=function(z,U,j){if(j===0)return z;var G=U.duration,H=U.easing,Y=H===void 0?"ease":H,K=U.style,ee=U.properties,ue=U.onAnimationEnd,ve=j>0?p[j-1]:U,Fe=ee||Object.keys(K);if(typeof Y=="function"||Y==="spring")return[].concat(HM(z),[h.runJSAnimation.bind(h,{from:ve.style,to:K,duration:G,easing:Y}),G]);var Ne=n6(Fe,G,Y),Oe=qs(qs(qs({},ve.style),K),{},{transition:Ne});return[].concat(HM(z),[Oe,G,ue]).filter(bMe)};return this.manager.start([a].concat(HM(p.reduce(k,[C,Math.max(O,_)])),[u.onAnimationEnd]))}},{key:"runAnimation",value:function(u){this.manager||(this.manager=yMe());var h=u.begin,p=u.duration,_=u.attributeName,a=u.to,b=u.easing,C=u.onAnimationStart,A=u.onAnimationEnd,O=u.steps,k=u.children,N=this.manager;if(this.unSubscribe=N.subscribe(this.handleStyleChange),typeof b=="function"||typeof k=="function"||b==="spring"){this.runJSAnimation(u);return}if(O.length>1){this.runStepAnimation(u);return}var z=_?zv({},_,a):a,U=n6(Object.keys(z),p,b);N.start([C,h,qs(qs({},z),{},{transition:U}),p,A])}},{key:"render",value:function(){var u=this.props,h=u.children;u.begin;var p=u.duration;u.attributeName,u.easing;var _=u.isActive;u.steps,u.from,u.to,u.canBegin,u.onAnimationEnd,u.shouldReAnimate,u.onAnimationReStart;var a=HMe(u,WMe),b=W.Children.count(h),C=this.state.style;if(typeof h=="function")return h(C);if(!_||b===0||p<=0)return h;var A=function(k){var N=k.props,z=N.style,U=z===void 0?{}:z,j=N.className,G=W.cloneElement(k,qs(qs({},a),{},{style:qs(qs({},U),C),className:j}));return G};return b===1?A(W.Children.only(h)):Ye.createElement("div",null,W.Children.map(h,function(O){return A(O)}))}}]),n}(W.PureComponent);Ku.displayName="Animate";Ku.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ku.propTypes={from:En.oneOfType([En.object,En.string]),to:En.oneOfType([En.object,En.string]),attributeName:En.string,duration:En.number,begin:En.number,easing:En.oneOfType([En.string,En.func]),steps:En.arrayOf(En.shape({duration:En.number.isRequired,style:En.object.isRequired,easing:En.oneOfType([En.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),En.func]),properties:En.arrayOf("string"),onAnimationEnd:En.func})),children:En.oneOfType([En.node,En.func]),isActive:En.bool,canBegin:En.bool,onAnimationEnd:En.func,shouldReAnimate:En.bool,onAnimationStart:En.func,onAnimationReStart:En.func};En.object,En.object,En.object,En.element;En.object,En.object,En.object,En.oneOfType([En.array,En.element]),En.any;function Q0(e){"@babel/helpers - typeof";return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(e)}function _T(){return _T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_T.apply(this,arguments)}function oIe(e,t){return uIe(e)||lIe(e,t)||sIe(e,t)||aIe()}function aIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sIe(e,t){if(e){if(typeof e=="string")return l6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l6(e,t)}}function l6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function lIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function uIe(e){if(Array.isArray(e))return e}function u6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function c6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u6(Object(n),!0).forEach(function(o){cIe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function cIe(e,t,n){return t=hIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hIe(e){var t=fIe(e,"string");return Q0(t)=="symbol"?t:t+""}function fIe(e,t){if(Q0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Q0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h6=function(t,n,o,u,h){var p=Math.min(Math.abs(o)/2,Math.abs(u)/2),_=u>=0?1:-1,a=o>=0?1:-1,b=u>=0&&o>=0||u<0&&o<0?1:0,C;if(p>0&&h instanceof Array){for(var A=[0,0,0,0],O=0,k=4;O<k;O++)A[O]=h[O]>p?p:h[O];C="M".concat(t,",").concat(n+_*A[0]),A[0]>0&&(C+="A ".concat(A[0],",").concat(A[0],",0,0,").concat(b,",").concat(t+a*A[0],",").concat(n)),C+="L ".concat(t+o-a*A[1],",").concat(n),A[1]>0&&(C+="A ".concat(A[1],",").concat(A[1],",0,0,").concat(b,`,
        `).concat(t+o,",").concat(n+_*A[1])),C+="L ".concat(t+o,",").concat(n+u-_*A[2]),A[2]>0&&(C+="A ".concat(A[2],",").concat(A[2],",0,0,").concat(b,`,
        `).concat(t+o-a*A[2],",").concat(n+u)),C+="L ".concat(t+a*A[3],",").concat(n+u),A[3]>0&&(C+="A ".concat(A[3],",").concat(A[3],",0,0,").concat(b,`,
        `).concat(t,",").concat(n+u-_*A[3])),C+="Z"}else if(p>0&&h===+h&&h>0){var N=Math.min(p,h);C="M ".concat(t,",").concat(n+_*N,`
            A `).concat(N,",").concat(N,",0,0,").concat(b,",").concat(t+a*N,",").concat(n,`
            L `).concat(t+o-a*N,",").concat(n,`
            A `).concat(N,",").concat(N,",0,0,").concat(b,",").concat(t+o,",").concat(n+_*N,`
            L `).concat(t+o,",").concat(n+u-_*N,`
            A `).concat(N,",").concat(N,",0,0,").concat(b,",").concat(t+o-a*N,",").concat(n+u,`
            L `).concat(t+a*N,",").concat(n+u,`
            A `).concat(N,",").concat(N,",0,0,").concat(b,",").concat(t,",").concat(n+u-_*N," Z")}else C="M ".concat(t,",").concat(n," h ").concat(o," v ").concat(u," h ").concat(-o," Z");return C},dIe=function(t,n){if(!t||!n)return!1;var o=t.x,u=t.y,h=n.x,p=n.y,_=n.width,a=n.height;if(Math.abs(_)>0&&Math.abs(a)>0){var b=Math.min(h,h+_),C=Math.max(h,h+_),A=Math.min(p,p+a),O=Math.max(p,p+a);return o>=b&&o<=C&&u>=A&&u<=O}return!1},pIe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},VD=function(t){var n=c6(c6({},pIe),t),o=W.useRef(),u=W.useState(-1),h=oIe(u,2),p=h[0],_=h[1];W.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var Y=o.current.getTotalLength();Y&&_(Y)}catch{}},[]);var a=n.x,b=n.y,C=n.width,A=n.height,O=n.radius,k=n.className,N=n.animationEasing,z=n.animationDuration,U=n.animationBegin,j=n.isAnimationActive,G=n.isUpdateAnimationActive;if(a!==+a||b!==+b||C!==+C||A!==+A||C===0||A===0)return null;var H=Cr("recharts-rectangle",k);return G?Ye.createElement(Ku,{canBegin:p>0,from:{width:C,height:A,x:a,y:b},to:{width:C,height:A,x:a,y:b},duration:z,animationEasing:N,isActive:G},function(Y){var K=Y.width,ee=Y.height,ue=Y.x,ve=Y.y;return Ye.createElement(Ku,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:U,duration:z,isActive:j,easing:N},Ye.createElement("path",_T({},gr(n,!0),{className:H,d:h6(ue,ve,K,ee,O),ref:o})))}):Ye.createElement("path",_T({},gr(n,!0),{className:H,d:h6(a,b,C,A,O)}))};function D3(){return D3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},D3.apply(this,arguments)}var GD=function(t){var n=t.cx,o=t.cy,u=t.r,h=t.className,p=Cr("recharts-dot",h);return n===+n&&o===+o&&u===+u?Ye.createElement("circle",D3({},gr(t,!1),FS(t),{className:p,cx:n,cy:o,r:u})):null};function J0(e){"@babel/helpers - typeof";return J0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J0(e)}var mIe=["x","y","top","left","width","height","className"];function L3(){return L3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},L3.apply(this,arguments)}function f6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function gIe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f6(Object(n),!0).forEach(function(o){yIe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function yIe(e,t,n){return t=_Ie(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Ie(e){var t=vIe(e,"string");return J0(t)=="symbol"?t:t+""}function vIe(e,t){if(J0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(J0(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xIe(e,t){if(e==null)return{};var n=bIe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function bIe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}var wIe=function(t,n,o,u,h,p){return"M".concat(t,",").concat(h,"v").concat(u,"M").concat(p,",").concat(n,"h").concat(o)},SIe=function(t){var n=t.x,o=n===void 0?0:n,u=t.y,h=u===void 0?0:u,p=t.top,_=p===void 0?0:p,a=t.left,b=a===void 0?0:a,C=t.width,A=C===void 0?0:C,O=t.height,k=O===void 0?0:O,N=t.className,z=xIe(t,mIe),U=gIe({x:o,y:h,top:_,left:b,width:A,height:k},z);return!Qt(o)||!Qt(h)||!Qt(A)||!Qt(k)||!Qt(_)||!Qt(b)?null:Ye.createElement("path",L3({},gr(U,!0),{className:Cr("recharts-cross",N),d:wIe(o,h,A,k,_,b)}))},TIe=b9,EIe=TIe(Object.getPrototypeOf,Object),AIe=EIe,CIe=rc,PIe=AIe,MIe=ic,IIe="[object Object]",OIe=Function.prototype,RIe=Object.prototype,aZ=OIe.toString,kIe=RIe.hasOwnProperty,DIe=aZ.call(Object);function LIe(e){if(!MIe(e)||CIe(e)!=IIe)return!1;var t=PIe(e);if(t===null)return!0;var n=kIe.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&aZ.call(n)==DIe}var zIe=LIe;const FIe=Vr(zIe);var NIe=rc,BIe=ic,jIe="[object Boolean]";function $Ie(e){return e===!0||e===!1||BIe(e)&&NIe(e)==jIe}var UIe=$Ie;const VIe=Vr(UIe);function ex(e){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(e)}function vT(){return vT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},vT.apply(this,arguments)}function GIe(e,t){return ZIe(e)||qIe(e,t)||HIe(e,t)||WIe()}function WIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HIe(e,t){if(e){if(typeof e=="string")return d6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d6(e,t)}}function d6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function qIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function ZIe(e){if(Array.isArray(e))return e}function p6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function m6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p6(Object(n),!0).forEach(function(o){XIe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function XIe(e,t,n){return t=YIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YIe(e){var t=KIe(e,"string");return ex(t)=="symbol"?t:t+""}function KIe(e,t){if(ex(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(ex(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g6=function(t,n,o,u,h){var p=o-u,_;return _="M ".concat(t,",").concat(n),_+="L ".concat(t+o,",").concat(n),_+="L ".concat(t+o-p/2,",").concat(n+h),_+="L ".concat(t+o-p/2-u,",").concat(n+h),_+="L ".concat(t,",").concat(n," Z"),_},QIe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},JIe=function(t){var n=m6(m6({},QIe),t),o=W.useRef(),u=W.useState(-1),h=GIe(u,2),p=h[0],_=h[1];W.useEffect(function(){if(o.current&&o.current.getTotalLength)try{var H=o.current.getTotalLength();H&&_(H)}catch{}},[]);var a=n.x,b=n.y,C=n.upperWidth,A=n.lowerWidth,O=n.height,k=n.className,N=n.animationEasing,z=n.animationDuration,U=n.animationBegin,j=n.isUpdateAnimationActive;if(a!==+a||b!==+b||C!==+C||A!==+A||O!==+O||C===0&&A===0||O===0)return null;var G=Cr("recharts-trapezoid",k);return j?Ye.createElement(Ku,{canBegin:p>0,from:{upperWidth:0,lowerWidth:0,height:O,x:a,y:b},to:{upperWidth:C,lowerWidth:A,height:O,x:a,y:b},duration:z,animationEasing:N,isActive:j},function(H){var Y=H.upperWidth,K=H.lowerWidth,ee=H.height,ue=H.x,ve=H.y;return Ye.createElement(Ku,{canBegin:p>0,from:"0px ".concat(p===-1?1:p,"px"),to:"".concat(p,"px 0px"),attributeName:"strokeDasharray",begin:U,duration:z,easing:N},Ye.createElement("path",vT({},gr(n,!0),{className:G,d:g6(ue,ve,Y,K,ee),ref:o})))}):Ye.createElement("g",null,Ye.createElement("path",vT({},gr(n,!0),{className:G,d:g6(a,b,C,A,O)})))},eOe=["option","shapeType","propTransformer","activeClassName","isActive"];function tx(e){"@babel/helpers - typeof";return tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tx(e)}function tOe(e,t){if(e==null)return{};var n=nOe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function nOe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function y6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function xT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y6(Object(n),!0).forEach(function(o){rOe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function rOe(e,t,n){return t=iOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iOe(e){var t=oOe(e,"string");return tx(t)=="symbol"?t:t+""}function oOe(e,t){if(tx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(tx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aOe(e,t){return xT(xT({},t),e)}function sOe(e,t){return e==="symbols"}function _6(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return Ye.createElement(VD,n);case"trapezoid":return Ye.createElement(JIe,n);case"sector":return Ye.createElement(Kq,n);case"symbols":if(sOe(t))return Ye.createElement(lD,n);break;default:return null}}function lOe(e){return W.isValidElement(e)?e.props:e}function uOe(e){var t=e.option,n=e.shapeType,o=e.propTransformer,u=o===void 0?aOe:o,h=e.activeClassName,p=h===void 0?"recharts-active-shape":h,_=e.isActive,a=tOe(e,eOe),b;if(W.isValidElement(t))b=W.cloneElement(t,xT(xT({},a),lOe(t)));else if(hr(t))b=t(a);else if(FIe(t)&&!VIe(t)){var C=u(t,a);b=Ye.createElement(_6,{shapeType:n,elementProps:C})}else{var A=a;b=Ye.createElement(_6,{shapeType:n,elementProps:A})}return _?Ye.createElement(xi,{className:p},b):b}function nA(e,t){return t!=null&&"trapezoids"in e.props}function rA(e,t){return t!=null&&"sectors"in e.props}function nx(e,t){return t!=null&&"points"in e.props}function cOe(e,t){var n,o,u=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,h=e.y===(t==null||(o=t.labelViewBox)===null||o===void 0?void 0:o.y)||e.y===t.y;return u&&h}function hOe(e,t){var n=e.endAngle===t.endAngle,o=e.startAngle===t.startAngle;return n&&o}function fOe(e,t){var n=e.x===t.x,o=e.y===t.y,u=e.z===t.z;return n&&o&&u}function dOe(e,t){var n;return nA(e,t)?n=cOe:rA(e,t)?n=hOe:nx(e,t)&&(n=fOe),n}function pOe(e,t){var n;return nA(e,t)?n="trapezoids":rA(e,t)?n="sectors":nx(e,t)&&(n="points"),n}function mOe(e,t){if(nA(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(rA(e,t)){var o;return(o=t.tooltipPayload)===null||o===void 0||(o=o[0])===null||o===void 0||(o=o.payload)===null||o===void 0?void 0:o.payload}return nx(e,t)?t.payload:{}}function gOe(e){var t=e.activeTooltipItem,n=e.graphicalItem,o=e.itemData,u=pOe(n,t),h=mOe(n,t),p=o.filter(function(a,b){var C=B0(h,a),A=n.props[u].filter(function(N){var z=dOe(n,t);return z(N,t)}),O=n.props[u].indexOf(A[A.length-1]),k=b===O;return C&&k}),_=o.indexOf(p[p.length-1]);return _}var yOe=Math.ceil,_Oe=Math.max;function vOe(e,t,n,o){for(var u=-1,h=_Oe(yOe((t-e)/(n||1)),0),p=Array(h);h--;)p[o?h:++u]=e,e+=n;return p}var xOe=vOe,bOe=j9,v6=1/0,wOe=17976931348623157e292;function SOe(e){if(!e)return e===0?e:0;if(e=bOe(e),e===v6||e===-v6){var t=e<0?-1:1;return t*wOe}return e===e?e:0}var sZ=SOe,TOe=xOe,EOe=WE,qM=sZ;function AOe(e){return function(t,n,o){return o&&typeof o!="number"&&EOe(t,n,o)&&(n=o=void 0),t=qM(t),n===void 0?(n=t,t=0):n=qM(n),o=o===void 0?t<n?1:-1:qM(o),TOe(t,n,o,e)}}var COe=AOe,POe=COe,MOe=POe(),IOe=MOe;const bT=Vr(IOe);function rx(e){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(e)}function x6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function b6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x6(Object(n),!0).forEach(function(o){lZ(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function lZ(e,t,n){return t=OOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OOe(e){var t=ROe(e,"string");return rx(t)=="symbol"?t:t+""}function ROe(e,t){if(rx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(rx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kOe=["Webkit","Moz","O","ms"],DOe=function(t,n){var o=t.replace(/(\w)/,function(h){return h.toUpperCase()}),u=kOe.reduce(function(h,p){return b6(b6({},h),{},lZ({},p+o,n))},{});return u[t]=n,u};function Cg(e){"@babel/helpers - typeof";return Cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cg(e)}function wT(){return wT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},wT.apply(this,arguments)}function w6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function ZM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w6(Object(n),!0).forEach(function(o){ka(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function LOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S6(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,cZ(o.key),o)}}function zOe(e,t,n){return t&&S6(e.prototype,t),n&&S6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function FOe(e,t,n){return t=ST(t),NOe(e,uZ()?Reflect.construct(t,n||[],ST(e).constructor):t.apply(e,n))}function NOe(e,t){if(t&&(Cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BOe(e)}function BOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uZ=function(){return!!e})()}function ST(e){return ST=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ST(e)}function jOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z3(e,t)}function z3(e,t){return z3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},z3(e,t)}function ka(e,t,n){return t=cZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cZ(e){var t=$Oe(e,"string");return Cg(t)=="symbol"?t:t+""}function $Oe(e,t){if(Cg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Cg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UOe=function(t){var n=t.data,o=t.startIndex,u=t.endIndex,h=t.x,p=t.width,_=t.travellerWidth;if(!n||!n.length)return{};var a=n.length,b=Qv().domain(bT(0,a)).range([h,h+p-_]),C=b.domain().map(function(A){return b(A)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:b(o),endX:b(u),scale:b,scaleValues:C}},T6=function(t){return t.changedTouches&&!!t.changedTouches.length},Pg=function(e){function t(n){var o;return LOe(this,t),o=FOe(this,t,[n]),ka(o,"handleDrag",function(u){o.leaveTimer&&(clearTimeout(o.leaveTimer),o.leaveTimer=null),o.state.isTravellerMoving?o.handleTravellerMove(u):o.state.isSlideMoving&&o.handleSlideDrag(u)}),ka(o,"handleTouchMove",function(u){u.changedTouches!=null&&u.changedTouches.length>0&&o.handleDrag(u.changedTouches[0])}),ka(o,"handleDragEnd",function(){o.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var u=o.props,h=u.endIndex,p=u.onDragEnd,_=u.startIndex;p==null||p({endIndex:h,startIndex:_})}),o.detachDragEndListener()}),ka(o,"handleLeaveWrapper",function(){(o.state.isTravellerMoving||o.state.isSlideMoving)&&(o.leaveTimer=window.setTimeout(o.handleDragEnd,o.props.leaveTimeOut))}),ka(o,"handleEnterSlideOrTraveller",function(){o.setState({isTextActive:!0})}),ka(o,"handleLeaveSlideOrTraveller",function(){o.setState({isTextActive:!1})}),ka(o,"handleSlideDragStart",function(u){var h=T6(u)?u.changedTouches[0]:u;o.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:h.pageX}),o.attachDragEndListener()}),o.travellerDragStartHandlers={startX:o.handleTravellerDragStart.bind(o,"startX"),endX:o.handleTravellerDragStart.bind(o,"endX")},o.state={},o}return jOe(t,e),zOe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(o){var u=o.startX,h=o.endX,p=this.state.scaleValues,_=this.props,a=_.gap,b=_.data,C=b.length-1,A=Math.min(u,h),O=Math.max(u,h),k=t.getIndexInRange(p,A),N=t.getIndexInRange(p,O);return{startIndex:k-k%a,endIndex:N===C?C:N-N%a}}},{key:"getTextOfTick",value:function(o){var u=this.props,h=u.data,p=u.tickFormatter,_=u.dataKey,a=Ga(h[o],_,o);return hr(p)?p(a,o):a}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(o){var u=this.state,h=u.slideMoveStartX,p=u.startX,_=u.endX,a=this.props,b=a.x,C=a.width,A=a.travellerWidth,O=a.startIndex,k=a.endIndex,N=a.onChange,z=o.pageX-h;z>0?z=Math.min(z,b+C-A-_,b+C-A-p):z<0&&(z=Math.max(z,b-p,b-_));var U=this.getIndex({startX:p+z,endX:_+z});(U.startIndex!==O||U.endIndex!==k)&&N&&N(U),this.setState({startX:p+z,endX:_+z,slideMoveStartX:o.pageX})}},{key:"handleTravellerDragStart",value:function(o,u){var h=T6(u)?u.changedTouches[0]:u;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:o,brushMoveStartX:h.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(o){var u=this.state,h=u.brushMoveStartX,p=u.movingTravellerId,_=u.endX,a=u.startX,b=this.state[p],C=this.props,A=C.x,O=C.width,k=C.travellerWidth,N=C.onChange,z=C.gap,U=C.data,j={startX:this.state.startX,endX:this.state.endX},G=o.pageX-h;G>0?G=Math.min(G,A+O-k-b):G<0&&(G=Math.max(G,A-b)),j[p]=b+G;var H=this.getIndex(j),Y=H.startIndex,K=H.endIndex,ee=function(){var ve=U.length-1;return p==="startX"&&(_>a?Y%z===0:K%z===0)||_<a&&K===ve||p==="endX"&&(_>a?K%z===0:Y%z===0)||_>a&&K===ve};this.setState(ka(ka({},p,b+G),"brushMoveStartX",o.pageX),function(){N&&ee()&&N(H)})}},{key:"handleTravellerMoveKeyboard",value:function(o,u){var h=this,p=this.state,_=p.scaleValues,a=p.startX,b=p.endX,C=this.state[u],A=_.indexOf(C);if(A!==-1){var O=A+o;if(!(O===-1||O>=_.length)){var k=_[O];u==="startX"&&k>=b||u==="endX"&&k<=a||this.setState(ka({},u,k),function(){h.props.onChange(h.getIndex({startX:h.state.startX,endX:h.state.endX}))})}}}},{key:"renderBackground",value:function(){var o=this.props,u=o.x,h=o.y,p=o.width,_=o.height,a=o.fill,b=o.stroke;return Ye.createElement("rect",{stroke:b,fill:a,x:u,y:h,width:p,height:_})}},{key:"renderPanorama",value:function(){var o=this.props,u=o.x,h=o.y,p=o.width,_=o.height,a=o.data,b=o.children,C=o.padding,A=W.Children.only(b);return A?Ye.cloneElement(A,{x:u,y:h,width:p,height:_,margin:C,compact:!0,data:a}):null}},{key:"renderTravellerLayer",value:function(o,u){var h,p,_=this,a=this.props,b=a.y,C=a.travellerWidth,A=a.height,O=a.traveller,k=a.ariaLabel,N=a.data,z=a.startIndex,U=a.endIndex,j=Math.max(o,this.props.x),G=ZM(ZM({},gr(this.props,!1)),{},{x:j,y:b,width:C,height:A}),H=k||"Min value: ".concat((h=N[z])===null||h===void 0?void 0:h.name,", Max value: ").concat((p=N[U])===null||p===void 0?void 0:p.name);return Ye.createElement(xi,{tabIndex:0,role:"slider","aria-label":H,"aria-valuenow":o,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[u],onTouchStart:this.travellerDragStartHandlers[u],onKeyDown:function(K){["ArrowLeft","ArrowRight"].includes(K.key)&&(K.preventDefault(),K.stopPropagation(),_.handleTravellerMoveKeyboard(K.key==="ArrowRight"?1:-1,u))},onFocus:function(){_.setState({isTravellerFocused:!0})},onBlur:function(){_.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(O,G))}},{key:"renderSlide",value:function(o,u){var h=this.props,p=h.y,_=h.height,a=h.stroke,b=h.travellerWidth,C=Math.min(o,u)+b,A=Math.max(Math.abs(u-o)-b,0);return Ye.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:a,fillOpacity:.2,x:C,y:p,width:A,height:_})}},{key:"renderText",value:function(){var o=this.props,u=o.startIndex,h=o.endIndex,p=o.y,_=o.height,a=o.travellerWidth,b=o.stroke,C=this.state,A=C.startX,O=C.endX,k=5,N={pointerEvents:"none",fill:b};return Ye.createElement(xi,{className:"recharts-brush-texts"},Ye.createElement(QS,wT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(A,O)-k,y:p+_/2},N),this.getTextOfTick(u)),Ye.createElement(QS,wT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(A,O)+a+k,y:p+_/2},N),this.getTextOfTick(h)))}},{key:"render",value:function(){var o=this.props,u=o.data,h=o.className,p=o.children,_=o.x,a=o.y,b=o.width,C=o.height,A=o.alwaysShowText,O=this.state,k=O.startX,N=O.endX,z=O.isTextActive,U=O.isSlideMoving,j=O.isTravellerMoving,G=O.isTravellerFocused;if(!u||!u.length||!Qt(_)||!Qt(a)||!Qt(b)||!Qt(C)||b<=0||C<=0)return null;var H=Cr("recharts-brush",h),Y=Ye.Children.count(p)===1,K=DOe("userSelect","none");return Ye.createElement(xi,{className:H,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:K},this.renderBackground(),Y&&this.renderPanorama(),this.renderSlide(k,N),this.renderTravellerLayer(k,"startX"),this.renderTravellerLayer(N,"endX"),(z||U||j||G||A)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(o){var u=o.x,h=o.y,p=o.width,_=o.height,a=o.stroke,b=Math.floor(h+_/2)-1;return Ye.createElement(Ye.Fragment,null,Ye.createElement("rect",{x:u,y:h,width:p,height:_,fill:a,stroke:"none"}),Ye.createElement("line",{x1:u+1,y1:b,x2:u+p-1,y2:b,fill:"none",stroke:"#fff"}),Ye.createElement("line",{x1:u+1,y1:b+2,x2:u+p-1,y2:b+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(o,u){var h;return Ye.isValidElement(o)?h=Ye.cloneElement(o,u):hr(o)?h=o(u):h=t.renderDefaultTraveller(u),h}},{key:"getDerivedStateFromProps",value:function(o,u){var h=o.data,p=o.width,_=o.x,a=o.travellerWidth,b=o.updateId,C=o.startIndex,A=o.endIndex;if(h!==u.prevData||b!==u.prevUpdateId)return ZM({prevData:h,prevTravellerWidth:a,prevUpdateId:b,prevX:_,prevWidth:p},h&&h.length?UOe({data:h,width:p,x:_,travellerWidth:a,startIndex:C,endIndex:A}):{scale:null,scaleValues:null});if(u.scale&&(p!==u.prevWidth||_!==u.prevX||a!==u.prevTravellerWidth)){u.scale.range([_,_+p-a]);var O=u.scale.domain().map(function(k){return u.scale(k)});return{prevData:h,prevTravellerWidth:a,prevUpdateId:b,prevX:_,prevWidth:p,startX:u.scale(o.startIndex),endX:u.scale(o.endIndex),scaleValues:O}}return null}},{key:"getIndexInRange",value:function(o,u){for(var h=o.length,p=0,_=h-1;_-p>1;){var a=Math.floor((p+_)/2);o[a]>u?_=a:p=a}return u>=o[_]?_:p}}])}(W.PureComponent);ka(Pg,"displayName","Brush");ka(Pg,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var VOe=mD;function GOe(e,t){var n;return VOe(e,function(o,u,h){return n=t(o,u,h),!n}),!!n}var WOe=GOe,HOe=d9,qOe=Yh,ZOe=WOe,XOe=ba,YOe=WE;function KOe(e,t,n){var o=XOe(e)?HOe:ZOe;return n&&YOe(e,t,n)&&(t=void 0),o(e,qOe(t))}var QOe=KOe;const JOe=Vr(QOe);var Vl=function(t,n){var o=t.alwaysShow,u=t.ifOverflow;return o&&(u="extendDomain"),u===n},E6=L9;function e3e(e,t,n){t=="__proto__"&&E6?E6(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var t3e=e3e,n3e=t3e,r3e=k9,i3e=Yh;function o3e(e,t){var n={};return t=i3e(t),r3e(e,function(o,u,h){n3e(n,u,t(o,u,h))}),n}var a3e=o3e;const s3e=Vr(a3e);function l3e(e,t){for(var n=-1,o=e==null?0:e.length;++n<o;)if(!t(e[n],n,e))return!1;return!0}var u3e=l3e,c3e=mD;function h3e(e,t){var n=!0;return c3e(e,function(o,u,h){return n=!!t(o,u,h),n}),n}var f3e=h3e,d3e=u3e,p3e=f3e,m3e=Yh,g3e=ba,y3e=WE;function _3e(e,t,n){var o=g3e(e)?d3e:p3e;return n&&y3e(e,t,n)&&(t=void 0),o(e,m3e(t))}var v3e=_3e;const hZ=Vr(v3e);var x3e=["x","y"];function ix(e){"@babel/helpers - typeof";return ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ix(e)}function F3(){return F3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},F3.apply(this,arguments)}function A6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Cv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?A6(Object(n),!0).forEach(function(o){b3e(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function b3e(e,t,n){return t=w3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w3e(e){var t=S3e(e,"string");return ix(t)=="symbol"?t:t+""}function S3e(e,t){if(ix(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(ix(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T3e(e,t){if(e==null)return{};var n=E3e(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function E3e(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function A3e(e,t){var n=e.x,o=e.y,u=T3e(e,x3e),h="".concat(n),p=parseInt(h,10),_="".concat(o),a=parseInt(_,10),b="".concat(t.height||u.height),C=parseInt(b,10),A="".concat(t.width||u.width),O=parseInt(A,10);return Cv(Cv(Cv(Cv(Cv({},t),u),p?{x:p}:{}),a?{y:a}:{}),{},{height:C,width:O,name:t.name,radius:t.radius})}function C6(e){return Ye.createElement(uOe,F3({shapeType:"rectangle",propTransformer:A3e,activeClassName:"recharts-active-bar"},e))}var C3e=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(o,u){if(typeof t=="number")return t;var h=typeof o=="number";return h?t(o,u):(h||Vd(),n)}},P3e=["value","background"],fZ;function Mg(e){"@babel/helpers - typeof";return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}function M3e(e,t){if(e==null)return{};var n=I3e(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function I3e(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function TT(){return TT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},TT.apply(this,arguments)}function P6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function ji(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P6(Object(n),!0).forEach(function(o){Th(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function O3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M6(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,pZ(o.key),o)}}function R3e(e,t,n){return t&&M6(e.prototype,t),n&&M6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function k3e(e,t,n){return t=ET(t),D3e(e,dZ()?Reflect.construct(t,n||[],ET(e).constructor):t.apply(e,n))}function D3e(e,t){if(t&&(Mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L3e(e)}function L3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dZ=function(){return!!e})()}function ET(e){return ET=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ET(e)}function z3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N3(e,t)}function N3(e,t){return N3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},N3(e,t)}function Th(e,t,n){return t=pZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pZ(e){var t=F3e(e,"string");return Mg(t)=="symbol"?t:t+""}function F3e(e,t){if(Mg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Mg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fx=function(e){function t(){var n;O3e(this,t);for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];return n=k3e(this,t,[].concat(u)),Th(n,"state",{isAnimationFinished:!1}),Th(n,"id",Ox("recharts-bar-")),Th(n,"handleAnimationEnd",function(){var p=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),p&&p()}),Th(n,"handleAnimationStart",function(){var p=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),p&&p()}),n}return z3e(t,e),R3e(t,[{key:"renderRectanglesStatically",value:function(o){var u=this,h=this.props,p=h.shape,_=h.dataKey,a=h.activeIndex,b=h.activeBar,C=gr(this.props,!1);return o&&o.map(function(A,O){var k=O===a,N=k?b:p,z=ji(ji(ji({},C),A),{},{isActive:k,option:N,index:O,dataKey:_,onAnimationStart:u.handleAnimationStart,onAnimationEnd:u.handleAnimationEnd});return Ye.createElement(xi,TT({className:"recharts-bar-rectangle"},NS(u.props,A,O),{key:"rectangle-".concat(A==null?void 0:A.x,"-").concat(A==null?void 0:A.y,"-").concat(A==null?void 0:A.value)}),Ye.createElement(C6,z))})}},{key:"renderRectanglesWithAnimation",value:function(){var o=this,u=this.props,h=u.data,p=u.layout,_=u.isAnimationActive,a=u.animationBegin,b=u.animationDuration,C=u.animationEasing,A=u.animationId,O=this.state.prevData;return Ye.createElement(Ku,{begin:a,duration:b,isActive:_,easing:C,from:{t:0},to:{t:1},key:"bar-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(k){var N=k.t,z=h.map(function(U,j){var G=O&&O[j];if(G){var H=ps(G.x,U.x),Y=ps(G.y,U.y),K=ps(G.width,U.width),ee=ps(G.height,U.height);return ji(ji({},U),{},{x:H(N),y:Y(N),width:K(N),height:ee(N)})}if(p==="horizontal"){var ue=ps(0,U.height),ve=ue(N);return ji(ji({},U),{},{y:U.y+U.height-ve,height:ve})}var Fe=ps(0,U.width),Ne=Fe(N);return ji(ji({},U),{},{width:Ne})});return Ye.createElement(xi,null,o.renderRectanglesStatically(z))})}},{key:"renderRectangles",value:function(){var o=this.props,u=o.data,h=o.isAnimationActive,p=this.state.prevData;return h&&u&&u.length&&(!p||!B0(p,u))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(u)}},{key:"renderBackground",value:function(){var o=this,u=this.props,h=u.data,p=u.dataKey,_=u.activeIndex,a=gr(this.props.background,!1);return h.map(function(b,C){b.value;var A=b.background,O=M3e(b,P3e);if(!A)return null;var k=ji(ji(ji(ji(ji({},O),{},{fill:"#eee"},A),a),NS(o.props,b,C)),{},{onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd,dataKey:p,index:C,className:"recharts-bar-background-rectangle"});return Ye.createElement(C6,TT({key:"background-bar-".concat(C),option:o.props.background,isActive:C===_},k))})}},{key:"renderErrorBar",value:function(o,u){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var h=this.props,p=h.data,_=h.xAxis,a=h.yAxis,b=h.layout,C=h.children,A=rl(C,tA);if(!A)return null;var O=b==="vertical"?p[0].height/2:p[0].width/2,k=function(U,j){var G=Array.isArray(U.value)?U.value[1]:U.value;return{x:U.x,y:U.y,value:G,errorVal:Ga(U,j)}},N={clipPath:o?"url(#clipPath-".concat(u,")"):null};return Ye.createElement(xi,N,A.map(function(z){return Ye.cloneElement(z,{key:"error-bar-".concat(u,"-").concat(z.props.dataKey),data:p,xAxis:_,yAxis:a,layout:b,offset:O,dataPointFormatter:k})}))}},{key:"render",value:function(){var o=this.props,u=o.hide,h=o.data,p=o.className,_=o.xAxis,a=o.yAxis,b=o.left,C=o.top,A=o.width,O=o.height,k=o.isAnimationActive,N=o.background,z=o.id;if(u||!h||!h.length)return null;var U=this.state.isAnimationFinished,j=Cr("recharts-bar",p),G=_&&_.allowDataOverflow,H=a&&a.allowDataOverflow,Y=G||H,K=Tr(z)?this.id:z;return Ye.createElement(xi,{className:j},G||H?Ye.createElement("defs",null,Ye.createElement("clipPath",{id:"clipPath-".concat(K)},Ye.createElement("rect",{x:G?b:b-A/2,y:H?C:C-O/2,width:G?A:A*2,height:H?O:O*2}))):null,Ye.createElement(xi,{className:"recharts-bar-rectangles",clipPath:Y?"url(#clipPath-".concat(K,")"):null},N?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(Y,K),(!k||U)&&zh.renderCallByParent(this.props,h))}}],[{key:"getDerivedStateFromProps",value:function(o,u){return o.animationId!==u.prevAnimationId?{prevAnimationId:o.animationId,curData:o.data,prevData:u.curData}:o.data!==u.curData?{curData:o.data}:null}}])}(W.PureComponent);fZ=Fx;Th(Fx,"displayName","Bar");Th(Fx,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Bu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Th(Fx,"getComposedData",function(e){var t=e.props,n=e.item,o=e.barPosition,u=e.bandSize,h=e.xAxis,p=e.yAxis,_=e.xAxisTicks,a=e.yAxisTicks,b=e.stackedData,C=e.dataStartIndex,A=e.displayedData,O=e.offset,k=PCe(o,n);if(!k)return null;var N=t.layout,z=n.type.defaultProps,U=z!==void 0?ji(ji({},z),n.props):n.props,j=U.dataKey,G=U.children,H=U.minPointSize,Y=N==="horizontal"?p:h,K=b?Y.scale.domain():null,ee=zCe({numericAxis:Y}),ue=rl(G,U9),ve=A.map(function(Fe,Ne){var Oe,Le,Ue,et,rt,st;b?Oe=MCe(b[C+Ne],K):(Oe=Ga(Fe,j),Array.isArray(Oe)||(Oe=[ee,Oe]));var Ke=C3e(H,fZ.defaultProps.minPointSize)(Oe[1],Ne);if(N==="horizontal"){var Ze,Xe=[p.scale(Oe[0]),p.scale(Oe[1])],de=Xe[0],lt=Xe[1];Le=P$({axis:h,ticks:_,bandSize:u,offset:k.offset,entry:Fe,index:Ne}),Ue=(Ze=lt??de)!==null&&Ze!==void 0?Ze:void 0,et=k.size;var gt=de-lt;if(rt=Number.isNaN(gt)?0:gt,st={x:Le,y:p.y,width:et,height:p.height},Math.abs(Ke)>0&&Math.abs(rt)<Math.abs(Ke)){var Se=Js(rt||Ke)*(Math.abs(Ke)-Math.abs(rt));Ue-=Se,rt+=Se}}else{var qt=[h.scale(Oe[0]),h.scale(Oe[1])],an=qt[0],dn=qt[1];if(Le=an,Ue=P$({axis:p,ticks:a,bandSize:u,offset:k.offset,entry:Fe,index:Ne}),et=dn-an,rt=k.size,st={x:h.x,y:Ue,width:h.width,height:rt},Math.abs(Ke)>0&&Math.abs(et)<Math.abs(Ke)){var Wt=Js(et||Ke)*(Math.abs(Ke)-Math.abs(et));et+=Wt}}return ji(ji(ji({},Fe),{},{x:Le,y:Ue,width:et,height:rt,value:b?Oe:Oe[1],payload:Fe,background:st},ue&&ue[Ne]&&ue[Ne].props),{},{tooltipPayload:[Zq(n,Fe)],tooltipPosition:{x:Le+et/2,y:Ue+rt/2}})});return ji({data:ve,layout:N},O)});function ox(e){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(e)}function N3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I6(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,mZ(o.key),o)}}function B3e(e,t,n){return t&&I6(e.prototype,t),n&&I6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Ys(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?O6(Object(n),!0).forEach(function(o){iA(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function iA(e,t,n){return t=mZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mZ(e){var t=j3e(e,"string");return ox(t)=="symbol"?t:t+""}function j3e(e,t){if(ox(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(ox(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $3e=function(t,n,o,u,h){var p=t.width,_=t.height,a=t.layout,b=t.children,C=Object.keys(n),A={left:o.left,leftMirror:o.left,right:p-o.right,rightMirror:p-o.right,top:o.top,topMirror:o.top,bottom:_-o.bottom,bottomMirror:_-o.bottom},O=!!La(b,Fx);return C.reduce(function(k,N){var z=n[N],U=z.orientation,j=z.domain,G=z.padding,H=G===void 0?{}:G,Y=z.mirror,K=z.reversed,ee="".concat(U).concat(Y?"Mirror":""),ue,ve,Fe,Ne,Oe;if(z.type==="number"&&(z.padding==="gap"||z.padding==="no-gap")){var Le=j[1]-j[0],Ue=1/0,et=z.categoricalDomain.sort();if(et.forEach(function(qt,an){an>0&&(Ue=Math.min((qt||0)-(et[an-1]||0),Ue))}),Number.isFinite(Ue)){var rt=Ue/Le,st=z.layout==="vertical"?o.height:o.width;if(z.padding==="gap"&&(ue=rt*st/2),z.padding==="no-gap"){var Ke=$d(t.barCategoryGap,rt*st),Ze=rt*st/2;ue=Ze-Ke-(Ze-Ke)/st*Ke}}}u==="xAxis"?ve=[o.left+(H.left||0)+(ue||0),o.left+o.width-(H.right||0)-(ue||0)]:u==="yAxis"?ve=a==="horizontal"?[o.top+o.height-(H.bottom||0),o.top+(H.top||0)]:[o.top+(H.top||0)+(ue||0),o.top+o.height-(H.bottom||0)-(ue||0)]:ve=z.range,K&&(ve=[ve[1],ve[0]]);var Xe=ACe(z,h,O),de=Xe.scale,lt=Xe.realScaleType;de.domain(j).range(ve),CCe(de);var gt=LCe(de,Ys(Ys({},z),{},{realScaleType:lt}));u==="xAxis"?(Oe=U==="top"&&!Y||U==="bottom"&&Y,Fe=o.left,Ne=A[ee]-Oe*z.height):u==="yAxis"&&(Oe=U==="left"&&!Y||U==="right"&&Y,Fe=A[ee]-Oe*z.width,Ne=o.top);var Se=Ys(Ys(Ys({},z),gt),{},{realScaleType:lt,x:Fe,y:Ne,scale:de,width:u==="xAxis"?o.width:z.width,height:u==="yAxis"?o.height:z.height});return Se.bandSize=fT(Se,gt),!z.hide&&u==="xAxis"?A[ee]+=(Oe?-1:1)*Se.height:z.hide||(A[ee]+=(Oe?-1:1)*Se.width),Ys(Ys({},k),{},iA({},N,Se))},{})},gZ=function(t,n){var o=t.x,u=t.y,h=n.x,p=n.y;return{x:Math.min(o,h),y:Math.min(u,p),width:Math.abs(h-o),height:Math.abs(p-u)}},U3e=function(t){var n=t.x1,o=t.y1,u=t.x2,h=t.y2;return gZ({x:n,y:o},{x:u,y:h})},yZ=function(){function e(t){N3e(this,e),this.scale=t}return B3e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=o.bandAware,h=o.position;if(n!==void 0){if(h)switch(h){case"start":return this.scale(n);case"middle":{var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+p}case"end":{var _=this.bandwidth?this.bandwidth():0;return this.scale(n)+_}default:return this.scale(n)}if(u){var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+a}return this.scale(n)}}},{key:"isInRange",value:function(n){var o=this.range(),u=o[0],h=o[o.length-1];return u<=h?n>=u&&n<=h:n>=h&&n<=u}}],[{key:"create",value:function(n){return new e(n)}}])}();iA(yZ,"EPS",1e-4);var WD=function(t){var n=Object.keys(t).reduce(function(o,u){return Ys(Ys({},o),{},iA({},u,yZ.create(t[u])))},{});return Ys(Ys({},n),{},{apply:function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=h.bandAware,_=h.position;return s3e(u,function(a,b){return n[b].apply(a,{bandAware:p,position:_})})},isInRange:function(u){return hZ(u,function(h,p){return n[p].isInRange(h)})}})};function V3e(e){return(e%180+180)%180}var G3e=function(t){var n=t.width,o=t.height,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=V3e(u),p=h*Math.PI/180,_=Math.atan(o/n),a=p>_&&p<Math.PI-_?o/Math.sin(p):n/Math.cos(p);return Math.abs(a)},W3e=Yh,H3e=Rx,q3e=VE;function Z3e(e){return function(t,n,o){var u=Object(t);if(!H3e(t)){var h=W3e(n);t=q3e(t),n=function(_){return h(u[_],_,u)}}var p=e(t,n,o);return p>-1?u[h?t[p]:p]:void 0}}var X3e=Z3e,Y3e=sZ;function K3e(e){var t=Y3e(e),n=t%1;return t===t?n?t-n:t:0}var Q3e=K3e,J3e=C9,eRe=Yh,tRe=Q3e,nRe=Math.max;function rRe(e,t,n){var o=e==null?0:e.length;if(!o)return-1;var u=n==null?0:tRe(n);return u<0&&(u=nRe(o+u,0)),J3e(e,eRe(t),u)}var iRe=rRe,oRe=X3e,aRe=iRe,sRe=oRe(aRe),lRe=sRe;const uRe=Vr(lRe);var cRe=hde(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),HD=W.createContext(void 0),qD=W.createContext(void 0),_Z=W.createContext(void 0),vZ=W.createContext({}),xZ=W.createContext(void 0),bZ=W.createContext(0),wZ=W.createContext(0),R6=function(t){var n=t.state,o=n.xAxisMap,u=n.yAxisMap,h=n.offset,p=t.clipPathId,_=t.children,a=t.width,b=t.height,C=cRe(h);return Ye.createElement(HD.Provider,{value:o},Ye.createElement(qD.Provider,{value:u},Ye.createElement(vZ.Provider,{value:h},Ye.createElement(_Z.Provider,{value:C},Ye.createElement(xZ.Provider,{value:p},Ye.createElement(bZ.Provider,{value:b},Ye.createElement(wZ.Provider,{value:a},_)))))))},hRe=function(){return W.useContext(xZ)},SZ=function(t){var n=W.useContext(HD);n==null&&Vd();var o=n[t];return o==null&&Vd(),o},fRe=function(){var t=W.useContext(HD);return _h(t)},dRe=function(){var t=W.useContext(qD),n=uRe(t,function(o){return hZ(o.domain,Number.isFinite)});return n||_h(t)},TZ=function(t){var n=W.useContext(qD);n==null&&Vd();var o=n[t];return o==null&&Vd(),o},pRe=function(){var t=W.useContext(_Z);return t},mRe=function(){return W.useContext(vZ)},ZD=function(){return W.useContext(wZ)},XD=function(){return W.useContext(bZ)};function Ig(e){"@babel/helpers - typeof";return Ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ig(e)}function gRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yRe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,AZ(o.key),o)}}function _Re(e,t,n){return t&&yRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vRe(e,t,n){return t=AT(t),xRe(e,EZ()?Reflect.construct(t,n||[],AT(e).constructor):t.apply(e,n))}function xRe(e,t){if(t&&(Ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bRe(e)}function bRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EZ=function(){return!!e})()}function AT(e){return AT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},AT(e)}function wRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B3(e,t)}function B3(e,t){return B3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},B3(e,t)}function k6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function D6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k6(Object(n),!0).forEach(function(o){YD(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function YD(e,t,n){return t=AZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AZ(e){var t=SRe(e,"string");return Ig(t)=="symbol"?t:t+""}function SRe(e,t){if(Ig(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Ig(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TRe(e,t){return PRe(e)||CRe(e,t)||ARe(e,t)||ERe()}function ERe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ARe(e,t){if(e){if(typeof e=="string")return L6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L6(e,t)}}function L6(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function CRe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function PRe(e){if(Array.isArray(e))return e}function j3(){return j3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},j3.apply(this,arguments)}var MRe=function(t,n){var o;return Ye.isValidElement(t)?o=Ye.cloneElement(t,n):hr(t)?o=t(n):o=Ye.createElement("line",j3({},n,{className:"recharts-reference-line-line"})),o},IRe=function(t,n,o,u,h,p,_,a,b){var C=h.x,A=h.y,O=h.width,k=h.height;if(o){var N=b.y,z=t.y.apply(N,{position:p});if(Vl(b,"discard")&&!t.y.isInRange(z))return null;var U=[{x:C+O,y:z},{x:C,y:z}];return a==="left"?U.reverse():U}if(n){var j=b.x,G=t.x.apply(j,{position:p});if(Vl(b,"discard")&&!t.x.isInRange(G))return null;var H=[{x:G,y:A+k},{x:G,y:A}];return _==="top"?H.reverse():H}if(u){var Y=b.segment,K=Y.map(function(ee){return t.apply(ee,{position:p})});return Vl(b,"discard")&&JOe(K,function(ee){return!t.isInRange(ee)})?null:K}return null};function ORe(e){var t=e.x,n=e.y,o=e.segment,u=e.xAxisId,h=e.yAxisId,p=e.shape,_=e.className,a=e.alwaysShow,b=hRe(),C=SZ(u),A=TZ(h),O=pRe();if(!b||!O)return null;Nu(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var k=WD({x:C.scale,y:A.scale}),N=to(t),z=to(n),U=o&&o.length===2,j=IRe(k,N,z,U,O,e.position,C.orientation,A.orientation,e);if(!j)return null;var G=TRe(j,2),H=G[0],Y=H.x,K=H.y,ee=G[1],ue=ee.x,ve=ee.y,Fe=Vl(e,"hidden")?"url(#".concat(b,")"):void 0,Ne=D6(D6({clipPath:Fe},gr(e,!0)),{},{x1:Y,y1:K,x2:ue,y2:ve});return Ye.createElement(xi,{className:Cr("recharts-reference-line",_)},MRe(p,Ne),zo.renderCallByParent(e,U3e({x1:Y,y1:K,x2:ue,y2:ve})))}var KD=function(e){function t(){return gRe(this,t),vRe(this,t,arguments)}return wRe(t,e),_Re(t,[{key:"render",value:function(){return Ye.createElement(ORe,this.props)}}])}(Ye.Component);YD(KD,"displayName","ReferenceLine");YD(KD,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function $3(){return $3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},$3.apply(this,arguments)}function Og(e){"@babel/helpers - typeof";return Og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Og(e)}function z6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function F6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z6(Object(n),!0).forEach(function(o){oA(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function RRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kRe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,PZ(o.key),o)}}function DRe(e,t,n){return t&&kRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function LRe(e,t,n){return t=CT(t),zRe(e,CZ()?Reflect.construct(t,n||[],CT(e).constructor):t.apply(e,n))}function zRe(e,t){if(t&&(Og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FRe(e)}function FRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CZ=function(){return!!e})()}function CT(e){return CT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CT(e)}function NRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U3(e,t)}function U3(e,t){return U3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},U3(e,t)}function oA(e,t,n){return t=PZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PZ(e){var t=BRe(e,"string");return Og(t)=="symbol"?t:t+""}function BRe(e,t){if(Og(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Og(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jRe=function(t){var n=t.x,o=t.y,u=t.xAxis,h=t.yAxis,p=WD({x:u.scale,y:h.scale}),_=p.apply({x:n,y:o},{bandAware:!0});return Vl(t,"discard")&&!p.isInRange(_)?null:_},aA=function(e){function t(){return RRe(this,t),LRe(this,t,arguments)}return NRe(t,e),DRe(t,[{key:"render",value:function(){var o=this.props,u=o.x,h=o.y,p=o.r,_=o.alwaysShow,a=o.clipPathId,b=to(u),C=to(h);if(Nu(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!b||!C)return null;var A=jRe(this.props);if(!A)return null;var O=A.x,k=A.y,N=this.props,z=N.shape,U=N.className,j=Vl(this.props,"hidden")?"url(#".concat(a,")"):void 0,G=F6(F6({clipPath:j},gr(this.props,!0)),{},{cx:O,cy:k});return Ye.createElement(xi,{className:Cr("recharts-reference-dot",U)},t.renderDot(z,G),zo.renderCallByParent(this.props,{x:O-p,y:k-p,width:2*p,height:2*p}))}}])}(Ye.Component);oA(aA,"displayName","ReferenceDot");oA(aA,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});oA(aA,"renderDot",function(e,t){var n;return Ye.isValidElement(e)?n=Ye.cloneElement(e,t):hr(e)?n=e(t):n=Ye.createElement(GD,$3({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function V3(){return V3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},V3.apply(this,arguments)}function Rg(e){"@babel/helpers - typeof";return Rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rg(e)}function N6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function B6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?N6(Object(n),!0).forEach(function(o){sA(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function $Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function URe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,IZ(o.key),o)}}function VRe(e,t,n){return t&&URe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GRe(e,t,n){return t=PT(t),WRe(e,MZ()?Reflect.construct(t,n||[],PT(e).constructor):t.apply(e,n))}function WRe(e,t){if(t&&(Rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HRe(e)}function HRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MZ=function(){return!!e})()}function PT(e){return PT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},PT(e)}function qRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G3(e,t)}function G3(e,t){return G3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},G3(e,t)}function sA(e,t,n){return t=IZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IZ(e){var t=ZRe(e,"string");return Rg(t)=="symbol"?t:t+""}function ZRe(e,t){if(Rg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Rg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XRe=function(t,n,o,u,h){var p=h.x1,_=h.x2,a=h.y1,b=h.y2,C=h.xAxis,A=h.yAxis;if(!C||!A)return null;var O=WD({x:C.scale,y:A.scale}),k={x:t?O.x.apply(p,{position:"start"}):O.x.rangeMin,y:o?O.y.apply(a,{position:"start"}):O.y.rangeMin},N={x:n?O.x.apply(_,{position:"end"}):O.x.rangeMax,y:u?O.y.apply(b,{position:"end"}):O.y.rangeMax};return Vl(h,"discard")&&(!O.isInRange(k)||!O.isInRange(N))?null:gZ(k,N)},lA=function(e){function t(){return $Re(this,t),GRe(this,t,arguments)}return qRe(t,e),VRe(t,[{key:"render",value:function(){var o=this.props,u=o.x1,h=o.x2,p=o.y1,_=o.y2,a=o.className,b=o.alwaysShow,C=o.clipPathId;Nu(b===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var A=to(u),O=to(h),k=to(p),N=to(_),z=this.props.shape;if(!A&&!O&&!k&&!N&&!z)return null;var U=XRe(A,O,k,N,this.props);if(!U&&!z)return null;var j=Vl(this.props,"hidden")?"url(#".concat(C,")"):void 0;return Ye.createElement(xi,{className:Cr("recharts-reference-area",a)},t.renderRect(z,B6(B6({clipPath:j},gr(this.props,!0)),U)),zo.renderCallByParent(this.props,U))}}])}(Ye.Component);sA(lA,"displayName","ReferenceArea");sA(lA,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});sA(lA,"renderRect",function(e,t){var n;return Ye.isValidElement(e)?n=Ye.cloneElement(e,t):hr(e)?n=e(t):n=Ye.createElement(VD,V3({},t,{className:"recharts-reference-area-rect"})),n});function OZ(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var o=[],u=0;u<e.length;u+=t)o.push(e[u]);return o}function YRe(e,t,n){var o={width:e.width+t.width,height:e.height+t.height};return G3e(o,n)}function KRe(e,t,n){var o=n==="width",u=e.x,h=e.y,p=e.width,_=e.height;return t===1?{start:o?u:h,end:o?u+p:h+_}:{start:o?u+p:h+_,end:o?u:h}}function MT(e,t,n,o,u){if(e*t<e*o||e*t>e*u)return!1;var h=n();return e*(t-e*h/2-o)>=0&&e*(t+e*h/2-u)<=0}function QRe(e,t){return OZ(e,t+1)}function JRe(e,t,n,o,u){for(var h=(o||[]).slice(),p=t.start,_=t.end,a=0,b=1,C=p,A=function(){var N=o==null?void 0:o[a];if(N===void 0)return{v:OZ(o,b)};var z=a,U,j=function(){return U===void 0&&(U=n(N,z)),U},G=N.coordinate,H=a===0||MT(e,G,j,C,_);H||(a=0,C=p,b+=1),H&&(C=G+e*(j()/2+u),a+=b)},O;b<=h.length;)if(O=A(),O)return O.v;return[]}function ax(e){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(e)}function j6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Do(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?j6(Object(n),!0).forEach(function(o){eke(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function eke(e,t,n){return t=tke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tke(e){var t=nke(e,"string");return ax(t)=="symbol"?t:t+""}function nke(e,t){if(ax(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(ax(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rke(e,t,n,o,u){for(var h=(o||[]).slice(),p=h.length,_=t.start,a=t.end,b=function(O){var k=h[O],N,z=function(){return N===void 0&&(N=n(k,O)),N};if(O===p-1){var U=e*(k.coordinate+e*z()/2-a);h[O]=k=Do(Do({},k),{},{tickCoord:U>0?k.coordinate-U*e:k.coordinate})}else h[O]=k=Do(Do({},k),{},{tickCoord:k.coordinate});var j=MT(e,k.tickCoord,z,_,a);j&&(a=k.tickCoord-e*(z()/2+u),h[O]=Do(Do({},k),{},{isShow:!0}))},C=p-1;C>=0;C--)b(C);return h}function ike(e,t,n,o,u,h){var p=(o||[]).slice(),_=p.length,a=t.start,b=t.end;if(h){var C=o[_-1],A=n(C,_-1),O=e*(C.coordinate+e*A/2-b);p[_-1]=C=Do(Do({},C),{},{tickCoord:O>0?C.coordinate-O*e:C.coordinate});var k=MT(e,C.tickCoord,function(){return A},a,b);k&&(b=C.tickCoord-e*(A/2+u),p[_-1]=Do(Do({},C),{},{isShow:!0}))}for(var N=h?_-1:_,z=function(G){var H=p[G],Y,K=function(){return Y===void 0&&(Y=n(H,G)),Y};if(G===0){var ee=e*(H.coordinate-e*K()/2-a);p[G]=H=Do(Do({},H),{},{tickCoord:ee<0?H.coordinate-ee*e:H.coordinate})}else p[G]=H=Do(Do({},H),{},{tickCoord:H.coordinate});var ue=MT(e,H.tickCoord,K,a,b);ue&&(a=H.tickCoord+e*(K()/2+u),p[G]=Do(Do({},H),{},{isShow:!0}))},U=0;U<N;U++)z(U);return p}function QD(e,t,n){var o=e.tick,u=e.ticks,h=e.viewBox,p=e.minTickGap,_=e.orientation,a=e.interval,b=e.tickFormatter,C=e.unit,A=e.angle;if(!u||!u.length||!o)return[];if(Qt(a)||Bu.isSsr)return QRe(u,typeof a=="number"&&Qt(a)?a:0);var O=[],k=_==="top"||_==="bottom"?"width":"height",N=C&&k==="width"?Kv(C,{fontSize:t,letterSpacing:n}):{width:0,height:0},z=function(H,Y){var K=hr(b)?b(H.value,Y):H.value;return k==="width"?YRe(Kv(K,{fontSize:t,letterSpacing:n}),N,A):Kv(K,{fontSize:t,letterSpacing:n})[k]},U=u.length>=2?Js(u[1].coordinate-u[0].coordinate):1,j=KRe(h,U,k);return a==="equidistantPreserveStart"?JRe(U,j,z,u,p):(a==="preserveStart"||a==="preserveStartEnd"?O=ike(U,j,z,u,p,a==="preserveStartEnd"):O=rke(U,j,z,u,p),O.filter(function(G){return G.isShow}))}var oke=["viewBox"],ake=["viewBox"],ske=["ticks"];function kg(e){"@babel/helpers - typeof";return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kg(e)}function Vm(){return Vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Vm.apply(this,arguments)}function $6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Wo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$6(Object(n),!0).forEach(function(o){JD(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function XM(e,t){if(e==null)return{};var n=lke(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function lke(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function uke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U6(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,kZ(o.key),o)}}function cke(e,t,n){return t&&U6(e.prototype,t),n&&U6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hke(e,t,n){return t=IT(t),fke(e,RZ()?Reflect.construct(t,n||[],IT(e).constructor):t.apply(e,n))}function fke(e,t){if(t&&(kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dke(e)}function dke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RZ=function(){return!!e})()}function IT(e){return IT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},IT(e)}function pke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W3(e,t)}function W3(e,t){return W3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},W3(e,t)}function JD(e,t,n){return t=kZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kZ(e){var t=mke(e,"string");return kg(t)=="symbol"?t:t+""}function mke(e,t){if(kg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(kg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ly=function(e){function t(n){var o;return uke(this,t),o=hke(this,t,[n]),o.state={fontSize:"",letterSpacing:""},o}return pke(t,e),cke(t,[{key:"shouldComponentUpdate",value:function(o,u){var h=o.viewBox,p=XM(o,oke),_=this.props,a=_.viewBox,b=XM(_,ake);return!eg(h,a)||!eg(p,b)||!eg(u,this.state)}},{key:"componentDidMount",value:function(){var o=this.layerReference;if(o){var u=o.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];u&&this.setState({fontSize:window.getComputedStyle(u).fontSize,letterSpacing:window.getComputedStyle(u).letterSpacing})}}},{key:"getTickLineCoord",value:function(o){var u=this.props,h=u.x,p=u.y,_=u.width,a=u.height,b=u.orientation,C=u.tickSize,A=u.mirror,O=u.tickMargin,k,N,z,U,j,G,H=A?-1:1,Y=o.tickSize||C,K=Qt(o.tickCoord)?o.tickCoord:o.coordinate;switch(b){case"top":k=N=o.coordinate,U=p+ +!A*a,z=U-H*Y,G=z-H*O,j=K;break;case"left":z=U=o.coordinate,N=h+ +!A*_,k=N-H*Y,j=k-H*O,G=K;break;case"right":z=U=o.coordinate,N=h+ +A*_,k=N+H*Y,j=k+H*O,G=K;break;default:k=N=o.coordinate,U=p+ +A*a,z=U+H*Y,G=z+H*O,j=K;break}return{line:{x1:k,y1:z,x2:N,y2:U},tick:{x:j,y:G}}}},{key:"getTickTextAnchor",value:function(){var o=this.props,u=o.orientation,h=o.mirror,p;switch(u){case"left":p=h?"start":"end";break;case"right":p=h?"end":"start";break;default:p="middle";break}return p}},{key:"getTickVerticalAnchor",value:function(){var o=this.props,u=o.orientation,h=o.mirror,p="end";switch(u){case"left":case"right":p="middle";break;case"top":p=h?"start":"end";break;default:p=h?"end":"start";break}return p}},{key:"renderAxisLine",value:function(){var o=this.props,u=o.x,h=o.y,p=o.width,_=o.height,a=o.orientation,b=o.mirror,C=o.axisLine,A=Wo(Wo(Wo({},gr(this.props,!1)),gr(C,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var O=+(a==="top"&&!b||a==="bottom"&&b);A=Wo(Wo({},A),{},{x1:u,y1:h+O*_,x2:u+p,y2:h+O*_})}else{var k=+(a==="left"&&!b||a==="right"&&b);A=Wo(Wo({},A),{},{x1:u+k*p,y1:h,x2:u+k*p,y2:h+_})}return Ye.createElement("line",Vm({},A,{className:Cr("recharts-cartesian-axis-line",vs(C,"className"))}))}},{key:"renderTicks",value:function(o,u,h){var p=this,_=this.props,a=_.tickLine,b=_.stroke,C=_.tick,A=_.tickFormatter,O=_.unit,k=QD(Wo(Wo({},this.props),{},{ticks:o}),u,h),N=this.getTickTextAnchor(),z=this.getTickVerticalAnchor(),U=gr(this.props,!1),j=gr(C,!1),G=Wo(Wo({},U),{},{fill:"none"},gr(a,!1)),H=k.map(function(Y,K){var ee=p.getTickLineCoord(Y),ue=ee.line,ve=ee.tick,Fe=Wo(Wo(Wo(Wo({textAnchor:N,verticalAnchor:z},U),{},{stroke:"none",fill:b},j),ve),{},{index:K,payload:Y,visibleTicksCount:k.length,tickFormatter:A});return Ye.createElement(xi,Vm({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},NS(p.props,Y,K)),a&&Ye.createElement("line",Vm({},G,ue,{className:Cr("recharts-cartesian-axis-tick-line",vs(a,"className"))})),C&&t.renderTickItem(C,Fe,"".concat(hr(A)?A(Y.value,K):Y.value).concat(O||"")))});return Ye.createElement("g",{className:"recharts-cartesian-axis-ticks"},H)}},{key:"render",value:function(){var o=this,u=this.props,h=u.axisLine,p=u.width,_=u.height,a=u.ticksGenerator,b=u.className,C=u.hide;if(C)return null;var A=this.props,O=A.ticks,k=XM(A,ske),N=O;return hr(a)&&(N=O&&O.length>0?a(this.props):a(k)),p<=0||_<=0||!N||!N.length?null:Ye.createElement(xi,{className:Cr("recharts-cartesian-axis",b),ref:function(U){o.layerReference=U}},h&&this.renderAxisLine(),this.renderTicks(N,this.state.fontSize,this.state.letterSpacing),zo.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(o,u,h){var p;return Ye.isValidElement(o)?p=Ye.cloneElement(o,u):hr(o)?p=o(u):p=Ye.createElement(QS,Vm({},u,{className:"recharts-cartesian-axis-tick-value"}),h),p}}])}(W.Component);JD(ly,"displayName","CartesianAxis");JD(ly,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var gke=["x1","y1","x2","y2","key"],yke=["offset"];function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}function V6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Fo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V6(Object(n),!0).forEach(function(o){_ke(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function _ke(e,t,n){return t=vke(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vke(e){var t=xke(e,"string");return Gd(t)=="symbol"?t:t+""}function xke(e,t){if(Gd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Gd(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sd(){return Sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Sd.apply(this,arguments)}function G6(e,t){if(e==null)return{};var n=bke(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function bke(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}var wke=function(t){var n=t.fill;if(!n||n==="none")return null;var o=t.fillOpacity,u=t.x,h=t.y,p=t.width,_=t.height;return Ye.createElement("rect",{x:u,y:h,width:p,height:_,stroke:"none",fill:n,fillOpacity:o,className:"recharts-cartesian-grid-bg"})};function DZ(e,t){var n;if(Ye.isValidElement(e))n=Ye.cloneElement(e,t);else if(hr(e))n=e(t);else{var o=t.x1,u=t.y1,h=t.x2,p=t.y2,_=t.key,a=G6(t,gke),b=gr(a,!1);b.offset;var C=G6(b,yke);n=Ye.createElement("line",Sd({},C,{x1:o,y1:u,x2:h,y2:p,fill:"none",key:_}))}return n}function Ske(e){var t=e.x,n=e.width,o=e.horizontal,u=o===void 0?!0:o,h=e.horizontalPoints;if(!u||!h||!h.length)return null;var p=h.map(function(_,a){var b=Fo(Fo({},e),{},{x1:t,y1:_,x2:t+n,y2:_,key:"line-".concat(a),index:a});return DZ(u,b)});return Ye.createElement("g",{className:"recharts-cartesian-grid-horizontal"},p)}function Tke(e){var t=e.y,n=e.height,o=e.vertical,u=o===void 0?!0:o,h=e.verticalPoints;if(!u||!h||!h.length)return null;var p=h.map(function(_,a){var b=Fo(Fo({},e),{},{x1:_,y1:t,x2:_,y2:t+n,key:"line-".concat(a),index:a});return DZ(u,b)});return Ye.createElement("g",{className:"recharts-cartesian-grid-vertical"},p)}function Eke(e){var t=e.horizontalFill,n=e.fillOpacity,o=e.x,u=e.y,h=e.width,p=e.height,_=e.horizontalPoints,a=e.horizontal,b=a===void 0?!0:a;if(!b||!t||!t.length)return null;var C=_.map(function(O){return Math.round(O+u-u)}).sort(function(O,k){return O-k});u!==C[0]&&C.unshift(0);var A=C.map(function(O,k){var N=!C[k+1],z=N?u+p-O:C[k+1]-O;if(z<=0)return null;var U=k%t.length;return Ye.createElement("rect",{key:"react-".concat(k),y:O,x:o,height:z,width:h,stroke:"none",fill:t[U],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Ye.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},A)}function Ake(e){var t=e.vertical,n=t===void 0?!0:t,o=e.verticalFill,u=e.fillOpacity,h=e.x,p=e.y,_=e.width,a=e.height,b=e.verticalPoints;if(!n||!o||!o.length)return null;var C=b.map(function(O){return Math.round(O+h-h)}).sort(function(O,k){return O-k});h!==C[0]&&C.unshift(0);var A=C.map(function(O,k){var N=!C[k+1],z=N?h+_-O:C[k+1]-O;if(z<=0)return null;var U=k%o.length;return Ye.createElement("rect",{key:"react-".concat(k),x:O,y:p,width:z,height:a,stroke:"none",fill:o[U],fillOpacity:u,className:"recharts-cartesian-grid-bg"})});return Ye.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},A)}var Cke=function(t,n){var o=t.xAxis,u=t.width,h=t.height,p=t.offset;return Hq(QD(Fo(Fo(Fo({},ly.defaultProps),o),{},{ticks:Lu(o,!0),viewBox:{x:0,y:0,width:u,height:h}})),p.left,p.left+p.width,n)},Pke=function(t,n){var o=t.yAxis,u=t.width,h=t.height,p=t.offset;return Hq(QD(Fo(Fo(Fo({},ly.defaultProps),o),{},{ticks:Lu(o,!0),viewBox:{x:0,y:0,width:u,height:h}})),p.top,p.top+p.height,n)},Em={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function LZ(e){var t,n,o,u,h,p,_=ZD(),a=XD(),b=mRe(),C=Fo(Fo({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Em.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Em.fill,horizontal:(o=e.horizontal)!==null&&o!==void 0?o:Em.horizontal,horizontalFill:(u=e.horizontalFill)!==null&&u!==void 0?u:Em.horizontalFill,vertical:(h=e.vertical)!==null&&h!==void 0?h:Em.vertical,verticalFill:(p=e.verticalFill)!==null&&p!==void 0?p:Em.verticalFill,x:Qt(e.x)?e.x:b.left,y:Qt(e.y)?e.y:b.top,width:Qt(e.width)?e.width:b.width,height:Qt(e.height)?e.height:b.height}),A=C.x,O=C.y,k=C.width,N=C.height,z=C.syncWithTicks,U=C.horizontalValues,j=C.verticalValues,G=fRe(),H=dRe();if(!Qt(k)||k<=0||!Qt(N)||N<=0||!Qt(A)||A!==+A||!Qt(O)||O!==+O)return null;var Y=C.verticalCoordinatesGenerator||Cke,K=C.horizontalCoordinatesGenerator||Pke,ee=C.horizontalPoints,ue=C.verticalPoints;if((!ee||!ee.length)&&hr(K)){var ve=U&&U.length,Fe=K({yAxis:H?Fo(Fo({},H),{},{ticks:ve?U:H.ticks}):void 0,width:_,height:a,offset:b},ve?!0:z);Nu(Array.isArray(Fe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Gd(Fe),"]")),Array.isArray(Fe)&&(ee=Fe)}if((!ue||!ue.length)&&hr(Y)){var Ne=j&&j.length,Oe=Y({xAxis:G?Fo(Fo({},G),{},{ticks:Ne?j:G.ticks}):void 0,width:_,height:a,offset:b},Ne?!0:z);Nu(Array.isArray(Oe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Gd(Oe),"]")),Array.isArray(Oe)&&(ue=Oe)}return Ye.createElement("g",{className:"recharts-cartesian-grid"},Ye.createElement(wke,{fill:C.fill,fillOpacity:C.fillOpacity,x:C.x,y:C.y,width:C.width,height:C.height}),Ye.createElement(Ske,Sd({},C,{offset:b,horizontalPoints:ee,xAxis:G,yAxis:H})),Ye.createElement(Tke,Sd({},C,{offset:b,verticalPoints:ue,xAxis:G,yAxis:H})),Ye.createElement(Eke,Sd({},C,{horizontalPoints:ee})),Ye.createElement(Ake,Sd({},C,{verticalPoints:ue})))}LZ.displayName="CartesianGrid";var Mke=["layout","type","stroke","connectNulls","isRange","ref"],Ike=["key"],zZ;function Dg(e){"@babel/helpers - typeof";return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(e)}function FZ(e,t){if(e==null)return{};var n=Oke(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function Oke(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function Td(){return Td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Td.apply(this,arguments)}function W6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function fh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W6(Object(n),!0).forEach(function(o){Bl(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Rke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H6(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,BZ(o.key),o)}}function kke(e,t,n){return t&&H6(e.prototype,t),n&&H6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dke(e,t,n){return t=OT(t),Lke(e,NZ()?Reflect.construct(t,n||[],OT(e).constructor):t.apply(e,n))}function Lke(e,t){if(t&&(Dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zke(e)}function zke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NZ=function(){return!!e})()}function OT(e){return OT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},OT(e)}function Fke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H3(e,t)}function H3(e,t){return H3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},H3(e,t)}function Bl(e,t,n){return t=BZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BZ(e){var t=Nke(e,"string");return Dg(t)=="symbol"?t:t+""}function Nke(e,t){if(Dg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Dg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ef=function(e){function t(){var n;Rke(this,t);for(var o=arguments.length,u=new Array(o),h=0;h<o;h++)u[h]=arguments[h];return n=Dke(this,t,[].concat(u)),Bl(n,"state",{isAnimationFinished:!0}),Bl(n,"id",Ox("recharts-area-")),Bl(n,"handleAnimationEnd",function(){var p=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),hr(p)&&p()}),Bl(n,"handleAnimationStart",function(){var p=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),hr(p)&&p()}),n}return Fke(t,e),kke(t,[{key:"renderDots",value:function(o,u,h){var p=this.props.isAnimationActive,_=this.state.isAnimationFinished;if(p&&!_)return null;var a=this.props,b=a.dot,C=a.points,A=a.dataKey,O=gr(this.props,!1),k=gr(b,!0),N=C.map(function(U,j){var G=fh(fh(fh({key:"dot-".concat(j),r:3},O),k),{},{index:j,cx:U.x,cy:U.y,dataKey:A,value:U.value,payload:U.payload,points:C});return t.renderDotItem(b,G)}),z={clipPath:o?"url(#clipPath-".concat(u?"":"dots-").concat(h,")"):null};return Ye.createElement(xi,Td({className:"recharts-area-dots"},z),N)}},{key:"renderHorizontalRect",value:function(o){var u=this.props,h=u.baseLine,p=u.points,_=u.strokeWidth,a=p[0].x,b=p[p.length-1].x,C=o*Math.abs(a-b),A=Sh(p.map(function(O){return O.y||0}));return Qt(h)&&typeof h=="number"?A=Math.max(h,A):h&&Array.isArray(h)&&h.length&&(A=Math.max(Sh(h.map(function(O){return O.y||0})),A)),Qt(A)?Ye.createElement("rect",{x:a<b?a:a-C,y:0,width:C,height:Math.floor(A+(_?parseInt("".concat(_),10):1))}):null}},{key:"renderVerticalRect",value:function(o){var u=this.props,h=u.baseLine,p=u.points,_=u.strokeWidth,a=p[0].y,b=p[p.length-1].y,C=o*Math.abs(a-b),A=Sh(p.map(function(O){return O.x||0}));return Qt(h)&&typeof h=="number"?A=Math.max(h,A):h&&Array.isArray(h)&&h.length&&(A=Math.max(Sh(h.map(function(O){return O.x||0})),A)),Qt(A)?Ye.createElement("rect",{x:0,y:a<b?a:a-C,width:A+(_?parseInt("".concat(_),10):1),height:Math.floor(C)}):null}},{key:"renderClipRect",value:function(o){var u=this.props.layout;return u==="vertical"?this.renderVerticalRect(o):this.renderHorizontalRect(o)}},{key:"renderAreaStatically",value:function(o,u,h,p){var _=this.props,a=_.layout,b=_.type,C=_.stroke,A=_.connectNulls,O=_.isRange;_.ref;var k=FZ(_,Mke);return Ye.createElement(xi,{clipPath:h?"url(#clipPath-".concat(p,")"):null},Ye.createElement(e0,Td({},gr(k,!0),{points:o,connectNulls:A,type:b,baseLine:u,layout:a,stroke:"none",className:"recharts-area-area"})),C!=="none"&&Ye.createElement(e0,Td({},gr(this.props,!1),{className:"recharts-area-curve",layout:a,type:b,connectNulls:A,fill:"none",points:o})),C!=="none"&&O&&Ye.createElement(e0,Td({},gr(this.props,!1),{className:"recharts-area-curve",layout:a,type:b,connectNulls:A,fill:"none",points:u})))}},{key:"renderAreaWithAnimation",value:function(o,u){var h=this,p=this.props,_=p.points,a=p.baseLine,b=p.isAnimationActive,C=p.animationBegin,A=p.animationDuration,O=p.animationEasing,k=p.animationId,N=this.state,z=N.prevPoints,U=N.prevBaseLine;return Ye.createElement(Ku,{begin:C,duration:A,isActive:b,easing:O,from:{t:0},to:{t:1},key:"area-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var G=j.t;if(z){var H=z.length/_.length,Y=_.map(function(ve,Fe){var Ne=Math.floor(Fe*H);if(z[Ne]){var Oe=z[Ne],Le=ps(Oe.x,ve.x),Ue=ps(Oe.y,ve.y);return fh(fh({},ve),{},{x:Le(G),y:Ue(G)})}return ve}),K;if(Qt(a)&&typeof a=="number"){var ee=ps(U,a);K=ee(G)}else if(Tr(a)||ey(a)){var ue=ps(U,0);K=ue(G)}else K=a.map(function(ve,Fe){var Ne=Math.floor(Fe*H);if(U[Ne]){var Oe=U[Ne],Le=ps(Oe.x,ve.x),Ue=ps(Oe.y,ve.y);return fh(fh({},ve),{},{x:Le(G),y:Ue(G)})}return ve});return h.renderAreaStatically(Y,K,o,u)}return Ye.createElement(xi,null,Ye.createElement("defs",null,Ye.createElement("clipPath",{id:"animationClipPath-".concat(u)},h.renderClipRect(G))),Ye.createElement(xi,{clipPath:"url(#animationClipPath-".concat(u,")")},h.renderAreaStatically(_,a,o,u)))})}},{key:"renderArea",value:function(o,u){var h=this.props,p=h.points,_=h.baseLine,a=h.isAnimationActive,b=this.state,C=b.prevPoints,A=b.prevBaseLine,O=b.totalLength;return a&&p&&p.length&&(!C&&O>0||!B0(C,p)||!B0(A,_))?this.renderAreaWithAnimation(o,u):this.renderAreaStatically(p,_,o,u)}},{key:"render",value:function(){var o,u=this.props,h=u.hide,p=u.dot,_=u.points,a=u.className,b=u.top,C=u.left,A=u.xAxis,O=u.yAxis,k=u.width,N=u.height,z=u.isAnimationActive,U=u.id;if(h||!_||!_.length)return null;var j=this.state.isAnimationFinished,G=_.length===1,H=Cr("recharts-area",a),Y=A&&A.allowDataOverflow,K=O&&O.allowDataOverflow,ee=Y||K,ue=Tr(U)?this.id:U,ve=(o=gr(p,!1))!==null&&o!==void 0?o:{r:3,strokeWidth:2},Fe=ve.r,Ne=Fe===void 0?3:Fe,Oe=ve.strokeWidth,Le=Oe===void 0?2:Oe,Ue=gpe(p)?p:{},et=Ue.clipDot,rt=et===void 0?!0:et,st=Ne*2+Le;return Ye.createElement(xi,{className:H},Y||K?Ye.createElement("defs",null,Ye.createElement("clipPath",{id:"clipPath-".concat(ue)},Ye.createElement("rect",{x:Y?C:C-k/2,y:K?b:b-N/2,width:Y?k:k*2,height:K?N:N*2})),!rt&&Ye.createElement("clipPath",{id:"clipPath-dots-".concat(ue)},Ye.createElement("rect",{x:C-st/2,y:b-st/2,width:k+st,height:N+st}))):null,G?null:this.renderArea(ee,ue),(p||G)&&this.renderDots(ee,rt,ue),(!z||j)&&zh.renderCallByParent(this.props,_))}}],[{key:"getDerivedStateFromProps",value:function(o,u){return o.animationId!==u.prevAnimationId?{prevAnimationId:o.animationId,curPoints:o.points,curBaseLine:o.baseLine,prevPoints:u.curPoints,prevBaseLine:u.curBaseLine}:o.points!==u.curPoints||o.baseLine!==u.curBaseLine?{curPoints:o.points,curBaseLine:o.baseLine}:null}}])}(W.PureComponent);zZ=ef;Bl(ef,"displayName","Area");Bl(ef,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Bu.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Bl(ef,"getBaseValue",function(e,t,n,o){var u=e.layout,h=e.baseValue,p=t.props.baseValue,_=p??h;if(Qt(_)&&typeof _=="number")return _;var a=u==="horizontal"?o:n,b=a.scale.domain();if(a.type==="number"){var C=Math.max(b[0],b[1]),A=Math.min(b[0],b[1]);return _==="dataMin"?A:_==="dataMax"||C<0?C:Math.max(Math.min(b[0],b[1]),0)}return _==="dataMin"?b[0]:_==="dataMax"?b[1]:b[0]});Bl(ef,"getComposedData",function(e){var t=e.props,n=e.item,o=e.xAxis,u=e.yAxis,h=e.xAxisTicks,p=e.yAxisTicks,_=e.bandSize,a=e.dataKey,b=e.stackedData,C=e.dataStartIndex,A=e.displayedData,O=e.offset,k=t.layout,N=b&&b.length,z=zZ.getBaseValue(t,n,o,u),U=k==="horizontal",j=!1,G=A.map(function(Y,K){var ee;N?ee=b[C+K]:(ee=Ga(Y,a),Array.isArray(ee)?j=!0:ee=[z,ee]);var ue=ee[1]==null||N&&Ga(Y,a)==null;return U?{x:C$({axis:o,ticks:h,bandSize:_,entry:Y,index:K}),y:ue?null:u.scale(ee[1]),value:ee,payload:Y}:{x:ue?null:o.scale(ee[1]),y:C$({axis:u,ticks:p,bandSize:_,entry:Y,index:K}),value:ee,payload:Y}}),H;return N||j?H=G.map(function(Y){var K=Array.isArray(Y.value)?Y.value[0]:null;return U?{x:Y.x,y:K!=null&&Y.y!=null?u.scale(K):null}:{x:K!=null?o.scale(K):null,y:Y.y}}):H=U?u.scale(z):o.scale(z),fh({points:G,baseLine:H,layout:k,isRange:j},O)});Bl(ef,"renderDotItem",function(e,t){var n;if(Ye.isValidElement(e))n=Ye.cloneElement(e,t);else if(hr(e))n=e(t);else{var o=Cr("recharts-area-dot",typeof e!="boolean"?e.className:""),u=t.key,h=FZ(t,Ike);n=Ye.createElement(GD,Td({key:u},h,{className:o}))}return n});function Lg(e){"@babel/helpers - typeof";return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lg(e)}function Bke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jke(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,UZ(o.key),o)}}function $ke(e,t,n){return t&&jke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uke(e,t,n){return t=RT(t),Vke(e,jZ()?Reflect.construct(t,n||[],RT(e).constructor):t.apply(e,n))}function Vke(e,t){if(t&&(Lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gke(e)}function Gke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jZ=function(){return!!e})()}function RT(e){return RT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},RT(e)}function Wke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q3(e,t)}function q3(e,t){return q3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},q3(e,t)}function $Z(e,t,n){return t=UZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UZ(e){var t=Hke(e,"string");return Lg(t)=="symbol"?t:t+""}function Hke(e,t){if(Lg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Lg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z3(){return Z3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Z3.apply(this,arguments)}function qke(e){var t=e.xAxisId,n=ZD(),o=XD(),u=SZ(t);return u==null?null:Ye.createElement(ly,Z3({},u,{className:Cr("recharts-".concat(u.axisType," ").concat(u.axisType),u.className),viewBox:{x:0,y:0,width:n,height:o},ticksGenerator:function(p){return Lu(p,!0)}}))}var uA=function(e){function t(){return Bke(this,t),Uke(this,t,arguments)}return Wke(t,e),$ke(t,[{key:"render",value:function(){return Ye.createElement(qke,this.props)}}])}(Ye.Component);$Z(uA,"displayName","XAxis");$Z(uA,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function zg(e){"@babel/helpers - typeof";return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zg(e)}function Zke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xke(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,WZ(o.key),o)}}function Yke(e,t,n){return t&&Xke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kke(e,t,n){return t=kT(t),Qke(e,VZ()?Reflect.construct(t,n||[],kT(e).constructor):t.apply(e,n))}function Qke(e,t){if(t&&(zg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jke(e)}function Jke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VZ=function(){return!!e})()}function kT(e){return kT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},kT(e)}function eDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X3(e,t)}function X3(e,t){return X3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},X3(e,t)}function GZ(e,t,n){return t=WZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WZ(e){var t=tDe(e,"string");return zg(t)=="symbol"?t:t+""}function tDe(e,t){if(zg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(zg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y3(){return Y3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Y3.apply(this,arguments)}var nDe=function(t){var n=t.yAxisId,o=ZD(),u=XD(),h=TZ(n);return h==null?null:Ye.createElement(ly,Y3({},h,{className:Cr("recharts-".concat(h.axisType," ").concat(h.axisType),h.className),viewBox:{x:0,y:0,width:o,height:u},ticksGenerator:function(_){return Lu(_,!0)}}))},cA=function(e){function t(){return Zke(this,t),Kke(this,t,arguments)}return eDe(t,e),Yke(t,[{key:"render",value:function(){return Ye.createElement(nDe,this.props)}}])}(Ye.Component);GZ(cA,"displayName","YAxis");GZ(cA,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function q6(e){return aDe(e)||oDe(e)||iDe(e)||rDe()}function rDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iDe(e,t){if(e){if(typeof e=="string")return K3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K3(e,t)}}function oDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aDe(e){if(Array.isArray(e))return K3(e)}function K3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var Q3=function(t,n,o,u,h){var p=rl(t,KD),_=rl(t,aA),a=[].concat(q6(p),q6(_)),b=rl(t,lA),C="".concat(u,"Id"),A=u[0],O=n;if(a.length&&(O=a.reduce(function(z,U){if(U.props[C]===o&&Vl(U.props,"extendDomain")&&Qt(U.props[A])){var j=U.props[A];return[Math.min(z[0],j),Math.max(z[1],j)]}return z},O)),b.length){var k="".concat(A,"1"),N="".concat(A,"2");O=b.reduce(function(z,U){if(U.props[C]===o&&Vl(U.props,"extendDomain")&&Qt(U.props[k])&&Qt(U.props[N])){var j=U.props[k],G=U.props[N];return[Math.min(z[0],j,G),Math.max(z[1],j,G)]}return z},O)}return h&&h.length&&(O=h.reduce(function(z,U){return Qt(U)?[Math.min(z[0],U),Math.max(z[1],U)]:z},O)),O},HZ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(n=!1));function u(a,b,C){this.fn=a,this.context=b,this.once=C||!1}function h(a,b,C,A,O){if(typeof C!="function")throw new TypeError("The listener must be a function");var k=new u(C,A||a,O),N=n?n+b:b;return a._events[N]?a._events[N].fn?a._events[N]=[a._events[N],k]:a._events[N].push(k):(a._events[N]=k,a._eventsCount++),a}function p(a,b){--a._eventsCount===0?a._events=new o:delete a._events[b]}function _(){this._events=new o,this._eventsCount=0}_.prototype.eventNames=function(){var b=[],C,A;if(this._eventsCount===0)return b;for(A in C=this._events)t.call(C,A)&&b.push(n?A.slice(1):A);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(C)):b},_.prototype.listeners=function(b){var C=n?n+b:b,A=this._events[C];if(!A)return[];if(A.fn)return[A.fn];for(var O=0,k=A.length,N=new Array(k);O<k;O++)N[O]=A[O].fn;return N},_.prototype.listenerCount=function(b){var C=n?n+b:b,A=this._events[C];return A?A.fn?1:A.length:0},_.prototype.emit=function(b,C,A,O,k,N){var z=n?n+b:b;if(!this._events[z])return!1;var U=this._events[z],j=arguments.length,G,H;if(U.fn){switch(U.once&&this.removeListener(b,U.fn,void 0,!0),j){case 1:return U.fn.call(U.context),!0;case 2:return U.fn.call(U.context,C),!0;case 3:return U.fn.call(U.context,C,A),!0;case 4:return U.fn.call(U.context,C,A,O),!0;case 5:return U.fn.call(U.context,C,A,O,k),!0;case 6:return U.fn.call(U.context,C,A,O,k,N),!0}for(H=1,G=new Array(j-1);H<j;H++)G[H-1]=arguments[H];U.fn.apply(U.context,G)}else{var Y=U.length,K;for(H=0;H<Y;H++)switch(U[H].once&&this.removeListener(b,U[H].fn,void 0,!0),j){case 1:U[H].fn.call(U[H].context);break;case 2:U[H].fn.call(U[H].context,C);break;case 3:U[H].fn.call(U[H].context,C,A);break;case 4:U[H].fn.call(U[H].context,C,A,O);break;default:if(!G)for(K=1,G=new Array(j-1);K<j;K++)G[K-1]=arguments[K];U[H].fn.apply(U[H].context,G)}}return!0},_.prototype.on=function(b,C,A){return h(this,b,C,A,!1)},_.prototype.once=function(b,C,A){return h(this,b,C,A,!0)},_.prototype.removeListener=function(b,C,A,O){var k=n?n+b:b;if(!this._events[k])return this;if(!C)return p(this,k),this;var N=this._events[k];if(N.fn)N.fn===C&&(!O||N.once)&&(!A||N.context===A)&&p(this,k);else{for(var z=0,U=[],j=N.length;z<j;z++)(N[z].fn!==C||O&&!N[z].once||A&&N[z].context!==A)&&U.push(N[z]);U.length?this._events[k]=U.length===1?U[0]:U:p(this,k)}return this},_.prototype.removeAllListeners=function(b){var C;return b?(C=n?n+b:b,this._events[C]&&p(this,C)):(this._events=new o,this._eventsCount=0),this},_.prototype.off=_.prototype.removeListener,_.prototype.addListener=_.prototype.on,_.prefixed=n,_.EventEmitter=_,e.exports=_})(HZ);var sDe=HZ.exports;const lDe=Vr(sDe);var YM=new lDe,KM="recharts.syncMouseEvents";function sx(e){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(e)}function uDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cDe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,qZ(o.key),o)}}function hDe(e,t,n){return t&&cDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QM(e,t,n){return t=qZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qZ(e){var t=fDe(e,"string");return sx(t)=="symbol"?t:t+""}function fDe(e,t){if(sx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t);if(sx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var dDe=function(){function e(){uDe(this,e),QM(this,"activeIndex",0),QM(this,"coordinateList",[]),QM(this,"layout","horizontal")}return hDe(e,[{key:"setDetails",value:function(n){var o,u=n.coordinateList,h=u===void 0?null:u,p=n.container,_=p===void 0?null:p,a=n.layout,b=a===void 0?null:a,C=n.offset,A=C===void 0?null:C,O=n.mouseHandlerCallback,k=O===void 0?null:O;this.coordinateList=(o=h??this.coordinateList)!==null&&o!==void 0?o:[],this.container=_??this.container,this.layout=b??this.layout,this.offset=A??this.offset,this.mouseHandlerCallback=k??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,o;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var u=this.container.getBoundingClientRect(),h=u.x,p=u.y,_=u.height,a=this.coordinateList[this.activeIndex].coordinate,b=((n=window)===null||n===void 0?void 0:n.scrollX)||0,C=((o=window)===null||o===void 0?void 0:o.scrollY)||0,A=h+a+b,O=p+this.offset.top+_/2+C;this.mouseHandlerCallback({pageX:A,pageY:O})}}}])}();function pDe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var o=e==null?void 0:e[0],u=e==null?void 0:e[1];if(o&&u&&Qt(o)&&Qt(u))return!0}return!1}function mDe(e,t,n,o){var u=o/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-u:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-u,width:e==="horizontal"?o:n.width-1,height:e==="horizontal"?n.height-1:o}}function ZZ(e){var t=e.cx,n=e.cy,o=e.radius,u=e.startAngle,h=e.endAngle,p=wo(t,n,o,u),_=wo(t,n,o,h);return{points:[p,_],cx:t,cy:n,radius:o,startAngle:u,endAngle:h}}function gDe(e,t,n){var o,u,h,p;if(e==="horizontal")o=t.x,h=o,u=n.top,p=n.top+n.height;else if(e==="vertical")u=t.y,p=u,o=n.left,h=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var _=t.cx,a=t.cy,b=t.innerRadius,C=t.outerRadius,A=t.angle,O=wo(_,a,b,A),k=wo(_,a,C,A);o=O.x,u=O.y,h=k.x,p=k.y}else return ZZ(t);return[{x:o,y:u},{x:h,y:p}]}function lx(e){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(e)}function Z6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Dw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z6(Object(n),!0).forEach(function(o){yDe(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function yDe(e,t,n){return t=_De(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _De(e){var t=vDe(e,"string");return lx(t)=="symbol"?t:t+""}function vDe(e,t){if(lx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(lx(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xDe(e){var t,n,o=e.element,u=e.tooltipEventType,h=e.isActive,p=e.activeCoordinate,_=e.activePayload,a=e.offset,b=e.activeTooltipIndex,C=e.tooltipAxisBandSize,A=e.layout,O=e.chartName,k=(t=o.props.cursor)!==null&&t!==void 0?t:(n=o.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!o||!k||!h||!p||O!=="ScatterChart"&&u!=="axis")return null;var N,z=e0;if(O==="ScatterChart")N=p,z=SIe;else if(O==="BarChart")N=mDe(A,p,a,C),z=VD;else if(A==="radial"){var U=ZZ(p),j=U.cx,G=U.cy,H=U.radius,Y=U.startAngle,K=U.endAngle;N={cx:j,cy:G,startAngle:Y,endAngle:K,innerRadius:H,outerRadius:H},z=Kq}else N={points:gDe(A,p,a)},z=e0;var ee=Dw(Dw(Dw(Dw({stroke:"#ccc",pointerEvents:"none"},a),N),gr(k,!1)),{},{payload:_,payloadIndex:b,className:Cr("recharts-tooltip-cursor",k.className)});return W.isValidElement(k)?W.cloneElement(k,ee):W.createElement(z,ee)}var bDe=["item"],wDe=["children","className","width","height","style","compact","title","desc"];function Fg(e){"@babel/helpers - typeof";return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fg(e)}function n0(){return n0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n0.apply(this,arguments)}function X6(e,t){return EDe(e)||TDe(e,t)||YZ(e,t)||SDe()}function SDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TDe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o,u,h,p,_=[],a=!0,b=!1;try{if(h=(n=n.call(e)).next,t!==0)for(;!(a=(o=h.call(n)).done)&&(_.push(o.value),_.length!==t);a=!0);}catch(C){b=!0,u=C}finally{try{if(!a&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(b)throw u}}return _}}function EDe(e){if(Array.isArray(e))return e}function Y6(e,t){if(e==null)return{};var n=ADe(e,t),o,u;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(u=0;u<h.length;u++)o=h[u],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function ADe(e,t){if(e==null)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function CDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PDe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,KZ(o.key),o)}}function MDe(e,t,n){return t&&PDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IDe(e,t,n){return t=DT(t),ODe(e,XZ()?Reflect.construct(t,n||[],DT(e).constructor):t.apply(e,n))}function ODe(e,t){if(t&&(Fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RDe(e)}function RDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XZ=function(){return!!e})()}function DT(e){return DT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},DT(e)}function kDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J3(e,t)}function J3(e,t){return J3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,u){return o.__proto__=u,o},J3(e,t)}function Ng(e){return zDe(e)||LDe(e)||YZ(e)||DDe()}function DDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YZ(e,t){if(e){if(typeof e=="string")return eR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eR(e,t)}}function LDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zDe(e){if(Array.isArray(e))return eR(e)}function eR(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function K6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),n.push.apply(n,o)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K6(Object(n),!0).forEach(function(o){jn(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K6(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function jn(e,t,n){return t=KZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KZ(e){var t=FDe(e,"string");return Fg(t)=="symbol"?t:t+""}function FDe(e,t){if(Fg(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(Fg(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NDe={xAxis:["bottom","top"],yAxis:["left","right"]},BDe={width:"100%",height:"100%"},QZ={x:0,y:0};function Lw(e){return e}var jDe=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},$De=function(t,n,o,u){var h=n.find(function(C){return C&&C.index===o});if(h){if(t==="horizontal")return{x:h.coordinate,y:u.y};if(t==="vertical")return{x:u.x,y:h.coordinate};if(t==="centric"){var p=h.coordinate,_=u.radius;return Rt(Rt(Rt({},u),wo(u.cx,u.cy,_,p)),{},{angle:p,radius:_})}var a=h.coordinate,b=u.angle;return Rt(Rt(Rt({},u),wo(u.cx,u.cy,a,b)),{},{angle:b,radius:a})}return QZ},hA=function(t,n){var o=n.graphicalItems,u=n.dataStartIndex,h=n.dataEndIndex,p=(o??[]).reduce(function(_,a){var b=a.props.data;return b&&b.length?[].concat(Ng(_),Ng(b)):_},[]);return p.length>0?p:t&&t.length&&Qt(u)&&Qt(h)?t.slice(u,h+1):[]};function JZ(e){return e==="number"?[0,"auto"]:void 0}var tR=function(t,n,o,u){var h=t.graphicalItems,p=t.tooltipAxis,_=hA(n,t);return o<0||!h||!h.length||o>=_.length?null:h.reduce(function(a,b){var C,A=(C=b.props.data)!==null&&C!==void 0?C:n;A&&t.dataStartIndex+t.dataEndIndex!==0&&(A=A.slice(t.dataStartIndex,t.dataEndIndex+1));var O;if(p.dataKey&&!p.allowDuplicatedCategory){var k=A===void 0?_:A;O=zS(k,p.dataKey,u)}else O=A&&A[o]||_[o];return O?[].concat(Ng(a),[Zq(b,O)]):a},[])},Q6=function(t,n,o,u){var h=u||{x:t.chartX,y:t.chartY},p=jDe(h,o),_=t.orderedTooltipTicks,a=t.tooltipAxis,b=t.tooltipTicks,C=xCe(p,_,b,a);if(C>=0&&b){var A=b[C]&&b[C].value,O=tR(t,n,C,A),k=$De(o,_,C,h);return{activeTooltipIndex:C,activeLabel:A,activePayload:O,activeCoordinate:k}}return null},UDe=function(t,n){var o=n.axes,u=n.graphicalItems,h=n.axisType,p=n.axisIdKey,_=n.stackGroups,a=n.dataStartIndex,b=n.dataEndIndex,C=t.layout,A=t.children,O=t.stackOffset,k=Wq(C,h);return o.reduce(function(N,z){var U,j=z.type.defaultProps!==void 0?Rt(Rt({},z.type.defaultProps),z.props):z.props,G=j.type,H=j.dataKey,Y=j.allowDataOverflow,K=j.allowDuplicatedCategory,ee=j.scale,ue=j.ticks,ve=j.includeHidden,Fe=j[p];if(N[Fe])return N;var Ne=hA(t.data,{graphicalItems:u.filter(function(gt){var Se,qt=p in gt.props?gt.props[p]:(Se=gt.type.defaultProps)===null||Se===void 0?void 0:Se[p];return qt===Fe}),dataStartIndex:a,dataEndIndex:b}),Oe=Ne.length,Le,Ue,et;pDe(j.domain,Y,G)&&(Le=x3(j.domain,null,Y),k&&(G==="number"||ee!=="auto")&&(et=Jv(Ne,H,"category")));var rt=JZ(G);if(!Le||Le.length===0){var st,Ke=(st=j.domain)!==null&&st!==void 0?st:rt;if(H){if(Le=Jv(Ne,H,G),G==="category"&&k){var Ze=spe(Le);K&&Ze?(Ue=Le,Le=bT(0,Oe)):K||(Le=O$(Ke,Le,z).reduce(function(gt,Se){return gt.indexOf(Se)>=0?gt:[].concat(Ng(gt),[Se])},[]))}else if(G==="category")K?Le=Le.filter(function(gt){return gt!==""&&!Tr(gt)}):Le=O$(Ke,Le,z).reduce(function(gt,Se){return gt.indexOf(Se)>=0||Se===""||Tr(Se)?gt:[].concat(Ng(gt),[Se])},[]);else if(G==="number"){var Xe=ECe(Ne,u.filter(function(gt){var Se,qt,an=p in gt.props?gt.props[p]:(Se=gt.type.defaultProps)===null||Se===void 0?void 0:Se[p],dn="hide"in gt.props?gt.props.hide:(qt=gt.type.defaultProps)===null||qt===void 0?void 0:qt.hide;return an===Fe&&(ve||!dn)}),H,h,C);Xe&&(Le=Xe)}k&&(G==="number"||ee!=="auto")&&(et=Jv(Ne,H,"category"))}else k?Le=bT(0,Oe):_&&_[Fe]&&_[Fe].hasStack&&G==="number"?Le=O==="expand"?[0,1]:qq(_[Fe].stackGroups,a,b):Le=Gq(Ne,u.filter(function(gt){var Se=p in gt.props?gt.props[p]:gt.type.defaultProps[p],qt="hide"in gt.props?gt.props.hide:gt.type.defaultProps.hide;return Se===Fe&&(ve||!qt)}),G,C,!0);if(G==="number")Le=Q3(A,Le,Fe,h,ue),Ke&&(Le=x3(Ke,Le,Y));else if(G==="category"&&Ke){var de=Ke,lt=Le.every(function(gt){return de.indexOf(gt)>=0});lt&&(Le=de)}}return Rt(Rt({},N),{},jn({},Fe,Rt(Rt({},j),{},{axisType:h,domain:Le,categoricalDomain:et,duplicateDomain:Ue,originalDomain:(U=j.domain)!==null&&U!==void 0?U:rt,isCategorical:k,layout:C})))},{})},VDe=function(t,n){var o=n.graphicalItems,u=n.Axis,h=n.axisType,p=n.axisIdKey,_=n.stackGroups,a=n.dataStartIndex,b=n.dataEndIndex,C=t.layout,A=t.children,O=hA(t.data,{graphicalItems:o,dataStartIndex:a,dataEndIndex:b}),k=O.length,N=Wq(C,h),z=-1;return o.reduce(function(U,j){var G=j.type.defaultProps!==void 0?Rt(Rt({},j.type.defaultProps),j.props):j.props,H=G[p],Y=JZ("number");if(!U[H]){z++;var K;return N?K=bT(0,k):_&&_[H]&&_[H].hasStack?(K=qq(_[H].stackGroups,a,b),K=Q3(A,K,H,h)):(K=x3(Y,Gq(O,o.filter(function(ee){var ue,ve,Fe=p in ee.props?ee.props[p]:(ue=ee.type.defaultProps)===null||ue===void 0?void 0:ue[p],Ne="hide"in ee.props?ee.props.hide:(ve=ee.type.defaultProps)===null||ve===void 0?void 0:ve.hide;return Fe===H&&!Ne}),"number",C),u.defaultProps.allowDataOverflow),K=Q3(A,K,H,h)),Rt(Rt({},U),{},jn({},H,Rt(Rt({axisType:h},u.defaultProps),{},{hide:!0,orientation:vs(NDe,"".concat(h,".").concat(z%2),null),domain:K,originalDomain:Y,isCategorical:N,layout:C})))}return U},{})},GDe=function(t,n){var o=n.axisType,u=o===void 0?"xAxis":o,h=n.AxisComp,p=n.graphicalItems,_=n.stackGroups,a=n.dataStartIndex,b=n.dataEndIndex,C=t.children,A="".concat(u,"Id"),O=rl(C,h),k={};return O&&O.length?k=UDe(t,{axes:O,graphicalItems:p,axisType:u,axisIdKey:A,stackGroups:_,dataStartIndex:a,dataEndIndex:b}):p&&p.length&&(k=VDe(t,{Axis:h,graphicalItems:p,axisType:u,axisIdKey:A,stackGroups:_,dataStartIndex:a,dataEndIndex:b})),k},WDe=function(t){var n=_h(t),o=Lu(n,!1,!0);return{tooltipTicks:o,orderedTooltipTicks:gD(o,function(u){return u.coordinate}),tooltipAxis:n,tooltipAxisBandSize:fT(n,o)}},J6=function(t){var n=t.children,o=t.defaultShowTooltip,u=La(n,Pg),h=0,p=0;return t.data&&t.data.length!==0&&(p=t.data.length-1),u&&u.props&&(u.props.startIndex>=0&&(h=u.props.startIndex),u.props.endIndex>=0&&(p=u.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:h,dataEndIndex:p,activeTooltipIndex:-1,isTooltipActive:!!o}},HDe=function(t){return!t||!t.length?!1:t.some(function(n){var o=Fu(n&&n.type);return o&&o.indexOf("Bar")>=0})},eU=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},qDe=function(t,n){var o=t.props,u=t.graphicalItems,h=t.xAxisMap,p=h===void 0?{}:h,_=t.yAxisMap,a=_===void 0?{}:_,b=o.width,C=o.height,A=o.children,O=o.margin||{},k=La(A,Pg),N=La(A,tg),z=Object.keys(a).reduce(function(K,ee){var ue=a[ee],ve=ue.orientation;return!ue.mirror&&!ue.hide?Rt(Rt({},K),{},jn({},ve,K[ve]+ue.width)):K},{left:O.left||0,right:O.right||0}),U=Object.keys(p).reduce(function(K,ee){var ue=p[ee],ve=ue.orientation;return!ue.mirror&&!ue.hide?Rt(Rt({},K),{},jn({},ve,vs(K,"".concat(ve))+ue.height)):K},{top:O.top||0,bottom:O.bottom||0}),j=Rt(Rt({},U),z),G=j.bottom;k&&(j.bottom+=k.props.height||Pg.defaultProps.height),N&&n&&(j=SCe(j,u,o,n));var H=b-j.left-j.right,Y=C-j.top-j.bottom;return Rt(Rt({brushBottom:G},j),{},{width:Math.max(H,0),height:Math.max(Y,0)})},ZDe=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},XDe=function(t){var n,o=t.chartName,u=t.GraphicalChild,h=t.defaultTooltipEventType,p=h===void 0?"axis":h,_=t.validateTooltipEventTypes,a=_===void 0?["axis"]:_,b=t.axisComponents,C=t.legendContent,A=t.formatAxisMap,O=t.defaultProps,k=function(U,j){var G=j.graphicalItems,H=j.stackGroups,Y=j.offset,K=j.updateId,ee=j.dataStartIndex,ue=j.dataEndIndex,ve=U.barSize,Fe=U.layout,Ne=U.barGap,Oe=U.barCategoryGap,Le=U.maxBarSize,Ue=eU(Fe),et=Ue.numericAxisName,rt=Ue.cateAxisName,st=HDe(G),Ke=[];return G.forEach(function(Ze,Xe){var de=hA(U.data,{graphicalItems:[Ze],dataStartIndex:ee,dataEndIndex:ue}),lt=Ze.type.defaultProps!==void 0?Rt(Rt({},Ze.type.defaultProps),Ze.props):Ze.props,gt=lt.dataKey,Se=lt.maxBarSize,qt=lt["".concat(et,"Id")],an=lt["".concat(rt,"Id")],dn={},Wt=b.reduce(function(nn,rn){var ea=j["".concat(rn.axisType,"Map")],Ci=lt["".concat(rn.axisType,"Id")];ea&&ea[Ci]||rn.axisType==="zAxis"||Vd();var ta=ea[Ci];return Rt(Rt({},nn),{},jn(jn({},rn.axisType,ta),"".concat(rn.axisType,"Ticks"),Lu(ta)))},dn),An=Wt[rt],ht=Wt["".concat(rt,"Ticks")],Zt=H&&H[qt]&&H[qt].hasStack&&FCe(Ze,H[qt].stackGroups),jt=Fu(Ze.type).indexOf("Bar")>=0,At=fT(An,ht),er=[],Rn=st&&bCe({barSize:ve,stackGroups:H,totalSize:ZDe(Wt,rt)});if(jt){var _r,dr,vr=Tr(Se)?Le:Se,Zr=(_r=(dr=fT(An,ht,!0))!==null&&dr!==void 0?dr:vr)!==null&&_r!==void 0?_r:0;er=wCe({barGap:Ne,barCategoryGap:Oe,bandSize:Zr!==At?Zr:At,sizeList:Rn[an],maxBarSize:vr}),Zr!==At&&(er=er.map(function(nn){return Rt(Rt({},nn),{},{position:Rt(Rt({},nn.position),{},{offset:nn.position.offset-Zr/2})})}))}var Ii=Ze&&Ze.type&&Ze.type.getComposedData;Ii&&Ke.push({props:Rt(Rt({},Ii(Rt(Rt({},Wt),{},{displayedData:de,props:U,dataKey:gt,item:Ze,bandSize:At,barPosition:er,offset:Y,stackedData:Zt,layout:Fe,dataStartIndex:ee,dataEndIndex:ue}))),{},jn(jn(jn({key:Ze.key||"item-".concat(Xe)},et,Wt[et]),rt,Wt[rt]),"animationId",K)),childIndex:vpe(Ze,U.children),item:Ze})}),Ke},N=function(U,j){var G=U.props,H=U.dataStartIndex,Y=U.dataEndIndex,K=U.updateId;if(!Tj({props:G}))return null;var ee=G.children,ue=G.layout,ve=G.stackOffset,Fe=G.data,Ne=G.reverseStackOrder,Oe=eU(ue),Le=Oe.numericAxisName,Ue=Oe.cateAxisName,et=rl(ee,u),rt=DCe(Fe,et,"".concat(Le,"Id"),"".concat(Ue,"Id"),ve,Ne),st=b.reduce(function(lt,gt){var Se="".concat(gt.axisType,"Map");return Rt(Rt({},lt),{},jn({},Se,GDe(G,Rt(Rt({},gt),{},{graphicalItems:et,stackGroups:gt.axisType===Le&&rt,dataStartIndex:H,dataEndIndex:Y}))))},{}),Ke=qDe(Rt(Rt({},st),{},{props:G,graphicalItems:et}),j==null?void 0:j.legendBBox);Object.keys(st).forEach(function(lt){st[lt]=A(G,st[lt],Ke,lt.replace("Map",""),o)});var Ze=st["".concat(Ue,"Map")],Xe=WDe(Ze),de=k(G,Rt(Rt({},st),{},{dataStartIndex:H,dataEndIndex:Y,updateId:K,graphicalItems:et,stackGroups:rt,offset:Ke}));return Rt(Rt({formattedGraphicalItems:de,graphicalItems:et,offset:Ke,stackGroups:rt},Xe),st)};return n=function(z){function U(j){var G,H,Y;return CDe(this,U),Y=IDe(this,U,[j]),jn(Y,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),jn(Y,"accessibilityManager",new dDe),jn(Y,"handleLegendBBoxUpdate",function(K){if(K){var ee=Y.state,ue=ee.dataStartIndex,ve=ee.dataEndIndex,Fe=ee.updateId;Y.setState(Rt({legendBBox:K},N({props:Y.props,dataStartIndex:ue,dataEndIndex:ve,updateId:Fe},Rt(Rt({},Y.state),{},{legendBBox:K}))))}}),jn(Y,"handleReceiveSyncEvent",function(K,ee,ue){if(Y.props.syncId===K){if(ue===Y.eventEmitterSymbol&&typeof Y.props.syncMethod!="function")return;Y.applySyncEvent(ee)}}),jn(Y,"handleBrushChange",function(K){var ee=K.startIndex,ue=K.endIndex;if(ee!==Y.state.dataStartIndex||ue!==Y.state.dataEndIndex){var ve=Y.state.updateId;Y.setState(function(){return Rt({dataStartIndex:ee,dataEndIndex:ue},N({props:Y.props,dataStartIndex:ee,dataEndIndex:ue,updateId:ve},Y.state))}),Y.triggerSyncEvent({dataStartIndex:ee,dataEndIndex:ue})}}),jn(Y,"handleMouseEnter",function(K){var ee=Y.getMouseInfo(K);if(ee){var ue=Rt(Rt({},ee),{},{isTooltipActive:!0});Y.setState(ue),Y.triggerSyncEvent(ue);var ve=Y.props.onMouseEnter;hr(ve)&&ve(ue,K)}}),jn(Y,"triggeredAfterMouseMove",function(K){var ee=Y.getMouseInfo(K),ue=ee?Rt(Rt({},ee),{},{isTooltipActive:!0}):{isTooltipActive:!1};Y.setState(ue),Y.triggerSyncEvent(ue);var ve=Y.props.onMouseMove;hr(ve)&&ve(ue,K)}),jn(Y,"handleItemMouseEnter",function(K){Y.setState(function(){return{isTooltipActive:!0,activeItem:K,activePayload:K.tooltipPayload,activeCoordinate:K.tooltipPosition||{x:K.cx,y:K.cy}}})}),jn(Y,"handleItemMouseLeave",function(){Y.setState(function(){return{isTooltipActive:!1}})}),jn(Y,"handleMouseMove",function(K){K.persist(),Y.throttleTriggeredAfterMouseMove(K)}),jn(Y,"handleMouseLeave",function(K){Y.throttleTriggeredAfterMouseMove.cancel();var ee={isTooltipActive:!1};Y.setState(ee),Y.triggerSyncEvent(ee);var ue=Y.props.onMouseLeave;hr(ue)&&ue(ee,K)}),jn(Y,"handleOuterEvent",function(K){var ee=_pe(K),ue=vs(Y.props,"".concat(ee));if(ee&&hr(ue)){var ve,Fe;/.*touch.*/i.test(ee)?Fe=Y.getMouseInfo(K.changedTouches[0]):Fe=Y.getMouseInfo(K),ue((ve=Fe)!==null&&ve!==void 0?ve:{},K)}}),jn(Y,"handleClick",function(K){var ee=Y.getMouseInfo(K);if(ee){var ue=Rt(Rt({},ee),{},{isTooltipActive:!0});Y.setState(ue),Y.triggerSyncEvent(ue);var ve=Y.props.onClick;hr(ve)&&ve(ue,K)}}),jn(Y,"handleMouseDown",function(K){var ee=Y.props.onMouseDown;if(hr(ee)){var ue=Y.getMouseInfo(K);ee(ue,K)}}),jn(Y,"handleMouseUp",function(K){var ee=Y.props.onMouseUp;if(hr(ee)){var ue=Y.getMouseInfo(K);ee(ue,K)}}),jn(Y,"handleTouchMove",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&Y.throttleTriggeredAfterMouseMove(K.changedTouches[0])}),jn(Y,"handleTouchStart",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&Y.handleMouseDown(K.changedTouches[0])}),jn(Y,"handleTouchEnd",function(K){K.changedTouches!=null&&K.changedTouches.length>0&&Y.handleMouseUp(K.changedTouches[0])}),jn(Y,"triggerSyncEvent",function(K){Y.props.syncId!==void 0&&YM.emit(KM,Y.props.syncId,K,Y.eventEmitterSymbol)}),jn(Y,"applySyncEvent",function(K){var ee=Y.props,ue=ee.layout,ve=ee.syncMethod,Fe=Y.state.updateId,Ne=K.dataStartIndex,Oe=K.dataEndIndex;if(K.dataStartIndex!==void 0||K.dataEndIndex!==void 0)Y.setState(Rt({dataStartIndex:Ne,dataEndIndex:Oe},N({props:Y.props,dataStartIndex:Ne,dataEndIndex:Oe,updateId:Fe},Y.state)));else if(K.activeTooltipIndex!==void 0){var Le=K.chartX,Ue=K.chartY,et=K.activeTooltipIndex,rt=Y.state,st=rt.offset,Ke=rt.tooltipTicks;if(!st)return;if(typeof ve=="function")et=ve(Ke,K);else if(ve==="value"){et=-1;for(var Ze=0;Ze<Ke.length;Ze++)if(Ke[Ze].value===K.activeLabel){et=Ze;break}}var Xe=Rt(Rt({},st),{},{x:st.left,y:st.top}),de=Math.min(Le,Xe.x+Xe.width),lt=Math.min(Ue,Xe.y+Xe.height),gt=Ke[et]&&Ke[et].value,Se=tR(Y.state,Y.props.data,et),qt=Ke[et]?{x:ue==="horizontal"?Ke[et].coordinate:de,y:ue==="horizontal"?lt:Ke[et].coordinate}:QZ;Y.setState(Rt(Rt({},K),{},{activeLabel:gt,activeCoordinate:qt,activePayload:Se,activeTooltipIndex:et}))}else Y.setState(K)}),jn(Y,"renderCursor",function(K){var ee,ue=Y.state,ve=ue.isTooltipActive,Fe=ue.activeCoordinate,Ne=ue.activePayload,Oe=ue.offset,Le=ue.activeTooltipIndex,Ue=ue.tooltipAxisBandSize,et=Y.getTooltipEventType(),rt=(ee=K.props.active)!==null&&ee!==void 0?ee:ve,st=Y.props.layout,Ke=K.key||"_recharts-cursor";return Ye.createElement(xDe,{key:Ke,activeCoordinate:Fe,activePayload:Ne,activeTooltipIndex:Le,chartName:o,element:K,isActive:rt,layout:st,offset:Oe,tooltipAxisBandSize:Ue,tooltipEventType:et})}),jn(Y,"renderPolarAxis",function(K,ee,ue){var ve=vs(K,"type.axisType"),Fe=vs(Y.state,"".concat(ve,"Map")),Ne=K.type.defaultProps,Oe=Ne!==void 0?Rt(Rt({},Ne),K.props):K.props,Le=Fe&&Fe[Oe["".concat(ve,"Id")]];return W.cloneElement(K,Rt(Rt({},Le),{},{className:Cr(ve,Le.className),key:K.key||"".concat(ee,"-").concat(ue),ticks:Lu(Le,!0)}))}),jn(Y,"renderPolarGrid",function(K){var ee=K.props,ue=ee.radialLines,ve=ee.polarAngles,Fe=ee.polarRadius,Ne=Y.state,Oe=Ne.radiusAxisMap,Le=Ne.angleAxisMap,Ue=_h(Oe),et=_h(Le),rt=et.cx,st=et.cy,Ke=et.innerRadius,Ze=et.outerRadius;return W.cloneElement(K,{polarAngles:Array.isArray(ve)?ve:Lu(et,!0).map(function(Xe){return Xe.coordinate}),polarRadius:Array.isArray(Fe)?Fe:Lu(Ue,!0).map(function(Xe){return Xe.coordinate}),cx:rt,cy:st,innerRadius:Ke,outerRadius:Ze,key:K.key||"polar-grid",radialLines:ue})}),jn(Y,"renderLegend",function(){var K=Y.state.formattedGraphicalItems,ee=Y.props,ue=ee.children,ve=ee.width,Fe=ee.height,Ne=Y.props.margin||{},Oe=ve-(Ne.left||0)-(Ne.right||0),Le=Uq({children:ue,formattedGraphicalItems:K,legendWidth:Oe,legendContent:C});if(!Le)return null;var Ue=Le.item,et=Y6(Le,bDe);return W.cloneElement(Ue,Rt(Rt({},et),{},{chartWidth:ve,chartHeight:Fe,margin:Ne,onBBoxUpdate:Y.handleLegendBBoxUpdate}))}),jn(Y,"renderTooltip",function(){var K,ee=Y.props,ue=ee.children,ve=ee.accessibilityLayer,Fe=La(ue,Dl);if(!Fe)return null;var Ne=Y.state,Oe=Ne.isTooltipActive,Le=Ne.activeCoordinate,Ue=Ne.activePayload,et=Ne.activeLabel,rt=Ne.offset,st=(K=Fe.props.active)!==null&&K!==void 0?K:Oe;return W.cloneElement(Fe,{viewBox:Rt(Rt({},rt),{},{x:rt.left,y:rt.top}),active:st,label:et,payload:st?Ue:[],coordinate:Le,accessibilityLayer:ve})}),jn(Y,"renderBrush",function(K){var ee=Y.props,ue=ee.margin,ve=ee.data,Fe=Y.state,Ne=Fe.offset,Oe=Fe.dataStartIndex,Le=Fe.dataEndIndex,Ue=Fe.updateId;return W.cloneElement(K,{key:K.key||"_recharts-brush",onChange:Iw(Y.handleBrushChange,K.props.onChange),data:ve,x:Qt(K.props.x)?K.props.x:Ne.left,y:Qt(K.props.y)?K.props.y:Ne.top+Ne.height+Ne.brushBottom-(ue.bottom||0),width:Qt(K.props.width)?K.props.width:Ne.width,startIndex:Oe,endIndex:Le,updateId:"brush-".concat(Ue)})}),jn(Y,"renderReferenceElement",function(K,ee,ue){if(!K)return null;var ve=Y,Fe=ve.clipPathId,Ne=Y.state,Oe=Ne.xAxisMap,Le=Ne.yAxisMap,Ue=Ne.offset,et=K.type.defaultProps||{},rt=K.props,st=rt.xAxisId,Ke=st===void 0?et.xAxisId:st,Ze=rt.yAxisId,Xe=Ze===void 0?et.yAxisId:Ze;return W.cloneElement(K,{key:K.key||"".concat(ee,"-").concat(ue),xAxis:Oe[Ke],yAxis:Le[Xe],viewBox:{x:Ue.left,y:Ue.top,width:Ue.width,height:Ue.height},clipPathId:Fe})}),jn(Y,"renderActivePoints",function(K){var ee=K.item,ue=K.activePoint,ve=K.basePoint,Fe=K.childIndex,Ne=K.isRange,Oe=[],Le=ee.props.key,Ue=ee.item.type.defaultProps!==void 0?Rt(Rt({},ee.item.type.defaultProps),ee.item.props):ee.item.props,et=Ue.activeDot,rt=Ue.dataKey,st=Rt(Rt({index:Fe,dataKey:rt,cx:ue.x,cy:ue.y,r:4,fill:UD(ee.item),strokeWidth:2,stroke:"#fff",payload:ue.payload,value:ue.value},gr(et,!1)),FS(et));return Oe.push(U.renderActiveDot(et,st,"".concat(Le,"-activePoint-").concat(Fe))),ve?Oe.push(U.renderActiveDot(et,Rt(Rt({},st),{},{cx:ve.x,cy:ve.y}),"".concat(Le,"-basePoint-").concat(Fe))):Ne&&Oe.push(null),Oe}),jn(Y,"renderGraphicChild",function(K,ee,ue){var ve=Y.filterFormatItem(K,ee,ue);if(!ve)return null;var Fe=Y.getTooltipEventType(),Ne=Y.state,Oe=Ne.isTooltipActive,Le=Ne.tooltipAxis,Ue=Ne.activeTooltipIndex,et=Ne.activeLabel,rt=Y.props.children,st=La(rt,Dl),Ke=ve.props,Ze=Ke.points,Xe=Ke.isRange,de=Ke.baseLine,lt=ve.item.type.defaultProps!==void 0?Rt(Rt({},ve.item.type.defaultProps),ve.item.props):ve.item.props,gt=lt.activeDot,Se=lt.hide,qt=lt.activeBar,an=lt.activeShape,dn=!!(!Se&&Oe&&st&&(gt||qt||an)),Wt={};Fe!=="axis"&&st&&st.props.trigger==="click"?Wt={onClick:Iw(Y.handleItemMouseEnter,K.props.onClick)}:Fe!=="axis"&&(Wt={onMouseLeave:Iw(Y.handleItemMouseLeave,K.props.onMouseLeave),onMouseEnter:Iw(Y.handleItemMouseEnter,K.props.onMouseEnter)});var An=W.cloneElement(K,Rt(Rt({},ve.props),Wt));function ht(rn){return typeof Le.dataKey=="function"?Le.dataKey(rn.payload):null}if(dn)if(Ue>=0){var Zt,jt;if(Le.dataKey&&!Le.allowDuplicatedCategory){var At=typeof Le.dataKey=="function"?ht:"payload.".concat(Le.dataKey.toString());Zt=zS(Ze,At,et),jt=Xe&&de&&zS(de,At,et)}else Zt=Ze==null?void 0:Ze[Ue],jt=Xe&&de&&de[Ue];if(an||qt){var er=K.props.activeIndex!==void 0?K.props.activeIndex:Ue;return[W.cloneElement(K,Rt(Rt(Rt({},ve.props),Wt),{},{activeIndex:er})),null,null]}if(!Tr(Zt))return[An].concat(Ng(Y.renderActivePoints({item:ve,activePoint:Zt,basePoint:jt,childIndex:Ue,isRange:Xe})))}else{var Rn,_r=(Rn=Y.getItemByXY(Y.state.activeCoordinate))!==null&&Rn!==void 0?Rn:{graphicalItem:An},dr=_r.graphicalItem,vr=dr.item,Zr=vr===void 0?K:vr,Ii=dr.childIndex,nn=Rt(Rt(Rt({},ve.props),Wt),{},{activeIndex:Ii});return[W.cloneElement(Zr,nn),null,null]}return Xe?[An,null,null]:[An,null]}),jn(Y,"renderCustomized",function(K,ee,ue){return W.cloneElement(K,Rt(Rt({key:"recharts-customized-".concat(ue)},Y.props),Y.state))}),jn(Y,"renderMap",{CartesianGrid:{handler:Lw,once:!0},ReferenceArea:{handler:Y.renderReferenceElement},ReferenceLine:{handler:Lw},ReferenceDot:{handler:Y.renderReferenceElement},XAxis:{handler:Lw},YAxis:{handler:Lw},Brush:{handler:Y.renderBrush,once:!0},Bar:{handler:Y.renderGraphicChild},Line:{handler:Y.renderGraphicChild},Area:{handler:Y.renderGraphicChild},Radar:{handler:Y.renderGraphicChild},RadialBar:{handler:Y.renderGraphicChild},Scatter:{handler:Y.renderGraphicChild},Pie:{handler:Y.renderGraphicChild},Funnel:{handler:Y.renderGraphicChild},Tooltip:{handler:Y.renderCursor,once:!0},PolarGrid:{handler:Y.renderPolarGrid,once:!0},PolarAngleAxis:{handler:Y.renderPolarAxis},PolarRadiusAxis:{handler:Y.renderPolarAxis},Customized:{handler:Y.renderCustomized}}),Y.clipPathId="".concat((G=j.id)!==null&&G!==void 0?G:Ox("recharts"),"-clip"),Y.throttleTriggeredAfterMouseMove=$9(Y.triggeredAfterMouseMove,(H=j.throttleDelay)!==null&&H!==void 0?H:1e3/60),Y.state={},Y}return kDe(U,z),MDe(U,[{key:"componentDidMount",value:function(){var G,H;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(G=this.props.margin.left)!==null&&G!==void 0?G:0,top:(H=this.props.margin.top)!==null&&H!==void 0?H:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var G=this.props,H=G.children,Y=G.data,K=G.height,ee=G.layout,ue=La(H,Dl);if(ue){var ve=ue.props.defaultIndex;if(!(typeof ve!="number"||ve<0||ve>this.state.tooltipTicks.length)){var Fe=this.state.tooltipTicks[ve]&&this.state.tooltipTicks[ve].value,Ne=tR(this.state,Y,ve,Fe),Oe=this.state.tooltipTicks[ve].coordinate,Le=(this.state.offset.top+K)/2,Ue=ee==="horizontal",et=Ue?{x:Oe,y:Le}:{y:Oe,x:Le},rt=this.state.formattedGraphicalItems.find(function(Ke){var Ze=Ke.item;return Ze.type.name==="Scatter"});rt&&(et=Rt(Rt({},et),rt.props.points[ve].tooltipPosition),Ne=rt.props.points[ve].tooltipPayload);var st={activeTooltipIndex:ve,isTooltipActive:!0,activeLabel:Fe,activePayload:Ne,activeCoordinate:et};this.setState(st),this.renderCursor(ue),this.accessibilityManager.setIndex(ve)}}}},{key:"getSnapshotBeforeUpdate",value:function(G,H){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==H.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==G.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==G.margin){var Y,K;this.accessibilityManager.setDetails({offset:{left:(Y=this.props.margin.left)!==null&&Y!==void 0?Y:0,top:(K=this.props.margin.top)!==null&&K!==void 0?K:0}})}return null}},{key:"componentDidUpdate",value:function(G){LO([La(G.children,Dl)],[La(this.props.children,Dl)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var G=La(this.props.children,Dl);if(G&&typeof G.props.shared=="boolean"){var H=G.props.shared?"axis":"item";return a.indexOf(H)>=0?H:p}return p}},{key:"getMouseInfo",value:function(G){if(!this.container)return null;var H=this.container,Y=H.getBoundingClientRect(),K=Hwe(Y),ee={chartX:Math.round(G.pageX-K.left),chartY:Math.round(G.pageY-K.top)},ue=Y.width/H.offsetWidth||1,ve=this.inRange(ee.chartX,ee.chartY,ue);if(!ve)return null;var Fe=this.state,Ne=Fe.xAxisMap,Oe=Fe.yAxisMap,Le=this.getTooltipEventType();if(Le!=="axis"&&Ne&&Oe){var Ue=_h(Ne).scale,et=_h(Oe).scale,rt=Ue&&Ue.invert?Ue.invert(ee.chartX):null,st=et&&et.invert?et.invert(ee.chartY):null;return Rt(Rt({},ee),{},{xValue:rt,yValue:st})}var Ke=Q6(this.state,this.props.data,this.props.layout,ve);return Ke?Rt(Rt({},ee),Ke):null}},{key:"inRange",value:function(G,H){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,K=this.props.layout,ee=G/Y,ue=H/Y;if(K==="horizontal"||K==="vertical"){var ve=this.state.offset,Fe=ee>=ve.left&&ee<=ve.left+ve.width&&ue>=ve.top&&ue<=ve.top+ve.height;return Fe?{x:ee,y:ue}:null}var Ne=this.state,Oe=Ne.angleAxisMap,Le=Ne.radiusAxisMap;if(Oe&&Le){var Ue=_h(Oe);return D$({x:ee,y:ue},Ue)}return null}},{key:"parseEventsOfWrapper",value:function(){var G=this.props.children,H=this.getTooltipEventType(),Y=La(G,Dl),K={};Y&&H==="axis"&&(Y.props.trigger==="click"?K={onClick:this.handleClick}:K={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var ee=FS(this.props,this.handleOuterEvent);return Rt(Rt({},ee),K)}},{key:"addListener",value:function(){YM.on(KM,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){YM.removeListener(KM,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(G,H,Y){for(var K=this.state.formattedGraphicalItems,ee=0,ue=K.length;ee<ue;ee++){var ve=K[ee];if(ve.item===G||ve.props.key===G.key||H===Fu(ve.item.type)&&Y===ve.childIndex)return ve}return null}},{key:"renderClipPath",value:function(){var G=this.clipPathId,H=this.state.offset,Y=H.left,K=H.top,ee=H.height,ue=H.width;return Ye.createElement("defs",null,Ye.createElement("clipPath",{id:G},Ye.createElement("rect",{x:Y,y:K,height:ee,width:ue})))}},{key:"getXScales",value:function(){var G=this.state.xAxisMap;return G?Object.entries(G).reduce(function(H,Y){var K=X6(Y,2),ee=K[0],ue=K[1];return Rt(Rt({},H),{},jn({},ee,ue.scale))},{}):null}},{key:"getYScales",value:function(){var G=this.state.yAxisMap;return G?Object.entries(G).reduce(function(H,Y){var K=X6(Y,2),ee=K[0],ue=K[1];return Rt(Rt({},H),{},jn({},ee,ue.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(G){var H;return(H=this.state.xAxisMap)===null||H===void 0||(H=H[G])===null||H===void 0?void 0:H.scale}},{key:"getYScaleByAxisId",value:function(G){var H;return(H=this.state.yAxisMap)===null||H===void 0||(H=H[G])===null||H===void 0?void 0:H.scale}},{key:"getItemByXY",value:function(G){var H=this.state,Y=H.formattedGraphicalItems,K=H.activeItem;if(Y&&Y.length)for(var ee=0,ue=Y.length;ee<ue;ee++){var ve=Y[ee],Fe=ve.props,Ne=ve.item,Oe=Ne.type.defaultProps!==void 0?Rt(Rt({},Ne.type.defaultProps),Ne.props):Ne.props,Le=Fu(Ne.type);if(Le==="Bar"){var Ue=(Fe.data||[]).find(function(Ke){return dIe(G,Ke)});if(Ue)return{graphicalItem:ve,payload:Ue}}else if(Le==="RadialBar"){var et=(Fe.data||[]).find(function(Ke){return D$(G,Ke)});if(et)return{graphicalItem:ve,payload:et}}else if(nA(ve,K)||rA(ve,K)||nx(ve,K)){var rt=gOe({graphicalItem:ve,activeTooltipItem:K,itemData:Oe.data}),st=Oe.activeIndex===void 0?rt:Oe.activeIndex;return{graphicalItem:Rt(Rt({},ve),{},{childIndex:st}),payload:nx(ve,K)?Oe.data[rt]:ve.props.data[rt]}}}return null}},{key:"render",value:function(){var G=this;if(!Tj(this))return null;var H=this.props,Y=H.children,K=H.className,ee=H.width,ue=H.height,ve=H.style,Fe=H.compact,Ne=H.title,Oe=H.desc,Le=Y6(H,wDe),Ue=gr(Le,!1);if(Fe)return Ye.createElement(R6,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ye.createElement(FO,n0({},Ue,{width:ee,height:ue,title:Ne,desc:Oe}),this.renderClipPath(),Aj(Y,this.renderMap)));if(this.props.accessibilityLayer){var et,rt;Ue.tabIndex=(et=this.props.tabIndex)!==null&&et!==void 0?et:0,Ue.role=(rt=this.props.role)!==null&&rt!==void 0?rt:"application",Ue.onKeyDown=function(Ke){G.accessibilityManager.keyboardEvent(Ke)},Ue.onFocus=function(){G.accessibilityManager.focus()}}var st=this.parseEventsOfWrapper();return Ye.createElement(R6,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ye.createElement("div",n0({className:Cr("recharts-wrapper",K),style:Rt({position:"relative",cursor:"default",width:ee,height:ue},ve)},st,{ref:function(Ze){G.container=Ze}}),Ye.createElement(FO,n0({},Ue,{width:ee,height:ue,title:Ne,desc:Oe,style:BDe}),this.renderClipPath(),Aj(Y,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(W.Component),jn(n,"displayName",o),jn(n,"defaultProps",Rt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},O)),jn(n,"getDerivedStateFromProps",function(z,U){var j=z.dataKey,G=z.data,H=z.children,Y=z.width,K=z.height,ee=z.layout,ue=z.stackOffset,ve=z.margin,Fe=U.dataStartIndex,Ne=U.dataEndIndex;if(U.updateId===void 0){var Oe=J6(z);return Rt(Rt(Rt({},Oe),{},{updateId:0},N(Rt(Rt({props:z},Oe),{},{updateId:0}),U)),{},{prevDataKey:j,prevData:G,prevWidth:Y,prevHeight:K,prevLayout:ee,prevStackOffset:ue,prevMargin:ve,prevChildren:H})}if(j!==U.prevDataKey||G!==U.prevData||Y!==U.prevWidth||K!==U.prevHeight||ee!==U.prevLayout||ue!==U.prevStackOffset||!eg(ve,U.prevMargin)){var Le=J6(z),Ue={chartX:U.chartX,chartY:U.chartY,isTooltipActive:U.isTooltipActive},et=Rt(Rt({},Q6(U,G,ee)),{},{updateId:U.updateId+1}),rt=Rt(Rt(Rt({},Le),Ue),et);return Rt(Rt(Rt({},rt),N(Rt({props:z},rt),U)),{},{prevDataKey:j,prevData:G,prevWidth:Y,prevHeight:K,prevLayout:ee,prevStackOffset:ue,prevMargin:ve,prevChildren:H})}if(!LO(H,U.prevChildren)){var st,Ke,Ze,Xe,de=La(H,Pg),lt=de&&(st=(Ke=de.props)===null||Ke===void 0?void 0:Ke.startIndex)!==null&&st!==void 0?st:Fe,gt=de&&(Ze=(Xe=de.props)===null||Xe===void 0?void 0:Xe.endIndex)!==null&&Ze!==void 0?Ze:Ne,Se=lt!==Fe||gt!==Ne,qt=!Tr(G),an=qt&&!Se?U.updateId:U.updateId+1;return Rt(Rt({updateId:an},N(Rt(Rt({props:z},U),{},{updateId:an,dataStartIndex:lt,dataEndIndex:gt}),U)),{},{prevChildren:H,dataStartIndex:lt,dataEndIndex:gt})}return null}),jn(n,"renderActiveDot",function(z,U,j){var G;return W.isValidElement(z)?G=W.cloneElement(z,U):hr(z)?G=z(U):G=Ye.createElement(GD,U),Ye.createElement(xi,{className:"recharts-active-dot",key:j},G)}),n},YDe=XDe({chartName:"AreaChart",GraphicalChild:ef,axisComponents:[{axisType:"xAxis",AxisComp:uA},{axisType:"yAxis",AxisComp:cA}],formatAxisMap:$3e});const KDe={light:"",dark:".dark"},eX=W.createContext(null);function tX(){const e=W.useContext(eX);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const nX=W.forwardRef(({id:e,className:t,children:n,config:o,...u},h)=>{const p=W.useId(),_=`chart-${e||p.replace(/:/g,"")}`;return re.jsx(eX.Provider,{value:{config:o},children:re.jsxs("div",{"data-chart":_,ref:h,className:wn("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...u,children:[re.jsx(QDe,{id:_,config:o}),re.jsx(Bwe,{children:n})]})})});nX.displayName="Chart";const QDe=({id:e,config:t})=>{const n=Object.entries(t).filter(([o,u])=>u.theme||u.color);return n.length?re.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(KDe).map(([o,u])=>`
${u} [data-chart=${e}] {
${n.map(([h,p])=>{var a;const _=((a=p.theme)==null?void 0:a[o])||p.color;return _?`  --color-${h}: ${_};`:null}).join(`
`)}
}
`).join(`
`)}}):null},JDe=Dl,rX=W.forwardRef(({active:e,payload:t,className:n,indicator:o="dot",hideLabel:u=!1,hideIndicator:h=!1,label:p,labelFormatter:_,labelClassName:a,formatter:b,color:C,nameKey:A,labelKey:O},k)=>{const{config:N}=tX(),z=W.useMemo(()=>{var K;if(u||!(t!=null&&t.length))return null;const[j]=t,G=`${O||j.dataKey||j.name||"value"}`,H=nR(N,j,G),Y=!O&&typeof p=="string"?((K=N[p])==null?void 0:K.label)||p:H==null?void 0:H.label;return _?re.jsx("div",{className:wn("font-medium",a),children:_(Y,t)}):Y?re.jsx("div",{className:wn("font-medium",a),children:Y}):null},[p,_,t,u,a,N,O]);if(!e||!(t!=null&&t.length))return null;const U=t.length===1&&o!=="dot";return re.jsxs("div",{ref:k,className:wn("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[U?null:z,re.jsx("div",{className:"grid gap-1.5",children:t.map((j,G)=>{const H=`${A||j.name||j.dataKey||"value"}`,Y=nR(N,j,H),K=C||j.payload.fill||j.color;return re.jsx("div",{className:wn("flex flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",o==="dot"&&"items-center"),children:b&&(j==null?void 0:j.value)!==void 0&&j.name?b(j.value,j.name,j,G,j.payload):re.jsxs(re.Fragment,{children:[Y!=null&&Y.icon?re.jsx(Y.icon,{}):!h&&re.jsx("div",{className:wn("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":o==="dot","w-1":o==="line","w-0 border-[1.5px] border-dashed bg-transparent":o==="dashed","my-0.5":U&&o==="dashed"}),style:{"--color-bg":K,"--color-border":K}}),re.jsxs("div",{className:wn("flex flex-1 justify-between leading-none",U?"items-end":"items-center"),children:[re.jsxs("div",{className:"grid gap-1.5",children:[U?z:null,re.jsx("span",{className:"text-muted-foreground",children:(Y==null?void 0:Y.label)||j.name})]}),j.value&&re.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:j.value.toLocaleString()})]})]})},j.dataKey)})})]})});rX.displayName="ChartTooltip";const eLe=W.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:o="bottom",nameKey:u},h)=>{const{config:p}=tX();return n!=null&&n.length?re.jsx("div",{ref:h,className:wn("flex items-center justify-center gap-4",o==="top"?"pb-3":"pt-3",e),children:n.map(_=>{const a=`${u||_.dataKey||"value"}`,b=nR(p,_,a);return re.jsxs("div",{className:wn("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[b!=null&&b.icon&&!t?re.jsx(b.icon,{}):re.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:_.color}}),b==null?void 0:b.label]},_.value)})}):null});eLe.displayName="ChartLegend";function nR(e,t,n){if(typeof t!="object"||t===null)return;const o="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let u=n;return n in t&&typeof t[n]=="string"?u=t[n]:o&&n in o&&typeof o[n]=="string"&&(u=o[n]),u in e?e[u]:e[n]}const tLe={latency:{label:"Latency",color:"hsl(var(--chart-1))"}};function nLe({pings:e,startingLocation:t,start:n,destination:o}){return re.jsxs(oE,{children:[re.jsxs(aE,{children:[re.jsx("div",{className:"text-2xl font-semibold text-customPurple pl-1",children:"Latency"}),re.jsx("div",{className:"text-sm font-normal text-customMauve pl-1",children:t+" to "+o})]}),re.jsx(sE,{children:re.jsx(nX,{config:tLe,children:re.jsxs(YDe,{accessibilityLayer:!0,data:e,margin:{left:-25,right:0},children:[re.jsx(LZ,{vertical:!1}),re.jsx(uA,{dataKey:"time",tickLine:!1,axisLine:!1,tickMargin:8}),re.jsx(cA,{tickLine:!1,axisLine:!1,tickMargin:8}),re.jsx(JDe,{cursor:!1,content:re.jsx(rX,{indicator:"dot",hideLabel:!0})}),re.jsx(ef,{dataKey:"latency",type:"linear",fill:"hsl(39, 100%, 50%)",fillOpacity:.6,stroke:"hsl(30, 100%, 65%)",strokeWidth:"3"})]})})})]})}const zw=({type:e,latency:t})=>re.jsx("div",{className:"flex flex-col items-center justify-center border h-full p-4",children:re.jsxs("div",{className:"items-left",children:[re.jsx("span",{className:"text-normal text-customLavender",children:e}),re.jsx("div",{className:"flex items-center mt-4 space-x-4",children:re.jsx("span",{className:"text-4xl text-sky-900",children:t})})]})});function rLe({startFromLatency:e,destinationFromLatency:t}){const[n,o]=W.useState([]),[u,h]=W.useState(!0),[p,_]=W.useState(null),[a,b]=W.useState(""),[C,A]=W.useState(1),[O,k]=W.useState([]),[N,z]=W.useState(e),[U,j]=W.useState(t);!N&&!U&&(z("us-west-2"),j("ca-central-1")),W.useEffect(()=>{(async()=>{try{const K=await fetch("https://f2ggum2vms.us-west-2.awsapprunner.com/data/regions.json");if(!K.ok)throw new Error("Failed to fetch regions");const ee=await K.json();o(ee)}catch(K){_(K)}finally{h(!1)}})()},[]),W.useEffect(()=>{(async()=>{try{const K=await fetch("https://ncst1bngw1.execute-api.us-west-2.amazonaws.com/dev/pingdata");if(!K.ok)throw new Error("Failed to fetch pings");const ue=(await K.json()).Items.filter(ve=>ve.origin.S===N&&ve.destination.S===U).map(ve=>({time:new Date(ve.timestamp.S).toLocaleTimeString(),latency:parseFloat(ve.latency.N)}));k(ue)}catch(K){_(K)}})()},[N,U]);const G=K=>{const ee=K.toString().padStart(2,"0"),ue=O.filter(Fe=>{const[Ne,Oe]=Fe.time.split(" "),[Le,Ue,et]=Ne.split(":").map(Number);return(Oe==="PM"&&Le!==12?Le+12:Oe==="AM"&&Le===12?0:Le).toString().padStart(2,"0")===ee});if(ue.length===0)return"N/A";const ve=ue.reduce((Fe,Ne)=>Fe+parseFloat(Ne.latency),0)/ue.length;return Math.round(ve)+" ms"},H=()=>{const K=O[O.length-1];return K?Math.round(K.latency)+" ms":"N/A"},Y=K=>{if(O.length===0)return"N/A";const ee=O.map(ve=>ve.latency).sort((ve,Fe)=>ve-Fe),ue=Math.floor(K/100*ee.length);return Math.round(ee[ue])+" ms"};return re.jsxs("div",{children:[re.jsx("div",{className:"px-0 mt-16"}),re.jsx(iE,{page:"Latency History"}),re.jsx("div",{className:"flex justify-center min-h-screen py-10 bg-customBg",children:re.jsxs("div",{className:"flex flex-col w-full ml-8 mr-5",children:[re.jsxs("div",{className:"flex flex-row",children:[re.jsx(jm,{to:"/latency",className:"mt-2 -ml-3 mr-4 bg-white p-2 text-sky-950 rounded-full",children:re.jsx(Pie,{})}),re.jsx("span",{className:"text-3xl font-bold pt-2 text-sky-900",children:"Historical Latency - Worldwide"})]}),re.jsx("span",{className:"text-customLavender px-11 mt-0",children:"View historical latency from location to AWS data centers worldwide"}),re.jsxs("div",{className:"flex my-4 bg-white h-auto rounded-lg",children:[re.jsx("div",{className:"w-1/2",children:re.jsx(nLe,{pings:O,startingLocation:N,destination:U})}),re.jsxs("div",{className:"grid flex-1 grid-cols-2 grid-rows-2",children:[re.jsx(zw,{type:"16:00 PST",latency:G(16)}),re.jsx(zw,{type:"Live",latency:H()}),re.jsx(zw,{type:"P50",latency:Y(50)}),re.jsx(zw,{type:"P90",latency:Y(90)})]})]}),re.jsxs("div",{className:"flex",children:[re.jsxs("div",{className:"flex flex-col w-2/5 p-4 mr-2 bg-white rounded-lg justify-evenly",children:[re.jsxs("div",{className:"flex flex-col justify-center items-start pl-5",children:[re.jsx("span",{className:"text-customLavender text-sm font-semibold",children:"starting location:"}),re.jsx("span",{className:"text-2xl text-customText",children:N})]}),re.jsx(EH,{}),re.jsxs("div",{className:"flex flex-col w-2/5 p-4 mr-2 bg-white rounded-lg justify-evenly",children:[re.jsx("span",{className:"text-customLavender text-sm font-semibold",children:"Destination:"}),re.jsx("span",{className:"text-2xl text-customText",children:U})]})]}),re.jsxs("div",{className:"flex-1 pt-5 ml-2 bg-white rounded-lg ",children:[re.jsxs("div",{className:"flex justify-between pb-4 pt-4",children:[re.jsxs("div",{className:"flex flex-row",children:[re.jsxs("span",{className:"text-2xl pl-8 pt-1 font-semibold text-sky-900 pb-2",children:["Region Performance"," "]}),re.jsx("span",{className:"text-xs text-customLavender pl-4 pt-4",children:"Select a final destination to view historical latency"})]}),re.jsx(MS,{className:"w-fit mr-5",placeholder:"search..",onKeyPress:K=>K.key==="Enter"&&b(K.target.value)})]}),re.jsxs(Gk,{children:[re.jsx(Wk,{children:re.jsxs(Jm,{children:[re.jsx($m,{children:re.jsx("div",{className:"pl-5",children:"Select"})}),re.jsx($m,{children:"Region"}),re.jsx($m,{children:"Region Code"}),re.jsx($m,{children:"Latency (ms)"})]})}),re.jsx(Hk,{className:"text-normal text-customPurple",children:n==null?void 0:n.map((K,ee)=>(K.name.toUpperCase()===a.toUpperCase()||a===""&&ee>=C*3-2&&ee<=C*3)&&re.jsxs(Jm,{children:[re.jsx(vd,{children:re.jsx("div",{className:"pl-5",children:re.jsx(uE,{variant:"outline",onClick:()=>{j(K.code)}})})})," ",re.jsxs(vd,{children:[K.name," (",K.area,")"]}),re.jsx(vd,{children:K.code}),re.jsx(vd,{children:"100 ms"})]},K.code))})]}),re.jsx(dg,{variant:"outline",size:"icon",className:"aspect-square bg-white border-none text-customMauve ml-6 mb-4",onClick:()=>{C>1&&A(C-1),b("")},children:re.jsx(Oie,{})}),re.jsxs(dg,{variant:"outline",size:"icon",className:"aspect-square bg-white border-none text-customMauve ml-0 mb-4",onClick:()=>{C<n.length/3&&A(C+1),b("")},children:[re.jsx(Cie,{}),re.jsx("div",{className:"font-semibold",children:" ...."})]})]})]})]})})]})}var vo=[];for(var JM=0;JM<256;++JM)vo.push((JM+256).toString(16).slice(1));function iLe(e,t=0){return(vo[e[t+0]]+vo[e[t+1]]+vo[e[t+2]]+vo[e[t+3]]+"-"+vo[e[t+4]]+vo[e[t+5]]+"-"+vo[e[t+6]]+vo[e[t+7]]+"-"+vo[e[t+8]]+vo[e[t+9]]+"-"+vo[e[t+10]]+vo[e[t+11]]+vo[e[t+12]]+vo[e[t+13]]+vo[e[t+14]]+vo[e[t+15]]).toLowerCase()}var Fw,oLe=new Uint8Array(16);function aLe(){if(!Fw&&(Fw=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Fw))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fw(oLe)}var sLe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const tU={randomUUID:sLe};function Nw(e,t,n){if(tU.randomUUID&&!t&&!e)return tU.randomUUID();e=e||{};var o=e.random||(e.rng||aLe)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,iLe(o)}const iX="data:image/svg+xml,%3csvg%20width='302'%20height='311'%20viewBox='0%200%20302%20311'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3crect%20width='302'%20height='311'%20fill='url(%23pattern0_186_2)'/%3e%3cdefs%3e%3cpattern%20id='pattern0_186_2'%20patternContentUnits='objectBoundingBox'%20width='1'%20height='1'%3e%3cuse%20xlink:href='%23image0_186_2'%20transform='matrix(0.00804532%200%200%200.0078125%20-0.0149007%200)'/%3e%3c/pattern%3e%3cimage%20id='image0_186_2'%20width='128'%20height='128'%20xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAACYhJREFUeJztnU9sHFcdxz9vdu2NHRAcEGorcaBqFFIp6Q3itQlEyqEOUAmBI4qEIkWtVTsmqBJCXOACN5ACbbIufxqEVFWoaSWkijqVLCht4oXiS1JBG0F7gBZuEVJLNrvrnR8He5K1vTM7/97Mm533OSV6b9978vc735nfzOxbhWXkWBpf+5SLMwfyBeAg0AX+CfLbSsX5+ZOtw+96fVVuq7SkytKeP3/SFXlIkDklTAd0/UChHj3fOfwbsAYoNBFE34WgvrHcOfyMNUDB6Iv3OTbjPS7vuxU5UE1rYRZ99B/prjANksawH670nHmbAIaS4pHui8BVawCDSHJOj4OCG/YUkDP9R7rrugchuytzgao1QA5sEx0OpnROj4H6qzVARmgS3UXJFSWqJvDpGJ9fsdcAGtF0TndF0VSoi05l46JsVI8I8gxQiTHW/TYBUmZbyea605DKOX2b6Oduzvwb4PT4n76WQPxrjc7Um9YAKZCl6B4JxUfBRQBrgJjkIbpHUvEBBF4A+ywgEppuzrgouSKoi5VK7wU/0T0WxponleIC4ASNqWA94MLwjUZn6hDYBBiKptuwoY70nWwd+U8zRHwRTuHwiN9SFTzn/dsaYAB5xrsfIWPfFeGUGq+8TLd3wa+TF/9gDXAbE0X3iCL+cnfq16ed5hnxT4lrjc7Um95/Sm0Ak0X3iCo+gMCcX0fv6t+jdAYogugeccRf3Pv6XXR7db/O/fEPJTFAkUT3iCM+gNronQgb/zDCBiii6B5xxYdo8Q8jZoAii+6RRPyo8Q8jYIBREN0jifgQPf6hoAYYJdE9kooP0eMfCmSAURTdIw3x48Q/GG6AURbdIw3xIV78g4EGKIPoHmmJD/HiHwwxQJlE90hT/LjxDzkaoIyie6QpPsSPf8jYAGUW3SNt8SF+/EMGBrCi30GH+EniHzQZwIq+Gx3iQ7L4hxQNYEX3R5f4kCz+IaEBrOjD0Sl+0viHGAawoodHp/iQPP4hpAGs6NHRLT4kj38IMIBu0V3Hff6pVv295EOaRxbipxH/sMMA86x/rDq+8QjI11P8qnKk996LzsJY86QgQ9/bTyI+gGz05pT/HG+EiX/oM8Di+NrDsNEA+WjcRfVRKtE9wn5pI6n4AAqZ8z88Vaj4hy0DLIw1TwK/AklywJdSdI8sxV+avHyPu6F8v23s4IY3wOLE65+g12sQL+1LLbpHluID9HqVrwTF/7lO/a2wY1XpbZwBNRlhfit6H1mLD+nFP0BVoY6H+LabFX0AeYifZvwDVAXu9WmzogeQh/iQbvzD5kB+AeAg6i7lcp/bcw49ztpEpJWOMHmJD178+7ZGOvoB1OJ48ypwKETfFvAKSl4CLjXa9X9EnWwUyFP8zfiv/Mtvbgc5EDUBqsCLhDPABDCLqFmAxfHm3xFWcGSl1uaPZ6m3okxcRPIUH9KPf4Dq2Jh6stuVJeAjET+7D8U+RJ1pj9NapDnS6ZC3+JDu1f+dMYHT42tfls0BYu85s4ORSgcTxNcR/9Bnp4Vac1YJvwTuib/MgRT62sEE8QEWas1vKuEJn+bbe/5EZVuefJure1tjNx8WJXOgjgB74gw6hMKkgyniAyzW1l5F1GcHt6rvNzqHfxBnXN/bv4+zNnFrj5p2XI4JPAQciDPBEFoIV0Sx6qJe/Fnn8N80zBGLLB7phmV+cv3u6kb3XfyNeH/Yp387CX3/f2HPX+6l1zuGki8pOIaWdJB3lGLVFVbbHffSBWbeT3+O4ZgkPsDpWvOMCD/1ab7W6Ew9EHfsWE//RjkdTBMfYLHWfA1hZlCbgu+d70z9MO7YqWwUOSrpYKL4OuMfNOwUWtR0MFF80Bv/kMFWsUVIB1PFB73xvzVGdpiYDiaLrzv+IefNovNOB5PFB/3xDwbtFj7P+mSl1juqcI8j8iAov/cUktACXhHFigNKhLMYcJPHD103f7aNknQAXWSTDoHkKn4W8Q8GG6CfjK4d+slVfMgm/sGQLWKGcZZ6i1usAqvAdzWnQ+7iQzpf+wpDIRIgiJTTwQjxs4p/GAED7GShdnm/gzMrwmzUJ5pK8a3z7Sm/R66ZoevR7yAKcQqIwnJ75jpwHfhJ1HRw8/sJz20oOBHQ9pxfW8y5ysNC7fJ+JdXvgJzy6bLS6Ewdz3RRO9D15o8fQTXwyLHcnrnu4P4ooMvn51mP8i2p1JFe5asEbPqQpvgETDSynOvU3xJ426d5olrrHMl0QTvI6urfo3QGAFCKl30b3c3X3vNgfnL9boTEmz5EoZwGQFYCGnMzwFivO0fCPX+iUkoDTLT3/gG45dO8b7G2dl+W6/HIOv6hpAb4MQ/8D+E1v3Yh+9NAHvEPJTUAAA6+pwEl2Z8G8oh/AiYceRwJuA7IoRzMI/6hxAYwqRzMK/6hxAYAc8rBvOKfgElLgSnlYF7xDyU3gAnlYJ7xDyU3wLByEHhQ9xryjH8CJi4PAeWgtxuKTvKMf7AGGFYOHtVZDuYd/2ANkGs5mHf8EzB5qcirHMw7/sEaAMinHDQh/sEaAMinHDQh/glYQKnIoxw0If7BGuAOGZaDpsQ/WAPcJsty0JT4J2ARpWPzbVt5x6c51XLQlPgHa4DtKHXJty2lctCk+AdrgG1kUQ6aFP8ELKSUZFEOmhT/YA2wDd3loGnxD9YAu9FYDpoW/2ANsAud5aBp8Q/WALvQVQ6aGP9gDTAYDeWgifEP1gAD0VEOmhj/YA0wkLTLQVPjH6wBBpJ2OWhq/IM1gD8ploOmxj9YA/gyrBwM+0uqJsc/WAP4MqwcbNf4XJhxTI5/sAYIRJRK/LKoyfEP1gCBKAKuA0KUg6bHP1gDBDLZnvw9CcpB0+MfrAECSVoOmh7/YA0wnJjlYBHiH6wBhhK3HCxC/IM1wFCGlYPdGgOfDhYh/sEaIBRB5aDr7q4GihL/YA0QiuByUO3aXbwo8Q/WAKGIWg4WJf7BGiAUUcrBIsU/WAOEJ2Q5WKT4B2uA0IQtB4sU/2ANEJow5WDR4h+sASIxrBwsWvyDNUAkhpWDRYt/sAaIxFY52PZp3ocw7fdZhTyvZ1XJsAaIwFY5+GpAF7+f4Uv9177SwhogIoKKfCQLPKtjLWlgDRAR1W09C/Kf0P3hRqcjv9C5piRYA0SkwdEPRFUeBXohursu8tjT1G/oXldcrAFisNz+zO+AE6D+G9DtpqBOLnfqRl79e5Tqt4PT5rEPXfm401FLoL4I7Gfz7/k28JJbkSeeatXfy3eFw/k/8TZc8PuSH3AAAAAASUVORK5CYII='/%3e%3c/defs%3e%3c/svg%3e",lLe="data:image/svg+xml,%3csvg%20width='97'%20height='84'%20viewBox='0%200%2097%2084'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_553_67)'%3e%3cpath%20d='M67.3512%201H30.3185C29.2886%201%2028.3307%201.52829%2027.7812%202.39935L6.02386%2036.8885C5.39967%2037.878%205.4076%2039.14%206.04415%2040.1215L27.777%2073.6324C28.3302%2074.4852%2029.2775%2075%2030.2941%2075H67.3755C68.4065%2075%2069.3652%2074.4706%2069.9144%2073.5981L91.0078%2040.0878C91.6155%2039.1224%2091.6231%2037.8959%2091.0274%2036.9231L69.9097%202.43345C69.3644%201.54294%2068.3954%201%2067.3512%201Z'%20fill='url(%23paint0_linear_553_67)'%20fill-opacity='0.6'%20shape-rendering='crispEdges'/%3e%3c/g%3e%3cg%20filter='url(%23filter1_d_553_67)'%3e%3cpath%20d='M60.6956%2011H36.7505C35.6946%2011%2034.7164%2011.5551%2034.175%2012.4616L19.9318%2036.3065C19.359%2037.2653%2019.3664%2038.463%2019.9508%2039.4147L34.1698%2062.5699C34.7155%2063.4585%2035.6835%2064%2036.7263%2064H60.7196C61.7765%2064%2062.7555%2063.4438%2063.2966%2062.5359L77.0971%2039.3813C77.6544%2038.4461%2077.6615%2037.2825%2077.1155%2036.3407L63.2909%2012.4953C62.7543%2011.5698%2061.7654%2011%2060.6956%2011Z'%20fill='url(%23paint1_linear_553_67)'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_553_67'%20x='0.561157'%20y='0'%20width='95.9077'%20height='84'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4'/%3e%3cfeGaussianBlur%20stdDeviation='2.5'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.195052%200%200%200%200%200.195052%200%200%200%200%200.195052%200%200%200%200.1%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_553_67'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_553_67'%20result='shape'/%3e%3c/filter%3e%3cfilter%20id='filter1_d_553_67'%20x='14.5073'%20y='10'%20width='68.0128'%20height='63'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4'/%3e%3cfeGaussianBlur%20stdDeviation='2.5'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.225033%200%200%200%200%200.225033%200%200%200%200%200.225033%200%200%200%200.1%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_553_67'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_553_67'%20result='shape'/%3e%3c/filter%3e%3clinearGradient%20id='paint0_linear_553_67'%20x1='79.472'%20y1='8.84332'%20x2='27.2019'%20y2='75.6926'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%234118E5'/%3e%3cstop%20offset='1'%20stop-color='%231899E2'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_553_67'%20x1='69.504'%20y1='16.6175'%20x2='26.2365'%20y2='9.5519'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23CEB0FF'/%3e%3cstop%20offset='1'%20stop-color='%2391D6FD'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e";var eI="rovingFocusGroup.onEntryFocus",uLe={bubbles:!1,cancelable:!0},fA="RovingFocusGroup",[rR,oX,cLe]=_E(fA),[hLe,dA]=tc(fA,[cLe]),[fLe,dLe]=hLe(fA),aX=W.forwardRef((e,t)=>re.jsx(rR.Provider,{scope:e.__scopeRovingFocusGroup,children:re.jsx(rR.Slot,{scope:e.__scopeRovingFocusGroup,children:re.jsx(pLe,{...e,ref:t})})}));aX.displayName=fA;var pLe=W.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:o,loop:u=!1,dir:h,currentTabStopId:p,defaultCurrentTabStopId:_,onCurrentTabStopIdChange:a,onEntryFocus:b,preventScrollOnEntryFocus:C=!1,...A}=e,O=W.useRef(null),k=Fr(t,O),N=vE(h),[z=null,U]=pg({prop:p,defaultProp:_,onChange:a}),[j,G]=W.useState(!1),H=Ss(b),Y=oX(n),K=W.useRef(!1),[ee,ue]=W.useState(0);return W.useEffect(()=>{const ve=O.current;if(ve)return ve.addEventListener(eI,H),()=>ve.removeEventListener(eI,H)},[H]),re.jsx(fLe,{scope:n,orientation:o,dir:N,loop:u,currentTabStopId:z,onItemFocus:W.useCallback(ve=>U(ve),[U]),onItemShiftTab:W.useCallback(()=>G(!0),[]),onFocusableItemAdd:W.useCallback(()=>ue(ve=>ve+1),[]),onFocusableItemRemove:W.useCallback(()=>ue(ve=>ve-1),[]),children:re.jsx(fr.div,{tabIndex:j||ee===0?-1:0,"data-orientation":o,...A,ref:k,style:{outline:"none",...e.style},onMouseDown:hn(e.onMouseDown,()=>{K.current=!0}),onFocus:hn(e.onFocus,ve=>{const Fe=!K.current;if(ve.target===ve.currentTarget&&Fe&&!j){const Ne=new CustomEvent(eI,uLe);if(ve.currentTarget.dispatchEvent(Ne),!Ne.defaultPrevented){const Oe=Y().filter(st=>st.focusable),Le=Oe.find(st=>st.active),Ue=Oe.find(st=>st.id===z),rt=[Le,Ue,...Oe].filter(Boolean).map(st=>st.ref.current);uX(rt,C)}}K.current=!1}),onBlur:hn(e.onBlur,()=>G(!1))})})}),sX="RovingFocusGroupItem",lX=W.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:o=!0,active:u=!1,tabStopId:h,...p}=e,_=Dh(),a=h||_,b=dLe(sX,n),C=b.currentTabStopId===a,A=oX(n),{onFocusableItemAdd:O,onFocusableItemRemove:k}=b;return W.useEffect(()=>{if(o)return O(),()=>k()},[o,O,k]),re.jsx(rR.ItemSlot,{scope:n,id:a,focusable:o,active:u,children:re.jsx(fr.span,{tabIndex:C?0:-1,"data-orientation":b.orientation,...p,ref:t,onMouseDown:hn(e.onMouseDown,N=>{o?b.onItemFocus(a):N.preventDefault()}),onFocus:hn(e.onFocus,()=>b.onItemFocus(a)),onKeyDown:hn(e.onKeyDown,N=>{if(N.key==="Tab"&&N.shiftKey){b.onItemShiftTab();return}if(N.target!==N.currentTarget)return;const z=yLe(N,b.orientation,b.dir);if(z!==void 0){if(N.metaKey||N.ctrlKey||N.altKey||N.shiftKey)return;N.preventDefault();let j=A().filter(G=>G.focusable).map(G=>G.ref.current);if(z==="last")j.reverse();else if(z==="prev"||z==="next"){z==="prev"&&j.reverse();const G=j.indexOf(N.currentTarget);j=b.loop?_Le(j,G+1):j.slice(G+1)}setTimeout(()=>uX(j))}})})})});lX.displayName=sX;var mLe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function gLe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function yLe(e,t,n){const o=gLe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(o))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(o)))return mLe[o]}function uX(e,t=!1){const n=document.activeElement;for(const o of e)if(o===n||(o.focus({preventScroll:t}),document.activeElement!==n))return}function _Le(e,t){return e.map((n,o)=>e[(t+o)%e.length])}var cX=aX,hX=lX,iR=["Enter"," "],vLe=["ArrowDown","PageUp","Home"],fX=["ArrowUp","PageDown","End"],xLe=[...vLe,...fX],bLe={ltr:[...iR,"ArrowRight"],rtl:[...iR,"ArrowLeft"]},wLe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Nx="Menu",[ux,SLe,TLe]=_E(Nx),[Jd,ELe]=tc(Nx,[TLe,qg,dA]),pA=qg(),dX=dA(),[ALe,ep]=Jd(Nx),[CLe,Bx]=Jd(Nx),pX=e=>{const{__scopeMenu:t,open:n=!1,children:o,dir:u,onOpenChange:h,modal:p=!0}=e,_=pA(t),[a,b]=W.useState(null),C=W.useRef(!1),A=Ss(h),O=vE(u);return W.useEffect(()=>{const k=()=>{C.current=!0,document.addEventListener("pointerdown",N,{capture:!0,once:!0}),document.addEventListener("pointermove",N,{capture:!0,once:!0})},N=()=>C.current=!1;return document.addEventListener("keydown",k,{capture:!0}),()=>{document.removeEventListener("keydown",k,{capture:!0}),document.removeEventListener("pointerdown",N,{capture:!0}),document.removeEventListener("pointermove",N,{capture:!0})}},[]),re.jsx(Lk,{..._,children:re.jsx(ALe,{scope:t,open:n,onOpenChange:A,content:a,onContentChange:b,children:re.jsx(CLe,{scope:t,onClose:W.useCallback(()=>A(!1),[A]),isUsingKeyboardRef:C,dir:O,modal:p,children:o})})})};pX.displayName=Nx;var PLe="MenuAnchor",eL=W.forwardRef((e,t)=>{const{__scopeMenu:n,...o}=e,u=pA(n);return re.jsx(yE,{...u,...o,ref:t})});eL.displayName=PLe;var tL="MenuPortal",[MLe,mX]=Jd(tL,{forceMount:void 0}),gX=e=>{const{__scopeMenu:t,forceMount:n,children:o,container:u}=e,h=ep(tL,t);return re.jsx(MLe,{scope:t,forceMount:n,children:re.jsx(al,{present:n||h.open,children:re.jsx(Tx,{asChild:!0,container:u,children:o})})})};gX.displayName=tL;var xs="MenuContent",[ILe,nL]=Jd(xs),yX=W.forwardRef((e,t)=>{const n=mX(xs,e.__scopeMenu),{forceMount:o=n.forceMount,...u}=e,h=ep(xs,e.__scopeMenu),p=Bx(xs,e.__scopeMenu);return re.jsx(ux.Provider,{scope:e.__scopeMenu,children:re.jsx(al,{present:o||h.open,children:re.jsx(ux.Slot,{scope:e.__scopeMenu,children:p.modal?re.jsx(OLe,{...u,ref:t}):re.jsx(RLe,{...u,ref:t})})})})}),OLe=W.forwardRef((e,t)=>{const n=ep(xs,e.__scopeMenu),o=W.useRef(null),u=Fr(t,o);return W.useEffect(()=>{const h=o.current;if(h)return vx(h)},[]),re.jsx(rL,{...e,ref:u,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:hn(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),RLe=W.forwardRef((e,t)=>{const n=ep(xs,e.__scopeMenu);return re.jsx(rL,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),rL=W.forwardRef((e,t)=>{const{__scopeMenu:n,loop:o=!1,trapFocus:u,onOpenAutoFocus:h,onCloseAutoFocus:p,disableOutsidePointerEvents:_,onEntryFocus:a,onEscapeKeyDown:b,onPointerDownOutside:C,onFocusOutside:A,onInteractOutside:O,onDismiss:k,disableOutsideScroll:N,...z}=e,U=ep(xs,n),j=Bx(xs,n),G=pA(n),H=dX(n),Y=SLe(n),[K,ee]=W.useState(null),ue=W.useRef(null),ve=Fr(t,ue,U.onContentChange),Fe=W.useRef(0),Ne=W.useRef(""),Oe=W.useRef(0),Le=W.useRef(null),Ue=W.useRef("right"),et=W.useRef(0),rt=N?Ex:W.Fragment,st=N?{as:Wu,allowPinchZoom:!0}:void 0,Ke=Xe=>{var Wt,An;const de=Ne.current+Xe,lt=Y().filter(ht=>!ht.disabled),gt=document.activeElement,Se=(Wt=lt.find(ht=>ht.ref.current===gt))==null?void 0:Wt.textValue,qt=lt.map(ht=>ht.textValue),an=GLe(qt,de,Se),dn=(An=lt.find(ht=>ht.textValue===an))==null?void 0:An.ref.current;(function ht(Zt){Ne.current=Zt,window.clearTimeout(Fe.current),Zt!==""&&(Fe.current=window.setTimeout(()=>ht(""),1e3))})(de),dn&&setTimeout(()=>dn.focus())};W.useEffect(()=>()=>window.clearTimeout(Fe.current),[]),dE();const Ze=W.useCallback(Xe=>{var lt,gt;return Ue.current===((lt=Le.current)==null?void 0:lt.side)&&HLe(Xe,(gt=Le.current)==null?void 0:gt.area)},[]);return re.jsx(ILe,{scope:n,searchRef:Ne,onItemEnter:W.useCallback(Xe=>{Ze(Xe)&&Xe.preventDefault()},[Ze]),onItemLeave:W.useCallback(Xe=>{var de;Ze(Xe)||((de=ue.current)==null||de.focus(),ee(null))},[Ze]),onTriggerLeave:W.useCallback(Xe=>{Ze(Xe)&&Xe.preventDefault()},[Ze]),pointerGraceTimerRef:Oe,onPointerGraceIntentChange:W.useCallback(Xe=>{Le.current=Xe},[]),children:re.jsx(rt,{...st,children:re.jsx(Sx,{asChild:!0,trapped:u,onMountAutoFocus:hn(h,Xe=>{var de;Xe.preventDefault(),(de=ue.current)==null||de.focus({preventScroll:!0})}),onUnmountAutoFocus:p,children:re.jsx(wx,{asChild:!0,disableOutsidePointerEvents:_,onEscapeKeyDown:b,onPointerDownOutside:C,onFocusOutside:A,onInteractOutside:O,onDismiss:k,children:re.jsx(cX,{asChild:!0,...H,dir:j.dir,orientation:"vertical",loop:o,currentTabStopId:K,onCurrentTabStopIdChange:ee,onEntryFocus:hn(a,Xe=>{j.isUsingKeyboardRef.current||Xe.preventDefault()}),preventScrollOnEntryFocus:!0,children:re.jsx(zk,{role:"menu","aria-orientation":"vertical","data-state":kX(U.open),"data-radix-menu-content":"",dir:j.dir,...G,...z,ref:ve,style:{outline:"none",...z.style},onKeyDown:hn(z.onKeyDown,Xe=>{const lt=Xe.target.closest("[data-radix-menu-content]")===Xe.currentTarget,gt=Xe.ctrlKey||Xe.altKey||Xe.metaKey,Se=Xe.key.length===1;lt&&(Xe.key==="Tab"&&Xe.preventDefault(),!gt&&Se&&Ke(Xe.key));const qt=ue.current;if(Xe.target!==qt||!xLe.includes(Xe.key))return;Xe.preventDefault();const dn=Y().filter(Wt=>!Wt.disabled).map(Wt=>Wt.ref.current);fX.includes(Xe.key)&&dn.reverse(),ULe(dn)}),onBlur:hn(e.onBlur,Xe=>{Xe.currentTarget.contains(Xe.target)||(window.clearTimeout(Fe.current),Ne.current="")}),onPointerMove:hn(e.onPointerMove,cx(Xe=>{const de=Xe.target,lt=et.current!==Xe.clientX;if(Xe.currentTarget.contains(de)&&lt){const gt=Xe.clientX>et.current?"right":"left";Ue.current=gt,et.current=Xe.clientX}}))})})})})})})});yX.displayName=xs;var kLe="MenuGroup",iL=W.forwardRef((e,t)=>{const{__scopeMenu:n,...o}=e;return re.jsx(fr.div,{role:"group",...o,ref:t})});iL.displayName=kLe;var DLe="MenuLabel",_X=W.forwardRef((e,t)=>{const{__scopeMenu:n,...o}=e;return re.jsx(fr.div,{...o,ref:t})});_X.displayName=DLe;var LT="MenuItem",nU="menu.itemSelect",mA=W.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:o,...u}=e,h=W.useRef(null),p=Bx(LT,e.__scopeMenu),_=nL(LT,e.__scopeMenu),a=Fr(t,h),b=W.useRef(!1),C=()=>{const A=h.current;if(!n&&A){const O=new CustomEvent(nU,{bubbles:!0,cancelable:!0});A.addEventListener(nU,k=>o==null?void 0:o(k),{once:!0}),OG(A,O),O.defaultPrevented?b.current=!1:p.onClose()}};return re.jsx(vX,{...u,ref:a,disabled:n,onClick:hn(e.onClick,C),onPointerDown:A=>{var O;(O=e.onPointerDown)==null||O.call(e,A),b.current=!0},onPointerUp:hn(e.onPointerUp,A=>{var O;b.current||(O=A.currentTarget)==null||O.click()}),onKeyDown:hn(e.onKeyDown,A=>{const O=_.searchRef.current!=="";n||O&&A.key===" "||iR.includes(A.key)&&(A.currentTarget.click(),A.preventDefault())})})});mA.displayName=LT;var vX=W.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:o=!1,textValue:u,...h}=e,p=nL(LT,n),_=dX(n),a=W.useRef(null),b=Fr(t,a),[C,A]=W.useState(!1),[O,k]=W.useState("");return W.useEffect(()=>{const N=a.current;N&&k((N.textContent??"").trim())},[h.children]),re.jsx(ux.ItemSlot,{scope:n,disabled:o,textValue:u??O,children:re.jsx(hX,{asChild:!0,..._,focusable:!o,children:re.jsx(fr.div,{role:"menuitem","data-highlighted":C?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...h,ref:b,onPointerMove:hn(e.onPointerMove,cx(N=>{o?p.onItemLeave(N):(p.onItemEnter(N),N.defaultPrevented||N.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:hn(e.onPointerLeave,cx(N=>p.onItemLeave(N))),onFocus:hn(e.onFocus,()=>A(!0)),onBlur:hn(e.onBlur,()=>A(!1))})})})}),LLe="MenuCheckboxItem",xX=W.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:o,...u}=e;return re.jsx(EX,{scope:e.__scopeMenu,checked:n,children:re.jsx(mA,{role:"menuitemcheckbox","aria-checked":zT(n)?"mixed":n,...u,ref:t,"data-state":aL(n),onSelect:hn(u.onSelect,()=>o==null?void 0:o(zT(n)?!0:!n),{checkForDefaultPrevented:!1})})})});xX.displayName=LLe;var bX="MenuRadioGroup",[zLe,FLe]=Jd(bX,{value:void 0,onValueChange:()=>{}}),wX=W.forwardRef((e,t)=>{const{value:n,onValueChange:o,...u}=e,h=Ss(o);return re.jsx(zLe,{scope:e.__scopeMenu,value:n,onValueChange:h,children:re.jsx(iL,{...u,ref:t})})});wX.displayName=bX;var SX="MenuRadioItem",TX=W.forwardRef((e,t)=>{const{value:n,...o}=e,u=FLe(SX,e.__scopeMenu),h=n===u.value;return re.jsx(EX,{scope:e.__scopeMenu,checked:h,children:re.jsx(mA,{role:"menuitemradio","aria-checked":h,...o,ref:t,"data-state":aL(h),onSelect:hn(o.onSelect,()=>{var p;return(p=u.onValueChange)==null?void 0:p.call(u,n)},{checkForDefaultPrevented:!1})})})});TX.displayName=SX;var oL="MenuItemIndicator",[EX,NLe]=Jd(oL,{checked:!1}),AX=W.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:o,...u}=e,h=NLe(oL,n);return re.jsx(al,{present:o||zT(h.checked)||h.checked===!0,children:re.jsx(fr.span,{...u,ref:t,"data-state":aL(h.checked)})})});AX.displayName=oL;var BLe="MenuSeparator",CX=W.forwardRef((e,t)=>{const{__scopeMenu:n,...o}=e;return re.jsx(fr.div,{role:"separator","aria-orientation":"horizontal",...o,ref:t})});CX.displayName=BLe;var jLe="MenuArrow",PX=W.forwardRef((e,t)=>{const{__scopeMenu:n,...o}=e,u=pA(n);return re.jsx(Fk,{...u,...o,ref:t})});PX.displayName=jLe;var $Le="MenuSub",[Sje,MX]=Jd($Le),Fv="MenuSubTrigger",IX=W.forwardRef((e,t)=>{const n=ep(Fv,e.__scopeMenu),o=Bx(Fv,e.__scopeMenu),u=MX(Fv,e.__scopeMenu),h=nL(Fv,e.__scopeMenu),p=W.useRef(null),{pointerGraceTimerRef:_,onPointerGraceIntentChange:a}=h,b={__scopeMenu:e.__scopeMenu},C=W.useCallback(()=>{p.current&&window.clearTimeout(p.current),p.current=null},[]);return W.useEffect(()=>C,[C]),W.useEffect(()=>{const A=_.current;return()=>{window.clearTimeout(A),a(null)}},[_,a]),re.jsx(eL,{asChild:!0,...b,children:re.jsx(vX,{id:u.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":u.contentId,"data-state":kX(n.open),...e,ref:gk(t,u.onTriggerChange),onClick:A=>{var O;(O=e.onClick)==null||O.call(e,A),!(e.disabled||A.defaultPrevented)&&(A.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:hn(e.onPointerMove,cx(A=>{h.onItemEnter(A),!A.defaultPrevented&&!e.disabled&&!n.open&&!p.current&&(h.onPointerGraceIntentChange(null),p.current=window.setTimeout(()=>{n.onOpenChange(!0),C()},100))})),onPointerLeave:hn(e.onPointerLeave,cx(A=>{var k,N;C();const O=(k=n.content)==null?void 0:k.getBoundingClientRect();if(O){const z=(N=n.content)==null?void 0:N.dataset.side,U=z==="right",j=U?-5:5,G=O[U?"left":"right"],H=O[U?"right":"left"];h.onPointerGraceIntentChange({area:[{x:A.clientX+j,y:A.clientY},{x:G,y:O.top},{x:H,y:O.top},{x:H,y:O.bottom},{x:G,y:O.bottom}],side:z}),window.clearTimeout(_.current),_.current=window.setTimeout(()=>h.onPointerGraceIntentChange(null),300)}else{if(h.onTriggerLeave(A),A.defaultPrevented)return;h.onPointerGraceIntentChange(null)}})),onKeyDown:hn(e.onKeyDown,A=>{var k;const O=h.searchRef.current!=="";e.disabled||O&&A.key===" "||bLe[o.dir].includes(A.key)&&(n.onOpenChange(!0),(k=n.content)==null||k.focus(),A.preventDefault())})})})});IX.displayName=Fv;var OX="MenuSubContent",RX=W.forwardRef((e,t)=>{const n=mX(xs,e.__scopeMenu),{forceMount:o=n.forceMount,...u}=e,h=ep(xs,e.__scopeMenu),p=Bx(xs,e.__scopeMenu),_=MX(OX,e.__scopeMenu),a=W.useRef(null),b=Fr(t,a);return re.jsx(ux.Provider,{scope:e.__scopeMenu,children:re.jsx(al,{present:o||h.open,children:re.jsx(ux.Slot,{scope:e.__scopeMenu,children:re.jsx(rL,{id:_.contentId,"aria-labelledby":_.triggerId,...u,ref:b,align:"start",side:p.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:C=>{var A;p.isUsingKeyboardRef.current&&((A=a.current)==null||A.focus()),C.preventDefault()},onCloseAutoFocus:C=>C.preventDefault(),onFocusOutside:hn(e.onFocusOutside,C=>{C.target!==_.trigger&&h.onOpenChange(!1)}),onEscapeKeyDown:hn(e.onEscapeKeyDown,C=>{p.onClose(),C.preventDefault()}),onKeyDown:hn(e.onKeyDown,C=>{var k;const A=C.currentTarget.contains(C.target),O=wLe[p.dir].includes(C.key);A&&O&&(h.onOpenChange(!1),(k=_.trigger)==null||k.focus(),C.preventDefault())})})})})})});RX.displayName=OX;function kX(e){return e?"open":"closed"}function zT(e){return e==="indeterminate"}function aL(e){return zT(e)?"indeterminate":e?"checked":"unchecked"}function ULe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function VLe(e,t){return e.map((n,o)=>e[(t+o)%e.length])}function GLe(e,t,n){const u=t.length>1&&Array.from(t).every(b=>b===t[0])?t[0]:t,h=n?e.indexOf(n):-1;let p=VLe(e,Math.max(h,0));u.length===1&&(p=p.filter(b=>b!==n));const a=p.find(b=>b.toLowerCase().startsWith(u.toLowerCase()));return a!==n?a:void 0}function WLe(e,t){const{x:n,y:o}=e;let u=!1;for(let h=0,p=t.length-1;h<t.length;p=h++){const _=t[h].x,a=t[h].y,b=t[p].x,C=t[p].y;a>o!=C>o&&n<(b-_)*(o-a)/(C-a)+_&&(u=!u)}return u}function HLe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return WLe(n,t)}function cx(e){return t=>t.pointerType==="mouse"?e(t):void 0}var qLe=pX,ZLe=eL,XLe=gX,YLe=yX,KLe=iL,QLe=_X,JLe=mA,eze=xX,tze=wX,nze=TX,rze=AX,ize=CX,oze=PX,aze=IX,sze=RX,gA="Menubar",[oR,lze,uze]=_E(gA),[DX,Tje]=tc(gA,[uze,dA]),Jo=ELe(),LX=dA(),[cze,sL]=DX(gA),zX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,value:o,onValueChange:u,defaultValue:h,loop:p=!0,dir:_,...a}=e,b=vE(_),C=LX(n),[A="",O]=pg({prop:o,onChange:u,defaultProp:h}),[k,N]=W.useState(null);return re.jsx(cze,{scope:n,value:A,onMenuOpen:W.useCallback(z=>{O(z),N(z)},[O]),onMenuClose:W.useCallback(()=>O(""),[O]),onMenuToggle:W.useCallback(z=>{O(U=>U?"":z),N(z)},[O]),dir:b,loop:p,children:re.jsx(oR.Provider,{scope:n,children:re.jsx(oR.Slot,{scope:n,children:re.jsx(cX,{asChild:!0,...C,orientation:"horizontal",loop:p,dir:b,currentTabStopId:k,onCurrentTabStopIdChange:N,children:re.jsx(fr.div,{role:"menubar",...a,ref:t})})})})})});zX.displayName=gA;var lL="MenubarMenu",[hze,FX]=DX(lL),NX=e=>{const{__scopeMenubar:t,value:n,...o}=e,u=Dh(),h=n||u||"LEGACY_REACT_AUTO_VALUE",p=sL(lL,t),_=Jo(t),a=W.useRef(null),b=W.useRef(!1),C=p.value===h;return W.useEffect(()=>{C||(b.current=!1)},[C]),re.jsx(hze,{scope:t,value:h,triggerId:Dh(),triggerRef:a,contentId:Dh(),wasKeyboardTriggerOpenRef:b,children:re.jsx(qLe,{..._,open:C,onOpenChange:A=>{A||p.onMenuClose()},modal:!1,dir:p.dir,...o})})};NX.displayName=lL;var aR="MenubarTrigger",BX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,disabled:o=!1,...u}=e,h=LX(n),p=Jo(n),_=sL(aR,n),a=FX(aR,n),b=W.useRef(null),C=Fr(t,b,a.triggerRef),[A,O]=W.useState(!1),k=_.value===a.value;return re.jsx(oR.ItemSlot,{scope:n,value:a.value,disabled:o,children:re.jsx(hX,{asChild:!0,...h,focusable:!o,tabStopId:a.value,children:re.jsx(ZLe,{asChild:!0,...p,children:re.jsx(fr.button,{type:"button",role:"menuitem",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":k,"aria-controls":k?a.contentId:void 0,"data-highlighted":A?"":void 0,"data-state":k?"open":"closed","data-disabled":o?"":void 0,disabled:o,...u,ref:C,onPointerDown:hn(e.onPointerDown,N=>{!o&&N.button===0&&N.ctrlKey===!1&&(_.onMenuOpen(a.value),k||N.preventDefault())}),onPointerEnter:hn(e.onPointerEnter,()=>{var z;!!_.value&&!k&&(_.onMenuOpen(a.value),(z=b.current)==null||z.focus())}),onKeyDown:hn(e.onKeyDown,N=>{o||(["Enter"," "].includes(N.key)&&_.onMenuToggle(a.value),N.key==="ArrowDown"&&_.onMenuOpen(a.value),["Enter"," ","ArrowDown"].includes(N.key)&&(a.wasKeyboardTriggerOpenRef.current=!0,N.preventDefault()))}),onFocus:hn(e.onFocus,()=>O(!0)),onBlur:hn(e.onBlur,()=>O(!1))})})})})});BX.displayName=aR;var fze="MenubarPortal",jX=e=>{const{__scopeMenubar:t,...n}=e,o=Jo(t);return re.jsx(XLe,{...o,...n})};jX.displayName=fze;var sR="MenubarContent",$X=W.forwardRef((e,t)=>{const{__scopeMenubar:n,align:o="start",...u}=e,h=Jo(n),p=sL(sR,n),_=FX(sR,n),a=lze(n),b=W.useRef(!1);return re.jsx(YLe,{id:_.contentId,"aria-labelledby":_.triggerId,"data-radix-menubar-content":"",...h,...u,ref:t,align:o,onCloseAutoFocus:hn(e.onCloseAutoFocus,C=>{var O;!!!p.value&&!b.current&&((O=_.triggerRef.current)==null||O.focus()),b.current=!1,C.preventDefault()}),onFocusOutside:hn(e.onFocusOutside,C=>{const A=C.target;a().some(k=>{var N;return(N=k.ref.current)==null?void 0:N.contains(A)})&&C.preventDefault()}),onInteractOutside:hn(e.onInteractOutside,()=>{b.current=!0}),onEntryFocus:C=>{_.wasKeyboardTriggerOpenRef.current||C.preventDefault()},onKeyDown:hn(e.onKeyDown,C=>{if(["ArrowRight","ArrowLeft"].includes(C.key)){const A=C.target,O=A.hasAttribute("data-radix-menubar-subtrigger"),k=A.closest("[data-radix-menubar-content]")!==C.currentTarget,z=(p.dir==="rtl"?"ArrowRight":"ArrowLeft")===C.key;if(!z&&O||k&&z)return;let G=a().filter(K=>!K.disabled).map(K=>K.value);z&&G.reverse();const H=G.indexOf(_.value);G=p.loop?Cze(G,H+1):G.slice(H+1);const[Y]=G;Y&&p.onMenuOpen(Y)}},{checkForDefaultPrevented:!1}),style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});$X.displayName=sR;var dze="MenubarGroup",pze=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(KLe,{...u,...o,ref:t})});pze.displayName=dze;var mze="MenubarLabel",UX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(QLe,{...u,...o,ref:t})});UX.displayName=mze;var gze="MenubarItem",VX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(JLe,{...u,...o,ref:t})});VX.displayName=gze;var yze="MenubarCheckboxItem",GX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(eze,{...u,...o,ref:t})});GX.displayName=yze;var _ze="MenubarRadioGroup",vze=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(tze,{...u,...o,ref:t})});vze.displayName=_ze;var xze="MenubarRadioItem",WX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(nze,{...u,...o,ref:t})});WX.displayName=xze;var bze="MenubarItemIndicator",HX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(rze,{...u,...o,ref:t})});HX.displayName=bze;var wze="MenubarSeparator",qX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(ize,{...u,...o,ref:t})});qX.displayName=wze;var Sze="MenubarArrow",Tze=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(oze,{...u,...o,ref:t})});Tze.displayName=Sze;var Eze="MenubarSubTrigger",ZX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(aze,{"data-radix-menubar-subtrigger":"",...u,...o,ref:t})});ZX.displayName=Eze;var Aze="MenubarSubContent",XX=W.forwardRef((e,t)=>{const{__scopeMenubar:n,...o}=e,u=Jo(n);return re.jsx(sze,{...u,"data-radix-menubar-content":"",...o,ref:t,style:{...e.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});XX.displayName=Aze;function Cze(e,t){return e.map((n,o)=>e[(t+o)%e.length])}var YX=zX,Pze=NX,KX=BX,Mze=jX,QX=$X,JX=UX,eY=VX,tY=GX,nY=WX,rY=HX,iY=qX,oY=ZX,aY=XX;const Ize=Pze,sY=W.forwardRef(({className:e,...t},n)=>re.jsx(YX,{ref:n,className:wn("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",e),...t}));sY.displayName=YX.displayName;const lY=W.forwardRef(({className:e,...t},n)=>re.jsx(KX,{ref:n,className:wn("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",e),...t}));lY.displayName=KX.displayName;const Oze=W.forwardRef(({className:e,inset:t,children:n,...o},u)=>re.jsxs(oY,{ref:u,className:wn("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",e),...o,children:[n,re.jsx(Rie,{className:"ml-auto h-4 w-4"})]}));Oze.displayName=oY.displayName;const Rze=W.forwardRef(({className:e,...t},n)=>re.jsx(aY,{ref:n,className:wn("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Rze.displayName=aY.displayName;const uY=W.forwardRef(({className:e,align:t="start",alignOffset:n=-4,sideOffset:o=8,...u},h)=>re.jsx(Mze,{children:re.jsx(QX,{ref:h,align:t,alignOffset:n,sideOffset:o,className:wn("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...u})}));uY.displayName=QX.displayName;const cY=W.forwardRef(({className:e,inset:t,...n},o)=>re.jsx(eY,{ref:o,className:wn("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));cY.displayName=eY.displayName;const kze=W.forwardRef(({className:e,children:t,checked:n,...o},u)=>re.jsxs(tY,{ref:u,className:wn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...o,children:[re.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:re.jsx(rY,{children:re.jsx(lE,{className:"h-4 w-4"})})}),t]}));kze.displayName=tY.displayName;const Dze=W.forwardRef(({className:e,children:t,...n},o)=>re.jsxs(nY,{ref:o,className:wn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[re.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:re.jsx(rY,{children:re.jsx(Lie,{className:"h-2 w-2 fill-current"})})}),t]}));Dze.displayName=nY.displayName;const Lze=W.forwardRef(({className:e,inset:t,...n},o)=>re.jsx(JX,{ref:o,className:wn("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));Lze.displayName=JX.displayName;const zze=W.forwardRef(({className:e,...t},n)=>re.jsx(iY,{ref:n,className:wn("-mx-1 my-1 h-px bg-muted",e),...t}));zze.displayName=iY.displayName;function Fze(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const Nze=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Bze=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,jze={};function rU(e,t){return(jze.jsx?Bze:Nze).test(e)}const $ze=/[ \t\n\f\r]/g;function Uze(e){return typeof e=="object"?e.type==="text"?iU(e.value):!1:iU(e)}function iU(e){return e.replace($ze,"")===""}class jx{constructor(t,n,o){this.property=t,this.normal=n,o&&(this.space=o)}}jx.prototype.property={};jx.prototype.normal={};jx.prototype.space=null;function hY(e,t){const n={},o={};let u=-1;for(;++u<e.length;)Object.assign(n,e[u].property),Object.assign(o,e[u].normal);return new jx(n,o,t)}function lR(e){return e.toLowerCase()}class Cs{constructor(t,n){this.property=t,this.attribute=n}}Cs.prototype.space=null;Cs.prototype.boolean=!1;Cs.prototype.booleanish=!1;Cs.prototype.overloadedBoolean=!1;Cs.prototype.number=!1;Cs.prototype.commaSeparated=!1;Cs.prototype.spaceSeparated=!1;Cs.prototype.commaOrSpaceSeparated=!1;Cs.prototype.mustUseProperty=!1;Cs.prototype.defined=!1;let Vze=0;const ir=tp(),$i=tp(),fY=tp(),Gt=tp(),ti=tp(),ig=tp(),Ra=tp();function tp(){return 2**++Vze}const uR=Object.freeze(Object.defineProperty({__proto__:null,boolean:ir,booleanish:$i,commaOrSpaceSeparated:Ra,commaSeparated:ig,number:Gt,overloadedBoolean:fY,spaceSeparated:ti},Symbol.toStringTag,{value:"Module"})),tI=Object.keys(uR);class uL extends Cs{constructor(t,n,o,u){let h=-1;if(super(t,n),oU(this,"space",u),typeof o=="number")for(;++h<tI.length;){const p=tI[h];oU(this,tI[h],(o&uR[p])===uR[p])}}}uL.prototype.defined=!0;function oU(e,t,n){n&&(e[t]=n)}const Gze={}.hasOwnProperty;function uy(e){const t={},n={};let o;for(o in e.properties)if(Gze.call(e.properties,o)){const u=e.properties[o],h=new uL(o,e.transform(e.attributes||{},o),u,e.space);e.mustUseProperty&&e.mustUseProperty.includes(o)&&(h.mustUseProperty=!0),t[o]=h,n[lR(o)]=o,n[lR(h.attribute)]=o}return new jx(t,n,e.space)}const dY=uy({space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),pY=uy({space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function mY(e,t){return t in e?e[t]:t}function gY(e,t){return mY(e,t.toLowerCase())}const yY=uy({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:gY,properties:{xmlns:null,xmlnsXLink:null}}),_Y=uy({transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:$i,ariaAutoComplete:null,ariaBusy:$i,ariaChecked:$i,ariaColCount:Gt,ariaColIndex:Gt,ariaColSpan:Gt,ariaControls:ti,ariaCurrent:null,ariaDescribedBy:ti,ariaDetails:null,ariaDisabled:$i,ariaDropEffect:ti,ariaErrorMessage:null,ariaExpanded:$i,ariaFlowTo:ti,ariaGrabbed:$i,ariaHasPopup:null,ariaHidden:$i,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ti,ariaLevel:Gt,ariaLive:null,ariaModal:$i,ariaMultiLine:$i,ariaMultiSelectable:$i,ariaOrientation:null,ariaOwns:ti,ariaPlaceholder:null,ariaPosInSet:Gt,ariaPressed:$i,ariaReadOnly:$i,ariaRelevant:null,ariaRequired:$i,ariaRoleDescription:ti,ariaRowCount:Gt,ariaRowIndex:Gt,ariaRowSpan:Gt,ariaSelected:$i,ariaSetSize:Gt,ariaSort:null,ariaValueMax:Gt,ariaValueMin:Gt,ariaValueNow:Gt,ariaValueText:null,role:null}}),Wze=uy({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:gY,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ig,acceptCharset:ti,accessKey:ti,action:null,allow:null,allowFullScreen:ir,allowPaymentRequest:ir,allowUserMedia:ir,alt:null,as:null,async:ir,autoCapitalize:null,autoComplete:ti,autoFocus:ir,autoPlay:ir,blocking:ti,capture:null,charSet:null,checked:ir,cite:null,className:ti,cols:Gt,colSpan:null,content:null,contentEditable:$i,controls:ir,controlsList:ti,coords:Gt|ig,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ir,defer:ir,dir:null,dirName:null,disabled:ir,download:fY,draggable:$i,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ir,formTarget:null,headers:ti,height:Gt,hidden:ir,high:Gt,href:null,hrefLang:null,htmlFor:ti,httpEquiv:ti,id:null,imageSizes:null,imageSrcSet:null,inert:ir,inputMode:null,integrity:null,is:null,isMap:ir,itemId:null,itemProp:ti,itemRef:ti,itemScope:ir,itemType:ti,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ir,low:Gt,manifest:null,max:null,maxLength:Gt,media:null,method:null,min:null,minLength:Gt,multiple:ir,muted:ir,name:null,nonce:null,noModule:ir,noValidate:ir,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ir,optimum:Gt,pattern:null,ping:ti,placeholder:null,playsInline:ir,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ir,referrerPolicy:null,rel:ti,required:ir,reversed:ir,rows:Gt,rowSpan:Gt,sandbox:ti,scope:null,scoped:ir,seamless:ir,selected:ir,shadowRootClonable:ir,shadowRootDelegatesFocus:ir,shadowRootMode:null,shape:null,size:Gt,sizes:null,slot:null,span:Gt,spellCheck:$i,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Gt,step:null,style:null,tabIndex:Gt,target:null,title:null,translate:null,type:null,typeMustMatch:ir,useMap:null,value:$i,width:Gt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ti,axis:null,background:null,bgColor:null,border:Gt,borderColor:null,bottomMargin:Gt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ir,declare:ir,event:null,face:null,frame:null,frameBorder:null,hSpace:Gt,leftMargin:Gt,link:null,longDesc:null,lowSrc:null,marginHeight:Gt,marginWidth:Gt,noResize:ir,noHref:ir,noShade:ir,noWrap:ir,object:null,profile:null,prompt:null,rev:null,rightMargin:Gt,rules:null,scheme:null,scrolling:$i,standby:null,summary:null,text:null,topMargin:Gt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Gt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ir,disableRemotePlayback:ir,prefix:null,property:null,results:Gt,security:null,unselectable:null}}),Hze=uy({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:mY,properties:{about:Ra,accentHeight:Gt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Gt,amplitude:Gt,arabicForm:null,ascent:Gt,attributeName:null,attributeType:null,azimuth:Gt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Gt,by:null,calcMode:null,capHeight:Gt,className:ti,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Gt,diffuseConstant:Gt,direction:null,display:null,dur:null,divisor:Gt,dominantBaseline:null,download:ir,dx:null,dy:null,edgeMode:null,editable:null,elevation:Gt,enableBackground:null,end:null,event:null,exponent:Gt,externalResourcesRequired:null,fill:null,fillOpacity:Gt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ig,g2:ig,glyphName:ig,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Gt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Gt,horizOriginX:Gt,horizOriginY:Gt,id:null,ideographic:Gt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Gt,k:Gt,k1:Gt,k2:Gt,k3:Gt,k4:Gt,kernelMatrix:Ra,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Gt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Gt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Gt,overlineThickness:Gt,paintOrder:null,panose1:null,path:null,pathLength:Gt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ti,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Gt,pointsAtY:Gt,pointsAtZ:Gt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ra,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ra,rev:Ra,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ra,requiredFeatures:Ra,requiredFonts:Ra,requiredFormats:Ra,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Gt,specularExponent:Gt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Gt,strikethroughThickness:Gt,string:null,stroke:null,strokeDashArray:Ra,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Gt,strokeOpacity:Gt,strokeWidth:null,style:null,surfaceScale:Gt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ra,tabIndex:Gt,tableValues:null,target:null,targetX:Gt,targetY:Gt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ra,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Gt,underlineThickness:Gt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Gt,values:null,vAlphabetic:Gt,vMathematical:Gt,vectorEffect:null,vHanging:Gt,vIdeographic:Gt,version:null,vertAdvY:Gt,vertOriginX:Gt,vertOriginY:Gt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Gt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),qze=/^data[-\w.:]+$/i,aU=/-[a-z]/g,Zze=/[A-Z]/g;function Xze(e,t){const n=lR(t);let o=t,u=Cs;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&qze.test(t)){if(t.charAt(4)==="-"){const h=t.slice(5).replace(aU,Kze);o="data"+h.charAt(0).toUpperCase()+h.slice(1)}else{const h=t.slice(4);if(!aU.test(h)){let p=h.replace(Zze,Yze);p.charAt(0)!=="-"&&(p="-"+p),t="data"+p}}u=uL}return new u(o,t)}function Yze(e){return"-"+e.toLowerCase()}function Kze(e){return e.charAt(1).toUpperCase()}const Qze={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Jze=hY([pY,dY,yY,_Y,Wze],"html"),cL=hY([pY,dY,yY,_Y,Hze],"svg");function eFe(e){return e.join(" ").trim()}var vY={},sU=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,tFe=/\n/g,nFe=/^\s*/,rFe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,iFe=/^:\s*/,oFe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,aFe=/^[;\s]*/,sFe=/^\s+|\s+$/g,lFe=`
`,lU="/",uU="*",dd="",uFe="comment",cFe="declaration",hFe=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,o=1;function u(N){var z=N.match(tFe);z&&(n+=z.length);var U=N.lastIndexOf(lFe);o=~U?N.length-U:o+N.length}function h(){var N={line:n,column:o};return function(z){return z.position=new p(N),b(),z}}function p(N){this.start=N,this.end={line:n,column:o},this.source=t.source}p.prototype.content=e;function _(N){var z=new Error(t.source+":"+n+":"+o+": "+N);if(z.reason=N,z.filename=t.source,z.line=n,z.column=o,z.source=e,!t.silent)throw z}function a(N){var z=N.exec(e);if(z){var U=z[0];return u(U),e=e.slice(U.length),z}}function b(){a(nFe)}function C(N){var z;for(N=N||[];z=A();)z!==!1&&N.push(z);return N}function A(){var N=h();if(!(lU!=e.charAt(0)||uU!=e.charAt(1))){for(var z=2;dd!=e.charAt(z)&&(uU!=e.charAt(z)||lU!=e.charAt(z+1));)++z;if(z+=2,dd===e.charAt(z-1))return _("End of comment missing");var U=e.slice(2,z-2);return o+=2,u(U),e=e.slice(z),o+=2,N({type:uFe,comment:U})}}function O(){var N=h(),z=a(rFe);if(z){if(A(),!a(iFe))return _("property missing ':'");var U=a(oFe),j=N({type:cFe,property:cU(z[0].replace(sU,dd)),value:U?cU(U[0].replace(sU,dd)):dd});return a(aFe),j}}function k(){var N=[];C(N);for(var z;z=O();)z!==!1&&(N.push(z),C(N));return N}return b(),k()};function cU(e){return e?e.replace(sFe,dd):dd}var fFe=pd&&pd.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vY,"__esModule",{value:!0});var dFe=fFe(hFe);function pFe(e,t){var n=null;if(!e||typeof e!="string")return n;var o=(0,dFe.default)(e),u=typeof t=="function";return o.forEach(function(h){if(h.type==="declaration"){var p=h.property,_=h.value;u?t(p,_,h):_&&(n=n||{},n[p]=_)}}),n}var hU=vY.default=pFe;const mFe=hU.default||hU,xY=bY("end"),hL=bY("start");function bY(e){return t;function t(n){const o=n&&n.position&&n.position[e]||{};if(typeof o.line=="number"&&o.line>0&&typeof o.column=="number"&&o.column>0)return{line:o.line,column:o.column,offset:typeof o.offset=="number"&&o.offset>-1?o.offset:void 0}}}function gFe(e){const t=hL(e),n=xY(e);if(t&&n)return{start:t,end:n}}function r0(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?fU(e.position):"start"in e||"end"in e?fU(e):"line"in e||"column"in e?cR(e):""}function cR(e){return dU(e&&e.line)+":"+dU(e&&e.column)}function fU(e){return cR(e&&e.start)+"-"+cR(e&&e.end)}function dU(e){return e&&typeof e=="number"?e:1}class jo extends Error{constructor(t,n,o){super(),typeof n=="string"&&(o=n,n=void 0);let u="",h={},p=!1;if(n&&("line"in n&&"column"in n?h={place:n}:"start"in n&&"end"in n?h={place:n}:"type"in n?h={ancestors:[n],place:n.position}:h={...n}),typeof t=="string"?u=t:!h.cause&&t&&(p=!0,u=t.message,h.cause=t),!h.ruleId&&!h.source&&typeof o=="string"){const a=o.indexOf(":");a===-1?h.ruleId=o:(h.source=o.slice(0,a),h.ruleId=o.slice(a+1))}if(!h.place&&h.ancestors&&h.ancestors){const a=h.ancestors[h.ancestors.length-1];a&&(h.place=a.position)}const _=h.place&&"start"in h.place?h.place.start:h.place;this.ancestors=h.ancestors||void 0,this.cause=h.cause||void 0,this.column=_?_.column:void 0,this.fatal=void 0,this.file,this.message=u,this.line=_?_.line:void 0,this.name=r0(h.place)||"1:1",this.place=h.place||void 0,this.reason=this.message,this.ruleId=h.ruleId||void 0,this.source=h.source||void 0,this.stack=p&&h.cause&&typeof h.cause.stack=="string"?h.cause.stack:"",this.actual,this.expected,this.note,this.url}}jo.prototype.file="";jo.prototype.name="";jo.prototype.reason="";jo.prototype.message="";jo.prototype.stack="";jo.prototype.column=void 0;jo.prototype.line=void 0;jo.prototype.ancestors=void 0;jo.prototype.cause=void 0;jo.prototype.fatal=void 0;jo.prototype.place=void 0;jo.prototype.ruleId=void 0;jo.prototype.source=void 0;const fL={}.hasOwnProperty,yFe=new Map,_Fe=/[A-Z]/g,vFe=/-([a-z])/g,xFe=new Set(["table","tbody","thead","tfoot","tr"]),bFe=new Set(["td","th"]),wY="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function wFe(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let o;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");o=IFe(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");o=MFe(n,t.jsx,t.jsxs)}const u={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:o,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?cL:Jze,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},h=SY(u,e,void 0);return h&&typeof h!="string"?h:u.create(e,u.Fragment,{children:h||void 0},void 0)}function SY(e,t,n){if(t.type==="element")return SFe(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return TFe(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return AFe(e,t,n);if(t.type==="mdxjsEsm")return EFe(e,t);if(t.type==="root")return CFe(e,t,n);if(t.type==="text")return PFe(e,t)}function SFe(e,t,n){const o=e.schema;let u=o;t.tagName.toLowerCase()==="svg"&&o.space==="html"&&(u=cL,e.schema=u),e.ancestors.push(t);const h=EY(e,t.tagName,!1),p=OFe(e,t);let _=pL(e,t);return xFe.has(t.tagName)&&(_=_.filter(function(a){return typeof a=="string"?!Uze(a):!0})),TY(e,p,h,t),dL(p,_),e.ancestors.pop(),e.schema=o,e.create(t,h,p,n)}function TFe(e,t){if(t.data&&t.data.estree&&e.evaluater){const o=t.data.estree.body[0];return o.type,e.evaluater.evaluateExpression(o.expression)}hx(e,t.position)}function EFe(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);hx(e,t.position)}function AFe(e,t,n){const o=e.schema;let u=o;t.name==="svg"&&o.space==="html"&&(u=cL,e.schema=u),e.ancestors.push(t);const h=t.name===null?e.Fragment:EY(e,t.name,!0),p=RFe(e,t),_=pL(e,t);return TY(e,p,h,t),dL(p,_),e.ancestors.pop(),e.schema=o,e.create(t,h,p,n)}function CFe(e,t,n){const o={};return dL(o,pL(e,t)),e.create(t,e.Fragment,o,n)}function PFe(e,t){return t.value}function TY(e,t,n,o){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=o)}function dL(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function MFe(e,t,n){return o;function o(u,h,p,_){const b=Array.isArray(p.children)?n:t;return _?b(h,p,_):b(h,p)}}function IFe(e,t){return n;function n(o,u,h,p){const _=Array.isArray(h.children),a=hL(o);return t(u,h,p,_,{columnNumber:a?a.column-1:void 0,fileName:e,lineNumber:a?a.line:void 0},void 0)}}function OFe(e,t){const n={};let o,u;for(u in t.properties)if(u!=="children"&&fL.call(t.properties,u)){const h=kFe(e,u,t.properties[u]);if(h){const[p,_]=h;e.tableCellAlignToStyle&&p==="align"&&typeof _=="string"&&bFe.has(t.tagName)?o=_:n[p]=_}}if(o){const h=n.style||(n.style={});h[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=o}return n}function RFe(e,t){const n={};for(const o of t.attributes)if(o.type==="mdxJsxExpressionAttribute")if(o.data&&o.data.estree&&e.evaluater){const h=o.data.estree.body[0];h.type;const p=h.expression;p.type;const _=p.properties[0];_.type,Object.assign(n,e.evaluater.evaluateExpression(_.argument))}else hx(e,t.position);else{const u=o.name;let h;if(o.value&&typeof o.value=="object")if(o.value.data&&o.value.data.estree&&e.evaluater){const _=o.value.data.estree.body[0];_.type,h=e.evaluater.evaluateExpression(_.expression)}else hx(e,t.position);else h=o.value===null?!0:o.value;n[u]=h}return n}function pL(e,t){const n=[];let o=-1;const u=e.passKeys?new Map:yFe;for(;++o<t.children.length;){const h=t.children[o];let p;if(e.passKeys){const a=h.type==="element"?h.tagName:h.type==="mdxJsxFlowElement"||h.type==="mdxJsxTextElement"?h.name:void 0;if(a){const b=u.get(a)||0;p=a+"-"+b,u.set(a,b+1)}}const _=SY(e,h,p);_!==void 0&&n.push(_)}return n}function kFe(e,t,n){const o=Xze(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=o.commaSeparated?Fze(n):eFe(n)),o.property==="style"){let u=typeof n=="object"?n:DFe(e,String(n));return e.stylePropertyNameCase==="css"&&(u=LFe(u)),["style",u]}return[e.elementAttributeNameCase==="react"&&o.space?Qze[o.property]||o.property:o.attribute,n]}}function DFe(e,t){const n={};try{mFe(t,o)}catch(u){if(!e.ignoreInvalidStyle){const h=u,p=new jo("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:h,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw p.file=e.filePath||void 0,p.url=wY+"#cannot-parse-style-attribute",p}}return n;function o(u,h){let p=u;p.slice(0,2)!=="--"&&(p.slice(0,4)==="-ms-"&&(p="ms-"+p.slice(4)),p=p.replace(vFe,FFe)),n[p]=h}}function EY(e,t,n){let o;if(!n)o={type:"Literal",value:t};else if(t.includes(".")){const u=t.split(".");let h=-1,p;for(;++h<u.length;){const _=rU(u[h])?{type:"Identifier",name:u[h]}:{type:"Literal",value:u[h]};p=p?{type:"MemberExpression",object:p,property:_,computed:!!(h&&_.type==="Literal"),optional:!1}:_}o=p}else o=rU(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(o.type==="Literal"){const u=o.value;return fL.call(e.components,u)?e.components[u]:u}if(e.evaluater)return e.evaluater.evaluateExpression(o);hx(e)}function hx(e,t){const n=new jo("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=wY+"#cannot-handle-mdx-estrees-without-createevaluater",n}function LFe(e){const t={};let n;for(n in e)fL.call(e,n)&&(t[zFe(n)]=e[n]);return t}function zFe(e){let t=e.replace(_Fe,NFe);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function FFe(e,t){return t.toUpperCase()}function NFe(e){return"-"+e.toLowerCase()}const nI={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},BFe={};function jFe(e,t){const n=BFe,o=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,u=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return AY(e,o,u)}function AY(e,t,n){if($Fe(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return pU(e.children,t,n)}return Array.isArray(e)?pU(e,t,n):""}function pU(e,t,n){const o=[];let u=-1;for(;++u<e.length;)o[u]=AY(e[u],t,n);return o.join("")}function $Fe(e){return!!(e&&typeof e=="object")}const mU=document.createElement("i");function mL(e){const t="&"+e+";";mU.innerHTML=t;const n=mU.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Qu(e,t,n,o){const u=e.length;let h=0,p;if(t<0?t=-t>u?0:u+t:t=t>u?u:t,n=n>0?n:0,o.length<1e4)p=Array.from(o),p.unshift(t,n),e.splice(...p);else for(n&&e.splice(t,n);h<o.length;)p=o.slice(h,h+1e4),p.unshift(t,0),e.splice(...p),h+=1e4,t+=1e4}function ms(e,t){return e.length>0?(Qu(e,e.length,0,t),e):t}const gU={}.hasOwnProperty;function UFe(e){const t={};let n=-1;for(;++n<e.length;)VFe(t,e[n]);return t}function VFe(e,t){let n;for(n in t){const u=(gU.call(e,n)?e[n]:void 0)||(e[n]={}),h=t[n];let p;if(h)for(p in h){gU.call(u,p)||(u[p]=[]);const _=h[p];GFe(u[p],Array.isArray(_)?_:_?[_]:[])}}}function GFe(e,t){let n=-1;const o=[];for(;++n<t.length;)(t[n].add==="after"?e:o).push(t[n]);Qu(e,0,0,o)}function CY(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function og(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const zl=tf(/[A-Za-z]/),Ba=tf(/[\dA-Za-z]/),WFe=tf(/[#-'*+\--9=?A-Z^-~]/);function hR(e){return e!==null&&(e<32||e===127)}const fR=tf(/\d/),HFe=tf(/[\dA-Fa-f]/),qFe=tf(/[!-/:-@[-`{-~]/);function Wn(e){return e!==null&&e<-2}function va(e){return e!==null&&(e<0||e===32)}function zr(e){return e===-2||e===-1||e===32}const ZFe=tf(new RegExp("\\p{P}|\\p{S}","u")),XFe=tf(/\s/);function tf(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function cy(e){const t=[];let n=-1,o=0,u=0;for(;++n<e.length;){const h=e.charCodeAt(n);let p="";if(h===37&&Ba(e.charCodeAt(n+1))&&Ba(e.charCodeAt(n+2)))u=2;else if(h<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(h))||(p=String.fromCharCode(h));else if(h>55295&&h<57344){const _=e.charCodeAt(n+1);h<56320&&_>56319&&_<57344?(p=String.fromCharCode(h,_),u=1):p=""}else p=String.fromCharCode(h);p&&(t.push(e.slice(o,n),encodeURIComponent(p)),o=n+u+1,p=""),u&&(n+=u,u=0)}return t.join("")+e.slice(o)}function ii(e,t,n,o){const u=o?o-1:Number.POSITIVE_INFINITY;let h=0;return p;function p(a){return zr(a)?(e.enter(n),_(a)):t(a)}function _(a){return zr(a)&&h++<u?(e.consume(a),_):(e.exit(n),t(a))}}const YFe={tokenize:KFe};function KFe(e){const t=e.attempt(this.parser.constructs.contentInitial,o,u);let n;return t;function o(_){if(_===null){e.consume(_);return}return e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),ii(e,t,"linePrefix")}function u(_){return e.enter("paragraph"),h(_)}function h(_){const a=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=a),n=a,p(_)}function p(_){if(_===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(_);return}return Wn(_)?(e.consume(_),e.exit("chunkText"),h):(e.consume(_),p)}}const QFe={tokenize:JFe},yU={tokenize:eNe};function JFe(e){const t=this,n=[];let o=0,u,h,p;return _;function _(H){if(o<n.length){const Y=n[o];return t.containerState=Y[1],e.attempt(Y[0].continuation,a,b)(H)}return b(H)}function a(H){if(o++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,u&&G();const Y=t.events.length;let K=Y,ee;for(;K--;)if(t.events[K][0]==="exit"&&t.events[K][1].type==="chunkFlow"){ee=t.events[K][1].end;break}j(o);let ue=Y;for(;ue<t.events.length;)t.events[ue][1].end=Object.assign({},ee),ue++;return Qu(t.events,K+1,0,t.events.slice(Y)),t.events.length=ue,b(H)}return _(H)}function b(H){if(o===n.length){if(!u)return O(H);if(u.currentConstruct&&u.currentConstruct.concrete)return N(H);t.interrupt=!!(u.currentConstruct&&!u._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(yU,C,A)(H)}function C(H){return u&&G(),j(o),O(H)}function A(H){return t.parser.lazy[t.now().line]=o!==n.length,p=t.now().offset,N(H)}function O(H){return t.containerState={},e.attempt(yU,k,N)(H)}function k(H){return o++,n.push([t.currentConstruct,t.containerState]),O(H)}function N(H){if(H===null){u&&G(),j(0),e.consume(H);return}return u=u||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:h,_tokenizer:u}),z(H)}function z(H){if(H===null){U(e.exit("chunkFlow"),!0),j(0),e.consume(H);return}return Wn(H)?(e.consume(H),U(e.exit("chunkFlow")),o=0,t.interrupt=void 0,_):(e.consume(H),z)}function U(H,Y){const K=t.sliceStream(H);if(Y&&K.push(null),H.previous=h,h&&(h.next=H),h=H,u.defineSkip(H.start),u.write(K),t.parser.lazy[H.start.line]){let ee=u.events.length;for(;ee--;)if(u.events[ee][1].start.offset<p&&(!u.events[ee][1].end||u.events[ee][1].end.offset>p))return;const ue=t.events.length;let ve=ue,Fe,Ne;for(;ve--;)if(t.events[ve][0]==="exit"&&t.events[ve][1].type==="chunkFlow"){if(Fe){Ne=t.events[ve][1].end;break}Fe=!0}for(j(o),ee=ue;ee<t.events.length;)t.events[ee][1].end=Object.assign({},Ne),ee++;Qu(t.events,ve+1,0,t.events.slice(ue)),t.events.length=ee}}function j(H){let Y=n.length;for(;Y-- >H;){const K=n[Y];t.containerState=K[1],K[0].exit.call(t,e)}n.length=H}function G(){u.write([null]),h=void 0,u=void 0,t.containerState._closeFlow=void 0}}function eNe(e,t,n){return ii(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function _U(e){if(e===null||va(e)||XFe(e))return 1;if(ZFe(e))return 2}function gL(e,t,n){const o=[];let u=-1;for(;++u<e.length;){const h=e[u].resolveAll;h&&!o.includes(h)&&(t=h(t,n),o.push(h))}return t}const dR={name:"attention",tokenize:nNe,resolveAll:tNe};function tNe(e,t){let n=-1,o,u,h,p,_,a,b,C;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(o=n;o--;)if(e[o][0]==="exit"&&e[o][1].type==="attentionSequence"&&e[o][1]._open&&t.sliceSerialize(e[o][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[o][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[o][1].end.offset-e[o][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;a=e[o][1].end.offset-e[o][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const A=Object.assign({},e[o][1].end),O=Object.assign({},e[n][1].start);vU(A,-a),vU(O,a),p={type:a>1?"strongSequence":"emphasisSequence",start:A,end:Object.assign({},e[o][1].end)},_={type:a>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[n][1].start),end:O},h={type:a>1?"strongText":"emphasisText",start:Object.assign({},e[o][1].end),end:Object.assign({},e[n][1].start)},u={type:a>1?"strong":"emphasis",start:Object.assign({},p.start),end:Object.assign({},_.end)},e[o][1].end=Object.assign({},p.start),e[n][1].start=Object.assign({},_.end),b=[],e[o][1].end.offset-e[o][1].start.offset&&(b=ms(b,[["enter",e[o][1],t],["exit",e[o][1],t]])),b=ms(b,[["enter",u,t],["enter",p,t],["exit",p,t],["enter",h,t]]),b=ms(b,gL(t.parser.constructs.insideSpan.null,e.slice(o+1,n),t)),b=ms(b,[["exit",h,t],["enter",_,t],["exit",_,t],["exit",u,t]]),e[n][1].end.offset-e[n][1].start.offset?(C=2,b=ms(b,[["enter",e[n][1],t],["exit",e[n][1],t]])):C=0,Qu(e,o-1,n-o+3,b),n=o+b.length-C-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function nNe(e,t){const n=this.parser.constructs.attentionMarkers.null,o=this.previous,u=_U(o);let h;return p;function p(a){return h=a,e.enter("attentionSequence"),_(a)}function _(a){if(a===h)return e.consume(a),_;const b=e.exit("attentionSequence"),C=_U(a),A=!C||C===2&&u||n.includes(a),O=!u||u===2&&C||n.includes(o);return b._open=!!(h===42?A:A&&(u||!O)),b._close=!!(h===42?O:O&&(C||!A)),t(a)}}function vU(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const rNe={name:"autolink",tokenize:iNe};function iNe(e,t,n){let o=0;return u;function u(k){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(k),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),h}function h(k){return zl(k)?(e.consume(k),p):k===64?n(k):b(k)}function p(k){return k===43||k===45||k===46||Ba(k)?(o=1,_(k)):b(k)}function _(k){return k===58?(e.consume(k),o=0,a):(k===43||k===45||k===46||Ba(k))&&o++<32?(e.consume(k),_):(o=0,b(k))}function a(k){return k===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(k),e.exit("autolinkMarker"),e.exit("autolink"),t):k===null||k===32||k===60||hR(k)?n(k):(e.consume(k),a)}function b(k){return k===64?(e.consume(k),C):WFe(k)?(e.consume(k),b):n(k)}function C(k){return Ba(k)?A(k):n(k)}function A(k){return k===46?(e.consume(k),o=0,C):k===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(k),e.exit("autolinkMarker"),e.exit("autolink"),t):O(k)}function O(k){if((k===45||Ba(k))&&o++<63){const N=k===45?O:A;return e.consume(k),N}return n(k)}}const yA={tokenize:oNe,partial:!0};function oNe(e,t,n){return o;function o(h){return zr(h)?ii(e,u,"linePrefix")(h):u(h)}function u(h){return h===null||Wn(h)?t(h):n(h)}}const PY={name:"blockQuote",tokenize:aNe,continuation:{tokenize:sNe},exit:lNe};function aNe(e,t,n){const o=this;return u;function u(p){if(p===62){const _=o.containerState;return _.open||(e.enter("blockQuote",{_container:!0}),_.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(p),e.exit("blockQuoteMarker"),h}return n(p)}function h(p){return zr(p)?(e.enter("blockQuotePrefixWhitespace"),e.consume(p),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(p))}}function sNe(e,t,n){const o=this;return u;function u(p){return zr(p)?ii(e,h,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(p):h(p)}function h(p){return e.attempt(PY,t,n)(p)}}function lNe(e){e.exit("blockQuote")}const MY={name:"characterEscape",tokenize:uNe};function uNe(e,t,n){return o;function o(h){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(h),e.exit("escapeMarker"),u}function u(h){return qFe(h)?(e.enter("characterEscapeValue"),e.consume(h),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(h)}}const IY={name:"characterReference",tokenize:cNe};function cNe(e,t,n){const o=this;let u=0,h,p;return _;function _(A){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(A),e.exit("characterReferenceMarker"),a}function a(A){return A===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(A),e.exit("characterReferenceMarkerNumeric"),b):(e.enter("characterReferenceValue"),h=31,p=Ba,C(A))}function b(A){return A===88||A===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(A),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),h=6,p=HFe,C):(e.enter("characterReferenceValue"),h=7,p=fR,C(A))}function C(A){if(A===59&&u){const O=e.exit("characterReferenceValue");return p===Ba&&!mL(o.sliceSerialize(O))?n(A):(e.enter("characterReferenceMarker"),e.consume(A),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return p(A)&&u++<h?(e.consume(A),C):n(A)}}const xU={tokenize:fNe,partial:!0},bU={name:"codeFenced",tokenize:hNe,concrete:!0};function hNe(e,t,n){const o=this,u={tokenize:K,partial:!0};let h=0,p=0,_;return a;function a(ee){return b(ee)}function b(ee){const ue=o.events[o.events.length-1];return h=ue&&ue[1].type==="linePrefix"?ue[2].sliceSerialize(ue[1],!0).length:0,_=ee,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),C(ee)}function C(ee){return ee===_?(p++,e.consume(ee),C):p<3?n(ee):(e.exit("codeFencedFenceSequence"),zr(ee)?ii(e,A,"whitespace")(ee):A(ee))}function A(ee){return ee===null||Wn(ee)?(e.exit("codeFencedFence"),o.interrupt?t(ee):e.check(xU,z,Y)(ee)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),O(ee))}function O(ee){return ee===null||Wn(ee)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),A(ee)):zr(ee)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ii(e,k,"whitespace")(ee)):ee===96&&ee===_?n(ee):(e.consume(ee),O)}function k(ee){return ee===null||Wn(ee)?A(ee):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),N(ee))}function N(ee){return ee===null||Wn(ee)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),A(ee)):ee===96&&ee===_?n(ee):(e.consume(ee),N)}function z(ee){return e.attempt(u,Y,U)(ee)}function U(ee){return e.enter("lineEnding"),e.consume(ee),e.exit("lineEnding"),j}function j(ee){return h>0&&zr(ee)?ii(e,G,"linePrefix",h+1)(ee):G(ee)}function G(ee){return ee===null||Wn(ee)?e.check(xU,z,Y)(ee):(e.enter("codeFlowValue"),H(ee))}function H(ee){return ee===null||Wn(ee)?(e.exit("codeFlowValue"),G(ee)):(e.consume(ee),H)}function Y(ee){return e.exit("codeFenced"),t(ee)}function K(ee,ue,ve){let Fe=0;return Ne;function Ne(rt){return ee.enter("lineEnding"),ee.consume(rt),ee.exit("lineEnding"),Oe}function Oe(rt){return ee.enter("codeFencedFence"),zr(rt)?ii(ee,Le,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(rt):Le(rt)}function Le(rt){return rt===_?(ee.enter("codeFencedFenceSequence"),Ue(rt)):ve(rt)}function Ue(rt){return rt===_?(Fe++,ee.consume(rt),Ue):Fe>=p?(ee.exit("codeFencedFenceSequence"),zr(rt)?ii(ee,et,"whitespace")(rt):et(rt)):ve(rt)}function et(rt){return rt===null||Wn(rt)?(ee.exit("codeFencedFence"),ue(rt)):ve(rt)}}}function fNe(e,t,n){const o=this;return u;function u(p){return p===null?n(p):(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),h)}function h(p){return o.parser.lazy[o.now().line]?n(p):t(p)}}const rI={name:"codeIndented",tokenize:pNe},dNe={tokenize:mNe,partial:!0};function pNe(e,t,n){const o=this;return u;function u(b){return e.enter("codeIndented"),ii(e,h,"linePrefix",5)(b)}function h(b){const C=o.events[o.events.length-1];return C&&C[1].type==="linePrefix"&&C[2].sliceSerialize(C[1],!0).length>=4?p(b):n(b)}function p(b){return b===null?a(b):Wn(b)?e.attempt(dNe,p,a)(b):(e.enter("codeFlowValue"),_(b))}function _(b){return b===null||Wn(b)?(e.exit("codeFlowValue"),p(b)):(e.consume(b),_)}function a(b){return e.exit("codeIndented"),t(b)}}function mNe(e,t,n){const o=this;return u;function u(p){return o.parser.lazy[o.now().line]?n(p):Wn(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),u):ii(e,h,"linePrefix",5)(p)}function h(p){const _=o.events[o.events.length-1];return _&&_[1].type==="linePrefix"&&_[2].sliceSerialize(_[1],!0).length>=4?t(p):Wn(p)?u(p):n(p)}}const gNe={name:"codeText",tokenize:vNe,resolve:yNe,previous:_Ne};function yNe(e){let t=e.length-4,n=3,o,u;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(o=n;++o<t;)if(e[o][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(o=n-1,t++;++o<=t;)u===void 0?o!==t&&e[o][1].type!=="lineEnding"&&(u=o):(o===t||e[o][1].type==="lineEnding")&&(e[u][1].type="codeTextData",o!==u+2&&(e[u][1].end=e[o-1][1].end,e.splice(u+2,o-u-2),t-=o-u-2,o=u+2),u=void 0);return e}function _Ne(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function vNe(e,t,n){let o=0,u,h;return p;function p(A){return e.enter("codeText"),e.enter("codeTextSequence"),_(A)}function _(A){return A===96?(e.consume(A),o++,_):(e.exit("codeTextSequence"),a(A))}function a(A){return A===null?n(A):A===32?(e.enter("space"),e.consume(A),e.exit("space"),a):A===96?(h=e.enter("codeTextSequence"),u=0,C(A)):Wn(A)?(e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),a):(e.enter("codeTextData"),b(A))}function b(A){return A===null||A===32||A===96||Wn(A)?(e.exit("codeTextData"),a(A)):(e.consume(A),b)}function C(A){return A===96?(e.consume(A),u++,C):u===o?(e.exit("codeTextSequence"),e.exit("codeText"),t(A)):(h.type="codeTextData",b(A))}}class xNe{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const o=n??Number.POSITIVE_INFINITY;return o<this.left.length?this.left.slice(t,o):t>this.left.length?this.right.slice(this.right.length-o+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-o+this.left.length).reverse())}splice(t,n,o){const u=n||0;this.setCursor(Math.trunc(t));const h=this.right.splice(this.right.length-u,Number.POSITIVE_INFINITY);return o&&Pv(this.left,o),h.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Pv(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Pv(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);Pv(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Pv(this.left,n.reverse())}}}function Pv(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function OY(e){const t={};let n=-1,o,u,h,p,_,a,b;const C=new xNe(e);for(;++n<C.length;){for(;n in t;)n=t[n];if(o=C.get(n),n&&o[1].type==="chunkFlow"&&C.get(n-1)[1].type==="listItemPrefix"&&(a=o[1]._tokenizer.events,h=0,h<a.length&&a[h][1].type==="lineEndingBlank"&&(h+=2),h<a.length&&a[h][1].type==="content"))for(;++h<a.length&&a[h][1].type!=="content";)a[h][1].type==="chunkText"&&(a[h][1]._isInFirstContentOfListItem=!0,h++);if(o[0]==="enter")o[1].contentType&&(Object.assign(t,bNe(C,n)),n=t[n],b=!0);else if(o[1]._container){for(h=n,u=void 0;h--&&(p=C.get(h),p[1].type==="lineEnding"||p[1].type==="lineEndingBlank");)p[0]==="enter"&&(u&&(C.get(u)[1].type="lineEndingBlank"),p[1].type="lineEnding",u=h);u&&(o[1].end=Object.assign({},C.get(u)[1].start),_=C.slice(u,n),_.unshift(o),C.splice(u,n-u+1,_))}}return Qu(e,0,Number.POSITIVE_INFINITY,C.slice(0)),!b}function bNe(e,t){const n=e.get(t)[1],o=e.get(t)[2];let u=t-1;const h=[],p=n._tokenizer||o.parser[n.contentType](n.start),_=p.events,a=[],b={};let C,A,O=-1,k=n,N=0,z=0;const U=[z];for(;k;){for(;e.get(++u)[1]!==k;);h.push(u),k._tokenizer||(C=o.sliceStream(k),k.next||C.push(null),A&&p.defineSkip(k.start),k._isInFirstContentOfListItem&&(p._gfmTasklistFirstContentOfListItem=!0),p.write(C),k._isInFirstContentOfListItem&&(p._gfmTasklistFirstContentOfListItem=void 0)),A=k,k=k.next}for(k=n;++O<_.length;)_[O][0]==="exit"&&_[O-1][0]==="enter"&&_[O][1].type===_[O-1][1].type&&_[O][1].start.line!==_[O][1].end.line&&(z=O+1,U.push(z),k._tokenizer=void 0,k.previous=void 0,k=k.next);for(p.events=[],k?(k._tokenizer=void 0,k.previous=void 0):U.pop(),O=U.length;O--;){const j=_.slice(U[O],U[O+1]),G=h.pop();a.push([G,G+j.length-1]),e.splice(G,2,j)}for(a.reverse(),O=-1;++O<a.length;)b[N+a[O][0]]=N+a[O][1],N+=a[O][1]-a[O][0]-1;return b}const wNe={tokenize:ENe,resolve:TNe},SNe={tokenize:ANe,partial:!0};function TNe(e){return OY(e),e}function ENe(e,t){let n;return o;function o(_){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),u(_)}function u(_){return _===null?h(_):Wn(_)?e.check(SNe,p,h)(_):(e.consume(_),u)}function h(_){return e.exit("chunkContent"),e.exit("content"),t(_)}function p(_){return e.consume(_),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,u}}function ANe(e,t,n){const o=this;return u;function u(p){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),ii(e,h,"linePrefix")}function h(p){if(p===null||Wn(p))return n(p);const _=o.events[o.events.length-1];return!o.parser.constructs.disable.null.includes("codeIndented")&&_&&_[1].type==="linePrefix"&&_[2].sliceSerialize(_[1],!0).length>=4?t(p):e.interrupt(o.parser.constructs.flow,n,t)(p)}}function RY(e,t,n,o,u,h,p,_,a){const b=a||Number.POSITIVE_INFINITY;let C=0;return A;function A(j){return j===60?(e.enter(o),e.enter(u),e.enter(h),e.consume(j),e.exit(h),O):j===null||j===32||j===41||hR(j)?n(j):(e.enter(o),e.enter(p),e.enter(_),e.enter("chunkString",{contentType:"string"}),z(j))}function O(j){return j===62?(e.enter(h),e.consume(j),e.exit(h),e.exit(u),e.exit(o),t):(e.enter(_),e.enter("chunkString",{contentType:"string"}),k(j))}function k(j){return j===62?(e.exit("chunkString"),e.exit(_),O(j)):j===null||j===60||Wn(j)?n(j):(e.consume(j),j===92?N:k)}function N(j){return j===60||j===62||j===92?(e.consume(j),k):k(j)}function z(j){return!C&&(j===null||j===41||va(j))?(e.exit("chunkString"),e.exit(_),e.exit(p),e.exit(o),t(j)):C<b&&j===40?(e.consume(j),C++,z):j===41?(e.consume(j),C--,z):j===null||j===32||j===40||hR(j)?n(j):(e.consume(j),j===92?U:z)}function U(j){return j===40||j===41||j===92?(e.consume(j),z):z(j)}}function kY(e,t,n,o,u,h){const p=this;let _=0,a;return b;function b(k){return e.enter(o),e.enter(u),e.consume(k),e.exit(u),e.enter(h),C}function C(k){return _>999||k===null||k===91||k===93&&!a||k===94&&!_&&"_hiddenFootnoteSupport"in p.parser.constructs?n(k):k===93?(e.exit(h),e.enter(u),e.consume(k),e.exit(u),e.exit(o),t):Wn(k)?(e.enter("lineEnding"),e.consume(k),e.exit("lineEnding"),C):(e.enter("chunkString",{contentType:"string"}),A(k))}function A(k){return k===null||k===91||k===93||Wn(k)||_++>999?(e.exit("chunkString"),C(k)):(e.consume(k),a||(a=!zr(k)),k===92?O:A)}function O(k){return k===91||k===92||k===93?(e.consume(k),_++,A):A(k)}}function DY(e,t,n,o,u,h){let p;return _;function _(O){return O===34||O===39||O===40?(e.enter(o),e.enter(u),e.consume(O),e.exit(u),p=O===40?41:O,a):n(O)}function a(O){return O===p?(e.enter(u),e.consume(O),e.exit(u),e.exit(o),t):(e.enter(h),b(O))}function b(O){return O===p?(e.exit(h),a(p)):O===null?n(O):Wn(O)?(e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),ii(e,b,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),C(O))}function C(O){return O===p||O===null||Wn(O)?(e.exit("chunkString"),b(O)):(e.consume(O),O===92?A:C)}function A(O){return O===p||O===92?(e.consume(O),C):C(O)}}function i0(e,t){let n;return o;function o(u){return Wn(u)?(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),n=!0,o):zr(u)?ii(e,o,n?"linePrefix":"lineSuffix")(u):t(u)}}const CNe={name:"definition",tokenize:MNe},PNe={tokenize:INe,partial:!0};function MNe(e,t,n){const o=this;let u;return h;function h(k){return e.enter("definition"),p(k)}function p(k){return kY.call(o,e,_,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(k)}function _(k){return u=og(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)),k===58?(e.enter("definitionMarker"),e.consume(k),e.exit("definitionMarker"),a):n(k)}function a(k){return va(k)?i0(e,b)(k):b(k)}function b(k){return RY(e,C,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(k)}function C(k){return e.attempt(PNe,A,A)(k)}function A(k){return zr(k)?ii(e,O,"whitespace")(k):O(k)}function O(k){return k===null||Wn(k)?(e.exit("definition"),o.parser.defined.push(u),t(k)):n(k)}}function INe(e,t,n){return o;function o(_){return va(_)?i0(e,u)(_):n(_)}function u(_){return DY(e,h,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(_)}function h(_){return zr(_)?ii(e,p,"whitespace")(_):p(_)}function p(_){return _===null||Wn(_)?t(_):n(_)}}const ONe={name:"hardBreakEscape",tokenize:RNe};function RNe(e,t,n){return o;function o(h){return e.enter("hardBreakEscape"),e.consume(h),u}function u(h){return Wn(h)?(e.exit("hardBreakEscape"),t(h)):n(h)}}const kNe={name:"headingAtx",tokenize:LNe,resolve:DNe};function DNe(e,t){let n=e.length-2,o=3,u,h;return e[o][1].type==="whitespace"&&(o+=2),n-2>o&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(o===n-1||n-4>o&&e[n-2][1].type==="whitespace")&&(n-=o+1===n?2:4),n>o&&(u={type:"atxHeadingText",start:e[o][1].start,end:e[n][1].end},h={type:"chunkText",start:e[o][1].start,end:e[n][1].end,contentType:"text"},Qu(e,o,n-o+1,[["enter",u,t],["enter",h,t],["exit",h,t],["exit",u,t]])),e}function LNe(e,t,n){let o=0;return u;function u(C){return e.enter("atxHeading"),h(C)}function h(C){return e.enter("atxHeadingSequence"),p(C)}function p(C){return C===35&&o++<6?(e.consume(C),p):C===null||va(C)?(e.exit("atxHeadingSequence"),_(C)):n(C)}function _(C){return C===35?(e.enter("atxHeadingSequence"),a(C)):C===null||Wn(C)?(e.exit("atxHeading"),t(C)):zr(C)?ii(e,_,"whitespace")(C):(e.enter("atxHeadingText"),b(C))}function a(C){return C===35?(e.consume(C),a):(e.exit("atxHeadingSequence"),_(C))}function b(C){return C===null||C===35||va(C)?(e.exit("atxHeadingText"),_(C)):(e.consume(C),b)}}const zNe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],wU=["pre","script","style","textarea"],FNe={name:"htmlFlow",tokenize:$Ne,resolveTo:jNe,concrete:!0},NNe={tokenize:VNe,partial:!0},BNe={tokenize:UNe,partial:!0};function jNe(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function $Ne(e,t,n){const o=this;let u,h,p,_,a;return b;function b(Se){return C(Se)}function C(Se){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(Se),A}function A(Se){return Se===33?(e.consume(Se),O):Se===47?(e.consume(Se),h=!0,z):Se===63?(e.consume(Se),u=3,o.interrupt?t:de):zl(Se)?(e.consume(Se),p=String.fromCharCode(Se),U):n(Se)}function O(Se){return Se===45?(e.consume(Se),u=2,k):Se===91?(e.consume(Se),u=5,_=0,N):zl(Se)?(e.consume(Se),u=4,o.interrupt?t:de):n(Se)}function k(Se){return Se===45?(e.consume(Se),o.interrupt?t:de):n(Se)}function N(Se){const qt="CDATA[";return Se===qt.charCodeAt(_++)?(e.consume(Se),_===qt.length?o.interrupt?t:Le:N):n(Se)}function z(Se){return zl(Se)?(e.consume(Se),p=String.fromCharCode(Se),U):n(Se)}function U(Se){if(Se===null||Se===47||Se===62||va(Se)){const qt=Se===47,an=p.toLowerCase();return!qt&&!h&&wU.includes(an)?(u=1,o.interrupt?t(Se):Le(Se)):zNe.includes(p.toLowerCase())?(u=6,qt?(e.consume(Se),j):o.interrupt?t(Se):Le(Se)):(u=7,o.interrupt&&!o.parser.lazy[o.now().line]?n(Se):h?G(Se):H(Se))}return Se===45||Ba(Se)?(e.consume(Se),p+=String.fromCharCode(Se),U):n(Se)}function j(Se){return Se===62?(e.consume(Se),o.interrupt?t:Le):n(Se)}function G(Se){return zr(Se)?(e.consume(Se),G):Ne(Se)}function H(Se){return Se===47?(e.consume(Se),Ne):Se===58||Se===95||zl(Se)?(e.consume(Se),Y):zr(Se)?(e.consume(Se),H):Ne(Se)}function Y(Se){return Se===45||Se===46||Se===58||Se===95||Ba(Se)?(e.consume(Se),Y):K(Se)}function K(Se){return Se===61?(e.consume(Se),ee):zr(Se)?(e.consume(Se),K):H(Se)}function ee(Se){return Se===null||Se===60||Se===61||Se===62||Se===96?n(Se):Se===34||Se===39?(e.consume(Se),a=Se,ue):zr(Se)?(e.consume(Se),ee):ve(Se)}function ue(Se){return Se===a?(e.consume(Se),a=null,Fe):Se===null||Wn(Se)?n(Se):(e.consume(Se),ue)}function ve(Se){return Se===null||Se===34||Se===39||Se===47||Se===60||Se===61||Se===62||Se===96||va(Se)?K(Se):(e.consume(Se),ve)}function Fe(Se){return Se===47||Se===62||zr(Se)?H(Se):n(Se)}function Ne(Se){return Se===62?(e.consume(Se),Oe):n(Se)}function Oe(Se){return Se===null||Wn(Se)?Le(Se):zr(Se)?(e.consume(Se),Oe):n(Se)}function Le(Se){return Se===45&&u===2?(e.consume(Se),st):Se===60&&u===1?(e.consume(Se),Ke):Se===62&&u===4?(e.consume(Se),lt):Se===63&&u===3?(e.consume(Se),de):Se===93&&u===5?(e.consume(Se),Xe):Wn(Se)&&(u===6||u===7)?(e.exit("htmlFlowData"),e.check(NNe,gt,Ue)(Se)):Se===null||Wn(Se)?(e.exit("htmlFlowData"),Ue(Se)):(e.consume(Se),Le)}function Ue(Se){return e.check(BNe,et,gt)(Se)}function et(Se){return e.enter("lineEnding"),e.consume(Se),e.exit("lineEnding"),rt}function rt(Se){return Se===null||Wn(Se)?Ue(Se):(e.enter("htmlFlowData"),Le(Se))}function st(Se){return Se===45?(e.consume(Se),de):Le(Se)}function Ke(Se){return Se===47?(e.consume(Se),p="",Ze):Le(Se)}function Ze(Se){if(Se===62){const qt=p.toLowerCase();return wU.includes(qt)?(e.consume(Se),lt):Le(Se)}return zl(Se)&&p.length<8?(e.consume(Se),p+=String.fromCharCode(Se),Ze):Le(Se)}function Xe(Se){return Se===93?(e.consume(Se),de):Le(Se)}function de(Se){return Se===62?(e.consume(Se),lt):Se===45&&u===2?(e.consume(Se),de):Le(Se)}function lt(Se){return Se===null||Wn(Se)?(e.exit("htmlFlowData"),gt(Se)):(e.consume(Se),lt)}function gt(Se){return e.exit("htmlFlow"),t(Se)}}function UNe(e,t,n){const o=this;return u;function u(p){return Wn(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),h):n(p)}function h(p){return o.parser.lazy[o.now().line]?n(p):t(p)}}function VNe(e,t,n){return o;function o(u){return e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),e.attempt(yA,t,n)}}const GNe={name:"htmlText",tokenize:WNe};function WNe(e,t,n){const o=this;let u,h,p;return _;function _(de){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(de),a}function a(de){return de===33?(e.consume(de),b):de===47?(e.consume(de),K):de===63?(e.consume(de),H):zl(de)?(e.consume(de),ve):n(de)}function b(de){return de===45?(e.consume(de),C):de===91?(e.consume(de),h=0,N):zl(de)?(e.consume(de),G):n(de)}function C(de){return de===45?(e.consume(de),k):n(de)}function A(de){return de===null?n(de):de===45?(e.consume(de),O):Wn(de)?(p=A,Ke(de)):(e.consume(de),A)}function O(de){return de===45?(e.consume(de),k):A(de)}function k(de){return de===62?st(de):de===45?O(de):A(de)}function N(de){const lt="CDATA[";return de===lt.charCodeAt(h++)?(e.consume(de),h===lt.length?z:N):n(de)}function z(de){return de===null?n(de):de===93?(e.consume(de),U):Wn(de)?(p=z,Ke(de)):(e.consume(de),z)}function U(de){return de===93?(e.consume(de),j):z(de)}function j(de){return de===62?st(de):de===93?(e.consume(de),j):z(de)}function G(de){return de===null||de===62?st(de):Wn(de)?(p=G,Ke(de)):(e.consume(de),G)}function H(de){return de===null?n(de):de===63?(e.consume(de),Y):Wn(de)?(p=H,Ke(de)):(e.consume(de),H)}function Y(de){return de===62?st(de):H(de)}function K(de){return zl(de)?(e.consume(de),ee):n(de)}function ee(de){return de===45||Ba(de)?(e.consume(de),ee):ue(de)}function ue(de){return Wn(de)?(p=ue,Ke(de)):zr(de)?(e.consume(de),ue):st(de)}function ve(de){return de===45||Ba(de)?(e.consume(de),ve):de===47||de===62||va(de)?Fe(de):n(de)}function Fe(de){return de===47?(e.consume(de),st):de===58||de===95||zl(de)?(e.consume(de),Ne):Wn(de)?(p=Fe,Ke(de)):zr(de)?(e.consume(de),Fe):st(de)}function Ne(de){return de===45||de===46||de===58||de===95||Ba(de)?(e.consume(de),Ne):Oe(de)}function Oe(de){return de===61?(e.consume(de),Le):Wn(de)?(p=Oe,Ke(de)):zr(de)?(e.consume(de),Oe):Fe(de)}function Le(de){return de===null||de===60||de===61||de===62||de===96?n(de):de===34||de===39?(e.consume(de),u=de,Ue):Wn(de)?(p=Le,Ke(de)):zr(de)?(e.consume(de),Le):(e.consume(de),et)}function Ue(de){return de===u?(e.consume(de),u=void 0,rt):de===null?n(de):Wn(de)?(p=Ue,Ke(de)):(e.consume(de),Ue)}function et(de){return de===null||de===34||de===39||de===60||de===61||de===96?n(de):de===47||de===62||va(de)?Fe(de):(e.consume(de),et)}function rt(de){return de===47||de===62||va(de)?Fe(de):n(de)}function st(de){return de===62?(e.consume(de),e.exit("htmlTextData"),e.exit("htmlText"),t):n(de)}function Ke(de){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(de),e.exit("lineEnding"),Ze}function Ze(de){return zr(de)?ii(e,Xe,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(de):Xe(de)}function Xe(de){return e.enter("htmlTextData"),p(de)}}const yL={name:"labelEnd",tokenize:KNe,resolveTo:YNe,resolveAll:XNe},HNe={tokenize:QNe},qNe={tokenize:JNe},ZNe={tokenize:eBe};function XNe(e){let t=-1;for(;++t<e.length;){const n=e[t][1];(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(e.splice(t+1,n.type==="labelImage"?4:2),n.type="data",t++)}return e}function YNe(e,t){let n=e.length,o=0,u,h,p,_;for(;n--;)if(u=e[n][1],h){if(u.type==="link"||u.type==="labelLink"&&u._inactive)break;e[n][0]==="enter"&&u.type==="labelLink"&&(u._inactive=!0)}else if(p){if(e[n][0]==="enter"&&(u.type==="labelImage"||u.type==="labelLink")&&!u._balanced&&(h=n,u.type!=="labelLink")){o=2;break}}else u.type==="labelEnd"&&(p=n);const a={type:e[h][1].type==="labelLink"?"link":"image",start:Object.assign({},e[h][1].start),end:Object.assign({},e[e.length-1][1].end)},b={type:"label",start:Object.assign({},e[h][1].start),end:Object.assign({},e[p][1].end)},C={type:"labelText",start:Object.assign({},e[h+o+2][1].end),end:Object.assign({},e[p-2][1].start)};return _=[["enter",a,t],["enter",b,t]],_=ms(_,e.slice(h+1,h+o+3)),_=ms(_,[["enter",C,t]]),_=ms(_,gL(t.parser.constructs.insideSpan.null,e.slice(h+o+4,p-3),t)),_=ms(_,[["exit",C,t],e[p-2],e[p-1],["exit",b,t]]),_=ms(_,e.slice(p+1)),_=ms(_,[["exit",a,t]]),Qu(e,h,e.length,_),e}function KNe(e,t,n){const o=this;let u=o.events.length,h,p;for(;u--;)if((o.events[u][1].type==="labelImage"||o.events[u][1].type==="labelLink")&&!o.events[u][1]._balanced){h=o.events[u][1];break}return _;function _(O){return h?h._inactive?A(O):(p=o.parser.defined.includes(og(o.sliceSerialize({start:h.end,end:o.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(O),e.exit("labelMarker"),e.exit("labelEnd"),a):n(O)}function a(O){return O===40?e.attempt(HNe,C,p?C:A)(O):O===91?e.attempt(qNe,C,p?b:A)(O):p?C(O):A(O)}function b(O){return e.attempt(ZNe,C,A)(O)}function C(O){return t(O)}function A(O){return h._balanced=!0,n(O)}}function QNe(e,t,n){return o;function o(A){return e.enter("resource"),e.enter("resourceMarker"),e.consume(A),e.exit("resourceMarker"),u}function u(A){return va(A)?i0(e,h)(A):h(A)}function h(A){return A===41?C(A):RY(e,p,_,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(A)}function p(A){return va(A)?i0(e,a)(A):C(A)}function _(A){return n(A)}function a(A){return A===34||A===39||A===40?DY(e,b,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(A):C(A)}function b(A){return va(A)?i0(e,C)(A):C(A)}function C(A){return A===41?(e.enter("resourceMarker"),e.consume(A),e.exit("resourceMarker"),e.exit("resource"),t):n(A)}}function JNe(e,t,n){const o=this;return u;function u(_){return kY.call(o,e,h,p,"reference","referenceMarker","referenceString")(_)}function h(_){return o.parser.defined.includes(og(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)))?t(_):n(_)}function p(_){return n(_)}}function eBe(e,t,n){return o;function o(h){return e.enter("reference"),e.enter("referenceMarker"),e.consume(h),e.exit("referenceMarker"),u}function u(h){return h===93?(e.enter("referenceMarker"),e.consume(h),e.exit("referenceMarker"),e.exit("reference"),t):n(h)}}const tBe={name:"labelStartImage",tokenize:nBe,resolveAll:yL.resolveAll};function nBe(e,t,n){const o=this;return u;function u(_){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(_),e.exit("labelImageMarker"),h}function h(_){return _===91?(e.enter("labelMarker"),e.consume(_),e.exit("labelMarker"),e.exit("labelImage"),p):n(_)}function p(_){return _===94&&"_hiddenFootnoteSupport"in o.parser.constructs?n(_):t(_)}}const rBe={name:"labelStartLink",tokenize:iBe,resolveAll:yL.resolveAll};function iBe(e,t,n){const o=this;return u;function u(p){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(p),e.exit("labelMarker"),e.exit("labelLink"),h}function h(p){return p===94&&"_hiddenFootnoteSupport"in o.parser.constructs?n(p):t(p)}}const iI={name:"lineEnding",tokenize:oBe};function oBe(e,t){return n;function n(o){return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),ii(e,t,"linePrefix")}}const tS={name:"thematicBreak",tokenize:aBe};function aBe(e,t,n){let o=0,u;return h;function h(b){return e.enter("thematicBreak"),p(b)}function p(b){return u=b,_(b)}function _(b){return b===u?(e.enter("thematicBreakSequence"),a(b)):o>=3&&(b===null||Wn(b))?(e.exit("thematicBreak"),t(b)):n(b)}function a(b){return b===u?(e.consume(b),o++,a):(e.exit("thematicBreakSequence"),zr(b)?ii(e,_,"whitespace")(b):_(b))}}const fa={name:"list",tokenize:uBe,continuation:{tokenize:cBe},exit:fBe},sBe={tokenize:dBe,partial:!0},lBe={tokenize:hBe,partial:!0};function uBe(e,t,n){const o=this,u=o.events[o.events.length-1];let h=u&&u[1].type==="linePrefix"?u[2].sliceSerialize(u[1],!0).length:0,p=0;return _;function _(k){const N=o.containerState.type||(k===42||k===43||k===45?"listUnordered":"listOrdered");if(N==="listUnordered"?!o.containerState.marker||k===o.containerState.marker:fR(k)){if(o.containerState.type||(o.containerState.type=N,e.enter(N,{_container:!0})),N==="listUnordered")return e.enter("listItemPrefix"),k===42||k===45?e.check(tS,n,b)(k):b(k);if(!o.interrupt||k===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),a(k)}return n(k)}function a(k){return fR(k)&&++p<10?(e.consume(k),a):(!o.interrupt||p<2)&&(o.containerState.marker?k===o.containerState.marker:k===41||k===46)?(e.exit("listItemValue"),b(k)):n(k)}function b(k){return e.enter("listItemMarker"),e.consume(k),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||k,e.check(yA,o.interrupt?n:C,e.attempt(sBe,O,A))}function C(k){return o.containerState.initialBlankLine=!0,h++,O(k)}function A(k){return zr(k)?(e.enter("listItemPrefixWhitespace"),e.consume(k),e.exit("listItemPrefixWhitespace"),O):n(k)}function O(k){return o.containerState.size=h+o.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(k)}}function cBe(e,t,n){const o=this;return o.containerState._closeFlow=void 0,e.check(yA,u,h);function u(_){return o.containerState.furtherBlankLines=o.containerState.furtherBlankLines||o.containerState.initialBlankLine,ii(e,t,"listItemIndent",o.containerState.size+1)(_)}function h(_){return o.containerState.furtherBlankLines||!zr(_)?(o.containerState.furtherBlankLines=void 0,o.containerState.initialBlankLine=void 0,p(_)):(o.containerState.furtherBlankLines=void 0,o.containerState.initialBlankLine=void 0,e.attempt(lBe,t,p)(_))}function p(_){return o.containerState._closeFlow=!0,o.interrupt=void 0,ii(e,e.attempt(fa,t,n),"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(_)}}function hBe(e,t,n){const o=this;return ii(e,u,"listItemIndent",o.containerState.size+1);function u(h){const p=o.events[o.events.length-1];return p&&p[1].type==="listItemIndent"&&p[2].sliceSerialize(p[1],!0).length===o.containerState.size?t(h):n(h)}}function fBe(e){e.exit(this.containerState.type)}function dBe(e,t,n){const o=this;return ii(e,u,"listItemPrefixWhitespace",o.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function u(h){const p=o.events[o.events.length-1];return!zr(h)&&p&&p[1].type==="listItemPrefixWhitespace"?t(h):n(h)}}const SU={name:"setextUnderline",tokenize:mBe,resolveTo:pBe};function pBe(e,t){let n=e.length,o,u,h;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){o=n;break}e[n][1].type==="paragraph"&&(u=n)}else e[n][1].type==="content"&&e.splice(n,1),!h&&e[n][1].type==="definition"&&(h=n);const p={type:"setextHeading",start:Object.assign({},e[u][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[u][1].type="setextHeadingText",h?(e.splice(u,0,["enter",p,t]),e.splice(h+1,0,["exit",e[o][1],t]),e[o][1].end=Object.assign({},e[h][1].end)):e[o][1]=p,e.push(["exit",p,t]),e}function mBe(e,t,n){const o=this;let u;return h;function h(b){let C=o.events.length,A;for(;C--;)if(o.events[C][1].type!=="lineEnding"&&o.events[C][1].type!=="linePrefix"&&o.events[C][1].type!=="content"){A=o.events[C][1].type==="paragraph";break}return!o.parser.lazy[o.now().line]&&(o.interrupt||A)?(e.enter("setextHeadingLine"),u=b,p(b)):n(b)}function p(b){return e.enter("setextHeadingLineSequence"),_(b)}function _(b){return b===u?(e.consume(b),_):(e.exit("setextHeadingLineSequence"),zr(b)?ii(e,a,"lineSuffix")(b):a(b))}function a(b){return b===null||Wn(b)?(e.exit("setextHeadingLine"),t(b)):n(b)}}const gBe={tokenize:yBe};function yBe(e){const t=this,n=e.attempt(yA,o,e.attempt(this.parser.constructs.flowInitial,u,ii(e,e.attempt(this.parser.constructs.flow,u,e.attempt(wNe,u)),"linePrefix")));return n;function o(h){if(h===null){e.consume(h);return}return e.enter("lineEndingBlank"),e.consume(h),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function u(h){if(h===null){e.consume(h);return}return e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const _Be={resolveAll:zY()},vBe=LY("string"),xBe=LY("text");function LY(e){return{tokenize:t,resolveAll:zY(e==="text"?bBe:void 0)};function t(n){const o=this,u=this.parser.constructs[e],h=n.attempt(u,p,_);return p;function p(C){return b(C)?h(C):_(C)}function _(C){if(C===null){n.consume(C);return}return n.enter("data"),n.consume(C),a}function a(C){return b(C)?(n.exit("data"),h(C)):(n.consume(C),a)}function b(C){if(C===null)return!0;const A=u[C];let O=-1;if(A)for(;++O<A.length;){const k=A[O];if(!k.previous||k.previous.call(o,o.previous))return!0}return!1}}}function zY(e){return t;function t(n,o){let u=-1,h;for(;++u<=n.length;)h===void 0?n[u]&&n[u][1].type==="data"&&(h=u,u++):(!n[u]||n[u][1].type!=="data")&&(u!==h+2&&(n[h][1].end=n[u-1][1].end,n.splice(h+2,u-h-2),u=h+2),h=void 0);return e?e(n,o):n}}function bBe(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const o=e[n-1][1],u=t.sliceStream(o);let h=u.length,p=-1,_=0,a;for(;h--;){const b=u[h];if(typeof b=="string"){for(p=b.length;b.charCodeAt(p-1)===32;)_++,p--;if(p)break;p=-1}else if(b===-2)a=!0,_++;else if(b!==-1){h++;break}}if(_){const b={type:n===e.length||a||_<2?"lineSuffix":"hardBreakTrailing",start:{line:o.end.line,column:o.end.column-_,offset:o.end.offset-_,_index:o.start._index+h,_bufferIndex:h?p:o.start._bufferIndex+p},end:Object.assign({},o.end)};o.end=Object.assign({},b.start),o.start.offset===o.end.offset?Object.assign(o,b):(e.splice(n,0,["enter",b,t],["exit",b,t]),n+=2)}n++}return e}function wBe(e,t,n){let o=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const u={},h=[];let p=[],_=[];const a={consume:G,enter:H,exit:Y,attempt:ue(K),check:ue(ee),interrupt:ue(ee,{interrupt:!0})},b={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:k,sliceSerialize:O,now:N,defineSkip:z,write:A};let C=t.tokenize.call(b,a);return t.resolveAll&&h.push(t),b;function A(Oe){return p=ms(p,Oe),U(),p[p.length-1]!==null?[]:(ve(t,0),b.events=gL(h,b.events,b),b.events)}function O(Oe,Le){return TBe(k(Oe),Le)}function k(Oe){return SBe(p,Oe)}function N(){const{line:Oe,column:Le,offset:Ue,_index:et,_bufferIndex:rt}=o;return{line:Oe,column:Le,offset:Ue,_index:et,_bufferIndex:rt}}function z(Oe){u[Oe.line]=Oe.column,Ne()}function U(){let Oe;for(;o._index<p.length;){const Le=p[o._index];if(typeof Le=="string")for(Oe=o._index,o._bufferIndex<0&&(o._bufferIndex=0);o._index===Oe&&o._bufferIndex<Le.length;)j(Le.charCodeAt(o._bufferIndex));else j(Le)}}function j(Oe){C=C(Oe)}function G(Oe){Wn(Oe)?(o.line++,o.column=1,o.offset+=Oe===-3?2:1,Ne()):Oe!==-1&&(o.column++,o.offset++),o._bufferIndex<0?o._index++:(o._bufferIndex++,o._bufferIndex===p[o._index].length&&(o._bufferIndex=-1,o._index++)),b.previous=Oe}function H(Oe,Le){const Ue=Le||{};return Ue.type=Oe,Ue.start=N(),b.events.push(["enter",Ue,b]),_.push(Ue),Ue}function Y(Oe){const Le=_.pop();return Le.end=N(),b.events.push(["exit",Le,b]),Le}function K(Oe,Le){ve(Oe,Le.from)}function ee(Oe,Le){Le.restore()}function ue(Oe,Le){return Ue;function Ue(et,rt,st){let Ke,Ze,Xe,de;return Array.isArray(et)?gt(et):"tokenize"in et?gt([et]):lt(et);function lt(dn){return Wt;function Wt(An){const ht=An!==null&&dn[An],Zt=An!==null&&dn.null,jt=[...Array.isArray(ht)?ht:ht?[ht]:[],...Array.isArray(Zt)?Zt:Zt?[Zt]:[]];return gt(jt)(An)}}function gt(dn){return Ke=dn,Ze=0,dn.length===0?st:Se(dn[Ze])}function Se(dn){return Wt;function Wt(An){return de=Fe(),Xe=dn,dn.partial||(b.currentConstruct=dn),dn.name&&b.parser.constructs.disable.null.includes(dn.name)?an():dn.tokenize.call(Le?Object.assign(Object.create(b),Le):b,a,qt,an)(An)}}function qt(dn){return Oe(Xe,de),rt}function an(dn){return de.restore(),++Ze<Ke.length?Se(Ke[Ze]):st}}}function ve(Oe,Le){Oe.resolveAll&&!h.includes(Oe)&&h.push(Oe),Oe.resolve&&Qu(b.events,Le,b.events.length-Le,Oe.resolve(b.events.slice(Le),b)),Oe.resolveTo&&(b.events=Oe.resolveTo(b.events,b))}function Fe(){const Oe=N(),Le=b.previous,Ue=b.currentConstruct,et=b.events.length,rt=Array.from(_);return{restore:st,from:et};function st(){o=Oe,b.previous=Le,b.currentConstruct=Ue,b.events.length=et,_=rt,Ne()}}function Ne(){o.line in u&&o.column<2&&(o.column=u[o.line],o.offset+=u[o.line]-1)}}function SBe(e,t){const n=t.start._index,o=t.start._bufferIndex,u=t.end._index,h=t.end._bufferIndex;let p;if(n===u)p=[e[n].slice(o,h)];else{if(p=e.slice(n,u),o>-1){const _=p[0];typeof _=="string"?p[0]=_.slice(o):p.shift()}h>0&&p.push(e[u].slice(0,h))}return p}function TBe(e,t){let n=-1;const o=[];let u;for(;++n<e.length;){const h=e[n];let p;if(typeof h=="string")p=h;else switch(h){case-5:{p="\r";break}case-4:{p=`
`;break}case-3:{p=`\r
`;break}case-2:{p=t?" ":"	";break}case-1:{if(!t&&u)continue;p=" ";break}default:p=String.fromCharCode(h)}u=h===-2,o.push(p)}return o.join("")}const EBe={42:fa,43:fa,45:fa,48:fa,49:fa,50:fa,51:fa,52:fa,53:fa,54:fa,55:fa,56:fa,57:fa,62:PY},ABe={91:CNe},CBe={[-2]:rI,[-1]:rI,32:rI},PBe={35:kNe,42:tS,45:[SU,tS],60:FNe,61:SU,95:tS,96:bU,126:bU},MBe={38:IY,92:MY},IBe={[-5]:iI,[-4]:iI,[-3]:iI,33:tBe,38:IY,42:dR,60:[rNe,GNe],91:rBe,92:[ONe,MY],93:yL,95:dR,96:gNe},OBe={null:[dR,_Be]},RBe={null:[42,95]},kBe={null:[]},DBe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:RBe,contentInitial:ABe,disable:kBe,document:EBe,flow:PBe,flowInitial:CBe,insideSpan:OBe,string:MBe,text:IBe},Symbol.toStringTag,{value:"Module"}));function LBe(e){const n=UFe([DBe,...(e||{}).extensions||[]]),o={defined:[],lazy:{},constructs:n,content:u(YFe),document:u(QFe),flow:u(gBe),string:u(vBe),text:u(xBe)};return o;function u(h){return p;function p(_){return wBe(o,h,_)}}}function zBe(e){for(;!OY(e););return e}const TU=/[\0\t\n\r]/g;function FBe(){let e=1,t="",n=!0,o;return u;function u(h,p,_){const a=[];let b,C,A,O,k;for(h=t+(typeof h=="string"?h.toString():new TextDecoder(p||void 0).decode(h)),A=0,t="",n&&(h.charCodeAt(0)===65279&&A++,n=void 0);A<h.length;){if(TU.lastIndex=A,b=TU.exec(h),O=b&&b.index!==void 0?b.index:h.length,k=h.charCodeAt(O),!b){t=h.slice(A);break}if(k===10&&A===O&&o)a.push(-3),o=void 0;else switch(o&&(a.push(-5),o=void 0),A<O&&(a.push(h.slice(A,O)),e+=O-A),k){case 0:{a.push(65533),e++;break}case 9:{for(C=Math.ceil(e/4)*4,a.push(-2);e++<C;)a.push(-1);break}case 10:{a.push(-4),e=1;break}default:o=!0,e=1}A=O+1}return _&&(o&&a.push(-5),t&&a.push(t),a.push(null)),a}}const NBe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function BBe(e){return e.replace(NBe,jBe)}function jBe(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const u=n.charCodeAt(1),h=u===120||u===88;return CY(n.slice(h?2:1),h?16:10)}return mL(n)||e}const FY={}.hasOwnProperty;function $Be(e,t,n){return typeof t!="string"&&(n=t,t=void 0),UBe(n)(zBe(LBe(n).document().write(FBe()(e,t,!0))))}function UBe(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:h(Ii),autolinkProtocol:Fe,autolinkEmail:Fe,atxHeading:h(_r),blockQuote:h(Zt),characterEscape:Fe,characterReference:Fe,codeFenced:h(jt),codeFencedFenceInfo:p,codeFencedFenceMeta:p,codeIndented:h(jt,p),codeText:h(At,p),codeTextData:Fe,data:Fe,codeFlowValue:Fe,definition:h(er),definitionDestinationString:p,definitionLabelString:p,definitionTitleString:p,emphasis:h(Rn),hardBreakEscape:h(dr),hardBreakTrailing:h(dr),htmlFlow:h(vr,p),htmlFlowData:Fe,htmlText:h(vr,p),htmlTextData:Fe,image:h(Zr),label:p,link:h(Ii),listItem:h(rn),listItemValue:O,listOrdered:h(nn,A),listUnordered:h(nn),paragraph:h(ea),reference:Se,referenceString:p,resourceDestinationString:p,resourceTitleString:p,setextHeading:h(_r),strong:h(Ci),thematicBreak:h(ul)},exit:{atxHeading:a(),atxHeadingSequence:K,autolink:a(),autolinkEmail:ht,autolinkProtocol:An,blockQuote:a(),characterEscapeValue:Ne,characterReferenceMarkerHexadecimal:an,characterReferenceMarkerNumeric:an,characterReferenceValue:dn,characterReference:Wt,codeFenced:a(U),codeFencedFence:z,codeFencedFenceInfo:k,codeFencedFenceMeta:N,codeFlowValue:Ne,codeIndented:a(j),codeText:a(rt),codeTextData:Ne,data:Ne,definition:a(),definitionDestinationString:Y,definitionLabelString:G,definitionTitleString:H,emphasis:a(),hardBreakEscape:a(Le),hardBreakTrailing:a(Le),htmlFlow:a(Ue),htmlFlowData:Ne,htmlText:a(et),htmlTextData:Ne,image:a(Ke),label:Xe,labelText:Ze,lineEnding:Oe,link:a(st),listItem:a(),listOrdered:a(),listUnordered:a(),paragraph:a(),referenceString:qt,resourceDestinationString:de,resourceTitleString:lt,resource:gt,setextHeading:a(ve),setextHeadingLineSequence:ue,setextHeadingText:ee,strong:a(),thematicBreak:a()}};NY(t,(e||{}).mdastExtensions||[]);const n={};return o;function o(It){let Yt={type:"root",children:[]};const Mn={stack:[Yt],tokenStack:[],config:t,enter:_,exit:b,buffer:p,resume:C,data:n},Zn=[];let xr=-1;for(;++xr<It.length;)if(It[xr][1].type==="listOrdered"||It[xr][1].type==="listUnordered")if(It[xr][0]==="enter")Zn.push(xr);else{const Wi=Zn.pop();xr=u(It,Wi,xr)}for(xr=-1;++xr<It.length;){const Wi=t[It[xr][0]];FY.call(Wi,It[xr][1].type)&&Wi[It[xr][1].type].call(Object.assign({sliceSerialize:It[xr][2].sliceSerialize},Mn),It[xr][1])}if(Mn.tokenStack.length>0){const Wi=Mn.tokenStack[Mn.tokenStack.length-1];(Wi[1]||EU).call(Mn,void 0,Wi[0])}for(Yt.position={start:ch(It.length>0?It[0][1].start:{line:1,column:1,offset:0}),end:ch(It.length>0?It[It.length-2][1].end:{line:1,column:1,offset:0})},xr=-1;++xr<t.transforms.length;)Yt=t.transforms[xr](Yt)||Yt;return Yt}function u(It,Yt,Mn){let Zn=Yt-1,xr=-1,Wi=!1,Eo,ro,Oi,Za;for(;++Zn<=Mn;){const en=It[Zn];switch(en[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{en[0]==="enter"?xr++:xr--,Za=void 0;break}case"lineEndingBlank":{en[0]==="enter"&&(Eo&&!Za&&!xr&&!Oi&&(Oi=Zn),Za=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Za=void 0}if(!xr&&en[0]==="enter"&&en[1].type==="listItemPrefix"||xr===-1&&en[0]==="exit"&&(en[1].type==="listUnordered"||en[1].type==="listOrdered")){if(Eo){let na=Zn;for(ro=void 0;na--;){const pr=It[na];if(pr[1].type==="lineEnding"||pr[1].type==="lineEndingBlank"){if(pr[0]==="exit")continue;ro&&(It[ro][1].type="lineEndingBlank",Wi=!0),pr[1].type="lineEnding",ro=na}else if(!(pr[1].type==="linePrefix"||pr[1].type==="blockQuotePrefix"||pr[1].type==="blockQuotePrefixWhitespace"||pr[1].type==="blockQuoteMarker"||pr[1].type==="listItemIndent"))break}Oi&&(!ro||Oi<ro)&&(Eo._spread=!0),Eo.end=Object.assign({},ro?It[ro][1].start:en[1].end),It.splice(ro||Zn,0,["exit",Eo,en[2]]),Zn++,Mn++}if(en[1].type==="listItemPrefix"){const na={type:"listItem",_spread:!1,start:Object.assign({},en[1].start),end:void 0};Eo=na,It.splice(Zn,0,["enter",na,en[2]]),Zn++,Mn++,Oi=void 0,Za=!0}}}return It[Yt][1]._spread=Wi,Mn}function h(It,Yt){return Mn;function Mn(Zn){_.call(this,It(Zn),Zn),Yt&&Yt.call(this,Zn)}}function p(){this.stack.push({type:"fragment",children:[]})}function _(It,Yt,Mn){this.stack[this.stack.length-1].children.push(It),this.stack.push(It),this.tokenStack.push([Yt,Mn]),It.position={start:ch(Yt.start),end:void 0}}function a(It){return Yt;function Yt(Mn){It&&It.call(this,Mn),b.call(this,Mn)}}function b(It,Yt){const Mn=this.stack.pop(),Zn=this.tokenStack.pop();if(Zn)Zn[0].type!==It.type&&(Yt?Yt.call(this,It,Zn[0]):(Zn[1]||EU).call(this,It,Zn[0]));else throw new Error("Cannot close `"+It.type+"` ("+r0({start:It.start,end:It.end})+"): its not open");Mn.position.end=ch(It.end)}function C(){return jFe(this.stack.pop())}function A(){this.data.expectingFirstListItemValue=!0}function O(It){if(this.data.expectingFirstListItemValue){const Yt=this.stack[this.stack.length-2];Yt.start=Number.parseInt(this.sliceSerialize(It),10),this.data.expectingFirstListItemValue=void 0}}function k(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.lang=It}function N(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.meta=It}function z(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function U(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.value=It.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function j(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.value=It.replace(/(\r?\n|\r)$/g,"")}function G(It){const Yt=this.resume(),Mn=this.stack[this.stack.length-1];Mn.label=Yt,Mn.identifier=og(this.sliceSerialize(It)).toLowerCase()}function H(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.title=It}function Y(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.url=It}function K(It){const Yt=this.stack[this.stack.length-1];if(!Yt.depth){const Mn=this.sliceSerialize(It).length;Yt.depth=Mn}}function ee(){this.data.setextHeadingSlurpLineEnding=!0}function ue(It){const Yt=this.stack[this.stack.length-1];Yt.depth=this.sliceSerialize(It).codePointAt(0)===61?1:2}function ve(){this.data.setextHeadingSlurpLineEnding=void 0}function Fe(It){const Mn=this.stack[this.stack.length-1].children;let Zn=Mn[Mn.length-1];(!Zn||Zn.type!=="text")&&(Zn=ta(),Zn.position={start:ch(It.start),end:void 0},Mn.push(Zn)),this.stack.push(Zn)}function Ne(It){const Yt=this.stack.pop();Yt.value+=this.sliceSerialize(It),Yt.position.end=ch(It.end)}function Oe(It){const Yt=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Mn=Yt.children[Yt.children.length-1];Mn.position.end=ch(It.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Yt.type)&&(Fe.call(this,It),Ne.call(this,It))}function Le(){this.data.atHardBreak=!0}function Ue(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.value=It}function et(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.value=It}function rt(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.value=It}function st(){const It=this.stack[this.stack.length-1];if(this.data.inReference){const Yt=this.data.referenceType||"shortcut";It.type+="Reference",It.referenceType=Yt,delete It.url,delete It.title}else delete It.identifier,delete It.label;this.data.referenceType=void 0}function Ke(){const It=this.stack[this.stack.length-1];if(this.data.inReference){const Yt=this.data.referenceType||"shortcut";It.type+="Reference",It.referenceType=Yt,delete It.url,delete It.title}else delete It.identifier,delete It.label;this.data.referenceType=void 0}function Ze(It){const Yt=this.sliceSerialize(It),Mn=this.stack[this.stack.length-2];Mn.label=BBe(Yt),Mn.identifier=og(Yt).toLowerCase()}function Xe(){const It=this.stack[this.stack.length-1],Yt=this.resume(),Mn=this.stack[this.stack.length-1];if(this.data.inReference=!0,Mn.type==="link"){const Zn=It.children;Mn.children=Zn}else Mn.alt=Yt}function de(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.url=It}function lt(){const It=this.resume(),Yt=this.stack[this.stack.length-1];Yt.title=It}function gt(){this.data.inReference=void 0}function Se(){this.data.referenceType="collapsed"}function qt(It){const Yt=this.resume(),Mn=this.stack[this.stack.length-1];Mn.label=Yt,Mn.identifier=og(this.sliceSerialize(It)).toLowerCase(),this.data.referenceType="full"}function an(It){this.data.characterReferenceType=It.type}function dn(It){const Yt=this.sliceSerialize(It),Mn=this.data.characterReferenceType;let Zn;Mn?(Zn=CY(Yt,Mn==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Zn=mL(Yt);const xr=this.stack[this.stack.length-1];xr.value+=Zn}function Wt(It){const Yt=this.stack.pop();Yt.position.end=ch(It.end)}function An(It){Ne.call(this,It);const Yt=this.stack[this.stack.length-1];Yt.url=this.sliceSerialize(It)}function ht(It){Ne.call(this,It);const Yt=this.stack[this.stack.length-1];Yt.url="mailto:"+this.sliceSerialize(It)}function Zt(){return{type:"blockquote",children:[]}}function jt(){return{type:"code",lang:null,meta:null,value:""}}function At(){return{type:"inlineCode",value:""}}function er(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Rn(){return{type:"emphasis",children:[]}}function _r(){return{type:"heading",depth:0,children:[]}}function dr(){return{type:"break"}}function vr(){return{type:"html",value:""}}function Zr(){return{type:"image",title:null,url:"",alt:null}}function Ii(){return{type:"link",title:null,url:"",children:[]}}function nn(It){return{type:"list",ordered:It.type==="listOrdered",start:null,spread:It._spread,children:[]}}function rn(It){return{type:"listItem",spread:It._spread,checked:null,children:[]}}function ea(){return{type:"paragraph",children:[]}}function Ci(){return{type:"strong",children:[]}}function ta(){return{type:"text",value:""}}function ul(){return{type:"thematicBreak"}}}function ch(e){return{line:e.line,column:e.column,offset:e.offset}}function NY(e,t){let n=-1;for(;++n<t.length;){const o=t[n];Array.isArray(o)?NY(e,o):VBe(e,o)}}function VBe(e,t){let n;for(n in t)if(FY.call(t,n))switch(n){case"canContainEols":{const o=t[n];o&&e[n].push(...o);break}case"transforms":{const o=t[n];o&&e[n].push(...o);break}case"enter":case"exit":{const o=t[n];o&&Object.assign(e[n],o);break}}}function EU(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+r0({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+r0({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+r0({start:t.start,end:t.end})+") is still open")}function GBe(e){const t=this;t.parser=n;function n(o){return $Be(o,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function WBe(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function HBe(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function qBe(e,t){const n=t.value?t.value+`
`:"",o={};t.lang&&(o.className=["language-"+t.lang]);let u={type:"element",tagName:"code",properties:o,children:[{type:"text",value:n}]};return t.meta&&(u.data={meta:t.meta}),e.patch(t,u),u=e.applyData(t,u),u={type:"element",tagName:"pre",properties:{},children:[u]},e.patch(t,u),u}function ZBe(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function XBe(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function YBe(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",o=String(t.identifier).toUpperCase(),u=cy(o.toLowerCase()),h=e.footnoteOrder.indexOf(o);let p,_=e.footnoteCounts.get(o);_===void 0?(_=0,e.footnoteOrder.push(o),p=e.footnoteOrder.length):p=h+1,_+=1,e.footnoteCounts.set(o,_);const a={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+u,id:n+"fnref-"+u+(_>1?"-"+_:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(p)}]};e.patch(t,a);const b={type:"element",tagName:"sup",properties:{},children:[a]};return e.patch(t,b),e.applyData(t,b)}function KBe(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function QBe(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function BY(e,t){const n=t.referenceType;let o="]";if(n==="collapsed"?o+="[]":n==="full"&&(o+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+o}];const u=e.all(t),h=u[0];h&&h.type==="text"?h.value="["+h.value:u.unshift({type:"text",value:"["});const p=u[u.length-1];return p&&p.type==="text"?p.value+=o:u.push({type:"text",value:o}),u}function JBe(e,t){const n=String(t.identifier).toUpperCase(),o=e.definitionById.get(n);if(!o)return BY(e,t);const u={src:cy(o.url||""),alt:t.alt};o.title!==null&&o.title!==void 0&&(u.title=o.title);const h={type:"element",tagName:"img",properties:u,children:[]};return e.patch(t,h),e.applyData(t,h)}function e4e(e,t){const n={src:cy(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const o={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,o),e.applyData(t,o)}function t4e(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const o={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,o),e.applyData(t,o)}function n4e(e,t){const n=String(t.identifier).toUpperCase(),o=e.definitionById.get(n);if(!o)return BY(e,t);const u={href:cy(o.url||"")};o.title!==null&&o.title!==void 0&&(u.title=o.title);const h={type:"element",tagName:"a",properties:u,children:e.all(t)};return e.patch(t,h),e.applyData(t,h)}function r4e(e,t){const n={href:cy(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const o={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,o),e.applyData(t,o)}function i4e(e,t,n){const o=e.all(t),u=n?o4e(n):jY(t),h={},p=[];if(typeof t.checked=="boolean"){const C=o[0];let A;C&&C.type==="element"&&C.tagName==="p"?A=C:(A={type:"element",tagName:"p",properties:{},children:[]},o.unshift(A)),A.children.length>0&&A.children.unshift({type:"text",value:" "}),A.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),h.className=["task-list-item"]}let _=-1;for(;++_<o.length;){const C=o[_];(u||_!==0||C.type!=="element"||C.tagName!=="p")&&p.push({type:"text",value:`
`}),C.type==="element"&&C.tagName==="p"&&!u?p.push(...C.children):p.push(C)}const a=o[o.length-1];a&&(u||a.type!=="element"||a.tagName!=="p")&&p.push({type:"text",value:`
`});const b={type:"element",tagName:"li",properties:h,children:p};return e.patch(t,b),e.applyData(t,b)}function o4e(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let o=-1;for(;!t&&++o<n.length;)t=jY(n[o])}return t}function jY(e){const t=e.spread;return t??e.children.length>1}function a4e(e,t){const n={},o=e.all(t);let u=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++u<o.length;){const p=o[u];if(p.type==="element"&&p.tagName==="li"&&p.properties&&Array.isArray(p.properties.className)&&p.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const h={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(o,!0)};return e.patch(t,h),e.applyData(t,h)}function s4e(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function l4e(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function u4e(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function c4e(e,t){const n=e.all(t),o=n.shift(),u=[];if(o){const p={type:"element",tagName:"thead",properties:{},children:e.wrap([o],!0)};e.patch(t.children[0],p),u.push(p)}if(n.length>0){const p={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},_=hL(t.children[1]),a=xY(t.children[t.children.length-1]);_&&a&&(p.position={start:_,end:a}),u.push(p)}const h={type:"element",tagName:"table",properties:{},children:e.wrap(u,!0)};return e.patch(t,h),e.applyData(t,h)}function h4e(e,t,n){const o=n?n.children:void 0,h=(o?o.indexOf(t):1)===0?"th":"td",p=n&&n.type==="table"?n.align:void 0,_=p?p.length:t.children.length;let a=-1;const b=[];for(;++a<_;){const A=t.children[a],O={},k=p?p[a]:void 0;k&&(O.align=k);let N={type:"element",tagName:h,properties:O,children:[]};A&&(N.children=e.all(A),e.patch(A,N),N=e.applyData(A,N)),b.push(N)}const C={type:"element",tagName:"tr",properties:{},children:e.wrap(b,!0)};return e.patch(t,C),e.applyData(t,C)}function f4e(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const AU=9,CU=32;function d4e(e){const t=String(e),n=/\r?\n|\r/g;let o=n.exec(t),u=0;const h=[];for(;o;)h.push(PU(t.slice(u,o.index),u>0,!0),o[0]),u=o.index+o[0].length,o=n.exec(t);return h.push(PU(t.slice(u),u>0,!1)),h.join("")}function PU(e,t,n){let o=0,u=e.length;if(t){let h=e.codePointAt(o);for(;h===AU||h===CU;)o++,h=e.codePointAt(o)}if(n){let h=e.codePointAt(u-1);for(;h===AU||h===CU;)u--,h=e.codePointAt(u-1)}return u>o?e.slice(o,u):""}function p4e(e,t){const n={type:"text",value:d4e(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function m4e(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const g4e={blockquote:WBe,break:HBe,code:qBe,delete:ZBe,emphasis:XBe,footnoteReference:YBe,heading:KBe,html:QBe,imageReference:JBe,image:e4e,inlineCode:t4e,linkReference:n4e,link:r4e,listItem:i4e,list:a4e,paragraph:s4e,root:l4e,strong:u4e,table:c4e,tableCell:f4e,tableRow:h4e,text:p4e,thematicBreak:m4e,toml:Bw,yaml:Bw,definition:Bw,footnoteDefinition:Bw};function Bw(){}const $Y=-1,_A=0,FT=1,NT=2,_L=3,vL=4,xL=5,bL=6,UY=7,VY=8,MU=typeof self=="object"?self:globalThis,y4e=(e,t)=>{const n=(u,h)=>(e.set(h,u),u),o=u=>{if(e.has(u))return e.get(u);const[h,p]=t[u];switch(h){case _A:case $Y:return n(p,u);case FT:{const _=n([],u);for(const a of p)_.push(o(a));return _}case NT:{const _=n({},u);for(const[a,b]of p)_[o(a)]=o(b);return _}case _L:return n(new Date(p),u);case vL:{const{source:_,flags:a}=p;return n(new RegExp(_,a),u)}case xL:{const _=n(new Map,u);for(const[a,b]of p)_.set(o(a),o(b));return _}case bL:{const _=n(new Set,u);for(const a of p)_.add(o(a));return _}case UY:{const{name:_,message:a}=p;return n(new MU[_](a),u)}case VY:return n(BigInt(p),u);case"BigInt":return n(Object(BigInt(p)),u)}return n(new MU[h](p),u)};return o},IU=e=>y4e(new Map,e)(0),Am="",{toString:_4e}={},{keys:v4e}=Object,Mv=e=>{const t=typeof e;if(t!=="object"||!e)return[_A,t];const n=_4e.call(e).slice(8,-1);switch(n){case"Array":return[FT,Am];case"Object":return[NT,Am];case"Date":return[_L,Am];case"RegExp":return[vL,Am];case"Map":return[xL,Am];case"Set":return[bL,Am]}return n.includes("Array")?[FT,n]:n.includes("Error")?[UY,n]:[NT,n]},jw=([e,t])=>e===_A&&(t==="function"||t==="symbol"),x4e=(e,t,n,o)=>{const u=(p,_)=>{const a=o.push(p)-1;return n.set(_,a),a},h=p=>{if(n.has(p))return n.get(p);let[_,a]=Mv(p);switch(_){case _A:{let C=p;switch(a){case"bigint":_=VY,C=p.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);C=null;break;case"undefined":return u([$Y],p)}return u([_,C],p)}case FT:{if(a)return u([a,[...p]],p);const C=[],A=u([_,C],p);for(const O of p)C.push(h(O));return A}case NT:{if(a)switch(a){case"BigInt":return u([a,p.toString()],p);case"Boolean":case"Number":case"String":return u([a,p.valueOf()],p)}if(t&&"toJSON"in p)return h(p.toJSON());const C=[],A=u([_,C],p);for(const O of v4e(p))(e||!jw(Mv(p[O])))&&C.push([h(O),h(p[O])]);return A}case _L:return u([_,p.toISOString()],p);case vL:{const{source:C,flags:A}=p;return u([_,{source:C,flags:A}],p)}case xL:{const C=[],A=u([_,C],p);for(const[O,k]of p)(e||!(jw(Mv(O))||jw(Mv(k))))&&C.push([h(O),h(k)]);return A}case bL:{const C=[],A=u([_,C],p);for(const O of p)(e||!jw(Mv(O)))&&C.push(h(O));return A}}const{message:b}=p;return u([_,{name:a,message:b}],p)};return h},OU=(e,{json:t,lossy:n}={})=>{const o=[];return x4e(!(t||n),!!t,new Map,o)(e),o},BT=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?IU(OU(e,t)):structuredClone(e):(e,t)=>IU(OU(e,t));function b4e(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function w4e(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function S4e(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||b4e,o=e.options.footnoteBackLabel||w4e,u=e.options.footnoteLabel||"Footnotes",h=e.options.footnoteLabelTagName||"h2",p=e.options.footnoteLabelProperties||{className:["sr-only"]},_=[];let a=-1;for(;++a<e.footnoteOrder.length;){const b=e.footnoteById.get(e.footnoteOrder[a]);if(!b)continue;const C=e.all(b),A=String(b.identifier).toUpperCase(),O=cy(A.toLowerCase());let k=0;const N=[],z=e.footnoteCounts.get(A);for(;z!==void 0&&++k<=z;){N.length>0&&N.push({type:"text",value:" "});let G=typeof n=="string"?n:n(a,k);typeof G=="string"&&(G={type:"text",value:G}),N.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+O+(k>1?"-"+k:""),dataFootnoteBackref:"",ariaLabel:typeof o=="string"?o:o(a,k),className:["data-footnote-backref"]},children:Array.isArray(G)?G:[G]})}const U=C[C.length-1];if(U&&U.type==="element"&&U.tagName==="p"){const G=U.children[U.children.length-1];G&&G.type==="text"?G.value+=" ":U.children.push({type:"text",value:" "}),U.children.push(...N)}else C.push(...N);const j={type:"element",tagName:"li",properties:{id:t+"fn-"+O},children:e.wrap(C,!0)};e.patch(b,j),_.push(j)}if(_.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:h,properties:{...BT(p),id:"footnote-label"},children:[{type:"text",value:u}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(_,!0)},{type:"text",value:`
`}]}}const GY=function(e){if(e==null)return C4e;if(typeof e=="function")return vA(e);if(typeof e=="object")return Array.isArray(e)?T4e(e):E4e(e);if(typeof e=="string")return A4e(e);throw new Error("Expected function, string, or object as test")};function T4e(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=GY(e[n]);return vA(o);function o(...u){let h=-1;for(;++h<t.length;)if(t[h].apply(this,u))return!0;return!1}}function E4e(e){const t=e;return vA(n);function n(o){const u=o;let h;for(h in e)if(u[h]!==t[h])return!1;return!0}}function A4e(e){return vA(t);function t(n){return n&&n.type===e}}function vA(e){return t;function t(n,o,u){return!!(P4e(n)&&e.call(this,n,typeof o=="number"?o:void 0,u||void 0))}}function C4e(){return!0}function P4e(e){return e!==null&&typeof e=="object"&&"type"in e}const WY=[],M4e=!0,RU=!1,I4e="skip";function O4e(e,t,n,o){let u;typeof t=="function"&&typeof n!="function"?(o=n,n=t):u=t;const h=GY(u),p=o?-1:1;_(e,void 0,[])();function _(a,b,C){const A=a&&typeof a=="object"?a:{};if(typeof A.type=="string"){const k=typeof A.tagName=="string"?A.tagName:typeof A.name=="string"?A.name:void 0;Object.defineProperty(O,"name",{value:"node ("+(a.type+(k?"<"+k+">":""))+")"})}return O;function O(){let k=WY,N,z,U;if((!t||h(a,b,C[C.length-1]||void 0))&&(k=R4e(n(a,C)),k[0]===RU))return k;if("children"in a&&a.children){const j=a;if(j.children&&k[0]!==I4e)for(z=(o?j.children.length:-1)+p,U=C.concat(j);z>-1&&z<j.children.length;){const G=j.children[z];if(N=_(G,z,U)(),N[0]===RU)return N;z=typeof N[1]=="number"?N[1]:z+p}}return k}}}function R4e(e){return Array.isArray(e)?e:typeof e=="number"?[M4e,e]:e==null?WY:[e]}function HY(e,t,n,o){let u,h,p;typeof t=="function"&&typeof n!="function"?(h=void 0,p=t,u=n):(h=t,p=n,u=o),O4e(e,h,_,u);function _(a,b){const C=b[b.length-1],A=C?C.children.indexOf(a):void 0;return p(a,A,C)}}const pR={}.hasOwnProperty,k4e={};function D4e(e,t){const n=t||k4e,o=new Map,u=new Map,h=new Map,p={...g4e,...n.handlers},_={all:b,applyData:z4e,definitionById:o,footnoteById:u,footnoteCounts:h,footnoteOrder:[],handlers:p,one:a,options:n,patch:L4e,wrap:N4e};return HY(e,function(C){if(C.type==="definition"||C.type==="footnoteDefinition"){const A=C.type==="definition"?o:u,O=String(C.identifier).toUpperCase();A.has(O)||A.set(O,C)}}),_;function a(C,A){const O=C.type,k=_.handlers[O];if(pR.call(_.handlers,O)&&k)return k(_,C,A);if(_.options.passThrough&&_.options.passThrough.includes(O)){if("children"in C){const{children:z,...U}=C,j=BT(U);return j.children=_.all(C),j}return BT(C)}return(_.options.unknownHandler||F4e)(_,C,A)}function b(C){const A=[];if("children"in C){const O=C.children;let k=-1;for(;++k<O.length;){const N=_.one(O[k],C);if(N){if(k&&O[k-1].type==="break"&&(!Array.isArray(N)&&N.type==="text"&&(N.value=kU(N.value)),!Array.isArray(N)&&N.type==="element")){const z=N.children[0];z&&z.type==="text"&&(z.value=kU(z.value))}Array.isArray(N)?A.push(...N):A.push(N)}}}return A}}function L4e(e,t){e.position&&(t.position=gFe(e))}function z4e(e,t){let n=t;if(e&&e.data){const o=e.data.hName,u=e.data.hChildren,h=e.data.hProperties;if(typeof o=="string")if(n.type==="element")n.tagName=o;else{const p="children"in n?n.children:[n];n={type:"element",tagName:o,properties:{},children:p}}n.type==="element"&&h&&Object.assign(n.properties,BT(h)),"children"in n&&n.children&&u!==null&&u!==void 0&&(n.children=u)}return n}function F4e(e,t){const n=t.data||{},o="value"in t&&!(pR.call(n,"hProperties")||pR.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,o),e.applyData(t,o)}function N4e(e,t){const n=[];let o=-1;for(t&&n.push({type:"text",value:`
`});++o<e.length;)o&&n.push({type:"text",value:`
`}),n.push(e[o]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function kU(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function DU(e,t){const n=D4e(e,t),o=n.one(e,void 0),u=S4e(n),h=Array.isArray(o)?{type:"root",children:o}:o||{type:"root",children:[]};return u&&h.children.push({type:"text",value:`
`},u),h}function B4e(e,t){return e&&"run"in e?async function(n,o){const u=DU(n,{file:o,...t});await e.run(u,o)}:function(n,o){return DU(n,{file:o,...t||e})}}function LU(e){if(e)throw e}var nS=Object.prototype.hasOwnProperty,qY=Object.prototype.toString,zU=Object.defineProperty,FU=Object.getOwnPropertyDescriptor,NU=function(t){return typeof Array.isArray=="function"?Array.isArray(t):qY.call(t)==="[object Array]"},BU=function(t){if(!t||qY.call(t)!=="[object Object]")return!1;var n=nS.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&nS.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!o)return!1;var u;for(u in t);return typeof u>"u"||nS.call(t,u)},jU=function(t,n){zU&&n.name==="__proto__"?zU(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},$U=function(t,n){if(n==="__proto__")if(nS.call(t,n)){if(FU)return FU(t,n).value}else return;return t[n]},j4e=function e(){var t,n,o,u,h,p,_=arguments[0],a=1,b=arguments.length,C=!1;for(typeof _=="boolean"&&(C=_,_=arguments[1]||{},a=2),(_==null||typeof _!="object"&&typeof _!="function")&&(_={});a<b;++a)if(t=arguments[a],t!=null)for(n in t)o=$U(_,n),u=$U(t,n),_!==u&&(C&&u&&(BU(u)||(h=NU(u)))?(h?(h=!1,p=o&&NU(o)?o:[]):p=o&&BU(o)?o:{},jU(_,{name:n,newValue:e(C,p,u)})):typeof u<"u"&&jU(_,{name:n,newValue:u}));return _};const oI=Vr(j4e);function mR(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function $4e(){const e=[],t={run:n,use:o};return t;function n(...u){let h=-1;const p=u.pop();if(typeof p!="function")throw new TypeError("Expected function as last argument, not "+p);_(null,...u);function _(a,...b){const C=e[++h];let A=-1;if(a){p(a);return}for(;++A<u.length;)(b[A]===null||b[A]===void 0)&&(b[A]=u[A]);u=b,C?U4e(C,_)(...b):p(null,...b)}}function o(u){if(typeof u!="function")throw new TypeError("Expected `middelware` to be a function, not "+u);return e.push(u),t}}function U4e(e,t){let n;return o;function o(...p){const _=e.length>p.length;let a;_&&p.push(u);try{a=e.apply(this,p)}catch(b){const C=b;if(_&&n)throw C;return u(C)}_||(a&&a.then&&typeof a.then=="function"?a.then(h,u):a instanceof Error?u(a):h(a))}function u(p,..._){n||(n=!0,t(p,..._))}function h(p){u(null,p)}}const kl={basename:V4e,dirname:G4e,extname:W4e,join:H4e,sep:"/"};function V4e(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');$x(e);let n=0,o=-1,u=e.length,h;if(t===void 0||t.length===0||t.length>e.length){for(;u--;)if(e.codePointAt(u)===47){if(h){n=u+1;break}}else o<0&&(h=!0,o=u+1);return o<0?"":e.slice(n,o)}if(t===e)return"";let p=-1,_=t.length-1;for(;u--;)if(e.codePointAt(u)===47){if(h){n=u+1;break}}else p<0&&(h=!0,p=u+1),_>-1&&(e.codePointAt(u)===t.codePointAt(_--)?_<0&&(o=u):(_=-1,o=p));return n===o?o=p:o<0&&(o=e.length),e.slice(n,o)}function G4e(e){if($x(e),e.length===0)return".";let t=-1,n=e.length,o;for(;--n;)if(e.codePointAt(n)===47){if(o){t=n;break}}else o||(o=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function W4e(e){$x(e);let t=e.length,n=-1,o=0,u=-1,h=0,p;for(;t--;){const _=e.codePointAt(t);if(_===47){if(p){o=t+1;break}continue}n<0&&(p=!0,n=t+1),_===46?u<0?u=t:h!==1&&(h=1):u>-1&&(h=-1)}return u<0||n<0||h===0||h===1&&u===n-1&&u===o+1?"":e.slice(u,n)}function H4e(...e){let t=-1,n;for(;++t<e.length;)$x(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":q4e(n)}function q4e(e){$x(e);const t=e.codePointAt(0)===47;let n=Z4e(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function Z4e(e,t){let n="",o=0,u=-1,h=0,p=-1,_,a;for(;++p<=e.length;){if(p<e.length)_=e.codePointAt(p);else{if(_===47)break;_=47}if(_===47){if(!(u===p-1||h===1))if(u!==p-1&&h===2){if(n.length<2||o!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(a=n.lastIndexOf("/"),a!==n.length-1){a<0?(n="",o=0):(n=n.slice(0,a),o=n.length-1-n.lastIndexOf("/")),u=p,h=0;continue}}else if(n.length>0){n="",o=0,u=p,h=0;continue}}t&&(n=n.length>0?n+"/..":"..",o=2)}else n.length>0?n+="/"+e.slice(u+1,p):n=e.slice(u+1,p),o=p-u-1;u=p,h=0}else _===46&&h>-1?h++:h=-1}return n}function $x(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const X4e={cwd:Y4e};function Y4e(){return"/"}function gR(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function K4e(e){if(typeof e=="string")e=new URL(e);else if(!gR(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return Q4e(e)}function Q4e(e){if(e.hostname!==""){const o=new TypeError('File URL host must be "localhost" or empty on darwin');throw o.code="ERR_INVALID_FILE_URL_HOST",o}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const o=t.codePointAt(n+2);if(o===70||o===102){const u=new TypeError("File URL path must not include encoded / characters");throw u.code="ERR_INVALID_FILE_URL_PATH",u}}return decodeURIComponent(t)}const aI=["history","path","basename","stem","extname","dirname"];class ZY{constructor(t){let n;t?gR(t)?n={path:t}:typeof t=="string"||J4e(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":X4e.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let o=-1;for(;++o<aI.length;){const h=aI[o];h in n&&n[h]!==void 0&&n[h]!==null&&(this[h]=h==="history"?[...n[h]]:n[h])}let u;for(u in n)aI.includes(u)||(this[u]=n[u])}get basename(){return typeof this.path=="string"?kl.basename(this.path):void 0}set basename(t){lI(t,"basename"),sI(t,"basename"),this.path=kl.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?kl.dirname(this.path):void 0}set dirname(t){UU(this.basename,"dirname"),this.path=kl.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?kl.extname(this.path):void 0}set extname(t){if(sI(t,"extname"),UU(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=kl.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){gR(t)&&(t=K4e(t)),lI(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?kl.basename(this.path,this.extname):void 0}set stem(t){lI(t,"stem"),sI(t,"stem"),this.path=kl.join(this.dirname||"",t+(this.extname||""))}fail(t,n,o){const u=this.message(t,n,o);throw u.fatal=!0,u}info(t,n,o){const u=this.message(t,n,o);return u.fatal=void 0,u}message(t,n,o){const u=new jo(t,n,o);return this.path&&(u.name=this.path+":"+u.name,u.file=this.path),u.fatal=!1,this.messages.push(u),u}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function sI(e,t){if(e&&e.includes(kl.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+kl.sep+"`")}function lI(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function UU(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function J4e(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const eje=function(e){const o=this.constructor.prototype,u=o[e],h=function(){return u.apply(h,arguments)};return Object.setPrototypeOf(h,o),h},tje={}.hasOwnProperty;class wL extends eje{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=$4e()}copy(){const t=new wL;let n=-1;for(;++n<this.attachers.length;){const o=this.attachers[n];t.use(...o)}return t.data(oI(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(hI("data",this.frozen),this.namespace[t]=n,this):tje.call(this.namespace,t)&&this.namespace[t]||void 0:t?(hI("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...o]=this.attachers[this.freezeIndex];if(o[0]===!1)continue;o[0]===!0&&(o[0]=void 0);const u=n.call(t,...o);typeof u=="function"&&this.transformers.use(u)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=$w(t),o=this.parser||this.Parser;return uI("parse",o),o(String(n),n)}process(t,n){const o=this;return this.freeze(),uI("process",this.parser||this.Parser),cI("process",this.compiler||this.Compiler),n?u(void 0,n):new Promise(u);function u(h,p){const _=$w(t),a=o.parse(_);o.run(a,_,function(C,A,O){if(C||!A||!O)return b(C);const k=A,N=o.stringify(k,O);ije(N)?O.value=N:O.result=N,b(C,O)});function b(C,A){C||!A?p(C):h?h(A):n(void 0,A)}}}processSync(t){let n=!1,o;return this.freeze(),uI("processSync",this.parser||this.Parser),cI("processSync",this.compiler||this.Compiler),this.process(t,u),GU("processSync","process",n),o;function u(h,p){n=!0,LU(h),o=p}}run(t,n,o){VU(t),this.freeze();const u=this.transformers;return!o&&typeof n=="function"&&(o=n,n=void 0),o?h(void 0,o):new Promise(h);function h(p,_){const a=$w(n);u.run(t,a,b);function b(C,A,O){const k=A||t;C?_(C):p?p(k):o(void 0,k,O)}}}runSync(t,n){let o=!1,u;return this.run(t,n,h),GU("runSync","run",o),u;function h(p,_){LU(p),u=_,o=!0}}stringify(t,n){this.freeze();const o=$w(n),u=this.compiler||this.Compiler;return cI("stringify",u),VU(t),u(t,o)}use(t,...n){const o=this.attachers,u=this.namespace;if(hI("use",this.frozen),t!=null)if(typeof t=="function")a(t,n);else if(typeof t=="object")Array.isArray(t)?_(t):p(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function h(b){if(typeof b=="function")a(b,[]);else if(typeof b=="object")if(Array.isArray(b)){const[C,...A]=b;a(C,A)}else p(b);else throw new TypeError("Expected usable value, not `"+b+"`")}function p(b){if(!("plugins"in b)&&!("settings"in b))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");_(b.plugins),b.settings&&(u.settings=oI(!0,u.settings,b.settings))}function _(b){let C=-1;if(b!=null)if(Array.isArray(b))for(;++C<b.length;){const A=b[C];h(A)}else throw new TypeError("Expected a list of plugins, not `"+b+"`")}function a(b,C){let A=-1,O=-1;for(;++A<o.length;)if(o[A][0]===b){O=A;break}if(O===-1)o.push([b,...C]);else if(C.length>0){let[k,...N]=C;const z=o[O][1];mR(z)&&mR(k)&&(k=oI(!0,z,k)),o[O]=[b,k,...N]}}}}const nje=new wL().freeze();function uI(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function cI(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function hI(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function VU(e){if(!mR(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function GU(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function $w(e){return rje(e)?e:new ZY(e)}function rje(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function ije(e){return typeof e=="string"||oje(e)}function oje(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const aje="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",WU=[],HU={allowDangerousHtml:!0},sje=/^(https?|ircs?|mailto|xmpp)$/i,lje=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function uje(e){const t=e.allowedElements,n=e.allowElement,o=e.children||"",u=e.className,h=e.components,p=e.disallowedElements,_=e.rehypePlugins||WU,a=e.remarkPlugins||WU,b=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...HU}:HU,C=e.skipHtml,A=e.unwrapDisallowed,O=e.urlTransform||cje,k=nje().use(GBe).use(a).use(B4e,b).use(_),N=new ZY;typeof o=="string"&&(N.value=o);for(const G of lje)Object.hasOwn(e,G.from)&&(""+G.from+(G.to?"use `"+G.to+"` instead":"remove it")+aje+G.id,void 0);const z=k.parse(N);let U=k.runSync(z,N);return u&&(U={type:"element",tagName:"div",properties:{className:u},children:U.type==="root"?U.children:[U]}),HY(U,j),wFe(U,{Fragment:re.Fragment,components:h,ignoreInvalidStyle:!0,jsx:re.jsx,jsxs:re.jsxs,passKeys:!0,passNode:!0});function j(G,H,Y){if(G.type==="raw"&&Y&&typeof H=="number")return C?Y.children.splice(H,1):Y.children[H]={type:"text",value:G.value},H;if(G.type==="element"){let K;for(K in nI)if(Object.hasOwn(nI,K)&&Object.hasOwn(G.properties,K)){const ee=G.properties[K],ue=nI[K];(ue===null||ue.includes(G.tagName))&&(G.properties[K]=O(String(ee||""),K,G))}}if(G.type==="element"){let K=t?!t.includes(G.tagName):p?p.includes(G.tagName):!1;if(!K&&n&&typeof H=="number"&&(K=!n(G,H,Y)),K&&Y&&typeof H=="number")return A&&G.children?Y.children.splice(H,1,...G.children):Y.children.splice(H,1),H}}}function cje(e){const t=e.indexOf(":"),n=e.indexOf("?"),o=e.indexOf("#"),u=e.indexOf("/");return t<0||u>-1&&t>u||n>-1&&t>n||o>-1&&t>o||sje.test(e.slice(0,t))?e:""}var fI={VITE_API_URL:"https://f2ggum2vms.us-west-2.awsapprunner.com",VITE_AWS_API_URL:"https://1nuu606qd3.execute-api.us-west-2.amazonaws.com/default/LambdaStack-us-west-2-regionFunction0D786950-A7tCAv9V8Mr0",VITE_AWS_R2C_URL:"https://dlche4ubk8.execute-api.us-west-2.amazonaws.com/default/R2CMain-regionToClientHandlerD3108EC1-GwnbgtoBzMOs",VITE_CHATBOT_API_KEY:"1",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const hje=({conversations:e,chatConversationsContainerRef:t})=>(W.useEffect(()=>{const n=t==null?void 0:t.current;n&&n.scrollTo(0,n.scrollHeight)},[e]),re.jsx("div",{className:"w-full",children:e&&e.map((n,o)=>re.jsx(dje,{message:n},`chatbot-message-${o}`))})),fje=({disabled:e,onSubmit:t,placeholder:n,customSubmitIcon:o})=>{const u=W.useRef(null),h=W.useCallback(_=>{_.preventDefault();const a=u==null?void 0:u.current;a&&a.value.trim().length>0&&(t&&t(a.value),a.value="")},[t]),p=W.useCallback(_=>{_.key==="Enter"&&!_.shiftKey&&h(_)},[h]);return re.jsxs("div",{className:"flex items-center flex-1",children:[re.jsx("textarea",{ref:u,className:"w-full pl-8 pr-15 pt-4 mb-4 pb-0 bg-gradient-to-br from-slate-100 to-indigo-100 rounded-full",onKeyUp:p,placeholder:n||"Type here to chat",disabled:e}),re.jsx("button",{disabled:e,onClick:h,className:"px-2.5 mx-2 py-3 text-white rounded-full hover:bg-indigo-200 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-300",children:o||re.jsx("img",{src:iX,alt:"Send",className:"h-5"})})]})},dje=({message:e})=>{const t=e.type!=="human";return re.jsxs("div",{className:"mt-4 mr-52 ml-52 flex",children:[re.jsx("div",{className:"bg-neutral text-neutral-content h-10 w-10 rounded-full flex items-center justify-center mr-4",children:t?re.jsx("img",{src:lLe,alt:"AI-Chatbot",className:"h-10 "}):""}),re.jsxs("div",{className:"flex flex-col",children:[re.jsx("h4",{className:"font-semibold select-none",children:t?"LQ AI":""}),re.jsx("p",{className:t?"bg-white font-ember text-sky-950":"font-ember bg-gradient-to-br text- from-purple-100 to-indigo-300 rounded-full pl-5 pr-5 pt-2 pb-2 m-2",children:re.jsx(uje,{children:e.content})})]})]})};function pje(){W.useState("");const[e,t]=W.useState(""),[n,o]=W.useState([]),[u,h]=W.useState(!1),p=W.useRef(null);W.useEffect(()=>{(()=>{const A=localStorage.getItem("userUuid");if(A)t(A);else{const O=Nw();localStorage.setItem("userUuid",O),t(O)}})()},[]),W.useEffect(()=>{e&&_()},[e]);const _=async()=>{const C=await fetch(`${fI.VITE_CHATBOT_API_URL}/get-history`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":"1"},body:JSON.stringify({session_id:e})});if(C.status===200){const O=(await C.json()).filter(k=>k.type!=="tool");o(O)}},a=async C=>{h(!0);const A={input:C,session_id:e,time:new Date().toISOString()},k=(await fetch(`${fI.VITE_CHATBOT_API_URL}/chat`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":"1"},body:JSON.stringify(A)})).body.getReader(),N=new TextDecoder;let z,U="";const j=Nw(),G={id:j,type:"AIMessageChunk",content:""};o(Y=>[...Y,{id:Nw(),type:"human",content:C},G]);let H=!1;for(;!(z=await k.read()).done;){const Y=N.decode(z.value,{stream:!0});Y==="<|tool_call|>"||Y==="<|message_received|>"?H||(U+=`
Analyzing...
`,H=!0):(H&&(U=U.replace(`
Analyzing...
`,""),H=!1),U+=Y),o(K=>K.map(ee=>ee.id===j?{...ee,content:U}:ee))}h(!1)},b=async()=>{h(!0),(await fetch(`${fI.VITE_CHATBOT_API_URL}/delete-history`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":"1"},body:JSON.stringify({session_id:e})})).status===409?o([{id:Nw(),type:"AIMessageChunk",content:"Deletion not successful"}]):o([]),h(!1)};return re.jsxs("div",{className:"flex flex-col h-screen bg-white mt-16",children:[re.jsx(iE,{page:"Chatbox"}),re.jsxs("div",{className:"flex flex-col justify-between items-center w-full h-full p-4",children:[n.length===0?re.jsxs(re.Fragment,{children:[re.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-br from-indigo-700 to-blue-400 text-transparent bg-clip-text mt-48",children:"Welcome to AWS LQ AI"}),re.jsx("h2",{className:"text-lg text-semibold font-ember text-customPurple -mt-12",children:"How can I help you today?"}),re.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-6 w-3/5 mb-6 -mt-10 ml-20 mr-20 ",children:[re.jsx("div",{className:"p-10 bg-slate-100 hover:bg-gradient-to-br from-indigo-100 to-white-100 rounded-lg hover:shadow-lg transition-shadow duration-300 cursor-pointer text-center",children:re.jsx("p",{className:"text-sm text-slate-500 font-ember font-medium",children:"What region will provide the optimal latency to AWS Origon?"})}),re.jsx("div",{className:"p-10 bg-slate-100 rounded-lg hover:shadow-lg transition-shadow duration-300 cursor-pointer hover:bg-gradient-to-br from-indigo-100 to-white-100 text-center",children:re.jsx("p",{className:"text-sm text-slate-500 font-ember font-medium",children:"What is the live ping between ca-central-1 and ap-south-2?"})}),re.jsx("div",{className:"p-10 bg-slate-100 rounded-lg hover:shadow-lg transition-shadow hover:bg-gradient-to-br from-indigo-100 to-white-100 duration-300 cursor-pointer text-center",children:re.jsx("p",{className:"text-sm text-slate-500 font-ember font-medium",children:"What was the latency between Ohio and Mumbai last Sunday?"})}),re.jsx("div",{className:"p-10 bg-slate-100 rounded-lg hover:shadow-lg hover:bg-gradient-to-br from-indigo-100 to-white-100 transition-shadow duration-300 cursor-pointer text-center",children:re.jsx("p",{className:"text-sm text-slate-500 font-ember font-medium",children:"What are the available services at the East Canada Data Center?"})})]})]}):re.jsx("div",{ref:p,className:"flex-grow w-full overflow-y-auto",children:re.jsx(hje,{conversations:n,chatConversationsContainerRef:p})}),re.jsxs("div",{className:"flex w-3/5 mt-2",children:[re.jsx(fje,{disabled:u,onSubmit:a,placeholder:"Enter a prompt",customSubmitIcon:re.jsx("img",{src:iX,alt:"Send",className:"mr-1  mb-2 ml-1 h-6"})}),re.jsx(sY,{className:"mt-2 ml-4",children:re.jsxs(Ize,{children:[re.jsx(lY,{children:"..."}),re.jsx(uY,{children:re.jsx(cY,{children:re.jsx("button",{onClick:b,children:"Delete History"})})})]})})]})]})]})}function mje(){return re.jsx("div",{children:re.jsx(ere,{children:re.jsxs(qne,{children:[re.jsx(Dv,{index:!0,element:re.jsx(fre,{})}),re.jsx(Dv,{path:"/latency",element:re.jsx(vce,{})}),re.jsx(Dv,{path:"/history",element:re.jsx(rLe,{})}),re.jsx(Dv,{path:"/chatbox",element:re.jsx(pje,{})})]})})})}dI.createRoot(document.getElementById("root")).render(re.jsx(Ye.StrictMode,{children:re.jsx(mje,{})}));
